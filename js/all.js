!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PIXI=t()}}(function(){return function(){return function t(e,r,n){function i(s,a){if(!r[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var l=r[s]={exports:{}};e[s][0].call(l.exports,function(t){return i(e[s][1][t]||t)},l,l.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}}()({1:[function(t,e,r){"use strict";function n(t){var e=32;return(t&=-t)&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}r.INT_BITS=32,r.INT_MAX=2147483647,r.INT_MIN=-1<<31,r.sign=function(t){return(t>0)-(t<0)},r.abs=function(t){var e=t>>31;return(t^e)-e},r.min=function(t,e){return e^(t^e)&-(t<e)},r.max=function(t,e){return t^(t^e)&-(t<e)},r.isPow2=function(t){return!(t&t-1||!t)},r.log2=function(t){var e,r;return e=(t>65535)<<4,e|=r=((t>>>=e)>255)<<3,e|=r=((t>>>=r)>15)<<2,(e|=r=((t>>>=r)>3)<<1)|(t>>>=r)>>1},r.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},r.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},r.countTrailingZeros=n,r.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)},r.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},r.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var i=new Array(256);!function(t){for(var e=0;e<256;++e){var r=e,n=e,i=7;for(r>>>=1;r;r>>>=1)n<<=1,n|=1&r,--i;t[e]=n<<i&255}}(i),r.reverse=function(t){return i[255&t]<<24|i[t>>>8&255]<<16|i[t>>>16&255]<<8|i[t>>>24&255]},r.interleave2=function(t,e){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))<<1},r.deinterleave2=function(t,e){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>e&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},r.interleave3=function(t,e,r){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<1)|(r=1227133513&((r=3272356035&((r=251719695&((r=4278190335&((r&=1023)|r<<16))|r<<8))|r<<4))|r<<2))<<2},r.deinterleave3=function(t,e){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>e&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},r.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>n(t)+1}},{}],2:[function(t,e,r){"use strict";function n(t,e,r){r=r||2;var n,o,a,u,h,l,d,f=e&&e.length,p=f?e[0]*r:t.length,v=i(t,0,p,r,!0),g=[];if(!v)return g;if(f&&(v=c(t,e,v,r)),t.length>80*r){n=a=t[0],o=u=t[1];for(var y=r;y<p;y+=r)(h=t[y])<n&&(n=h),(l=t[y+1])<o&&(o=l),h>a&&(a=h),l>u&&(u=l);d=0!==(d=Math.max(a-n,u-o))?1/d:0}return s(v,g,r,n,o,d),g}function i(t,e,r,n,i){var o,s;if(i===M(t,e,r,n)>0)for(o=e;o<r;o+=n)s=E(o,t[o],t[o+1],s);else for(o=r-n;o>=e;o-=n)s=E(o,t[o],t[o+1],s);return s&&b(s,s.next)&&(S(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!b(n,n.next)&&0!==_(n.prev,n,n.next))n=n.next;else{if(S(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function s(t,e,r,n,i,c,d){if(t){!d&&c&&p(t,n,i,c);for(var f,v,g=t;t.prev!==t.next;)if(f=t.prev,v=t.next,c?u(t,n,i,c):a(t))e.push(f.i/r),e.push(t.i/r),e.push(v.i/r),S(t),t=v.next,g=v.next;else if((t=v)===g){d?1===d?s(t=h(t,e,r),e,r,n,i,c,2):2===d&&l(t,e,r,n,i,c):s(o(t),e,r,n,i,c,1);break}}}function a(t){var e=t.prev,r=t,n=t.next;if(_(e,r,n)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(y(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&_(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(t,e,r,n){var i=t.prev,o=t,s=t.next;if(_(i,o,s)>=0)return!1;for(var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,h=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,l=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,c=v(a,u,e,r,n),d=v(h,l,e,r,n),f=t.prevZ,p=t.nextZ;f&&f.z>=c&&p&&p.z<=d;){if(f!==t.prev&&f!==t.next&&y(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&_(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==t.prev&&p!==t.next&&y(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&_(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=c;){if(f!==t.prev&&f!==t.next&&y(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&_(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&y(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&_(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function h(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!b(i,o)&&x(i,n,n.next,o)&&T(i,o)&&T(o,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(o.i/r),S(n),S(n.next),n=t=o),n=n.next}while(n!==t);return n}function l(t,e,r,n,i,a){var u=t;do{for(var h=u.next.next;h!==u.prev;){if(u.i!==h.i&&m(u,h)){var l=w(u,h);return u=o(u,u.next),l=o(l,l.next),s(u,e,r,n,i,a),void s(l,e,r,n,i,a)}h=h.next}u=u.next}while(u!==t)}function c(t,e,r,n){var s,a,u,h=[];for(s=0,a=e.length;s<a;s++)(u=i(t,e[s]*n,s<a-1?e[s+1]*n:t.length,n,!1))===u.next&&(u.steiner=!0),h.push(g(u));for(h.sort(d),s=0;s<h.length;s++)f(h[s],r),r=o(r,r.next);return r}function d(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var r,n=e,i=t.x,o=t.y,s=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var a=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>s){if(s=a,a===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(i===s)return r.prev;var u,h=r,l=r.x,c=r.y,d=1/0;for(n=r.next;n!==h;)i>=n.x&&n.x>=l&&i!==n.x&&y(o<c?i:s,o,l,c,o<c?s:i,o,n.x,n.y)&&((u=Math.abs(o-n.y)/(i-n.x))<d||u===d&&n.x>r.x)&&T(n,t)&&(r=n,d=u),n=n.next;return r}(t,e)){var r=w(e,t);o(r,r.next)}}function p(t,e,r,n){var i=t;do{null===i.z&&(i.z=v(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,n,i,o,s,a,u,h=1;do{for(r=t,t=null,o=null,s=0;r;){for(s++,n=r,a=0,e=0;e<h&&(a++,n=n.nextZ);e++);for(u=h;a>0||u>0&&n;)0!==a&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,h*=2}while(s>1)}(i)}function v(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){var e=t,r=t;do{e.x<r.x&&(r=e),e=e.next}while(e!==t);return r}function y(t,e,r,n,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(n-a)-(r-s)*(e-a)>=0&&(r-s)*(o-a)-(i-s)*(n-a)>=0}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&x(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&T(t,e)&&T(e,t)&&function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)}function _(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function x(t,e,r,n){return!!(b(t,e)&&b(r,n)||b(t,n)&&b(r,e))||_(t,e,r)>0!=_(t,e,n)>0&&_(r,n,t)>0!=_(r,n,e)>0}function T(t,e){return _(t.prev,t,t.next)<0?_(t,e,t.next)>=0&&_(t,t.prev,e)>=0:_(t,e,t.prev)<0||_(t,t.next,e)<0}function w(t,e){var r=new O(t.i,t.x,t.y),n=new O(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function E(t,e,r,n){var i=new O(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function O(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function M(t,e,r,n){for(var i=0,o=e,s=r-n;o<r;o+=n)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}e.exports=n,e.exports.default=n,n.deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,s=Math.abs(M(t,0,o,r));if(i)for(var a=0,u=e.length;a<u;a++){var h=e[a]*r,l=a<u-1?e[a+1]*r:t.length;s-=Math.abs(M(t,h,l,r))}var c=0;for(a=0;a<n.length;a+=3){var d=n[a]*r,f=n[a+1]*r,p=n[a+2]*r;c+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},n.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)r.vertices.push(t[i][o][s]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r}},{}],3:[function(t,e,r){"use strict";function n(){}function i(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(){this._events=new n,this._eventsCount=0}var s=Object.prototype.hasOwnProperty,a="~";Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(a=!1)),o.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)s.call(t,e)&&r.push(a?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},o.prototype.listeners=function(t,e){var r=a?a+t:t,n=this._events[r];if(e)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},o.prototype.emit=function(t,e,r,n,i,o){var s=a?a+t:t;if(!this._events[s])return!1;var u,h,l=this._events[s],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,n),!0;case 5:return l.fn.call(l.context,e,r,n,i),!0;case 6:return l.fn.call(l.context,e,r,n,i,o),!0}for(h=1,u=new Array(c-1);h<c;h++)u[h-1]=arguments[h];l.fn.apply(l.context,u)}else{var d,f=l.length;for(h=0;h<f;h++)switch(l[h].once&&this.removeListener(t,l[h].fn,void 0,!0),c){case 1:l[h].fn.call(l[h].context);break;case 2:l[h].fn.call(l[h].context,e);break;case 3:l[h].fn.call(l[h].context,e,r);break;case 4:l[h].fn.call(l[h].context,e,r,n);break;default:if(!u)for(d=1,u=new Array(c-1);d<c;d++)u[d-1]=arguments[d];l[h].fn.apply(l[h].context,u)}}return!0},o.prototype.on=function(t,e,r){var n=new i(e,r||this),o=a?a+t:t;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],n]:this._events[o].push(n):(this._events[o]=n,this._eventsCount++),this},o.prototype.once=function(t,e,r){var n=new i(e,r||this,!0),o=a?a+t:t;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],n]:this._events[o].push(n):(this._events[o]=n,this._eventsCount++),this},o.prototype.removeListener=function(t,e,r,i){var o=a?a+t:t;if(!this._events[o])return this;if(!e)return 0==--this._eventsCount?this._events=new n:delete this._events[o],this;var s=this._events[o];if(s.fn)s.fn!==e||i&&!s.once||r&&s.context!==r||(0==--this._eventsCount?this._events=new n:delete this._events[o]);else{for(var u=0,h=[],l=s.length;u<l;u++)(s[u].fn!==e||i&&!s[u].once||r&&s[u].context!==r)&&h.push(s[u]);h.length?this._events[o]=1===h.length?h[0]:h:0==--this._eventsCount?this._events=new n:delete this._events[o]}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=a?a+t:t,this._events[e]&&(0==--this._eventsCount?this._events=new n:delete this._events[e])):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prototype.setMaxListeners=function(){return this},o.prefixed=a,o.EventEmitter=o,void 0!==e&&(e.exports=o)},{}],4:[function(t,e,r){!function(t){var r=/iPhone/i,n=/iPod/i,i=/iPad/i,o=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,s=/Android/i,a=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,u=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,h=/Windows Phone/i,l=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,c=/BlackBerry/i,d=/BB10/i,f=/Opera Mini/i,p=/(CriOS|Chrome)(?=.*\bMobile\b)/i,v=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,g=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),y=function(t,e){return t.test(e)},m=function(t){var e=t||navigator.userAgent,m=e.split("[FBAN");if(void 0!==m[1]&&(e=m[0]),void 0!==(m=e.split("Twitter"))[1]&&(e=m[0]),this.apple={phone:y(r,e),ipod:y(n,e),tablet:!y(r,e)&&y(i,e),device:y(r,e)||y(n,e)||y(i,e)},this.amazon={phone:y(a,e),tablet:!y(a,e)&&y(u,e),device:y(a,e)||y(u,e)},this.android={phone:y(a,e)||y(o,e),tablet:!y(a,e)&&!y(o,e)&&(y(u,e)||y(s,e)),device:y(a,e)||y(u,e)||y(o,e)||y(s,e)},this.windows={phone:y(h,e),tablet:y(l,e),device:y(h,e)||y(l,e)},this.other={blackberry:y(c,e),blackberry10:y(d,e),opera:y(f,e),firefox:y(v,e),chrome:y(p,e),device:y(c,e)||y(d,e)||y(f,e)||y(v,e)||y(p,e)},this.seven_inch=y(g,e),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},_=function(){var t=new m;return t.Class=m,t};void 0!==e&&e.exports&&"undefined"==typeof window?e.exports=m:void 0!==e&&e.exports&&"undefined"!=typeof window?e.exports=_():t.isMobile=_()}(this)},{}],5:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function(){function t(e,r,i){void 0===r&&(r=!1),n(this,t),this._fn=e,this._once=r,this._thisArg=i,this._next=this._prev=this._owner=null}return o(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}(),a=function(){function t(){n(this,t),this._head=this._tail=void 0}return o(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var r=[];e;)r.push(e),e=e._next;return r}},{key:"has",value:function(t){if(!(t instanceof s))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return i(this,new s(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return i(this,new s(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof s))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();a.MiniSignalBinding=s,r.default=a,e.exports=r.default},{}],6:[function(t,e,r){"use strict";var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,s,a=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),u=1;u<arguments.length;u++){for(var h in r=Object(arguments[u]))i.call(r,h)&&(a[h]=r[h]);if(n){s=n(r);for(var l=0;l<s.length;l++)o.call(r,s[l])&&(a[s[l]]=r[s[l]])}}return a}},{}],7:[function(t,e,r){"use strict";e.exports=function(t,e){e=e||{};for(var r={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},n=r.parser[e.strictMode?"strict":"loose"].exec(t),i={},o=14;o--;)i[r.key[o]]=n[o]||"";return i[r.q.name]={},i[r.key[12]].replace(r.q.parser,function(t,e,n){e&&(i[r.q.name][e]=n)}),i}},{}],8:[function(t,e,r){(function(t){function e(t,e){for(var r=0,n=t.length-1;n>=0;n--){var i=t[n];"."===i?t.splice(n,1):".."===i?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return i.exec(t).slice(1)};r.resolve=function(){for(var r="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var s=o>=0?arguments[o]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(r=s+"/"+r,i="/"===s.charAt(0))}return(i?"/":"")+(r=e(n(r.split("/"),function(t){return!!t}),!i).join("/"))||"."},r.normalize=function(t){var i=r.isAbsolute(t),o="/"===s(t,-1);return(t=e(n(t.split("/"),function(t){return!!t}),!i).join("/"))||i||(t="."),t&&o&&(t+="/"),(i?"/":"")+t},r.isAbsolute=function(t){return"/"===t.charAt(0)},r.join=function(){var t=Array.prototype.slice.call(arguments,0);return r.normalize(n(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},r.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var r=t.length-1;r>=0&&""===t[r];r--);return e>r?[]:t.slice(e,r-e+1)}t=r.resolve(t).substr(1),e=r.resolve(e).substr(1);for(var i=n(t.split("/")),o=n(e.split("/")),s=Math.min(i.length,o.length),a=s,u=0;u<s;u++)if(i[u]!==o[u]){a=u;break}var h=[];for(u=a;u<i.length;u++)h.push("..");return(h=h.concat(o.slice(a))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(t){var e=o(t),r=e[0],n=e[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},r.basename=function(t,e){var r=o(t)[2];return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r},r.extname=function(t){return o(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)}}).call(this,t("_process"))},{_process:26}],9:[function(t,e,r){var n=new ArrayBuffer(0),i=function(t,e,r,i){this.gl=t,this.buffer=t.createBuffer(),this.type=e||t.ARRAY_BUFFER,this.drawType=i||t.STATIC_DRAW,this.data=n,r&&this.upload(r),this._updateID=0};i.prototype.upload=function(t,e,r){r||this.bind();var n=this.gl;t=t||this.data,e=e||0,this.data.byteLength>=t.byteLength?n.bufferSubData(this.type,e,t):n.bufferData(this.type,t,this.drawType),this.data=t},i.prototype.bind=function(){this.gl.bindBuffer(this.type,this.buffer)},i.createVertexBuffer=function(t,e,r){return new i(t,t.ARRAY_BUFFER,e,r)},i.createIndexBuffer=function(t,e,r){return new i(t,t.ELEMENT_ARRAY_BUFFER,e,r)},i.create=function(t,e,r,n){return new i(t,e,r,n)},i.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)},e.exports=i},{}],10:[function(t,e,r){var n=t("./GLTexture"),i=function(t,e,r){this.gl=t,this.framebuffer=t.createFramebuffer(),this.stencil=null,this.texture=null,this.width=e||100,this.height=r||100};i.prototype.enableTexture=function(t){var e=this.gl;this.texture=t||new n(e),this.texture.bind(),this.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture.texture,0)},i.prototype.enableStencil=function(){if(!this.stencil){var t=this.gl;this.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencil),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height)}},i.prototype.clear=function(t,e,r,n){this.bind();var i=this.gl;i.clearColor(t,e,r,n),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT)},i.prototype.bind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer)},i.prototype.unbind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)},i.prototype.resize=function(t,e){var r=this.gl;this.width=t,this.height=e,this.texture&&this.texture.uploadData(null,t,e),this.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,this.stencil),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t,e))},i.prototype.destroy=function(){var t=this.gl;this.texture&&this.texture.destroy(),t.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null},i.createRGBA=function(t,e,r,o){var s=n.fromData(t,null,e,r);s.enableNearestScaling(),s.enableWrapClamp();var a=new i(t,e,r);return a.enableTexture(s),a.unbind(),a},i.createFloat32=function(t,e,r,o){var s=new n.fromData(t,o,e,r);s.enableNearestScaling(),s.enableWrapClamp();var a=new i(t,e,r);return a.enableTexture(s),a.unbind(),a},e.exports=i},{"./GLTexture":12}],11:[function(t,e,r){var n=t("./shader/compileProgram"),i=t("./shader/extractAttributes"),o=t("./shader/extractUniforms"),s=t("./shader/setPrecision"),a=t("./shader/generateUniformAccessObject"),u=function(t,e,r,u,h){this.gl=t,u&&(e=s(e,u),r=s(r,u)),this.program=n(t,e,r,h),this.attributes=i(t,this.program),this.uniformData=o(t,this.program),this.uniforms=a(t,this.uniformData)};u.prototype.bind=function(){return this.gl.useProgram(this.program),this},u.prototype.destroy=function(){this.attributes=null,this.uniformData=null,this.uniforms=null,this.gl.deleteProgram(this.program)},e.exports=u},{"./shader/compileProgram":17,"./shader/extractAttributes":19,"./shader/extractUniforms":20,"./shader/generateUniformAccessObject":21,"./shader/setPrecision":25}],12:[function(t,e,r){var n=function(t,e,r,n,i){this.gl=t,this.texture=t.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=e||-1,this.height=r||-1,this.format=n||t.RGBA,this.type=i||t.UNSIGNED_BYTE};n.prototype.upload=function(t){this.bind();var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var r=t.videoWidth||t.width,n=t.videoHeight||t.height;n!==this.height||r!==this.width?e.texImage2D(e.TEXTURE_2D,0,this.format,this.format,this.type,t):e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.format,this.type,t),this.width=r,this.height=n};var i=!1;n.prototype.uploadData=function(t,e,r){this.bind();var n=this.gl;if(t instanceof Float32Array){if(!i){if(!n.getExtension("OES_texture_float"))throw new Error("floating point textures not available");i=!0}this.type=n.FLOAT}else this.type=this.type||n.UNSIGNED_BYTE;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),e!==this.width||r!==this.height?n.texImage2D(n.TEXTURE_2D,0,this.format,e,r,0,this.format,this.type,t||null):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e,r,this.format,this.type,t||null),this.width=e,this.height=r},n.prototype.bind=function(t){var e=this.gl;void 0!==t&&e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)},n.prototype.unbind=function(){var t=this.gl;t.bindTexture(t.TEXTURE_2D,null)},n.prototype.minFilter=function(t){var e=this.gl;this.bind(),this.mipmap?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR:e.NEAREST)},n.prototype.magFilter=function(t){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t?e.LINEAR:e.NEAREST)},n.prototype.enableMipmap=function(){var t=this.gl;this.bind(),this.mipmap=!0,t.generateMipmap(t.TEXTURE_2D)},n.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)},n.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)},n.prototype.enableWrapClamp=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)},n.prototype.enableWrapRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)},n.prototype.enableWrapMirrorRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.MIRRORED_REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.MIRRORED_REPEAT)},n.prototype.destroy=function(){this.gl.deleteTexture(this.texture)},n.fromSource=function(t,e,r){var i=new n(t);return i.premultiplyAlpha=r||!1,i.upload(e),i},n.fromData=function(t,e,r,i){var o=new n(t);return o.uploadData(e,r,i),o},e.exports=n},{}],13:[function(t,e,r){function n(t,e){if(this.nativeVaoExtension=null,n.FORCE_NATIVE||(this.nativeVaoExtension=t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object")),this.nativeState=e,this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var r=t.getParameter(t.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(r),attribState:new Array(r)}}this.gl=t,this.attributes=[],this.indexBuffer=null,this.dirty=!1}var i=t("./setVertexAttribArrays");n.prototype.constructor=n,e.exports=n,n.FORCE_NATIVE=!1,n.prototype.bind=function(){if(this.nativeVao){if(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty)return this.dirty=!1,this.activate(),this;this.indexBuffer&&this.indexBuffer.bind()}else this.activate();return this},n.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this},n.prototype.activate=function(){for(var t=this.gl,e=null,r=0;r<this.attributes.length;r++){var n=this.attributes[r];e!==n.buffer&&(n.buffer.bind(),e=n.buffer),t.vertexAttribPointer(n.attribute.location,n.attribute.size,n.type||t.FLOAT,n.normalized||!1,n.stride||0,n.start||0)}return i(t,this.attributes,this.nativeState),this.indexBuffer&&this.indexBuffer.bind(),this},n.prototype.addAttribute=function(t,e,r,n,i,o){return this.attributes.push({buffer:t,attribute:e,location:e.location,type:r||this.gl.FLOAT,normalized:n||!1,stride:i||0,start:o||0}),this.dirty=!0,this},n.prototype.addIndex=function(t){return this.indexBuffer=t,this.dirty=!0,this},n.prototype.clear=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this},n.prototype.draw=function(t,e,r){var n=this.gl;return this.indexBuffer?n.drawElements(t,e||this.indexBuffer.data.length,n.UNSIGNED_SHORT,2*(r||0)):n.drawArrays(t,r,e||this.getSize()),this},n.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null},n.prototype.getSize=function(){var t=this.attributes[0];return t.buffer.data.length/(t.stride/4||t.attribute.size)}},{"./setVertexAttribArrays":16}],14:[function(t,e,r){e.exports=function(t,e){var r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);if(!r)throw new Error("This browser does not support webGL. Try using the canvas renderer");return r}},{}],15:[function(t,e,r){var n={createContext:t("./createContext"),setVertexAttribArrays:t("./setVertexAttribArrays"),GLBuffer:t("./GLBuffer"),GLFramebuffer:t("./GLFramebuffer"),GLShader:t("./GLShader"),GLTexture:t("./GLTexture"),VertexArrayObject:t("./VertexArrayObject"),shader:t("./shader")};void 0!==e&&e.exports&&(e.exports=n),"undefined"!=typeof window&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=n)},{"./GLBuffer":9,"./GLFramebuffer":10,"./GLShader":11,"./GLTexture":12,"./VertexArrayObject":13,"./createContext":14,"./setVertexAttribArrays":16,"./shader":22}],16:[function(t,e,r){e.exports=function(t,e,r){var n;if(r){var i=r.tempAttribState,o=r.attribState;for(n=0;n<i.length;n++)i[n]=!1;for(n=0;n<e.length;n++)i[e[n].attribute.location]=!0;for(n=0;n<o.length;n++)o[n]!==i[n]&&(o[n]=i[n],r.attribState[n]?t.enableVertexAttribArray(n):t.disableVertexAttribArray(n))}else for(n=0;n<e.length;n++){var s=e[n];t.enableVertexAttribArray(s.attribute.location)}}},{}],17:[function(t,e,r){var n=function(t,e,r){var n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(console.log(t.getShaderInfoLog(n)),null)};e.exports=function(t,e,r,i){var o=n(t,t.VERTEX_SHADER,e),s=n(t,t.FRAGMENT_SHADER,r),a=t.createProgram();if(t.attachShader(a,o),t.attachShader(a,s),i)for(var u in i)t.bindAttribLocation(a,i[u],u);return t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(a,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(a)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(a)),t.deleteProgram(a),a=null),t.deleteShader(o),t.deleteShader(s),a}},{}],18:[function(t,e,r){var n=function(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e};e.exports=function(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return n(2*e);case"bvec3":return n(3*e);case"bvec4":return n(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}}},{}],19:[function(t,e,r){var n=t("./mapType"),i=t("./mapSize"),o=function(t,e,r,n){gl.vertexAttribPointer(this.location,this.size,t||gl.FLOAT,e||!1,r||0,n||0)};e.exports=function(t,e){for(var r={},s=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),a=0;a<s;a++){var u=t.getActiveAttrib(e,a),h=n(t,u.type);r[u.name]={type:h,size:i(h),location:t.getAttribLocation(e,u.name),pointer:o}}return r}},{"./mapSize":23,"./mapType":24}],20:[function(t,e,r){var n=t("./mapType"),i=t("./defaultValue");e.exports=function(t,e){for(var r={},o=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),s=0;s<o;s++){var a=t.getActiveUniform(e,s),u=a.name.replace(/\[.*?\]/,""),h=n(t,a.type);r[u]={type:h,size:a.size,location:t.getUniformLocation(e,u),value:i(h,a.size)}}return r}},{"./defaultValue":18,"./mapType":24}],21:[function(t,e,r){function n(t,e){return function(r){this.data[t].value=r;var n=this.data[t].location;1===e.size?s[e.type](this.gl,n,r):a[e.type](this.gl,n,r)}}function i(t,e){for(var r=e,n=0;n<t.length-1;n++){var i=r[t[n]]||{data:{}};r[t[n]]=i,r=i}return r}var o=function(t){return function(){return this.data[t].value}},s={float:function(t,e,r){t.uniform1f(e,r)},vec2:function(t,e,r){t.uniform2f(e,r[0],r[1])},vec3:function(t,e,r){t.uniform3f(e,r[0],r[1],r[2])},vec4:function(t,e,r){t.uniform4f(e,r[0],r[1],r[2],r[3])},int:function(t,e,r){t.uniform1i(e,r)},ivec2:function(t,e,r){t.uniform2i(e,r[0],r[1])},ivec3:function(t,e,r){t.uniform3i(e,r[0],r[1],r[2])},ivec4:function(t,e,r){t.uniform4i(e,r[0],r[1],r[2],r[3])},bool:function(t,e,r){t.uniform1i(e,r)},bvec2:function(t,e,r){t.uniform2i(e,r[0],r[1])},bvec3:function(t,e,r){t.uniform3i(e,r[0],r[1],r[2])},bvec4:function(t,e,r){t.uniform4i(e,r[0],r[1],r[2],r[3])},mat2:function(t,e,r){t.uniformMatrix2fv(e,!1,r)},mat3:function(t,e,r){t.uniformMatrix3fv(e,!1,r)},mat4:function(t,e,r){t.uniformMatrix4fv(e,!1,r)},sampler2D:function(t,e,r){t.uniform1i(e,r)}},a={float:function(t,e,r){t.uniform1fv(e,r)},vec2:function(t,e,r){t.uniform2fv(e,r)},vec3:function(t,e,r){t.uniform3fv(e,r)},vec4:function(t,e,r){t.uniform4fv(e,r)},int:function(t,e,r){t.uniform1iv(e,r)},ivec2:function(t,e,r){t.uniform2iv(e,r)},ivec3:function(t,e,r){t.uniform3iv(e,r)},ivec4:function(t,e,r){t.uniform4iv(e,r)},bool:function(t,e,r){t.uniform1iv(e,r)},bvec2:function(t,e,r){t.uniform2iv(e,r)},bvec3:function(t,e,r){t.uniform3iv(e,r)},bvec4:function(t,e,r){t.uniform4iv(e,r)},sampler2D:function(t,e,r){t.uniform1iv(e,r)}};e.exports=function(t,e){var r={data:{}};r.gl=t;for(var s=Object.keys(e),a=0;a<s.length;a++){var u=s[a],h=u.split("."),l=h[h.length-1],c=i(h,r),d=e[u];c.data[l]=d,c.gl=t,Object.defineProperty(c,l,{get:o(l),set:n(l,d)})}return r}},{}],22:[function(t,e,r){e.exports={compileProgram:t("./compileProgram"),defaultValue:t("./defaultValue"),extractAttributes:t("./extractAttributes"),extractUniforms:t("./extractUniforms"),generateUniformAccessObject:t("./generateUniformAccessObject"),setPrecision:t("./setPrecision"),mapSize:t("./mapSize"),mapType:t("./mapType")}},{"./compileProgram":17,"./defaultValue":18,"./extractAttributes":19,"./extractUniforms":20,"./generateUniformAccessObject":21,"./mapSize":23,"./mapType":24,"./setPrecision":25}],23:[function(t,e,r){var n={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};e.exports=function(t){return n[t]}},{}],24:[function(t,e,r){var n=null,i={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};e.exports=function(t,e){if(!n){var r=Object.keys(i);n={};for(var o=0;o<r.length;++o){var s=r[o];n[t[s]]=i[s]}}return n[e]}},{}],25:[function(t,e,r){e.exports=function(t,e){return"precision"!==t.substring(0,9)?"precision "+e+" float;\n"+t:t}},{}],26:[function(t,e,r){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function s(){v&&f&&(v=!1,f.length?p=f.concat(p):g=-1,p.length&&a())}function a(){if(!v){var t=o(s);v=!0;for(var e=p.length;e;){for(f=p,p=[];++g<e;)f&&f[g].run();g=-1,e=p.length}f=null,v=!1,function(t){if(c===clearTimeout)return clearTimeout(t);if((c===i||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}(t)}}function u(t,e){this.fun=t,this.array=e}function h(){}var l,c,d=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(t){l=n}try{c="function"==typeof clearTimeout?clearTimeout:i}catch(t){c=i}}();var f,p=[],v=!1,g=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];p.push(new u(t,e)),1!==p.length||v||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=h,d.addListener=h,d.once=h,d.off=h,d.removeListener=h,d.removeAllListeners=h,d.emit=h,d.prependListener=h,d.prependOnceListener=h,d.listeners=function(t){return[]},d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],27:[function(t,e,r){(function(t){!function(n){function i(t){throw new RangeError(A[t])}function o(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function s(t,e){var r=t.split("@"),n="";return r.length>1&&(n=r[0]+"@",t=r[1]),n+o((t=t.replace(R,".")).split("."),e).join(".")}function a(t){for(var e,r,n=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(r=t.charCodeAt(i++)))?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),i--):n.push(e);return n}function u(t){return o(t,function(t){var e="";return t>65535&&(e+=L((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+L(t)}).join("")}function h(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:b}function l(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function c(t,e,r){var n=0;for(t=r?D(t/E):t>>1,t+=D(t/e);t>I*T>>1;n+=b)t=D(t/I);return D(n+(I+1)*t/(t+w))}function d(t){var e,r,n,o,s,a,l,d,f,p,v=[],g=t.length,y=0,m=O,w=S;for((r=t.lastIndexOf(M))<0&&(r=0),n=0;n<r;++n)t.charCodeAt(n)>=128&&i("not-basic"),v.push(t.charCodeAt(n));for(o=r>0?r+1:0;o<g;){for(s=y,a=1,l=b;o>=g&&i("invalid-input"),((d=h(t.charCodeAt(o++)))>=b||d>D((_-y)/a))&&i("overflow"),y+=d*a,!(d<(f=l<=w?x:l>=w+T?T:l-w));l+=b)a>D(_/(p=b-f))&&i("overflow"),a*=p;w=c(y-s,e=v.length+1,0==s),D(y/e)>_-m&&i("overflow"),m+=D(y/e),y%=e,v.splice(y++,0,m)}return u(v)}function f(t){var e,r,n,o,s,u,h,d,f,p,v,g,y,m,w,E=[];for(g=(t=a(t)).length,e=O,r=0,s=S,u=0;u<g;++u)(v=t[u])<128&&E.push(L(v));for(n=o=E.length,o&&E.push(M);n<g;){for(h=_,u=0;u<g;++u)(v=t[u])>=e&&v<h&&(h=v);for(h-e>D((_-r)/(y=n+1))&&i("overflow"),r+=(h-e)*y,e=h,u=0;u<g;++u)if((v=t[u])<e&&++r>_&&i("overflow"),v==e){for(d=r,f=b;!(d<(p=f<=s?x:f>=s+T?T:f-s));f+=b)w=d-p,m=b-p,E.push(L(l(p+w%m,0))),d=D(w/m);E.push(L(l(d,0))),s=c(r,y,n==o),r=0,++n}++r,++e}return E.join("")}var p="object"==typeof r&&r&&!r.nodeType&&r,v="object"==typeof e&&e&&!e.nodeType&&e,g="object"==typeof t&&t;g.global!==g&&g.window!==g&&g.self!==g||(n=g);var y,m,_=2147483647,b=36,x=1,T=26,w=38,E=700,S=72,O=128,M="-",P=/^xn--/,C=/[^\x20-\x7E]/,R=/[\x2E\u3002\uFF0E\uFF61]/g,A={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=b-x,D=Math.floor,L=String.fromCharCode;if(y={version:"1.4.1",ucs2:{decode:a,encode:u},decode:d,encode:f,toASCII:function(t){return s(t,function(t){return C.test(t)?"xn--"+f(t):t})},toUnicode:function(t){return s(t,function(t){return P.test(t)?d(t.slice(4).toLowerCase()):t})}},p&&v)if(e.exports==p)v.exports=y;else for(m in y)y.hasOwnProperty(m)&&(p[m]=y[m]);else n.punycode=y}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],28:[function(t,e,r){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,r,o){e=e||"&",r=r||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var h=t.length;u>0&&h>u&&(h=u);for(var l=0;l<h;++l){var c,d,f,p,v=t[l].replace(a,"%20"),g=v.indexOf(r);g>=0?(c=v.substr(0,g),d=v.substr(g+1)):(c=v,d=""),f=decodeURIComponent(c),p=decodeURIComponent(d),n(s,f)?i(s[f])?s[f].push(p):s[f]=[s[f],p]:s[f]=p}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],29:[function(t,e,r){"use strict";function n(t,e){if(t.map)return t.map(e);for(var r=[],n=0;n<t.length;n++)r.push(e(t[n],n));return r}var i=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,r,a){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?n(s(t),function(s){var a=encodeURIComponent(i(s))+r;return o(t[s])?n(t[s],function(t){return a+encodeURIComponent(i(t))}).join(e):a+encodeURIComponent(i(t[s]))}).join(e):a?encodeURIComponent(i(a))+r+encodeURIComponent(i(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},{}],30:[function(t,e,r){"use strict";r.decode=r.parse=t("./decode"),r.encode=r.stringify=t("./encode")},{"./decode":28,"./encode":29}],31:[function(t,e,r){"use strict";e.exports=function(t,e,r){var n,i=t.length;if(!(e>=i||0===r)){var o=i-(r=e+r>i?i-e:r);for(n=e;n<o;++n)t[n]=t[n+r];t.length=o}}},{}],32:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=n(t("mini-signals")),a=n(t("parse-uri")),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("./async")),h=n(t("./Resource")),l=/(#[\w-]+)?$/,c=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.baseUrl=r,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,r){return e._loadResource(t,r)},this._queue=u.queue(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new s.default,this.onError=new s.default,this.onLoad=new s.default,this.onStart=new s.default,this.onComplete=new s.default}return t.prototype.add=function(t,e,r,n){if(Array.isArray(t)){for(var o=0;o<t.length;++o)this.add(t[o]);return this}if("object"===(void 0===t?"undefined":i(t))&&(n=e||t.callback||t.onComplete,r=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(n=r,r=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof r&&(n=r,r=null),this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new h.default(t,e,r),"function"==typeof n&&this.resources[t].onAfterMiddleware.once(n),this.loading){for(var s=r.parentResource,a=[],u=0;u<s.children.length;++u)s.children[u].isComplete||a.push(s.children[u]);var l=s.progressChunk*(a.length+1)/(a.length+2);s.children.push(this.resources[t]),s.progressChunk=l;for(var c=0;c<a.length;++c)a[c].progressChunk=l;this.resources[t].progressChunk=l}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},t.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,r=0;r<this._queue._tasks.length;++r)this._queue._tasks[r].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},t.prototype._prepareUrl=function(t){var e=(0,a.default)(t,{strictMode:!0}),r=void 0;if(r=e.protocol||!e.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var n=l.exec(r)[0];-1!==(r=r.substr(0,r.length-n.length)).indexOf("?")?r+="&"+this.defaultQueryString:r+="?"+this.defaultQueryString,r+=n}return r},t.prototype._loadResource=function(t,e){var r=this;t._dequeue=e,u.eachSeries(this._beforeMiddleware,function(e,n){e.call(r,t,function(){n(t.isComplete?{}:null)})},function(){t.isComplete?r._onLoad(t):(t._onLoadBinding=t.onComplete.once(r._onLoad,r),t.load())},!0)},t.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),u.eachSeries(this._afterMiddleware,function(r,n){r.call(e,t,n)},function(){t.onAfterMiddleware.dispatch(t),e.progress+=t.progressChunk,e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()},!0)},o(t,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),t}();r.default=c},{"./Resource":33,"./async":34,"mini-signals":5,"parse-uri":7}],33:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(){}function o(t,e,r){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=r)}function s(t){return t.toString().replace("object ","")}r.__esModule=!0;var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=n(t("parse-uri")),h=n(t("mini-signals")),l=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),c=null,d=function(){function t(e,r,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"!=typeof e||"string"!=typeof r)throw new Error("Both name and url are required for constructing a resource.");n=n||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===r.indexOf("data:")),this.name=e,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===n.crossOrigin?"anonymous":n.crossOrigin,this.loadType=n.loadType||this._determineLoadType(),this.xhrType=n.xhrType,this.metadata=n.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=i,this._onLoadBinding=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this),this.onStart=new h.default,this.onProgress=new h.default,this.onComplete=new h.default,this.onAfterMiddleware=new h.default}return t.setExtensionLoadType=function(e,r){o(t._loadTypeMap,e,r)},t.setExtensionXhrType=function(e,r){o(t._xhrTypeMap,e,r)},t.prototype.complete=function(){if(this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this.complete()}},t.prototype.load=function(e){var r=this;if(!this.isLoading){if(this.isComplete)return void(e&&setTimeout(function(){return e(r)},1));switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:l&&this.crossOrigin?this._loadXdr():this._loadXhr()}}},t.prototype._hasFlag=function(t){return!!(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(t,this.url[r],Array.isArray(e)?e[r]:e));else{var n=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(n)?n[0]:n))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXdrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},t.prototype._createSource=function(t,e,r){r||(r=t+"/"+this._getExtension(e));var n=document.createElement("source");return n.src=e,n.type=r,n},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(s(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnAbort=function(){this.abort(s(this.xhr)+" Request was aborted by the user.")},t.prototype._xdrOnTimeout=function(){this.abort(s(this.xhr)+" Request timed out.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,r="",n=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(r=e.responseText),0===n&&(r.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?n=200:1223===n&&(n=204),2==(n/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var i=new DOMParser;this.data=i.parseFromString(r,"text/xml")}else{var o=document.createElement("div");o.innerHTML=r,this.data=o}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||r;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";e=e||window.location,c||(c=document.createElement("a")),c.href=t;var r=!(t=(0,u.default)(c.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,n=t.protocol?t.protocol+":":"";return t.host===e.hostname&&r&&n===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var r=t.indexOf("/");e=t.substring(r+1,t.indexOf(";",r))}else{var n=t.indexOf("?"),i=t.indexOf("#"),o=Math.min(n>-1?n:t.length,i>-1?i:t.length);e=(t=t.substring(0,o)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},a(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();r.default=d,d.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},d.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},d.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},d.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},d._loadTypeMap={gif:d.LOAD_TYPE.IMAGE,png:d.LOAD_TYPE.IMAGE,bmp:d.LOAD_TYPE.IMAGE,jpg:d.LOAD_TYPE.IMAGE,jpeg:d.LOAD_TYPE.IMAGE,tif:d.LOAD_TYPE.IMAGE,tiff:d.LOAD_TYPE.IMAGE,webp:d.LOAD_TYPE.IMAGE,tga:d.LOAD_TYPE.IMAGE,svg:d.LOAD_TYPE.IMAGE,"svg+xml":d.LOAD_TYPE.IMAGE,mp3:d.LOAD_TYPE.AUDIO,ogg:d.LOAD_TYPE.AUDIO,wav:d.LOAD_TYPE.AUDIO,mp4:d.LOAD_TYPE.VIDEO,webm:d.LOAD_TYPE.VIDEO},d._xhrTypeMap={xhtml:d.XHR_RESPONSE_TYPE.DOCUMENT,html:d.XHR_RESPONSE_TYPE.DOCUMENT,htm:d.XHR_RESPONSE_TYPE.DOCUMENT,xml:d.XHR_RESPONSE_TYPE.DOCUMENT,tmx:d.XHR_RESPONSE_TYPE.DOCUMENT,svg:d.XHR_RESPONSE_TYPE.DOCUMENT,tsx:d.XHR_RESPONSE_TYPE.DOCUMENT,gif:d.XHR_RESPONSE_TYPE.BLOB,png:d.XHR_RESPONSE_TYPE.BLOB,bmp:d.XHR_RESPONSE_TYPE.BLOB,jpg:d.XHR_RESPONSE_TYPE.BLOB,jpeg:d.XHR_RESPONSE_TYPE.BLOB,tif:d.XHR_RESPONSE_TYPE.BLOB,tiff:d.XHR_RESPONSE_TYPE.BLOB,webp:d.XHR_RESPONSE_TYPE.BLOB,tga:d.XHR_RESPONSE_TYPE.BLOB,json:d.XHR_RESPONSE_TYPE.JSON,text:d.XHR_RESPONSE_TYPE.TEXT,txt:d.XHR_RESPONSE_TYPE.TEXT,ttf:d.XHR_RESPONSE_TYPE.BUFFER,otf:d.XHR_RESPONSE_TYPE.BUFFER},d.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},{"mini-signals":5,"parse-uri":7}],34:[function(t,e,r){"use strict";function n(){}function i(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}r.__esModule=!0,r.eachSeries=function(t,e,r,n){var i=0,o=t.length;!function s(a){a||i===o?r&&r(a):n?setTimeout(function(){e(t[i++],s)},1):e(t[i++],s)}()},r.queue=function(t,e){function r(t,e,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(a.started=!0,null==t&&a.idle())setTimeout(function(){return a.drain()},1);else{var i={data:t,callback:"function"==typeof r?r:n};e?a._tasks.unshift(i):a._tasks.push(i),setTimeout(function(){return a.process()},1)}}function o(t){return function(){s-=1,t.callback.apply(t,arguments),null!=arguments[0]&&a.error(arguments[0],t.data),s<=a.concurrency-a.buffer&&a.unsaturated(),a.idle()&&a.drain(),a.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var s=0,a={_tasks:[],concurrency:e,saturated:n,unsaturated:n,buffer:e/4,empty:n,drain:n,error:n,started:!1,paused:!1,push:function(t,e){r(t,!1,e)},kill:function(){s=0,a.drain=n,a.started=!1,a._tasks=[]},unshift:function(t,e){r(t,!0,e)},process:function(){for(;!a.paused&&s<a.concurrency&&a._tasks.length;){var e=a._tasks.shift();0===a._tasks.length&&a.empty(),(s+=1)===a.concurrency&&a.saturated(),t(e.data,i(o(e)))}},length:function(){return a._tasks.length},running:function(){return s},idle:function(){return a._tasks.length+s===0},pause:function(){!0!==a.paused&&(a.paused=!0)},resume:function(){if(!1!==a.paused){a.paused=!1;for(var t=1;t<=a.concurrency;t++)a.process()}}};return a}},{}],35:[function(t,e,r){"use strict";r.__esModule=!0,r.encodeBinary=function(t){for(var e="",r=0;r<t.length;){for(var i=[0,0,0],o=[0,0,0,0],s=0;s<i.length;++s)r<t.length?i[s]=255&t.charCodeAt(r++):i[s]=0;switch(o[0]=i[0]>>2,o[1]=(3&i[0])<<4|i[1]>>4,o[2]=(15&i[1])<<2|i[2]>>6,o[3]=63&i[2],r-(t.length-1)){case 2:o[3]=64,o[2]=64;break;case 1:o[3]=64}for(var a=0;a<o.length;++a)e+=n.charAt(o[a])}return e};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},{}],36:[function(t,e,r){"use strict";var n=t("./Loader").default,i=t("./Resource").default,o=t("./async"),s=t("./b64");n.Resource=i,n.async=o,n.base64=s,e.exports=n,e.exports.default=n},{"./Loader":32,"./Resource":33,"./async":34,"./b64":35}],37:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};r.blobMiddlewareFactory=function(){return function(t,e){if(t.data){if(t.xhr&&t.xhrType===o.default.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var r=function(){var r=a.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=r,t.type=o.default.TYPE.IMAGE,t.data.onload=function(){a.revokeObjectURL(r),t.data.onload=null,e()},{v:void 0}}();if("object"===(void 0===r?"undefined":i(r)))return r.v}}else{var n=t.xhr.getResponseHeader("content-type");if(n&&0===n.indexOf("image"))return t.data=new Image,t.data.src="data:"+n+";base64,"+s.default.encodeBinary(t.xhr.responseText),t.type=o.default.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}};var o=n(t("../../Resource")),s=n(t("../../b64")),a=window.URL||window.webkitURL},{"../../Resource":33,"../../b64":35}],38:[function(t,e,r){"use strict";function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(t,e,r){if(t&&s.isObject(t)&&t instanceof n)return t;var i=new n;return i.parse(t,e,r),i}var o=t("punycode"),s=t("./util");r.parse=i,r.resolve=function(t,e){return i(t,!1,!0).resolve(e)},r.resolveObject=function(t,e){return t?i(t,!1,!0).resolveObject(e):e},r.format=function(t){return s.isString(t)&&(t=i(t)),t instanceof n?t.format():n.prototype.format.call(t)},r.Url=n;var a=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),c=["'"].concat(l),d=["%","/","?",";","#"].concat(c),f=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,v=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},_=t("querystring");n.prototype.parse=function(t,e,r){if(!s.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=-1!==n&&n<t.indexOf("#")?"?":"#",u=t.split(i);u[0]=u[0].replace(/\\/g,"/");var l=t=u.join(i);if(l=l.trim(),!r&&1===t.split("#").length){var b=h.exec(l);if(b)return this.path=l,this.href=l,this.pathname=b[1],b[2]?(this.search=b[2],this.query=e?_.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var x=a.exec(l);if(x){var T=(x=x[0]).toLowerCase();this.protocol=T,l=l.substr(x.length)}if(r||x||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var w="//"===l.substr(0,2);!w||x&&y[x]||(l=l.substr(2),this.slashes=!0)}if(!y[x]&&(w||x&&!m[x])){for(var E=-1,S=0;S<f.length;S++){-1!==(P=l.indexOf(f[S]))&&(-1===E||P<E)&&(E=P)}var O,M;-1!==(M=-1===E?l.lastIndexOf("@"):l.lastIndexOf("@",E))&&(O=l.slice(0,M),l=l.slice(M+1),this.auth=decodeURIComponent(O)),E=-1;for(S=0;S<d.length;S++){var P;-1!==(P=l.indexOf(d[S]))&&(-1===E||P<E)&&(E=P)}-1===E&&(E=l.length),this.host=l.slice(0,E),l=l.slice(E),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var R=this.hostname.split(/\./),A=(S=0,R.length);S<A;S++){var I=R[S];if(I&&!I.match(p)){for(var D="",L=0,N=I.length;L<N;L++)I.charCodeAt(L)>127?D+="x":D+=I[L];if(!D.match(p)){var B=R.slice(0,S),F=R.slice(S+1),k=I.match(v);k&&(B.push(k[1]),F.unshift(k[2])),F.length&&(l="/"+F.join(".")+l),this.hostname=B.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=o.toASCII(this.hostname));var j=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+j,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==l[0]&&(l="/"+l))}if(!g[T])for(S=0,A=c.length;S<A;S++){var X=c[S];if(-1!==l.indexOf(X)){var G=encodeURIComponent(X);G===X&&(G=escape(X)),l=l.split(X).join(G)}}var W=l.indexOf("#");-1!==W&&(this.hash=l.substr(W),l=l.slice(0,W));var H=l.indexOf("?");if(-1!==H?(this.search=l.substr(H),this.query=l.substr(H+1),e&&(this.query=_.parse(this.query)),l=l.slice(0,H)):e&&(this.search="",this.query={}),l&&(this.pathname=l),m[T]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){j=this.pathname||"";var V=this.search||"";this.path=j+V}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&s.isObject(this.query)&&Object.keys(this.query).length&&(o=_.stringify(this.query));var a=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||m[e])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),e+i+(r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(a=a.replace("#","%23"))+n},n.prototype.resolve=function(t){return this.resolveObject(i(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(s.isString(t)){var e=new n;e.parse(t,!1,!0),t=e}for(var r=new n,i=Object.keys(this),o=0;o<i.length;o++){var a=i[o];r[a]=this[a]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var u=Object.keys(t),h=0;h<u.length;h++){var l=u[h];"protocol"!==l&&(r[l]=t[l])}return m[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!m[t.protocol]){for(var c=Object.keys(t),d=0;d<c.length;d++){var f=c[d];r[f]=t[f]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||y[t.protocol])r.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),r.pathname=p.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var v=r.pathname||"",g=r.search||"";r.path=v+g}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var _=r.pathname&&"/"===r.pathname.charAt(0),b=t.host||t.pathname&&"/"===t.pathname.charAt(0),x=b||_||r.host&&t.pathname,T=x,w=r.pathname&&r.pathname.split("/")||[],E=(p=t.pathname&&t.pathname.split("/")||[],r.protocol&&!m[r.protocol]);if(E&&(r.hostname="",r.port=null,r.host&&(""===w[0]?w[0]=r.host:w.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),x=x&&(""===p[0]||""===w[0])),b)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,w=p;else if(p.length)w||(w=[]),w.pop(),w=w.concat(p),r.search=t.search,r.query=t.query;else if(!s.isNullOrUndefined(t.search)){if(E)r.hostname=r.host=w.shift(),(C=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=C.shift(),r.host=r.hostname=C.shift());return r.search=t.search,r.query=t.query,s.isNull(r.pathname)&&s.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!w.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var S=w.slice(-1)[0],O=(r.host||t.host||w.length>1)&&("."===S||".."===S)||""===S,M=0,P=w.length;P>=0;P--)"."===(S=w[P])?w.splice(P,1):".."===S?(w.splice(P,1),M++):M&&(w.splice(P,1),M--);if(!x&&!T)for(;M--;M)w.unshift("..");!x||""===w[0]||w[0]&&"/"===w[0].charAt(0)||w.unshift(""),O&&"/"!==w.join("/").substr(-1)&&w.push("");var C,R=""===w[0]||w[0]&&"/"===w[0].charAt(0);E&&(r.hostname=r.host=R?"":w.length?w.shift():"",(C=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=C.shift(),r.host=r.hostname=C.shift()));return(x=x||r.host&&w.length)&&!R&&w.unshift(""),w.length?r.pathname=w.join("/"):(r.pathname=null,r.path=null),s.isNull(r.pathname)&&s.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var t=this.host,e=u.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":39,punycode:27,querystring:30}],39:[function(t,e,r){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],40:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),o=n(t("ismobilejs")),s=n(t("./accessibleTarget"));i.utils.mixins.delayMixin(i.DisplayObject.prototype,s.default);var a=100,u=0,h=0,l=2,c=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),!o.default.tablet&&!o.default.phone||navigator.isCocoonJS||this.createTouchHook();var r=document.createElement("div");r.style.width=a+"px",r.style.height=a+"px",r.style.position="absolute",r.style.top=u+"px",r.style.left=h+"px",r.style.zIndex=l,this.div=r,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=e,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessabillity=!1,window.addEventListener("keydown",this._onKeyDown,!1)}return t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2,e.style.backgroundColor="#FF0000",e.title="HOOK DIV",e.addEventListener("focus",function(){t.isMobileAccessabillity=!0,t.activate(),document.body.removeChild(e)}),document.body.appendChild(e)},t.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},t.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessabillity&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},t.prototype.updateAccessibleObjects=function(t){if(t.visible){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,r=0;r<e.length;r++)this.updateAccessibleObjects(e[r])}},t.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),e=t.width/this.renderer.width,r=t.height/this.renderer.height,n=this.div;n.style.left=t.left+"px",n.style.top=t.top+"px",n.style.width=this.renderer.width+"px",n.style.height=this.renderer.height+"px";for(var o=0;o<this.children.length;o++){var s=this.children[o];if(s.renderId!==this.renderId)s._accessibleActive=!1,i.utils.removeItems(this.children,o,1),this.div.removeChild(s._accessibleDiv),this.pool.push(s._accessibleDiv),s._accessibleDiv=null,o--,0===this.children.length&&this.deactivate();else{n=s._accessibleDiv;var a=s.hitArea,u=s.worldTransform;s.hitArea?(n.style.left=(u.tx+a.x*u.a)*e+"px",n.style.top=(u.ty+a.y*u.d)*r+"px",n.style.width=a.width*u.a*e+"px",n.style.height=a.height*u.d*r+"px"):(a=s.getBounds(),this.capHitArea(a),n.style.left=a.x*e+"px",n.style.top=a.y*r+"px",n.style.width=a.width*e+"px",n.style.height=a.height*r+"px",n.title!==s.accessibleTitle&&null!==s.accessibleTitle&&(n.title=s.accessibleTitle),n.getAttribute("aria-label")!==s.accessibleHint&&null!==s.accessibleHint&&n.setAttribute("aria-label",s.accessibleHint))}}this.renderId++}},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},t.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width=a+"px",e.style.height=a+"px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=l,e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData)},t.prototype._onFocus=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},t.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},t.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},t.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},t.prototype.destroy=function(){this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},t}();r.default=c,i.WebGLRenderer.registerPlugin("accessibility",c),i.CanvasRenderer.registerPlugin("accessibility",c)},{"../core":65,"./accessibleTarget":41,ismobilejs:4}],41:[function(t,e,r){"use strict";r.__esModule=!0,r.default={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},{}],42:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./accessibleTarget");Object.defineProperty(r,"accessibleTarget",{enumerable:!0,get:function(){return n(i).default}});var o=t("./AccessibilityManager");Object.defineProperty(r,"AccessibilityManager",{enumerable:!0,get:function(){return n(o).default}})},{"./AccessibilityManager":40,"./accessibleTarget":41}],43:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("./autoDetectRenderer"),s=n(t("./display/Container")),a=t("./ticker"),u=n(t("./settings")),h=t("./const"),l=function(){function t(e,r,n,i,h){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),"number"==typeof e&&(e=Object.assign({width:e,height:r||u.default.RENDER_OPTIONS.height,forceCanvas:!!i,sharedTicker:!!h},n)),this._options=e=Object.assign({autoStart:!0,sharedTicker:!1,forceCanvas:!1,sharedLoader:!1},e),this.renderer=(0,o.autoDetectRenderer)(e),this.stage=new s.default,this._ticker=null,this.ticker=e.sharedTicker?a.shared:new a.Ticker,e.autoStart&&this.start()}return t.prototype.render=function(){this.renderer.render(this.stage)},t.prototype.stop=function(){this._ticker.stop()},t.prototype.start=function(){this._ticker.start()},t.prototype.destroy=function(t,e){if(this._ticker){var r=this._ticker;this.ticker=null,r.destroy()}this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null,this._options=null},i(t,[{key:"ticker",set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,h.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}},{key:"view",get:function(){return this.renderer.view}},{key:"screen",get:function(){return this.renderer.screen}}]),t}();r.default=l},{"./autoDetectRenderer":45,"./const":46,"./display/Container":48,"./settings":101,"./ticker":121}],44:[function(t,e,r){"use strict";function n(t,e){if(t instanceof Array){if("precision"!==t[0].substring(0,9)){var r=t.slice(0);return r.unshift("precision "+e+" float;"),r}}else if("precision"!==t.trim().substring(0,9))return"precision "+e+" float;\n"+t;return t}r.__esModule=!0;var i=t("pixi-gl-core"),o=function(t){return t&&t.__esModule?t:{default:t}}(t("./settings")),s=function(t){function e(r,i,s,a,u){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n(i,u||o.default.PRECISION_VERTEX),n(s,u||o.default.PRECISION_FRAGMENT),void 0,a))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(i.GLShader);r.default=s},{"./settings":101,"pixi-gl-core":15}],45:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.autoDetectRenderer=function(t,e,r,n){var a=t&&t.forceCanvas;return void 0!==n&&(a=n),!a&&i.isWebGLSupported()?new s.default(t,e,r):new o.default(t,e,r)};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("./utils")),o=n(t("./renderers/canvas/CanvasRenderer")),s=n(t("./renderers/webgl/WebGLRenderer"))},{"./renderers/canvas/CanvasRenderer":77,"./renderers/webgl/WebGLRenderer":84,"./utils":125}],46:[function(t,e,r){"use strict";r.__esModule=!0,r.VERSION="4.8.2",r.PI_2=2*Math.PI,r.RAD_TO_DEG=180/Math.PI,r.DEG_TO_RAD=Math.PI/180,r.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2},r.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19},r.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},r.SCALE_MODES={LINEAR:0,NEAREST:1},r.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2},r.GC_MODES={AUTO:0,MANUAL:1},r.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i,r.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i,r.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,r.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},r.PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"},r.TRANSFORM_MODE={STATIC:0,DYNAMIC:1},r.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},r.UPDATE_PRIORITY={INTERACTION:50,HIGH:25,NORMAL:0,LOW:-25,UTILITY:-50}},{}],47:[function(t,e,r){"use strict";r.__esModule=!0;var n=t("../math"),i=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?n.Rectangle.EMPTY:((t=t||new n.Rectangle(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addQuad=function(t){var e=this.minX,r=this.minY,n=this.maxX,i=this.maxY,o=t[0],s=t[1];e=o<e?o:e,r=s<r?s:r,n=o>n?o:n,i=s>i?s:i,e=(o=t[2])<e?o:e,r=(s=t[3])<r?s:r,n=o>n?o:n,i=s>i?s:i,e=(o=t[4])<e?o:e,r=(s=t[5])<r?s:r,n=o>n?o:n,i=s>i?s:i,e=(o=t[6])<e?o:e,r=(s=t[7])<r?s:r,n=o>n?o:n,i=s>i?s:i,this.minX=e,this.minY=r,this.maxX=n,this.maxY=i},t.prototype.addFrame=function(t,e,r,n,i){var o=t.worldTransform,s=o.a,a=o.b,u=o.c,h=o.d,l=o.tx,c=o.ty,d=this.minX,f=this.minY,p=this.maxX,v=this.maxY,g=s*e+u*r+l,y=a*e+h*r+c;d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,v=y>v?y:v,d=(g=s*n+u*r+l)<d?g:d,f=(y=a*n+h*r+c)<f?y:f,p=g>p?g:p,v=y>v?y:v,d=(g=s*e+u*i+l)<d?g:d,f=(y=a*e+h*i+c)<f?y:f,p=g>p?g:p,v=y>v?y:v,d=(g=s*n+u*i+l)<d?g:d,f=(y=a*n+h*i+c)<f?y:f,p=g>p?g:p,v=y>v?y:v,this.minX=d,this.minY=f,this.maxX=p,this.maxY=v},t.prototype.addVertices=function(t,e,r,n){for(var i=t.worldTransform,o=i.a,s=i.b,a=i.c,u=i.d,h=i.tx,l=i.ty,c=this.minX,d=this.minY,f=this.maxX,p=this.maxY,v=r;v<n;v+=2){var g=e[v],y=e[v+1],m=o*g+a*y+h,_=u*y+s*g+l;c=m<c?m:c,d=_<d?_:d,f=m>f?m:f,p=_>p?_:p}this.minX=c,this.minY=d,this.maxX=f,this.maxY=p},t.prototype.addBounds=function(t){var e=this.minX,r=this.minY,n=this.maxX,i=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>i?t.maxY:i},t.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,n=t.minY>e.minY?t.minY:e.minY,i=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=i&&n<=o){var s=this.minX,a=this.minY,u=this.maxX,h=this.maxY;this.minX=r<s?r:s,this.minY=n<a?n:a,this.maxX=i>u?i:u,this.maxY=o>h?o:h}},t.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,n=t.minY>e.y?t.minY:e.y,i=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=i&&n<=o){var s=this.minX,a=this.minY,u=this.maxX,h=this.maxY;this.minX=r<s?r:s,this.minY=n<a?n:a,this.maxX=i>u?i:u,this.maxY=o>h?o:h}},t}();r.default=i},{"../math":70}],48:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=t("../utils"),o=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r.children=[],r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments.length;if(e>1)for(var r=0;r<e;r++)this.addChild(arguments[r]);else t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),n=this.getChildIndex(e);this.children[r]=e,this.children[n]=t,this.onChildrenChange(r<n?r:n)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);(0,i.removeItems)(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments.length;if(e>1)for(var r=0;r<e;r++)this.removeChild(arguments[r]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,(0,i.removeItems)(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,(0,i.removeItems)(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),e},e.prototype.removeChildren=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1],r=t,n="number"==typeof e?e:this.children.length,i=n-r,o=void 0;if(i>0&&i<=n){o=this.children.splice(r,i);for(var s=0;s<o.length;++s)o[s].parent=null,o[s].transform&&(o[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<o.length;++a)o[a].emit("removed",this);return o}if(0===i&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];e.visible&&e.renderable&&(e.calculateBounds(),e._mask?(e._mask.calculateBounds(),this._bounds.addBoundsMask(e._bounds,e._mask._bounds)):e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds))}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.renderWebGL=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this._filters)this.renderAdvancedWebGL(t);else{this._renderWebGL(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].renderWebGL(t)}},e.prototype.renderAdvancedWebGL=function(t){t.flush();var e=this._filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<e.length;n++)e[n].enabled&&this._enabledFilters.push(e[n]);this._enabledFilters.length&&t.filterManager.pushFilter(this,this._enabledFilters)}r&&t.maskManager.pushMask(this,this._mask),this._renderWebGL(t);for(var i=0,o=this.children.length;i<o;i++)this.children[i].renderWebGL(t);t.flush(),r&&t.maskManager.popMask(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filterManager.popFilter()},e.prototype._renderWebGL=function(t){},e.prototype._renderCanvas=function(t){},e.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask),this._renderCanvas(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},e.prototype.destroy=function(e){t.prototype.destroy.call(this);var r="boolean"==typeof e?e:e&&e.children,n=this.removeChildren(0,this.children.length);if(r)for(var i=0;i<n.length;++i)n[i].destroy(e)},n(e,[{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}]),e}(function(t){return t&&t.__esModule?t:{default:t}}(t("./DisplayObject")).default);r.default=o,o.prototype.containerUpdateTransform=o.prototype.updateTransform},{"../utils":125,"./DisplayObject":49}],49:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=n(t("eventemitter3")),s=t("../const"),a=n(t("../settings")),u=n(t("./TransformStatic")),h=n(t("./Transform")),l=n(t("./Bounds")),c=t("../math"),d=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this)),n=a.default.TRANSFORM_MODE===s.TRANSFORM_MODE.STATIC?u.default:h.default;return r.tempDisplayObjectParent=null,r.transform=new n,r.alpha=1,r.visible=!0,r.renderable=!0,r.parent=null,r.worldAlpha=1,r.filterArea=null,r._filters=null,r._enabledFilters=null,r._bounds=new l.default,r._boundsID=0,r._lastBoundsID=-1,r._boundsRect=null,r._localBoundsRect=null,r._mask=null,r._destroyed=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),e||(this._boundsRect||(this._boundsRect=new c.Rectangle),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new c.Rectangle),t=this._localBoundsRect);var n=this.getBounds(!1,t);return this.parent=r,this.transform=e,n},e.prototype.toGlobal=function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,n){return e&&(t=e.toGlobal(t,r,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.renderWebGL=function(t){},e.prototype.renderCanvas=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=n||1,this.rotation=i,this.skew.x=o,this.skew.y=s,this.pivot.x=a,this.pivot.y=u,this},e.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},i(e,[{key:"_tempDisplayObjectParent",get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent}},{key:"x",get:function(){return this.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.position.y},set:function(t){this.transform.position.y=t}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(t){this.transform.position.copy(t)}},{key:"scale",get:function(){return this.transform.scale},set:function(t){this.transform.scale.copy(t)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copy(t)}},{key:"skew",get:function(){return this.transform.skew},set:function(t){this.transform.skew.copy(t)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t}},{key:"worldVisible",get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},{key:"mask",get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0,this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.renderable=!1,this._mask.isMask=!0)}},{key:"filters",get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}]),e}(o.default);r.default=d,d.prototype.displayObjectUpdateTransform=d.prototype.updateTransform},{"../const":46,"../math":70,"../settings":101,"./Bounds":47,"./Transform":50,"./TransformStatic":52,eventemitter3:3}],50:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=t("../math"),o=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r.position=new i.Point(0,0),r.scale=new i.Point(1,1),r.skew=new i.ObservablePoint(r.updateSkew,r,0,0),r.pivot=new i.Point(0,0),r._rotation=0,r._cx=1,r._sx=0,r._cy=0,r._sy=1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x)},e.prototype.updateLocalTransform=function(){var t=this.localTransform;t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d)},e.prototype.updateTransform=function(t){var e=this.localTransform;e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d);var r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._worldID++},e.prototype.setFromMatrix=function(t){t.decompose(this)},n(e,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateSkew()}}]),e}(function(t){return t&&t.__esModule?t:{default:t}}(t("./TransformBase")).default);r.default=o},{"../math":70,"./TransformBase":51}],51:[function(t,e,r){"use strict";r.__esModule=!0;var n=t("../math"),i=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.worldTransform=new n.Matrix,this.localTransform=new n.Matrix,this._worldID=0,this._parentID=0}return t.prototype.updateLocalTransform=function(){},t.prototype.updateTransform=function(t){var e=t.worldTransform,r=this.worldTransform,n=this.localTransform;r.a=n.a*e.a+n.b*e.c,r.b=n.a*e.b+n.b*e.d,r.c=n.c*e.a+n.d*e.c,r.d=n.c*e.b+n.d*e.d,r.tx=n.tx*e.a+n.ty*e.c+e.tx,r.ty=n.tx*e.b+n.ty*e.d+e.ty,this._worldID++},t}();r.default=i,i.prototype.updateWorldTransform=i.prototype.updateTransform,i.IDENTITY=new i},{"../math":70}],52:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=t("../math"),o=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r.position=new i.ObservablePoint(r.onChange,r,0,0),r.scale=new i.ObservablePoint(r.onChange,r,1,1),r.pivot=new i.ObservablePoint(r.onChange,r,0,0),r.skew=new i.ObservablePoint(r.updateSkew,r,0,0),r._rotation=0,r._cx=1,r._sx=0,r._cy=0,r._sy=1,r._localID=0,r._currentLocalID=0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onChange=function(){this._localID++},e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x),this._localID++},e.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale._x,t.b=this._sx*this.scale._x,t.c=this._cy*this.scale._y,t.d=this._sy*this.scale._y,t.tx=this.position._x-(this.pivot._x*t.a+this.pivot._y*t.c),t.ty=this.position._y-(this.pivot._x*t.b+this.pivot._y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},e.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale._x,e.b=this._sx*this.scale._x,e.c=this._cy*this.scale._y,e.d=this._sy*this.scale._y,e.tx=this.position._x-(this.pivot._x*e.a+this.pivot._y*e.c),e.ty=this.position._y-(this.pivot._x*e.b+this.pivot._y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},e.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},n(e,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateSkew()}}]),e}(function(t){return t&&t.__esModule?t:{default:t}}(t("./TransformBase")).default);r.default=o},{"../math":70,"./TransformBase":51}],53:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("../display/Container")),o=n(t("../textures/RenderTexture")),s=n(t("../textures/Texture")),a=n(t("./GraphicsData")),u=n(t("../sprites/Sprite")),h=t("../math"),l=t("../utils"),c=t("../const"),d=n(t("../display/Bounds")),f=n(t("./utils/bezierCurveTo")),p=n(t("../renderers/canvas/CanvasRenderer")),v=void 0,g=new h.Matrix,y=new h.Point,m=new Float32Array(4),_=new Float32Array(4),b=function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n.fillAlpha=1,n.lineWidth=0,n.nativeLines=r,n.lineColor=0,n.lineAlignment=.5,n.graphicsData=[],n.tint=16777215,n._prevTint=16777215,n.blendMode=c.BLEND_MODES.NORMAL,n.currentPath=null,n._webGL={},n.isMask=!1,n.boundsPadding=0,n._localBounds=new d.default,n.dirty=0,n.fastRectDirty=-1,n.clearDirty=0,n.boundsDirty=-1,n.cachedSpriteDirty=!1,n._spriteRect=null,n._fastRect=!1,n._prevRectTint=null,n._prevRectFillColor=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.clone=function(){var t=new e;t.renderable=this.renderable,t.fillAlpha=this.fillAlpha,t.lineWidth=this.lineWidth,t.lineColor=this.lineColor,t.lineAlignment=this.lineAlignment,t.tint=this.tint,t.blendMode=this.blendMode,t.isMask=this.isMask,t.boundsPadding=this.boundsPadding,t.dirty=0,t.cachedSpriteDirty=this.cachedSpriteDirty;for(var r=0;r<this.graphicsData.length;++r)t.graphicsData.push(this.graphicsData[r].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t.updateLocalBounds(),t},e.prototype._quadraticCurveLength=function(t,e,r,n,i,o){var s=t-(2*r+i),a=e-(2*n+o),u=(r-2)*t*2,h=(n-2)*e*2,l=4*(s*s+a*a),c=4*(s*u+a*h),d=u*u+h*h,f=2*Math.sqrt(l+c+d),p=Math.sqrt(l),v=2*l*p,g=2*Math.sqrt(d),y=c/p;return(v*f+p*c*(f-g)+(4*d*l-c*c)*Math.log((2*p+y+f)/(y+g)))/(4*v)},e.prototype._bezierCurveLength=function(t,e,r,n,i,o,s,a){for(var u=0,h=0,l=0,c=0,d=0,f=0,p=0,v=0,g=0,y=0,m=0,_=t,b=e,x=1;x<=10;++x)y=_-(v=(p=(f=(d=1-(h=x/10))*d)*d)*t+3*f*h*r+3*d*(l=h*h)*i+(c=l*h)*s),m=b-(g=p*e+3*f*h*n+3*d*l*o+c*a),_=v,b=g,u+=Math.sqrt(y*y+m*m);return u},e.prototype._segmentsCount=function(t){var r=Math.ceil(t/e.CURVES.maxLength);return r<e.CURVES.minSegments?r=e.CURVES.minSegments:r>e.CURVES.maxSegments&&(r=e.CURVES.maxSegments),r},e.prototype.lineStyle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;if(this.lineWidth=t,this.lineColor=e,this.lineAlpha=r,this.lineAlignment=n,this.currentPath)if(this.currentPath.shape.points.length){var i=new h.Polygon(this.currentPath.shape.points.slice(-2));i.closed=!1,this.drawShape(i)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha,this.currentPath.lineAlignment=this.lineAlignment;return this},e.prototype.moveTo=function(t,e){var r=new h.Polygon([t,e]);return r.closed=!1,this.drawShape(r),this},e.prototype.lineTo=function(t,e){var r=this.currentPath.shape.points,n=r[r.length-2],i=r[r.length-1];return n===t&&i===e||(r.push(t,e),this.dirty++),this},e.prototype.quadraticCurveTo=function(t,r,n,i){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var o=this.currentPath.shape.points,s=0,a=0;0===o.length&&this.moveTo(0,0);for(var u=o[o.length-2],h=o[o.length-1],l=e.CURVES.adaptive?this._segmentsCount(this._quadraticCurveLength(u,h,t,r,n,i)):20,c=1;c<=l;++c){var d=c/l;s=u+(t-u)*d,a=h+(r-h)*d,o.push(s+(t+(n-t)*d-s)*d,a+(r+(i-r)*d-a)*d)}return this.dirty++,this},e.prototype.bezierCurveTo=function(t,r,n,i,o,s){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var a=this.currentPath.shape.points,u=a[a.length-2],h=a[a.length-1];a.length-=2;var l=e.CURVES.adaptive?this._segmentsCount(this._bezierCurveLength(u,h,t,r,n,i,o,s)):20;return(0,f.default)(u,h,t,r,n,i,o,s,l,a),this.dirty++,this},e.prototype.arcTo=function(t,e,r,n,i){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var o=this.currentPath.shape.points,s=o[o.length-2],a=o[o.length-1]-e,u=s-t,h=n-e,l=r-t,c=Math.abs(a*l-u*h);if(c<1e-8||0===i)o[o.length-2]===t&&o[o.length-1]===e||o.push(t,e);else{var d=a*a+u*u,f=h*h+l*l,p=a*h+u*l,v=i*Math.sqrt(d)/c,g=i*Math.sqrt(f)/c,y=v*p/d,m=g*p/f,_=v*l+g*u,b=v*h+g*a,x=u*(g+y),T=a*(g+y),w=l*(v+m),E=h*(v+m),S=Math.atan2(T-b,x-_),O=Math.atan2(E-b,w-_);this.arc(_+t,b+e,i,S,O,u*h>l*a)}return this.dirty++,this},e.prototype.arc=function(t,r,n,i,o){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(i===o)return this;!s&&o<=i?o+=c.PI_2:s&&i<=o&&(i+=c.PI_2);var a=o-i,u=e.CURVES.adaptive?this._segmentsCount(Math.abs(a)*n):40*Math.ceil(Math.abs(a)/c.PI_2);if(0===a)return this;var h=t+Math.cos(i)*n,l=r+Math.sin(i)*n,d=this.currentPath?this.currentPath.shape.points:null;if(d){var f=Math.abs(d[d.length-2]-h),p=Math.abs(d[d.length-1]-l);f<.001&&p<.001||d.push(h,l)}else this.moveTo(h,l),d=this.currentPath.shape.points;for(var v=a/(2*u),g=2*v,y=Math.cos(v),m=Math.sin(v),_=u-1,b=_%1/_,x=0;x<=_;++x){var T=v+i+g*(x+b*x),w=Math.cos(T),E=-Math.sin(T);d.push((y*w+m*E)*n+t,(y*-E+m*w)*n+r)}return this.dirty++,this},e.prototype.beginFill=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.filling=!0,this.fillColor=t,this.fillAlpha=e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},e.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},e.prototype.drawRect=function(t,e,r,n){return this.drawShape(new h.Rectangle(t,e,r,n)),this},e.prototype.drawRoundedRect=function(t,e,r,n,i){return this.drawShape(new h.RoundedRectangle(t,e,r,n,i)),this},e.prototype.drawCircle=function(t,e,r){return this.drawShape(new h.Circle(t,e,r)),this},e.prototype.drawEllipse=function(t,e,r,n){return this.drawShape(new h.Ellipse(t,e,r,n)),this},e.prototype.drawPolygon=function(t){var e=t,r=!0;if(e instanceof h.Polygon&&(r=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var n=0;n<e.length;++n)e[n]=arguments[n]}var i=new h.Polygon(e);return i.closed=r,this.drawShape(i),this},e.prototype.drawStar=function(t,e,r,n,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;i=i||n/2;for(var s=-1*Math.PI/2+o,a=2*r,u=c.PI_2/a,h=[],l=0;l<a;l++){var d=l%2?i:n,f=l*u+s;h.push(t+d*Math.cos(f),e+d*Math.sin(f))}return this.drawPolygon(h)},e.prototype.clear=function(){return(this.lineWidth||this.filling||this.graphicsData.length>0)&&(this.lineWidth=0,this.lineAlignment=.5,this.filling=!1,this.boundsDirty=-1,this.canvasTintDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this._spriteRect=null,this},e.prototype.isFastRect=function(){return 1===this.graphicsData.length&&this.graphicsData[0].shape.type===c.SHAPES.RECT&&!this.graphicsData[0].lineWidth},e.prototype._renderWebGL=function(t){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect()),this._fastRect?this._renderSpriteRect(t):(t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this))},e.prototype._renderSpriteRect=function(t){var e=this.graphicsData[0].shape;this._spriteRect||(this._spriteRect=new u.default(new s.default(s.default.WHITE)));var r=this._spriteRect,n=this.graphicsData[0].fillColor;if(16777215===this.tint)r.tint=n;else if(this.tint!==this._prevRectTint||n!==this._prevRectFillColor){var i=m,o=_;(0,l.hex2rgb)(n,i),(0,l.hex2rgb)(this.tint,o),i[0]*=o[0],i[1]*=o[1],i[2]*=o[2],r.tint=(0,l.rgb2hex)(i),this._prevRectTint=this.tint,this._prevRectFillColor=n}r.alpha=this.graphicsData[0].fillAlpha,r.worldAlpha=this.worldAlpha*r.alpha,r.blendMode=this.blendMode,r._texture._frame.width=e.width,r._texture._frame.height=e.height,r.transform.worldTransform=this.transform.worldTransform,r.anchor.set(-e.x/e.width,-e.y/e.height),r._onAnchorUpdate(),r._renderWebGL(t)},e.prototype._renderCanvas=function(t){!0!==this.isMask&&t.plugins.graphics.render(this)},e.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var t=this._localBounds;this._bounds.addFrame(this.transform,t.minX,t.minY,t.maxX,t.maxY)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,y);for(var e=this.graphicsData,r=0;r<e.length;++r){var n=e[r];if(n.fill&&n.shape&&n.shape.contains(y.x,y.y)){if(n.holes)for(var i=0;i<n.holes.length;i++){if(n.holes[i].contains(y.x,y.y))return!1}return!0}}return!1},e.prototype.updateLocalBounds=function(){var t=1/0,e=-1/0,r=1/0,n=-1/0;if(this.graphicsData.length)for(var i=0,o=0,s=0,a=0,u=0,h=0;h<this.graphicsData.length;h++){var l=this.graphicsData[h],d=l.type,f=l.lineWidth;if(i=l.shape,d===c.SHAPES.RECT||d===c.SHAPES.RREC)o=i.x-f/2,s=i.y-f/2,t=o<t?o:t,e=o+(a=i.width+f)>e?o+a:e,r=s<r?s:r,n=s+(u=i.height+f)>n?s+u:n;else if(d===c.SHAPES.CIRC)o=i.x,s=i.y,t=o-(a=i.radius+f/2)<t?o-a:t,e=o+a>e?o+a:e,r=s-(u=i.radius+f/2)<r?s-u:r,n=s+u>n?s+u:n;else if(d===c.SHAPES.ELIP)o=i.x,s=i.y,t=o-(a=i.width+f/2)<t?o-a:t,e=o+a>e?o+a:e,r=s-(u=i.height+f/2)<r?s-u:r,n=s+u>n?s+u:n;else for(var p=i.points,v=0,g=0,y=0,m=0,_=0,b=0,x=0,T=0,w=0;w+2<p.length;w+=2)o=p[w],s=p[w+1],v=p[w+2],g=p[w+3],y=Math.abs(v-o),m=Math.abs(g-s),u=f,(a=Math.sqrt(y*y+m*m))<1e-9||(t=(x=(v+o)/2)-(_=(u/a*m+y)/2)<t?x-_:t,e=x+_>e?x+_:e,r=(T=(g+s)/2)-(b=(u/a*y+m)/2)<r?T-b:r,n=T+b>n?T+b:n)}else t=0,e=0,r=0,n=0;var E=this.boundsPadding;this._localBounds.minX=t-E,this._localBounds.maxX=e+E,this._localBounds.minY=r-E,this._localBounds.maxY=n+E},e.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var e=new a.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,t,this.lineAlignment);return this.graphicsData.push(e),e.type===c.SHAPES.POLY&&(e.shape.closed=e.shape.closed,this.currentPath=e),this.dirty++,e},e.prototype.generateCanvasTexture=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this.getLocalBounds(),n=o.default.create(r.width,r.height,t,e);v||(v=new p.default),this.transform.updateLocalTransform(),this.transform.localTransform.copy(g),g.invert(),g.tx-=r.x,g.ty-=r.y,v.render(this,n,!0,g);var i=s.default.fromCanvas(n.baseTexture._canvasRenderTarget.canvas,t,"graphics");return i.baseTexture.resolution=e,i.baseTexture.update(),i},e.prototype.closePath=function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this},e.prototype.addHole=function(){var t=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(t.shape),this.currentPath=null,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e);for(var r=0;r<this.graphicsData.length;++r)this.graphicsData[r].destroy();for(var n in this._webGL)for(var i=0;i<this._webGL[n].data.length;++i)this._webGL[n].data[i].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webGL=null,this._localBounds=null},e}(i.default);r.default=b,b._SPRITE_TEXTURE=null,b.CURVES={adaptive:!1,maxLength:10,minSegments:8,maxSegments:2048}},{"../const":46,"../display/Bounds":47,"../display/Container":48,"../math":70,"../renderers/canvas/CanvasRenderer":77,"../sprites/Sprite":102,"../textures/RenderTexture":113,"../textures/Texture":115,"../utils":125,"./GraphicsData":54,"./utils/bezierCurveTo":56}],54:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(e,r,n,i,o,s,a,u,h){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.lineWidth=e,this.lineAlignment=h,this.nativeLines=a,this.lineColor=r,this.lineAlpha=n,this._lineTint=r,this.fillColor=i,this.fillAlpha=o,this._fillTint=i,this.fill=s,this.holes=[],this.shape=u,this.type=u.type}return t.prototype.clone=function(){return new t(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape)},t.prototype.addHole=function(t){this.holes.push(t)},t.prototype.destroy=function(){this.shape=null,this.holes=null},t}();r.default=n},{}],55:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../renderers/canvas/CanvasRenderer")),i=t("../../const"),o=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e}return t.prototype.render=function(t){var e=this.renderer,r=e.context,n=t.worldAlpha,o=t.transform.worldTransform,s=e.resolution;r.setTransform(o.a*s,o.b*s,o.c*s,o.d*s,o.tx*s,o.ty*s),t.canvasTintDirty===t.dirty&&t._prevTint===t.tint||this.updateGraphicsTint(t),e.setBlendMode(t.blendMode);for(var a=0;a<t.graphicsData.length;a++){var u=t.graphicsData[a],h=u.shape,l=u._fillTint,c=u._lineTint;if(r.lineWidth=u.lineWidth,u.type===i.SHAPES.POLY){r.beginPath(),this.renderPolygon(h.points,h.closed,r);for(var d=0;d<u.holes.length;d++)this.renderPolygon(u.holes[d].points,!0,r);u.fill&&(r.globalAlpha=u.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fill()),u.lineWidth&&(r.globalAlpha=u.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.stroke())}else if(u.type===i.SHAPES.RECT)(u.fillColor||0===u.fillColor)&&(r.globalAlpha=u.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fillRect(h.x,h.y,h.width,h.height)),u.lineWidth&&(r.globalAlpha=u.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.strokeRect(h.x,h.y,h.width,h.height));else if(u.type===i.SHAPES.CIRC)r.beginPath(),r.arc(h.x,h.y,h.radius,0,2*Math.PI),r.closePath(),u.fill&&(r.globalAlpha=u.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fill()),u.lineWidth&&(r.globalAlpha=u.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.stroke());else if(u.type===i.SHAPES.ELIP){var f=2*h.width,p=2*h.height,v=h.x-f/2,g=h.y-p/2;r.beginPath();var y=f/2*.5522848,m=p/2*.5522848,_=v+f,b=g+p,x=v+f/2,T=g+p/2;r.moveTo(v,T),r.bezierCurveTo(v,T-m,x-y,g,x,g),r.bezierCurveTo(x+y,g,_,T-m,_,T),r.bezierCurveTo(_,T+m,x+y,b,x,b),r.bezierCurveTo(x-y,b,v,T+m,v,T),r.closePath(),u.fill&&(r.globalAlpha=u.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fill()),u.lineWidth&&(r.globalAlpha=u.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.stroke())}else if(u.type===i.SHAPES.RREC){var w=h.x,E=h.y,S=h.width,O=h.height,M=h.radius,P=Math.min(S,O)/2|0;M=M>P?P:M,r.beginPath(),r.moveTo(w,E+M),r.lineTo(w,E+O-M),r.quadraticCurveTo(w,E+O,w+M,E+O),r.lineTo(w+S-M,E+O),r.quadraticCurveTo(w+S,E+O,w+S,E+O-M),r.lineTo(w+S,E+M),r.quadraticCurveTo(w+S,E,w+S-M,E),r.lineTo(w+M,E),r.quadraticCurveTo(w,E,w,E+M),r.closePath(),(u.fillColor||0===u.fillColor)&&(r.globalAlpha=u.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fill()),u.lineWidth&&(r.globalAlpha=u.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.stroke())}}},t.prototype.updateGraphicsTint=function(t){t._prevTint=t.tint,t.canvasTintDirty=t.dirty;for(var e=(t.tint>>16&255)/255,r=(t.tint>>8&255)/255,n=(255&t.tint)/255,i=0;i<t.graphicsData.length;++i){var o=t.graphicsData[i],s=0|o.fillColor,a=0|o.lineColor;o._fillTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*r*255<<8)+(255&s)/255*n*255,o._lineTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*r*255<<8)+(255&a)/255*n*255}},t.prototype.renderPolygon=function(t,e,r){r.moveTo(t[0],t[1]);for(var n=1;n<t.length/2;++n)r.lineTo(t[2*n],t[2*n+1]);e&&r.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();r.default=o,n.default.registerPlugin("graphics",o)},{"../../const":46,"../../renderers/canvas/CanvasRenderer":77}],56:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e,r,n,i,o,s,a,u){var h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[],l=0,c=0,d=0,f=0,p=0;h.push(t,e);for(var v=1,g=0;v<=u;++v)d=(c=(l=1-(g=v/u))*l)*l,p=(f=g*g)*g,h.push(d*t+3*c*g*r+3*l*f*i+p*s,d*e+3*c*g*n+3*l*f*o+p*a);return h}},{}],57:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("../../utils"),o=t("../../const"),s=n(t("../../renderers/webgl/utils/ObjectRenderer")),a=n(t("../../renderers/webgl/WebGLRenderer")),u=n(t("./WebGLGraphicsData")),h=n(t("./shaders/PrimitiveShader")),l=n(t("./utils/buildPoly")),c=n(t("./utils/buildRectangle")),d=n(t("./utils/buildRoundedRectangle")),f=n(t("./utils/buildCircle")),p=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.graphicsDataPool=[],n.primitiveShader=null,n.gl=r.gl,n.CONTEXT_UID=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new h.default(this.gl)},e.prototype.destroy=function(){s.default.prototype.destroy.call(this);for(var t=0;t<this.graphicsDataPool.length;++t)this.graphicsDataPool[t].destroy();this.graphicsDataPool=null},e.prototype.render=function(t){var e=this.renderer,r=e.gl,n=void 0,o=t._webGL[this.CONTEXT_UID];o&&t.dirty===o.dirty||(this.updateGraphics(t),o=t._webGL[this.CONTEXT_UID]);var s=this.primitiveShader;e.bindShader(s),e.state.setBlendMode(t.blendMode);for(var a=0,u=o.data.length;a<u;a++){var h=(n=o.data[a]).shader;e.bindShader(h),h.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),h.uniforms.tint=(0,i.hex2rgb)(t.tint),h.uniforms.alpha=t.worldAlpha,e.bindVao(n.vao),n.nativeLines?r.drawArrays(r.LINES,0,n.points.length/6):n.vao.draw(r.TRIANGLE_STRIP,n.indices.length)}},e.prototype.updateGraphics=function(t){var e=this.renderer.gl,r=t._webGL[this.CONTEXT_UID];if(r||(r=t._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:e,clearDirty:-1,dirty:-1}),r.dirty=t.dirty,t.clearDirty!==r.clearDirty){r.clearDirty=t.clearDirty;for(var n=0;n<r.data.length;n++)this.graphicsDataPool.push(r.data[n]);r.data.length=0,r.lastIndex=0}for(var i=void 0,s=void 0,a=r.lastIndex;a<t.graphicsData.length;a++){var u=t.graphicsData[a];i=this.getWebGLData(r,0),u.nativeLines&&u.lineWidth&&(s=this.getWebGLData(r,0,!0),r.lastIndex++),u.type===o.SHAPES.POLY&&(0,l.default)(u,i,s),u.type===o.SHAPES.RECT?(0,c.default)(u,i,s):u.type===o.SHAPES.CIRC||u.type===o.SHAPES.ELIP?(0,f.default)(u,i,s):u.type===o.SHAPES.RREC&&(0,d.default)(u,i,s),r.lastIndex++}this.renderer.bindVao(null);for(var h=0;h<r.data.length;h++)(i=r.data[h]).dirty&&i.upload()},e.prototype.getWebGLData=function(t,e,r){var n=t.data[t.data.length-1];return(!n||n.nativeLines!==r||n.points.length>32e4)&&((n=this.graphicsDataPool.pop()||new u.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState)).nativeLines=r,n.reset(e),t.data.push(n)),n.dirty=!0,n},e}(s.default);r.default=p,a.default.registerPlugin("graphics",p)},{"../../const":46,"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../utils":125,"./WebGLGraphicsData":58,"./shaders/PrimitiveShader":59,"./utils/buildCircle":60,"./utils/buildPoly":62,"./utils/buildRectangle":63,"./utils/buildRoundedRectangle":64}],58:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(t("pixi-gl-core")),i=function(){function t(e,r,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.gl=e,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=n.default.GLBuffer.createVertexBuffer(e),this.indexBuffer=n.default.GLBuffer.createIndexBuffer(e),this.dirty=!0,this.nativeLines=!1,this.glPoints=null,this.glIndices=null,this.shader=r,this.vao=new n.default.VertexArrayObject(e,i).addIndex(this.indexBuffer).addAttribute(this.buffer,r.attributes.aVertexPosition,e.FLOAT,!1,24,0).addAttribute(this.buffer,r.attributes.aColor,e.FLOAT,!1,24,8)}return t.prototype.reset=function(){this.points.length=0,this.indices.length=0},t.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},t.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null},t}();r.default=i},{"pixi-gl-core":15}],59:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){function e(r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(function(t){return t&&t.__esModule?t:{default:t}}(t("../../../Shader")).default);r.default=n},{"../../../Shader":44}],60:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e,r){var s=t.shape,a=s.x,u=s.y,h=void 0,l=void 0;if(t.type===i.SHAPES.CIRC?(h=s.radius,l=s.radius):(h=s.width,l=s.height),0!==h&&0!==l){var c=Math.floor(30*Math.sqrt(s.radius))||Math.floor(15*Math.sqrt(s.width+s.height)),d=2*Math.PI/c;if(t.fill){var f=(0,o.hex2rgb)(t.fillColor),p=t.fillAlpha,v=f[0]*p,g=f[1]*p,y=f[2]*p,m=e.points,_=e.indices,b=m.length/6;_.push(b);for(var x=0;x<c+1;x++)m.push(a,u,v,g,y,p),m.push(a+Math.sin(d*x)*h,u+Math.cos(d*x)*l,v,g,y,p),_.push(b++,b++);_.push(b-1)}if(t.lineWidth){var T=t.points;t.points=[];for(var w=0;w<c;w++)t.points.push(a+Math.sin(d*-w)*h,u+Math.cos(d*-w)*l);t.points.push(t.points[0],t.points[1]),(0,n.default)(t,e,r),t.points=T}}};var n=function(t){return t&&t.__esModule?t:{default:t}}(t("./buildLine")),i=t("../../../const"),o=t("../../../utils")},{"../../../const":46,"../../../utils":125,"./buildLine":61}],61:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e,r){t.nativeLines?function(t,e){var r=0,n=t.points;if(0!==n.length){var o=e.points,s=n.length/2,a=(0,i.hex2rgb)(t.lineColor),u=t.lineAlpha,h=a[0]*u,l=a[1]*u,c=a[2]*u;for(r=1;r<s;r++){var d=n[2*(r-1)],f=n[2*(r-1)+1],p=n[2*r],v=n[2*r+1];o.push(d,f),o.push(h,l,c,u),o.push(p,v),o.push(h,l,c,u)}}}(t,r):function(t,e){var r=t.points;if(0!==r.length){var o=new n.Point(r[0],r[1]),s=new n.Point(r[r.length-2],r[r.length-1]);if(o.x===s.x&&o.y===s.y){(r=r.slice()).pop(),r.pop();var a=(s=new n.Point(r[r.length-2],r[r.length-1])).x+.5*(o.x-s.x),u=s.y+.5*(o.y-s.y);r.unshift(a,u),r.push(a,u)}var h=e.points,l=e.indices,c=r.length/2,d=r.length,f=h.length/6,p=t.lineWidth/2,v=(0,i.hex2rgb)(t.lineColor),g=t.lineAlpha,y=v[0]*g,m=v[1]*g,_=v[2]*g,b=r[0],x=r[1],T=r[2],w=r[3],E=0,S=0,O=-(x-w),M=b-T,P=0,C=0,R=0,A=0,I=Math.sqrt(O*O+M*M);O/=I,M/=I,O*=p,M*=p;var D=t.lineAlignment,L=2*(1-D),N=2*D;h.push(b-O*L,x-M*L,y,m,_,g),h.push(b+O*N,x+M*N,y,m,_,g);for(var B=1;B<c-1;++B){b=r[2*(B-1)],x=r[2*(B-1)+1],T=r[2*B],w=r[2*B+1],E=r[2*(B+1)],S=r[2*(B+1)+1],O=-(x-w),M=b-T,O/=I=Math.sqrt(O*O+M*M),M/=I,O*=p,M*=p,P=-(w-S),C=T-E,P/=I=Math.sqrt(P*P+C*C),C/=I;var F=-M+x-(-M+w),k=-O+T-(-O+b),j=(-O+b)*(-M+w)-(-O+T)*(-M+x),U=-(C*=p)+S-(-C+w),X=-(P*=p)+T-(-P+E),G=(-P+E)*(-C+w)-(-P+T)*(-C+S),W=F*X-U*k;if(Math.abs(W)<.1)W+=10.1,h.push(T-O*L,w-M*L,y,m,_,g),h.push(T+O*N,w+M*N,y,m,_,g);else{var H=(k*G-X*j)/W,V=(U*j-F*G)/W;(H-T)*(H-T)+(V-w)*(V-w)>196*p*p?(R=O-P,A=M-C,R/=I=Math.sqrt(R*R+A*A),A/=I,R*=p,A*=p,h.push(T-R*L,w-A*L),h.push(y,m,_,g),h.push(T+R*N,w+A*N),h.push(y,m,_,g),h.push(T-R*N*L,w-A*L),h.push(y,m,_,g),d++):(h.push(T+(H-T)*L,w+(V-w)*L),h.push(y,m,_,g),h.push(T-(H-T)*N,w-(V-w)*N),h.push(y,m,_,g))}}b=r[2*(c-2)],x=r[2*(c-2)+1],T=r[2*(c-1)],O=-(x-(w=r[2*(c-1)+1])),M=b-T,O/=I=Math.sqrt(O*O+M*M),M/=I,O*=p,M*=p,h.push(T-O*L,w-M*L),h.push(y,m,_,g),h.push(T+O*N,w+M*N),h.push(y,m,_,g),l.push(f);for(var Y=0;Y<d;++Y)l.push(f++);l.push(f-1)}}(t,e)};var n=t("../../../math"),i=t("../../../utils")},{"../../../math":70,"../../../utils":125}],62:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.default=function(t,e,r){t.points=t.shape.points.slice();var n=t.points;if(t.fill&&n.length>=6){for(var a=[],u=t.holes,h=0;h<u.length;h++){var l=u[h];a.push(n.length/2),n=n.concat(l.points)}var c=e.points,d=e.indices,f=n.length/2,p=(0,o.hex2rgb)(t.fillColor),v=t.fillAlpha,g=p[0]*v,y=p[1]*v,m=p[2]*v,_=(0,s.default)(n,a,2);if(!_)return;for(var b=c.length/6,x=0;x<_.length;x+=3)d.push(_[x]+b),d.push(_[x]+b),d.push(_[x+1]+b),d.push(_[x+2]+b),d.push(_[x+2]+b);for(var T=0;T<f;T++)c.push(n[2*T],n[2*T+1],g,y,m,v)}t.lineWidth>0&&(0,i.default)(t,e,r)};var i=n(t("./buildLine")),o=t("../../../utils"),s=n(t("earcut"))},{"../../../utils":125,"./buildLine":61,earcut:2}],63:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e,r){var o=t.shape,s=o.x,a=o.y,u=o.width,h=o.height;if(t.fill){var l=(0,i.hex2rgb)(t.fillColor),c=t.fillAlpha,d=l[0]*c,f=l[1]*c,p=l[2]*c,v=e.points,g=e.indices,y=v.length/6;v.push(s,a),v.push(d,f,p,c),v.push(s+u,a),v.push(d,f,p,c),v.push(s,a+h),v.push(d,f,p,c),v.push(s+u,a+h),v.push(d,f,p,c),g.push(y,y,y+1,y+2,y+3,y+3)}if(t.lineWidth){var m=t.points;t.points=[s,a,s+u,a,s+u,a+h,s,a+h,s,a],(0,n.default)(t,e,r),t.points=m}};var n=function(t){return t&&t.__esModule?t:{default:t}}(t("./buildLine")),i=t("../../../utils")},{"../../../utils":125,"./buildLine":61}],64:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e,r){return t+(e-t)*r}function o(t,e,r,n,o,s){for(var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],u=0,h=0,l=0,c=0,d=0,f=0,p=0,v=0;p<=20;++p)u=i(t,r,v=p/20),h=i(e,n,v),l=i(r,o,v),c=i(n,s,v),d=i(u,l,v),f=i(h,c,v),a.push(d,f);return a}r.__esModule=!0,r.default=function(t,e,r){var n=t.shape,i=n.x,h=n.y,l=n.width,c=n.height,d=n.radius,f=[];if(f.push(i,h+d),o(i,h+c-d,i,h+c,i+d,h+c,f),o(i+l-d,h+c,i+l,h+c,i+l,h+c-d,f),o(i+l,h+d,i+l,h,i+l-d,h,f),o(i+d,h,i,h,i,h+d+1e-10,f),t.fill){for(var p=(0,u.hex2rgb)(t.fillColor),v=t.fillAlpha,g=p[0]*v,y=p[1]*v,m=p[2]*v,_=e.points,b=e.indices,x=_.length/6,T=(0,s.default)(f,null,2),w=0,E=T.length;w<E;w+=3)b.push(T[w]+x),b.push(T[w]+x),b.push(T[w+1]+x),b.push(T[w+2]+x),b.push(T[w+2]+x);for(var S=0,O=f.length;S<O;S++)_.push(f[S],f[++S],g,y,m,v)}if(t.lineWidth){var M=t.points;t.points=f,(0,a.default)(t,e,r),t.points=M}};var s=n(t("earcut")),a=n(t("./buildLine")),u=t("../../../utils")},{"../../../utils":125,"./buildLine":61,earcut:2}],65:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.autoDetectRenderer=r.Application=r.Filter=r.SpriteMaskFilter=r.Quad=r.RenderTarget=r.ObjectRenderer=r.WebGLManager=r.Shader=r.CanvasRenderTarget=r.TextureUvs=r.VideoBaseTexture=r.BaseRenderTexture=r.RenderTexture=r.BaseTexture=r.TextureMatrix=r.Texture=r.Spritesheet=r.CanvasGraphicsRenderer=r.GraphicsRenderer=r.GraphicsData=r.Graphics=r.TextMetrics=r.TextStyle=r.Text=r.SpriteRenderer=r.CanvasTinter=r.CanvasSpriteRenderer=r.Sprite=r.TransformBase=r.TransformStatic=r.Transform=r.Container=r.DisplayObject=r.Bounds=r.glCore=r.WebGLRenderer=r.CanvasRenderer=r.ticker=r.utils=r.settings=void 0;var o=t("./const");Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(r,t,{enumerable:!0,get:function(){return o[t]}})});var s=t("./math");Object.keys(s).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(r,t,{enumerable:!0,get:function(){return s[t]}})});var a=t("pixi-gl-core");Object.defineProperty(r,"glCore",{enumerable:!0,get:function(){return i(a).default}});var u=t("./display/Bounds");Object.defineProperty(r,"Bounds",{enumerable:!0,get:function(){return i(u).default}});var h=t("./display/DisplayObject");Object.defineProperty(r,"DisplayObject",{enumerable:!0,get:function(){return i(h).default}});var l=t("./display/Container");Object.defineProperty(r,"Container",{enumerable:!0,get:function(){return i(l).default}});var c=t("./display/Transform");Object.defineProperty(r,"Transform",{enumerable:!0,get:function(){return i(c).default}});var d=t("./display/TransformStatic");Object.defineProperty(r,"TransformStatic",{enumerable:!0,get:function(){return i(d).default}});var f=t("./display/TransformBase");Object.defineProperty(r,"TransformBase",{enumerable:!0,get:function(){return i(f).default}});var p=t("./sprites/Sprite");Object.defineProperty(r,"Sprite",{enumerable:!0,get:function(){return i(p).default}});var v=t("./sprites/canvas/CanvasSpriteRenderer");Object.defineProperty(r,"CanvasSpriteRenderer",{enumerable:!0,get:function(){return i(v).default}});var g=t("./sprites/canvas/CanvasTinter");Object.defineProperty(r,"CanvasTinter",{enumerable:!0,get:function(){return i(g).default}});var y=t("./sprites/webgl/SpriteRenderer");Object.defineProperty(r,"SpriteRenderer",{enumerable:!0,get:function(){return i(y).default}});var m=t("./text/Text");Object.defineProperty(r,"Text",{enumerable:!0,get:function(){return i(m).default}});var _=t("./text/TextStyle");Object.defineProperty(r,"TextStyle",{enumerable:!0,get:function(){return i(_).default}});var b=t("./text/TextMetrics");Object.defineProperty(r,"TextMetrics",{enumerable:!0,get:function(){return i(b).default}});var x=t("./graphics/Graphics");Object.defineProperty(r,"Graphics",{enumerable:!0,get:function(){return i(x).default}});var T=t("./graphics/GraphicsData");Object.defineProperty(r,"GraphicsData",{enumerable:!0,get:function(){return i(T).default}});var w=t("./graphics/webgl/GraphicsRenderer");Object.defineProperty(r,"GraphicsRenderer",{enumerable:!0,get:function(){return i(w).default}});var E=t("./graphics/canvas/CanvasGraphicsRenderer");Object.defineProperty(r,"CanvasGraphicsRenderer",{enumerable:!0,get:function(){return i(E).default}});var S=t("./textures/Spritesheet");Object.defineProperty(r,"Spritesheet",{enumerable:!0,get:function(){return i(S).default}});var O=t("./textures/Texture");Object.defineProperty(r,"Texture",{enumerable:!0,get:function(){return i(O).default}});var M=t("./textures/TextureMatrix");Object.defineProperty(r,"TextureMatrix",{enumerable:!0,get:function(){return i(M).default}});var P=t("./textures/BaseTexture");Object.defineProperty(r,"BaseTexture",{enumerable:!0,get:function(){return i(P).default}});var C=t("./textures/RenderTexture");Object.defineProperty(r,"RenderTexture",{enumerable:!0,get:function(){return i(C).default}});var R=t("./textures/BaseRenderTexture");Object.defineProperty(r,"BaseRenderTexture",{enumerable:!0,get:function(){return i(R).default}});var A=t("./textures/VideoBaseTexture");Object.defineProperty(r,"VideoBaseTexture",{enumerable:!0,get:function(){return i(A).default}});var I=t("./textures/TextureUvs");Object.defineProperty(r,"TextureUvs",{enumerable:!0,get:function(){return i(I).default}});var D=t("./renderers/canvas/utils/CanvasRenderTarget");Object.defineProperty(r,"CanvasRenderTarget",{enumerable:!0,get:function(){return i(D).default}});var L=t("./Shader");Object.defineProperty(r,"Shader",{enumerable:!0,get:function(){return i(L).default}});var N=t("./renderers/webgl/managers/WebGLManager");Object.defineProperty(r,"WebGLManager",{enumerable:!0,get:function(){return i(N).default}});var B=t("./renderers/webgl/utils/ObjectRenderer");Object.defineProperty(r,"ObjectRenderer",{enumerable:!0,get:function(){return i(B).default}});var F=t("./renderers/webgl/utils/RenderTarget");Object.defineProperty(r,"RenderTarget",{enumerable:!0,get:function(){return i(F).default}});var k=t("./renderers/webgl/utils/Quad");Object.defineProperty(r,"Quad",{enumerable:!0,get:function(){return i(k).default}});var j=t("./renderers/webgl/filters/spriteMask/SpriteMaskFilter");Object.defineProperty(r,"SpriteMaskFilter",{enumerable:!0,get:function(){return i(j).default}});var U=t("./renderers/webgl/filters/Filter");Object.defineProperty(r,"Filter",{enumerable:!0,get:function(){return i(U).default}});var X=t("./Application");Object.defineProperty(r,"Application",{enumerable:!0,get:function(){return i(X).default}});var G=t("./autoDetectRenderer");Object.defineProperty(r,"autoDetectRenderer",{enumerable:!0,get:function(){return G.autoDetectRenderer}});var W=n(t("./utils")),H=n(t("./ticker")),V=i(t("./settings")),Y=i(t("./renderers/canvas/CanvasRenderer")),z=i(t("./renderers/webgl/WebGLRenderer"));r.settings=V.default,r.utils=W,r.ticker=H,r.CanvasRenderer=Y.default,r.WebGLRenderer=z.default},{"./Application":43,"./Shader":44,"./autoDetectRenderer":45,"./const":46,"./display/Bounds":47,"./display/Container":48,"./display/DisplayObject":49,"./display/Transform":50,"./display/TransformBase":51,"./display/TransformStatic":52,"./graphics/Graphics":53,"./graphics/GraphicsData":54,"./graphics/canvas/CanvasGraphicsRenderer":55,"./graphics/webgl/GraphicsRenderer":57,"./math":70,"./renderers/canvas/CanvasRenderer":77,"./renderers/canvas/utils/CanvasRenderTarget":79,"./renderers/webgl/WebGLRenderer":84,"./renderers/webgl/filters/Filter":86,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":89,"./renderers/webgl/managers/WebGLManager":93,"./renderers/webgl/utils/ObjectRenderer":94,"./renderers/webgl/utils/Quad":95,"./renderers/webgl/utils/RenderTarget":96,"./settings":101,"./sprites/Sprite":102,"./sprites/canvas/CanvasSpriteRenderer":103,"./sprites/canvas/CanvasTinter":104,"./sprites/webgl/SpriteRenderer":106,"./text/Text":108,"./text/TextMetrics":109,"./text/TextStyle":110,"./textures/BaseRenderTexture":111,"./textures/BaseTexture":112,"./textures/RenderTexture":113,"./textures/Spritesheet":114,"./textures/Texture":115,"./textures/TextureMatrix":116,"./textures/TextureUvs":117,"./textures/VideoBaseTexture":118,"./ticker":121,"./utils":125,"pixi-gl-core":15}],66:[function(t,e,r){"use strict";function n(t){return t<0?-1:t>0?1:0}r.__esModule=!0;var i=function(t){return t&&t.__esModule?t:{default:t}}(t("./Matrix")),o=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],s=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],a=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],u=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],h=[],l=[];!function(){for(var t=0;t<16;t++){var e=[];l.push(e);for(var r=0;r<16;r++)for(var c=n(o[t]*o[r]+a[t]*s[r]),d=n(s[t]*o[r]+u[t]*s[r]),f=n(o[t]*a[r]+a[t]*u[r]),p=n(s[t]*a[r]+u[t]*u[r]),v=0;v<16;v++)if(o[v]===c&&s[v]===d&&a[v]===f&&u[v]===p){e.push(v);break}}for(var g=0;g<16;g++){var y=new i.default;y.set(o[g],s[g],a[g],u[g],0,0),h.push(y)}}();var c={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(t){return o[t]},uY:function(t){return s[t]},vX:function(t){return a[t]},vY:function(t){return u[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return l[t][e]},sub:function(t,e){return l[t][c.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?c.S:c.N:2*Math.abs(e)<=Math.abs(t)?t>0?c.E:c.W:e>0?t>0?c.SE:c.SW:t>0?c.NE:c.NW},matrixAppendRotationInv:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=h[c.inv(e)];i.tx=r,i.ty=n,t.append(i)}};r.default=c},{"./Matrix":67}],67:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){return t&&t.__esModule?t:{default:t}}(t("./Point")),o=t("../const"),s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.a=e,this.b=r,this.c=n,this.d=i,this.tx=o,this.ty=s,this.array=null}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,n,i,o){return this.a=t,this.b=e,this.c=r,this.d=n,this.tx=i,this.ty=o,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new i.default;var r=t.x,n=t.y;return e.x=this.a*r+this.c*n+this.tx,e.y=this.b*r+this.d*n+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new i.default;var r=1/(this.a*this.d+this.c*-this.b),n=t.x,o=t.y;return e.x=this.d*r*n+-this.c*r*o+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*o+-this.b*r*n+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),n=this.a,i=this.c,o=this.tx;return this.a=n*e-this.b*r,this.b=n*r+this.b*e,this.c=i*e-this.d*r,this.d=i*r+this.d*e,this.tx=o*e-this.ty*r,this.ty=o*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,n=this.c,i=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*r+t.b*i,this.c=t.c*e+t.d*n,this.d=t.c*r+t.d*i,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*r+t.ty*i+this.ty,this},t.prototype.setTransform=function(t,e,r,n,i,o,s,a,u){return this.a=Math.cos(s+u)*i,this.b=Math.sin(s+u)*i,this.c=-Math.sin(s-a)*o,this.d=Math.cos(s-a)*o,this.tx=t-(r*this.a+n*this.c),this.ty=e-(r*this.b+n*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,n=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,n=this.c,i=this.d,s=-Math.atan2(-n,i),a=Math.atan2(r,e),u=Math.abs(s+a);return u<1e-5||Math.abs(o.PI_2-u)<1e-5?(t.rotation=a,e<0&&i>=0&&(t.rotation+=t.rotation<=0?Math.PI:-Math.PI),t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=a),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(n*n+i*i),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,n=this.d,i=this.tx,o=t*n-e*r;return this.a=n/o,this.b=-e/o,this.c=-r/o,this.d=t/o,this.tx=(r*this.ty-n*i)/o,this.ty=-(t*this.ty-e*i)/o,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},n(t,null,[{key:"IDENTITY",get:function(){return new t}},{key:"TEMP_MATRIX",get:function(){return new t}}]),t}();r.default=s},{"../const":46,"./Point":69}],68:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._x=n,this._y=i,this.cb=e,this.scope=r}return t.prototype.clone=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new t(e||this.cb,r||this.scope,this._x,this._y)},t.prototype.set=function(t,e){var r=t||0,n=e||(0!==e?r:0);this._x===r&&this._y===n||(this._x=r,this._y=n,this.cb.call(this.scope))},t.prototype.copy=function(t){this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope))},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},n(t,[{key:"x",get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}]),t}();r.default=i},{}],69:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=e,this.y=r}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copy=function(t){this.set(t.x,t.y)},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},t}();r.default=n},{}],70:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./Point");Object.defineProperty(r,"Point",{enumerable:!0,get:function(){return n(i).default}});var o=t("./ObservablePoint");Object.defineProperty(r,"ObservablePoint",{enumerable:!0,get:function(){return n(o).default}});var s=t("./Matrix");Object.defineProperty(r,"Matrix",{enumerable:!0,get:function(){return n(s).default}});var a=t("./GroupD8");Object.defineProperty(r,"GroupD8",{enumerable:!0,get:function(){return n(a).default}});var u=t("./shapes/Circle");Object.defineProperty(r,"Circle",{enumerable:!0,get:function(){return n(u).default}});var h=t("./shapes/Ellipse");Object.defineProperty(r,"Ellipse",{enumerable:!0,get:function(){return n(h).default}});var l=t("./shapes/Polygon");Object.defineProperty(r,"Polygon",{enumerable:!0,get:function(){return n(l).default}});var c=t("./shapes/Rectangle");Object.defineProperty(r,"Rectangle",{enumerable:!0,get:function(){return n(c).default}});var d=t("./shapes/RoundedRectangle");Object.defineProperty(r,"RoundedRectangle",{enumerable:!0,get:function(){return n(d).default}})},{"./GroupD8":66,"./Matrix":67,"./ObservablePoint":68,"./Point":69,"./shapes/Circle":71,"./shapes/Ellipse":72,"./shapes/Polygon":73,"./shapes/Rectangle":74,"./shapes/RoundedRectangle":75}],71:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(t("./Rectangle")),i=t("../../const"),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=e,this.y=r,this.radius=n,this.type=i.SHAPES.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,n=this.x-t,i=this.y-e;return(n*=n)+(i*=i)<=r},t.prototype.getBounds=function(){return new n.default(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}();r.default=o},{"../../const":46,"./Rectangle":74}],72:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(t("./Rectangle")),i=t("../../const"),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=e,this.y=r,this.width=n,this.height=o,this.type=i.SHAPES.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,n=(e-this.y)/this.height;return(r*=r)+(n*=n)<=1},t.prototype.getBounds=function(){return new n.default(this.x-this.width,this.y-this.height,this.width,this.height)},t}();r.default=o},{"../../const":46,"./Rectangle":74}],73:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../Point")),i=t("../../const"),o=function(){function t(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Array.isArray(r[0])&&(r=r[0]),r[0]instanceof n.default){for(var s=[],a=0,u=r.length;a<u;a++)s.push(r[a].x,r[a].y);r=s}this.closed=!0,this.points=r,this.type=i.SHAPES.POLY}return t.prototype.clone=function(){return new t(this.points.slice())},t.prototype.close=function(){var t=this.points;t[0]===t[t.length-2]&&t[1]===t[t.length-1]||t.push(t[0],t[1])},t.prototype.contains=function(t,e){for(var r=!1,n=this.points.length/2,i=0,o=n-1;i<n;o=i++){var s=this.points[2*i],a=this.points[2*i+1],u=this.points[2*o],h=this.points[2*o+1];a>e!=h>e&&t<(e-a)/(h-a)*(u-s)+s&&(r=!r)}return r},t}();r.default=o},{"../../const":46,"../Point":69}],74:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=t("../../const"),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=Number(e),this.y=Number(r),this.width=Number(n),this.height=Number(o),this.type=i.SHAPES.RECT}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},t.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e},t.prototype.fit=function(t){this.x<t.x&&(this.width+=this.x,this.width<0&&(this.width=0),this.x=t.x),this.y<t.y&&(this.height+=this.y,this.height<0&&(this.height=0),this.y=t.y),this.x+this.width>t.x+t.width&&(this.width=t.width-this.x,this.width<0&&(this.width=0)),this.y+this.height>t.y+t.height&&(this.height=t.height-this.y,this.height<0&&(this.height=0))},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);this.x=e,this.width=r-e,this.y=n,this.height=i-n},n(t,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}],[{key:"EMPTY",get:function(){return new t(0,0,0,0)}}]),t}();r.default=o},{"../../const":46}],75:[function(t,e,r){"use strict";r.__esModule=!0;var n=t("../../const"),i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=e,this.y=r,this.width=i,this.height=o,this.radius=s,this.type=n.SHAPES.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),n=e-(this.y+this.radius),i=this.radius*this.radius;if(r*r+n*n<=i)return!0;if((r=t-(this.x+this.width-this.radius))*r+n*n<=i)return!0;if(r*r+(n=e-(this.y+this.height-this.radius))*n<=i)return!0;if((r=t-(this.x+this.radius))*r+n*n<=i)return!0}return!1},t}();r.default=i},{"../../const":46}],76:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("../utils"),s=t("../math"),a=t("../const"),u=n(t("../settings")),h=n(t("../display/Container")),l=n(t("../textures/RenderTexture")),c=n(t("eventemitter3")),d=new s.Matrix,f=function(t){function e(r,n,i,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return(0,o.sayHello)(r),"number"==typeof n&&(n=Object.assign({width:n,height:i||u.default.RENDER_OPTIONS.height},l)),n=Object.assign({},u.default.RENDER_OPTIONS,n),c.options=n,c.type=a.RENDERER_TYPE.UNKNOWN,c.screen=new s.Rectangle(0,0,n.width,n.height),c.view=n.view||document.createElement("canvas"),c.resolution=n.resolution||u.default.RESOLUTION,c.transparent=n.transparent,c.autoResize=n.autoResize||!1,c.blendModes=null,c.preserveDrawingBuffer=n.preserveDrawingBuffer,c.clearBeforeRender=n.clearBeforeRender,c.roundPixels=n.roundPixels,c._backgroundColor=0,c._backgroundColorRgba=[0,0,0,0],c._backgroundColorString="#000000",c.backgroundColor=n.backgroundColor||c._backgroundColor,c._tempDisplayObjectParent=new h.default,c._lastObjectRendered=c._tempDisplayObjectParent,c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoResize&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},e.prototype.generateTexture=function(t,e,r,n){n=n||t.getLocalBounds();var i=l.default.create(0|n.width,0|n.height,e,r);return d.tx=-n.x,d.ty=-n.y,this.render(t,i,!1,d,!!t.parent),i},e.prototype.destroy=function(t){t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=a.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},i(e,[{key:"width",get:function(){return this.view.width}},{key:"height",get:function(){return this.view.height}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=(0,o.hex2string)(t),(0,o.hex2rgb)(t,this._backgroundColorRgba)}}]),e}(c.default);r.default=f},{"../const":46,"../display/Container":48,"../math":70,"../settings":101,"../textures/RenderTexture":113,"../utils":125,eventemitter3:3}],77:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("../SystemRenderer")),o=n(t("./utils/CanvasMaskManager")),s=n(t("./utils/CanvasRenderTarget")),a=n(t("./utils/mapCanvasBlendModesToPixi")),u=t("../../utils"),h=t("../../const"),l=n(t("../../settings")),c=function(t){function e(r,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"Canvas",r,n,i));return s.type=h.RENDERER_TYPE.CANVAS,s.rootContext=s.view.getContext("2d",{alpha:s.transparent}),s.context=s.rootContext,s.refresh=!0,s.maskManager=new o.default(s),s.smoothProperty="imageSmoothingEnabled",s.rootContext.imageSmoothingEnabled||(s.rootContext.webkitImageSmoothingEnabled?s.smoothProperty="webkitImageSmoothingEnabled":s.rootContext.mozImageSmoothingEnabled?s.smoothProperty="mozImageSmoothingEnabled":s.rootContext.oImageSmoothingEnabled?s.smoothProperty="oImageSmoothingEnabled":s.rootContext.msImageSmoothingEnabled&&(s.smoothProperty="msImageSmoothingEnabled")),s.initPlugins(),s.blendModes=(0,a.default)(),s._activeBlendMode=null,s.renderingToScreen=!1,s.resize(s.options.width,s.options.height),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.render=function(t,e,r,n,i){if(this.view){this.renderingToScreen=!e,this.emit("prerender");var o=this.resolution;e?((e=e.baseTexture||e)._canvasRenderTarget||(e._canvasRenderTarget=new s.default(e.width,e.height,e.resolution),e.source=e._canvasRenderTarget.canvas,e.valid=!0),this.context=e._canvasRenderTarget.context,this.resolution=e._canvasRenderTarget.resolution):this.context=this.rootContext;var a=this.context;if(e||(this._lastObjectRendered=t),!i){var u=t.parent,l=this._tempDisplayObjectParent.transform.worldTransform;n?(n.copy(l),this._tempDisplayObjectParent.transform._worldID=-1):l.identity(),t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=u}a.save(),a.setTransform(1,0,0,1,0,0),a.globalAlpha=1,this._activeBlendMode=h.BLEND_MODES.NORMAL,a.globalCompositeOperation=this.blendModes[h.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(a.fillStyle="black",a.clear()),(void 0!==r?r:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?a.clearRect(0,0,this.width,this.height):(a.fillStyle=this._backgroundColorString,a.fillRect(0,0,this.width,this.height)));var c=this.context;this.context=a,t.renderCanvas(this),this.context=c,a.restore(),this.resolution=o,this.emit("postrender")}},e.prototype.clear=function(t){var e=this.context;t=t||this._backgroundColorString,!this.transparent&&t?(e.fillStyle=t,e.fillRect(0,0,this.width,this.height)):e.clearRect(0,0,this.width,this.height)},e.prototype.setBlendMode=function(t){this._activeBlendMode!==t&&(this._activeBlendMode=t,this.context.globalCompositeOperation=this.blendModes[t])},e.prototype.destroy=function(e){this.destroyPlugins(),t.prototype.destroy.call(this,e),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},e.prototype.resize=function(e,r){t.prototype.resize.call(this,e,r),this.smoothProperty&&(this.rootContext[this.smoothProperty]=l.default.SCALE_MODE===h.SCALE_MODES.LINEAR)},e.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},e}(i.default);r.default=c,u.pluginTarget.mixin(c)},{"../../const":46,"../../settings":101,"../../utils":125,"../SystemRenderer":76,"./utils/CanvasMaskManager":78,"./utils/CanvasRenderTarget":79,"./utils/mapCanvasBlendModesToPixi":81}],78:[function(t,e,r){"use strict";r.__esModule=!0;var n=t("../../../const"),i=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e}return t.prototype.pushMask=function(t){var e=this.renderer;e.context.save();var r=t.alpha,n=t.transform.worldTransform,i=e.resolution;e.context.setTransform(n.a*i,n.b*i,n.c*i,n.d*i,n.tx*i,n.ty*i),t._texture||(this.renderGraphicsShape(t),e.context.clip()),t.worldAlpha=r},t.prototype.renderGraphicsShape=function(t){var e=this.renderer.context,r=t.graphicsData.length;if(0!==r){e.beginPath();for(var i=0;i<r;i++){var o=t.graphicsData[i],s=o.shape;if(o.type===n.SHAPES.POLY){var a=s.points;e.moveTo(a[0],a[1]);for(var u=1;u<a.length/2;u++)e.lineTo(a[2*u],a[2*u+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath()}else if(o.type===n.SHAPES.RECT)e.rect(s.x,s.y,s.width,s.height),e.closePath();else if(o.type===n.SHAPES.CIRC)e.arc(s.x,s.y,s.radius,0,2*Math.PI),e.closePath();else if(o.type===n.SHAPES.ELIP){var h=2*s.width,l=2*s.height,c=s.x-h/2,d=s.y-l/2,f=h/2*.5522848,p=l/2*.5522848,v=c+h,g=d+l,y=c+h/2,m=d+l/2;e.moveTo(c,m),e.bezierCurveTo(c,m-p,y-f,d,y,d),e.bezierCurveTo(y+f,d,v,m-p,v,m),e.bezierCurveTo(v,m+p,y+f,g,y,g),e.bezierCurveTo(y-f,g,c,m+p,c,m),e.closePath()}else if(o.type===n.SHAPES.RREC){var _=s.x,b=s.y,x=s.width,T=s.height,w=s.radius,E=Math.min(x,T)/2|0;w=w>E?E:w,e.moveTo(_,b+w),e.lineTo(_,b+T-w),e.quadraticCurveTo(_,b+T,_+w,b+T),e.lineTo(_+x-w,b+T),e.quadraticCurveTo(_+x,b+T,_+x,b+T-w),e.lineTo(_+x,b+w),e.quadraticCurveTo(_+x,b,_+x-w,b),e.lineTo(_+w,b),e.quadraticCurveTo(_,b,_,b+w),e.closePath()}}}},t.prototype.popMask=function(t){t.context.restore(),t.invalidateBlendMode()},t.prototype.destroy=function(){},t}();r.default=i},{"../../../const":46}],79:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../settings")),o=function(){function t(e,r,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||i.default.RESOLUTION,this.resize(e,r)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},n(t,[{key:"width",get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},{key:"height",get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}]),t}();r.default=o},{"../../../settings":101}],80:[function(t,e,r){"use strict";function n(t){var e=document.createElement("canvas");e.width=6,e.height=1;var r=e.getContext("2d");return r.fillStyle=t,r.fillRect(0,0,6,1),e}r.__esModule=!0,r.default=function(){if("undefined"==typeof document)return!1;var t=n("#ff00ff"),e=n("#ffff00"),r=document.createElement("canvas");r.width=6,r.height=1;var i=r.getContext("2d");i.globalCompositeOperation="multiply",i.drawImage(t,0,0),i.drawImage(e,2,0);var o=i.getImageData(2,0,1,1);if(!o)return!1;var s=o.data;return 255===s[0]&&0===s[1]&&0===s[2]}},{}],81:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,i.default)()?(t[n.BLEND_MODES.NORMAL]="source-over",t[n.BLEND_MODES.ADD]="lighter",t[n.BLEND_MODES.MULTIPLY]="multiply",t[n.BLEND_MODES.SCREEN]="screen",t[n.BLEND_MODES.OVERLAY]="overlay",t[n.BLEND_MODES.DARKEN]="darken",t[n.BLEND_MODES.LIGHTEN]="lighten",t[n.BLEND_MODES.COLOR_DODGE]="color-dodge",t[n.BLEND_MODES.COLOR_BURN]="color-burn",t[n.BLEND_MODES.HARD_LIGHT]="hard-light",t[n.BLEND_MODES.SOFT_LIGHT]="soft-light",t[n.BLEND_MODES.DIFFERENCE]="difference",t[n.BLEND_MODES.EXCLUSION]="exclusion",t[n.BLEND_MODES.HUE]="hue",t[n.BLEND_MODES.SATURATION]="saturate",t[n.BLEND_MODES.COLOR]="color",t[n.BLEND_MODES.LUMINOSITY]="luminosity"):(t[n.BLEND_MODES.NORMAL]="source-over",t[n.BLEND_MODES.ADD]="lighter",t[n.BLEND_MODES.MULTIPLY]="source-over",t[n.BLEND_MODES.SCREEN]="source-over",t[n.BLEND_MODES.OVERLAY]="source-over",t[n.BLEND_MODES.DARKEN]="source-over",t[n.BLEND_MODES.LIGHTEN]="source-over",t[n.BLEND_MODES.COLOR_DODGE]="source-over",t[n.BLEND_MODES.COLOR_BURN]="source-over",t[n.BLEND_MODES.HARD_LIGHT]="source-over",t[n.BLEND_MODES.SOFT_LIGHT]="source-over",t[n.BLEND_MODES.DIFFERENCE]="source-over",t[n.BLEND_MODES.EXCLUSION]="source-over",t[n.BLEND_MODES.HUE]="source-over",t[n.BLEND_MODES.SATURATION]="source-over",t[n.BLEND_MODES.COLOR]="source-over",t[n.BLEND_MODES.LUMINOSITY]="source-over"),t[n.BLEND_MODES.NORMAL_NPM]=t[n.BLEND_MODES.NORMAL],t[n.BLEND_MODES.ADD_NPM]=t[n.BLEND_MODES.ADD],t[n.BLEND_MODES.SCREEN_NPM]=t[n.BLEND_MODES.SCREEN],t};var n=t("../../../const"),i=function(t){return t&&t.__esModule?t:{default:t}}(t("./canUseNewCanvasBlendModes"))},{"../../../const":46,"./canUseNewCanvasBlendModes":80}],82:[function(t,e,r){"use strict";r.__esModule=!0;var n=t("../../const"),i=function(t){return t&&t.__esModule?t:{default:t}}(t("../../settings")),o=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=i.default.GC_MAX_IDLE,this.checkCountMax=i.default.GC_MAX_CHECK_COUNT,this.mode=i.default.GC_MODE}return t.prototype.update=function(){this.count++,this.mode!==n.GC_MODES.MANUAL&&++this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())},t.prototype.run=function(){for(var t=this.renderer.textureManager,e=t._managedTextures,r=!1,n=0;n<e.length;n++){var i=e[n];!i._glRenderTargets&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),e[n]=null,r=!0)}if(r){for(var o=0,s=0;s<e.length;s++)null!==e[s]&&(e[o++]=e[s]);e.length=o}},t.prototype.unload=function(t){var e=this.renderer.textureManager;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture,!0);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},t}();r.default=o},{"../../const":46,"../../settings":101}],83:[function(t,e,r){"use strict";r.__esModule=!0;var n=t("pixi-gl-core"),i=t("../../const"),o=function(t){return t&&t.__esModule?t:{default:t}}(t("./utils/RenderTarget")),s=t("../../utils"),a=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e,this.gl=e.gl,this._managedTextures=[]}return t.prototype.bindTexture=function(){},t.prototype.getTexture=function(){},t.prototype.updateTexture=function(t,e){var r=this.gl,s=!!t._glRenderTargets;if(!t.hasLoaded)return null;var a=this.renderer.boundTextures;if(void 0===e){e=0;for(var u=0;u<a.length;++u)if(a[u]===t){e=u;break}}a[e]=t,r.activeTexture(r.TEXTURE0+e);var h=t._glTextures[this.renderer.CONTEXT_UID];if(h)s?t._glRenderTargets[this.renderer.CONTEXT_UID].resize(t.width,t.height):h.upload(t.source);else{if(s){var l=new o.default(this.gl,t.width,t.height,t.scaleMode,t.resolution);l.resize(t.width,t.height),t._glRenderTargets[this.renderer.CONTEXT_UID]=l,h=l.texture}else(h=new n.GLTexture(this.gl,null,null,null,null)).bind(e),h.premultiplyAlpha=!0,h.upload(t.source);t._glTextures[this.renderer.CONTEXT_UID]=h,t.on("update",this.updateTexture,this),t.on("dispose",this.destroyTexture,this),this._managedTextures.push(t),t.isPowerOfTwo?(t.mipmap&&h.enableMipmap(),t.wrapMode===i.WRAP_MODES.CLAMP?h.enableWrapClamp():t.wrapMode===i.WRAP_MODES.REPEAT?h.enableWrapRepeat():h.enableWrapMirrorRepeat()):h.enableWrapClamp(),t.scaleMode===i.SCALE_MODES.NEAREST?h.enableNearestScaling():h.enableLinearScaling()}return h},t.prototype.destroyTexture=function(t,e){if((t=t.baseTexture||t).hasLoaded){var r=this.renderer.CONTEXT_UID,n=t._glTextures,i=t._glRenderTargets;if(n[r]&&(this.renderer.unbindTexture(t),n[r].destroy(),t.off("update",this.updateTexture,this),t.off("dispose",this.destroyTexture,this),delete n[r],!e)){var o=this._managedTextures.indexOf(t);-1!==o&&(0,s.removeItems)(this._managedTextures,o,1)}i&&i[r]&&(i[r].destroy(),delete i[r])}},t.prototype.removeAll=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];e._glTextures[this.renderer.CONTEXT_UID]&&delete e._glTextures[this.renderer.CONTEXT_UID]}},t.prototype.destroy=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];this.destroyTexture(e,!0),e.off("update",this.updateTexture,this),e.off("dispose",this.destroyTexture,this)}this._managedTextures=null},t}();r.default=a},{"../../const":46,"../../utils":125,"./utils/RenderTarget":96,"pixi-gl-core":15}],84:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("../SystemRenderer")),o=n(t("./managers/MaskManager")),s=n(t("./managers/StencilManager")),a=n(t("./managers/FilterManager")),u=n(t("./utils/RenderTarget")),h=n(t("./utils/ObjectRenderer")),l=n(t("./TextureManager")),c=n(t("../../textures/BaseTexture")),d=n(t("./TextureGarbageCollector")),f=n(t("./WebGLState")),p=n(t("./utils/mapWebGLDrawModesToPixi")),v=n(t("./utils/validateContext")),g=t("../../utils"),y=n(t("pixi-gl-core")),m=t("../../const"),_=0,b=function(t){function e(r,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"WebGL",r,n,i));return a.legacy=a.options.legacy,a.legacy&&(y.default.VertexArrayObject.FORCE_NATIVE=!0),a.type=m.RENDERER_TYPE.WEBGL,a.handleContextLost=a.handleContextLost.bind(a),a.handleContextRestored=a.handleContextRestored.bind(a),a.view.addEventListener("webglcontextlost",a.handleContextLost,!1),a.view.addEventListener("webglcontextrestored",a.handleContextRestored,!1),a._contextOptions={alpha:a.transparent,antialias:a.options.antialias,premultipliedAlpha:a.transparent&&"notMultiplied"!==a.transparent,stencil:!0,preserveDrawingBuffer:a.options.preserveDrawingBuffer,powerPreference:a.options.powerPreference},a._backgroundColorRgba[3]=a.transparent?0:1,a.maskManager=new o.default(a),a.stencilManager=new s.default(a),a.emptyRenderer=new h.default(a),a.currentRenderer=a.emptyRenderer,a.textureManager=null,a.filterManager=null,a.initPlugins(),a.options.context&&(0,v.default)(a.options.context),a.gl=a.options.context||y.default.createContext(a.view,a._contextOptions),a.CONTEXT_UID=_++,a.state=new f.default(a.gl),a.renderingToScreen=!0,a.boundTextures=null,a._activeShader=null,a._activeVao=null,a._activeRenderTarget=null,a._initContext(),a.drawModes=(0,p.default)(a.gl),a._nextTextureLocation=0,a.setBlendMode(0),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._initContext=function(){var t=this.gl;t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext();var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this._activeShader=null,this._activeVao=null,this.boundTextures=new Array(e),this.emptyTextures=new Array(e),this.textureManager=new l.default(this),this.filterManager=new a.default(this),this.textureGC=new d.default(this),this.state.resetToDefault(),this.rootRenderTarget=new u.default(t,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget);var r=new y.default.GLTexture.fromData(t,null,1,1),n={_glTextures:{}};n._glTextures[this.CONTEXT_UID]={};for(var i=0;i<e;i++){var o=new c.default;o._glTextures[this.CONTEXT_UID]=r,this.boundTextures[i]=n,this.emptyTextures[i]=o,this.bindTexture(null,i)}this.emit("context",t),this.resize(this.screen.width,this.screen.height)},e.prototype.render=function(t,e,r,n,i){if(this.renderingToScreen=!e,this.emit("prerender"),this.gl&&!this.gl.isContextLost()){if(this._nextTextureLocation=0,e||(this._lastObjectRendered=t),!i){var o=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=o}this.bindRenderTexture(e,n),this.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this._activeRenderTarget.clear(),t.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender")}},e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.resize=function(t,e){i.default.prototype.resize.call(this,t,e),this.rootRenderTarget.resize(t,e),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},e.prototype.setBlendMode=function(t){this.state.setBlendMode(t)},e.prototype.clear=function(t){this._activeRenderTarget.clear(t)},e.prototype.setTransform=function(t){this._activeRenderTarget.transform=t},e.prototype.clearRenderTexture=function(t,e){var r=t.baseTexture._glRenderTargets[this.CONTEXT_UID];return r&&r.clear(e),this},e.prototype.bindRenderTexture=function(t,e){var r=void 0;if(t){var n=t.baseTexture;n._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(n,0),this.unbindTexture(n),(r=n._glRenderTargets[this.CONTEXT_UID]).setFrame(t.frame)}else r=this.rootRenderTarget;return r.transform=e,this.bindRenderTarget(r),this},e.prototype.bindRenderTarget=function(t){return t!==this._activeRenderTarget&&(this._activeRenderTarget=t,t.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=t.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(t.stencilMaskStack)),this},e.prototype.bindShader=function(t,e){return this._activeShader!==t&&(this._activeShader=t,t.bind(),!1!==e&&(t.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0))),this},e.prototype.bindTexture=function(t,e,r){if((t=(t=t||this.emptyTextures[e]).baseTexture||t).touched=this.textureGC.count,r)e=e||0;else{for(var n=0;n<this.boundTextures.length;n++)if(this.boundTextures[n]===t)return n;void 0===e&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,e=this.boundTextures.length-this._nextTextureLocation-1)}var i=this.gl,o=t._glTextures[this.CONTEXT_UID];return o?(this.boundTextures[e]=t,i.activeTexture(i.TEXTURE0+e),i.bindTexture(i.TEXTURE_2D,o.texture)):this.textureManager.updateTexture(t,e),e},e.prototype.unbindTexture=function(t){var e=this.gl;t=t.baseTexture||t;for(var r=0;r<this.boundTextures.length;r++)this.boundTextures[r]===t&&(this.boundTextures[r]=this.emptyTextures[r],e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[r]._glTextures[this.CONTEXT_UID].texture));return this},e.prototype.createVao=function(){return new y.default.VertexArrayObject(this.gl,this.state.attribState)},e.prototype.bindVao=function(t){return this._activeVao===t?this:(t?t.bind():this._activeVao&&this._activeVao.unbind(),this._activeVao=t,this)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer),this.bindVao(null),this._activeShader=null,this._activeRenderTarget=this.rootRenderTarget;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.emptyTextures[t];return this.rootRenderTarget.activate(),this.state.resetToDefault(),this},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.textureManager.removeAll(),this.filterManager.destroy(!0),this._initContext()},e.prototype.destroy=function(e){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.textureManager.destroy(),t.prototype.destroy.call(this,e),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext(),this.gl=null},e}(i.default);r.default=b,g.pluginTarget.mixin(b)},{"../../const":46,"../../textures/BaseTexture":112,"../../utils":125,"../SystemRenderer":76,"./TextureGarbageCollector":82,"./TextureManager":83,"./WebGLState":85,"./managers/FilterManager":90,"./managers/MaskManager":91,"./managers/StencilManager":92,"./utils/ObjectRenderer":94,"./utils/RenderTarget":96,"./utils/mapWebGLDrawModesToPixi":99,"./utils/validateContext":100,"pixi-gl-core":15}],85:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(t("./utils/mapWebGLBlendModesToPixi")),i=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=e,this.maxAttribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)},this.blendModes=(0,n.default)(e),this.nativeVaoExtension=e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object")}return t.prototype.push=function(){var t=this.stack[this.stackIndex];t||(t=this.stack[this.stackIndex]=new Uint8Array(16)),++this.stackIndex;for(var e=0;e<this.activeState.length;e++)t[e]=this.activeState[e]},t.prototype.pop=function(){var t=this.stack[--this.stackIndex];this.setState(t)},t.prototype.setState=function(t){this.setBlend(t[0]),this.setDepthTest(t[1]),this.setFrontFace(t[2]),this.setCullFace(t[3]),this.setBlendMode(t[4])},t.prototype.setBlend=function(t){t=t?1:0,this.activeState[0]!==t&&(this.activeState[0]=t,this.gl[t?"enable":"disable"](this.gl.BLEND))},t.prototype.setBlendMode=function(t){if(t!==this.activeState[4]){this.activeState[4]=t;var e=this.blendModes[t];2===e.length?this.gl.blendFunc(e[0],e[1]):this.gl.blendFuncSeparate(e[0],e[1],e[2],e[3])}},t.prototype.setDepthTest=function(t){t=t?1:0,this.activeState[1]!==t&&(this.activeState[1]=t,this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST))},t.prototype.setCullFace=function(t){t=t?1:0,this.activeState[3]!==t&&(this.activeState[3]=t,this.gl[t?"enable":"disable"](this.gl.CULL_FACE))},t.prototype.setFrontFace=function(t){t=t?1:0,this.activeState[2]!==t&&(this.activeState[2]=t,this.gl.frontFace(this.gl[t?"CW":"CCW"]))},t.prototype.resetAttributes=function(){for(var t=0;t<this.attribState.tempAttribState.length;t++)this.attribState.tempAttribState[t]=0;for(var e=0;e<this.attribState.attribState.length;e++)this.attribState.attribState[e]=0;for(var r=1;r<this.maxAttribs;r++)this.gl.disableVertexAttribArray(r)},t.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var t=0;t<this.activeState.length;++t)this.activeState[t]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},t}();r.default=i},{"./utils/mapWebGLBlendModesToPixi":98}],86:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=n(t("./extractUniformsFromSrc")),s=t("../../../utils"),a=t("../../../const"),u=n(t("../../../settings")),h={},l=function(){function t(e,r,n){for(var i in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this._blendMode=a.BLEND_MODES.NORMAL,this.uniformData=n||(0,o.default)(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler"),this.uniforms={},this.uniformData)this.uniforms[i]=this.uniformData[i].value,this.uniformData[i].type&&(this.uniformData[i].type=this.uniformData[i].type.toLowerCase());this.glShaders={},h[this.vertexSrc+this.fragmentSrc]||(h[this.vertexSrc+this.fragmentSrc]=(0,s.uid)()),this.glShaderKey=h[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=u.default.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0}return t.prototype.apply=function(t,e,r,n,i){t.applyFilter(this,e,r,n)},i(t,[{key:"blendMode",get:function(){return this._blendMode},set:function(t){this._blendMode=t}}],[{key:"defaultVertexSrc",get:function(){return["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join("\n")}},{key:"defaultFragmentSrc",get:function(){return["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join("\n")}}]),t}();r.default=l},{"../../../const":46,"../../../settings":101,"../../../utils":125,"./extractUniformsFromSrc":87}],87:[function(t,e,r){"use strict";function n(t){for(var e=new RegExp("^(projectionMatrix|uSampler|filterArea|filterClamp)$"),r={},n=void 0,o=t.replace(/\s+/g," ").split(/\s*;\s*/),s=0;s<o.length;s++){var a=o[s].trim();if(a.indexOf("uniform")>-1){var u=a.split(" "),h=u[1],l=u[2],c=1;l.indexOf("[")>-1&&(n=l.split(/\[|]/),l=n[0],c*=Number(n[1])),l.match(e)||(r[l]={value:i(h,c),name:l,type:h})}}return r}r.__esModule=!0,r.default=function(t,e,r){var i=n(t),o=n(e);return Object.assign(i,o)};var i=function(t){return t&&t.__esModule?t:{default:t}}(t("pixi-gl-core")).default.shader.defaultValue},{"pixi-gl-core":15}],88:[function(t,e,r){"use strict";r.__esModule=!0,r.calculateScreenSpaceMatrix=function(t,e,r){var n=t.identity();return n.translate(e.x/r.width,e.y/r.height),n.scale(r.width,r.height),n},r.calculateNormalizedScreenSpaceMatrix=function(t,e,r){var n=t.identity();n.translate(e.x/r.width,e.y/r.height);var i=r.width/e.width,o=r.height/e.height;return n.scale(i,o),n},r.calculateSpriteMatrix=function(t,e,r,i){var o=i._texture.orig,s=t.set(r.width,0,0,r.height,e.x,e.y),a=i.worldTransform.copy(n.Matrix.TEMP_MATRIX);return a.invert(),s.prepend(a),s.scale(1/o.width,1/o.height),s.translate(i.anchor.x,i.anchor.y),s};var n=t("../../../math")},{"../../../math":70}],89:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("../Filter")),o=t("../../../../math"),s=n((t("path"),t("../../../../textures/TextureMatrix"))),a=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new o.Matrix,i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n"));return r.renderable=!1,i.maskSprite=r,i.maskMatrix=n,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,r){var n=this.maskSprite,i=this.maskSprite.texture;i.valid&&(i.transform||(i.transform=new s.default(i,0)),i.transform.update(),this.uniforms.mask=i,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(i.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=i.transform.uClampFrame,t.applyFilter(this,e,r))},e}(i.default);r.default=a},{"../../../../math":70,"../../../../textures/TextureMatrix":116,"../Filter":86,path:8}],90:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var o=n(t("./WebGLManager")),s=n(t("../utils/RenderTarget")),a=n(t("../utils/Quad")),u=t("../../../math"),h=n(t("../../../Shader")),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../filters/filterTransforms")),c=n(t("bit-twiddle")),d=function(){function t(){i(this,t),this.renderTarget=null,this.target=null,this.resolution=1,this.sourceFrame=new u.Rectangle,this.destinationFrame=new u.Rectangle,this.filters=[]}return t.prototype.clear=function(){this.filters=null,this.target=null,this.renderTarget=null},t}(),f=function(t){function e(r){i(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.gl=n.renderer.gl,n.quad=new a.default(n.gl,r.state.attribState),n.shaderCache={},n.pool={},n.filterData=null,n.managedFilters=[],n.renderer.on("prerender",n.onPrerender,n),n._screenWidth=r.view.width,n._screenHeight=r.view.height,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.pushFilter=function(t,e){var r=this.renderer,n=this.filterData;if(!n){n=this.renderer._activeRenderTarget.filterStack;var i=new d;i.sourceFrame=i.destinationFrame=this.renderer._activeRenderTarget.size,i.renderTarget=r._activeRenderTarget,this.renderer._activeRenderTarget.filterData=n={index:0,stack:[i]},this.filterData=n}var o=n.stack[++n.index],s=n.stack[0].destinationFrame;o||(o=n.stack[n.index]=new d);var a=t.filterArea&&0===t.filterArea.x&&0===t.filterArea.y&&t.filterArea.width===r.screen.width&&t.filterArea.height===r.screen.height,u=e[0].resolution,h=0|e[0].padding,l=a?r.screen:t.filterArea||t.getBounds(!0),c=o.sourceFrame,f=o.destinationFrame;c.x=(l.x*u|0)/u,c.y=(l.y*u|0)/u,c.width=(l.width*u|0)/u,c.height=(l.height*u|0)/u,a||(n.stack[0].renderTarget.transform||e[0].autoFit&&c.fit(s),c.pad(h)),f.width=c.width,f.height=c.height;var p=this.getPotRenderTarget(r.gl,c.width,c.height,u);o.target=t,o.filters=e,o.resolution=u,o.renderTarget=p,p.setFrame(f,c),r.bindRenderTarget(p),p.clear()},e.prototype.popFilter=function(){var t=this.filterData,e=t.stack[t.index-1],r=t.stack[t.index];this.quad.map(r.renderTarget.size,r.sourceFrame).upload();var n=r.filters;if(1===n.length)n[0].apply(this,r.renderTarget,e.renderTarget,!1,r),this.freePotRenderTarget(r.renderTarget);else{var i=r.renderTarget,o=this.getPotRenderTarget(this.renderer.gl,r.sourceFrame.width,r.sourceFrame.height,r.resolution);o.setFrame(r.destinationFrame,r.sourceFrame),o.clear();var s=0;for(s=0;s<n.length-1;++s){n[s].apply(this,i,o,!0,r);var a=i;i=o,o=a}n[s].apply(this,i,e.renderTarget,!1,r),this.freePotRenderTarget(i),this.freePotRenderTarget(o)}r.clear(),0==--t.index&&(this.filterData=null)},e.prototype.applyFilter=function(t,e,r,n){var i=this.renderer,o=i.gl,s=t.glShaders[i.CONTEXT_UID];s||(t.glShaderKey?(s=this.shaderCache[t.glShaderKey])||(s=new h.default(this.gl,t.vertexSrc,t.fragmentSrc),t.glShaders[i.CONTEXT_UID]=this.shaderCache[t.glShaderKey]=s,this.managedFilters.push(t)):(s=t.glShaders[i.CONTEXT_UID]=new h.default(this.gl,t.vertexSrc,t.fragmentSrc),this.managedFilters.push(t)),i.bindVao(null),this.quad.initVao(s)),i.bindVao(this.quad.vao),i.bindRenderTarget(r),n&&(o.disable(o.SCISSOR_TEST),i.clear(),o.enable(o.SCISSOR_TEST)),r===i.maskManager.scissorRenderTarget&&i.maskManager.pushScissorMask(null,i.maskManager.scissorData),i.bindShader(s);var a=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=a,this.syncUniforms(s,t),i.state.setBlendMode(t.blendMode),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,e.texture.texture),this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0),o.bindTexture(o.TEXTURE_2D,a._glTextures[this.renderer.CONTEXT_UID].texture)},e.prototype.syncUniforms=function(t,e){var r=e.uniformData,n=e.uniforms,i=1,o=void 0;if(t.uniforms.filterArea){o=this.filterData.stack[this.filterData.index];var s=t.uniforms.filterArea;s[0]=o.renderTarget.size.width,s[1]=o.renderTarget.size.height,s[2]=o.sourceFrame.x,s[3]=o.sourceFrame.y,t.uniforms.filterArea=s}if(t.uniforms.filterClamp){o=o||this.filterData.stack[this.filterData.index];var a=t.uniforms.filterClamp;a[0]=0,a[1]=0,a[2]=(o.sourceFrame.width-1)/o.renderTarget.size.width,a[3]=(o.sourceFrame.height-1)/o.renderTarget.size.height,t.uniforms.filterClamp=a}for(var u in r){var h=r[u].type;if("sampler2d"===h&&0!==n[u]){if(n[u].baseTexture)t.uniforms[u]=this.renderer.bindTexture(n[u].baseTexture,i);else{t.uniforms[u]=i;var l=this.renderer.gl;this.renderer.boundTextures[i]=this.renderer.emptyTextures[i],l.activeTexture(l.TEXTURE0+i),n[u].texture.bind()}i++}else if("mat3"===h)void 0!==n[u].a?t.uniforms[u]=n[u].toArray(!0):t.uniforms[u]=n[u];else if("vec2"===h)if(void 0!==n[u].x){var c=t.uniforms[u]||new Float32Array(2);c[0]=n[u].x,c[1]=n[u].y,t.uniforms[u]=c}else t.uniforms[u]=n[u];else"float"===h?t.uniforms.data[u].value!==r[u]&&(t.uniforms[u]=n[u]):t.uniforms[u]=n[u]}},e.prototype.getRenderTarget=function(t,e){var r=this.filterData.stack[this.filterData.index],n=this.getPotRenderTarget(this.renderer.gl,r.sourceFrame.width,r.sourceFrame.height,e||r.resolution);return n.setFrame(r.destinationFrame,r.sourceFrame),n},e.prototype.returnRenderTarget=function(t){this.freePotRenderTarget(t)},e.prototype.calculateScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return l.calculateScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size)},e.prototype.calculateNormalizedScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return l.calculateNormalizedScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size,e.destinationFrame)},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.filterData.stack[this.filterData.index];return l.calculateSpriteMatrix(t,r.sourceFrame,r.renderTarget.size,e)},e.prototype.destroy=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.renderer,r=this.managedFilters;e.off("prerender",this.onPrerender,this);for(var n=0;n<r.length;n++)t||r[n].glShaders[e.CONTEXT_UID].destroy(),delete r[n].glShaders[e.CONTEXT_UID];this.shaderCache={},t?this.pool={}:this.emptyPool()},e.prototype.getPotRenderTarget=function(t,e,r,n){var i="screen";r*=n,(e*=n)===this._screenWidth&&r===this._screenHeight||(i=(65535&(e=c.default.nextPow2(e)))<<16|65535&(r=c.default.nextPow2(r))),this.pool[i]||(this.pool[i]=[]);var o=this.pool[i].pop();if(!o){var a=this.renderer.boundTextures[0];t.activeTexture(t.TEXTURE0),o=new s.default(t,e,r,null,1),t.bindTexture(t.TEXTURE_2D,a._glTextures[this.renderer.CONTEXT_UID].texture)}return o.resolution=n,o.defaultFrame.width=o.size.width=e/n,o.defaultFrame.height=o.size.height=r/n,o.filterPoolKey=i,o},e.prototype.emptyPool=function(){for(var t in this.pool){var e=this.pool[t];if(e)for(var r=0;r<e.length;r++)e[r].destroy(!0)}this.pool={}},e.prototype.freePotRenderTarget=function(t){this.pool[t.filterPoolKey].push(t)},e.prototype.onPrerender=function(){if(this._screenWidth!==this.renderer.view.width||this._screenHeight!==this.renderer.view.height){this._screenWidth=this.renderer.view.width,this._screenHeight=this.renderer.view.height;var t=this.pool.screen;if(t)for(var e=0;e<t.length;e++)t[e].destroy(!0);this.pool.screen=[]}},e}(o.default);r.default=f},{"../../../Shader":44,"../../../math":70,"../filters/filterTransforms":88,"../utils/Quad":95,"../utils/RenderTarget":96,"./WebGLManager":93,"bit-twiddle":1}],91:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("./WebGLManager")),o=n(t("../filters/spriteMask/SpriteMaskFilter")),s=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.scissor=!1,n.scissorData=null,n.scissorRenderTarget=null,n.enableScissor=!0,n.alphaMaskPool=[],n.alphaMaskIndex=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.pushMask=function(t,e){if(e.texture)this.pushSpriteMask(t,e);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&e.isFastRect()){var r=e.worldTransform,n=Math.atan2(r.b,r.a);(n=Math.round(n*(180/Math.PI)))%90?this.pushStencilMask(e):this.pushScissorMask(t,e)}else this.pushStencilMask(e)},e.prototype.popMask=function(t,e){e.texture?this.popSpriteMask(t,e):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(t,e):this.popStencilMask(t,e)},e.prototype.pushSpriteMask=function(t,e){var r=this.alphaMaskPool[this.alphaMaskIndex];r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new o.default(e)]),r[0].resolution=this.renderer.resolution,r[0].maskSprite=e,t.filterArea=e.getBounds(!0),this.renderer.filterManager.pushFilter(t,r),this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},e.prototype.pushStencilMask=function(t){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(t)},e.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},e.prototype.pushScissorMask=function(t,e){e.renderable=!0;var r=this.renderer._activeRenderTarget,n=e.getBounds();n.fit(r.size),e.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var i=this.renderer.resolution;this.renderer.gl.scissor(n.x*i,(r.root?r.size.height-n.y-n.height:n.y)*i,n.width*i,n.height*i),this.scissorRenderTarget=r,this.scissorData=e,this.scissor=!0},e.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var t=this.renderer.gl;t.disable(t.SCISSOR_TEST)},e}(i.default);r.default=s},{"../filters/spriteMask/SpriteMaskFilter":89,"./WebGLManager":93}],92:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(t("./WebGLManager")),i=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.stencilMaskStack=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var e=this.renderer.gl;0===t.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)},e.prototype.pushStencil=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var e=this.renderer.gl,r=this.stencilMaskStack.length;0===r&&e.enable(e.STENCIL_TEST),this.stencilMaskStack.push(t),e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.EQUAL,r,this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.INCR),this.renderer.plugins.graphics.render(t),this._useCurrent()},e.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var t=this.renderer.gl,e=this.stencilMaskStack.pop();0===this.stencilMaskStack.length?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),this.renderer.plugins.graphics.render(e),this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.stencilMaskStack.length)-1},e.prototype.destroy=function(){n.default.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},e}(n.default);r.default=i},{"./WebGLManager":93}],93:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e,this.renderer.on("context",this.onContextChange,this)}return t.prototype.onContextChange=function(){},t.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null},t}();r.default=n},{}],94:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.flush=function(){},e.prototype.render=function(t){},e}(function(t){return t&&t.__esModule?t:{default:t}}(t("../managers/WebGLManager")).default);r.default=n},{"../managers/WebGLManager":93}],95:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("pixi-gl-core")),o=n(t("../../../utils/createIndicesForQuads")),s=function(){function t(e,r){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.gl=e,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(16);for(var n=0;n<4;n++)this.interleaved[4*n]=this.vertices[2*n],this.interleaved[4*n+1]=this.vertices[2*n+1],this.interleaved[4*n+2]=this.uvs[2*n],this.interleaved[4*n+3]=this.uvs[2*n+1];this.indices=(0,o.default)(1),this.vertexBuffer=i.default.GLBuffer.createVertexBuffer(e,this.interleaved,e.STATIC_DRAW),this.indexBuffer=i.default.GLBuffer.createIndexBuffer(e,this.indices,e.STATIC_DRAW),this.vao=new i.default.VertexArrayObject(e,r)}return t.prototype.initVao=function(t){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,t.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,t.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)},t.prototype.map=function(t,e){var r=0,n=0;return this.uvs[0]=r,this.uvs[1]=n,this.uvs[2]=r+e.width/t.width,this.uvs[3]=n,this.uvs[4]=r+e.width/t.width,this.uvs[5]=n+e.height/t.height,this.uvs[6]=r,this.uvs[7]=n+e.height/t.height,r=e.x,n=e.y,this.vertices[0]=r,this.vertices[1]=n,this.vertices[2]=r+e.width,this.vertices[3]=n,this.vertices[4]=r+e.width,this.vertices[5]=n+e.height,this.vertices[6]=r,this.vertices[7]=n+e.height,this},t.prototype.upload=function(){for(var t=0;t<4;t++)this.interleaved[4*t]=this.vertices[2*t],this.interleaved[4*t+1]=this.vertices[2*t+1],this.interleaved[4*t+2]=this.uvs[2*t],this.interleaved[4*t+3]=this.uvs[2*t+1];return this.vertexBuffer.upload(this.interleaved),this},t.prototype.destroy=function(){var t=this.gl;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)},t}();r.default=s},{"../../../utils/createIndicesForQuads":123,"pixi-gl-core":15}],96:[function(t,e,r){"use strict";r.__esModule=!0;var n=t("../../../math"),i=t("../../../const"),o=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../settings")),s=t("pixi-gl-core"),a=function(){function t(e,r,a,u,h,l){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.gl=e,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new n.Rectangle(0,0,1,1),this.resolution=h||o.default.RESOLUTION,this.projectionMatrix=new n.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new n.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.filterPoolKey="",this.scaleMode=void 0!==u?u:o.default.SCALE_MODE,this.root=l,this.root?(this.frameBuffer=new s.GLFramebuffer(e,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=s.GLFramebuffer.createRGBA(e,100,100),this.scaleMode===i.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(r,a)}return t.prototype.clear=function(t){var e=t||this.clearColor;this.frameBuffer.clear(e[0],e[1],e[2],e[3])},t.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},t.prototype.setFrame=function(t,e){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||this.destinationFrame},t.prototype.activate=function(){var t=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame!==this.sourceFrame?(t.enable(t.SCISSOR_TEST),t.scissor(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):t.disable(t.SCISSOR_TEST),t.viewport(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)},t.prototype.calculateProjection=function(t,e){var r=this.projectionMatrix;e=e||t,r.identity(),this.root?(r.a=1/t.width*2,r.d=-1/t.height*2,r.tx=-1-e.x*r.a,r.ty=1-e.y*r.d):(r.a=1/t.width*2,r.d=1/t.height*2,r.tx=-1-e.x*r.a,r.ty=-1-e.y*r.d)},t.prototype.resize=function(t,e){if(t|=0,e|=0,this.size.width!==t||this.size.height!==e){this.size.width=t,this.size.height=e,this.defaultFrame.width=t,this.defaultFrame.height=e,this.frameBuffer.resize(t*this.resolution,e*this.resolution);var r=this.frame||this.size;this.calculateProjection(r)}},t.prototype.destroy=function(){this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null},t}();r.default=a},{"../../../const":46,"../../../math":70,"../../../settings":101,"pixi-gl-core":15}],97:[function(t,e,r){"use strict";function n(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}r.__esModule=!0,r.default=function(t,e){var r=!e;if(r){var s=document.createElement("canvas");s.width=1,s.height=1,e=i.default.createContext(s)}for(var a=e.createShader(e.FRAGMENT_SHADER);;){var u=o.replace(/%forloop%/gi,n(t));if(e.shaderSource(a,u),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS))break;t=t/2|0}return r&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").loseContext(),t};var i=function(t){return t&&t.__esModule?t:{default:t}}(t("pixi-gl-core")),o=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n")},{"pixi-gl-core":15}],98:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[n.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.ADD]=[t.ONE,t.DST_ALPHA],e[n.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR],e[n.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.ADD_NPM]=[t.SRC_ALPHA,t.DST_ALPHA,t.ONE,t.DST_ALPHA],e[n.BLEND_MODES.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_COLOR],e};var n=t("../../../const")},{"../../../const":46}],99:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e[n.DRAW_MODES.POINTS]=t.POINTS,e[n.DRAW_MODES.LINES]=t.LINES,e[n.DRAW_MODES.LINE_LOOP]=t.LINE_LOOP,e[n.DRAW_MODES.LINE_STRIP]=t.LINE_STRIP,e[n.DRAW_MODES.TRIANGLES]=t.TRIANGLES,e[n.DRAW_MODES.TRIANGLE_STRIP]=t.TRIANGLE_STRIP,e[n.DRAW_MODES.TRIANGLE_FAN]=t.TRIANGLE_FAN,e};var n=t("../../../const")},{"../../../const":46}],100:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}},{}],101:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("./utils/maxRecommendedTextures")),o=n(t("./utils/canUploadSameBuffer"));r.default={TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,i.default)(32),SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@([0-9\.]+)x/,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1,width:800,height:600,legacy:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:"mediump",CAN_UPLOAD_SAME_BUFFER:(0,o.default)(),MESH_CANVAS_PADDING:0}},{"./utils/canUploadSameBuffer":122,"./utils/maxRecommendedTextures":127}],102:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("../math"),s=t("../utils"),a=t("../const"),u=n(t("../textures/Texture")),h=n(t("../display/Container")),l=new o.Point,c=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n._anchor=new o.ObservablePoint(n._onAnchorUpdate,n,r?r.defaultAnchor.x:0,r?r.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=a.BLEND_MODES.NORMAL,n.shader=null,n.cachedTint=16777215,n.texture=r||u.default.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.pluginName="sprite",n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this.cachedTint=16777215,this._width&&(this.scale.x=(0,s.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,s.sign)(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID||this._textureID!==this._texture._updateID){this._transformID=this.transform._worldID,this._textureID=this._texture._updateID;var t=this._texture,e=this.transform.worldTransform,r=e.a,n=e.b,i=e.c,o=e.d,s=e.tx,a=e.ty,u=this.vertexData,h=t.trim,l=t.orig,c=this._anchor,d=0,f=0,p=0,v=0;h?(d=(f=h.x-c._x*l.width)+h.width,p=(v=h.y-c._y*l.height)+h.height):(d=(f=-c._x*l.width)+l.width,p=(v=-c._y*l.height)+l.height),u[0]=r*f+i*v+s,u[1]=o*v+n*f+a,u[2]=r*d+i*v+s,u[3]=o*v+n*d+a,u[4]=r*d+i*p+s,u[5]=o*p+n*d+a,u[6]=r*f+i*p+s,u[7]=o*p+n*f+a}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,r=t.orig,n=this._anchor,i=this.transform.worldTransform,o=i.a,s=i.b,a=i.c,u=i.d,h=i.tx,l=i.ty,c=-n._x*r.width,d=c+r.width,f=-n._y*r.height,p=f+r.height;e[0]=o*c+a*f+h,e[1]=u*f+s*c+l,e[2]=o*d+a*f+h,e[3]=u*f+s*d+l,e[4]=o*d+a*p+h,e[5]=u*p+s*d+l,e[6]=o*c+a*p+h,e[7]=u*p+s*c+l},e.prototype._renderWebGL=function(t){this.calculateVertices(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._renderCanvas=function(t){t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new o.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,l);var e=this._texture.orig.width,r=this._texture.orig.height,n=-e*this.anchor.x,i=0;return l.x>=n&&l.x<n+e&&(i=-r*this.anchor.y,l.y>=i&&l.y<i+r)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var r="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!r)}this._texture=null,this.shader=null},e.from=function(t){return new e(u.default.from(t))},e.fromFrame=function(t){var r=s.TextureCache[t];if(!r)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return new e(r)},e.fromImage=function(t,r,n){return new e(u.default.fromImage(t,r,n))},i(e,[{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=(0,s.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=(0,s.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"anchor",get:function(){return this._anchor},set:function(t){this._anchor.copy(t)}},{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t||u.default.EMPTY,this.cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}]),e}(h.default);r.default=c},{"../const":46,"../display/Container":48,"../math":70,"../textures/Texture":115,"../utils":125}],103:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("../../renderers/canvas/CanvasRenderer")),o=t("../../const"),s=t("../../math"),a=n(t("./CanvasTinter")),u=new s.Matrix,h=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e}return t.prototype.render=function(t){var e=t._texture,r=this.renderer,n=e._frame.width,i=e._frame.height,h=t.transform.worldTransform,l=0,c=0;if(!(e.orig.width<=0||e.orig.height<=0)&&e.baseTexture.source&&(r.setBlendMode(t.blendMode),e.valid)){r.context.globalAlpha=t.worldAlpha;var d=e.baseTexture.scaleMode===o.SCALE_MODES.LINEAR;r.smoothProperty&&r.context[r.smoothProperty]!==d&&(r.context[r.smoothProperty]=d),e.trim?(l=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,c=e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(l=(.5-t.anchor.x)*e.orig.width,c=(.5-t.anchor.y)*e.orig.height),e.rotate&&(h.copy(u),h=u,s.GroupD8.matrixAppendRotationInv(h,e.rotate,l,c),l=0,c=0),l-=n/2,c-=i/2,r.roundPixels?(r.context.setTransform(h.a,h.b,h.c,h.d,h.tx*r.resolution|0,h.ty*r.resolution|0),l|=0,c|=0):r.context.setTransform(h.a,h.b,h.c,h.d,h.tx*r.resolution,h.ty*r.resolution);var f=e.baseTexture.resolution;16777215!==t.tint?(t.cachedTint===t.tint&&t.tintedTexture.tintId===t._texture._updateID||(t.cachedTint=t.tint,t.tintedTexture=a.default.getTintedTexture(t,t.tint)),r.context.drawImage(t.tintedTexture,0,0,n*f,i*f,l*r.resolution,c*r.resolution,n*r.resolution,i*r.resolution)):r.context.drawImage(e.baseTexture.source,e._frame.x*f,e._frame.y*f,n*f,i*f,l*r.resolution,c*r.resolution,n*r.resolution,i*r.resolution)}},t.prototype.destroy=function(){this.renderer=null},t}();r.default=h,i.default.registerPlugin("sprite",h)},{"../../const":46,"../../math":70,"../../renderers/canvas/CanvasRenderer":77,"./CanvasTinter":104}],104:[function(t,e,r){"use strict";r.__esModule=!0;var n=t("../../utils"),i={getTintedTexture:function(t,e){var r=t._texture,n="#"+("00000"+(0|(e=i.roundColor(e))).toString(16)).substr(-6);r.tintCache=r.tintCache||{};var o=r.tintCache[n],s=void 0;if(o){if(o.tintId===r._updateID)return r.tintCache[n];s=r.tintCache[n]}else s=i.canvas||document.createElement("canvas");if(i.tintMethod(r,e,s),s.tintId=r._updateID,i.convertTintToImage){var a=new Image;a.src=s.toDataURL(),r.tintCache[n]=a}else r.tintCache[n]=s,i.canvas=null;return s},tintWithMultiply:function(t,e,r){var n=r.getContext("2d"),i=t._frame.clone(),o=t.baseTexture.resolution;i.x*=o,i.y*=o,i.width*=o,i.height*=o,r.width=Math.ceil(i.width),r.height=Math.ceil(i.height),n.save(),n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,i.width,i.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.restore()},tintWithOverlay:function(t,e,r){var n=r.getContext("2d"),i=t._frame.clone(),o=t.baseTexture.resolution;i.x*=o,i.y*=o,i.width*=o,i.height*=o,r.width=Math.ceil(i.width),r.height=Math.ceil(i.height),n.save(),n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,i.width,i.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.restore()},tintWithPerPixel:function(t,e,r){var i=r.getContext("2d"),o=t._frame.clone(),s=t.baseTexture.resolution;o.x*=s,o.y*=s,o.width*=s,o.height*=s,r.width=Math.ceil(o.width),r.height=Math.ceil(o.height),i.save(),i.globalCompositeOperation="copy",i.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),i.restore();for(var a=(0,n.hex2rgb)(e),u=a[0],h=a[1],l=a[2],c=i.getImageData(0,0,o.width,o.height),d=c.data,f=0;f<d.length;f+=4)d[f+0]*=u,d[f+1]*=h,d[f+2]*=l;i.putImageData(c,0,0)},roundColor:function(t){var e=i.cacheStepsPerColorChannel,r=(0,n.hex2rgb)(t);return r[0]=Math.min(255,r[0]/e*e),r[1]=Math.min(255,r[1]/e*e),r[2]=Math.min(255,r[2]/e*e),(0,n.rgb2hex)(r)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,function(t){return t&&t.__esModule?t:{default:t}}(t("../../renderers/canvas/utils/canUseNewCanvasBlendModes")).default)(),tintMethod:0};i.tintMethod=i.canUseMultiply?i.tintWithMultiply:i.tintWithPerPixel,r.default=i},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":80,"../../utils":125}],105:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.vertices=new ArrayBuffer(e),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return t.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null},t}();r.default=n},{}],106:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("../../renderers/webgl/utils/ObjectRenderer")),o=n(t("../../renderers/webgl/WebGLRenderer")),s=n(t("../../utils/createIndicesForQuads")),a=n(t("./generateMultiTextureShader")),u=n(t("../../renderers/webgl/utils/checkMaxIfStatmentsInShader")),h=n(t("./BatchBuffer")),l=n(t("../../settings")),c=t("../../utils"),d=n(t("pixi-gl-core")),f=n(t("bit-twiddle")),p=0,v=0,g=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));n.vertSize=5,n.vertByteSize=4*n.vertSize,n.size=l.default.SPRITE_BATCH_SIZE,n.buffers=[];for(var i=1;i<=f.default.nextPow2(n.size);i*=2)n.buffers.push(new h.default(4*i*n.vertByteSize));n.indices=(0,s.default)(n.size),n.shader=null,n.currentIndex=0,n.groups=[];for(var o=0;o<n.size;o++)n.groups[o]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};return n.sprites=[],n.vertexBuffers=[],n.vaos=[],n.vaoMax=2,n.vertexCount=0,n.renderer.on("prerender",n.onPrerender,n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.renderer.legacy?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),l.default.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=(0,u.default)(this.MAX_TEXTURES,t)),this.shader=(0,a.default)(t,this.MAX_TEXTURES),this.indexBuffer=d.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.renderer.bindVao(null);for(var e=this.shader.attributes,r=0;r<this.vaoMax;r++){var n=this.vertexBuffers[r]=d.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),i=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(n,e.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(n,e.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(n,e.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12);e.aTextureId&&i.addAttribute(n,e.aTextureId,t.FLOAT,!1,this.vertByteSize,16),this.vaos[r]=i}this.vao=this.vaos[0],this.currentBlendMode=99999,this.boundTextures=new Array(this.MAX_TEXTURES)},e.prototype.onPrerender=function(){this.vertexCount=0},e.prototype.render=function(t){this.currentIndex>=this.size&&this.flush(),t._texture._uvs&&(this.sprites[this.currentIndex++]=t)},e.prototype.flush=function(){if(0!==this.currentIndex){var t=this.renderer.gl,e=this.MAX_TEXTURES,r=f.default.nextPow2(this.currentIndex),n=f.default.log2(r),i=this.buffers[n],o=this.sprites,s=this.groups,a=i.float32View,u=i.uint32View,h=this.boundTextures,g=this.renderer.boundTextures,y=this.renderer.textureGC.count,m=0,_=void 0,b=void 0,x=1,T=0,w=s[0],E=void 0,S=void 0,O=c.premultiplyBlendMode[o[0]._texture.baseTexture.premultipliedAlpha?1:0][o[0].blendMode];w.textureCount=0,w.start=0,w.blend=O,p++;var M=void 0;for(M=0;M<e;++M){var P=g[M];P._enabled!==p?(h[M]=P,P._virtalBoundId=M,P._enabled=p):h[M]=this.renderer.emptyTextures[M]}for(p++,M=0;M<this.currentIndex;++M){var C=o[M];o[M]=null,_=C._texture.baseTexture;var R=c.premultiplyBlendMode[Number(_.premultipliedAlpha)][C.blendMode];if(O!==R&&(O=R,b=null,T=e,p++),b!==_&&(b=_,_._enabled!==p)){if(T===e&&(p++,w.size=M-w.start,T=0,(w=s[x++]).blend=O,w.textureCount=0,w.start=M),_.touched=y,-1===_._virtalBoundId)for(var A=0;A<e;++A){var I=(A+v)%e,D=h[I];if(D._enabled!==p){v++,D._virtalBoundId=-1,_._virtalBoundId=I,h[I]=_;break}}_._enabled=p,w.textureCount++,w.ids[T]=_._virtalBoundId,w.textures[T++]=_}if(E=C.vertexData,S=C._texture._uvs.uvsUint32,this.renderer.roundPixels){var L=this.renderer.resolution;a[m]=(E[0]*L|0)/L,a[m+1]=(E[1]*L|0)/L,a[m+5]=(E[2]*L|0)/L,a[m+6]=(E[3]*L|0)/L,a[m+10]=(E[4]*L|0)/L,a[m+11]=(E[5]*L|0)/L,a[m+15]=(E[6]*L|0)/L,a[m+16]=(E[7]*L|0)/L}else a[m]=E[0],a[m+1]=E[1],a[m+5]=E[2],a[m+6]=E[3],a[m+10]=E[4],a[m+11]=E[5],a[m+15]=E[6],a[m+16]=E[7];u[m+2]=S[0],u[m+7]=S[1],u[m+12]=S[2],u[m+17]=S[3];var N=Math.min(C.worldAlpha,1),B=N<1&&_.premultipliedAlpha?(0,c.premultiplyTint)(C._tintRGB,N):C._tintRGB+(255*N<<24);u[m+3]=u[m+8]=u[m+13]=u[m+18]=B,a[m+4]=a[m+9]=a[m+14]=a[m+19]=_._virtalBoundId,m+=20}if(w.size=M-w.start,l.default.CAN_UPLOAD_SAME_BUFFER)this.vertexBuffers[this.vertexCount].upload(i.vertices,0,!0);else{if(this.vaoMax<=this.vertexCount){this.vaoMax++;var F=this.shader.attributes,k=this.vertexBuffers[this.vertexCount]=d.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),j=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(k,F.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(k,F.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(k,F.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12);F.aTextureId&&j.addAttribute(k,F.aTextureId,t.FLOAT,!1,this.vertByteSize,16),this.vaos[this.vertexCount]=j}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(i.vertices,0,!1),this.vertexCount++}for(M=0;M<e;++M)g[M]._virtalBoundId=-1;for(M=0;M<x;++M){for(var U=s[M],X=U.textureCount,G=0;G<X;G++)b=U.textures[G],g[U.ids[G]]!==b&&this.renderer.bindTexture(b,U.ids[G],!0),b._virtalBoundId=-1;this.renderer.state.setBlendMode(U.blend),t.drawElements(t.TRIANGLES,6*U.size,t.UNSIGNED_SHORT,6*U.start*2)}this.currentIndex=0}},e.prototype.start=function(){this.renderer.bindShader(this.shader),l.default.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this.vaoMax;e++)this.vertexBuffers[e]&&this.vertexBuffers[e].destroy(),this.vaos[e]&&this.vaos[e].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var r=0;r<this.buffers.length;++r)this.buffers[r].destroy()},e}(i.default);r.default=g,o.default.registerPlugin("sprite",g)},{"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":97,"../../settings":101,"../../utils":125,"../../utils/createIndicesForQuads":123,"./BatchBuffer":105,"./generateMultiTextureShader":107,"bit-twiddle":1,"pixi-gl-core":15}],107:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e){var r=i;r=(r=r.replace(/%count%/gi,e)).replace(/%forloop%/gi,function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(textureId == "+r+".0)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}(e));for(var o=new n.default(t,"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n",r),s=[],a=0;a<e;a++)s[a]=a;return o.bind(),o.uniforms.uSamplers=s,o};var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../Shader")),i=(t("path"),["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","float textureId = floor(vTextureId+0.5);","%forloop%","gl_FragColor = color * vColor;","}"].join("\n"))},{"../../Shader":44,path:8}],108:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=n(t("../sprites/Sprite")),s=n(t("../textures/Texture")),a=t("../math"),u=t("../utils"),h=t("../const"),l=n(t("../settings")),c=n(t("./TextStyle")),d=n(t("./TextMetrics")),f=n(t("../utils/trimCanvas")),p={texture:!0,children:!1,baseTexture:!0},v=function(t){function e(r,n,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),(i=i||document.createElement("canvas")).width=3,i.height=3;var o=s.default.fromCanvas(i,l.default.SCALE_MODE,"text");o.orig=new a.Rectangle,o.trim=new a.Rectangle;var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,o));return s.default.addToCache(u._texture,u._texture.baseTexture.textureCacheIds[0]),u.canvas=i,u.context=u.canvas.getContext("2d"),u.resolution=l.default.RESOLUTION,u._text=null,u._style=null,u._styleListener=null,u._font="",u.text=r,u.style=n,u.localStyleID=-1,u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var r=this.context,n=d.default.measureText(this._text,this._style,this._style.wordWrap,this.canvas),i=n.width,o=n.height,s=n.lines,a=n.lineHeight,u=n.lineWidths,h=n.maxLineWidth,l=n.fontProperties;this.canvas.width=Math.ceil((Math.max(1,i)+2*e.padding)*this.resolution),this.canvas.height=Math.ceil((Math.max(1,o)+2*e.padding)*this.resolution),r.scale(this.resolution,this.resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.strokeStyle=e.stroke,r.lineWidth=e.strokeThickness,r.textBaseline=e.textBaseline,r.lineJoin=e.lineJoin,r.miterLimit=e.miterLimit;var c=void 0,f=void 0;if(e.dropShadow){r.fillStyle=e.dropShadowColor,r.globalAlpha=e.dropShadowAlpha,r.shadowBlur=e.dropShadowBlur,e.dropShadowBlur>0&&(r.shadowColor=e.dropShadowColor);for(var p=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,v=Math.sin(e.dropShadowAngle)*e.dropShadowDistance,g=0;g<s.length;g++)c=e.strokeThickness/2,f=e.strokeThickness/2+g*a+l.ascent,"right"===e.align?c+=h-u[g]:"center"===e.align&&(c+=(h-u[g])/2),e.fill&&(this.drawLetterSpacing(s[g],c+p+e.padding,f+v+e.padding),e.stroke&&e.strokeThickness&&(r.strokeStyle=e.dropShadowColor,this.drawLetterSpacing(s[g],c+p+e.padding,f+v+e.padding,!0),r.strokeStyle=e.stroke))}r.shadowBlur=0,r.globalAlpha=1,r.fillStyle=this._generateFillStyle(e,s);for(var y=0;y<s.length;y++)c=e.strokeThickness/2,f=e.strokeThickness/2+y*a+l.ascent,"right"===e.align?c+=h-u[y]:"center"===e.align&&(c+=(h-u[y])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(s[y],c+e.padding,f+e.padding,!0),e.fill&&this.drawLetterSpacing(s[y],c+e.padding,f+e.padding);this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this._style.letterSpacing;if(0!==i)for(var o=String.prototype.split.call(t,""),s=e,a=0,u="";a<t.length;)u=o[a++],n?this.context.strokeText(u,s,r):this.context.fillText(u,s,r),s+=this.context.measureText(u).width+i;else n?this.context.strokeText(t,e,r):this.context.fillText(t,e,r)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=(0,f.default)(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var r=this._texture,n=this._style,i=n.trim?0:n.padding,o=r.baseTexture;o.hasLoaded=!0,o.resolution=this.resolution,o.realWidth=t.width,o.realHeight=t.height,o.width=t.width/this.resolution,o.height=t.height/this.resolution,r.trim.width=r._frame.width=t.width/this.resolution,r.trim.height=r._frame.height=t.height/this.resolution,r.trim.x=-i,r.trim.y=-i,r.orig.width=r._frame.width-2*i,r.orig.height=r._frame.height-2*i,this._onTextureUpdate(),o.emit("update",o),this.dirty=!1},e.prototype.renderWebGL=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype.renderWebGL.call(this,e)},e.prototype._renderCanvas=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._renderCanvas.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._onStyleChange=function(){this.dirty=!0},e.prototype._generateFillStyle=function(t,e){if(!Array.isArray(t.fill))return t.fill;if(navigator.isCocoonJS)return t.fill[0];var r=void 0,n=void 0,i=void 0,o=void 0,s=this.canvas.width/this.resolution,a=this.canvas.height/this.resolution,u=t.fill.slice(),l=t.fillGradientStops.slice();if(!l.length)for(var c=u.length+1,d=1;d<c;++d)l.push(d/c);if(u.unshift(t.fill[0]),l.unshift(0),u.push(t.fill[t.fill.length-1]),l.push(1),t.fillGradientType===h.TEXT_GRADIENT.LINEAR_VERTICAL){r=this.context.createLinearGradient(s/2,0,s/2,a),n=(u.length+1)*e.length,i=0;for(var f=0;f<e.length;f++){i+=1;for(var p=0;p<u.length;p++)o="number"==typeof l[p]?l[p]/e.length+f/e.length:i/n,r.addColorStop(o,u[p]),i++}}else{r=this.context.createLinearGradient(0,a/2,s,a/2),n=u.length+1,i=1;for(var v=0;v<u.length;v++)o="number"==typeof l[v]?l[v]:i/n,r.addColorStop(o,u[v]),i++}return r},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},p,e),t.prototype.destroy.call(this,e),this.context=null,this.canvas=null,this._style=null},i(e,[{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=(0,u.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=(0,u.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"style",get:function(){return this._style},set:function(t){(t=t||{})instanceof c.default?this._style=t:this._style=new c.default(t),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(t){t=String(""===t||null==t?" ":t),this._text!==t&&(this._text=t,this.dirty=!0)}}]),e}(o.default);r.default=v},{"../const":46,"../math":70,"../settings":101,"../sprites/Sprite":102,"../textures/Texture":115,"../utils":125,"../utils/trimCanvas":130,"./TextMetrics":109,"./TextStyle":110}],109:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(e,r,n,i,o,s,a,u,h){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.text=e,this.style=r,this.width=n,this.height=i,this.lines=o,this.lineWidths=s,this.lineHeight=a,this.maxLineWidth=u,this.fontProperties=h}return t.measureText=function(e,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t._canvas;n=null==n?r.wordWrap:n;var o=r.toFontString(),s=t.measureFont(o),a=i.getContext("2d");a.font=o;for(var u=(n?t.wordWrap(e,r,i):e).split(/(?:\r\n|\r|\n)/),h=new Array(u.length),l=0,c=0;c<u.length;c++){var d=a.measureText(u[c]).width+(u[c].length-1)*r.letterSpacing;h[c]=d,l=Math.max(l,d)}var f=l+r.strokeThickness;r.dropShadow&&(f+=r.dropShadowDistance);var p=r.lineHeight||s.fontSize+r.strokeThickness,v=Math.max(p,s.fontSize+r.strokeThickness)+(u.length-1)*(p+r.leading);return r.dropShadow&&(v+=r.dropShadowDistance),new t(e,r,f,v,u,h,p+r.leading,l,s)},t.wordWrap=function(e,r){for(var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:t._canvas).getContext("2d"),i=0,o="",s="",a={},u=r.letterSpacing,h=r.whiteSpace,l=t.collapseSpaces(h),c=t.collapseNewlines(h),d=!l,f=r.wordWrapWidth+u,p=t.tokenize(e),v=0;v<p.length;v++){var g=p[v];if(t.isNewline(g)){if(!c){s+=t.addLine(o),d=!l,o="",i=0;continue}g=" "}if(l){var y=t.isBreakingSpace(g),m=t.isBreakingSpace(o[o.length-1]);if(y&&m)continue}var _=t.getFromCache(g,u,a,n);if(_>f)if(""!==o&&(s+=t.addLine(o),o="",i=0),t.canBreakWords(g,r.breakWords))for(var b=g.split(""),x=0;x<b.length;x++){for(var T=b[x],w=1;b[x+w];){var E=b[x+w],S=T[T.length-1];if(t.canBreakChars(S,E,g,x,r.breakWords))break;T+=E,w++}x+=T.length-1;var O=t.getFromCache(T,u,a,n);O+i>f&&(s+=t.addLine(o),d=!1,o="",i=0),o+=T,i+=O}else{o.length>0&&(s+=t.addLine(o),o="",i=0);var M=v===p.length-1;s+=t.addLine(g,!M),d=!1,o="",i=0}else _+i>f&&(d=!1,s+=t.addLine(o),o="",i=0),(o.length>0||!t.isBreakingSpace(g)||d)&&(o+=g,i+=_)}return s+t.addLine(o,!1)},t.addLine=function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e=t.trimRight(e),r?e+"\n":e},t.getFromCache=function(t,e,r,n){var i=r[t];if(void 0===i){var o=t.length*e;i=n.measureText(t).width+o,r[t]=i}return i},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var r=e.length-1;r>=0;r--){var n=e[r];if(!t.isBreakingSpace(n))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var r=[],n="";if("string"!=typeof e)return r;for(var i=0;i<e.length;i++){var o=e[i];t.isBreakingSpace(o)||t.isNewline(o)?(""!==n&&(r.push(n),n=""),r.push(o)):n+=o}return""!==n&&r.push(n),r},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,r,n,i){return!0},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var r={},n=t._canvas,i=t._context;i.font=e;var o=t.METRICS_STRING+t.BASELINE_SYMBOL,s=Math.ceil(i.measureText(o).width),a=Math.ceil(i.measureText(t.BASELINE_SYMBOL).width),u=2*a;a=a*t.BASELINE_MULTIPLIER|0,n.width=s,n.height=u,i.fillStyle="#f00",i.fillRect(0,0,s,u),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,a);var h=i.getImageData(0,0,s,u).data,l=h.length,c=4*s,d=0,f=0,p=!1;for(d=0;d<a;++d){for(var v=0;v<c;v+=4)if(255!==h[f+v]){p=!0;break}if(p)break;f+=c}for(r.ascent=a-d,f=l-c,p=!1,d=u;d>a;--d){for(var g=0;g<c;g+=4)if(255!==h[f+g]){p=!0;break}if(p)break;f-=c}return r.descent=d-a,r.fontSize=r.ascent+r.descent,t._fonts[e]=r,r},t.clearMetrics=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e?delete t._fonts[e]:t._fonts={}},t}();r.default=n;var i=document.createElement("canvas");i.width=i.height=10,n._canvas=i,n._context=i.getContext("2d"),n._fonts={},n.METRICS_STRING="|Éq",n.BASELINE_SYMBOL="M",n.BASELINE_MULTIPLIER=1.4,n._newlines=[10,13],n._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},{}],110:[function(t,e,r){"use strict";function n(t){return"number"==typeof t?(0,u.hex2string)(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function i(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=n(t[e]);return t}return n(t)}function o(t,e,r){for(var n in r)Array.isArray(e[n])?t[n]=e[n].slice():t[n]=e[n]}r.__esModule=!0;var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("../const"),u=t("../utils"),h={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:a.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},l=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],c=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.styleID=0,this.reset(),o(this,e,e)}return t.prototype.clone=function(){var e={};return o(e,this,h),new t(e)},t.prototype.reset=function(){o(this,h,h)},t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var r=e.length-1;r>=0;r--){var n=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&l.indexOf(n)<0&&(n='"'+n+'"'),e[r]=n}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},s(t,[{key:"align",get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(t){var e=i(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(t){var e=i(t);this._fill!==e&&(this._fill=e,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}},{key:"leading",get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(t){var e=i(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)}},{key:"whiteSpace",get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}}]),t}();r.default=c},{"../const":46,"../utils":125}],111:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("./BaseTexture")),o=n(t("../settings")),s=function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,i=arguments[2],s=arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,null,i));return a.resolution=s||o.default.RESOLUTION,a.width=Math.ceil(r),a.height=Math.ceil(n),a.realWidth=a.width*a.resolution,a.realHeight=a.height*a.resolution,a.scaleMode=void 0!==i?i:o.default.SCALE_MODE,a.hasLoaded=!0,a._glRenderTargets={},a._canvasRenderTarget=null,a.valid=!1,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),t===this.width&&e===this.height||(this.valid=t>0&&e>0,this.width=t,this.height=e,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit("update",this))},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.renderer=null},e}(i.default);r.default=s},{"../settings":101,"./BaseTexture":112}],112:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("../utils"),o=n(t("../settings")),s=n(t("eventemitter3")),a=n(t("../utils/determineCrossOrigin")),u=n(t("bit-twiddle")),h=function(t){function e(r,n,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return a.uid=(0,i.uid)(),a.touched=0,a.resolution=s||o.default.RESOLUTION,a.width=100,a.height=100,a.realWidth=100,a.realHeight=100,a.scaleMode=void 0!==n?n:o.default.SCALE_MODE,a.hasLoaded=!1,a.isLoading=!1,a.source=null,a.origSource=null,a.imageType=null,a.sourceScale=1,a.premultipliedAlpha=!0,a.imageUrl=null,a.isPowerOfTwo=!1,a.mipmap=o.default.MIPMAP_TEXTURES,a.wrapMode=o.default.WRAP_MODE,a._glTextures={},a._enabled=0,a._virtalBoundId=-1,a._destroyed=!1,a.textureCacheIds=[],r&&a.loadSource(r),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.update=function(){"svg"!==this.imageType&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit("update",this)},e.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=u.default.isPow2(this.realWidth)&&u.default.isPow2(this.realHeight)},e.prototype.loadSource=function(t){var e=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,e&&this.source&&(this.source.onload=null,this.source.onerror=null);var r=!this.source;if(this.source=t,(t.src&&t.complete||t.getContext)&&t.width&&t.height)this._updateImageType(),"svg"===this.imageType?this._loadSvgSource():this._sourceLoaded(),r&&this.emit("loaded",this);else if(!t.getContext){this.isLoading=!0;var n=this;if(t.onload=function(){if(n._updateImageType(),t.onload=null,t.onerror=null,n.isLoading){if(n.isLoading=!1,n._sourceLoaded(),"svg"===n.imageType)return void n._loadSvgSource();n.emit("loaded",n)}},t.onerror=function(){t.onload=null,t.onerror=null,n.isLoading&&(n.isLoading=!1,n.emit("error",n))},t.complete&&t.src){if(t.onload=null,t.onerror=null,"svg"===n.imageType)return void n._loadSvgSource();this.isLoading=!1,t.width&&t.height?(this._sourceLoaded(),e&&this.emit("loaded",this)):e&&this.emit("error",this)}}},e.prototype._updateImageType=function(){if(this.imageUrl){var t=(0,i.decomposeDataUri)(this.imageUrl),e=void 0;if(t&&"image"===t.mediaType){var r=t.subType.split("+")[0];if(!(e=(0,i.getUrlFileExtension)("."+r)))throw new Error("Invalid image type in data URI.")}else(e=(0,i.getUrlFileExtension)(this.imageUrl))||(e="png");this.imageType=e}},e.prototype._loadSvgSource=function(){if("svg"===this.imageType){var t=(0,i.decomposeDataUri)(this.imageUrl);t?this._loadSvgSourceUsingDataUri(t):this._loadSvgSourceUsingXhr()}},e.prototype._loadSvgSourceUsingDataUri=function(t){var e=void 0;if("base64"===t.encoding){if(!atob)throw new Error("Your browser doesn't support base64 conversions.");e=atob(t.data)}else e=t.data;this._loadSvgSourceUsingString(e)},e.prototype._loadSvgSourceUsingXhr=function(){var t=this,e=new XMLHttpRequest;e.onload=function(){if(e.readyState!==e.DONE||200!==e.status)throw new Error("Failed to load SVG using XHR.");t._loadSvgSourceUsingString(e.response)},e.onerror=function(){return t.emit("error",t)},e.open("GET",this.imageUrl,!0),e.send()},e.prototype._loadSvgSourceUsingString=function(t){var r=(0,i.getSvgSize)(t),n=r.width,o=r.height;if(!n||!o)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");this.realWidth=Math.round(n*this.sourceScale),this.realHeight=Math.round(o*this.sourceScale),this._updateDimensions();var s=document.createElement("canvas");s.width=this.realWidth,s.height=this.realHeight,s._pixiId="canvas_"+(0,i.uid)(),s.getContext("2d").drawImage(this.source,0,0,n,o,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=s,e.addToCache(this,s._pixiId),this.isLoading=!1,this._sourceLoaded(),this.emit("loaded",this)},e.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},e.prototype.destroy=function(){this.imageUrl&&(delete i.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")),this.source=null,this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this._destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.updateSourceImage=function(t){this.source.src=t,this.loadSource(this.source)},e.fromImage=function(t,r,n,o){var s=i.BaseTextureCache[t];if(!s){var u=new Image;void 0===r&&0!==t.indexOf("data:")?u.crossOrigin=(0,a.default)(t):r&&(u.crossOrigin="string"==typeof r?r:"anonymous"),(s=new e(u,n)).imageUrl=t,o&&(s.sourceScale=o),s.resolution=(0,i.getResolutionOfUrl)(t),u.src=t,e.addToCache(s,t)}return s},e.fromCanvas=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas";t._pixiId||(t._pixiId=n+"_"+(0,i.uid)());var o=i.BaseTextureCache[t._pixiId];return o||(o=new e(t,r),e.addToCache(o,t._pixiId)),o},e.from=function(t,r,n){if("string"==typeof t)return e.fromImage(t,void 0,r,n);if(t instanceof HTMLImageElement){var o=t.src,s=i.BaseTextureCache[o];return s||((s=new e(t,r)).imageUrl=o,n&&(s.sourceScale=n),s.resolution=(0,i.getResolutionOfUrl)(o),e.addToCache(s,o)),s}return t instanceof HTMLCanvasElement?e.fromCanvas(t,r):t},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),i.BaseTextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=i.BaseTextureCache[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete i.BaseTextureCache[t],e}}else if(t&&t.textureCacheIds){for(var n=0;n<t.textureCacheIds.length;++n)delete i.BaseTextureCache[t.textureCacheIds[n]];return t.textureCacheIds.length=0,t}return null},e}(s.default);r.default=h},{"../settings":101,"../utils":125,"../utils/determineCrossOrigin":124,"bit-twiddle":1,eventemitter3:3}],113:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("./BaseRenderTexture")),o=function(t){function e(r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=null;if(!(r instanceof i.default)){var s=arguments[1],a=arguments[2],u=arguments[3],h=arguments[4];console.warn("Please use RenderTexture.create("+s+", "+a+") instead of the ctor directly."),o=arguments[0],n=null,r=new i.default(s,a,u,h)}var l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return l.legacyRenderer=o,l.valid=!0,l._updateUvs(),l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resize=function(t,e,r){t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r||this.baseTexture.resize(t,e),this._updateUvs()},e.create=function(t,r,n,o){return new e(new i.default(t,r,n,o))},e}(n(t("./Texture")).default);r.default=o},{"./BaseRenderTexture":111,"./Texture":115}],114:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=t("../"),o=t("../utils"),s=function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.baseTexture=e,this.textures={},this.animations={},this.data=r,this.resolution=this._updateResolution(n||this.baseTexture.imageUrl),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return n(t,null,[{key:"BATCH_SIZE",get:function(){return 1e3}}]),t.prototype._updateResolution=function(t){var e=this.data.meta.scale,r=(0,o.getResolutionOfUrl)(t,null);return null===r&&(r=void 0!==e?parseFloat(e):1),1!==r&&(this.baseTexture.resolution=r,this.baseTexture.update()),r},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},t.prototype._processFrames=function(e){for(var r=e,n=t.BATCH_SIZE,o=this.baseTexture.sourceScale;r-e<n&&r<this._frameKeys.length;){var s=this._frameKeys[r],a=this._frames[s],u=a.frame;if(u){var h,l=null,c=!1!==a.trimmed&&a.sourceSize?a.sourceSize:a.frame,d=new i.Rectangle(0,0,Math.floor(c.w*o)/this.resolution,Math.floor(c.h*o)/this.resolution);h=a.rotated?new i.Rectangle(Math.floor(u.x*o)/this.resolution,Math.floor(u.y*o)/this.resolution,Math.floor(u.h*o)/this.resolution,Math.floor(u.w*o)/this.resolution):new i.Rectangle(Math.floor(u.x*o)/this.resolution,Math.floor(u.y*o)/this.resolution,Math.floor(u.w*o)/this.resolution,Math.floor(u.h*o)/this.resolution),!1!==a.trimmed&&a.spriteSourceSize&&(l=new i.Rectangle(Math.floor(a.spriteSourceSize.x*o)/this.resolution,Math.floor(a.spriteSourceSize.y*o)/this.resolution,Math.floor(u.w*o)/this.resolution,Math.floor(u.h*o)/this.resolution)),this.textures[s]=new i.Texture(this.baseTexture,h,d,l,a.rotated?2:0,a.anchor),i.Texture.addToCache(this.textures[s],s)}r++}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];var r=t[e],n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var o;if(n){if(i>=r.length)break;o=r[i++]}else{if((i=r.next()).done)break;o=i.value}var s=o;this.animations[e].push(this.textures[s])}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())},0)},t.prototype.destroy=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&this.baseTexture.destroy(),this.baseTexture=null},t}();r.default=s},{"../":65,"../utils":125}],115:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}r.__esModule=!0;var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=n(t("./BaseTexture")),a=n(t("./VideoBaseTexture")),u=n(t("./TextureUvs")),h=n(t("eventemitter3")),l=t("../math"),c=t("../utils"),d=n(t("../settings")),f=function(t){function e(r,n,i,o,s,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));if(u.noFrame=!1,n||(u.noFrame=!0,n=new l.Rectangle(0,0,1,1)),r instanceof e&&(r=r.baseTexture),u.baseTexture=r,u._frame=n,u.trim=o,u.valid=!1,u.requiresUpdate=!1,u._uvs=null,u.orig=i||n,u._rotate=Number(s||0),!0===s)u._rotate=2;else if(u._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return r.hasLoaded?(u.noFrame&&(n=new l.Rectangle(0,0,r.width,r.height),r.on("update",u.onBaseTextureUpdated,u)),u.frame=n):r.once("loaded",u.onBaseTextureLoaded,u),u.defaultAnchor=a?new l.Point(a.x,a.y):new l.Point(0,0),u._updateID=0,u.transform=null,u.textureCacheIds=[],u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.update=function(){this.baseTexture.update()},e.prototype.onBaseTextureLoaded=function(t){this._updateID++,this.noFrame?this.frame=new l.Rectangle(0,0,t.width,t.height):this.frame=this._frame,this.baseTexture.on("update",this.onBaseTextureUpdated,this),this.emit("update",this)},e.prototype.onBaseTextureUpdated=function(t){this._updateID++,this._frame.width=t.width,this._frame.height=t.height,this.emit("update",this)},e.prototype.destroy=function(t){this.baseTexture&&(t&&(c.TextureCache[this.baseTexture.imageUrl]&&e.removeFromCache(this.baseTexture.imageUrl),this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame,this.orig,this.trim,this.rotate)},e.prototype._updateUvs=function(){this._uvs||(this._uvs=new u.default),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.fromImage=function(t,r,n,i){var o=c.TextureCache[t];return o||(o=new e(s.default.fromImage(t,r,n,i)),e.addToCache(o,t)),o},e.fromFrame=function(t){var e=c.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return e},e.fromCanvas=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas";return new e(s.default.fromCanvas(t,r,n))},e.fromVideo=function(t,r){return"string"==typeof t?e.fromVideoUrl(t,r):new e(a.default.fromVideo(t,r))},e.fromVideoUrl=function(t,r){return new e(a.default.fromUrl(t,r))},e.from=function(t){if("string"==typeof t){var r=c.TextureCache[t];return r||(null!==t.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)?e.fromVideoUrl(t):e.fromImage(t))}return t instanceof HTMLImageElement?new e(s.default.from(t)):t instanceof HTMLCanvasElement?e.fromCanvas(t,d.default.SCALE_MODE,"HTMLCanvasElement"):t instanceof HTMLVideoElement?e.fromVideo(t):t instanceof s.default?new e(t):t},e.fromLoader=function(t,r,n){var i=new s.default(t,void 0,(0,c.getResolutionOfUrl)(r)),o=new e(i);return i.imageUrl=r,n||(n=r),s.default.addToCache(o.baseTexture,n),e.addToCache(o,n),n!==r&&(s.default.addToCache(o.baseTexture,r),e.addToCache(o,r)),o},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),c.TextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=c.TextureCache[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete c.TextureCache[t],e}}else if(t&&t.textureCacheIds){for(var n=0;n<t.textureCacheIds.length;++n)c.TextureCache[t.textureCacheIds[n]]===t&&delete c.TextureCache[t.textureCacheIds[n]];return t.textureCacheIds.length=0,t}return null},o(e,[{key:"frame",get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,n=t.width,i=t.height,o=e+n>this.baseTexture.width,s=r+i>this.baseTexture.height;if(o||s){var a=o&&s?"and":"or",u="X: "+e+" + "+n+" = "+(e+n)+" > "+this.baseTexture.width,h="Y: "+r+" + "+i+" = "+(r+i)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+u+" "+a+" "+h)}this.valid=n&&i&&this.baseTexture.hasLoaded,this.trim||this.rotate||(this.orig=t),this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}}]),e}(h.default);r.default=f,f.EMPTY=new f(new s.default),i(f.EMPTY),i(f.EMPTY.baseTexture),f.WHITE=function(){var t=document.createElement("canvas");t.width=10,t.height=10;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,10,10),new f(new s.default(t))}(),i(f.WHITE),i(f.WHITE.baseTexture)},{"../math":70,"../settings":101,"../utils":125,"./BaseTexture":112,"./TextureUvs":117,"./VideoBaseTexture":118,eventemitter3:3}],116:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){return t&&t.__esModule?t:{default:t}}(t("../math/Matrix")),o=new i.default,s=function(){function t(e,r){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._texture=e,this.mapCoord=new i.default,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._lastTextureID=-1,this.clampOffset=0,this.clampMargin=void 0===r?.5:r}return t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,n=0;n<t.length;n+=2){var i=t[n],o=t[n+1];e[n]=i*r.a+o*r.c+r.tx,e[n+1]=i*r.b+o*r.d+r.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._lastTextureID===e._updateID)return!1;this._lastTextureID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var n=e.orig,i=e.trim;i&&(o.set(n.width/i.width,0,0,n.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(o));var s=e.baseTexture,a=this.uClampFrame,u=this.clampMargin/s.resolution,h=this.clampOffset;return a[0]=(e._frame.x+u+h)/s.width,a[1]=(e._frame.y+u+h)/s.height,a[2]=(e._frame.x+e._frame.width-u+h)/s.width,a[3]=(e._frame.y+e._frame.height-u+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,!0},n(t,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t,this._lastTextureID=-1}}]),t}();r.default=s},{"../math/Matrix":67}],117:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../math/GroupD8")),i=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}return t.prototype.set=function(t,e,r){var i=e.width,o=e.height;if(r){var s=t.width/2/i,a=t.height/2/o,u=t.x/i+s,h=t.y/o+a;r=n.default.add(r,n.default.NW),this.x0=u+s*n.default.uX(r),this.y0=h+a*n.default.uY(r),r=n.default.add(r,2),this.x1=u+s*n.default.uX(r),this.y1=h+a*n.default.uY(r),r=n.default.add(r,2),this.x2=u+s*n.default.uX(r),this.y2=h+a*n.default.uY(r),r=n.default.add(r,2),this.x3=u+s*n.default.uX(r),this.y3=h+a*n.default.uY(r)}else this.x0=t.x/i,this.y0=t.y/o,this.x1=(t.x+t.width)/i,this.y1=t.y/o,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/o,this.x3=t.x/i,this.y3=(t.y+t.height)/o;this.uvsUint32[0]=(65535*this.y0&65535)<<16|65535*this.x0&65535,this.uvsUint32[1]=(65535*this.y1&65535)<<16|65535*this.x1&65535,this.uvsUint32[2]=(65535*this.y2&65535)<<16|65535*this.x2&65535,this.uvsUint32[3]=(65535*this.y3&65535)<<16|65535*this.x3&65535},t}();r.default=i},{"../math/GroupD8":66}],118:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){e||(e="video/"+(t=t.split("?").shift().toLowerCase()).substr(t.lastIndexOf(".")+1));var r=document.createElement("source");return r.src=t,r.type=e,r}r.__esModule=!0;var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=n(t("./BaseTexture")),a=t("../utils"),u=t("../ticker"),h=t("../const"),l=n(t("../utils/determineCrossOrigin")),c=function(t){function e(r,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),!r)throw new Error("No video source element specified.");(r.readyState===r.HAVE_ENOUGH_DATA||r.readyState===r.HAVE_FUTURE_DATA)&&r.width&&r.height&&(r.complete=!0);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return i.width=r.videoWidth,i.height=r.videoHeight,i._autoUpdate=!0,i._isAutoUpdating=!1,i.autoPlay=!0,i.update=i.update.bind(i),i._onCanPlay=i._onCanPlay.bind(i),r.addEventListener("play",i._onPlayStart.bind(i)),r.addEventListener("pause",i._onPlayStop.bind(i)),i.hasLoaded=!1,i.__loaded=!1,i._isSourceReady()?i._onCanPlay():(r.addEventListener("canplay",i._onCanPlay),r.addEventListener("canplaythrough",i._onCanPlay)),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(u.shared.add(this.update,this,h.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0)},e.prototype._onPlayStop=function(){this._isAutoUpdating&&(u.shared.remove(this.update,this),this._isAutoUpdating=!1)},e.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())},e.prototype.destroy=function(){this._isAutoUpdating&&u.shared.remove(this.update,this),this.source&&this.source._pixiId&&(s.default.removeFromCache(this.source._pixiId),delete this.source._pixiId,this.source.pause(),this.source.src="",this.source.load()),t.prototype.destroy.call(this)},e.fromVideo=function(t,r){t._pixiId||(t._pixiId="video_"+(0,a.uid)());var n=a.BaseTextureCache[t._pixiId];return n||(n=new e(t,r),s.default.addToCache(n,t._pixiId)),n},e.fromUrl=function(t,r,n){var o=document.createElement("video");o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline","");var s=Array.isArray(t)?t[0].src||t[0]:t.src||t;if(void 0===n&&0!==s.indexOf("data:")?o.crossOrigin=(0,l.default)(s):n&&(o.crossOrigin="string"==typeof n?n:"anonymous"),Array.isArray(t))for(var a=0;a<t.length;++a)o.appendChild(i(t[a].src||t[a],t[a].mime));else o.appendChild(i(s,t.mime));return o.load(),e.fromVideo(o,r)},o(e,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(u.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(u.shared.add(this.update,this,h.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0))}}]),e}(s.default);r.default=c,c.fromUrls=c.fromUrl},{"../const":46,"../ticker":121,"../utils":125,"../utils/determineCrossOrigin":124,"./BaseTexture":112}],119:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=n(t("../settings")),s=t("../const"),a=n(t("./TickerListener")),u=function(){function t(){var e=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._head=new a.default(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/o.default.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.UPDATE_PRIORITY.NORMAL;return this._addListener(new a.default(t,e,r))},t.prototype.addOnce=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.UPDATE_PRIORITY.NORMAL;return this._addListener(new a.default(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null},t.prototype.update=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now(),e=void 0;if(t>this.lastTime){(e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*o.default.TARGET_FPMS*this.speed;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.elapsedMS=0;this.lastTime=t},i(t,[{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(Math.max(0,t)/1e3,o.default.TARGET_FPMS);this._maxElapsedMS=1/e}}]),t}();r.default=u},{"../const":46,"../settings":101,"./TickerListener":120}],120:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.fn=e,this.context=r,this.priority=n,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return e=e||null,this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}();r.default=n},{}],121:[function(t,e,r){"use strict";r.__esModule=!0,r.Ticker=r.shared=void 0;var n=function(t){return t&&t.__esModule?t:{default:t}}(t("./Ticker")),i=new n.default;i.autoStart=!0,i.destroy=function(){},r.shared=i,r.Ticker=n.default},{"./Ticker":119}],122:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(){return!(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))}},{}],123:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){for(var e=6*t,r=new Uint16Array(e),n=0,i=0;n<e;n+=6,i+=4)r[n+0]=i+0,r[n+1]=i+1,r[n+2]=i+2,r[n+3]=i+0,r[n+4]=i+2,r[n+5]=i+3;return r}},{}],124:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location;if(0===t.indexOf("data:"))return"";e=e||window.location,i||(i=document.createElement("a")),i.href=t;var r=!(t=n.default.parse(i.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&r&&t.protocol===e.protocol?"":"anonymous"};var n=function(t){return t&&t.__esModule?t:{default:t}}(t("url")),i=void 0},{url:38}],125:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.premultiplyBlendMode=r.BaseTextureCache=r.TextureCache=r.earcut=r.mixins=r.pluginTarget=r.EventEmitter=r.removeItems=r.isMobile=void 0,r.uid=function(){return++p},r.hex2rgb=function(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e},r.hex2string=function(t){return t=t.toString(16),"#"+("000000".substr(0,6-t.length)+t)},r.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},r.getResolutionOfUrl=function(t,e){var r=s.default.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1},r.decomposeDataUri=function(t){var e=o.DATA_URI.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}},r.getUrlFileExtension=function(t){var e=o.URL_FILE_EXTENSION.exec(t);if(e)return e[1].toLowerCase()},r.getSvgSize=function(t){var e=o.SVG_SIZE.exec(t),r={};return e&&(r[e[1]]=Math.round(parseFloat(e[3])),r[e[5]]=Math.round(parseFloat(e[7]))),r},r.skipHello=function(){v=!0},r.sayHello=function(t){if(!v){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["\n %c %c %c PixiJS "+o.VERSION+" - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log("PixiJS "+o.VERSION+" - "+t+" - http://www.pixijs.com/");v=!0}},r.isWebGLSupported=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),n=!(!r||!r.getContextAttributes().stencil);if(r){var i=r.getExtension("WEBGL_lose_context");i&&i.loseContext()}return r=null,n}catch(t){return!1}},r.sign=function(t){return 0===t?0:t<0?-1:1},r.destroyTextureCache=function(){var t=void 0;for(t in g)g[t].destroy();for(t in y)y[t].destroy()},r.clearTextureCache=function(){var t=void 0;for(t in g)delete g[t];for(t in y)delete y[t]},r.correctBlendMode=function(t,e){return m[e?1:0][t]},r.premultiplyTint=function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,n=t>>8&255,i=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((n=n*e+.5|0)<<8)+(i=i*e+.5|0)},r.premultiplyRgba=function(t,e,r,n){return r=r||new Float32Array(4),n||void 0===n?(r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e):(r[0]=t[0],r[1]=t[1],r[2]=t[2]),r[3]=e,r},r.premultiplyTintToRgba=function(t,e,r,n){return(r=r||new Float32Array(4))[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(255&t)/255,(n||void 0===n)&&(r[0]*=e,r[1]*=e,r[2]*=e),r[3]=e,r};var o=t("../const"),s=i(t("../settings")),a=i(t("eventemitter3")),u=i(t("./pluginTarget")),h=n(t("./mixin")),l=n(t("ismobilejs")),c=i(t("remove-array-items")),d=i(t("./mapPremultipliedBlendModes")),f=i(t("earcut")),p=0,v=!1;r.isMobile=l,r.removeItems=c.default,r.EventEmitter=a.default,r.pluginTarget=u.default,r.mixins=h,r.earcut=f.default;var g=r.TextureCache=Object.create(null),y=r.BaseTextureCache=Object.create(null),m=r.premultiplyBlendMode=(0,d.default)()},{"../const":46,"../settings":101,"./mapPremultipliedBlendModes":126,"./mixin":128,"./pluginTarget":129,earcut:2,eventemitter3:3,ismobilejs:4,"remove-array-items":31}],126:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[n.BLEND_MODES.NORMAL_NPM]=n.BLEND_MODES.NORMAL,t[n.BLEND_MODES.ADD_NPM]=n.BLEND_MODES.ADD,t[n.BLEND_MODES.SCREEN_NPM]=n.BLEND_MODES.SCREEN,e[n.BLEND_MODES.NORMAL]=n.BLEND_MODES.NORMAL_NPM,e[n.BLEND_MODES.ADD]=n.BLEND_MODES.ADD_NPM,e[n.BLEND_MODES.SCREEN]=n.BLEND_MODES.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i};var n=t("../const")},{"../const":46}],127:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){return n.default.tablet||n.default.phone?4:t};var n=function(t){return t&&t.__esModule?t:{default:t}}(t("ismobilejs"))},{ismobilejs:4}],128:[function(t,e,r){"use strict";function n(t,e){if(t&&e)for(var r=Object.keys(e),n=0;n<r.length;++n){var i=r[n];Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}}r.__esModule=!0,r.mixin=n,r.delayMixin=function(t,e){i.push(t,e)},r.performMixins=function(){for(var t=0;t<i.length;t+=2)n(i[t],i[t+1]);i.length=0};var i=[]},{}],129:[function(t,e,r){"use strict";r.__esModule=!0,r.default={mixin:function(t){!function(t){t.__plugins={},t.registerPlugin=function(e,r){t.__plugins[e]=r},t.prototype.initPlugins=function(){for(var e in this.plugins=this.plugins||{},t.__plugins)this.plugins[e]=new t.__plugins[e](this)},t.prototype.destroyPlugins=function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;this.plugins=null}}(t)}}},{}],130:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){var e=t.width,r=t.height,n=t.getContext("2d"),i=n.getImageData(0,0,e,r).data,o=i.length,s={top:null,left:null,right:null,bottom:null},a=null,u=void 0,h=void 0,l=void 0;for(u=0;u<o;u+=4)0!==i[u+3]&&(h=u/4%e,l=~~(u/4/e),null===s.top&&(s.top=l),null===s.left?s.left=h:h<s.left&&(s.left=h),null===s.right?s.right=h+1:s.right<h&&(s.right=h+1),null===s.bottom?s.bottom=l:s.bottom<l&&(s.bottom=l));return null!==s.top&&(e=s.right-s.left,r=s.bottom-s.top+1,a=n.getImageData(s.left,s.top,e,r)),{height:r,width:e,data:a}}},{}],131:[function(t,e,r){"use strict";function n(t){if(!i[t]){var e=(new Error).stack;void 0===e?console.warn("Deprecation Warning: ",t):(e=e.split("\n").splice(3).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cDeprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t),console.warn(e),console.groupEnd()):(console.warn("Deprecation Warning: ",t),console.warn(e))),i[t]=!0}}r.__esModule=!0,r.default=function(t){var e=t.mesh,r=t.particles,i=t.extras,o=t.filters,s=t.prepare,a=t.loaders,u=t.interaction;Object.defineProperties(t,{SpriteBatch:{get:function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")}},AssetLoader:{get:function(){throw new ReferenceError("The loader system was overhauled in PixiJS v3, please see the new PIXI.loaders.Loader class.")}},Stage:{get:function(){return n("You do not need to use a PIXI Stage any more, you can simply render any container."),t.Container}},DisplayObjectContainer:{get:function(){return n("DisplayObjectContainer has been shortened to Container, please use Container from now on."),t.Container}},Strip:{get:function(){return n("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),e.Mesh}},Rope:{get:function(){return n("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),e.Rope}},ParticleContainer:{get:function(){return n("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on."),r.ParticleContainer}},MovieClip:{get:function(){return n("The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite."),i.AnimatedSprite}},TilingSprite:{get:function(){return n("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),i.TilingSprite}},BitmapText:{get:function(){return n("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),i.BitmapText}},blendModes:{get:function(){return n("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),t.BLEND_MODES}},scaleModes:{get:function(){return n("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),t.SCALE_MODES}},BaseTextureCache:{get:function(){return n("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),t.utils.BaseTextureCache}},TextureCache:{get:function(){return n("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),t.utils.TextureCache}},math:{get:function(){return n("The math namespace is deprecated, please access members already accessible on PIXI."),t}},AbstractFilter:{get:function(){return n("AstractFilter has been renamed to Filter, please use PIXI.Filter"),t.Filter}},TransformManual:{get:function(){return n("TransformManual has been renamed to TransformBase, please update your pixi-spine"),t.TransformBase}},TARGET_FPMS:{get:function(){return n("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),t.settings.TARGET_FPMS},set:function(e){n("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),t.settings.TARGET_FPMS=e}},FILTER_RESOLUTION:{get:function(){return n("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),t.settings.FILTER_RESOLUTION},set:function(e){n("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),t.settings.FILTER_RESOLUTION=e}},RESOLUTION:{get:function(){return n("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),t.settings.RESOLUTION},set:function(e){n("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),t.settings.RESOLUTION=e}},MIPMAP_TEXTURES:{get:function(){return n("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),t.settings.MIPMAP_TEXTURES},set:function(e){n("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),t.settings.MIPMAP_TEXTURES=e}},SPRITE_BATCH_SIZE:{get:function(){return n("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),t.settings.SPRITE_BATCH_SIZE},set:function(e){n("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),t.settings.SPRITE_BATCH_SIZE=e}},SPRITE_MAX_TEXTURES:{get:function(){return n("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),t.settings.SPRITE_MAX_TEXTURES},set:function(e){n("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),t.settings.SPRITE_MAX_TEXTURES=e}},RETINA_PREFIX:{get:function(){return n("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),t.settings.RETINA_PREFIX},set:function(e){n("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),t.settings.RETINA_PREFIX=e}},DEFAULT_RENDER_OPTIONS:{get:function(){return n("PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS"),t.settings.RENDER_OPTIONS}}});for(var h=[{parent:"TRANSFORM_MODE",target:"TRANSFORM_MODE"},{parent:"GC_MODES",target:"GC_MODE"},{parent:"WRAP_MODES",target:"WRAP_MODE"},{parent:"SCALE_MODES",target:"SCALE_MODE"},{parent:"PRECISION",target:"PRECISION_FRAGMENT"}],l=0;l<h.length;l++)!function(e){var r=h[l];Object.defineProperty(t[r.parent],"DEFAULT",{get:function(){return n("PIXI."+r.parent+".DEFAULT has been deprecated, please use PIXI.settings."+r.target),t.settings[r.target]},set:function(e){n("PIXI."+r.parent+".DEFAULT has been deprecated, please use PIXI.settings."+r.target),t.settings[r.target]=e}})}();Object.defineProperties(t.settings,{PRECISION:{get:function(){return n("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),t.settings.PRECISION_FRAGMENT},set:function(e){n("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),t.settings.PRECISION_FRAGMENT=e}}}),i.AnimatedSprite&&Object.defineProperties(i,{MovieClip:{get:function(){return n("The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on."),i.AnimatedSprite}}}),i&&Object.defineProperties(i,{TextureTransform:{get:function(){return n("The TextureTransform class has been renamed to TextureMatrix, please use PIXI.TextureMatrix from now on."),t.TextureMatrix}}}),t.DisplayObject.prototype.generateTexture=function(t,e,r){return n("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)"),t.generateTexture(this,e,r)},t.Graphics.prototype.generateTexture=function(t,e){return n("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture"),this.generateCanvasTexture(t,e)},t.GroupD8.isSwapWidthHeight=function(e){return n("GroupD8.isSwapWidthHeight was renamed to GroupD8.isVertical"),t.GroupD8.isVertical(e)},t.RenderTexture.prototype.render=function(t,e,r,i){this.legacyRenderer.render(t,this,r,e,!i),n("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")},t.RenderTexture.prototype.getImage=function(t){return n("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)"),this.legacyRenderer.extract.image(t)},t.RenderTexture.prototype.getBase64=function(t){return n("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)"),this.legacyRenderer.extract.base64(t)},t.RenderTexture.prototype.getCanvas=function(t){return n("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)"),this.legacyRenderer.extract.canvas(t)},t.RenderTexture.prototype.getPixels=function(t){return n("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)"),this.legacyRenderer.pixels(t)},t.Sprite.prototype.setTexture=function(t){this.texture=t,n("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},i.BitmapText&&(i.BitmapText.prototype.setText=function(t){this.text=t,n("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")}),t.Text.prototype.setText=function(t){this.text=t,n("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},t.Text.calculateFontProperties=function(e){return n("Text.calculateFontProperties is now deprecated, please use the TextMetrics.measureFont"),t.TextMetrics.measureFont(e)},Object.defineProperties(t.Text,{fontPropertiesCache:{get:function(){return n("Text.fontPropertiesCache is deprecated"),t.TextMetrics._fonts}},fontPropertiesCanvas:{get:function(){return n("Text.fontPropertiesCanvas is deprecated"),t.TextMetrics._canvas}},fontPropertiesContext:{get:function(){return n("Text.fontPropertiesContext is deprecated"),t.TextMetrics._context}}}),t.Text.prototype.setStyle=function(t){this.style=t,n("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},t.Text.prototype.determineFontProperties=function(e){return n("determineFontProperties is now deprecated, please use TextMetrics.measureFont method"),t.TextMetrics.measureFont(e)},t.Text.getFontStyle=function(e){return n("getFontStyle is now deprecated, please use TextStyle.toFontString() instead"),(e=e||{})instanceof t.TextStyle||(e=new t.TextStyle(e)),e.toFontString()},Object.defineProperties(t.TextStyle.prototype,{font:{get:function(){n("text style property 'font' is now deprecated, please use the 'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on");var t="number"==typeof this._fontSize?this._fontSize+"px":this._fontSize;return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+t+" "+this._fontFamily},set:function(t){n("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on"),t.indexOf("italic")>1?this._fontStyle="italic":t.indexOf("oblique")>-1?this._fontStyle="oblique":this._fontStyle="normal",t.indexOf("small-caps")>-1?this._fontVariant="small-caps":this._fontVariant="normal";var e=t.split(" "),r=-1;this._fontSize=26;for(var i=0;i<e.length;++i)if(e[i].match(/(px|pt|em|%)/)){r=i,this._fontSize=e[i];break}this._fontWeight="normal";for(var o=0;o<r;++o)if(e[o].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=e[o];break}if(r>-1&&r<e.length-1){this._fontFamily="";for(var s=r+1;s<e.length;++s)this._fontFamily+=e[s]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.styleID++}}}),t.Texture.prototype.setFrame=function(t){this.frame=t,n("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")},t.Texture.addTextureToCache=function(e,r){t.Texture.addToCache(e,r),n("Texture.addTextureToCache is deprecated, please use Texture.addToCache from now on.")},t.Texture.removeTextureFromCache=function(e){return n("Texture.removeTextureFromCache is deprecated, please use Texture.removeFromCache from now on. Be aware that Texture.removeFromCache does not automatically its BaseTexture from the BaseTextureCache. For that, use BaseTexture.removeFromCache"),t.BaseTexture.removeFromCache(e),t.Texture.removeFromCache(e)},Object.defineProperties(o,{AbstractFilter:{get:function(){return n("AstractFilter has been renamed to Filter, please use PIXI.Filter"),t.AbstractFilter}},SpriteMaskFilter:{get:function(){return n("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),t.SpriteMaskFilter}},VoidFilter:{get:function(){return n("VoidFilter has been renamed to AlphaFilter, please use PIXI.filters.AlphaFilter"),o.AlphaFilter}}}),t.utils.uuid=function(){return n("utils.uuid() is deprecated, please use utils.uid() from now on."),t.utils.uid()},t.utils.canUseNewCanvasBlendModes=function(){return n("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on"),t.CanvasTinter.canUseMultiply};var c=!0;if(Object.defineProperty(t.utils,"_saidHello",{set:function(t){t&&(n("PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()"),this.skipHello()),c=t},get:function(){return c}}),s.BasePrepare&&(s.BasePrepare.prototype.register=function(t,e){return n("renderer.plugins.prepare.register is now deprecated, please use renderer.plugins.prepare.registerFindHook & renderer.plugins.prepare.registerUploadHook"),t&&this.registerFindHook(t),e&&this.registerUploadHook(e),this}),s.canvas&&Object.defineProperty(s.canvas,"UPLOADS_PER_FRAME",{set:function(){n("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return n("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),s.webgl&&Object.defineProperty(s.webgl,"UPLOADS_PER_FRAME",{set:function(){n("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return n("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),a.Loader){var d=a.Resource,f=a.Loader;Object.defineProperties(d.prototype,{isJson:{get:function(){return n("The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`."),this.type===d.TYPE.JSON}},isXml:{get:function(){return n("The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`."),this.type===d.TYPE.XML}},isImage:{get:function(){return n("The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`."),this.type===d.TYPE.IMAGE}},isAudio:{get:function(){return n("The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`."),this.type===d.TYPE.AUDIO}},isVideo:{get:function(){return n("The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`."),this.type===d.TYPE.VIDEO}}}),Object.defineProperties(f.prototype,{before:{get:function(){return n("The before() method is deprecated, please use pre()."),this.pre}},after:{get:function(){return n("The after() method is deprecated, please use use()."),this.use}}})}u.interactiveTarget&&Object.defineProperty(u.interactiveTarget,"defaultCursor",{set:function(t){n("Property defaultCursor has been replaced with 'cursor'. "),this.cursor=t},get:function(){return n("Property defaultCursor has been replaced with 'cursor'. "),this.cursor}}),u.InteractionManager&&(Object.defineProperty(u.InteractionManager,"defaultCursorStyle",{set:function(t){n("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default=t},get:function(){return n("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default}}),Object.defineProperty(u.InteractionManager,"currentCursorStyle",{set:function(t){n("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode=t},get:function(){return n("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode}}))};var i={}},{}],132:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),i=new n.Rectangle,o=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e,e.extract=this}return t.prototype.image=function(t){var e=new Image;return e.src=this.base64(t),e},t.prototype.base64=function(t){return this.canvas(t).toDataURL()},t.prototype.canvas=function(t){var e=this.renderer,r=void 0,o=void 0,s=void 0,a=void 0;t&&(a=t instanceof n.RenderTexture?t:e.generateTexture(t)),a?(r=a.baseTexture._canvasRenderTarget.context,o=a.baseTexture._canvasRenderTarget.resolution,s=a.frame):(r=e.rootContext,(s=i).width=this.renderer.width,s.height=this.renderer.height);var u=s.width*o,h=s.height*o,l=new n.CanvasRenderTarget(u,h,1),c=r.getImageData(s.x*o,s.y*o,u,h);return l.context.putImageData(c,0,0),l.canvas},t.prototype.pixels=function(t){var e=this.renderer,r=void 0,o=void 0,s=void 0,a=void 0;return t&&(a=t instanceof n.RenderTexture?t:e.generateTexture(t)),a?(r=a.baseTexture._canvasRenderTarget.context,o=a.baseTexture._canvasRenderTarget.resolution,s=a.frame):(r=e.rootContext,(s=i).width=e.width,s.height=e.height),r.getImageData(0,0,s.width*o,s.height*o).data},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t}();r.default=o,n.CanvasRenderer.registerPlugin("extract",o)},{"../../core":65}],133:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./webgl/WebGLExtract");Object.defineProperty(r,"webgl",{enumerable:!0,get:function(){return n(i).default}});var o=t("./canvas/CanvasExtract");Object.defineProperty(r,"canvas",{enumerable:!0,get:function(){return n(o).default}})},{"./canvas/CanvasExtract":132,"./webgl/WebGLExtract":134}],134:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),i=new n.Rectangle,o=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e,e.extract=this}return t.prototype.image=function(t){var e=new Image;return e.src=this.base64(t),e},t.prototype.base64=function(t){return this.canvas(t).toDataURL()},t.prototype.canvas=function(t){var e=this.renderer,r=void 0,o=void 0,s=void 0,a=!1,u=void 0,h=!1;t&&(t instanceof n.RenderTexture?u=t:(u=this.renderer.generateTexture(t),h=!0)),u?(o=(r=u.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID]).resolution,s=u.frame,a=!1):(o=(r=this.renderer.rootRenderTarget).resolution,a=!0,(s=i).width=r.size.width,s.height=r.size.height);var l=s.width*o,c=s.height*o,d=new n.CanvasRenderTarget(l,c,1);if(r){e.bindRenderTarget(r);var f=new Uint8Array(4*l*c),p=e.gl;p.readPixels(s.x*o,s.y*o,l,c,p.RGBA,p.UNSIGNED_BYTE,f);var v=d.context.getImageData(0,0,l,c);v.data.set(f),d.context.putImageData(v,0,0),a&&(d.context.scale(1,-1),d.context.drawImage(d.canvas,0,-c))}return h&&u.destroy(!0),d.canvas},t.prototype.pixels=function(t){var e=this.renderer,r=void 0,o=void 0,s=void 0,a=void 0,u=!1;t&&(t instanceof n.RenderTexture?a=t:(a=this.renderer.generateTexture(t),u=!0)),a?(o=(r=a.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID]).resolution,s=a.frame):(o=(r=this.renderer.rootRenderTarget).resolution,(s=i).width=r.size.width,s.height=r.size.height);var h=s.width*o,l=s.height*o,c=new Uint8Array(4*h*l);if(r){e.bindRenderTarget(r);var d=e.gl;d.readPixels(s.x*o,s.y*o,h,l,d.RGBA,d.UNSIGNED_BYTE,c)}return u&&a.destroy(!0),c},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t}();r.default=o,n.WebGLRenderer.registerPlugin("extract",o)},{"../../core":65}],135:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),o=function(t){function e(r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r[0]instanceof i.Texture?r[0]:r[0].texture));return o._textures=null,o._durations=null,o.textures=r,o._autoUpdate=!1!==n,o.animationSpeed=1,o.loop=!0,o.onComplete=null,o.onFrameChange=null,o.onLoop=null,o._currentTime=0,o.playing=!1,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.stop=function(){this.playing&&(this.playing=!1,this._autoUpdate&&i.ticker.shared.remove(this.update,this))},e.prototype.play=function(){this.playing||(this.playing=!0,this._autoUpdate&&i.ticker.shared.add(this.update,this,i.UPDATE_PRIORITY.HIGH))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){var e=this.animationSpeed*t,r=this.currentFrame;if(null!==this._durations){var n=this._currentTime%1*this._durations[this.currentFrame];for(n+=e/60*1e3;n<0;)this._currentTime--,n+=this._durations[this.currentFrame];var i=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);n>=this._durations[this.currentFrame];)n-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=n/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r?this.onLoop():this.animationSpeed<0&&this.currentFrame>r&&this.onLoop()),this.updateTexture())},e.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame],this._textureID=-1,this.cachedTint=16777215,this.onFrameChange&&this.onFrameChange(this.currentFrame)},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e)},e.fromFrames=function(t){for(var r=[],n=0;n<t.length;++n)r.push(i.Texture.fromFrame(t[n]));return new e(r)},e.fromImages=function(t){for(var r=[],n=0;n<t.length;++n)r.push(i.Texture.fromImage(t[n]));return new e(r)},n(e,[{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(t){if(t[0]instanceof i.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this.gotoAndStop(0),this.updateTexture()}},{key:"currentFrame",get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}}]),e}(i.Sprite);r.default=o},{"../core":65}],136:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),s=n(t("../core/math/ObservablePoint")),a=t("../core/utils"),u=n(t("../core/settings")),h=function(t){function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i._textWidth=0,i._textHeight=0,i._glyphs=[],i._font={tint:void 0!==n.tint?n.tint:16777215,align:n.align||"left",name:null,size:0},i.font=n.font,i._text=r,i._maxWidth=0,i._maxLineHeight=0,i._letterSpacing=0,i._anchor=new s.default(function(){i.dirty=!0},i,0,0),i.dirty=!1,i.updateText(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateText=function(){for(var t=e.fonts[this._font.name],r=this._font.size/t.size,n=new o.Point,i=[],s=[],a=this.text.replace(/(?:\r\n|\r)/g,"\n"),u=a.length,h=this._maxWidth*t.size/this._font.size,l=null,c=0,d=0,f=0,p=-1,v=0,g=0,y=0,m=0;m<u;m++){var _=a.charCodeAt(m),b=a.charAt(m);if(/(?:\s)/.test(b)&&(p=m,v=c),"\r"!==b&&"\n"!==b){var x=t.chars[_];x&&(l&&x.kerning[l]&&(n.x+=x.kerning[l]),i.push({texture:x.texture,line:f,charCode:_,position:new o.Point(n.x+x.xOffset+this._letterSpacing/2,n.y+x.yOffset)}),n.x+=x.xAdvance+this._letterSpacing,c=n.x,y=Math.max(y,x.yOffset+x.texture.height),l=_,-1!==p&&h>0&&n.x>h&&(++g,o.utils.removeItems(i,1+p-g,1+m-p),m=p,p=-1,s.push(v),d=Math.max(d,v),f++,n.x=0,n.y+=t.lineHeight,l=null))}else s.push(c),d=Math.max(d,c),++f,++g,n.x=0,n.y+=t.lineHeight,l=null}var T=a.charAt(a.length-1);"\r"!==T&&"\n"!==T&&(/(?:\s)/.test(T)&&(c=v),s.push(c),d=Math.max(d,c));for(var w=[],E=0;E<=f;E++){var S=0;"right"===this._font.align?S=d-s[E]:"center"===this._font.align&&(S=(d-s[E])/2),w.push(S)}for(var O=i.length,M=this.tint,P=0;P<O;P++){var C=this._glyphs[P];C?C.texture=i[P].texture:(C=new o.Sprite(i[P].texture),this._glyphs.push(C)),C.position.x=(i[P].position.x+w[i[P].line])*r,C.position.y=i[P].position.y*r,C.scale.x=C.scale.y=r,C.tint=M,C.parent||this.addChild(C)}for(var R=O;R<this._glyphs.length;++R)this.removeChild(this._glyphs[R]);if(this._textWidth=d*r,this._textHeight=(n.y+t.lineHeight)*r,0!==this.anchor.x||0!==this.anchor.y)for(var A=0;A<O;A++)this._glyphs[A].x-=this._textWidth*this.anchor.x,this._glyphs[A].y-=this._textHeight*this.anchor.y;this._maxLineHeight=y*r},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},e.registerFont=function(t,r){var n={},i=t.getElementsByTagName("info")[0],s=t.getElementsByTagName("common")[0],h=t.getElementsByTagName("page"),l=(0,a.getResolutionOfUrl)(h[0].getAttribute("file"),u.default.RESOLUTION),c={};n.font=i.getAttribute("face"),n.size=parseInt(i.getAttribute("size"),10),n.lineHeight=parseInt(s.getAttribute("lineHeight"),10)/l,n.chars={},r instanceof o.Texture&&(r=[r]);for(var d=0;d<h.length;d++){var f=h[d].getAttribute("id"),p=h[d].getAttribute("file");c[f]=r instanceof Array?r[d]:r[p]}for(var v=t.getElementsByTagName("char"),g=0;g<v.length;g++){var y=v[g],m=parseInt(y.getAttribute("id"),10),_=y.getAttribute("page")||0,b=new o.Rectangle(parseInt(y.getAttribute("x"),10)/l+c[_].frame.x/l,parseInt(y.getAttribute("y"),10)/l+c[_].frame.y/l,parseInt(y.getAttribute("width"),10)/l,parseInt(y.getAttribute("height"),10)/l);n.chars[m]={xOffset:parseInt(y.getAttribute("xoffset"),10)/l,yOffset:parseInt(y.getAttribute("yoffset"),10)/l,xAdvance:parseInt(y.getAttribute("xadvance"),10)/l,kerning:{},texture:new o.Texture(c[_].baseTexture,b),page:_}}for(var x=t.getElementsByTagName("kerning"),T=0;T<x.length;T++){var w=x[T],E=parseInt(w.getAttribute("first"),10)/l,S=parseInt(w.getAttribute("second"),10)/l,O=parseInt(w.getAttribute("amount"),10)/l;n.chars[S]&&(n.chars[S].kerning[E]=O)}return e.fonts[n.font]=n,n},i(e,[{key:"tint",get:function(){return this._font.tint},set:function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0}},{key:"align",get:function(){return this._font.align},set:function(t){this._font.align=t||"left",this.dirty=!0}},{key:"anchor",get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copy(t)}},{key:"font",get:function(){return this._font},set:function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):e.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)}},{key:"text",get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}},{key:"maxLineHeight",get:function(){return this.validate(),this._maxLineHeight}},{key:"textWidth",get:function(){return this.validate(),this._textWidth}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}},{key:"textHeight",get:function(){return this.validate(),this._textHeight}}]),e}(o.Container);r.default=h,h.fonts={}},{"../core":65,"../core/math/ObservablePoint":68,"../core/settings":101,"../core/utils":125}],137:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),o=function(t){return t&&t.__esModule?t:{default:t}}(t("../core/sprites/canvas/CanvasTinter")),s=new i.Point,a=function(t){function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return s.tileTransform=new i.TransformStatic,s._width=n,s._height=o,s._canvasPattern=null,s.uvTransform=r.transform||new i.TextureMatrix(r),s.pluginName="tilingSprite",s.uvRespectAnchor=!1,s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._onTextureUpdate=function(){this.uvTransform&&(this.uvTransform.texture=this._texture),this.cachedTint=16777215},e.prototype._renderWebGL=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvTransform.update(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.hasLoaded){var r=t.context,n=this.worldTransform,s=t.resolution,a=e.baseTexture,u=a.resolution,h=this.tilePosition.x/this.tileScale.x%e._frame.width*u,l=this.tilePosition.y/this.tileScale.y%e._frame.height*u;if(this._textureID!==this._texture._updateID||this.cachedTint!==this.tint){this._textureID=this._texture._updateID;var c=new i.CanvasRenderTarget(e._frame.width,e._frame.height,u);16777215!==this.tint?(this.tintedTexture=o.default.getTintedTexture(this,this.tint),c.context.drawImage(this.tintedTexture,0,0)):c.context.drawImage(a.source,-e._frame.x*u,-e._frame.y*u),this.cachedTint=this.tint,this._canvasPattern=c.context.createPattern(c.canvas,"repeat")}r.globalAlpha=this.worldAlpha,r.setTransform(n.a*s,n.b*s,n.c*s,n.d*s,n.tx*s,n.ty*s),t.setBlendMode(this.blendMode),r.fillStyle=this._canvasPattern,r.scale(this.tileScale.x/u,this.tileScale.y/u);var d=this.anchor.x*-this._width,f=this.anchor.y*-this._height;this.uvRespectAnchor?(r.translate(h,l),r.fillRect(-h+d,-l+f,this._width/this.tileScale.x*u,this._height/this.tileScale.y*u)):(r.translate(h+d,l+f),r.fillRect(-h,-l,this._width/this.tileScale.x*u,this._height/this.tileScale.y*u))}},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,r,n)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new i.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,s);var e=this._width,r=this._height,n=-e*this.anchor._x;if(s.x>=n&&s.x<n+e){var i=-r*this.anchor._y;if(s.y>=i&&s.y<i+r)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvTransform=null},e.from=function(t,r,n){return new e(i.Texture.from(t),r,n)},e.fromFrame=function(t,r,n){var o=i.utils.TextureCache[t];if(!o)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new e(o,r,n)},e.fromImage=function(t,r,n,o,s){return new e(i.Texture.fromImage(t,o,s),r,n)},n(e,[{key:"clampMargin",get:function(){return this.uvTransform.clampMargin},set:function(t){this.uvTransform.clampMargin=t,this.uvTransform.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copy(t)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copy(t)}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}}]),e}(i.Sprite);r.default=a},{"../core":65,"../core/sprites/canvas/CanvasTinter":104}],138:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),o=n(t("../core/textures/Texture")),s=n(t("../core/textures/BaseTexture")),a=t("../core/utils"),u=i.DisplayObject,h=new i.Matrix;u.prototype._cacheAsBitmap=!1,u.prototype._cacheData=!1;var l=function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.textureCacheId=null,this.originalRenderWebGL=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(u.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){if(this._cacheAsBitmap!==t){this._cacheAsBitmap=t;var e=void 0;t?(this._cacheData||(this._cacheData=new l),(e=this._cacheData).originalRenderWebGL=this.renderWebGL,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this._calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=e.originalRenderWebGL,this.renderCanvas=e.originalRenderCanvas,this._calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}}),u.prototype._renderCachedWebGL=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite._transformID=-1,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(t))},u.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.currentRenderer.flush();var r=this.getLocalBounds().clone();if(this._filters){var n=this._filters[0].padding;r.pad(n)}var u=t._activeRenderTarget,l=t.filterManager.filterStack,c=i.RenderTexture.create(0|r.width,0|r.height),d="cacheAsBitmap_"+(0,a.uid)();this._cacheData.textureCacheId=d,s.default.addToCache(c.baseTexture,d),o.default.addToCache(c,d);var f=h;f.tx=-r.x,f.ty=-r.y,this.transform.worldTransform.identity(),this.renderWebGL=this._cacheData.originalRenderWebGL,t.render(this,c,!0,f,!0),t.bindRenderTarget(u),t.filterManager.filterStack=l,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this._mask=null,this.filterArea=null;var p=new i.Sprite(c);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-r.x/r.width,p.anchor.y=-r.y/r.height,p.alpha=e,p._bounds=this._bounds,this._calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=p.containsPoint.bind(p)}},u.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite.renderCanvas(t))},u.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(),r=this.alpha;this.alpha=1;var n=t.context,u=i.RenderTexture.create(0|e.width,0|e.height),l="cacheAsBitmap_"+(0,a.uid)();this._cacheData.textureCacheId=l,s.default.addToCache(u.baseTexture,l),o.default.addToCache(u,l);var c=h;this.transform.localTransform.copy(c),c.invert(),c.tx-=e.x,c.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,u,!0,c,!1),t.context=n,this.renderCanvas=this._renderCachedCanvas,this._calculateBounds=this._calculateCachedBounds,this._mask=null,this.filterArea=null;var d=new i.Sprite(u);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-e.x/e.width,d.anchor.y=-e.y/e.height,d._bounds=this._bounds,d.alpha=r,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.updateTransform=this.displayObjectUpdateTransform,this._cacheData.sprite=d,this.containsPoint=d.containsPoint.bind(d)}},u.prototype._calculateCachedBounds=function(){this._cacheData.sprite._calculateBounds()},u.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},u.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,s.default.removeFromCache(this._cacheData.textureCacheId),o.default.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},u.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)}},{"../core":65,"../core/textures/BaseTexture":112,"../core/textures/Texture":115,"../core/utils":125}],139:[function(t,e,r){"use strict";var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core"));n.DisplayObject.prototype.name=null,n.Container.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null}},{"../core":65}],140:[function(t,e,r){"use strict";var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core"));n.DisplayObject.prototype.getGlobalPosition=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new n.Point,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t}},{"../core":65}],141:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.BitmapText=r.TilingSpriteRenderer=r.TilingSprite=r.AnimatedSprite=void 0;var i=t("./AnimatedSprite");Object.defineProperty(r,"AnimatedSprite",{enumerable:!0,get:function(){return n(i).default}});var o=t("./TilingSprite");Object.defineProperty(r,"TilingSprite",{enumerable:!0,get:function(){return n(o).default}});var s=t("./webgl/TilingSpriteRenderer");Object.defineProperty(r,"TilingSpriteRenderer",{enumerable:!0,get:function(){return n(s).default}});var a=t("./BitmapText");Object.defineProperty(r,"BitmapText",{enumerable:!0,get:function(){return n(a).default}}),t("./cacheAsBitmap"),t("./getChildByName"),t("./getGlobalPosition")},{"./AnimatedSprite":135,"./BitmapText":136,"./TilingSprite":137,"./cacheAsBitmap":138,"./getChildByName":139,"./getGlobalPosition":140,"./webgl/TilingSpriteRenderer":142}],142:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),i=t("../../core/const"),o=(t("path"),new n.Matrix),s=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.shader=null,n.simpleShader=null,n.quad=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new n.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n"),this.simpleShader=new n.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n"),this.renderer.bindVao(null),this.quad=new n.Quad(t,this.renderer.state.attribState),this.quad.initVao(this.shader)},e.prototype.render=function(t){var e=this.renderer,r=this.quad;e.bindVao(r.vao);var s=r.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((s=r.uvs)[0]=s[6]=-t.anchor.x,s[1]=s[3]=-t.anchor.y,s[2]=s[4]=1-t.anchor.x,s[5]=s[7]=1-t.anchor.y),r.upload();var a=t._texture,u=a.baseTexture,h=t.tileTransform.localTransform,l=t.uvTransform,c=u.isPowerOfTwo&&a.frame.width===u.width&&a.frame.height===u.height;c&&(u._glTextures[e.CONTEXT_UID]?c=u.wrapMode!==i.WRAP_MODES.CLAMP:u.wrapMode===i.WRAP_MODES.CLAMP&&(u.wrapMode=i.WRAP_MODES.REPEAT));var d=c?this.simpleShader:this.shader;e.bindShader(d);var f=a.width,p=a.height,v=t._width,g=t._height;o.set(h.a*f/v,h.b*f/g,h.c*p/v,h.d*p/g,h.tx/v,h.ty/g),o.invert(),c?o.prepend(l.mapCoord):(d.uniforms.uMapCoord=l.mapCoord.toArray(!0),d.uniforms.uClampFrame=l.uClampFrame,d.uniforms.uClampOffset=l.uClampOffset),d.uniforms.uTransform=o.toArray(!0),d.uniforms.uColor=n.utils.premultiplyTintToRgba(t.tint,t.worldAlpha,d.uniforms.uColor,u.premultipliedAlpha),d.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),d.uniforms.uSampler=e.bindTexture(a),e.setBlendMode(n.utils.correctBlendMode(t.blendMode,u.premultipliedAlpha)),r.vao.draw(this.renderer.gl.TRIANGLES,6,0)},e}(n.ObjectRenderer);r.default=s,n.WebGLRenderer.registerPlugin("tilingSprite",s)},{"../../core":65,"../../core/const":46,path:8}],143:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),o=(t("path"),function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n"));return n.alpha=r,n.glShaderKey="alpha",n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),n(e,[{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t}}]),e}(i.Filter));r.default=o},{"../../core":65,path:8}],144:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),s=n(t("./BlurXFilter")),a=n(t("./BlurYFilter")),u=function(t){function e(r,n,i,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return h.blurXFilter=new s.default(r,n,i,u),h.blurYFilter=new a.default(r,n,i,u),h.padding=0,h.resolution=i||o.settings.RESOLUTION,h.quality=n||4,h.blur=r||8,h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,r){var n=t.getRenderTarget(!0);this.blurXFilter.apply(t,e,n,!0),this.blurYFilter.apply(t,n,r,!1),t.returnRenderTarget(n)},i(e,[{key:"blur",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blendMode",get:function(){return this.blurYFilter._blendMode},set:function(t){this.blurYFilter._blendMode=t}}]),e}(o.Filter);r.default=u},{"../../core":65,"./BlurXFilter":145,"./BlurYFilter":146}],145:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),s=n(t("./generateBlurVertSource")),a=n(t("./generateBlurFragSource")),u=n(t("./getMaxBlurKernelSize")),h=function(t){function e(r,n,i,u){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),u=u||5;var h=(0,s.default)(u,!0),l=(0,a.default)(u),c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,h,l));return c.resolution=i||o.settings.RESOLUTION,c._quality=0,c.quality=n||4,c.strength=r||8,c.firstRun=!0,c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,r,n){if(this.firstRun){var i=t.renderer.gl,o=(0,u.default)(i);this.vertexSrc=(0,s.default)(o,!0),this.fragmentSrc=(0,a.default)(o),this.firstRun=!1}if(this.uniforms.strength=1/r.size.width*(r.size.width/e.size.width),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,r,n);else{for(var h=t.getRenderTarget(!0),l=e,c=h,d=0;d<this.passes-1;d++){t.applyFilter(this,l,c,!0);var f=c;c=l,l=f}t.applyFilter(this,l,r,n),t.returnRenderTarget(h)}},i(e,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),e}(o.Filter);r.default=h},{"../../core":65,"./generateBlurFragSource":147,"./generateBlurVertSource":148,"./getMaxBlurKernelSize":149}],146:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),s=n(t("./generateBlurVertSource")),a=n(t("./generateBlurFragSource")),u=n(t("./getMaxBlurKernelSize")),h=function(t){function e(r,n,i,u){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),u=u||5;var h=(0,s.default)(u,!1),l=(0,a.default)(u),c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,h,l));return c.resolution=i||o.settings.RESOLUTION,c._quality=0,c.quality=n||4,c.strength=r||8,c.firstRun=!0,c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,r,n){if(this.firstRun){var i=t.renderer.gl,o=(0,u.default)(i);this.vertexSrc=(0,s.default)(o,!1),this.fragmentSrc=(0,a.default)(o),this.firstRun=!1}if(this.uniforms.strength=1/r.size.height*(r.size.height/e.size.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,r,n);else{for(var h=t.getRenderTarget(!0),l=e,c=h,d=0;d<this.passes-1;d++){t.applyFilter(this,l,c,!0);var f=c;c=l,l=f}t.applyFilter(this,l,r,n),t.returnRenderTarget(h)}},i(e,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),e}(o.Filter);r.default=h},{"../../core":65,"./generateBlurFragSource":147,"./generateBlurVertSource":148,"./getMaxBlurKernelSize":149}],147:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){for(var e=n[t],r=e.length,o=i,s="",a=void 0,u=0;u<t;u++){var h="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",u);a=u,u>=r&&(a=t-u-1),s+=h=h.replace("%value%",e[a]),s+="\n"}return(o=o.replace("%blur%",s)).replace("%size%",t)};var n={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},i=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n")},{}],148:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e){var r=Math.ceil(t/2),i=n,o="",s=void 0;s=e?"vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";for(var a=0;a<t;a++){var u=s.replace("%index%",a);o+=u=u.replace("%sampleIndex%",a-(r-1)+".0"),o+="\n"}return(i=i.replace("%blur%",o)).replace("%size%",t)};var n=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float strength;","uniform mat3 projectionMatrix;","varying vec2 vBlurTexCoords[%size%];","void main(void)","{","gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);","%blur%","}"].join("\n")},{}],149:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){for(var e=t.getParameter(t.MAX_VARYING_VECTORS),r=15;r>e;)r-=2;return r}},{}],150:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),o=(t("path"),function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n"));return r.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],r.alpha=1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._loadMatrix=function(t){var e=t;arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(this._multiply(e,this.uniforms.m,t),e=this._colorMatrix(e)),this.uniforms.m=e},e.prototype._multiply=function(t,e,r){return t[0]=e[0]*r[0]+e[1]*r[5]+e[2]*r[10]+e[3]*r[15],t[1]=e[0]*r[1]+e[1]*r[6]+e[2]*r[11]+e[3]*r[16],t[2]=e[0]*r[2]+e[1]*r[7]+e[2]*r[12]+e[3]*r[17],t[3]=e[0]*r[3]+e[1]*r[8]+e[2]*r[13]+e[3]*r[18],t[4]=e[0]*r[4]+e[1]*r[9]+e[2]*r[14]+e[3]*r[19]+e[4],t[5]=e[5]*r[0]+e[6]*r[5]+e[7]*r[10]+e[8]*r[15],t[6]=e[5]*r[1]+e[6]*r[6]+e[7]*r[11]+e[8]*r[16],t[7]=e[5]*r[2]+e[6]*r[7]+e[7]*r[12]+e[8]*r[17],t[8]=e[5]*r[3]+e[6]*r[8]+e[7]*r[13]+e[8]*r[18],t[9]=e[5]*r[4]+e[6]*r[9]+e[7]*r[14]+e[8]*r[19]+e[9],t[10]=e[10]*r[0]+e[11]*r[5]+e[12]*r[10]+e[13]*r[15],t[11]=e[10]*r[1]+e[11]*r[6]+e[12]*r[11]+e[13]*r[16],t[12]=e[10]*r[2]+e[11]*r[7]+e[12]*r[12]+e[13]*r[17],t[13]=e[10]*r[3]+e[11]*r[8]+e[12]*r[13]+e[13]*r[18],t[14]=e[10]*r[4]+e[11]*r[9]+e[12]*r[14]+e[13]*r[19]+e[14],t[15]=e[15]*r[0]+e[16]*r[5]+e[17]*r[10]+e[18]*r[15],t[16]=e[15]*r[1]+e[16]*r[6]+e[17]*r[11]+e[18]*r[16],t[17]=e[15]*r[2]+e[16]*r[7]+e[17]*r[12]+e[18]*r[17],t[18]=e[15]*r[3]+e[16]*r[8]+e[17]*r[13]+e[18]*r[18],t[19]=e[15]*r[4]+e[16]*r[9]+e[17]*r[14]+e[18]*r[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.greyscale=function(t,e){var r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var r=Math.cos(t),n=Math.sin(t),i=1/3,o=(0,Math.sqrt)(i),s=[r+(1-r)*i,i*(1-r)-o*n,i*(1-r)+o*n,0,0,i*(1-r)+o*n,r+i*(1-r),i*(1-r)-o*n,0,0,i*(1-r)-o*n,i*(1-r)+o*n,r+i*(1-r),0,0,0,0,0,1,0];this._loadMatrix(s,e)},e.prototype.contrast=function(t,e){var r=(t||0)+1,n=-.5*(r-1),i=[r,0,0,0,n,0,r,0,0,n,0,0,r,0,n,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.saturate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1],r=2*t/3+1,n=-.5*(r-1),i=[r,n,n,0,0,n,r,n,0,0,n,n,r,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,r,n,i){var o=((r=r||16770432)>>16&255)/255,s=(r>>8&255)/255,a=(255&r)/255,u=((n=n||3375104)>>16&255)/255,h=(n>>8&255)/255,l=(255&n)/255,c=[.3,.59,.11,0,0,o,s,a,t=t||.2,0,u,h,l,e=e||.15,0,o-u,s-h,a-l,0,0];this._loadMatrix(c,i)},e.prototype.night=function(t,e){var r=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.predator=function(t,e){var r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},n(e,[{key:"matrix",get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t}},{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t}}]),e}(i.Filter));r.default=o,o.prototype.grayscale=o.prototype.greyscale},{"../../core":65,path:8}],151:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),o=(t("path"),function(t){function e(r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=new i.Matrix;r.renderable=!1;var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord;\n}","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy *= scale / filterArea.xy;\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n"));return s.maskSprite=r,s.maskMatrix=o,s.uniforms.mapSampler=r._texture,s.uniforms.filterMatrix=o,s.uniforms.scale={x:1,y:1},null!=n||(n=20),s.scale=new i.Point(n,n),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y,t.applyFilter(this,e,r)},n(e,[{key:"map",get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t}}]),e}(i.Filter));r.default=o},{"../../core":65,path:8}],152:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),i=(t("path"),function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec4 filterArea;\n\nvarying vec2 vTextureCoord;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n   vTextureCoord = aTextureCoord;\n\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n \n --\n \n From:\n https://github.com/mitsuhiko/webgl-meincraft\n \n Copyright (c) 2011 by Armin Ronacher.\n \n Some rights reserved.\n \n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n \n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n \n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n \n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n \n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n      vec4 color;\n\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(n.Filter));r.default=i},{"../../core":65,path:8}],153:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./fxaa/FXAAFilter");Object.defineProperty(r,"FXAAFilter",{enumerable:!0,get:function(){return n(i).default}});var o=t("./noise/NoiseFilter");Object.defineProperty(r,"NoiseFilter",{enumerable:!0,get:function(){return n(o).default}});var s=t("./displacement/DisplacementFilter");Object.defineProperty(r,"DisplacementFilter",{enumerable:!0,get:function(){return n(s).default}});var a=t("./blur/BlurFilter");Object.defineProperty(r,"BlurFilter",{enumerable:!0,get:function(){return n(a).default}});var u=t("./blur/BlurXFilter");Object.defineProperty(r,"BlurXFilter",{enumerable:!0,get:function(){return n(u).default}});var h=t("./blur/BlurYFilter");Object.defineProperty(r,"BlurYFilter",{enumerable:!0,get:function(){return n(h).default}});var l=t("./colormatrix/ColorMatrixFilter");Object.defineProperty(r,"ColorMatrixFilter",{enumerable:!0,get:function(){return n(l).default}});var c=t("./alpha/AlphaFilter");Object.defineProperty(r,"AlphaFilter",{enumerable:!0,get:function(){return n(c).default}})},{"./alpha/AlphaFilter":143,"./blur/BlurFilter":144,"./blur/BlurXFilter":145,"./blur/BlurYFilter":146,"./colormatrix/ColorMatrixFilter":150,"./displacement/DisplacementFilter":151,"./fxaa/FXAAFilter":152,"./noise/NoiseFilter":154}],154:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),o=(t("path"),function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random();!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n"));return i.noise=r,i.seed=n,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),n(e,[{key:"noise",get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t}},{key:"seed",get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t}}]),e}(i.Filter));r.default=o},{"../../core":65,path:8}],155:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),o=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.global=new i.Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return t.prototype.getLocalPosition=function(t,e,r){return t.worldTransform.applyInverse(r||this.global,e)},t.prototype.copyEvent=function(t){t.isPrimary&&(this.isPrimary=!0),this.button=t.button,this.buttons=Number.isInteger(t.buttons)?t.buttons:t.which,this.width=t.width,this.height=t.height,this.tiltX=t.tiltX,this.tiltY=t.tiltY,this.pointerType=t.pointerType,this.pressure=t.pressure,this.rotationAngle=t.rotationAngle,this.twist=t.twist||0,this.tangentialPressure=t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},n(t,[{key:"pointerId",get:function(){return this.identifier}}]),t}();r.default=o},{"../core":65}],156:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0},t.prototype.reset=function(){this.stopped=!1,this.currentTarget=null,this.target=null},t}();r.default=n},{}],157:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),s=n(t("./InteractionData")),a=n(t("./InteractionEvent")),u=n(t("./InteractionTrackingData")),h=n(t("eventemitter3")),l=n(t("./interactiveTarget"));o.utils.mixins.delayMixin(o.DisplayObject.prototype,l.default);var c=1,d={target:null,data:{global:null}},f=function(t){function e(r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n=n||{},i.renderer=r,i.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,i.interactionFrequency=n.interactionFrequency||10,i.mouse=new s.default,i.mouse.identifier=c,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[c]=i.mouse,i.interactionDataPool=[],i.eventData=new a.default,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.mouseOverRenderer=!1,i.supportsTouchEvents="ontouchstart"in window,i.supportsPointerEvents=!!window.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i._tempPoint=new o.Point,i.resolution=1,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.hitTest=function(t,e){return d.target=null,d.data.global=t,e||(e=this.renderer._lastObjectRendered),this.processInteractive(d,e,null,!0),d.target},e.prototype.setTargetElement=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents()},e.prototype.addEvents=function(){this.interactionDOMElement&&(o.ticker.shared.add(this.update,this,o.UPDATE_PRIORITY.INTERACTION),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},e.prototype.removeEvents=function(){this.interactionDOMElement&&(o.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},e.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var r=this.activeInteractionData[e];if(r.originalEvent&&"touch"!==r.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,r.originalEvent,r);this.processInteractive(n,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(void 0===e?"undefined":i(e)){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,r){r.stopped||(r.currentTarget=t,r.type=e,t.emit(e,r),t[e]&&t[e](r))},e.prototype.mapPositionToPoint=function(t,e,r){var n;n=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var i=navigator.isCocoonJS?this.resolution:1/this.resolution;t.x=(e-n.left)*(this.interactionDOMElement.width/n.width)*i,t.y=(r-n.top)*(this.interactionDOMElement.height/n.height)*i},e.prototype.processInteractive=function(t,e,r,n,i){if(!e||!e.visible)return!1;var o=t.data.global,s=!1,a=i=e.interactive||i,u=!0;if(e.hitArea?(n&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:(n=!1,u=!1)),a=!1):e._mask&&n&&(e._mask.containsPoint(o)||(n=!1,u=!1)),u&&e.interactiveChildren&&e.children)for(var h=e.children,l=h.length-1;l>=0;l--){var c=h[l],d=this.processInteractive(t,c,r,n,a);if(d){if(!c.parent)continue;a=!1,d&&(t.target&&(n=!1),s=!0)}}return i&&(n&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),r&&r(t,e,!!s))),s},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&t.preventDefault();for(var r=e.length,n=0;n<r;n++){var i=e[n],o=this.getInteractionDataForPointerId(i),s=this.configureInteractionEventForDOMEvent(this.eventData,i,o);if(s.data.originalEvent=t,this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===i.pointerType)this.emit("touchstart",s);else if("mouse"===i.pointerType||"pen"===i.pointerType){var a=2===i.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,r){var n=t.data,i=t.data.identifier;if(r)if(e.trackedPointers[i]||(e.trackedPointers[i]=new u.default(i)),this.dispatchEvent(e,"pointerdown",t),"touch"===n.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===n.pointerType||"pen"===n.pointerType){var o=2===n.button;o?e.trackedPointers[i].rightDown=!0:e.trackedPointers[i].leftDown=!0,this.dispatchEvent(e,o?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,r){for(var n=this.normalizeToPointerData(t),i=n.length,o=t.target!==this.interactionDOMElement?"outside":"",s=0;s<i;s++){var a=n[s],u=this.getInteractionDataForPointerId(a),h=this.configureInteractionEventForDOMEvent(this.eventData,a,u);if(h.data.originalEvent=t,this.processInteractive(h,this.renderer._lastObjectRendered,r,e||!o),this.emit(e?"pointercancel":"pointerup"+o,h),"mouse"===a.pointerType||"pen"===a.pointerType){var l=2===a.button;this.emit(l?"rightup"+o:"mouseup"+o,h)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,h),this.releaseInteractionDataForPointerId(a.pointerId,u))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var r=t.data,n=t.data.identifier;void 0!==e.trackedPointers[n]&&(delete e.trackedPointers[n],this.dispatchEvent(e,"pointercancel",t),"touch"===r.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,r){var n=t.data,i=t.data.identifier,o=e.trackedPointers[i],s="touch"===n.pointerType,a="mouse"===n.pointerType||"pen"===n.pointerType,h=!1;if(a){var l=2===n.button,c=u.default.FLAGS,d=l?c.RIGHT_DOWN:c.LEFT_DOWN,f=void 0!==o&&o.flags&d;r?(this.dispatchEvent(e,l?"rightup":"mouseup",t),f&&(this.dispatchEvent(e,l?"rightclick":"click",t),h=!0)):f&&this.dispatchEvent(e,l?"rightupoutside":"mouseupoutside",t),o&&(l?o.rightDown=!1:o.leftDown=!1)}r?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),o&&(a&&!h||this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),o.over=!1))):o&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),o&&o.none&&delete e.trackedPointers[i]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this.didMove=!0,this.cursor=null);for(var r=e.length,n=0;n<r;n++){var i=e[n],o=this.getInteractionDataForPointerId(i),s=this.configureInteractionEventForDOMEvent(this.eventData,i,o);s.data.originalEvent=t;var a="touch"!==i.pointerType||this.moveWhenInside;this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerMove,a),this.emit("pointermove",s),"touch"===i.pointerType&&this.emit("touchmove",s),"mouse"!==i.pointerType&&"pen"!==i.pointerType||this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,r){var n=t.data,i="touch"===n.pointerType,o="mouse"===n.pointerType||"pen"===n.pointerType;o&&this.processPointerOverOut(t,e,r),this.moveWhenInside&&!r||(this.dispatchEvent(e,"pointermove",t),i&&this.dispatchEvent(e,"touchmove",t),o&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var r=this.getInteractionDataForPointerId(e),n=this.configureInteractionEventForDOMEvent(this.eventData,e,r);n.data.originalEvent=e,this.processInteractive(n,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",n),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",n):this.releaseInteractionDataForPointerId(r.identifier)}},e.prototype.processPointerOverOut=function(t,e,r){var n=t.data,i=t.data.identifier,o="mouse"===n.pointerType||"pen"===n.pointerType,s=e.trackedPointers[i];r&&!s&&(s=e.trackedPointers[i]=new u.default(i)),void 0!==s&&(r&&this.mouseOverRenderer?(s.over||(s.over=!0,this.dispatchEvent(e,"pointerover",t),o&&this.dispatchEvent(e,"mouseover",t)),o&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),o&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[i]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],r=this.getInteractionDataForPointerId(e),n=this.configureInteractionEventForDOMEvent(this.eventData,e,r);n.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",n),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",n)},e.prototype.getInteractionDataForPointerId=function(t){var e=t.pointerId,r=void 0;return e===c||"mouse"===t.pointerType?r=this.mouse:this.activeInteractionData[e]?r=this.activeInteractionData[e]:((r=this.interactionDataPool.pop()||new s.default).identifier=e,this.activeInteractionData[e]=r),r.copyEvent(t),r},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,r){return t.data=r,this.mapPositionToPoint(r.global,e.clientX,e.clientY),navigator.isCocoonJS&&"touch"===e.pointerType&&(r.global.x=r.global.x/this.resolution,r.global.y=r.global.y/this.resolution),"touch"===e.pointerType&&(e.globalX=r.global.x,e.globalY=r.global.y),r.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var r=0,n=t.changedTouches.length;r<n;r++){var i=t.changedTouches[r];void 0===i.button&&(i.button=t.touches.length?1:0),void 0===i.buttons&&(i.buttons=t.touches.length?1:0),void 0===i.isPrimary&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===i.width&&(i.width=i.radiusX||1),void 0===i.height&&(i.height=i.radiusY||1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="touch"),void 0===i.pointerId&&(i.pointerId=i.identifier||0),void 0===i.pressure&&(i.pressure=i.force||.5),i.twist=0,i.tangentialPressure=0,void 0===i.layerX&&(i.layerX=i.offsetX=i.clientX),void 0===i.layerY&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,e.push(i)}else!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent?e.push(t):(void 0===t.isPrimary&&(t.isPrimary=!0),void 0===t.width&&(t.width=1),void 0===t.height&&(t.height=1),void 0===t.tiltX&&(t.tiltX=0),void 0===t.tiltY&&(t.tiltY=0),void 0===t.pointerType&&(t.pointerType="mouse"),void 0===t.pointerId&&(t.pointerId=c),void 0===t.pressure&&(t.pressure=.5),t.twist=0,t.tangentialPressure=0,t.isNormalized=!0,e.push(t));return e},e.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},e}(h.default);r.default=f,o.WebGLRenderer.registerPlugin("interaction",f),o.CanvasRenderer.registerPlugin("interaction",f)},{"../core":65,"./InteractionData":155,"./InteractionEvent":156,"./InteractionTrackingData":158,"./interactiveTarget":160,eventemitter3:3}],158:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},n(t,[{key:"pointerId",get:function(){return this._pointerId}},{key:"flags",get:function(){return this._flags},set:function(t){this._flags=t}},{key:"none",get:function(){return this._flags===this.constructor.FLAGS.NONE}},{key:"over",get:function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},set:function(t){this._doSet(this.constructor.FLAGS.OVER,t)}},{key:"rightDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},set:function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)}},{key:"leftDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},set:function(t){this._doSet(this.constructor.FLAGS.LEFT_DOWN,t)}}]),t}();r.default=i,i.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4})},{}],159:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./InteractionData");Object.defineProperty(r,"InteractionData",{enumerable:!0,get:function(){return n(i).default}});var o=t("./InteractionManager");Object.defineProperty(r,"InteractionManager",{enumerable:!0,get:function(){return n(o).default}});var s=t("./interactiveTarget");Object.defineProperty(r,"interactiveTarget",{enumerable:!0,get:function(){return n(s).default}});var a=t("./InteractionTrackingData");Object.defineProperty(r,"InteractionTrackingData",{enumerable:!0,get:function(){return n(a).default}});var u=t("./InteractionEvent");Object.defineProperty(r,"InteractionEvent",{enumerable:!0,get:function(){return n(u).default}})},{"./InteractionData":155,"./InteractionEvent":156,"./InteractionManager":157,"./InteractionTrackingData":158,"./interactiveTarget":160}],160:[function(t,e,r){"use strict";r.__esModule=!0,r.default={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0}},{}],161:[function(t,e,r){"use strict";function n(t,e){t.bitmapFont=s.BitmapText.registerFont(t.data,e)}r.__esModule=!0,r.parse=n,r.default=function(){return function(t,e){if(t.data&&t.type===o.Resource.TYPE.XML)if(0!==t.data.getElementsByTagName("page").length&&0!==t.data.getElementsByTagName("info").length&&null!==t.data.getElementsByTagName("info")[0].getAttribute("face")){var r=t.isDataUrl?"":i.dirname(t.url);t.isDataUrl&&("."===r&&(r=""),this.baseUrl&&r&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(r+="/")),(r=r.replace(this.baseUrl,""))&&"/"!==r.charAt(r.length-1)&&(r+="/");for(var s=t.data.getElementsByTagName("page"),a={},u=function(r){a[r.metadata.pageFile]=r.texture,Object.keys(a).length===s.length&&(n(t,a),e())},h=0;h<s.length;++h){var l=s[h].getAttribute("file"),c=r+l,d=!1;for(var f in this.resources){var p=this.resources[f];if(p.url===c){p.metadata.pageFile=l,p.texture?u(p):p.onAfterMiddleware.add(u),d=!0;break}}if(!d){var v={crossOrigin:t.crossOrigin,loadType:o.Resource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:l},t.metadata.imageMetadata),parentResource:t};this.add(c,v,u)}}}else e();else e()}};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("path")),o=t("resource-loader"),s=t("../extras")},{"../extras":141,path:8,"resource-loader":36}],162:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.shared=r.Resource=r.textureParser=r.getResourcePath=r.spritesheetParser=r.parseBitmapFontData=r.bitmapFontParser=r.Loader=void 0;var i=t("./bitmapFontParser");Object.defineProperty(r,"bitmapFontParser",{enumerable:!0,get:function(){return n(i).default}}),Object.defineProperty(r,"parseBitmapFontData",{enumerable:!0,get:function(){return i.parse}});var o=t("./spritesheetParser");Object.defineProperty(r,"spritesheetParser",{enumerable:!0,get:function(){return n(o).default}}),Object.defineProperty(r,"getResourcePath",{enumerable:!0,get:function(){return o.getResourcePath}});var s=t("./textureParser");Object.defineProperty(r,"textureParser",{enumerable:!0,get:function(){return n(s).default}});var a=t("resource-loader");Object.defineProperty(r,"Resource",{enumerable:!0,get:function(){return a.Resource}});var u=n(t("../core/Application")),h=n(t("./loader"));r.Loader=h.default;var l=new h.default;l.destroy=function(){},r.shared=l;var c=u.default.prototype;c._loader=null,Object.defineProperty(c,"loader",{get:function(){if(!this._loader){var t=this._options.sharedLoader;this._loader=t?l:new h.default}return this._loader}}),c._parentDestroy=c.destroy,c.destroy=function(t,e){this._loader&&(this._loader.destroy(),this._loader=null),this._parentDestroy(t,e)}},{"../core/Application":43,"./bitmapFontParser":161,"./loader":163,"./spritesheetParser":164,"./textureParser":165,"resource-loader":36}],163:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("resource-loader")),o=t("resource-loader/lib/middlewares/parsing/blob"),s=n(t("eventemitter3")),a=n(t("./textureParser")),u=n(t("./spritesheetParser")),h=n(t("./bitmapFontParser")),l=function(t){function e(r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));s.default.call(i);for(var o=0;o<e._pixiMiddleware.length;++o)i.use(e._pixiMiddleware[o]());return i.onStart.add(function(t){return i.emit("start",t)}),i.onProgress.add(function(t,e){return i.emit("progress",t,e)}),i.onError.add(function(t,e,r){return i.emit("error",t,e,r)}),i.onLoad.add(function(t,e){return i.emit("load",t,e)}),i.onComplete.add(function(t,e){return i.emit("complete",t,e)}),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.addPixiMiddleware=function(t){e._pixiMiddleware.push(t)},e.prototype.destroy=function(){this.removeAllListeners(),this.reset()},e}(i.default);for(var c in r.default=l,s.default.prototype)l.prototype[c]=s.default.prototype[c];l._pixiMiddleware=[o.blobMiddlewareFactory,a.default,u.default,h.default];var d=i.default.Resource;d.setExtensionXhrType("fnt",d.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":161,"./spritesheetParser":164,"./textureParser":165,eventemitter3:3,"resource-loader":36,"resource-loader/lib/middlewares/parsing/blob":37}],164:[function(t,e,r){"use strict";function n(t,e){return t.isDataUrl?t.data.meta.image:o.default.resolve(t.url.replace(e,""),t.data.meta.image)}r.__esModule=!0,r.default=function(){return function(t,e){var r=t.name+"_image";if(t.data&&t.type===i.Resource.TYPE.JSON&&t.data.frames&&!this.resources[r]){var o={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},a=n(t,this.baseUrl);this.add(r,a,o,function(r){if(r.error)e(r.error);else{var n=new s.Spritesheet(r.texture.baseTexture,t.data,t.url);n.parse(function(){t.spritesheet=n,t.textures=n.textures,e()})}})}else e()}},r.getResourcePath=n;var i=t("resource-loader"),o=function(t){return t&&t.__esModule?t:{default:t}}(t("url")),s=t("../core")},{"../core":65,"resource-loader":36,url:38}],165:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(){return function(t,e){t.data&&t.type===n.Resource.TYPE.IMAGE&&(t.texture=i.default.fromLoader(t.data,t.url,t.name)),e()}};var n=t("resource-loader"),i=function(t){return t&&t.__esModule?t:{default:t}}(t("../core/textures/Texture"))},{"../core/textures/Texture":115,"resource-loader":36}],166:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),o=function(t){return t&&t.__esModule?t:{default:t}}(t("../core/textures/Texture")),s=new i.Point,a=new i.Polygon,u=function(t){function e(r,n,s,a,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return h._texture=r||o.default.EMPTY,h.uvs=s||new Float32Array([0,0,1,0,1,1,0,1]),h.vertices=n||new Float32Array([0,0,100,0,100,100,0,100]),h.indices=a||new Uint16Array([0,1,3,2]),h.dirty=0,h.indexDirty=0,h.vertexDirty=0,h.autoUpdate=!0,h.blendMode=i.BLEND_MODES.NORMAL,h.canvasPadding=i.settings.MESH_CANVAS_PADDING,h.drawMode=u||e.DRAW_MODES.TRIANGLE_MESH,h.shader=null,h.tintRgb=new Float32Array([1,1,1]),h._glDatas={},h._uvTransform=new i.TextureMatrix(h._texture),h.uploadUvTransform=!1,h.pluginName="mesh",h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._renderWebGL=function(t){this.refresh(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._renderCanvas=function(t){this.refresh(),t.plugins[this.pluginName].render(this)},e.prototype._onTextureUpdate=function(){this._uvTransform.texture=this._texture,this.refresh()},e.prototype.multiplyUvs=function(){this.uploadUvTransform||this._uvTransform.multiplyUvs(this.uvs)},e.prototype.refresh=function(t){this.autoUpdate&&this.vertexDirty++,this._uvTransform.update(t)&&this._refresh()},e.prototype._refresh=function(){},e.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,s);for(var r=this.vertices,n=a.points,i=this.indices,o=this.indices.length,u=this.drawMode===e.DRAW_MODES.TRIANGLES?3:1,h=0;h+2<o;h+=u){var l=2*i[h],c=2*i[h+1],d=2*i[h+2];if(n[0]=r[l],n[1]=r[l+1],n[2]=r[c],n[3]=r[c+1],n[4]=r[d],n[5]=r[d+1],a.contains(s.x,s.y))return!0}return!1},e.prototype.destroy=function(e){for(var r in this._glDatas){var n=this._glDatas[r];n.destroy?n.destroy():(n.vertexBuffer&&(n.vertexBuffer.destroy(),n.vertexBuffer=null),n.indexBuffer&&(n.indexBuffer.destroy(),n.indexBuffer=null),n.uvBuffer&&(n.uvBuffer.destroy(),n.uvBuffer=null),n.vao&&(n.vao.destroy(),n.vao=null))}this._glDatas=null,t.prototype.destroy.call(this,e)},n(e,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}},{key:"tint",get:function(){return i.utils.rgb2hex(this.tintRgb)},set:function(t){this.tintRgb=i.utils.hex2rgb(t,this.tintRgb)}}]),e}(i.Container);r.default=u,u.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":65,"../core/textures/Texture":115}],167:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){return t&&t.__esModule?t:{default:t}}(t("./Plane")),o=10,s=function(t){function e(r,n,i,s,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,4,4));return u._origWidth=r.orig.width,u._origHeight=r.orig.height,u._width=u._origWidth,u._height=u._origHeight,u._leftWidth=void 0!==n?n:o,u._rightWidth=void 0!==s?s:o,u._topHeight=void 0!==i?i:o,u._bottomHeight=void 0!==a?a:o,u.refresh(!0),u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._topHeight+this._bottomHeight,r=this._height>e?1:this._height/e;t[9]=t[11]=t[13]=t[15]=this._topHeight*r,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*r,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._leftWidth+this._rightWidth,r=this._width>e?1:this._width/e;t[2]=t[10]=t[18]=t[26]=this._leftWidth*r,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*r,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._renderCanvas=function(t){var e=t.context;e.globalAlpha=this.worldAlpha,t.setBlendMode(this.blendMode);var r=this.worldTransform,n=t.resolution;t.roundPixels?e.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*n|0,r.ty*n|0):e.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*n,r.ty*n);var i=this._texture.baseTexture,o=i.source,s=i.width*i.resolution,a=i.height*i.resolution;this.drawSegment(e,o,s,a,0,1,10,11),this.drawSegment(e,o,s,a,2,3,12,13),this.drawSegment(e,o,s,a,4,5,14,15),this.drawSegment(e,o,s,a,8,9,18,19),this.drawSegment(e,o,s,a,10,11,20,21),this.drawSegment(e,o,s,a,12,13,22,23),this.drawSegment(e,o,s,a,16,17,26,27),this.drawSegment(e,o,s,a,18,19,28,29),this.drawSegment(e,o,s,a,20,21,30,31)},e.prototype.drawSegment=function(t,e,r,n,i,o,s,a){var u=this.uvs,h=this.vertices,l=(u[s]-u[i])*r,c=(u[a]-u[o])*n,d=h[s]-h[i],f=h[a]-h[o];l<1&&(l=1),c<1&&(c=1),d<1&&(d=1),f<1&&(f=1),t.drawImage(e,u[i]*r,u[o]*n,l,c,h[i],h[o],d,f)},e.prototype._refresh=function(){t.prototype._refresh.call(this);var e=this.uvs,r=this._texture;this._origWidth=r.orig.width,this._origHeight=r.orig.height;var n=1/this._origWidth,i=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=i*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-i*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.dirty++,this.multiplyUvs()},n(e,[{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._refresh()}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._refresh()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()}},{key:"topHeight",get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()}}]),e}(i.default);r.default=s},{"./Plane":168}],168:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(t("./Mesh")),i=function(t){function e(r,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return s._ready=!0,s.verticesX=i||10,s.verticesY=o||10,s.drawMode=n.default.DRAW_MODES.TRIANGLES,s.refresh(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._refresh=function(){for(var t=this._texture,e=this.verticesX*this.verticesY,r=[],n=[],i=[],o=this.verticesX-1,s=this.verticesY-1,a=t.width/o,u=t.height/s,h=0;h<e;h++){var l=h%this.verticesX,c=h/this.verticesX|0;r.push(l*a,c*u),n.push(l/o,c/s)}for(var d=o*s,f=0;f<d;f++){var p=f%o,v=f/o|0,g=v*this.verticesX+p,y=v*this.verticesX+p+1,m=(v+1)*this.verticesX+p,_=(v+1)*this.verticesX+p+1;i.push(g,y,m),i.push(y,_,m)}this.vertices=new Float32Array(r),this.uvs=new Float32Array(n),this.colors=new Float32Array([]),this.indices=new Uint16Array(i),this.dirty++,this.indexDirty++,this.multiplyUvs()},e.prototype._onTextureUpdate=function(){n.default.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},e}(n.default);r.default=i},{"./Mesh":166}],169:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){function e(r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return i.points=n,i.vertices=new Float32Array(4*n.length),i.uvs=new Float32Array(4*n.length),i.colors=new Float32Array(2*n.length),i.indices=new Uint16Array(2*n.length),i.autoUpdate=!0,i.refresh(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._refresh=function(){var t=this.points;if(!(t.length<1)&&this._texture._uvs){this.vertices.length/4!==t.length&&(this.vertices=new Float32Array(4*t.length),this.uvs=new Float32Array(4*t.length),this.colors=new Float32Array(2*t.length),this.indices=new Uint16Array(2*t.length));var e=this.uvs,r=this.indices,n=this.colors;e[0]=0,e[1]=0,e[2]=0,e[3]=1,n[0]=1,n[1]=1,r[0]=0,r[1]=1;for(var i=t.length,o=1;o<i;o++){var s=4*o,a=o/(i-1);e[s]=a,e[s+1]=0,e[s+2]=a,e[s+3]=1,n[s=2*o]=1,n[s+1]=1,r[s=2*o]=s,r[s+1]=s+1}this.dirty++,this.indexDirty++,this.multiplyUvs(),this.refreshVertices()}},e.prototype.refreshVertices=function(){var t=this.points;if(!(t.length<1))for(var e=t[0],r=void 0,n=0,i=0,o=this.vertices,s=t.length,a=0;a<s;a++){var u=t[a],h=4*a;i=-((r=a<t.length-1?t[a+1]:u).x-e.x),n=r.y-e.y;var l=10*(1-a/(s-1));l>1&&(l=1);var c=Math.sqrt(n*n+i*i),d=this._texture.height/2;n/=c,i/=c,n*=d,i*=d,o[h]=u.x+n,o[h+1]=u.y+i,o[h+2]=u.x-n,o[h+3]=u.y-i,e=u}},e.prototype.updateTransform=function(){this.autoUpdate&&this.refreshVertices(),this.containerUpdateTransform()},e}(function(t){return t&&t.__esModule?t:{default:t}}(t("./Mesh")).default);r.default=n},{"./Mesh":166}],170:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),i=function(t){return t&&t.__esModule?t:{default:t}}(t("../Mesh")),o=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e}return t.prototype.render=function(t){var e=this.renderer,r=e.context,n=t.worldTransform,o=e.resolution;e.roundPixels?r.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o|0,n.ty*o|0):r.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o),e.context.globalAlpha=t.worldAlpha,e.setBlendMode(t.blendMode),t.drawMode===i.default.DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(t):this._renderTriangles(t)},t.prototype._renderTriangleMesh=function(t){for(var e=t.vertices.length/2,r=0;r<e-2;r++){var n=2*r;this._renderDrawTriangle(t,n,n+2,n+4)}},t.prototype._renderTriangles=function(t){for(var e=t.indices,r=e.length,n=0;n<r;n+=3){var i=2*e[n],o=2*e[n+1],s=2*e[n+2];this._renderDrawTriangle(t,i,o,s)}},t.prototype._renderDrawTriangle=function(t,e,r,n){var i=this.renderer.context,o=t.uvs,s=t.vertices,a=t._texture;if(a.valid){var u=a.baseTexture,h=u.source,l=u.width,c=u.height,d=void 0,f=void 0,p=void 0,v=void 0,g=void 0,y=void 0;if(t.uploadUvTransform){var m=t._uvTransform.mapCoord;d=(o[e]*m.a+o[e+1]*m.c+m.tx)*u.width,f=(o[r]*m.a+o[r+1]*m.c+m.tx)*u.width,p=(o[n]*m.a+o[n+1]*m.c+m.tx)*u.width,v=(o[e]*m.b+o[e+1]*m.d+m.ty)*u.height,g=(o[r]*m.b+o[r+1]*m.d+m.ty)*u.height,y=(o[n]*m.b+o[n+1]*m.d+m.ty)*u.height}else d=o[e]*u.width,f=o[r]*u.width,p=o[n]*u.width,v=o[e+1]*u.height,g=o[r+1]*u.height,y=o[n+1]*u.height;var _=s[e],b=s[r],x=s[n],T=s[e+1],w=s[r+1],E=s[n+1],S=t.canvasPadding/this.renderer.resolution;if(S>0){var O=S/Math.abs(t.worldTransform.a),M=S/Math.abs(t.worldTransform.d),P=(_+b+x)/3,C=(T+w+E)/3,R=_-P,A=T-C,I=Math.sqrt(R*R+A*A);_=P+R/I*(I+O),T=C+A/I*(I+M),A=w-C,b=P+(R=b-P)/(I=Math.sqrt(R*R+A*A))*(I+O),w=C+A/I*(I+M),A=E-C,x=P+(R=x-P)/(I=Math.sqrt(R*R+A*A))*(I+O),E=C+A/I*(I+M)}i.save(),i.beginPath(),i.moveTo(_,T),i.lineTo(b,w),i.lineTo(x,E),i.closePath(),i.clip();var D=d*g+v*p+f*y-g*p-v*f-d*y,L=_*g+v*x+b*y-g*x-v*b-_*y,N=d*b+_*p+f*x-b*p-_*f-d*x,B=d*g*x+v*b*p+_*f*y-_*g*p-v*f*x-d*b*y,F=T*g+v*E+w*y-g*E-v*w-T*y,k=d*w+T*p+f*E-w*p-T*f-d*E,j=d*g*E+v*w*p+T*f*y-T*g*p-v*f*E-d*w*y;i.transform(L/D,F/D,N/D,k/D,B/D,j/D),i.drawImage(h,0,0,l*u.resolution,c*u.resolution,0,0,l,c),i.restore(),this.renderer.invalidateBlendMode()}},t.prototype.renderMeshFlat=function(t){var e=this.renderer.context,r=t.vertices,n=r.length/2;e.beginPath();for(var i=1;i<n-2;++i){var o=2*i,s=r[o],a=r[o+1],u=r[o+2],h=r[o+3],l=r[o+4],c=r[o+5];e.moveTo(s,a),e.lineTo(u,h),e.lineTo(l,c)}e.fillStyle="#FF0000",e.fill(),e.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();r.default=o,n.CanvasRenderer.registerPlugin("mesh",o)},{"../../core":65,"../Mesh":166}],171:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./Mesh");Object.defineProperty(r,"Mesh",{enumerable:!0,get:function(){return n(i).default}});var o=t("./webgl/MeshRenderer");Object.defineProperty(r,"MeshRenderer",{enumerable:!0,get:function(){return n(o).default}});var s=t("./canvas/CanvasMeshRenderer");Object.defineProperty(r,"CanvasMeshRenderer",{enumerable:!0,get:function(){return n(s).default}});var a=t("./Plane");Object.defineProperty(r,"Plane",{enumerable:!0,get:function(){return n(a).default}});var u=t("./NineSlicePlane");Object.defineProperty(r,"NineSlicePlane",{enumerable:!0,get:function(){return n(u).default}});var h=t("./Rope");Object.defineProperty(r,"Rope",{enumerable:!0,get:function(){return n(h).default}})},{"./Mesh":166,"./NineSlicePlane":167,"./Plane":168,"./Rope":169,"./canvas/CanvasMeshRenderer":170,"./webgl/MeshRenderer":172}],172:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),o=n(t("pixi-gl-core")),s=n(t("../Mesh")),a=(t("path"),i.Matrix.IDENTITY),u=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.shader=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new i.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n")},e.prototype.render=function(t){var e=this.renderer,r=e.gl,n=t._texture;if(n.valid){var u=t._glDatas[e.CONTEXT_UID];u||(e.bindVao(null),(u={shader:this.shader,vertexBuffer:o.default.GLBuffer.createVertexBuffer(r,t.vertices,r.STREAM_DRAW),uvBuffer:o.default.GLBuffer.createVertexBuffer(r,t.uvs,r.STREAM_DRAW),indexBuffer:o.default.GLBuffer.createIndexBuffer(r,t.indices,r.STATIC_DRAW),vao:null,dirty:t.dirty,indexDirty:t.indexDirty,vertexDirty:t.vertexDirty}).vao=new o.default.VertexArrayObject(r).addIndex(u.indexBuffer).addAttribute(u.vertexBuffer,u.shader.attributes.aVertexPosition,r.FLOAT,!1,8,0).addAttribute(u.uvBuffer,u.shader.attributes.aTextureCoord,r.FLOAT,!1,8,0),t._glDatas[e.CONTEXT_UID]=u),e.bindVao(u.vao),t.dirty!==u.dirty&&(u.dirty=t.dirty,u.uvBuffer.upload(t.uvs)),t.indexDirty!==u.indexDirty&&(u.indexDirty=t.indexDirty,u.indexBuffer.upload(t.indices)),t.vertexDirty!==u.vertexDirty&&(u.vertexDirty=t.vertexDirty,u.vertexBuffer.upload(t.vertices)),e.bindShader(u.shader),u.shader.uniforms.uSampler=e.bindTexture(n),e.state.setBlendMode(i.utils.correctBlendMode(t.blendMode,n.baseTexture.premultipliedAlpha)),u.shader.uniforms.uTransform&&(t.uploadUvTransform?u.shader.uniforms.uTransform=t._uvTransform.mapCoord.toArray(!0):u.shader.uniforms.uTransform=a.toArray(!0)),u.shader.uniforms.translationMatrix=t.worldTransform.toArray(!0),u.shader.uniforms.uColor=i.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,u.shader.uniforms.uColor,n.baseTexture.premultipliedAlpha);var h=t.drawMode===s.default.DRAW_MODES.TRIANGLE_MESH?r.TRIANGLE_STRIP:r.TRIANGLES;u.vao.draw(h,t.indices.length,0)}},e}(i.ObjectRenderer);r.default=u,i.WebGLRenderer.registerPlugin("mesh",u)},{"../../core":65,"../Mesh":166,path:8,"pixi-gl-core":15}],173:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),o=t("../core/utils"),s=function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1500,n=arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16384,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return o>16384&&(o=16384),o>r&&(o=r),a._properties=[!1,!0,!1,!1,!1],a._maxSize=r,a._batchSize=o,a._glBuffers={},a._bufferUpdateIDs=[],a._updateID=0,a.interactiveChildren=!1,a.blendMode=i.BLEND_MODES.NORMAL,a.autoResize=s,a.roundPixels=!0,a.baseTexture=null,a.setProperties(n),a._tint=0,a.tintRgb=new Float32Array(4),a.tint=16777215,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},e.prototype.renderWebGL=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.hasLoaded||this.baseTexture.once("update",function(){return e.onChildrenChange(0)})),t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},e.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,r=this.worldTransform,n=!0,i=0,o=0,s=0,a=0;t.setBlendMode(this.blendMode),e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var u=0;u<this.children.length;++u){var h=this.children[u];if(h.visible){var l=h._texture.frame;if(e.globalAlpha=this.worldAlpha*h.alpha,h.rotation%(2*Math.PI)==0)n&&(e.setTransform(r.a,r.b,r.c,r.d,r.tx*t.resolution,r.ty*t.resolution),n=!1),i=h.anchor.x*(-l.width*h.scale.x)+h.position.x+.5,o=h.anchor.y*(-l.height*h.scale.y)+h.position.y+.5,s=l.width*h.scale.x,a=l.height*h.scale.y;else{n||(n=!0),h.displayObjectUpdateTransform();var c=h.worldTransform;t.roundPixels?e.setTransform(c.a,c.b,c.c,c.d,c.tx*t.resolution|0,c.ty*t.resolution|0):e.setTransform(c.a,c.b,c.c,c.d,c.tx*t.resolution,c.ty*t.resolution),i=h.anchor.x*-l.width+.5,o=h.anchor.y*-l.height+.5,s=l.width,a=l.height}var d=h._texture.baseTexture.resolution;e.drawImage(h._texture.baseTexture.source,l.x*d,l.y*d,l.width*d,l.height*d,i*t.resolution,o*t.resolution,s*t.resolution,a*t.resolution)}}}},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._buffers)for(var r=0;r<this._buffers.length;++r)this._buffers[r].destroy();this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},n(e,[{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,(0,o.hex2rgb)(t,this.tintRgb)}}]),e}(i.Container);r.default=s},{"../core":65,"../core/utils":125}],174:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./ParticleContainer");Object.defineProperty(r,"ParticleContainer",{enumerable:!0,get:function(){return n(i).default}});var o=t("./webgl/ParticleRenderer");Object.defineProperty(r,"ParticleRenderer",{enumerable:!0,get:function(){return n(o).default}})},{"./ParticleContainer":173,"./webgl/ParticleRenderer":176}],175:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=n(t("pixi-gl-core")),o=n(t("../../core/utils/createIndicesForQuads")),s=function(){function t(e,r,n,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.gl=e,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var o=0;o<r.length;++o){var s=r[o];s={attribute:s.attribute,size:s.size,uploadFunction:s.uploadFunction,unsignedByte:s.unsignedByte,offset:s.offset},n[o]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return t.prototype.initBuffers=function(){var t=this.gl,e=0;this.indices=(0,o.default)(this.size),this.indexBuffer=i.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r){var n=this.dynamicProperties[r];n.offset=e,e+=n.size,this.dynamicStride+=n.size}var s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=i.default.GLBuffer.createVertexBuffer(t,s,t.STREAM_DRAW);var a=0;this.staticStride=0;for(var u=0;u<this.staticProperties.length;++u){var h=this.staticProperties[u];h.offset=a,a+=h.size,this.staticStride+=h.size}var l=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(l),this.staticDataUint32=new Uint32Array(l),this.staticBuffer=i.default.GLBuffer.createVertexBuffer(t,l,t.STATIC_DRAW),this.vao=new i.default.VertexArrayObject(t).addIndex(this.indexBuffer);for(var c=0;c<this.dynamicProperties.length;++c){var d=this.dynamicProperties[c];d.unsignedByte?this.vao.addAttribute(this.dynamicBuffer,d.attribute,t.UNSIGNED_BYTE,!0,4*this.dynamicStride,4*d.offset):this.vao.addAttribute(this.dynamicBuffer,d.attribute,t.FLOAT,!1,4*this.dynamicStride,4*d.offset)}for(var f=0;f<this.staticProperties.length;++f){var p=this.staticProperties[f];p.unsignedByte?this.vao.addAttribute(this.staticBuffer,p.attribute,t.UNSIGNED_BYTE,!0,4*this.staticStride,4*p.offset):this.vao.addAttribute(this.staticBuffer,p.attribute,t.FLOAT,!1,4*this.staticStride,4*p.offset)}},t.prototype.uploadDynamic=function(t,e,r){for(var n=0;n<this.dynamicProperties.length;n++){var i=this.dynamicProperties[n];i.uploadFunction(t,e,r,i.unsignedByte?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer.upload()},t.prototype.uploadStatic=function(t,e,r){for(var n=0;n<this.staticProperties.length;n++){var i=this.staticProperties[n];i.uploadFunction(t,e,r,i.unsignedByte?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer.upload()},t.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicBuffer.destroy(),this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer.destroy(),this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null},t}();r.default=s},{"../../core/utils/createIndicesForQuads":123,"pixi-gl-core":15}],176:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),o=n(t("./ParticleShader")),s=n(t("./ParticleBuffer")),a=t("../../core/utils"),u=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.shader=null,n.indexBuffer=null,n.properties=null,n.tempMatrix=new i.Matrix,n.CONTEXT_UID=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.shader=new o.default(t),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,unsignedByte:!0,uploadFunction:this.uploadTint,offset:0}]},e.prototype.start=function(){this.renderer.bindShader(this.shader)},e.prototype.render=function(t){var e=t.children,r=t._maxSize,n=t._batchSize,o=this.renderer,s=e.length;if(0!==s){s>r&&(s=r);var a=t._glBuffers[o.CONTEXT_UID];a||(a=t._glBuffers[o.CONTEXT_UID]=this.generateBuffers(t));var u=e[0]._texture.baseTexture;this.renderer.setBlendMode(i.utils.correctBlendMode(t.blendMode,u.premultipliedAlpha));var h=o.gl,l=t.worldTransform.copy(this.tempMatrix);l.prepend(o._activeRenderTarget.projectionMatrix),this.shader.uniforms.projectionMatrix=l.toArray(!0),this.shader.uniforms.uColor=i.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,u.premultipliedAlpha),this.shader.uniforms.uSampler=o.bindTexture(u);for(var c=!1,d=0,f=0;d<s;d+=n,f+=1){var p=s-d;if(p>n&&(p=n),f>=a.length){if(!t.autoResize)break;a.push(this._generateOneMoreBuffer(t))}var v=a[f];v.uploadDynamic(e,d,p);var g=t._bufferUpdateIDs[f]||0;(c=c||v._updateID<g)&&(v._updateID=t._updateID,v.uploadStatic(e,d,p)),o.bindVao(v.vao),v.vao.draw(h.TRIANGLES,6*p)}}},e.prototype.generateBuffers=function(t){for(var e=this.renderer.gl,r=[],n=t._maxSize,i=t._batchSize,o=t._properties,a=0;a<n;a+=i)r.push(new s.default(e,this.properties,o,i));return r},e.prototype._generateOneMoreBuffer=function(t){var e=this.renderer.gl,r=t._batchSize,n=t._properties;return new s.default(e,this.properties,n,r)},e.prototype.uploadVertices=function(t,e,r,n,i,o){for(var s=0,a=0,u=0,h=0,l=0;l<r;++l){var c=t[e+l],d=c._texture,f=c.scale.x,p=c.scale.y,v=d.trim,g=d.orig;v?(s=(a=v.x-c.anchor.x*g.width)+v.width,u=(h=v.y-c.anchor.y*g.height)+v.height):(s=g.width*(1-c.anchor.x),a=g.width*-c.anchor.x,u=g.height*(1-c.anchor.y),h=g.height*-c.anchor.y),n[o]=a*f,n[o+1]=h*p,n[o+i]=s*f,n[o+i+1]=h*p,n[o+2*i]=s*f,n[o+2*i+1]=u*p,n[o+3*i]=a*f,n[o+3*i+1]=u*p,o+=4*i}},e.prototype.uploadPosition=function(t,e,r,n,i,o){for(var s=0;s<r;s++){var a=t[e+s].position;n[o]=a.x,n[o+1]=a.y,n[o+i]=a.x,n[o+i+1]=a.y,n[o+2*i]=a.x,n[o+2*i+1]=a.y,n[o+3*i]=a.x,n[o+3*i+1]=a.y,o+=4*i}},e.prototype.uploadRotation=function(t,e,r,n,i,o){for(var s=0;s<r;s++){var a=t[e+s].rotation;n[o]=a,n[o+i]=a,n[o+2*i]=a,n[o+3*i]=a,o+=4*i}},e.prototype.uploadUvs=function(t,e,r,n,i,o){for(var s=0;s<r;++s){var a=t[e+s]._texture._uvs;a?(n[o]=a.x0,n[o+1]=a.y0,n[o+i]=a.x1,n[o+i+1]=a.y1,n[o+2*i]=a.x2,n[o+2*i+1]=a.y2,n[o+3*i]=a.x3,n[o+3*i+1]=a.y3,o+=4*i):(n[o]=0,n[o+1]=0,n[o+i]=0,n[o+i+1]=0,n[o+2*i]=0,n[o+2*i+1]=0,n[o+3*i]=0,n[o+3*i+1]=0,o+=4*i)}},e.prototype.uploadTint=function(t,e,r,n,i,o){for(var s=0;s<r;++s){var u=t[e+s],h=u._texture.baseTexture.premultipliedAlpha,l=u.alpha,c=l<1&&h?(0,a.premultiplyTint)(u._tintRGB,l):u._tintRGB+(255*l<<24);n[o]=c,n[o+i]=c,n[o+2*i]=c,n[o+3*i]=c,o+=4*i}},e.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),t.prototype.destroy.call(this),this.shader.destroy(),this.indices=null,this.tempMatrix=null},e}(i.ObjectRenderer);r.default=u,i.WebGLRenderer.registerPlugin("particle",u)},{"../../core":65,"../../core/utils":125,"./ParticleBuffer":175,"./ParticleShader":177}],177:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(t){function e(r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","attribute vec2 aPositionCoord;","attribute float aRotation;","uniform mat3 projectionMatrix;","uniform vec4 uColor;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   vec2 v = vec2(x, y);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor * uColor;","}"].join("\n"),["varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor;","  gl_FragColor = color;","}"].join("\n")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(function(t){return t&&t.__esModule?t:{default:t}}(t("../../core/Shader")).default);r.default=n},{"../../core/Shader":44}],178:[function(t,e,r){"use strict";Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1})},{}],179:[function(t,e,r){"use strict";Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t})},{}],180:[function(t,e,r){"use strict";var n=function(t){return t&&t.__esModule?t:{default:t}}(t("object-assign"));Object.assign||(Object.assign=n.default)},{"object-assign":6}],181:[function(t,e,r){"use strict";t("./Object.assign"),t("./requestAnimationFrame"),t("./Math.sign"),t("./Number.isInteger"),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array)},{"./Math.sign":178,"./Number.isInteger":179,"./Object.assign":180,"./requestAnimationFrame":182}],182:[function(t,e,r){(function(t){"use strict";if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!t.performance||!t.performance.now){var e=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-e}}for(var r=Date.now(),n=["ms","moz","webkit","o"],i=0;i<n.length&&!t.requestAnimationFrame;++i){var o=n[i];t.requestAnimationFrame=t[o+"RequestAnimationFrame"],t.cancelAnimationFrame=t[o+"CancelAnimationFrame"]||t[o+"CancelRequestAnimationFrame"]}t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+r-e;return n<0&&(n=0),r=e,setTimeout(function(){r=Date.now(),t(performance.now())},n)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){return clearTimeout(t)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],183:[function(t,e,r){"use strict";function n(t,e){var r=!1;if(t&&t._textures&&t._textures.length)for(var n=0;n<t._textures.length;n++)if(t._textures[n]instanceof l.Texture){var i=t._textures[n].baseTexture;-1===e.indexOf(i)&&(e.push(i),r=!0)}return r}function i(t,e){return t instanceof l.BaseTexture&&(-1===e.indexOf(t)&&e.push(t),!0)}function o(t,e){if(t._texture&&t._texture instanceof l.Texture){var r=t._texture.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function s(t,e){return e instanceof l.Text&&(e.updateText(!0),!0)}function a(t,e){if(e instanceof l.TextStyle){var r=e.toFontString();return l.TextMetrics.measureFont(r),!0}return!1}function u(t,e){if(t instanceof l.Text){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var r=t._texture.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function h(t,e){return t instanceof l.TextStyle&&(-1===e.indexOf(t)&&e.push(t),!0)}r.__esModule=!0;var l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),c=function(t){return t&&t.__esModule?t:{default:t}}(t("./limiters/CountLimiter")),d=l.ticker.shared;l.settings.UPLOADS_PER_FRAME=4;var f=function(){function t(e){var r=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.limiter=new c.default(l.settings.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){r.queue&&r.prepareItems()},this.registerFindHook(u),this.registerFindHook(h),this.registerFindHook(n),this.registerFindHook(i),this.registerFindHook(o),this.registerUploadHook(s),this.registerUploadHook(a)}return t.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,d.addOnce(this.tick,this,l.UPDATE_PRIORITY.UTILITY))):e&&e()},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var r=0,n=this.uploadHooks.length;r<n;r++)if(this.uploadHooks[r](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)d.addOnce(this.tick,this,l.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var i=this.completes.slice(0);this.completes.length=0;for(var o=0,s=i.length;o<s;o++)i[o]()}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},t.prototype.add=function(t){for(var e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](t,this.queue);e++);if(t instanceof l.Container)for(var n=t.children.length-1;n>=0;n--)this.add(t.children[n]);return this},t.prototype.destroy=function(){this.ticking&&d.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();r.default=f},{"../core":65,"./limiters/CountLimiter":186}],184:[function(t,e,r){"use strict";function n(t,e){if(e instanceof i.BaseTexture){var r=e.source,n=0===r.width?t.canvas.width:Math.min(t.canvas.width,r.width),o=0===r.height?t.canvas.height:Math.min(t.canvas.height,r.height);return t.ctx.drawImage(r,0,0,n,o,0,0,t.canvas.width,t.canvas.height),!0}return!1}r.__esModule=!0;var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),o=function(t){return t&&t.__esModule?t:{default:t}}(t("../BasePrepare")),s=16,a=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return i.uploadHookHelper=i,i.canvas=document.createElement("canvas"),i.canvas.width=s,i.canvas.height=s,i.ctx=i.canvas.getContext("2d"),i.registerUploadHook(n),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.ctx=null,this.canvas=null},e}(o.default);r.default=a,i.CanvasRenderer.registerPlugin("prepare",a)},{"../../core":65,"../BasePrepare":183}],185:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./webgl/WebGLPrepare");Object.defineProperty(r,"webgl",{enumerable:!0,get:function(){return n(i).default}});var o=t("./canvas/CanvasPrepare");Object.defineProperty(r,"canvas",{enumerable:!0,get:function(){return n(o).default}});var s=t("./BasePrepare");Object.defineProperty(r,"BasePrepare",{enumerable:!0,get:function(){return n(s).default}});var a=t("./limiters/CountLimiter");Object.defineProperty(r,"CountLimiter",{enumerable:!0,get:function(){return n(a).default}});var u=t("./limiters/TimeLimiter");Object.defineProperty(r,"TimeLimiter",{enumerable:!0,get:function(){return n(u).default}})},{"./BasePrepare":183,"./canvas/CanvasPrepare":184,"./limiters/CountLimiter":186,"./limiters/TimeLimiter":187,"./webgl/WebGLPrepare":188}],186:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.maxItemsPerFrame=e,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();r.default=n},{}],187:[function(t,e,r){"use strict";r.__esModule=!0;var n=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.maxMilliseconds=e,this.frameStart=0}return t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},t}();r.default=n},{}],188:[function(t,e,r){"use strict";function n(t,e){return e instanceof s.BaseTexture&&(e._glTextures[t.CONTEXT_UID]||t.textureManager.updateTexture(e),!0)}function i(t,e){return e instanceof s.Graphics&&((e.dirty||e.clearDirty||!e._webGL[t.plugins.graphics.CONTEXT_UID])&&t.plugins.graphics.updateGraphics(e),!0)}function o(t,e){return t instanceof s.Graphics&&(e.push(t),!0)}r.__esModule=!0;var s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),a=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return s.uploadHookHelper=s.renderer,s.registerFindHook(o),s.registerUploadHook(n),s.registerUploadHook(i),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(function(t){return t&&t.__esModule?t:{default:t}}(t("../BasePrepare")).default);r.default=a,s.WebGLRenderer.registerPlugin("prepare",a)},{"../../core":65,"../BasePrepare":183}],189:[function(t,e,r){(function(e){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}r.__esModule=!0,r.loader=r.prepare=r.particles=r.mesh=r.loaders=r.interaction=r.filters=r.extras=r.extract=r.accessibility=void 0;var i=t("./polyfill");Object.keys(i).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(r,t,{enumerable:!0,get:function(){return i[t]}})});var o=t("./core");Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(r,t,{enumerable:!0,get:function(){return o[t]}})});var s=function(t){return t&&t.__esModule?t:{default:t}}(t("./deprecation")),a=n(t("./accessibility")),u=n(t("./extract")),h=n(t("./extras")),l=n(t("./filters")),c=n(t("./interaction")),d=n(t("./loaders")),f=n(t("./mesh")),p=n(t("./particles")),v=n(t("./prepare"));o.utils.mixins.performMixins();var g=d.shared||null;r.accessibility=a,r.extract=u,r.extras=h,r.filters=l,r.interaction=c,r.loaders=d,r.mesh=f,r.particles=p,r.prepare=v,r.loader=g,"function"==typeof s.default&&(0,s.default)(r),e.PIXI=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./accessibility":42,"./core":65,"./deprecation":131,"./extract":133,"./extras":141,"./filters":153,"./interaction":159,"./loaders":162,"./mesh":171,"./particles":174,"./polyfill":181,"./prepare":185}]},{},[189])(189)});
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Perf=t()}}(function(){return function t(e,i,s){function n(r,_){if(!i[r]){if(!e[r]){var h="function"==typeof require&&require;if(!_&&h)return h(r,!0);if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var f=i[r]={exports:{}};e[r][0].call(f.exports,function(t){var i=e[r][1][t];return n(i||t)},f,f.exports,t,e,i,s)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<s.length;r++)n(s[r]);return n}({"perf.js":[function(t,e,i){!function(t,e){"use strict";function s(t,e){return null==e?null:(null==e.__id__&&(e.__id__=r++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[e.__id__],null==i&&((i=function(){return i.method.apply(i.scope,arguments)}).scope=t,i.method=e,t.hx__closures__[e.__id__]=i),i);var i}var n=("undefined"!=typeof window?window:i).Perf=function(t,e){null==e&&(e=0),null==t&&(t="TR"),this._perfObj=window.performance,this._memoryObj=window.performance.memory,this._memCheck=null!=this._perfObj&&null!=this._memoryObj&&this._memoryObj.totalJSHeapSize>0,this.currentFps=0,this.currentMs=0,this.currentMem="0",this._pos=t,this._offset=e,this._time=0,this._ticks=0,this._fpsMin=1/0,this._fpsMax=0,null!=this._perfObj&&null!=s(o=this._perfObj,o.now)?this._startTime=this._perfObj.now():this._startTime=(new Date).getTime(),this._prevTime=-n.MEASUREMENT_INTERVAL,this._createFpsDom(),this._createMsDom(),this._memCheck&&this._createMemoryDom(),window.requestAnimationFrame(s(this,this._tick))};n.prototype={_now:function(){return null!=this._perfObj&&null!=s(o=this._perfObj,o.now)?this._perfObj.now():(new Date).getTime()},_tick:function(){var t;t=null!=this._perfObj&&null!=s(o=this._perfObj,o.now)?this._perfObj.now():(new Date).getTime(),this._ticks++,t>this._prevTime+n.MEASUREMENT_INTERVAL&&(this.currentMs=Math.round(t-this._startTime),this.ms.innerHTML="MS: "+this.currentMs,this.currentFps=Math.round(1e3*this._ticks/(t-this._prevTime)),this._fpsMin=Math.min(this._fpsMin,this.currentFps),this._fpsMax=Math.max(this._fpsMax,this.currentFps),this.fps.innerHTML="FPS: "+this.currentFps+" ("+this._fpsMin+"-"+this._fpsMax+")",this.currentFps>=30?this.fps.style.backgroundColor=n.FPS_BG_CLR:this.currentFps>=15?this.fps.style.backgroundColor=n.FPS_WARN_BG_CLR:this.fps.style.backgroundColor=n.FPS_PROB_BG_CLR,this._prevTime=t,this._ticks=0,this._memCheck&&(this.currentMem=this._getFormattedSize(this._memoryObj.usedJSHeapSize,2),this.memory.innerHTML="MEM: "+this.currentMem)),this._startTime=t,window.requestAnimationFrame(s(this,this._tick))},_createDiv:function(t,e){var i;switch(null==e&&(e=0),(i=window.document.createElement("div")).id=t,i.className=t,i.style.position="absolute",this._pos){case"TL":i.style.left=this._offset+"px",i.style.top=e+"px";break;case"TR":i.style.right=this._offset+"px",i.style.top=e+"px";break;case"BL":i.style.left=this._offset+"px",i.style.bottom=(this._memCheck?48:32)-e+"px";break;case"BR":i.style.right=this._offset+"px",i.style.bottom=(this._memCheck?48:32)-e+"px"}return i.style.width="80px",i.style.height="12px",i.style.lineHeight="12px",i.style.padding="2px",i.style.fontFamily=n.FONT_FAMILY,i.style.fontSize="9px",i.style.fontWeight="bold",i.style.textAlign="center",window.document.body.appendChild(i),i},_createFpsDom:function(){this.fps=this._createDiv("fps"),this.fps.style.backgroundColor=n.FPS_BG_CLR,this.fps.style.zIndex="995",this.fps.style.color=n.FPS_TXT_CLR,this.fps.innerHTML="FPS: 0"},_createMsDom:function(){this.ms=this._createDiv("ms",16),this.ms.style.backgroundColor=n.MS_BG_CLR,this.ms.style.zIndex="996",this.ms.style.color=n.MS_TXT_CLR,this.ms.innerHTML="MS: 0"},_createMemoryDom:function(){this.memory=this._createDiv("memory",32),this.memory.style.backgroundColor=n.MEM_BG_CLR,this.memory.style.color=n.MEM_TXT_CLR,this.memory.style.zIndex="997",this.memory.innerHTML="MEM: 0"},_getFormattedSize:function(t,e){null==e&&(e=0);if(0==t)return"0";var i=Math.pow(10,e),s=Math.floor(Math.log(t)/Math.log(1024));return Math.round(t*i/Math.pow(1024,s))/i+" "+["Bytes","KB","MB","GB","TB"][s]},addInfo:function(t){this.info=this._createDiv("info",this._memCheck?48:32),this.info.style.backgroundColor=n.INFO_BG_CLR,this.info.style.color=n.INFO_TXT_CLR,this.info.style.zIndex="998",this.info.innerHTML=t},clearInfo:function(){null!=this.info&&(window.document.body.removeChild(this.info),this.info=null)}};var o,r=0;n.MEASUREMENT_INTERVAL=1e3,n.FONT_FAMILY="Helvetica,Arial",n.FPS_BG_CLR="#00FF00",n.FPS_WARN_BG_CLR="#FF8000",n.FPS_PROB_BG_CLR="#FF0000",n.MS_BG_CLR="#FFFF00",n.MEM_BG_CLR="#086A87",n.INFO_BG_CLR="#00FFFF",n.FPS_TXT_CLR="#000000",n.MS_TXT_CLR="#000000",n.MEM_TXT_CLR="#FFFFFF",n.INFO_TXT_CLR="#000000",n.TOP_LEFT="TL",n.TOP_RIGHT="TR",n.BOTTOM_LEFT="BL",n.BOTTOM_RIGHT="BR"}("undefined"!=typeof console&&console)},{}]},{},[])("perf.js")});
!function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var e=this||n;return e._counter=1e3,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var t=this||n;if(e=parseFloat(e),t.ctx||_(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,n.ctx.currentTime);for(var o=0;o<t._howls.length;o++)if(!t._howls[o]._webAudio)for(var r=t._howls[o]._getSoundIds(),a=0;a<r.length;a++){var i=t._howls[o]._soundById(r[a]);i&&i._node&&(i._node.volume=i._volume*e)}return t}return t._volume},mute:function(e){var t=this||n;t.ctx||_(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,n.ctx.currentTime);for(var o=0;o<t._howls.length;o++)if(!t._howls[o]._webAudio)for(var r=t._howls[o]._getSoundIds(),a=0;a<r.length;a++){var i=t._howls[o]._soundById(r[a]);i&&i._node&&(i._node.muted=!!e||i._muted)}return t},unload:function(){for(var e=this||n,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,_()),e},codecs:function(e){return(this||n)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||n;if(e.state=e.ctx&&e.ctx.state||"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(n){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||n,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(n){return e}if(!t||"function"!=typeof t.canPlayType)return e;var o=t.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),a=r&&parseInt(r[0].split("/")[1],10)<33;return e._codecs={mp3:!(a||!o&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!o,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||n,t=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi|Chrome/i.test(e._navigator&&e._navigator.userAgent);if(!e._mobileEnabled&&e.ctx&&t){e._mobileEnabled=!1,e.mobileAutoEnable=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var o=function(t){n._autoResume();var r=e.ctx.createBufferSource();r.buffer=e._scratchBuffer,r.connect(e.ctx.destination),void 0===r.start?r.noteOn(0):r.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),r.onended=function(){r.disconnect(0),e._mobileEnabled=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0);for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&n.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var o=0;o<e._howls[t]._sounds.length;o++)if(!e._howls[t]._sounds[o]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&n.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(function(){e.state="running";for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var n=new e,t=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};t.prototype={init:function(e){var t=this;return n.ctx||_(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhrWithCredentials=e.xhrWithCredentials||!1,t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=n.usingWebAudio&&!t._html5,void 0!==n.ctx&&n.ctx&&n.mobileAutoEnable&&n._enableMobileAudio(),n._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t.load(),t},load:function(){var e=this,t=null;if(!n.noAudio){"string"==typeof e._src&&(e._src=[e._src]);for(var r=0;r<e._src.length;r++){var i,u;if(e._format&&e._format[r])i=e._format[r];else{if("string"!=typeof(u=e._src[r])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(i=/^data:audio\/([^;,]+);/i.exec(u))||(i=/\.([^.]+)$/.exec(u.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&n.codecs(i)){t=e._src[r];break}}return t?(e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new o(e),e._webAudio&&a(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")}e._emit("loaderror",null,"No audio support.")},play:function(e,t){var o=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===o._state&&!o._sprite[e])return null;if(void 0===e){e="__default";for(var a=0,i=0;i<o._sounds.length;i++)o._sounds[i]._paused&&!o._sounds[i]._ended&&(a++,r=o._sounds[i]._id);1===a?e=null:r=null}}var u=r?o._soundById(r):o._inactiveSound();if(!u)return null;if(r&&!e&&(e=u._sprite||"__default"),"loaded"!==o._state){u._sprite=e,u._ended=!1;var s=u._id;return o._queue.push({event:"play",action:function(){o.play(s)}}),s}if(r&&!u._paused)return t||o._loadQueue("play"),u._id;o._webAudio&&n._autoResume();var _=Math.max(0,u._seek>0?u._seek:o._sprite[e][0]/1e3),d=Math.max(0,(o._sprite[e][0]+o._sprite[e][1])/1e3-_),l=1e3*d/Math.abs(u._rate);if(u._paused=!1,u._ended=!1,u._sprite=e,u._seek=_,u._start=o._sprite[e][0]/1e3,u._stop=(o._sprite[e][0]+o._sprite[e][1])/1e3,u._loop=!(!u._loop&&!o._sprite[e][2]),!(u._seek>=u._stop)){var c=u._node;if(o._webAudio){var p=function(){o._refreshBuffer(u);var e=u._muted||o._muted?0:u._volume;c.gain.setValueAtTime(e,n.ctx.currentTime),u._playStart=n.ctx.currentTime,void 0===c.bufferSource.start?u._loop?c.bufferSource.noteGrainOn(0,_,86400):c.bufferSource.noteGrainOn(0,_,d):u._loop?c.bufferSource.start(0,_,86400):c.bufferSource.start(0,_,d),l!==1/0&&(o._endTimers[u._id]=setTimeout(o._ended.bind(o,u),l)),t||setTimeout(function(){o._emit("play",u._id)},0)};"running"===n.state?p():(o.once("resume",p),o._clearTimer(u._id))}else{var f=function(){c.currentTime=_,c.muted=u._muted||o._muted||n._muted||c.muted,c.volume=u._volume*n.volume(),c.playbackRate=u._rate;try{var r=c.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(o._playLock=!0,r.then(function(){o._playLock=!1,t||o._emit("play",u._id)}).catch(function(){o._playLock=!1,o._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.")})):t||o._emit("play",u._id),c.playbackRate=u._rate,c.paused)return void o._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||u._loop?o._endTimers[u._id]=setTimeout(o._ended.bind(o,u),l):(o._endTimers[u._id]=function(){o._ended(u),c.removeEventListener("ended",o._endTimers[u._id],!1)},c.addEventListener("ended",o._endTimers[u._id],!1))}catch(e){o._emit("playerror",u._id,e)}},m=window&&window.ejecta||!c.readyState&&n._navigator.isCocoonJS;if(c.readyState>=3||m)f();else{var v=function(){f(),c.removeEventListener(n._canPlayEvent,v,!1)};c.addEventListener(n._canPlayEvent,v,!1),o._clearTimer(u._id)}}return u._id}o._ended(u)},pause:function(e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"pause",action:function(){n.pause(e)}}),n;for(var t=n._getSoundIds(e),o=0;o<t.length;o++){n._clearTimer(t[o]);var r=n._soundById(t[o]);if(r&&!r._paused&&(r._seek=n.seek(t[o]),r._rateSeek=0,r._paused=!0,n._stopFade(t[o]),r._node))if(n._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),n._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||n._emit("pause",r?r._id:null)}return n},stop:function(e,n){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"stop",action:function(){t.stop(e)}}),t;for(var o=t._getSoundIds(e),r=0;r<o.length;r++){t._clearTimer(o[r]);var a=t._soundById(o[r]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,t._stopFade(o[r]),a._node&&(t._webAudio?a._node.bufferSource&&(void 0===a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),t._cleanBuffer(a._node)):isNaN(a._node.duration)&&a._node.duration!==1/0||(a._node.currentTime=a._start||0,a._node.pause())),n||t._emit("stop",a._id))}return t},mute:function(e,t){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"mute",action:function(){o.mute(e,t)}}),o;if(void 0===t){if("boolean"!=typeof e)return o._muted;o._muted=e}for(var r=o._getSoundIds(t),a=0;a<r.length;a++){var i=o._soundById(r[a]);i&&(i._muted=e,i._interval&&o._stopFade(i._id),o._webAudio&&i._node?i._node.gain.setValueAtTime(e?0:i._volume,n.ctx.currentTime):i._node&&(i._node.muted=!!n._muted||e),o._emit("mute",i._id))}return o},volume:function(){var e,t,o,r=this,a=arguments;if(0===a.length)return r._volume;if(1===a.length||2===a.length&&void 0===a[1]?r._getSoundIds().indexOf(a[0])>=0?t=parseInt(a[0],10):e=parseFloat(a[0]):a.length>=2&&(e=parseFloat(a[0]),t=parseInt(a[1],10)),!(void 0!==e&&e>=0&&e<=1))return(o=t?r._soundById(t):r._sounds[0])?o._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,a)}}),r;void 0===t&&(r._volume=e),t=r._getSoundIds(t);for(var i=0;i<t.length;i++)(o=r._soundById(t[i]))&&(o._volume=e,a[2]||r._stopFade(t[i]),r._webAudio&&o._node&&!o._muted?o._node.gain.setValueAtTime(e,n.ctx.currentTime):o._node&&!o._muted&&(o._node.volume=e*n.volume()),r._emit("volume",o._id));return r},fade:function(e,t,o,r){var a=this;if("loaded"!==a._state||a._playLock)return a._queue.push({event:"fade",action:function(){a.fade(e,t,o,r)}}),a;a.volume(e,r);for(var i=a._getSoundIds(r),u=0;u<i.length;u++){var s=a._soundById(i[u]);if(s){if(r||a._stopFade(i[u]),a._webAudio&&!s._muted){var _=n.ctx.currentTime,d=_+o/1e3;s._volume=e,s._node.gain.setValueAtTime(e,_),s._node.gain.linearRampToValueAtTime(t,d)}a._startFadeInterval(s,e,t,o,i[u],void 0===r)}}return a},_startFadeInterval:function(e,n,t,o,r,a){var i=this,u=n,s=t-n,_=Math.abs(s/.01),d=Math.max(4,_>0?o/_:o),l=Date.now();e._fadeTo=t,e._interval=setInterval(function(){var r=(Date.now()-l)/o;l=Date.now(),u+=s*r,u=Math.max(0,u),u=Math.min(1,u),u=Math.round(100*u)/100,i._webAudio?e._volume=u:i.volume(u,e._id,!0),a&&(i._volume=u),(t<n&&u<=t||t>n&&u>=t)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,i.volume(t,e._id),i._emit("fade",e._id))},d)},_stopFade:function(e){var t=this,o=t._soundById(e);return o&&o._interval&&(t._webAudio&&o._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(o._interval),o._interval=null,t.volume(o._fadeTo,e),o._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,n,t,o=this,r=arguments;if(0===r.length)return o._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(t=o._soundById(parseInt(r[0],10)))&&t._loop;e=r[0],o._loop=e}else 2===r.length&&(e=r[0],n=parseInt(r[1],10));for(var a=o._getSoundIds(n),i=0;i<a.length;i++)(t=o._soundById(a[i]))&&(t._loop=e,o._webAudio&&t._node&&t._node.bufferSource&&(t._node.bufferSource.loop=e,e&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop)));return o},rate:function(){var e,t,o,r=this,a=arguments;if(0===a.length)t=r._sounds[0]._id;else if(1===a.length){r._getSoundIds().indexOf(a[0])>=0?t=parseInt(a[0],10):e=parseFloat(a[0])}else 2===a.length&&(e=parseFloat(a[0]),t=parseInt(a[1],10));if("number"!=typeof e)return(o=r._soundById(t))?o._rate:r._rate;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,a)}}),r;void 0===t&&(r._rate=e),t=r._getSoundIds(t);for(var i=0;i<t.length;i++)if(o=r._soundById(t[i])){o._rateSeek=r.seek(t[i]),o._playStart=r._webAudio?n.ctx.currentTime:o._playStart,o._rate=e,r._webAudio&&o._node&&o._node.bufferSource?o._node.bufferSource.playbackRate.setValueAtTime(e,n.ctx.currentTime):o._node&&(o._node.playbackRate=e);var u=r.seek(t[i]),s=1e3*((r._sprite[o._sprite][0]+r._sprite[o._sprite][1])/1e3-u)/Math.abs(o._rate);!r._endTimers[t[i]]&&o._paused||(r._clearTimer(t[i]),r._endTimers[t[i]]=setTimeout(r._ended.bind(r,o),s)),r._emit("rate",o._id)}return r},seek:function(){var e,t,o=this,r=arguments;if(0===r.length)t=o._sounds[0]._id;else if(1===r.length){o._getSoundIds().indexOf(r[0])>=0?t=parseInt(r[0],10):o._sounds.length&&(t=o._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(void 0===t)return o;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"seek",action:function(){o.seek.apply(o,r)}}),o;var a=o._soundById(t);if(a){if(!("number"==typeof e&&e>=0)){if(o._webAudio){var i=o.playing(t)?n.ctx.currentTime-a._playStart:0,u=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(u+i*Math.abs(a._rate))}return a._node.currentTime}var s=o.playing(t);s&&o.pause(t,!0),a._seek=e,a._ended=!1,o._clearTimer(t),!o._webAudio&&a._node&&(a._node.currentTime=e);var _=function(){o._emit("seek",t),s&&o.play(t,!0)};if(s&&!o._webAudio){var d=function(){o._playLock?setTimeout(d,0):_()};setTimeout(d,0)}else _()}return o},playing:function(e){var n=this;if("number"==typeof e){var t=n._soundById(e);return!!t&&!t._paused}for(var o=0;o<n._sounds.length;o++)if(!n._sounds[o]._paused)return!0;return!1},duration:function(e){var n=this,t=n._duration,o=n._soundById(e);return o&&(t=n._sprite[o._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,o=0;o<t.length;o++)t[o]._paused||e.stop(t[o]._id),e._webAudio||(/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent)||(t[o]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),t[o]._node.removeEventListener("error",t[o]._errorFn,!1),t[o]._node.removeEventListener(n._canPlayEvent,t[o]._loadFn,!1)),delete t[o]._node,e._clearTimer(t[o]._id);var a=n._howls.indexOf(e);a>=0&&n._howls.splice(a,1);var i=!0;for(o=0;o<n._howls.length;o++)if(n._howls[o]._src===e._src){i=!1;break}return r&&i&&delete r[e._src],n.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,n,t,o){var r=this["_on"+e];return"function"==typeof n&&r.push(o?{id:t,fn:n,once:o}:{id:t,fn:n}),this},off:function(e,n,t){var o=this,r=o["_on"+e],a=0;if("number"==typeof n&&(t=n,n=null),n||t)for(a=0;a<r.length;a++){var i=t===r[a].id;if(n===r[a].fn&&i||!n&&i){r.splice(a,1);break}}else if(e)o["_on"+e]=[];else{var u=Object.keys(o);for(a=0;a<u.length;a++)0===u[a].indexOf("_on")&&Array.isArray(o[u[a]])&&(o[u[a]]=[])}return o},once:function(e,n,t){return this.on(e,n,t,1),this},_emit:function(e,n,t){for(var o=this,r=o["_on"+e],a=r.length-1;a>=0;a--)r[a].id&&r[a].id!==n&&"load"!==e||(setTimeout(function(e){e.call(this,n,t)}.bind(o,r[a].fn),0),r[a].once&&o.off(e,r[a].fn,r[a].id));return o._loadQueue(e),o},_loadQueue:function(e){var n=this;if(n._queue.length>0){var t=n._queue[0];t.event===e&&(n._queue.shift(),n._loadQueue()),e||t.action()}return n},_ended:function(e){var t=this,o=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var r=!(!e._loop&&!t._sprite[o][2]);if(t._emit("end",e._id),!t._webAudio&&r&&t.stop(e._id,!0).play(e._id),t._webAudio&&r){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=n.ctx.currentTime;var a=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),a)}return t._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),n._autoSuspend()),t._webAudio||r||t.stop(e._id,!0),t},_clearTimer:function(e){var n=this;if(n._endTimers[e]){if("function"!=typeof n._endTimers[e])clearTimeout(n._endTimers[e]);else{var t=n._soundById(e);t&&t._node&&t._node.removeEventListener("ended",n._endTimers[e],!1)}delete n._endTimers[e]}return n},_soundById:function(e){for(var n=this,t=0;t<n._sounds.length;t++)if(e===n._sounds[t]._id)return n._sounds[t];return null},_inactiveSound:function(){var e=this;e._drain();for(var n=0;n<e._sounds.length;n++)if(e._sounds[n]._ended)return e._sounds[n].reset();return new o(e)},_drain:function(){var e=this,n=e._pool,t=0,o=0;if(!(e._sounds.length<n)){for(o=0;o<e._sounds.length;o++)e._sounds[o]._ended&&t++;for(o=e._sounds.length-1;o>=0;o--){if(t<=n)return;e._sounds[o]._ended&&(e._webAudio&&e._sounds[o]._node&&e._sounds[o]._node.disconnect(0),e._sounds.splice(o,1),t--)}}},_getSoundIds:function(e){if(void 0===e){for(var n=[],t=0;t<this._sounds.length;t++)n.push(this._sounds[t]._id);return n}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=n.ctx.createBufferSource(),e._node.bufferSource.buffer=r[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,n.ctx.currentTime),this},_cleanBuffer:function(e){if(n._scratchBuffer&&e.bufferSource){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=n._scratchBuffer}catch(e){}}return e.bufferSource=null,this}};var o=function(e){this._parent=e,this.init()};o.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,o=n._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),e._node.gain.setValueAtTime(o,n.ctx.currentTime),e._node.paused=!0,e._node.connect(n.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(n._canPlayEvent,e._loadFn,!1),e._node.src=t._src,e._node.preload="auto",e._node.volume=o*n.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(n._canPlayEvent,e._loadFn,!1)}};var r={},a=function(e){var n=e._src;if(r[n])return e._duration=r[n].duration,void s(e);if(/^data:[^;]+;base64,/.test(n)){for(var t=atob(n.split(",")[1]),o=new Uint8Array(t.length),a=0;a<t.length;++a)o[a]=t.charCodeAt(a);u(o.buffer,e)}else{var _=new XMLHttpRequest;_.open("GET",n,!0),_.withCredentials=e._xhrWithCredentials,_.responseType="arraybuffer",_.onload=function(){var n=(_.status+"")[0];"0"===n||"2"===n||"3"===n?u(_.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+_.status+".")},_.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete r[n],e.load())},i(_)}},i=function(e){try{e.send()}catch(n){e.onerror()}},u=function(e,t){var o=function(){t._emit("loaderror",null,"Decoding audio data failed.")},a=function(e){e&&t._sounds.length>0?(r[t._src]=e,s(t,e)):o()};"undefined"!=typeof Promise&&1===n.ctx.decodeAudioData.length?n.ctx.decodeAudioData(e).then(a).catch(o):n.ctx.decodeAudioData(e,a,o)},s=function(e,n){n&&!e._duration&&(e._duration=n.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},_=function(){try{"undefined"!=typeof AudioContext?n.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch(e){n.usingWebAudio=!1}var e=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),t=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),o=t?parseInt(t[1],10):null;if(e&&o&&o<9){var r=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());(n._navigator&&n._navigator.standalone&&!r||n._navigator&&!n._navigator.standalone&&!r)&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:1,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:n,Howl:t}}),"undefined"!=typeof exports&&(exports.Howler=n,exports.Howl=t),"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=n,window.Howl=t,window.Sound=o):"undefined"!=typeof global&&(global.HowlerGlobal=e,global.Howler=n,global.Howl=t,global.Sound=o)}(),function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var t=n._howls.length-1;t>=0;t--)n._howls[t].stereo(e);return n},HowlerGlobal.prototype.pos=function(e,n,t){var o=this;return o.ctx&&o.ctx.listener?(n="number"!=typeof n?o._pos[1]:n,t="number"!=typeof t?o._pos[2]:t,"number"!=typeof e?o._pos:(o._pos=[e,n,t],void 0!==o.ctx.listener.positionX?(o.ctx.listener.positionX.setTargetAtTime(o._pos[0],Howler.ctx.currentTime,.1),o.ctx.listener.positionY.setTargetAtTime(o._pos[1],Howler.ctx.currentTime,.1),o.ctx.listener.positionZ.setTargetAtTime(o._pos[2],Howler.ctx.currentTime,.1)):o.ctx.listener.setPosition(o._pos[0],o._pos[1],o._pos[2]),o)):o},HowlerGlobal.prototype.orientation=function(e,n,t,o,r,a){var i=this;if(!i.ctx||!i.ctx.listener)return i;var u=i._orientation;return n="number"!=typeof n?u[1]:n,t="number"!=typeof t?u[2]:t,o="number"!=typeof o?u[3]:o,r="number"!=typeof r?u[4]:r,a="number"!=typeof a?u[5]:a,"number"!=typeof e?u:(i._orientation=[e,n,t,o,r,a],void 0!==i.ctx.listener.forwardX?(i.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),i.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),i.ctx.listener.forwardZ.setTargetAtTime(t,Howler.ctx.currentTime,.1),i.ctx.listener.upX.setTargetAtTime(e,Howler.ctx.currentTime,.1),i.ctx.listener.upY.setTargetAtTime(n,Howler.ctx.currentTime,.1),i.ctx.listener.upZ.setTargetAtTime(t,Howler.ctx.currentTime,.1)):i.ctx.listener.setOrientation(e,n,t,o,r,a),i)},Howl.prototype.init=function(e){return function(n){var t=this;return t._orientation=n.orientation||[1,0,0],t._stereo=n.stereo||null,t._pos=n.pos||null,t._pannerAttr={coneInnerAngle:void 0!==n.coneInnerAngle?n.coneInnerAngle:360,coneOuterAngle:void 0!==n.coneOuterAngle?n.coneOuterAngle:360,coneOuterGain:void 0!==n.coneOuterGain?n.coneOuterGain:0,distanceModel:void 0!==n.distanceModel?n.distanceModel:"inverse",maxDistance:void 0!==n.maxDistance?n.maxDistance:1e4,panningModel:void 0!==n.panningModel?n.panningModel:"HRTF",refDistance:void 0!==n.refDistance?n.refDistance:1,rolloffFactor:void 0!==n.rolloffFactor?n.rolloffFactor:1},t._onstereo=n.onstereo?[{fn:n.onstereo}]:[],t._onpos=n.onpos?[{fn:n.onpos}]:[],t._onorientation=n.onorientation?[{fn:n.onorientation}]:[],e.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(n,t){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"stereo",action:function(){o.stereo(n,t)}}),o;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===t){if("number"!=typeof n)return o._stereo;o._stereo=n,o._pos=[n,0,0]}for(var a=o._getSoundIds(t),i=0;i<a.length;i++){var u=o._soundById(a[i]);if(u){if("number"!=typeof n)return u._stereo;u._stereo=n,u._pos=[n,0,0],u._node&&(u._pannerAttr.panningModel="equalpower",u._panner&&u._panner.pan||e(u,r),"spatial"===r?void 0!==u._panner.positionX?(u._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):u._panner.setPosition(n,0,0):u._panner.pan.setValueAtTime(n,Howler.ctx.currentTime)),o._emit("stereo",u._id)}}return o},Howl.prototype.pos=function(n,t,o,r){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"pos",action:function(){a.pos(n,t,o,r)}}),a;if(t="number"!=typeof t?0:t,o="number"!=typeof o?-.5:o,void 0===r){if("number"!=typeof n)return a._pos;a._pos=[n,t,o]}for(var i=a._getSoundIds(r),u=0;u<i.length;u++){var s=a._soundById(i[u]);if(s){if("number"!=typeof n)return s._pos;s._pos=[n,t,o],s._node&&(s._panner&&!s._panner.pan||e(s,"spatial"),void 0!==s._panner.positionX?(s._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(t,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(o,Howler.ctx.currentTime)):s._panner.setOrientation(n,t,o)),a._emit("pos",s._id)}}return a},Howl.prototype.orientation=function(n,t,o,r){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"orientation",action:function(){a.orientation(n,t,o,r)}}),a;if(t="number"!=typeof t?a._orientation[1]:t,o="number"!=typeof o?a._orientation[2]:o,void 0===r){if("number"!=typeof n)return a._orientation;a._orientation=[n,t,o]}for(var i=a._getSoundIds(r),u=0;u<i.length;u++){var s=a._soundById(i[u]);if(s){if("number"!=typeof n)return s._orientation;s._orientation=[n,t,o],s._node&&(s._panner||(s._pos||(s._pos=a._pos||[0,0,-.5]),e(s,"spatial")),void 0!==s._panner.orientationX?(s._panner.orientationX.setValueAtTime(n,Howler.ctx.currentTime),s._panner.orientationY.setValueAtTime(t,Howler.ctx.currentTime),s._panner.orientationZ.setValueAtTime(o,Howler.ctx.currentTime)):s._panner.setOrientation(n,t,o)),a._emit("orientation",s._id)}}return a},Howl.prototype.pannerAttr=function(){var n,t,o,r=this,a=arguments;if(!r._webAudio)return r;if(0===a.length)return r._pannerAttr;if(1===a.length){if("object"!=typeof a[0])return(o=r._soundById(parseInt(a[0],10)))?o._pannerAttr:r._pannerAttr;n=a[0],void 0===t&&(n.pannerAttr||(n.pannerAttr={coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,distanceModel:n.distanceModel,maxDistance:n.maxDistance,refDistance:n.refDistance,rolloffFactor:n.rolloffFactor,panningModel:n.panningModel}),r._pannerAttr={coneInnerAngle:void 0!==n.pannerAttr.coneInnerAngle?n.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:void 0!==n.pannerAttr.coneOuterAngle?n.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:void 0!==n.pannerAttr.coneOuterGain?n.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:void 0!==n.pannerAttr.distanceModel?n.pannerAttr.distanceModel:r._distanceModel,maxDistance:void 0!==n.pannerAttr.maxDistance?n.pannerAttr.maxDistance:r._maxDistance,refDistance:void 0!==n.pannerAttr.refDistance?n.pannerAttr.refDistance:r._refDistance,rolloffFactor:void 0!==n.pannerAttr.rolloffFactor?n.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:void 0!==n.pannerAttr.panningModel?n.pannerAttr.panningModel:r._panningModel})}else 2===a.length&&(n=a[0],t=parseInt(a[1],10));for(var i=r._getSoundIds(t),u=0;u<i.length;u++)if(o=r._soundById(i[u])){var s=o._pannerAttr;s={coneInnerAngle:void 0!==n.coneInnerAngle?n.coneInnerAngle:s.coneInnerAngle,coneOuterAngle:void 0!==n.coneOuterAngle?n.coneOuterAngle:s.coneOuterAngle,coneOuterGain:void 0!==n.coneOuterGain?n.coneOuterGain:s.coneOuterGain,distanceModel:void 0!==n.distanceModel?n.distanceModel:s.distanceModel,maxDistance:void 0!==n.maxDistance?n.maxDistance:s.maxDistance,refDistance:void 0!==n.refDistance?n.refDistance:s.refDistance,rolloffFactor:void 0!==n.rolloffFactor?n.rolloffFactor:s.rolloffFactor,panningModel:void 0!==n.panningModel?n.panningModel:s.panningModel};var _=o._panner;_?(_.coneInnerAngle=s.coneInnerAngle,_.coneOuterAngle=s.coneOuterAngle,_.coneOuterGain=s.coneOuterGain,_.distanceModel=s.distanceModel,_.maxDistance=s.maxDistance,_.refDistance=s.refDistance,_.rolloffFactor=s.rolloffFactor,_.panningModel=s.panningModel):(o._pos||(o._pos=r._pos||[0,0,-.5]),e(o,"spatial"))}return r},Sound.prototype.init=function(e){return function(){var n=this,t=n._parent;n._orientation=t._orientation,n._stereo=t._stereo,n._pos=t._pos,n._pannerAttr=t._pannerAttr,e.call(this),n._stereo?t.stereo(n._stereo):n._pos&&t.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var n=this,t=n._parent;return n._orientation=t._orientation,n._stereo=t._stereo,n._pos=t._pos,n._pannerAttr=t._pannerAttr,n._stereo?t.stereo(n._stereo):n._pos?t.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,t._refreshBuffer(n)),e.call(this)}}(Sound.prototype.reset);var e=function(e,n){"spatial"===(n=n||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}();
!function(e,t){"use strict";e.hxGeomAlgo=e.hxGeomAlgo||{},e.hxGeomAlgo._HxPoint=e.hxGeomAlgo._HxPoint||{},e.bikas=e.bikas||{},e.bikas.poki=e.bikas.poki||{},e.bikas.game=e.bikas.game||{};var n={},i=function(){return so.__string_rec(this,"")};function r(e,t){function n(){}n.prototype=e;var i=new n;for(var r in t)i[r]=t[r];return t.toString!==Object.prototype.toString&&(i.toString=t.toString),i}var a=function(e,t){this.r=new RegExp(e,t.split("u").join(""))};(n.EReg=a).__name__=["EReg"],a.prototype={r:null,match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m},matched:function(e){if(null!=this.r.m&&0<=e&&e<this.r.m.length)return this.r.m[e];throw new ao("EReg::matched")},__class__:a};var s=function(){};(n.HxOverrides=s).__name__=["HxOverrides"],s.dateStr=function(e){var t=e.getMonth()+1,n=e.getDate(),i=e.getHours(),r=e.getMinutes(),a=e.getSeconds();return e.getFullYear()+"-"+(t<10?"0"+t:""+t)+"-"+(n<10?"0"+n:""+n)+" "+(i<10?"0"+i:""+i)+":"+(r<10?"0"+r:""+r)+":"+(a<10?"0"+a:""+a)},s.strDate=function(e){switch(e.length){case 8:var t=e.split(":"),n=new Date;return n.setTime(0),n.setUTCHours(t[0]),n.setUTCMinutes(t[1]),n.setUTCSeconds(t[2]),n;case 10:var i=e.split("-");return new Date(i[0],i[1]-1,i[2],0,0,0);case 19:var r=e.split(" "),a=r[0].split("-"),s=r[1].split(":");return new Date(a[0],a[1]-1,a[2],s[0],s[1],s[2]);default:throw new ao("Invalid date format : "+e)}},s.cca=function(e,t){var n=e.charCodeAt(t);return n!=n?oo.get_undefined():n},s.substr=function(e,t,n){if(null==n)n=e.length;else if(n<0){if(0!=t)return"";n=e.length+n}return e.substr(t,n)},s.remove=function(e,t){var n=e.indexOf(t);return-1!=n&&(e.splice(n,1),!0)},s.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var l=e.Main=function(){};(n.Main=l).__name__=["Main"],l.main=function(){l.game_was_already_launched?Nl.trace("warning: game was already launched",{fileName:"Main.hx",lineNumber:32,className:"Main",methodName:"main"}):(l.game_was_already_launched=!0,Nl.trace=so.__trace,el.initializeAndStart(1554813245e3))},Math.__name__=["Math"];var o=e.Perf=function(e,t){null==t&&(t=0),null==e&&(e="TR"),this._perfObj=lo.get_window().performance,null!=_.field(this._perfObj,"memory")&&(this._memoryObj=_.field(this._perfObj,"memory")),this._memCheck=null!=this._perfObj&&null!=this._memoryObj&&0<this._memoryObj.totalJSHeapSize,this._pos=e,this._offset=t,this._init(),this._createFpsDom(),this._createMsDom(),this._memCheck&&this._createMemoryDom(),null!=Cc(kc=lo.get_window(),kc.requestAnimationFrame)?this.RAF=Cc(kc=lo.get_window(),kc.requestAnimationFrame):null!=window.mozRequestAnimationFrame?this.RAF=window.mozRequestAnimationFrame:null!=window.webkitRequestAnimationFrame?this.RAF=window.webkitRequestAnimationFrame:null!=window.msRequestAnimationFrame&&(this.RAF=window.msRequestAnimationFrame),null!=Cc(kc=lo.get_window(),kc.cancelAnimationFrame)?this.CAF=Cc(kc=lo.get_window(),kc.cancelAnimationFrame):null!=window.mozCancelAnimationFrame?this.CAF=window.mozCancelAnimationFrame:null!=window.webkitCancelAnimationFrame?this.CAF=window.webkitCancelAnimationFrame:null!=window.msCancelAnimationFrame&&(this.CAF=window.msCancelAnimationFrame),null!=this.RAF&&(this._raf=_.callMethod(lo.get_window(),this.RAF,[Cc(this,this._tick)]))};(n.Perf=o).__name__=["Perf"],o.prototype={fps:null,ms:null,memory:null,info:null,lowFps:null,avgFps:null,currentFps:null,currentMs:null,currentMem:null,_time:null,_startTime:null,_prevTime:null,_ticks:null,_fpsMin:null,_fpsMax:null,_memCheck:null,_pos:null,_offset:null,_measureCount:null,_totalFps:null,_perfObj:null,_memoryObj:null,_raf:null,RAF:null,CAF:null,_init:function(){this.currentFps=60,this.currentMs=0,this.currentMem="0",this.lowFps=60,this.avgFps=60,this._measureCount=0,this._totalFps=0,this._time=0,this._ticks=0,this._fpsMin=60,this._fpsMax=60,this._startTime=this._now(),this._prevTime=-o.MEASUREMENT_INTERVAL},_now:function(){return null!=this._perfObj&&null!=Cc(kc=this._perfObj,kc.now)?this._perfObj.now():(new Date).getTime()},_tick:function(e){var t=this._now();this._ticks++,null!=this._raf&&t>this._prevTime+o.MEASUREMENT_INTERVAL&&(this.currentMs=Math.round(t-this._startTime),this.ms.innerHTML="MS: "+this.currentMs,this.currentFps=Math.round(1e3*this._ticks/(t-this._prevTime)),0<this.currentFps&&e>o.DELAY_TIME&&(this._measureCount++,this._totalFps+=this.currentFps,this.lowFps=this._fpsMin=Math.min(this._fpsMin,this.currentFps),this._fpsMax=Math.max(this._fpsMax,this.currentFps),this.avgFps=Math.round(this._totalFps/this._measureCount)),this.fps.innerHTML="FPS: "+this.currentFps+" ("+this._fpsMin+"-"+this._fpsMax+")",30<=this.currentFps?this.fps.style.backgroundColor=o.FPS_BG_CLR:15<=this.currentFps?this.fps.style.backgroundColor=o.FPS_WARN_BG_CLR:this.fps.style.backgroundColor=o.FPS_PROB_BG_CLR,this._prevTime=t,this._ticks=0,this._memCheck&&(this.currentMem=this._getFormattedSize(this._memoryObj.usedJSHeapSize,2),this.memory.innerHTML="MEM: "+this.currentMem)),this._startTime=t,null!=this._raf&&(this._raf=_.callMethod(lo.get_window(),this.RAF,[Cc(this,this._tick)]))},_createDiv:function(e,t){null==t&&(t=0);var n=lo.get_document().createElement("div");switch(n.id=e,n.className=e,n.style.position="absolute",this._pos){case"BL":n.style.left=this._offset+"px",n.style.bottom=(this._memCheck?48:32)-t+"px";break;case"BR":n.style.right=this._offset+"px",n.style.bottom=(this._memCheck?48:32)-t+"px";break;case"TL":n.style.left=this._offset+"px",n.style.top=t+"px";break;case"TR":n.style.right=this._offset+"px",n.style.top=t+"px"}return n.style.width="80px",n.style.height="12px",n.style.lineHeight="12px",n.style.padding="2px",n.style.fontFamily=o.FONT_FAMILY,n.style.fontSize="9px",n.style.fontWeight="bold",n.style.textAlign="center",lo.get_document().body.appendChild(n),n},_createFpsDom:function(){this.fps=this._createDiv("fps"),this.fps.style.backgroundColor=o.FPS_BG_CLR,this.fps.style.zIndex="995",this.fps.style.color=o.FPS_TXT_CLR,this.fps.innerHTML="FPS: 0"},_createMsDom:function(){this.ms=this._createDiv("ms",16),this.ms.style.backgroundColor=o.MS_BG_CLR,this.ms.style.zIndex="996",this.ms.style.color=o.MS_TXT_CLR,this.ms.innerHTML="MS: 0"},_createMemoryDom:function(){this.memory=this._createDiv("memory",32),this.memory.style.backgroundColor=o.MEM_BG_CLR,this.memory.style.color=o.MEM_TXT_CLR,this.memory.style.zIndex="997",this.memory.innerHTML="MEM: 0"},_getFormattedSize:function(e,t){if(null==t&&(t=0),0==e)return"0";var n=Math.pow(10,t),i=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e*n/Math.pow(1024,i))/n+" "+["Bytes","KB","MB","GB","TB"][i]},addInfo:function(e){this.info=this._createDiv("info",this._memCheck?48:32),this.info.style.backgroundColor=o.INFO_BG_CLR,this.info.style.color=o.INFO_TXT_CLR,this.info.style.zIndex="998",this.info.innerHTML=e},clearInfo:function(){null!=this.info&&(lo.get_document().body.removeChild(this.info),this.info=null)},destroy:function(){this._cancelRAF(),this._perfObj=null,(this._memoryObj=null)!=this.fps&&(lo.get_document().body.removeChild(this.fps),this.fps=null),null!=this.ms&&(lo.get_document().body.removeChild(this.ms),this.ms=null),null!=this.memory&&(lo.get_document().body.removeChild(this.memory),this.memory=null),this.clearInfo(),this._init()},_cancelRAF:function(){_.callMethod(lo.get_window(),this.CAF,[this._raf]),this._raf=null},__class__:o};var _=function(){};(n.Reflect=_).__name__=["Reflect"],_.field=function(e,t){try{return e[t]}catch(e){return null}},_.setField=function(e,t,n){e[t]=n},_.getProperty=function(e,t){var n;return null==e?null:e.__properties__&&(n=e.__properties__["get_"+t])?e[n]():e[t]},_.setProperty=function(e,t,n){var i;e.__properties__&&(i=e.__properties__["set_"+t])?e[i](n):e[t]=n},_.callMethod=function(e,t,n){return t.apply(e,n)},_.fields=function(e){var t=[];if(null!=e){var n=Object.prototype.hasOwnProperty;for(var i in e)"__id__"!=i&&"hx__closures__"!=i&&n.call(e,i)&&t.push(i)}return t},_.isFunction=function(e){return"function"==typeof e&&!(so.isClass(e)||so.isEnum(e))},_.copy=function(e){for(var t={},n=0,i=_.fields(e);n<i.length;){var r=i[n];++n,_.setField(t,r,_.field(e,r))}return t};var p=function(){};(n.Std=p).__name__=["Std"],p.is=function(e,t){return so.__instanceof(e,t)},p.string=function(e){return so.__string_rec(e,"")},p.int=function(e){return 0|e},p.parseInt=function(e){var t=parseInt(e,10);return 0!=t||120!=s.cca(e,1)&&88!=s.cca(e,1)||(t=parseInt(e)),isNaN(t)?null:t},p.parseFloat=function(e){return parseFloat(e)};var u=function(){this.b=""};(n.StringBuf=u).__name__=["StringBuf"],u.prototype={b:null,add:function(e){this.b+=p.string(e)},addChar:function(e){this.b+=String.fromCharCode(e)},addSub:function(e,t,n){this.b+=s.substr(e,t,null==n?null:n)},toString:function(){return this.b},__class__:u};var h=function(){};(n.StringTools=h).__name__=["StringTools"],h.urlEncode=function(e){return encodeURIComponent(e)},h.isSpace=function(e,t){var n=s.cca(e,t);return 8<n&&n<14||32==n},h.ltrim=function(e){for(var t=e.length,n=0;n<t&&h.isSpace(e,n);)++n;return 0<n?s.substr(e,n,t-n):e},h.rtrim=function(e){for(var t=e.length,n=0;n<t&&h.isSpace(e,t-n-1);)++n;return 0<n?s.substr(e,0,t-n):e},h.trim=function(e){return h.ltrim(h.rtrim(e))},h.replace=function(e,t,n){return e.split(t).join(n)},h.hex=function(e,t){for(var n="";n="0123456789ABCDEF".charAt(15&e)+n,0<(e>>>=4););if(null!=t)for(;n.length<t;)n="0"+n;return n},h.fastCodeAt=function(e,t){return e.charCodeAt(t)},h.isEof=function(e){return e!=e};var c=n.ValueType={__ename__:["ValueType"],__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};c.TNull=["TNull",0],c.TNull.toString=i,(c.TNull.__enum__=c).TInt=["TInt",1],c.TInt.toString=i,(c.TInt.__enum__=c).TFloat=["TFloat",2],c.TFloat.toString=i,(c.TFloat.__enum__=c).TBool=["TBool",3],c.TBool.toString=i,(c.TBool.__enum__=c).TObject=["TObject",4],c.TObject.toString=i,(c.TObject.__enum__=c).TFunction=["TFunction",5],c.TFunction.toString=i,(c.TFunction.__enum__=c).TClass=function(e){var t=["TClass",6,e];return t.__enum__=c,t.toString=i,t},c.TEnum=function(e){var t=["TEnum",7,e];return t.__enum__=c,t.toString=i,t},c.TUnknown=["TUnknown",8],c.TUnknown.toString=i,(c.TUnknown.__enum__=c).__empty_constructs__=[c.TNull,c.TInt,c.TFloat,c.TBool,c.TObject,c.TFunction,c.TUnknown];var d=function(){};(n.Type=d).__name__=["Type"],d.getClass=function(e){return null==e?null:so.getClass(e)},d.getEnum=function(e){return null==e?null:e.__enum__},d.getClassName=function(e){var t=e.__name__;return null==t?null:t.join(".")},d.getEnumName=function(e){return e.__ename__.join(".")},d.resolveClass=function(e){var t=n[e];return null!=t&&so.isClass(t)?t:null},d.resolveEnum=function(e){var t=n[e];return null!=t&&so.isEnum(t)?t:null},d.createInstance=function(e,t){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);case 9:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]);case 10:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);case 11:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10]);case 12:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11]);case 13:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12]);case 14:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13]);default:throw new ao("Too many arguments")}},d.createEnum=function(e,t,n){var i=_.field(e,t);if(null==i)throw new ao("No such constructor "+t);if(_.isFunction(i)){if(null==n)throw new ao("Constructor "+t+" need parameters");return _.callMethod(e,i,n)}if(null!=n&&0!=n.length)throw new ao("Constructor "+t+" does not need parameters");return i},d.getInstanceFields=function(e){var t=[];for(var n in e.prototype)t.push(n);return s.remove(t,"__class__"),s.remove(t,"__properties__"),t},d.getEnumConstructs=function(e){return e.__constructs__.slice()},d.typeof=function(e){switch(typeof e){case"boolean":return c.TBool;case"function":return so.isClass(e)||so.isEnum(e)?c.TObject:c.TFunction;case"number":return Math.ceil(e)==e%2147483648?c.TInt:c.TFloat;case"object":if(null==e)return c.TNull;var t=e.__enum__;if(null!=t)return c.TEnum(t);var n=so.getClass(e);return null!=n?c.TClass(n):c.TObject;case"string":return c.TClass(String);case"undefined":return c.TNull;default:return c.TUnknown}},d.enumConstructor=function(e){return e[0]},d.enumIndex=function(e){return e[1]},d.allEnums=function(e){return e.__empty_constructs__};var m=function(e){this.nodeType=e,this.children=[],this.attributeMap=new Ll};(n.Xml=m).__name__=["Xml"],m.parse=function(e){return ql.parse(e)},m.createElement=function(e){var t=new m(m.Element);return t.set_nodeName(e),t},m.createPCData=function(e){var t=new m(m.PCData);return t.set_nodeValue(e),t},m.createCData=function(e){var t=new m(m.CData);return t.set_nodeValue(e),t},m.createComment=function(e){var t=new m(m.Comment);return t.set_nodeValue(e),t},m.createDocType=function(e){var t=new m(m.DocType);return t.set_nodeValue(e),t},m.createProcessingInstruction=function(e){var t=new m(m.ProcessingInstruction);return t.set_nodeValue(e),t},m.createDocument=function(){return new m(m.Document)},m.prototype={nodeType:null,nodeName:null,nodeValue:null,parent:null,children:null,attributeMap:null,get_nodeName:function(){if(this.nodeType!=m.Element)throw new ao("Bad node type, expected Element but found "+this.nodeType);return this.nodeName},set_nodeName:function(e){if(this.nodeType!=m.Element)throw new ao("Bad node type, expected Element but found "+this.nodeType);return this.nodeName=e},set_nodeValue:function(e){if(this.nodeType==m.Document||this.nodeType==m.Element)throw new ao("Bad node type, unexpected "+this.nodeType);return this.nodeValue=e},get:function(e){if(this.nodeType!=m.Element)throw new ao("Bad node type, expected Element but found "+this.nodeType);return this.attributeMap.get(e)},set:function(e,t){if(this.nodeType!=m.Element)throw new ao("Bad node type, expected Element but found "+this.nodeType);this.attributeMap.set(e,t)},exists:function(e){if(this.nodeType!=m.Element)throw new ao("Bad node type, expected Element but found "+this.nodeType);return this.attributeMap.exists(e)},elements:function(){this.ensureElementType();for(var e=[],t=0,n=this.children;t<n.length;){var i=n[t];++t,i.nodeType==m.Element&&e.push(i)}return s.iter(e)},addChild:function(e){this.ensureElementType(),null!=e.parent&&e.parent.removeChild(e),this.children.push(e),e.parent=this},removeChild:function(e){return this.ensureElementType(),!!s.remove(this.children,e)&&!(e.parent=null)},ensureElementType:function(){if(this.nodeType!=m.Document&&this.nodeType!=m.Element)throw new ao("Bad node type, expected Element or Document but found "+this.nodeType)},__class__:m,__properties__:{set_nodeValue:"set_nodeValue",set_nodeName:"set_nodeName",get_nodeName:"get_nodeName"}};var f=function(){this.scale_y=1,this.scale_x=1,this.rotation=0,this.position_y=0,this.position_x=0};(n["bikas.animation.SpriteState"]=f).__name__=["bikas","animation","SpriteState"],f.prototype={position_x:null,position_y:null,rotation:null,scale_x:null,scale_y:null,__class__:f};var g=function(){this.states=[]};(n["bikas.animation.AnimationKeyframe"]=g).__name__=["bikas","animation","AnimationKeyframe"],g.prototype={states:null,__class__:g};var v=function(){};(n["bikas.animation.SpriteDescription"]=v).__name__=["bikas","animation","SpriteDescription"],v.prototype={name:null,registration_x:null,registration_y:null,__class__:v};var b=function(){};(n["bikas.animation.StaticSprite"]=b).__name__=["bikas","animation","StaticSprite"],b.prototype={description:null,state:null,__class__:b};var y=function(){this.keyframes=[],this.animated_sprites=[],this.static_sprites=[]};(n["bikas.animation.Animation"]=y).__name__=["bikas","animation","Animation"],y.prototype={static_sprites:null,animated_sprites:null,keyframe_indexes:null,keyframes:null,__class__:y};var x=function(){};(n["bikas.animation.AnimationSerializer"]=x).__name__=["bikas","animation","AnimationSerializer"],x.describeData=function(){re.pushClass,re.pushBool,re.pushInt,re.pushDouble;var e=re.pushDouble,t=re.pushString,n=(re.pushEnum,re.pushArray),i=re.pushInstance,r=(re.pushIgnore,re.createSerialData()),a=re.pushClass(r,f,null);return e(a,"position_x"),e(a,"position_y"),e(a,"rotation"),e(a,"scale_x"),e(a,"scale_y"),n(a=re.pushClass(r,g,null),"states",[12]),t(a=re.pushClass(r,v,null),"name"),e(a,"registration_x"),e(a,"registration_y"),i(a=re.pushClass(r,b,null),"description"),i(a,"state"),n(a=re.pushClass(r,y,null),"static_sprites",[12]),n(a,"animated_sprites",[12]),n(a,"keyframe_indexes",[3]),n(a,"keyframes",[12]),re.validateSerialData(r),re.createTypeTableForSerialData(r),r},x.serialize=function(e,t){return re.serialize(e,t,[12])},x.unserialize=function(e,t){var n=re.unserialize(e,t);return null==n?(Nl.trace("load failed",{fileName:"AnimationSerializer.hx",lineNumber:71,className:"bikas.animation.AnimationSerializer",methodName:"unserialize"}),null):so.__cast(n,y)};var z=function(){this.animated_sprites=[],this.static_sprites=[]};(n["bikas.animation.SpriteAnimation"]=z).__name__=["bikas","animation","SpriteAnimation"],z.prototype={source:null,static_sprites:null,animated_sprites:null,current_frame:null,__class__:z};var w=function(e,t,n){null==n&&(n=1),this.start=e,this.end=t,this.additional_coeff=n};(n["bikas.animation.AnimationRange"]=w).__name__=["bikas","animation","AnimationRange"],w.prototype={start:null,end:null,additional_coeff:null,__class__:w};var k=function(){};(n["bikas.animation.PixiAnimationDo"]=k).__name__=["bikas","animation","PixiAnimationDo"],k.createSpriteAnimation=function(e,t,n){if(t.length!=n.length)return Nl.trace("error: name and texture length mismatch",{fileName:"PixiAnimationDo.hx",lineNumber:26,className:"bikas.animation.PixiAnimationDo",methodName:"createSpriteAnimation"}),null;for(var i=new z,r=function(e,t,n){var i=qa.createGroup(),r=qa.createSprite(t);i.add(r),null==t&&Nl.trace("warning: missing texture for "+e.name,{fileName:"PixiAnimationDo.hx",lineNumber:37,className:"bikas.animation.PixiAnimationDo",methodName:"createSpriteAnimation"});var a=e.registration_x/r.width,s=e.registration_y/r.height;return r.anchor.set(a,s),null!=n&&(i.position.x=n.position_x,i.position.y=n.position_y,i.rotation=n.rotation,i.scale.x=n.scale_x,i.scale.y=n.scale_y),i},a=i.current_frame=0,s=(i.source=e).static_sprites.length;a<s;){var l=a++,o=e.static_sprites[l],_=o.description,p=o.state,u=r(_,n[t.indexOf(_.name)],p);i.static_sprites.push(u)}for(var h=0,c=e.animated_sprites.length;h<c;){var d=h++,m=e.animated_sprites[d],f=n[t.indexOf(m.name)],g=null;0<e.keyframe_indexes.length&&(g=e.keyframes[e.keyframe_indexes[0]].states[d]);var v=r(m,f,g);i.animated_sprites.push(v)}return i},k.addToContainer=function(e,t){for(var n=0,i=t.static_sprites;n<i.length;){var r=i[n];++n,e.add(r)}for(var a=0,s=t.animated_sprites;a<s.length;){var l=s[a];++a,e.add(l)}},k.gotoFrame=function(e,t){for(var n=e.source,i=-1,r=-1,a=1,s=n.keyframe_indexes.length;a<s;){var l=a++;if(t>=n.keyframe_indexes[l-1]&&t<=n.keyframe_indexes[l]){i=l-1,r=l;break}}if(-1!=i||-1!=r){for(var o=n.keyframes[i],_=n.keyframes[r],p=n.keyframe_indexes[i],u=(t-p)/(n.keyframe_indexes[r]-p),h=0,c=o.states.length;h<c;){var d=h++,m=o.states[d],f=_.states[d],g=e.animated_sprites[d];g.position.x=va.linear(m.position_x,f.position_x,u),g.position.y=va.linear(m.position_y,f.position_y,u);var v=.017453292519943*va.linear(m.rotation,f.rotation,u);g.rotation!=v&&(g.rotation=v);var b=va.linear(m.scale_x,f.scale_x,u),y=va.linear(m.scale_y,f.scale_y,u);g.scale.x!=b&&(g.scale.x=b),g.scale.y!=y&&(g.scale.y=y)}e.current_frame=t}else Nl.trace("error: invalid frame or keyframes",{fileName:"PixiAnimationDo.hx",lineNumber:96,className:"bikas.animation.PixiAnimationDo",methodName:"gotoFrame"})},k.play=function(e,t){var n=e.source.keyframe_indexes[e.source.keyframe_indexes.length-1],i=k.getNextFrame(1,n,e.current_frame+t);k.gotoFrame(e,i)},k.playRange=function(e,t,n){var i=e.current_frame+n*t.additional_coeff;k.gotoFrame(e,k.getNextFrame(t.start,t.end,i))},k.playRangeOnce=function(e,t,n,i){null==i&&(i=!0);var r=t.start,a=t.end,s=1,l=!1;if(e.current_frame<r||e.current_frame>a)s=r;else if(s=e.current_frame+n*t.additional_coeff,i)Math.round(1e3*s)/1e3>=a&&(s=a,l=!0);else{a<=s&&(l=!0);var o=e.source.keyframe_indexes[e.source.keyframe_indexes.length-1];s=k.getNextFrame(1,o,s)}return k.gotoFrame(e,s),!!l},k.playRangeBackwardsOnce=function(e,t,n,i){null==i&&(i=!0);var r=t.start,a=t.end,s=1,l=!1;if(e.current_frame<r||e.current_frame>a)s=a;else if(s=e.current_frame-n*t.additional_coeff,i)Math.round(1e3*s)/1e3<=r&&(s=r,l=!0);else{s<=r&&(l=!0);var o=e.source.keyframe_indexes[e.source.keyframe_indexes.length-1];s=k.getNextFrame(1,o,s)}return k.gotoFrame(e,s),!!l},k.getNextFrame=function(e,t,n){if(n<=t&&e<=n)return n;if(t==e)return n;var i=t-e;return n-Math.floor((n-e)/i)*i},k.getTotalFrames=function(e){var t=e.keyframe_indexes[0];return k.getLastFrame(e)-t+1},k.getLastFrame=function(e){return e.keyframe_indexes[e.keyframe_indexes.length-1]},k.getRelativeRangeFrames=function(e,t){return t.start-e.current_frame},k.findSpriteByName=function(e,t){for(var n=e.source.static_sprites,i=0,r=n.length;i<r;){var a=i++;if(n[a].description.name==t)return e.static_sprites[a]}for(var s=e.source.animated_sprites,l=0,o=s.length;l<o;){var _=l++;if(s[_].name==t)return e.animated_sprites[_]}return null};var S=function(){};(n["bikas.assets.BitmapDataSource"]=S).__name__=["bikas","assets","BitmapDataSource"],S.prototype={bitmap_data:null,center_point:null,original_width:null,original_height:null,__class__:S};var C=function(){};(n["bikas.assets.BitmapDataAnimationSource"]=C).__name__=["bikas","assets","BitmapDataAnimationSource"],C.prototype={sources:null,__class__:C};var N=function(){};(n["bikas.assets.BitmapContainer"]=N).__name__=["bikas","assets","BitmapContainer"],N.prototype={source:null,container:null,bitmap:null,__class__:N};var P=function(){};(n["bikas.assets.PhaserAssetsDo"]=P).__name__=["bikas","assets","PhaserAssetsDo"],P.init=function(){var e=new hs($s.game);Va.drawRectangle(e,new na(-25,25,25,25),1,0,1,!0,16711680,1),(S.placeholder=new S).center_point=new ea(25,25),S.placeholder.original_width=25,S.placeholder.original_height=25},P.retrieveBitmapData=function(e,t){var n=t.get(e);return null!=n?n:S.placeholder},P.createBitmapDataSource=function(e){var t=new S;return t.bitmap_data=e,t.center_point=new ea(Math.round(e.width/2),Math.round(e.height/2)),t.original_width=e.width,t.original_height=e.height,t};var M=function(){};(n["bikas.bfanimation.BFAFrameData"]=M).__name__=["bikas","bfanimation","BFAFrameData"],M.prototype={name:null,texture:null,x:null,y:null,anchor_x:null,anchor_y:null,__class__:M};var I=function(){this.frames=[]};(n["bikas.bfanimation.BFAnimationData"]=I).__name__=["bikas","bfanimation","BFAnimationData"],I.prototype={name:null,type:null,frames:null,__class__:I};var T=function(){this.current_frame_time=0,this.frame_time_coeff=1,this.current_frame=0,this.group=null};(n["bikas.bfanimation.BFAnimation"]=T).__name__=["bikas","bfanimation","BFAnimation"],T.prototype={data:null,group:null,sprite:null,current_frame:null,frame_time_coeff:null,current_frame_time:null,__class__:T};var A=function(){};(n["bikas.bfanimation.BFAnimationDo"]=A).__name__=["bikas","bfanimation","BFAnimationDo"],A.createAnimationDatasFromXml=function(e,t){for(var n=[],i=m.parse(e).elements();i.hasNext();){var r=i.next();if("BFAnimationContainer"==r.get_nodeName())for(var a=r.elements();a.hasNext();){var s=a.next();if("Animation"==s.get_nodeName()){var l=new I;l.name=s.get("name"),l.type=s.get("type"),n.push(l);for(var o=s.elements();o.hasNext();){var _=o.next(),u=new M;u.name=_.get("name"),u.x=p.parseFloat(_.get("x")),u.y=p.parseFloat(_.get("y")),u.texture=t(u.name),null==u.texture?Nl.trace("warning: couldn't find texture "+u.name,{fileName:"BFAnimationDo.hx",lineNumber:31,className:"bikas.bfanimation.BFAnimationDo",methodName:"createAnimationDatasFromXml"}):(u.anchor_x=u.x/u.texture.width,u.anchor_y=u.y/u.texture.height),l.frames.push(u)}}}}return n},A.findAnimation=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.name==t)return i}return null},A.translateAnimationData=function(e,t,n){for(var i=0,r=e.frames;i<r.length;){var a=r[i];++i,a.x+=t,a.y+=n,null!=a.texture&&(a.anchor_x=a.x/a.texture.width,a.anchor_y=a.y/a.texture.height)}},A.createAnimationUsingSprite=function(e,t,n){if(null==n&&(n=1),null==e)return Nl.trace("warning: data == null",{fileName:"BFAnimationDo.hx",lineNumber:73,className:"bikas.bfanimation.BFAnimationDo",methodName:"createAnimationUsingSprite"}),null;if(0==e.frames.length)return Nl.trace("warning: no frames in data",{fileName:"BFAnimationDo.hx",lineNumber:77,className:"bikas.bfanimation.BFAnimationDo",methodName:"createAnimationUsingSprite"}),null;var i=new T;return i.data=e,i.sprite=t,i.frame_time_coeff=n,i.current_frame=-1,A.gotoFrame(i,0),i},A.createNewAnimation=function(e,t,n){if(null==n&&(n=1),null==e)return Nl.trace("warning: data == null",{fileName:"BFAnimationDo.hx",lineNumber:91,className:"bikas.bfanimation.BFAnimationDo",methodName:"createNewAnimation"}),null;if(0==e.frames.length)return Nl.trace("warning: no frames in data",{fileName:"BFAnimationDo.hx",lineNumber:95,className:"bikas.bfanimation.BFAnimationDo",methodName:"createNewAnimation"}),null;var i=new T;return i.data=e,i.sprite=qa.createSprite(e.frames[0].texture,0,0),t&&(i.group=qa.createGroup(),i.group.add(i.sprite)),i.frame_time_coeff=n,i.current_frame=-1,A.gotoFrame(i,0),i},A.replaceAnimationData=function(e,t){null==t&&Nl.trace("warning: data == null",{fileName:"BFAnimationDo.hx",lineNumber:113,className:"bikas.bfanimation.BFAnimationDo",methodName:"replaceAnimationData"}),0!=t.frames.length?(e.data=t,e.current_frame=-1,A.gotoFrame(e,0)):Nl.trace("warning: no frames in data",{fileName:"BFAnimationDo.hx",lineNumber:116,className:"bikas.bfanimation.BFAnimationDo",methodName:"replaceAnimationData"})},A.destroyAnimation=function(e,t){null==t&&(t=!1),e.data=null,t&&e.sprite.destroy(!0),null!=e.group&&e.group.destroy(!0),e.group=null,e.sprite=null},A.gotoFrame=function(e,t){if(t<e.data.frames.length&&0<=t){if(t!=e.current_frame){var n=e.data.frames[t];e.sprite.setTexture(n.texture),e.sprite.anchor.x=n.anchor_x,e.sprite.anchor.y=n.anchor_y,e.current_frame=t}}else Nl.trace("warning: frame is out of bounds",{fileName:"BFAnimationDo.hx",lineNumber:151,className:"bikas.bfanimation.BFAnimationDo",methodName:"gotoFrame"})},A.nextFrameFullStep=function(e){var t=e.current_frame+1;t>=e.data.frames.length&&(t=0),A.gotoFrame(e,t)},A.previousFrameFullStep=function(e){var t=e.current_frame-1;t<=e.data.frames.length&&(t=e.data.frames.length-1),A.gotoFrame(e,t)},A.nextFrameStep=function(e,t){if(null==e.data)return Nl.trace("warning: anim.data == null",{fileName:"BFAnimationDo.hx",lineNumber:176,className:"bikas.bfanimation.BFAnimationDo",methodName:"nextFrameStep"}),!1;if(e.current_frame_time+=t*e.frame_time_coeff,1<=e.current_frame_time){var n=e.current_frame_time%1,i=Math.floor(e.current_frame_time);e.current_frame_time=n;var r=e.current_frame+i;return A.gotoFrame(e,r%e.data.frames.length),r>=e.data.frames.length}return!1},A.previousFrameStep=function(e,t){if(null==e.data)return Nl.trace("warning: anim.data == null",{fileName:"BFAnimationDo.hx",lineNumber:200,className:"bikas.bfanimation.BFAnimationDo",methodName:"previousFrameStep"}),!1;if(e.current_frame_time+=t*e.frame_time_coeff,1<=e.current_frame_time){var n=e.current_frame_time%1,i=Math.floor(e.current_frame_time);e.current_frame_time=n;for(var r=e.current_frame-i;r<0;){if(0==e.data.frames.length){Nl.trace("warning: anim.data.frames.length == 0",{fileName:"BFAnimationDo.hx",lineNumber:211,className:"bikas.bfanimation.BFAnimationDo",methodName:"previousFrameStep"});break}r+=e.data.frames.length}return A.gotoFrame(e,r%e.data.frames.length),!0}return!1};var D=function(){this.radius_threshold=100,this.current_angle_speed=Math.PI/180,this.current_angle_goal=0};(n["bikas.bugs.Fly"]=D).__name__=["bikas","bugs","Fly"],D.prototype={position:null,angle:null,speed:null,center:null,random_angle_speed:null,random_angle_goal:null,current_angle_goal:null,current_angle_speed:null,radius_threshold:null,__class__:D};var E=function(){};(n["bikas.bugs.FlyDo"]=E).__name__=["bikas","bugs","FlyDo"],E.create=function(e,t,n,i,r,a,s){var l=new D;return l.position=ma.copyPoint(e),l.center=t,l.speed=n,l.angle=i,l.random_angle_goal=a,l.random_angle_speed=r,l.current_angle_goal=ma.getRandomSign()*ma.getRandomBetween(l.random_angle_goal.min,l.random_angle_goal.max),l.radius_threshold=s,l.current_angle_speed=ma.getRandomSign()*ma.getRandomBetween(l.random_angle_speed.min,l.random_angle_speed.max),l},E.update=function(e,t){if(e.current_angle_goal-=Math.abs(e.current_angle_speed*t),e.angle+=e.current_angle_speed*t,e.position.x+=Math.cos(e.angle)*e.speed*t,e.position.y+=Math.sin(e.angle)*e.speed*t,e.current_angle_goal<0)if(ma.distanceBetweenPoints(e.position,e.center)>=e.radius_threshold){var n=za.angle(za.subtract(e.center,e.position));e.current_angle_goal=ma.angleDifferenceRad(n,e.angle),e.current_angle_speed=ma.getRandomBetween(e.random_angle_speed.min,e.random_angle_speed.max),e.current_angle_goal<0&&(e.current_angle_speed*=-1)}else e.current_angle_goal=ma.getRandomSign()*ma.getRandomBetween(e.random_angle_goal.min,e.random_angle_goal.max),e.current_angle_speed=ma.getRandomSign()*ma.getRandomBetween(e.random_angle_speed.min,e.random_angle_speed.max)};var O=function(){};(n["bikas.editor.ColorScheme"]=O).__name__=["bikas","editor","ColorScheme"];var B=function(){};(n["bikas.editor.SerialSave"]=B).__name__=["bikas","editor","SerialSave"],B.prototype={name:null,created_time_stamp:null,save_time_stamp:null,__class__:B};var L=function(){this.bitmap_animation=null,this.bitmap=null};(n["bikas.editor.BitmapImage"]=L).__name__=["bikas","editor","BitmapImage"],L.prototype={source_name:null,bitmap_data_source:null,bitmap:null,offset_x:null,offset_y:null,rotation:null,bitmap_animation:null,__class__:L};var j=function(){};(n["bikas.editor.BitmapImageContainer"]=j).__name__=["bikas","editor","BitmapImageContainer"],j.prototype={images:null,container:null,__class__:j};var F=function(){};(n["bikas.editor.BitmapAnimation"]=F).__name__=["bikas","editor","BitmapAnimation"],F.prototype={source:null,frame:null,__class__:F};var R=n["bikas.editor.NapeBodyType"]={__ename__:["bikas","editor","NapeBodyType"],__constructs__:["NONE","STATIC","DYNAMIC"]};R.NONE=["NONE",0],R.NONE.toString=i,(R.NONE.__enum__=R).STATIC=["STATIC",1],R.STATIC.toString=i,(R.STATIC.__enum__=R).DYNAMIC=["DYNAMIC",2],R.DYNAMIC.toString=i,(R.DYNAMIC.__enum__=R).__empty_constructs__=[R.NONE,R.STATIC,R.DYNAMIC];var G=n["bikas.editor.CircleDrawType"]={__ename__:["bikas","editor","CircleDrawType"],__constructs__:["DEFAULT","TRANSPARENT"]};G.DEFAULT=["DEFAULT",0],G.DEFAULT.toString=i,(G.DEFAULT.__enum__=G).TRANSPARENT=["TRANSPARENT",1],G.TRANSPARENT.toString=i,(G.TRANSPARENT.__enum__=G).__empty_constructs__=[G.DEFAULT,G.TRANSPARENT];var Z=function(){this.graphics=null};(n["bikas.editor.Circle"]=Z).__name__=["bikas","editor","Circle"],Z.prototype={body_type:null,editable:null,fill_draw:null,fill_draw_type:null,radius:null,graphics:null,__class__:Z};var U=n["bikas.editor.PolygonDrawType"]={__ename__:["bikas","editor","PolygonDrawType"],__constructs__:["DEFAULT","TEXTURE"]};U.DEFAULT=["DEFAULT",0],U.DEFAULT.toString=i,(U.DEFAULT.__enum__=U).TEXTURE=["TEXTURE",1],U.TEXTURE.toString=i,(U.TEXTURE.__enum__=U).__empty_constructs__=[U.DEFAULT,U.TEXTURE];var V=function(){this.graphics=null,this.texture=null,this.convex_cached=!1,this.convex_cache_points=null};(n["bikas.editor.Polygon"]=V).__name__=["bikas","editor","Polygon"],V.prototype={body_type:null,points:null,convex_cache_points:null,convex_cached:null,editable:null,draw_type:null,color:null,alpha:null,texture:null,graphics:null,__class__:V};var q=function(){this.data=null,this.use_sutherland_hodgman=!1,this.bitmaps_updated=!0,this.line_source_name_cache="",this.fill_source_name_cache="",this.line_source_name="",this.fill_source_name=""};(n["bikas.editor.PolygonTexture"]=q).__name__=["bikas","editor","PolygonTexture"],q.prototype={fill_source_name:null,line_source_name:null,fill_source_name_cache:null,line_source_name_cache:null,bitmaps_updated:null,use_sutherland_hodgman:null,data:null,__class__:q};var W=function(){};(n["bikas.editor.GUID"]=W).__name__=["bikas","editor","GUID"],W.init=function(){var e=(new Date).getTime();W.guid_prefix=W.toBase62(e-141912e7)+"-",W.guid_postfix=0},W.toBase62=function(e){for(var t=[];0<e;)t.push("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(p.int(e%62))),e=Math.floor(e/62);return t.reverse(),t.join("")},W.generate=function(){return W.guid_prefix+W.guid_postfix++};var X=function(){};(n["bikas.engine.SerialStageHeader"]=X).__name__=["bikas","engine","SerialStageHeader"],X.prototype={save:null,group:null,__class__:X};var H=function(){};(n["bikas.engine.SerialLibraryHeader"]=H).__name__=["bikas","engine","SerialLibraryHeader"],H.prototype={save:null,group:null,__class__:H};var Y=function(){};(n["bikas.engine.Display"]=Y).__name__=["bikas","engine","Display"],Y.prototype={sprite:null,depth_cache:null,__class__:Y};var J=function(){};(n["bikas.engine.Group"]=J).__name__=["bikas","engine","Group"],J.prototype={container:null,entities:null,__class__:J};var K=function(){};(n["bikas.engine.Prefab"]=K).__name__=["bikas","engine","Prefab"],K.prototype={prefab_name:null,prefab_link_name:null,__class__:K};var Q=function(){};(n["bikas.engine.PrefabLink"]=Q).__name__=["bikas","engine","PrefabLink"],Q.prototype={guid:null,prefab_entity:null,__class__:Q};var $=function(){};(n["bikas.engine.InnerPrefabCount"]=$).__name__=["bikas","engine","InnerPrefabCount"],$.prototype={entity:null,count:null,__class__:$};var ee=function(){this.constraint=null,this.offset_rotated=null,this.offset=null,this.body=null,this.prefab_link=null,this.prefab=null,this.polygon=null,this.circle=null,this.bitmap_images=null,this.group=null,this.container_link=null,this.parent=null};(n["bikas.engine.Entity"]=ee).__name__=["bikas","engine","Entity"],ee.prototype={guid:null,name:null,display:null,position:null,transform:null,parent:null,container_link:null,group:null,bitmap_images:null,circle:null,polygon:null,prefab:null,prefab_link:null,body:null,offset:null,offset_rotated:null,constraint:null,__class__:ee};var te=function(){};(n["bikas.engine.Engine"]=te).__name__=["bikas","engine","Engine"],te.prototype={engine_serial_data:null,__class__:te};var ne=function(){this.debug_drawn=!1};(n["bikas.engine.World"]=ne).__name__=["bikas","engine","World"],ne.prototype={space:null,debug_drawn:null,__class__:ne};var ie=function(){};(n["bikas.engine.EngineDo"]=ie).__name__=["bikas","engine","EngineDo"],ie.createEngine=function(){var e=new te;return e.engine_serial_data=le.createEngineSerialData(!0),W.init(),e},ie.overloadLibrary=function(e,t,n,i){null!=n&&(Nl.trace("warning: current_library_group should be null",{fileName:"EngineDo.hx",lineNumber:105,className:"bikas.engine.EngineDo",methodName:"overloadLibrary"}),ie.destroyEntityIncludingChildren(n));for(var r=t.group.entities,a=null,s=a=function(e,t){if(null!=t.group)for(var n=0,s=t.group.entities;n<s.length;){var l=s[n];++n,a(t,l)}if(t.parent=e,null!=t.bitmap_images)for(var o=0,_=t.bitmap_images.images;o<_.length;){var p=_[o];++o,p.bitmap_data_source=P.retrieveBitmapData(p.source_name,i)}if(null!=t.prefab_link)for(var u=0;u<r.length;){var h=r[u];if(++u,t.prefab_link.guid==h.guid){t.prefab_link.prefab_entity=h;break}}},l=0;l<r.length;){var o=r[l];++l,s(t,o)}for(var _=ie.getSortedPrefabsByLayersOfInnerPrefabs(r),p=0;p<_.length;){var u=_[p];++p,ie.flatten(e,u)}return t},ie.overloadStage=function(e,t,n,i,r){if(null!=n)return Nl.trace("warning: current_stage_group should be null",{fileName:"EngineDo.hx",lineNumber:150,className:"bikas.engine.EngineDo",methodName:"overloadStage"}),ie.destroyEntityIncludingChildren(n),null;null!=i&&i.group.entities;var a=null,s=null,l=s=function(e,t){if(null!=e.group)for(var n=0,i=e.group.entities;n<i.length;){var r=i[n];++n,s(r,t)}if(null!=e.bitmap_images)for(var a=0,l=e.bitmap_images.images;a<l.length;){var o=l[a];++a,o.bitmap_data_source=P.retrieveBitmapData(o.source_name,t)}};return(a=function(e){if(null!=e.group)for(var t=0,n=e.group.entities;t<n.length;){var i=n[t];++t,a(i),i.parent=e}})(t),ie.linkPrefabLinks(t,i),l(t,r),t},ie.flattenAndAddStage=function(e,t,n){ie.flatten(e,t),ie.flattenPolygonEntities(t);var i=null,r=i=function(e,t,n){if(null!=e.group)for(var r=0,a=e.group.entities;r<a.length;){var s=a[r];++r,t=i(s,t,n)}else e.container_link=n,e.display.depth_cache=t,++t;return t};t.container_link=n,r(t,0,t.group.container),oe.addEntityIncludingChildren(t)},ie.getSortedPrefabsByLayersOfInnerPrefabs=function(e){for(var t=null,n=t=function(e,n){var i=n;if(null!=e.group)for(var r=0,a=0,s=e.group.entities;a<s.length;){var l=s[a];++a,null!=l.group&&i<(r=t(l,n))&&(i=r),null!=l.prefab_link&&(r=n+1,null!=l.prefab_link.prefab_entity&&(r=t(l.prefab_link.prefab_entity,r)),i<r&&(i=r))}return i},i=[],r=0;r<e.length;){var a=e[r];++r;var s=new $;s.count=n(a,0),s.entity=a,i.push(s)}i.sort(function(e,t){return e.count>t.count?1:e.count<t.count?-1:0});for(var l=[],o=0;o<i.length;){var _=i[o];++o,l.push(_.entity)}return l},ie.linkPrefabLinks=function(e,t){var n=t.group.entities,i=null;(i=function(e){if(null!=e.group)for(var t=0,r=e.group.entities;t<r.length;){var a=r[t];++t,i(a)}if(null!=n&&null!=e.prefab_link&&null==e.prefab_link.prefab_entity)for(var s=0;s<n.length;){var l=n[s];if(++s,e.prefab_link.guid==l.guid){e.prefab_link.prefab_entity=l;break}}})(e)},ie.createAndSetDefaultComponents=function(e){e.guid=W.generate(),e.name="Entity",e.transform.rotation=0,e.transform.scale_x=1,e.transform.scale_y=1,e.display.sprite=null,e.display.depth_cache=-1,e.parent=null,e.container_link=null},ie.createDefaultGroupComponent=function(){var e=new J;return e.entities=[],e.container=null,e},ie.createDefaultEntity=function(){if(0<ie.destroyed_entity_list.length){var e=ie.destroyed_entity_list.pop();return ie.createAndSetDefaultComponents(e),e}var t=new ee;return t.position=new ea(0,0),t.transform=new sa,t.display=new Y,ie.createAndSetDefaultComponents(t),t},ie.createDefaultEntity_old=function(){var e=new ee;return ie.createAndSetDefaultComponents(e),e},ie.createGroupEntity=function(){var e=ie.createDefaultEntity();return e.name="Group",e.group=ie.createDefaultGroupComponent(),e},ie.createAndAddBitmap=function(e,t,n){null==e.bitmap_images&&(e.bitmap_images=ie.createDefaultBitmapImageContainerComponent());var i=new L;return(i=ie.createDefaultBitmapImageComponent()).source_name=t,i.bitmap_data_source=n,e.bitmap_images.images.push(i),i},ie.createDefaultBitmapImageContainerComponent=function(){var e=new j;return e.container=null,e.images=[],e},ie.createDefaultBitmapImageComponent=function(){var e=new L;return e.bitmap=null,e.offset_x=0,e.offset_y=0,e.rotation=0,e.bitmap_animation=null,e},ie.createDefaultCircleComponent=function(){var e=new Z;return e.body_type=R.NONE,e.editable=!0,e.fill_draw=!0,e.fill_draw_type=G.DEFAULT,e.radius=25,e},ie.createDefaultPolygonComponent=function(){var e=new V;return e.body_type=R.NONE,e.convex_cache_points=null,e.convex_cached=!1,e.editable=!0,e.draw_type=U.DEFAULT,e.alpha=1,e.color=9546397,e.texture=null,e.points=null,e},ie.destroyEntityIncludingChildren=function(e){if(""!=e.guid){if(e.guid="",null!=e.parent&&s.remove(e.parent.group.entities,e),null!=e.polygon){if(null!=e.polygon.points){for(var t=0,n=e.polygon.points;t<n.length;){var i=n[t];++t,ea.destroy(i)}e.polygon.points=null}null!=e.polygon.graphics&&Nl.trace("warning: not supported",{fileName:"EngineDo.hx",lineNumber:466,className:"bikas.engine.EngineDo",methodName:"destroyEntityIncludingChildren"})}if(null!=e.circle&&null!=e.circle.graphics&&Nl.trace("warning: not supported",{fileName:"EngineDo.hx",lineNumber:474,className:"bikas.engine.EngineDo",methodName:"destroyEntityIncludingChildren"}),e.parent=null,(e.container_link=null)!=e.group)for(;0<e.group.entities.length;)ie.destroyEntityIncludingChildren(e.group.entities[0]);if(null!=e.bitmap_images){for(var r=0,a=e.bitmap_images.images;r<a.length;){var l=a[r];++r,null!=l.bitmap&&l.bitmap.destroy(!0),l.bitmap=null,l.bitmap_animation=null,l.bitmap_data_source=null}null!=e.bitmap_images.container&&e.bitmap_images.container.destroy(!0),e.bitmap_images=null}null!=e.offset&&(e.offset=null),null!=e.offset_rotated&&(e.offset_rotated=null),null!=e.body&&e.body.get_shapes().clear(),e.body=null,e.constraint=null,e.display.depth_cache=-1,null!=e.display.sprite&&(null!=e.display.sprite.parent&&e.display.sprite.parent.removeChild(e.display.sprite),e.display.sprite.destroy(!0),e.display.sprite=null),null!=e.group&&null!=e.group.container&&e.group.container.destroy(!0),e.group=null,e.bitmap_images=null,e.circle=null,e.polygon=null,e.prefab=null,$r.validate_reusable_objects&&-1!=ie.destroyed_entity_list.indexOf(e)?Nl.trace("warning: object is already added to destroyed list",{fileName:"EngineDo.hx",lineNumber:538,className:"bikas.engine.EngineDo",methodName:"destroyEntityIncludingChildren"}):ie.destroyed_entity_list.push(e)}else Nl.trace("warning: entity "+e.name+" is already destroyed or guid == ''",{fileName:"EngineDo.hx",lineNumber:443,className:"bikas.engine.EngineDo",methodName:"destroyEntityIncludingChildren"})},ie.flatten=function(e,t){if(null!=t.prefab_link)if(null==t.prefab_link.prefab_entity)Nl.trace("warning: prefab_entity is null for "+t.name,{fileName:"EngineDo.hx",lineNumber:555,className:"bikas.engine.EngineDo",methodName:"flatten"});else{var n=t.prefab_link.prefab_entity;t.prefab_link=null;for(var i=[],r=0,a=n.group.entities;r<a.length;){var s=a[r];++r;var l=ie.copyEntity(s,e,!0);l.parent=t,i.push(l)}t.group=new J,t.group.entities=i,t.prefab=new K,t.prefab.prefab_name=n.name,t.prefab.prefab_link_name=t.name}if(null!=t.group){for(var o=0,_=t.group.entities;o<_.length;){var p=_[o];++o,ga.applyTransform(p.position,p.transform,t.position,t.transform),ie.flatten(e,p)}t.position.x=0,t.position.y=0,t.transform.scale_x=1,t.transform.scale_y=1,t.transform.rotation=0}},ie.flattenPolygonEntities=function(e){if(null!=e.polygon){for(var t=new ea,n=e.transform.rotation,i=e.transform.rotation=0,r=e.polygon.points;i<r.length;){var a=r[i];++i,ga.applyTransformToPoint(a,t,e.transform)}if(null!=e.polygon.convex_cache_points)for(var s=0,l=e.polygon.convex_cache_points;s<l.length;){var o=l[s];++s;for(var _=0;_<o.length;){var p=o[_];++_,ga.applyTransformToPoint(p,t,e.transform)}}e.transform.scale_x=1,e.transform.scale_y=1,e.transform.rotation=n}if(null!=e.group)for(var u=0,h=e.group.entities;u<h.length;){var c=h[u];++u,ie.flattenPolygonEntities(c)}},ie.copyValue=function(e,t,n,i,r){var a=n;if(null!=a)if(11==r[0]){var l=so.__cast(n,Array),o=null;if(null==i)o=[];else for(o=so.__cast(i,Array);o.length>l.length;)o.pop();var u=r.slice();u.shift();for(var h=0,c=l.length;h<c;){var m=h++;m>=o.length?(a=ie.copyValue(e,t,l[m],null,u),o.push(a)):(a=ie.copyValue(e,t,l[m],o[m],u),o[m]=a)}a=o}else if(12==r[0]){for(var f=null,g=0,v=e.classes;g<v.length;){var b=v[g];if(++g,p.is(n,b.unserial_type)){f=b;break}}if(null==f)return Nl.trace("warning: couldn't find type for "+p.string(n),{fileName:"EngineDo.hx",lineNumber:681,className:"bikas.engine.EngineDo",methodName:"copyValue"}),null;var y=f.unserial_type,x=i;null==x&&(x=null!=f.init_func?f.init_func():d.createInstance(y,[])),y==L?so.__cast(x,L).bitmap_data_source=so.__cast(n,L).bitmap_data_source:y==Q?(so.__cast(x,Q).guid=so.__cast(n,Q).guid,so.__cast(x,Q).prefab_entity=so.__cast(n,Q).prefab_entity):y==K&&(so.__cast(x,K).prefab_link_name=so.__cast(n,K).prefab_link_name,so.__cast(x,K).prefab_name=so.__cast(n,K).prefab_name);var z,w,k=f.fields.slice();if(t&&y==ee)for(var S=0;S<k.length;){var C=k[S];if(++S,"guid"==C.field_name){s.remove(k,C);break}}for(var N=0;N<k.length;){var P=k[N];++N,z=_.field(n,P.field_name),w=_.field(x,P.field_name),_.setField(x,P.field_name,ie.copyValue(e,t,z,w,P.value_type_flags))}a=x}else if(128==r[0]){var M=so.__cast(i,ea);null==M&&(M=new ea(0,0)),M.x=so.__cast(n,ea).x,M.y=so.__cast(n,ea).y,a=M}else if(129==r[0]){var I=so.__cast(i,sa);null==I&&(I=new sa);var T=so.__cast(n,sa);I.scale_x=T.scale_x,I.scale_y=T.scale_y,I.rotation=T.rotation,a=I}return a},ie.resolveParentReferences=function(e){if(null!=e.group)for(var t=0,n=e.group.entities;t<n.length;){var i=n[t];++t,ie.resolveParentReferences(i),i.parent=e}},ie.copyEntity=function(e,t,n){var i=so.__cast(ie.copyValue(t,n,e,null,[12]),ee);return ie.resolveParentReferences(i),i.parent=e.parent,i},ie.createBodiesForEntities=function(e,t,n,i){if(null!=e.group)for(var r=0,a=e.group.entities;r<a.length;){var s=a[r];if(++r,!ie.createBodiesForEntities(s,t,n,i))return!1}var l=R.NONE;if(null!=e.polygon&&e.polygon.body_type!=R.NONE&&(l=e.polygon.body_type),null!=e.circle&&e.circle.body_type!=R.NONE){if(l!=R.NONE&&l!=e.circle.body_type)return Nl.trace("error: circle and polygon type mismatch",{fileName:"EngineDo.hx",lineNumber:790,className:"bikas.engine.EngineDo",methodName:"createBodiesForEntities"}),!1;l=e.circle.body_type}if(l!=R.NONE){var o=new C_;switch(e.body=o,t.push(e),d.enumIndex(l)){case 1:o.set_type(M_.get_STATIC());break;case 2:o.set_type(M_.get_DYNAMIC())}if(null!=e.polygon)if(null==e.polygon.convex_cache_points)Nl.trace("warning: convex_cache_points == null (added basic box)",{fileName:"EngineDo.hx",lineNumber:811,className:"bikas.engine.EngineDo",methodName:"createBodiesForEntities"}),o.get_shapes().add(new V_(V_.box(10,10),n,i));else if(0==e.polygon.convex_cache_points.length)Nl.trace("warning: no cached convexes in polygon (added basic box)",{fileName:"EngineDo.hx",lineNumber:815,className:"bikas.engine.EngineDo",methodName:"createBodiesForEntities"}),o.get_shapes().add(new V_(V_.box(10,10),n,i));else for(var _=0,p=e.polygon.convex_cache_points;_<p.length;){var u=p[_];++_,ie.addConvexPolygonToShapeList(o.get_shapes(),u)}if(null!=e.circle){if(e.circle.radius<=0)return Nl.trace("error: circle radius is 0 or less",{fileName:"EngineDo.hx",lineNumber:837,className:"bikas.engine.EngineDo",methodName:"createBodiesForEntities"}),!1;o.get_shapes().add(new R_(Math.abs(e.circle.radius)))}ie.fixBodyIfEmpty(o);var h=e.transform.scale_x,c=e.transform.scale_y;if(1!=h||1!=c){null!=e.circle&&h!=c&&(Nl.trace("warning: circle has different scale x and y",{fileName:"EngineDo.hx",lineNumber:853,className:"bikas.engine.EngineDo",methodName:"createBodiesForEntities"}),c=h);for(var m=o.get_shapes().iterator();m.hasNext();)m.next().scale(h,c)}var f=.017453292519943*e.transform.rotation;o.setShapeFilters(i),o.setShapeMaterials(n),o.get_shapes().empty()||o.align(),e.offset=new ea(o.get_position().get_x(),o.get_position().get_y()),e.offset_rotated=new ea(e.offset.x,e.offset.y),wa.rotate(e.offset_rotated,f),o.get_position().set_x(e.position.x+e.offset_rotated.x),o.get_position().set_y(e.position.y+e.offset_rotated.y),o.set_rotation(f),o.set_angularVel(0),o.get_velocity().setxy(0,0)}return!0},ie.setSpaceIncludingChildren=function(e,t){if(null!=e.group)for(var n=0,i=e.group.entities;n<i.length;){var r=i[n];++n,ie.setSpaceIncludingChildren(r,t)}null!=e.body&&e.body.get_space()!=t&&e.body.set_space(t)},ie.fixBodyIfEmpty=function(e){0==e.get_shapes().get_length()?(e.set_allowMovement(!1),e.set_allowRotation(!1)):(e.get_allowMovement()||e.set_allowMovement(!0),e.get_allowRotation()||e.set_allowRotation(!0))},ie.decomposePolygonToConvexes=function(e){if(e.length<3)return Nl.trace("warning: polygon has less than 3 points",{fileName:"EngineDo.hx",lineNumber:924,className:"bikas.engine.EngineDo",methodName:"decomposePolygonToConvexes"}),null;for(var t=new __,n=0;n<e.length;){var i=e[n];++n,t.push(y_.get(i.x,i.y))}if(!t.isSimple()){t.clear();for(var r=0,a=e.length;r<a;){for(var s=r++,l=!1,o=s+1,_=e.length;o<_;){var u=o++;if(ma.pointsEqual(e[s],e[u])){Nl.trace("warning: found point with same position: "+p.string(e[s]),{fileName:"EngineDo.hx",lineNumber:938,className:"bikas.engine.EngineDo",methodName:"decomposePolygonToConvexes"}),l=!0;break}}l||t.push(y_.get(e[s].x,e[s].y))}if(!t.isSimple())return Nl.trace("error: can't have self-intersecting polygon",{fileName:"EngineDo.hx",lineNumber:949,className:"bikas.engine.EngineDo",methodName:"decomposePolygonToConvexes"}),null}for(var h=t.convexDecomposition(),c=(h.get_length(),[]),d=h.iterator();d.hasNext();){var m=d.next();c.push([]);for(var f=m.iterator();f.hasNext();){var g=f.next();c[c.length-1].push(new ea(g.get_x(),g.get_y()))}}for(;!h.empty();)h.pop().dispose();return t.dispose(),c},ie.addConvexPolygonToShapeList=function(e,t){t.length<3&&Nl.trace("warning: polygon has less than 3 points",{fileName:"EngineDo.hx",lineNumber:975,className:"bikas.engine.EngineDo",methodName:"addConvexPolygonToShapeList"});for(var n=[],i=0;i<t.length;){var r=t[i];++i,n.push(y_.get(r.x,r.y))}e.add(new V_(n));for(var a=0;a<n.length;){var s=n[a];++a,s.dispose()}},ie.createWorld=function(e,t,n){var i=new ne;return i.space=new J_(e,Y_.get_DYNAMIC_AABB_TREE()),i.space.set_worldLinearDrag(t),i.space.set_worldAngularDrag(n),i};var re=function(){};(n["bikas.serialization.BefDo"]=re).__name__=["bikas","serialization","BefDo"],re.createSerialData=function(){var e=new zs;return e.classes=[],e.enum_cache=[],e},re.pushClass=function(e,t,n){var i=new se;return i.full_class_name=d.getClassName(t),i.serial_type=t,i.unserial_type=t,i.fields=[],i.ignore_fields=[],i.init_func=n,e.classes.push(i),i},re.pushField=function(e,t,n){var i=new ae;i.field_name=t,i.value_type_flags=[],i.value_type_flags.push(n),e.fields.push(i)},re.pushBool=function(e,t){re.pushField(e,t,0)},re.pushInt=function(e,t){re.pushField(e,t,3)},re.pushDouble=function(e,t){re.pushField(e,t,4)},re.pushString=function(e,t){re.pushField(e,t,5)},re.pushEnum=function(e,t){re.pushField(e,t,7)},re.pushArray=function(e,t,n){var i=new ae;i.field_name=t,i.value_type_flags=n.slice(),i.value_type_flags.unshift(11),e.fields.push(i)},re.pushInstance=function(e,t){re.pushField(e,t,12)},re.pushPoint=function(e,t){re.pushField(e,t,128)},re.pushTransform=function(e,t){re.pushField(e,t,129)},re.pushIgnore=function(e,t){e.ignore_fields.push(t)},re.validateSerialData=function(e){for(var t,n=!0,i=0,r=e.classes;i<r.length;){var a=r[i];++i,t=d.getInstanceFields(d.resolveClass(a.full_class_name));for(var s=0;s<t.length;){var l=t[s];++s;for(var o=!1,_=0,p=a.fields;_<p.length;){var u=p[_];if(++_,u.field_name==l){o=!0;break}}-1!=a.ignore_fields.indexOf(l)&&(o=!0),o||(Nl.trace("warning: field '"+l+"' in class '"+a.full_class_name+"' is not specified",{fileName:"BefDo.hx",lineNumber:117,className:"bikas.serialization.BefDo",methodName:"validateSerialData"}),n=!1)}for(var h=0;h<a.fields.length;)-1==t.indexOf(a.fields[h].field_name)&&(Nl.trace("warning: field '"+a.fields[h].field_name+"' does not exist in class '"+a.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:124,className:"bikas.serialization.BefDo",methodName:"validateSerialData"}),Nl.trace("auto-removing serial_field: '"+a.fields[h].field_name+"' from serial_class '"+a.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:125,className:"bikas.serialization.BefDo",methodName:"validateSerialData"}),a.fields.splice(h,1),--h,n=!1),++h;for(h=0;h<a.ignore_fields.length;)-1==t.indexOf(a.ignore_fields[h])&&Nl.trace("warning: ignore_field '"+a.ignore_fields[h]+"' does not exist in class '"+a.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:135,className:"bikas.serialization.BefDo",methodName:"validateSerialData"}),++h}return n},re.createTypeTableForSerialData=function(e){var t=re.createByteCursorForSerialization(32768);t.pos=0,re.setUInt16(t,e.classes.length);for(var n=0,i=e.classes;n<i.length;){var r=i[n];++n,re.setString(t,r.full_class_name),re.setUInt16(t,r.fields.length);for(var a=0,s=r.fields;a<s.length;){var l=s[a];++a,re.setString(t,l.field_name),re.setByte(t,l.value_type_flags.length);for(var o=0,_=l.value_type_flags;o<_.length;){var p=_[o];++o,re.setByte(t,p)}}}var u=t.pos,h=Il.alloc(u);h.blit(0,t.bytes,0,u),e.type_table=h},re.createByteCursorForSerialization=function(e){null==e&&(e=1048576);var t=new bs;return t.alloc_size=e,t.bytes=Il.alloc(e),t.pos=0,t},re.allocateMoreIfNeeded=function(e,t){if(e.pos+t>=e.bytes.length){var n=e.bytes.length+e.alloc_size;n<e.pos+t&&(n=e.pos+t);var i=Il.alloc(n);i.blit(0,e.bytes,0,e.bytes.length),e.bytes=i}},re.serialize=function(e,t,n,i){if(null==i&&(i=1048576),null==e.type_table)return Nl.trace("warning: type_table is not created for this serial_data",{fileName:"BefDo.hx",lineNumber:202,className:"bikas.serialization.BefDo",methodName:"serialize"}),null;var r=re.createByteCursorForSerialization(i);r.pos=0,re.setString(r,"BEF_v3"),re.setInt32(r,0),re.allocateMoreIfNeeded(r,e.type_table.length),r.bytes.blit(r.pos,e.type_table,0,e.type_table.length),r.pos+=e.type_table.length,e.enum_cache=[],re.setValue(r,e,t,n);var a=r.pos;r.pos=0,"BEF_v3"!=re.getString(r)&&Nl.trace("warning: something went wrong in serialization",{fileName:"BefDo.hx",lineNumber:224,className:"bikas.serialization.BefDo",methodName:"serialize"}),re.setInt32(r,a);var s=Il.alloc(a);return s.blit(0,r.bytes,0,a),s},re.unserialize=function(e,t){var n=new bs;n.bytes=t,n.pos=0;var i=re.getString(n);if("BEF_v3"!=i)return Nl.trace("error: wrong format name '"+i+"'",{fileName:"BefDo.hx",lineNumber:241,className:"bikas.serialization.BefDo",methodName:"unserialize"}),null;if(re.getInt32(n)!=t.length)return Nl.trace("error: invalid byte array",{fileName:"BefDo.hx",lineNumber:247,className:"bikas.serialization.BefDo",methodName:"unserialize"}),null;var r,a=re.getUInt16(n),s=new Ss;s.classes=[],s.enum_cache=[];for(var l=0,o=a;l<o;){l++,(r=new ks).fields=[],r.serial_class=null,r.full_class_name=re.getString(n);for(var _=re.getUInt16(n),p=0,u=e.classes;p<u.length;){var h=u[p];if(++p,h.full_class_name==r.full_class_name){r.serial_class=h;break}}null==r.serial_class&&Nl.trace("warning: couldn't find match in serial_data for '"+r.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:269,className:"bikas.serialization.BefDo",methodName:"unserialize"});for(var c=0,d=_;c<d;){c++;var m=new ws;m.field_name=re.getString(n),m.value_type_flags=[];for(var f=0,g=re.getByte(n);f<g;)f++,m.value_type_flags.push(re.getByte(n));if((m.serial_field=null)!=r.serial_class){for(var v=0,b=r.serial_class.fields;v<b.length;){var y=b[v];++v,y.field_name==m.field_name&&(m.serial_field=y)}if(null==m.serial_field)Nl.trace("warning: couldn't find serial_field for '"+m.field_name+"' in '"+r.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:287,className:"bikas.serialization.BefDo",methodName:"unserialize"});else if(m.value_type_flags.length!=m.serial_field.value_type_flags.length)Nl.trace("warning: field value type flag length mismatch of '"+m.field_name+"' in '"+r.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:290,className:"bikas.serialization.BefDo",methodName:"unserialize"}),m.serial_field=null;else for(var x=0,z=m.value_type_flags.length;x<z;){var w=x++;if(m.value_type_flags[w]!=m.serial_field.value_type_flags[w]&&(12!=m.value_type_flags[w]||128!=m.serial_field.value_type_flags[w]&&129!=m.serial_field.value_type_flags[w])){Nl.trace("warning: field value flag mismatch of '"+m.field_name+"' in '"+r.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:302,className:"bikas.serialization.BefDo",methodName:"unserialize"}),m.serial_field=null;break}}}r.fields.push(m)}s.classes.push(r)}var k=re.getByte(n);return re.getValue(n,s,k,null)},re.setByte=function(e,t){re.allocateMoreIfNeeded(e,1),e.bytes.set(e.pos,t),e.pos+=1},re.getByte=function(e){var t=e.bytes.get(e.pos);return e.pos+=1,t},re.setUInt16=function(e,t){re.allocateMoreIfNeeded(e,2),e.bytes.setUInt16(e.pos,t),e.pos+=2},re.getUInt16=function(e){var t=e.bytes.getUInt16(e.pos);return e.pos+=2,t},re.setInt32=function(e,t){re.allocateMoreIfNeeded(e,4);var n=e.bytes,i=e.pos;n.set(i,t),n.set(i+1,t>>8),n.set(i+2,t>>16),n.set(i+3,t>>>24),e.pos+=4},re.getInt32=function(e){var t=e.bytes,n=e.pos,i=t.get(n)|t.get(n+1)<<8|t.get(n+2)<<16|t.get(n+3)<<24;return e.pos+=4,i},re.setDouble=function(e,t){re.allocateMoreIfNeeded(e,8),e.bytes.setDouble(e.pos,t),e.pos+=8},re.getDouble=function(e){var t=e.bytes.getDouble(e.pos);return e.pos+=8,t},re.setString=function(e,t){var n=Il.ofString(t);re.setUInt16(e,n.length),re.allocateMoreIfNeeded(e,n.length),e.bytes.blit(e.pos,n,0,n.length),e.pos+=n.length},re.getString=function(e){var t=re.getUInt16(e),n=e.bytes.getString(e.pos,t);return e.pos+=t,n},re.setEnumValue=function(e,t,n){for(var i,r,a=d.getEnum(n),s=0,l=!1,o=0,_=t.enum_cache;o<_.length;){var p=_[o];if(++o,p.type==a){r=!(l=!0);for(var u=i=0,h=p.values;u<h.length;){var c=h[u];if(++u,c.value==n){r=!0;break}++i}if(r)re.setByte(e,8),re.setUInt16(e,s),re.setUInt16(e,i);else{var m=new ys;m.value=n,m.name=d.enumConstructor(n),p.values.push(m),re.setByte(e,9),re.setUInt16(e,s),re.setString(e,m.name)}break}++s}if(null==n)Nl.trace("warning: enum value is null",{fileName:"BefDo.hx",lineNumber:438,className:"bikas.serialization.BefDo",methodName:"setEnumValue"}),re.setByte(e,6);else if(!l){var f=new xs;f.type=a,f.name=d.getEnumName(a),f.values=[];var g=new ys;g.value=n,g.name=d.enumConstructor(n),f.values.push(g),re.setByte(e,10),re.setString(e,f.name),re.setString(e,g.name),t.enum_cache.push(f)}},re.getEnum=function(e,t,n){switch(t){case 8:var i=re.getUInt16(e),r=re.getUInt16(e),a=n.enum_cache[i],s=a.values[r];return null!=a.type&&null!=s.value?s.value:null;case 9:var l=re.getUInt16(e),o=re.getString(e),_=n.enum_cache[l],p=_.type,u=new ys;return _.values.push(u),u.name=o,null!=p?(u.value=d.createEnum(p,o),u.value):null;case 10:var h=re.getString(e),c=re.getString(e),m=d.resolveEnum(h),f=new xs;f.name=h,f.type=m,f.values=[];var g=new ys;return g.name=c,f.values.push(g),n.enum_cache.push(f),null!=m?(g.value=d.createEnum(m,c),g.value):null;default:return Nl.trace("error: unrecognized enum flag "+t,{fileName:"BefDo.hx",lineNumber:510,className:"bikas.serialization.BefDo",methodName:"getEnum"}),null}},re.setPoint=function(e,t){re.setDouble(e,t.x),re.setDouble(e,t.y)},re.getPoint=function(e,t){var n=re.getDouble(e),i=re.getDouble(e);if(null==t)return new ea(n,i);var r=so.__cast(t,ea);return r.x=n,r.y=i,r},re.setTransform=function(e,t){re.setDouble(e,t.scale_x),re.setDouble(e,t.scale_y),re.setDouble(e,t.rotation)},re.getTransform=function(e,t){var n=re.getDouble(e),i=re.getDouble(e),r=re.getDouble(e);if(null==t){var a=new sa;return a.scale_x=n,a.scale_y=i,a.rotation=r,a}var s=so.__cast(t,sa);return s.scale_x=n,s.scale_y=i,s.rotation=r,s},re.setValue=function(e,t,n,i){switch(i[0]){case 0:1==so.__cast(n,Ic)?re.setByte(e,1):re.setByte(e,2);break;case 3:re.setByte(e,3),re.setInt32(e,so.__cast(n,Nc));break;case 4:re.setByte(e,4),re.setDouble(e,so.__cast(n,Mc));break;case 5:re.setByte(e,5),re.setString(e,so.__cast(n,String));break;case 7:re.setEnumValue(e,t,n);break;case 11:if(null==n)re.setByte(e,6);else{re.setByte(e,11);var r=i.slice();r.shift(),re.setArray(e,t,r,so.__cast(n,Array))}break;case 12:if(null==n)re.setByte(e,6);else{for(var a=null,s=0,l=0,o=t.classes;l<o.length;){var _=o[l];if(++l,p.is(n,_.serial_type)){a=_;break}++s}null==a?(Nl.trace("warning: couldn't find SerialClass for '"+p.string(n)+"'",{fileName:"BefDo.hx",lineNumber:600,className:"bikas.serialization.BefDo",methodName:"setValue"}),re.setByte(e,6)):(re.setByte(e,12),re.setInstance(e,t,a,s,n))}break;case 128:null==n?re.setByte(e,6):(re.setByte(e,128),re.setPoint(e,so.__cast(n,ea)));break;case 129:null==n?re.setByte(e,6):(re.setByte(e,129),re.setTransform(e,so.__cast(n,sa)));break;default:Nl.trace("error: unrecognized flag '"+i[0]+"'",{fileName:"BefDo.hx",lineNumber:622,className:"bikas.serialization.BefDo",methodName:"setValue"})}},re.getValue=function(e,t,n,i){switch(n){case 1:return!0;case 2:return!1;case 3:return re.getInt32(e);case 4:return re.getDouble(e);case 5:return re.getString(e);case 6:return null;case 8:case 9:case 10:return re.getEnum(e,n,t);case 11:return re.getArray(e,t,i);case 12:return re.getInstance(e,t,i);case 128:return re.getPoint(e,i);case 129:return re.getTransform(e,i);default:return Nl.trace("error: unrecognized flag",{fileName:"BefDo.hx",lineNumber:651,className:"bikas.serialization.BefDo",methodName:"getValue"}),null}},re.setArray=function(e,t,n,i){var r=e.pos;re.setInt32(e,0),re.setByte(e,n[0]),re.setInt32(e,i.length);for(var a=0;a<i.length;){var s=i[a];++a,re.setValue(e,t,s,n)}var l=e.pos;e.pos=r,re.setInt32(e,l-e.pos-4),e.pos=l},re.getArray=function(e,t,n){re.getInt32(e),e.pos,re.getByte(e);var i,r,a=re.getInt32(e);if(null==n)n=[];else for(;n.length>a;)n.pop();for(var s=0,l=a;s<l;){var o=s++;i=re.getByte(e),o>=n.length?(r=re.getValue(e,t,i,null),n.push(r)):(r=re.getValue(e,t,i,n[o]),n[o]=r)}return n},re.setInstance=function(e,t,n,i,r){var a,s=n.fields,l=e.pos;re.setInt32(e,0),re.setUInt16(e,i);for(var o=0;o<s.length;){var p=s[o];++o,a=_.field(r,p.field_name),re.setValue(e,t,a,p.value_type_flags)}var u=e.pos;e.pos=l,re.setInt32(e,u-e.pos-4),e.pos=u},re.getInstance=function(e,t,n){var i,r,a,s=re.getInt32(e),l=e.pos,o=re.getUInt16(e),p=t.classes[o],u=p.serial_class;if(null==u)return Nl.trace("warning: skipping '"+p.full_class_name+"', because serial_class does not exist anymore",{fileName:"BefDo.hx",lineNumber:733,className:"bikas.serialization.BefDo",methodName:"getInstance"}),e.pos=l+s,null;null==n&&(n=null!=u.init_func?u.init_func():d.createInstance(u.unserial_type,[]));for(var h=0,c=p.fields;h<c.length;){var m=c[h];if(++h,a=re.getByte(e),i=m.field_name,null==m.serial_field)Nl.trace("warning: skipping '"+i+"' in '"+u.full_class_name+"', because serial_field does not exist or types don't match",{fileName:"BefDo.hx",lineNumber:752,className:"bikas.serialization.BefDo",methodName:"getInstance"}),re.getValue(e,t,a,null);else{switch(a){case 6:r=null;break;case 11:case 12:case 128:case 129:r=re.getValue(e,t,a,_.field(n,i));break;default:r=re.getValue(e,t,a,null)}_.setField(n,i,r)}}return n};var ae=function(){};(n["bikas.serialization.SerialField"]=ae).__name__=["bikas","serialization","SerialField"],ae.prototype={field_name:null,value_type_flags:null,__class__:ae};var se=function(){this.init_func=null};(n["bikas.serialization.SerialClass"]=se).__name__=["bikas","serialization","SerialClass"],se.prototype={full_class_name:null,serial_type:null,unserial_type:null,fields:null,ignore_fields:null,init_func:null,__class__:se};var le=function(){};(n["bikas.engine.EngineSerializer"]=le).__name__=["bikas","engine","EngineSerializer"],le.createEngineSerialData=function(e){null==e&&(e=!0);var t,n=re.createSerialData();return le.pushGlobalClasses(n),t=le.pushClass(n,ee,ie.createDefaultEntity),le.pushString(t,"guid"),le.pushString(t,"name"),le.pushInstance(t,"position"),le.pushInstance(t,"transform"),le.pushInstance(t,"display"),le.pushIgnore(t,"parent"),le.pushIgnore(t,"container_link"),le.pushInstance(t,"group"),le.pushInstance(t,"bitmap_images"),le.pushInstance(t,"circle"),le.pushInstance(t,"polygon"),le.pushInstance(t,"prefab"),le.pushInstance(t,"prefab_link"),le.pushIgnore(t,"body"),le.pushIgnore(t,"offset"),le.pushIgnore(t,"offset_rotated"),le.pushIgnore(t,"constraint"),t=le.pushClass(n,Y,null),le.pushIgnore(t,"sprite"),le.pushIgnore(t,"depth_cache"),t=le.pushClass(n,J,ie.createDefaultGroupComponent),le.pushArray(t,"entities",[12]),le.pushIgnore(t,"container"),t=le.pushClass(n,j,ie.createDefaultBitmapImageContainerComponent),le.pushArray(t,"images",[12]),le.pushIgnore(t,"container"),t=le.pushClass(n,L,ie.createDefaultBitmapImageComponent),le.pushString(t,"source_name"),le.pushIgnore(t,"bitmap_data_source"),le.pushIgnore(t,"bitmap"),le.pushDouble(t,"offset_x"),le.pushDouble(t,"offset_y"),le.pushDouble(t,"rotation"),le.pushInstance(t,"bitmap_animation"),t=le.pushClass(n,F,null),le.pushIgnore(t,"source"),le.pushInt(t,"frame"),t=le.pushClass(n,Z,ie.createDefaultCircleComponent),le.pushEnum(t,"body_type"),le.pushBool(t,"editable"),le.pushBool(t,"fill_draw"),le.pushEnum(t,"fill_draw_type"),le.pushDouble(t,"radius"),le.pushIgnore(t,"graphics"),t=le.pushClass(n,V,ie.createDefaultPolygonComponent),le.pushEnum(t,"body_type"),le.pushArray(t,"points",[12]),le.pushArray(t,"convex_cache_points",[11,12]),le.pushBool(t,"convex_cached"),le.pushIgnore(t,"editable"),le.pushEnum(t,"draw_type"),le.pushInt(t,"color"),le.pushDouble(t,"alpha"),le.pushInstance(t,"texture"),le.pushIgnore(t,"graphics"),t=le.pushClass(n,q,null),le.pushString(t,"fill_source_name"),le.pushString(t,"line_source_name"),le.pushIgnore(t,"fill_source_name_cache"),le.pushIgnore(t,"line_source_name_cache"),le.pushIgnore(t,"bitmaps_updated"),le.pushBool(t,"use_sutherland_hodgman"),le.pushIgnore(t,"data"),t=le.pushClass(n,K,null),le.pushIgnore(t,"prefab_name"),le.pushIgnore(t,"prefab_link_name"),t=le.pushClass(n,Q,null),le.pushString(t,"guid"),le.pushIgnore(t,"prefab_entity"),t=le.pushClass(n,B,null),le.pushString(t,"name"),le.pushDouble(t,"created_time_stamp"),le.pushDouble(t,"save_time_stamp"),t=le.pushClass(n,X,null),le.pushInstance(t,"save"),le.pushInstance(t,"group"),t=le.pushClass(n,H,null),le.pushInstance(t,"save"),le.pushInstance(t,"group"),e&&re.validateSerialData(n),re.createTypeTableForSerialData(n),n},le.pushGlobalClasses=function(e){var t=le.pushClass(e,ea,ea.createDefault);le.pushDouble(t,"x"),le.pushDouble(t,"y"),le.pushIgnore(t,"toString"),t=le.pushClass(e,sa),le.pushDouble(t,"scale_x"),le.pushDouble(t,"scale_y"),le.pushDouble(t,"rotation"),le.pushIgnore(t,"toString"),t=le.pushClass(e,na),le.pushDouble(t,"x"),le.pushDouble(t,"y"),le.pushDouble(t,"width"),le.pushDouble(t,"height"),le.pushIgnore(t,"toString")},le.unserializeStageEngine=function(e,t){var n=Kl.run(t);return le.unserializeStageEngineUncompressed(e,n)},le.unserializeLibraryEngine=function(e,t){var n=Kl.run(t);return le.unserializeLibraryEngineUncompressed(e,n)},le.unserializeStageEngineUncompressed=function(e,t){var n=re.unserialize(e,t);if(!p.is(n,X))return Nl.trace("error: wrong type, expected: "+p.string(X)+", got: "+p.string(n),{fileName:"EngineSerializer.hx",lineNumber:222,className:"bikas.engine.EngineSerializer",methodName:"unserializeStageEngineUncompressed"}),null;var i=so.__cast(n,X);return null==i.group?(Nl.trace("error: no stage group",{fileName:"EngineSerializer.hx",lineNumber:227,className:"bikas.engine.EngineSerializer",methodName:"unserializeStageEngineUncompressed"}),null):i},le.unserializeLibraryEngineUncompressed=function(e,t){var n=re.unserialize(e,t);if(!p.is(n,H))return Nl.trace("error: wrong type, expected: "+p.string(H)+", got: "+p.string(n),{fileName:"EngineSerializer.hx",lineNumber:236,className:"bikas.engine.EngineSerializer",methodName:"unserializeLibraryEngineUncompressed"}),null;var i=so.__cast(n,H);return null==i.group?(Nl.trace("error: no stage group",{fileName:"EngineSerializer.hx",lineNumber:241,className:"bikas.engine.EngineSerializer",methodName:"unserializeLibraryEngineUncompressed"}),null):i};var oe=function(){};(n["bikas.engine.EngineSystems"]=oe).__name__=["bikas","engine","EngineSystems"],oe.addEntity=function(e){null!=e.polygon&&de.refresh(e),null!=e.circle&&pe.refresh(e),null!=e.bitmap_images&&_e.add(e),ue.add(e),he.refresh(e),me.refresh(e)},oe.removeEntity=function(e){me.remove(e),ue.remove(e),null!=e.bitmap_images&&_e.remove(e),null!=e.circle&&pe.remove(e),null!=e.polygon&&de.remove(e)},oe.addEntityIncludingChildren=function(e){if(null!=e.group)for(var t=0,n=e.group.entities;t<n.length;){var i=n[t];++t,oe.addEntityIncludingChildren(i)}oe.addEntity(e)},oe.removeEntityIncludingChildren=function(e){if(oe.removeEntity(e),null!=e.group)for(var t=0,n=e.group.entities;t<n.length;){var i=n[t];++t,oe.removeEntityIncludingChildren(i)}},oe.refreshEntityIncludingChildren=function(e){Nl.trace("warning: not supported",{fileName:"EngineSystems.hx",lineNumber:76,className:"bikas.engine.EngineSystems",methodName:"refreshEntityIncludingChildren"})};var _e=function(){};(n["bikas.engine.BitmapImagesSystem"]=_e).__name__=["bikas","engine","BitmapImagesSystem"],_e.add=function(e){var t;2<=e.bitmap_images.images.length&&Nl.trace("warning: entity "+e.name+" has "+e.bitmap_images.images.length+" bitmap images, more than 1 sprite per entity is no longer supported!",{fileName:"EngineSystems.hx",lineNumber:116,className:"bikas.engine.BitmapImagesSystem",methodName:"add"});for(var n=0,i=e.bitmap_images.images;n<i.length;){var r=i[n];++n,t=r.bitmap_data_source,null==e.display.sprite&&(e.display.sprite=qa.createEmptySprite());var a=e.display.sprite;null==t.bitmap_data?Nl.trace("warning: source.bitmap_data == null (entity: "+e.name+", bitmap: "+r.source_name+")",{fileName:"EngineSystems.hx",lineNumber:134,className:"bikas.engine.BitmapImagesSystem",methodName:"add"}):(null==a.texture?a.texture=t.bitmap_data:a.setTexture(t.bitmap_data),a.anchor.x=(t.center_point.x-r.offset_x)/t.bitmap_data.width,a.anchor.y=(t.center_point.y-r.offset_y)/t.bitmap_data.height),0!=r.rotation&&Nl.trace("warning: image.rotation is not supported! (entity: "+e.name+", bitmap: "+r.source_name+", image.rotation: "+r.rotation+")",{fileName:"EngineSystems.hx",lineNumber:153,className:"bikas.engine.BitmapImagesSystem",methodName:"add"}),a.rotation=0;break}},_e.remove=function(e){};var pe=function(){};(n["bikas.engine.CircleFillDrawSystem"]=pe).__name__=["bikas","engine","CircleFillDrawSystem"],pe.remove=function(e){null!=e.circle&&null!=e.circle.graphics&&(e.circle.graphics.clear(),Nl.trace("warning: not supported",{fileName:"EngineSystems.hx",lineNumber:175,className:"bikas.engine.CircleFillDrawSystem",methodName:"remove"}))},pe.refresh=function(e){if(oe.debug_draw_polygons_and_circles){var t=1,n=e.circle.fill_draw_type;switch(d.enumIndex(n)){case 0:t=1;break;case 1:t=.5}var i=e.circle,r=null;null==i.graphics&&(r=i.graphics=qa.createGraphics(),Nl.trace("warning: not supported",{fileName:"EngineSystems.hx",lineNumber:194,className:"bikas.engine.CircleFillDrawSystem",methodName:"refresh"})),r.clear(),r.beginFill(9546397,t),r.lineStyle(1,1651777,t),r.drawCircle(0,0,2*i.radius),r.endFill()}};var ue=function(){};(n["bikas.engine.DisplayContainerSystem"]=ue).__name__=["bikas","engine","DisplayContainerSystem"],ue.add=function(e){e.display;var t=null;if(null!=(t=null!=e.group?e.group.container:e.display.sprite)){t.name="entity:"+e.name;var n=e.container_link;null!=n&&-1==n.children.indexOf(t)&&n.add(t)}},ue.remove=function(e){var t=e.container_link;null!=t&&(null!=e.group&&null!=e.group.container&&-1!=t.children.indexOf(e.group.container)&&t.remove(e.group.container),null!=e.display.sprite&&-1!=t.children.indexOf(e.display.sprite)&&t.remove(e.display.sprite))},ue.refresh=function(e){Nl.trace("warning: not supported",{fileName:"EngineSystems.hx",lineNumber:282,className:"bikas.engine.DisplayContainerSystem",methodName:"refresh"})};var he=function(){};(n["bikas.engine.DisplayPositionSystem"]=he).__name__=["bikas","engine","DisplayPositionSystem"],he.refresh=function(e){null!=e.group&&null!=e.group.container&&(e.group.container.x=e.position.x,e.group.container.y=e.position.y),null!=e.display.sprite&&(e.display.sprite.x=e.position.x,e.display.sprite.y=e.position.y)};var ce=function(){};(n["bikas.engine.NapeSystem"]=ce).__name__=["bikas","engine","NapeSystem"],ce.refresh=function(e){if(null==e.body.zpp_inner.component||!e.body.zpp_inner.component.sleeping){var t=e.offset,n=e.offset_rotated;n.x=t.x,n.y=t.y;var i=e.body.get_rotation(),r=Math.cos(i),a=Math.sin(i),s=r*n.x-a*n.y,l=a*n.x+r*n.y;n.x=s,n.y=l;var o=e.body.get_position().get_x();e.position.x=o-n.x;var _=e.body.get_position().get_y();if(e.position.y=_-n.y,null!=e.display.sprite){e.display.sprite.x=e.position.x,e.display.sprite.y=e.position.y;var p=e.body.get_rotation();e.display.sprite.rotation=ce.normalizeAngle(p)}}},ce.normalizeAngle=function(e){return(e=(e%Qr.PI2+Qr.PI2)%Qr.PI2)>Qr.PI&&(e-=Qr.PI2),e};var de=function(){};(n["bikas.engine.PolygonSystem"]=de).__name__=["bikas","engine","PolygonSystem"],de.remove=function(e){null!=e.polygon&&null!=e.polygon.graphics&&(e.polygon.graphics.clear(),Nl.trace("warning: not supported",{fileName:"EngineSystems.hx",lineNumber:359,className:"bikas.engine.PolygonSystem",methodName:"remove"}))},de.refresh=function(e){if(oe.debug_draw_polygons_and_circles){var t=e.polygon,n=t.draw_type;switch(d.enumIndex(n)){case 0:var i=null;null==t.graphics&&(i=t.graphics=qa.createGraphics(),Nl.trace("warning: not supported",{fileName:"EngineSystems.hx",lineNumber:396,className:"bikas.engine.PolygonSystem",methodName:"refresh"})),i.clear(),i.beginFill(9546397),i.lineStyle(1,1651777,1),i.moveTo(t.points[0].x,t.points[0].y);for(var r=1,a=t.points.length;r<a;){var s=r++;i.lineTo(t.points[s].x,t.points[s].y)}i.endFill()}}};var me=function(){};(n["bikas.engine.TransformSystem"]=me).__name__=["bikas","engine","TransformSystem"],me.refresh=function(e){var t=e.transform;if(null!=e.group&&null!=e.group.container){var n=e.group.container;n.scale.x=t.scale_x,n.scale.y=t.scale_y,n.rotation=.017453292519943*t.rotation}if(null!=e.display.sprite){var i=e.display.sprite;i.scale.x=t.scale_x,i.scale.y=t.scale_y,i.rotation=.017453292519943*t.rotation}},me.remove=function(e){if(null!=e.group){var t=e.group.container;null!=t&&(t.scale.x=1,t.scale.y=1,t.rotation=0)}if(null!=e.display.sprite){var n=e.display.sprite;n.scale.x=1,n.scale.y=1,n.rotation=0}};var fe=n["bikas.famobi.FamobiEventType"]={__ename__:["bikas","famobi","FamobiEventType"],__constructs__:["FamobiFail","FamobiRestart","FamobiStart","FamobiSuccess","FamobiLevelScore","FamobiTotalScore","FamobiLiveScore","FamobiTutorialCompleted","FamobiTutorialSkipped","FamobiVolumeChange"]};fe.FamobiFail=["FamobiFail",0],fe.FamobiFail.toString=i,(fe.FamobiFail.__enum__=fe).FamobiRestart=["FamobiRestart",1],fe.FamobiRestart.toString=i,(fe.FamobiRestart.__enum__=fe).FamobiStart=["FamobiStart",2],fe.FamobiStart.toString=i,(fe.FamobiStart.__enum__=fe).FamobiSuccess=["FamobiSuccess",3],fe.FamobiSuccess.toString=i,(fe.FamobiSuccess.__enum__=fe).FamobiLevelScore=["FamobiLevelScore",4],fe.FamobiLevelScore.toString=i,(fe.FamobiLevelScore.__enum__=fe).FamobiTotalScore=["FamobiTotalScore",5],fe.FamobiTotalScore.toString=i,(fe.FamobiTotalScore.__enum__=fe).FamobiLiveScore=["FamobiLiveScore",6],fe.FamobiLiveScore.toString=i,(fe.FamobiLiveScore.__enum__=fe).FamobiTutorialCompleted=["FamobiTutorialCompleted",7],fe.FamobiTutorialCompleted.toString=i,(fe.FamobiTutorialCompleted.__enum__=fe).FamobiTutorialSkipped=["FamobiTutorialSkipped",8],fe.FamobiTutorialSkipped.toString=i,(fe.FamobiTutorialSkipped.__enum__=fe).FamobiVolumeChange=["FamobiVolumeChange",9],fe.FamobiVolumeChange.toString=i,(fe.FamobiVolumeChange.__enum__=fe).__empty_constructs__=[fe.FamobiFail,fe.FamobiRestart,fe.FamobiStart,fe.FamobiSuccess,fe.FamobiLevelScore,fe.FamobiTotalScore,fe.FamobiLiveScore,fe.FamobiTutorialCompleted,fe.FamobiTutorialSkipped,fe.FamobiVolumeChange];var ge=function(){};(n["bikas.famobi.FamobiEvent"]=ge).__name__=["bikas","famobi","FamobiEvent"],ge.prototype={type:null,name:null,data:null,__class__:ge};var ve=function(){};(n["bikas.famobi.FamobiWrapperDo"]=ve).__name__=["bikas","famobi","FamobiWrapperDo"],ve.setupFamobi=function(){var e=lo.get_window();Nl.trace("init famobi",{fileName:"FamobiWrapperDo.hx",lineNumber:62,className:"bikas.famobi.FamobiWrapperDo",methodName:"setupFamobi"}),null==e.famobi?(e.famobi={},e.famobi.localStorage=lo.get_window().localStorage,e.famobi.sessionStorage=lo.get_window().sessionStorage):(null==e.famobi.localStorage&&(e.famobi.localStorage=lo.get_window().localStorage),null==e.famobi.sessionStorage&&(e.famobi.sessionStorage=lo.get_window().sessionStorage)),e.famobi_onPauseRequested=function(e){e||(e="api"),ve.famobi_pauseReasons.indexOf(e)<0&&ve.famobi_pauseReasons.push(e),window.famobi_pauseReasons=ve.famobi_pauseReasons,ve.famobi_paused=!0,Nl.trace("pause received",{fileName:"FamobiWrapperDo.hx",lineNumber:80,className:"bikas.famobi.FamobiWrapperDo",methodName:"setupFamobi"})},e.famobi_onResumeRequested=function(e){e||(e="api");var t=ve.famobi_pauseReasons.indexOf(e);t>=0&&ve.famobi_pauseReasons.splice(t,1),window.famobi_pauseReasons=ve.famobi_pauseReasons,0==ve.famobi_pauseReasons.length&&(ve.famobi_paused=!1,Nl.trace("resume received",{fileName:"FamobiWrapperDo.hx",lineNumber:86,className:"bikas.famobi.FamobiWrapperDo",methodName:"setupFamobi"}))}},ve.sendFamobiEvent=function(e,t,n,i,r){null==r&&(r=0),null==i&&(i=0),null==n&&(n=""),null==t&&(t="");var a=new ge,s=lo.get_window().famobi_analytics;if(null!=s){switch(d.enumIndex(e)){case 0:a.name=s.EVENT_LEVELFAIL,a.data={levelName:t,reason:n};break;case 1:return a.name=s.EVENT_LEVELRESTART,void(a.data={levelName:t});case 2:return a.name=s.EVENT_LEVELSTART,void(a.data={levelName:t});case 3:a.name=s.EVENT_LEVELSUCCESS,a.data={levelName:t};break;case 4:a.name=s.EVENT_LEVELSCORE,a.data={levelName:t,levelScore:i};break;case 5:a.name=s.EVENT_TOTALSCORE,a.data={totalScore:i};break;case 6:a.name=s.EVENT_LIVESCORE,a.data={liveScore:i};break;case 7:a.name=s.EVENT_TUTORIALCOMPLETED,a.data={};break;case 8:a.name=s.EVENT_TUTORIALSKIPPED,a.data={};break;case 9:a.name=s.EVENT_VOLUMECHANGE,a.data={bgmVolume:i,sfxVolume:r}}Nl.trace("send event, name: "+p.string(a.name)+", data: "+p.string(a.data),{fileName:"FamobiWrapperDo.hx",lineNumber:158,className:"bikas.famobi.FamobiWrapperDo",methodName:"sendFamobiEvent"}),s.trackEvent(a.name,a.data).then(function(){Nl.trace("event "+p.string(a.name)+" resolved",{fileName:"FamobiWrapperDo.hx",lineNumber:169,className:"bikas.famobi.FamobiWrapperDo",methodName:"sendFamobiEvent"})})}},ve.trackFail=function(e,t){ve.sendFamobiEvent(fe.FamobiFail,e,t)},ve.trackStart=function(e){ve.sendFamobiEvent(fe.FamobiStart,e)},ve.trackRestart=function(e){ve.sendFamobiEvent(fe.FamobiRestart,e)},ve.trackSuccess=function(e){ve.sendFamobiEvent(fe.FamobiSuccess,e)},ve.trackLevelScore=function(e,t){ve.sendFamobiEvent(fe.FamobiLevelScore,e,"",t)},ve.trackTotalScore=function(e){ve.sendFamobiEvent(fe.FamobiTotalScore,"","",e)},ve.trackTutorialCompleted=function(){ve.sendFamobiEvent(fe.FamobiTutorialCompleted)},ve.trackVolumeEvent=function(e,t){var n;n=e?1:0;var i;i=t?1:0,ve.sendFamobiEvent(fe.FamobiVolumeChange,"","",n,i)},ve.showAd=function(){var e=lo.get_window();null!=e.famobi&&(Nl.trace("show ad",{fileName:"FamobiWrapperDo.hx",lineNumber:237,className:"bikas.famobi.FamobiWrapperDo",methodName:"showAd"}),e.famobi.showAd(function(){Nl.trace("ad callback",{fileName:"FamobiWrapperDo.hx",lineNumber:241,className:"bikas.famobi.FamobiWrapperDo",methodName:"showAd"})}))},ve.saveToStorage=function(e,t){var n=lo.get_window();return null!=n.famobi&&(n.famobi.localStorage.setItem(e,t),!0)},ve.loadFromStorage=function(e){var t=lo.get_window();return null!=t.famobi?t.famobi.localStorage.getItem(e):null},ve.clearStorage=function(){var e=lo.get_window();return null!=e.famobi&&(e.famobi.localStorage.clear(),!0)};var be=n["bikas.game.AbilityAnimationState"]={__ename__:["bikas","game","AbilityAnimationState"],__constructs__:["None","JuctPicked","TransitioningToUI","RollingDice","ButtonMode"]};be.None=["None",0],be.None.toString=i,(be.None.__enum__=be).JuctPicked=["JuctPicked",1],be.JuctPicked.toString=i,(be.JuctPicked.__enum__=be).TransitioningToUI=["TransitioningToUI",2],be.TransitioningToUI.toString=i,(be.TransitioningToUI.__enum__=be).RollingDice=["RollingDice",3],be.RollingDice.toString=i,(be.RollingDice.__enum__=be).ButtonMode=["ButtonMode",4],be.ButtonMode.toString=i,(be.ButtonMode.__enum__=be).__empty_constructs__=[be.None,be.JuctPicked,be.TransitioningToUI,be.RollingDice,be.ButtonMode];var ye=n["bikas.game.AbilityType"]={__ename__:["bikas","game","AbilityType"],__constructs__:["None","Bomb","Dynamite","Armor","Nitro","Magnet"]};ye.None=["None",0],ye.None.toString=i,(ye.None.__enum__=ye).Bomb=["Bomb",1],ye.Bomb.toString=i,(ye.Bomb.__enum__=ye).Dynamite=["Dynamite",2],ye.Dynamite.toString=i,(ye.Dynamite.__enum__=ye).Armor=["Armor",3],ye.Armor.toString=i,(ye.Armor.__enum__=ye).Nitro=["Nitro",4],ye.Nitro.toString=i,(ye.Nitro.__enum__=ye).Magnet=["Magnet",5],ye.Magnet.toString=i,(ye.Magnet.__enum__=ye).__empty_constructs__=[ye.None,ye.Bomb,ye.Dynamite,ye.Armor,ye.Nitro,ye.Magnet];var xe=function(){this.use_ability_click=!1,this.instantly_receive_ability=!1,this.dice_roll_scaled_up=!1,this.current_shuffle_time=0,this.current_transition_time=0,this.menu_position=new ea,this.start_position=new ea,this.old_clicked_container=null,this.old_containers=[],this.old_icons=[],this.icon=null,this.container=null,this.state=be.None,this.type=ye.None};(n["bikas.game.AbilityButton"]=xe).__name__=["bikas","game","AbilityButton"],xe.prototype={type:null,state:null,container:null,icon:null,old_icons:null,old_containers:null,old_clicked_container:null,keyboard_shortcut_display:null,start_position:null,menu_position:null,start_scale:null,menu_scale:null,radius:null,current_transition_time:null,current_shuffle_time:null,dice_roll_scaled_up:null,dice_roll_frames:null,dice_roll_frame_count:null,dice_roll_start_frame:null,dice_roll_final_index:null,parent_cache_x:null,parent_cache_y:null,instantly_receive_ability:null,use_ability_click:null,__class__:xe};var ze=function(){};(n["bikas.game.AbilityButtonDo"]=ze).__name__=["bikas","game","AbilityButtonDo"],ze.pickItem=function(e,t,n,i,r){e.type=ye.None,e.state=be.TransitioningToUI,e.instantly_receive_ability=r,null!=e.icon&&(e.old_icons.push(e.icon),e.old_containers.push(e.container),e.icon=null,e.container=null),e.icon=A.createNewAnimation(Gs.animation_power_icons,!1),e.container=qa.createGroup(),i.add(e.container),e.radius=e.icon.sprite.width/2*1.2,e.start_position.x=t.x,e.start_position.y=t.y,e.start_scale=n.x/2,e.container.position.x=e.start_position.x,e.container.position.y=e.start_position.y,e.container.scale.x=e.start_scale,e.container.scale.y=e.start_scale,e.menu_position.x=0,e.menu_position.y=0,e.menu_scale=1,e.current_transition_time=0,e.current_shuffle_time=0,e.keyboard_shortcut_display=hr.createKeyboardShortcutDisplay("(ENTER)",2,24)},ze.destroy=function(e){null!=e.icon&&(e.old_icons.push(e.icon),e.icon=null),null!=e.container&&(e.old_containers.push(e.container),e.container=null);for(var t=0,n=e.old_icons;t<n.length;){var i=n[t];++t,i.sprite.destroy(!0),A.destroyAnimation(i)}for(var r=0,a=e.old_containers;r<a.length;){var s=a[r];++r,s.destroy(!0)}e.old_icons=null,e.old_containers=null,e.start_position=null,e.start_scale=null,e.menu_position=null,e.menu_scale=null},ze.useAbility=function(e,t,n,i,r,a){var s=e.ability_button;Ae.useCurrentAbility(e.car,e,e.abilities,t,n,i,r,a),s.state=be.None,s.old_clicked_container=s.container,ze.pushToOld(s)},ze.pushToOld=function(e){e.old_containers.push(e.container),e.old_icons.push(e.icon),e.icon=null,e.container=null},ze.updateAbilityItem=function(e,t,n,i,r,a,s,l,o){var _=e.ability_button,p=e.abilities;if(_.state==be.TransitioningToUI){null==_.icon.sprite.parent&&(_.container.add(_.icon.sprite),_.container.add(_.keyboard_shortcut_display.container)),_.current_transition_time+=l;var u=_.current_transition_time/Te.transition_time;1<u&&(u=1),_.instantly_receive_ability&&(u=1),_.container.x=va.smoothEnd(_.start_position.x,_.menu_position.x,u),_.container.y=va.smoothEnd(_.start_position.y,_.menu_position.y,u);var h=va.smoothToABCWithSmoothB(_.start_scale,1.3,_.menu_scale,.6,u);if(_.container.scale.x=h,_.container.scale.y=h,1==u){_.state=be.RollingDice,_.dice_roll_frames=[];for(var c=1,d=_.icon.data.frames.length;c<d;){var m=c++;_.dice_roll_frames.push(m)}ga.shuffleArray(_.dice_roll_frames),_.dice_roll_final_index=Ae.getIndexByAbility(e.abilities.received_ability),_.dice_roll_frame_count=2*xe.dice_roll_available_abilities.length+_.dice_roll_final_index}}if(_.state==be.RollingDice){_.current_shuffle_time+=l;var f=_.current_shuffle_time/Te.shuffle_time,g=va.smoothEnd(0,1,f),v=0;_.instantly_receive_ability&&(f=1.1),1<f?(g=f=1,v=_.dice_roll_final_index):v=Math.floor(_.dice_roll_frame_count*g)%xe.dice_roll_available_abilities.length,_.icon.current_frame!=v+1&&(Ms.playSound(Gs.sound_power_roll,o,.5),1==f&&Ms.playSound(Gs.sound_power_roll_end,o,.5)),A.gotoFrame(_.icon,v+1),1==f&&(_.container.scale.x=1,_.container.scale.y=1,_.state=be.ButtonMode,p.current_ability=Ae.getAbilityByIndex(v),p.received_ability=null)}_.state==be.ButtonMode&&(_.container.parent.x==_.parent_cache_x&&_.container.parent.y==_.parent_cache_y||(_.parent_cache_x=_.container.parent.x,_.parent_cache_y=_.container.parent.y),_.use_ability_click?(_.use_ability_click=!1,ze.useAbility(e,i,r,a,s,o)):$a.isDowned(_.parent_cache_x,_.parent_cache_y,t,_.radius)&&ze.useAbility(e,i,r,a,s,o),n.desktop&&($a.isOver(_.parent_cache_x,_.parent_cache_y,t,_.radius)?_.keyboard_shortcut_display.container.visible=!0:_.keyboard_shortcut_display.container.visible=!1)),null==p.received_ability&&(null==p.current_ability?_.state!=be.None&&(_.state=be.None,_.old_clicked_container=_.container,ze.pushToOld(_)):p.current_ability==ye.None&&_.state!=be.None&&(_.state=be.None,_.old_clicked_container=_.container,ze.pushToOld(_)));for(var b=0;b<_.old_icons.length;){var y=_.old_icons[b],x=_.old_containers[b];x.alpha-=.1*l,x==_.old_clicked_container&&(x.scale.x+=.05*l,x.scale.y+=.05*l),x.alpha<=0&&(y.sprite.destroy(!0),A.destroyAnimation(y),_.old_icons.splice(b,1),_.old_containers[b].destroy(!0),_.old_containers.splice(b,1),--b),++b}};var we=function(){this.cooldown_time_stamp=0,this.cooldown_time=1};(n["bikas.game.JumpPower"]=we).__name__=["bikas","game","JumpPower"],we.prototype={cooldown_time:null,cooldown_time_stamp:null,__class__:we};var ke=n["bikas.game.ConstantPowerType"]={__ename__:["bikas","game","ConstantPowerType"],__constructs__:["Nitro","Shield","Magnet"]};ke.Nitro=["Nitro",0],ke.Nitro.toString=i,(ke.Nitro.__enum__=ke).Shield=["Shield",1],ke.Shield.toString=i,(ke.Shield.__enum__=ke).Magnet=["Magnet",2],ke.Magnet.toString=i,(ke.Magnet.__enum__=ke).__empty_constructs__=[ke.Nitro,ke.Shield,ke.Magnet];var Se=function(e){this.additional=[],this.animation=null,this.added_to_partition=!1,this.above_car=!1,this.additional_offset=null,this.phase_time=5,this.max_alpha=1,this.max_time=0,this.current_time=0,this.activated=!1,this.type=e};(n["bikas.game.ConstantPower"]=Se).__name__=["bikas","game","ConstantPower"],Se.prototype={type:null,activated:null,current_time:null,max_time:null,max_alpha:null,phase_time:null,additional_offset:null,above_car:null,added_to_partition:null,sprite:null,animation:null,additional:null,__class__:Se};var Ce=function(){this.power_add_coeff=0};(n["bikas.game.ExplosionEvent"]=Ce).__name__=["bikas","game","ExplosionEvent"],Ce.prototype={type:null,source_car:null,space:null,explosion_center:null,explosion_radius:null,body_containment:null,min_impulse:null,max_impulse:null,power_add_coeff:null,one_time_velocity_friction:null,__class__:Ce};var Ne=n["bikas.game.ExplosiveType"]={__ename__:["bikas","game","ExplosiveType"],__constructs__:["Bomb","Dynamite","Barrel"]};Ne.Bomb=["Bomb",0],Ne.Bomb.toString=i,(Ne.Bomb.__enum__=Ne).Dynamite=["Dynamite",1],Ne.Dynamite.toString=i,(Ne.Dynamite.__enum__=Ne).Barrel=["Barrel",2],Ne.Barrel.toString=i,(Ne.Barrel.__enum__=Ne).__empty_constructs__=[Ne.Bomb,Ne.Dynamite,Ne.Barrel];var Pe=n["bikas.game.ExplosiveState"]={__ename__:["bikas","game","ExplosiveState"],__constructs__:["Normal","ExplosionExploded","ExplosionAnimation","Done"]};Pe.Normal=["Normal",0],Pe.Normal.toString=i,(Pe.Normal.__enum__=Pe).ExplosionExploded=["ExplosionExploded",1],Pe.ExplosionExploded.toString=i,(Pe.ExplosionExploded.__enum__=Pe).ExplosionAnimation=["ExplosionAnimation",2],Pe.ExplosionAnimation.toString=i,(Pe.ExplosionAnimation.__enum__=Pe).Done=["Done",3],Pe.Done.toString=i,(Pe.Done.__enum__=Pe).__empty_constructs__=[Pe.Normal,Pe.ExplosionExploded,Pe.ExplosionAnimation,Pe.Done];var Me=function(){this.explosion_events_buffer=[],this.explosion_max_impulse=1e3,this.explosion_min_impulse=350,this.explosion_radius=300,this.explosion_velocity_friction=.6,this.power_add_coeff=0,this.current_bomb_existance_time=0,this.bomb_throw_angular_impulse=2e3,this.dynamite_time=14,this.dynamite_time_current=-1,this.hide_sprite=null,this.source_car=null};(n["bikas.game.Explosive"]=Me).__name__=["bikas","game","Explosive"],Me.prototype={type:null,state:null,cbody:null,source_car:null,container:null,animation:null,hide_sprite:null,init_pos:null,dynamite_time_current:null,dynamite_time:null,bomb_throw_angular_impulse:null,current_bomb_existance_time:null,power_add_coeff:null,explosion_velocity_friction:null,explosion_radius:null,explosion_min_impulse:null,explosion_max_impulse:null,current_explosion_time:null,explosion_events_buffer:null,__class__:Me};var Ie=function(){this.last_car_multiplier=1,this.first_car_multiplier=1};(n["bikas.game.AbilityProbability"]=Ie).__name__=["bikas","game","AbilityProbability"],Ie.prototype={type:null,first_car_multiplier:null,last_car_multiplier:null,__class__:Ie};var Te=function(){this.nitro_power_charge=0,this.bot_ability_receive_time_stamp=0,this.received_ability=null,this.current_ability_power_add_coeff=0,this.current_ability=ye.None};(n["bikas.game.AbilityInventory"]=Te).__name__=["bikas","game","AbilityInventory"],Te.prototype={jump_power:null,nitro_power:null,shield_power:null,magnet_power:null,current_ability:null,current_ability_power_add_coeff:null,received_ability:null,bot_ability_receive_time_stamp:null,nitro_power_charge:null,__class__:Te};var Ae=function(){};(n["bikas.game.AbilityDo"]=Ae).__name__=["bikas","game","AbilityDo"],Ae.createAbilities=function(){var e=new Te;return e.jump_power=Ae.createJumpPower(),e.nitro_power=Ae.createNitroPower(),e.shield_power=Ae.createShieldPower(),e.magnet_power=Ae.createMagnetPower(),e},Ae.destroyAbilities=function(e){Ae.destroyConstantPower(e.nitro_power),Ae.destroyConstantPower(e.shield_power),Ae.destroyConstantPower(e.magnet_power),e.jump_power=null,e.nitro_power=null,e.shield_power=null,e.magnet_power=null},Ae.destroyConstantPower=function(e){null!=e.animation&&A.destroyAnimation(e.animation,!1),null!=e.sprite&&e.sprite.destroy(!0);for(var t=0,n=e.additional;t<n.length;){var i=n[t];++t,i.destroy(!0)}null!=e.additional_offset&&(ea.destroy(e.additional_offset),e.additional_offset=null)},Ae.deactivateAbilities=function(e){Ae.deactivateConstantPower(e.nitro_power),Ae.deactivateConstantPower(e.shield_power),Ae.deactivateConstantPower(e.magnet_power),e.nitro_power_charge=0,e.current_ability=ye.None,e.received_ability=null},Ae.deactivateConstantPower=function(e){e.current_time=0,e.activated=!1,null!=e.sprite&&e.sprite.visible&&(e.sprite.visible=!1)},Ae.createJumpPower=function(){return new we},Ae.createNitroPower=function(){var e=new Se(ke.Nitro);return e.additional_offset=ea.create(0,0),e.animation=A.createNewAnimation(Gs.animation_nitro_flames,!1),e.sprite=e.animation.sprite,e.max_alpha=.8,e.phase_time=3,e},Ae.createShieldPower=function(){var e=new Se(ke.Shield);return e.animation=A.createNewAnimation(Gs.animation_power_shield,!1),e.sprite=e.animation.sprite,e.sprite.alpha=1,e},Ae.createMagnetPower=function(){var e=new Se(ke.Magnet);return e.animation=A.createNewAnimation(Gs.animation_power_magnet,!1),e.sprite=e.animation.sprite,e.sprite.alpha=1,e},Ae.updateConstantPowerAbilities=function(e,t,n,i,r,a,s,l){n.nitro_power.activated&&Ae.updateConstantPower(e,t,n.nitro_power,i,r,a,s,l),n.shield_power.activated&&Ae.updateConstantPower(e,t,n.shield_power,i,r,a,s,l),n.magnet_power.activated&&Ae.updateConstantPower(e,t,n.magnet_power,i,r,a,s,l)},Ae.updateConstantPower=function(e,t,n,i,r,a,s,l){if(n.activated){if(null!=n.sprite){if(n.sprite.visible||(n.sprite.visible=!0),n.type==ke.Nitro)if(null!=i.exhaust_position){var o=i.exhaust_position.get_x();n.additional_offset.x=o-n.animation.data.frames[0].texture.width/2+20,n.additional_offset.y=i.exhaust_position.get_y()}else n.additional_offset.x=i.bounds.min_x-60,n.additional_offset.y=i.bounds.max_y-.5*i.back_wheel_diameter;var _=i.main_body.get_rotation();if(n.sprite.rotation=ce.normalizeAngle(_),null!=n.additional_offset?(wa.rotate(n.additional_offset,n.sprite.rotation),n.sprite.position.x=i.main_body_position_x+n.additional_offset.x,n.sprite.position.y=i.main_body_position_y+n.additional_offset.y):(n.sprite.position.x=i.main_body_position_x,n.sprite.position.y=i.main_body_position_y),!n.added_to_partition){var p;p=n.above_car?1:-1,null!=zi.tryToAddSpriteAfterThisDisplayObject(e,t,i.main_body_entity.display.sprite,p,n.sprite,!0)&&(n.added_to_partition=!0)}}if(n.current_time-=l.dc,n.type!=ke.Nitro&&n.type!=ke.Shield&&n.type!=ke.Magnet||(null==n.animation?Nl.trace("warning: power.animation == null",{fileName:"AbilityDo.hx",lineNumber:215,className:"bikas.game.AbilityDo",methodName:"updateConstantPower"}):A.nextFrameStep(n.animation,l.dc)),n.type==ke.Nitro)Mt.nitro(i,r,a,l.dc);else if(n.type==ke.Magnet)for(var u=i.main_body.get_position(),h=0;h<s.length;){var c=s[h];if(++h,c!=i){var d=u.sub(c.main_body.get_position());d.get_length()<Se.magnet_distance&&(d.muleq(5*l.dc),c.main_body.applyImpulse(d),c.main_body.get_velocity().muleq(Math.pow(.93,l.dc))),d.dispose()}}return n.current_time<0&&Ae.deactivateConstantPower(n),!0}return Ae.deactivateConstantPower(n),!1},Ae.useCurrentAbility=function(e,t,n,i,r,a,s,l){n.current_ability==ye.Bomb?(Ae.throwBombFromCar(e,n.current_ability_power_add_coeff,i,r,a,s),Wn.playSoundInGameLevel(Gs.sound_throw,l,e.main_body.get_position(),t.car,1e3,1)):n.current_ability==ye.Dynamite?(Ae.dropDynamiteFromCar(e,n.current_ability_power_add_coeff,i,r,a,s),Wn.playSoundInGameLevel(Gs.sound_throw,l,e.main_body.get_position(),t.car,1e3,1)):n.current_ability==ye.Armor?(Ae.activateOrExtendConstantPower(n.shield_power,e,Te.shield_time),Wn.playSoundInGameLevel(Gs.sound_armor,l,e.main_body.get_position(),t.car,1e3,1)):n.current_ability==ye.Nitro?Ae.activateOrExtendConstantPower(n.nitro_power,e,Te.nitro_time):n.current_ability==ye.Magnet?Ae.activateOrExtendConstantPower(n.magnet_power,e,Te.magnet_time):Nl.trace("warning: unhandled ability "+p.string(n.current_ability),{fileName:"AbilityDo.hx",lineNumber:301,className:"bikas.game.AbilityDo",methodName:"useCurrentAbility"}),n.current_ability=ye.None},Ae.activateOrExtendConstantPower=function(e,t,n){e.activated=!0,e.max_time=n,e.current_time=e.max_time,e.above_car=!0,e.type==ke.Nitro?e.above_car=!1:e.type==ke.Shield?e.above_car=!0:e.type==ke.Magnet&&(e.above_car=!0)},Ae.getAbilityByIndex=function(e){return 0==e?ye.Bomb:1==e?ye.Dynamite:2==e?ye.Armor:3==e?ye.Nitro:4==e?ye.Magnet:(Nl.trace("warning: ability does not exist",{fileName:"AbilityDo.hx",lineNumber:339,className:"bikas.game.AbilityDo",methodName:"getAbilityByIndex"}),ye.None)},Ae.getIndexByAbility=function(e){return e==ye.Bomb?0:e==ye.Dynamite?1:e==ye.Armor?2:e==ye.Nitro?3:e==ye.Magnet?4:(Nl.trace("warning: unhandled ability",{fileName:"AbilityDo.hx",lineNumber:360,className:"bikas.game.AbilityDo",methodName:"getIndexByAbility"}),-1)},Ae.isAllowedToJump=function(e,t){return t>=e.cooldown_time_stamp},Ae.isAbleToJump=function(e){return e.updates_since_any_wheel_collided<=6},Ae.tryJump=function(e,t,n,i,r){return!(!Ae.isAllowedToJump(e,r)||!Ae.isAbleToJump(i)||(e.cooldown_time_stamp=r+e.cooldown_time,Mt.jump(t,n,i),0))},Ae.throwBombFromCar=function(e,t,n,i,r,a){var s=y_.get(e.bounds.max_x+25,e.bounds.min_y-25);s.rotate(e.main_body.get_rotation()),s.addeq(e.main_body.get_position());var l=y_.get(1200,0);l.rotate(e.main_body.get_rotation()-.1111111111111111*Math.PI);var o=Ae.throwBomb(s.get_x(),s.get_y(),e.main_body.get_velocity().get_x(),l,t,n,i,r,a,e);return s.dispose(),l.dispose(),o},Ae.throwBomb=function(e,t,n,i,r,a,s,l,o,_){var p=Ae.createExplosive(a,s,Me.bomb_explosion_radius,e,t,Ne.Bomb,r);return p.source_car=_,Jt.setSpace(p.cbody,l),p.cbody.body.get_velocity().setxy(n,0),p.cbody.body.applyImpulse(i),p.cbody.body.applyAngularImpulse(p.bomb_throw_angular_impulse),p.current_bomb_existance_time=0,o.push(p),Jt.updateContainerBody(p.cbody),p},Ae.dropDynamiteFromCar=function(e,t,n,i,r,a){var s=e.main_body.get_position();return Ae.dropDynamite(s.get_x(),s.get_y(),t,n,i,r,a,e)},Ae.dropDynamite=function(e,t,n,i,r,a,s,l){var o=Ae.createExplosive(i,r,Me.dynamite_explosion_radius,e,t,Ne.Dynamite,n);return o.source_car=l,Jt.setSpace(o.cbody,a),s.push(o),Jt.updateContainerBody(o.cbody),o},Ae.applyExplosionImpulseToBodies=function(e,t,n,i,r,a,s,l,o,_){null==_&&(_=.6),null==o&&(o=10),null==l&&(l=2),null==s&&(s=1e3),null==a&&(a=350),null==r&&(r=!1),null==i&&(i=300);for(var p=e.bodiesInCircle(n,i,r).iterator();p.hasNext();){var u=p.next();if(-1==t.indexOf(u)){var h=u.get_position().sub(n),c=h.get_length();h.dispose();var d=ma.clamp(1-c/(2*i),0,1),m=va.linear(1,_,d);u.get_velocity().muleq(m);var f=va.linear(a,s,d),g=y_.get(0,-f*u.get_mass());u.applyImpulse(g);var v=va.linear(l,o,d)*u.get_inertia(),b=ma.getRandomSign();u.applyAngularImpulse(v*b),u.isStatic()&&(u.get_userData().just_applied_impulse_length=g.get_length()),u.get_userData().just_exploded=!0,g.dispose()}}},Ae.createExplosionEvent=function(e,t){var n=new Ce;return n.type=t.type,n.source_car=t.source_car,n.space=e.get_space(),n.explosion_center=e.get_position(),n.explosion_radius=t.explosion_radius,n.body_containment=!1,n.min_impulse=t.explosion_min_impulse,n.max_impulse=t.explosion_max_impulse,n.power_add_coeff=t.power_add_coeff,n.one_time_velocity_friction=t.explosion_velocity_friction,n},Ae.updateExplosive=function(e,t,n){Jt.updateContainerBody(e.cbody);var i=e.cbody.body;if(e.state==Pe.Normal)e.type==Ne.Dynamite?(e.dynamite_time_current-=n.dc,e.dynamite_time_current>2*e.dynamite_time?A.gotoFrame(e.animation,0):e.dynamite_time_current>e.dynamite_time?A.gotoFrame(e.animation,1):e.dynamite_time_current>.2*e.dynamite_time?A.gotoFrame(e.animation,2):e.dynamite_time_current<=0&&(e.state=Pe.ExplosionExploded,A.replaceAnimationData(e.animation,Gs.animation_explosion),e.explosion_events_buffer.push(Ae.createExplosionEvent(i,e)),e.current_explosion_time=Me.total_explosion_time,Jt.setSpace(e.cbody,null))):e.type==Ne.Bomb?(e.current_bomb_existance_time+=n.dc,e.current_bomb_existance_time>=Me.bomb_min_existance_time&&Aa.hasCollisionArbiterDynamicBody(i)?(A.replaceAnimationData(e.animation,Gs.animation_explosion),i.set_allowMovement(!1),i.set_allowRotation(!1),i.get_velocity().set_x(0),i.get_velocity().set_y(0),i.set_angularVel(0),i.setShapeFilters(Si.no_interaction),e.state=Pe.ExplosionExploded,e.explosion_events_buffer.push(Ae.createExplosionEvent(i,e)),e.current_explosion_time=Me.total_explosion_time,Jt.setSpace(e.cbody,null)):A.nextFrameStep(e.animation,n.dc)):e.type==Ne.Barrel&&(e.animation=A.createNewAnimation(Gs.animation_explosion,!1),e.container.add(e.animation.sprite),A.gotoFrame(e.animation,0),e.state=Pe.ExplosionExploded,e.explosion_events_buffer.push(Ae.createExplosionEvent(i,e)),e.current_explosion_time=Me.total_explosion_time,Jt.setSpace(e.cbody,null));else if(e.state==Pe.ExplosionExploded)e.state=Pe.ExplosionAnimation;else if(e.state==Pe.ExplosionAnimation){var r=n.dc;if(2<r&&(r=2),e.current_explosion_time-=r,e.current_explosion_time<=0)return void(e.state=Pe.Done);var a=1-e.current_explosion_time/Me.total_explosion_time,s=Math.floor(va.linear(0,Gs.animation_explosion.frames.length,a));3<=s&&null!=e.hide_sprite&&e.hide_sprite.visible&&(e.hide_sprite.visible=!1),s>=e.animation.data.frames.length&&(s=e.animation.data.frames.length-1),e.animation.sprite.parent.scale.x=2,e.animation.sprite.parent.scale.y=2,A.gotoFrame(e.animation,s)}},Ae.createExplosive=function(e,t,n,i,r,a,s,l,o){var _=new Me;if(_.state=Pe.Normal,_.cbody=Jt.createContainerBody(M_.get_DYNAMIC(),l),a!=Ne.Bomb&&a!=Ne.Dynamite||(_.cbody.body.get_position().set_x(i),_.cbody.body.get_position().set_y(r)),_.init_pos=_.cbody.body.get_position().copy(),(_.type=a)==Ne.Bomb){var u=new R_(21);_.cbody.body.get_shapes().add(u),_.animation=A.createNewAnimation(Gs.animation_power_bomb_burning,!1)}else if(a==Ne.Dynamite){_.dynamite_time_current=3*_.dynamite_time;var h=new V_(V_.box(93.75,52.5));_.cbody.body.get_shapes().add(h),_.cbody.body.setShapeFilters(Si.only_to_ground),_.animation=A.createNewAnimation(Gs.animation_power_dynamite,!1)}else a==Ne.Barrel?_.hide_sprite=o:Nl.trace("warning: unhandled type "+p.string(a),{fileName:"AbilityDo.hx",lineNumber:658,className:"bikas.game.AbilityDo",methodName:"createExplosive"});_.explosion_radius=n,_.explosion_min_impulse=350,_.explosion_max_impulse=1e3,_.power_add_coeff=s,_.container=qa.createGroup(),null!=_.animation&&_.container.add(_.animation.sprite);var c=new PIXI.Rectangle(-750,-750,1500,1500);return Jt.addDisplayObject(_.cbody,e,t,_.container,c,-1),_},Ae.destroyExplosive=function(e,t){null!=e.cbody&&Jt.destroyContainerBody(e.cbody,t,!0),null!=e.animation&&A.destroyAnimation(e.animation),e.animation=null,(e.cbody=null)!=e.init_pos&&(e.init_pos.dispose(),e.init_pos=null)};var De=function(){};(n["bikas.game.AdjustTop"]=De).__name__=["bikas","game","AdjustTop"],De.update=function(e){for(var t=e.level_seconds,n=e.step_size,i=(De.adjusts.length,0),r=De.adjusts;i<r.length;){var a=r[i];++i,a.update()}for(var s=0,l=De.updates.length;s<l;)De.updates[s](t,n)||(De.updates.splice(s,1),--s,--l),++s},De.cancelAll=function(){for(var e=0,t=De.adjusts;e<t.length;){var n=t[e];++e,null!=n.onEnd&&n.onEnd()}De.adjusts=[],De.updates=[]},De.prototype={__class__:De};var Ee=function(e){this.save={},this.start_time_stamp=0,this.current_wait=0,this.wait_frames_after_start_call=60,this.update_in_progress=!1,this.iteration=0,this.name="",this.onEnd=null,this.name=e};(n["bikas.game.AdjustTimed"]=Ee).__name__=["bikas","game","AdjustTimed"],Ee.prototype={update_start_call:null,update_begin_call:null,update_call:null,update_end_call:null,adjust_var:null,adjust_finish_call:null,onEnd:null,name:null,iteration:null,update_in_progress:null,wait_frames_after_start_call:null,current_wait:null,start_time_stamp:null,save:null,startAdjust:function(){Nl.trace("start adjust: "+this.name,{fileName:"AdjustTop.hx",lineNumber:71,className:"bikas.game.AdjustTimed",methodName:"startAdjust"}),-1==De.adjusts.indexOf(this)&&De.adjusts.push(this),this.iteration=0,this.startUpdate()},startUpdate:function(){this.start_time_stamp=mn.step.level_seconds,this.iteration++,Nl.trace("start adjust update: "+this.name+", iteration: "+this.iteration,{fileName:"AdjustTop.hx",lineNumber:81,className:"bikas.game.AdjustTimed",methodName:"startUpdate"}),null!=this.update_start_call&&this.update_start_call(),null!=this.update_call?(this.update_in_progress=!0,this.current_wait=this.wait_frames_after_start_call):this.finishUpdate()},finishUpdate:function(){this.update_in_progress=!1,null!=this.update_end_call&&this.update_end_call(),Nl.trace("end adjust update: "+this.name+", iteration: "+this.iteration,{fileName:"AdjustTop.hx",lineNumber:97,className:"bikas.game.AdjustTimed",methodName:"finishUpdate"}),null==this.adjust_var?this.end():this.adjust_var()?this.end():this.startUpdate()},end:function(){Nl.trace("finish adjust: "+this.name,{fileName:"AdjustTop.hx",lineNumber:109,className:"bikas.game.AdjustTimed",methodName:"end"}),-1!=De.adjusts.indexOf(this)&&s.remove(De.adjusts,this),null!=this.adjust_finish_call&&this.adjust_finish_call(),null!=this.onEnd&&this.onEnd()},update:function(){if(this.update_in_progress){if(0<this.current_wait){if(this.current_wait--,0!=this.current_wait)return;this.start_time_stamp=mn.step.level_seconds,null!=this.update_begin_call&&this.update_begin_call()}null!=this.update_call&&this.update_call()&&this.finishUpdate()}},__class__:Ee};var Oe=function(){};(n["bikas.game.AdjustDo"]=Oe).__name__=["bikas","game","AdjustDo"],Oe.initRace=function(e,t,n,i){for(var r=0,a=t.baggages;r<a.length;){var s=a[r];++r,s.body.setShapeFilters(Si.only_to_ground)}Vn.initRace(mn.game,mn.step)},Oe.all=function(e,t,n){var i=Oe.zeroToMaxDrive(e,t,n),r=Oe.zeroToMaxNitro(e,t,n),a=Oe.jump(e,t,n);return i.adjust_finish_call=function(){r.startAdjust()},r.adjust_finish_call=function(){a.startAdjust()},i.startAdjust(),null},Oe.zeroToMaxDrive=function(e,t,n){var i=new Ee("zero to max drive (for time: 0.9s)");return i.update_start_call=function(){Oe.initRace(mn.game,e,t,n)},i.update_call=function(){return Mt.drive(e,t,n,1),e.main_body.get_velocity().get_length()>=t.drive_velocity_max},i.update_end_call=function(){Nl.trace("impulse: "+t.drive_impulse,{fileName:"AdjustTop.hx",lineNumber:182,className:"bikas.game.AdjustDo",methodName:"zeroToMaxDrive"}),Nl.trace("time: "+(mn.step.level_seconds-i.start_time_stamp),{fileName:"AdjustTop.hx",lineNumber:183,className:"bikas.game.AdjustDo",methodName:"zeroToMaxDrive"})},i.adjust_var=function(){if(Math.abs(.9-(mn.step.level_seconds-i.start_time_stamp))<.008333333333333333)return t.info_zero_to_max_drive=mn.step.level_seconds-i.start_time_stamp,Pt.roundConfigFloats(t),Nl.trace(Pt.getMinimalConfigText(t),{fileName:"AdjustTop.hx",lineNumber:189,className:"bikas.game.AdjustDo",methodName:"zeroToMaxDrive"}),!0;var e=(mn.step.level_seconds-i.start_time_stamp)/.9;return t.drive_impulse*=e,Nl.trace("impulse: "+t.drive_impulse,{fileName:"AdjustTop.hx",lineNumber:194,className:"bikas.game.AdjustDo",methodName:"zeroToMaxDrive"}),!1},i},Oe.zeroToMaxNitro=function(e,t,n){var i=new Ee("zero to max nitro (for time: 0.5s)");return i.update_start_call=function(){Oe.initRace(mn.game,e,t,n)},i.update_call=function(){return Mt.nitro(e,t,n,mn.step.dc),e.main_body.get_velocity().get_length()>=t.nitro_velocity_to_drive_velocity_max_coeff*t.drive_velocity_max},i.update_end_call=function(){Nl.trace("impulse: "+t.nitro_impulse,{fileName:"AdjustTop.hx",lineNumber:213,className:"bikas.game.AdjustDo",methodName:"zeroToMaxNitro"}),Nl.trace("time: "+(mn.step.level_seconds-i.start_time_stamp),{fileName:"AdjustTop.hx",lineNumber:214,className:"bikas.game.AdjustDo",methodName:"zeroToMaxNitro"})},i.adjust_var=function(){if(Math.abs(.5-(mn.step.level_seconds-i.start_time_stamp))<.008333333333333333)return t.info_zero_to_max_nitro=mn.step.level_seconds-i.start_time_stamp,Pt.roundConfigFloats(t),Nl.trace(Pt.getMinimalConfigText(t),{fileName:"AdjustTop.hx",lineNumber:220,className:"bikas.game.AdjustDo",methodName:"zeroToMaxNitro"}),!0;var e=(mn.step.level_seconds-i.start_time_stamp)/.5;return t.nitro_impulse*=e,Nl.trace("coeff: "+e,{fileName:"AdjustTop.hx",lineNumber:225,className:"bikas.game.AdjustDo",methodName:"zeroToMaxNitro"}),Nl.trace("impulse: "+t.nitro_impulse,{fileName:"AdjustTop.hx",lineNumber:226,className:"bikas.game.AdjustDo",methodName:"zeroToMaxNitro"}),!1},i},Oe.jump=function(e,t,n){var i=new Ee("jump test (for height = -200)");return i.update_start_call=function(){Vn.initRace(mn.game,mn.step)},i.update_begin_call=function(){var r=e.back_wheel_body.get_position().get_y();i.save.jumpPreviousHeight=r+1,i.save.jumpInitHeight=e.main_body.get_position().get_y(),Mt.jump(e,t,n)},i.update_call=function(){var t=e.main_body.get_position().get_y();return i.save.jumpPreviousHeight<(i.save.jumpPreviousHeight=t)},i.update_end_call=function(){Nl.trace("impulse: "+t.jump_impulse,{fileName:"AdjustTop.hx",lineNumber:260,className:"bikas.game.AdjustDo",methodName:"jump"}),Nl.trace("time: "+(mn.step.level_seconds-i.start_time_stamp),{fileName:"AdjustTop.hx",lineNumber:261,className:"bikas.game.AdjustDo",methodName:"jump"})},i.adjust_var=function(){var n=e.main_body.get_position().get_y()-i.save.jumpInitHeight;if(-200==Math.round(n))return t.info_max_height_jump_time=mn.step.level_seconds-i.start_time_stamp,t.info_max_height_jump_distance=n,Pt.roundConfigFloats(t),Nl.trace(Pt.getMinimalConfigText(t),{fileName:"AdjustTop.hx",lineNumber:271,className:"bikas.game.AdjustDo",methodName:"jump"}),!0;var r=-200/n;return 1<r?r*=1-(r-1)/10:r<1&&(r*=1+(1-r)/10),t.jump_impulse*=r,Nl.trace("height: "+n,{fileName:"AdjustTop.hx",lineNumber:282,className:"bikas.game.AdjustDo",methodName:"jump"}),Nl.trace("coeff: "+r,{fileName:"AdjustTop.hx",lineNumber:283,className:"bikas.game.AdjustDo",methodName:"jump"}),Nl.trace("impulse: "+t.jump_impulse,{fileName:"AdjustTop.hx",lineNumber:284,className:"bikas.game.AdjustDo",methodName:"jump"}),!1},i},Oe.testZeroToMaxNitroToMaxDrive=function(e,t,n){var i=new Ee("zero to max nitro to max drive");return i.update_start_call=function(){Oe.initRace(mn.game,e,t,n),i.save.stage=0},i.update_begin_call=function(){},i.update_call=function(){if(0==i.save.stage)Mt.nitro(e,t,n,mn.step.dc),e.main_body.get_velocity().get_length()>=t.nitro_velocity_to_drive_velocity_max_coeff*t.drive_velocity_max&&(i.save.stage=1,i.save.slowDownTimeStamp=mn.step.level_seconds);else if(1==i.save.stage&&(Mt.drive(e,t,n,1),e.main_body.get_velocity().get_length()<=t.drive_velocity_max+1))return Nl.trace("slowed down from max nitro in "+(mn.step.level_seconds-i.save.slowDownTimeStamp),{fileName:"AdjustTop.hx",lineNumber:311,className:"bikas.game.AdjustDo",methodName:"testZeroToMaxNitroToMaxDrive"}),!0;return!1},i.adjust_var=function(){return!0},i},Oe.testRotate=function(e,t,n){var i=new Ee("test rotate(1): "+e.name);return i.update_start_call=function(){i.save.gravity=mn.game.world.space.get_gravity().get_y(),i.save.previousRotation=0,i.save.rotationAccumulated=0,i.save.appliedTimes=0,i.save.appliedPI=0,i.save.angularMaxTraced=!1,mn.game.world.space.get_gravity().set_y(0),i.save.piRotationTime=-1,Ot.setDeltaPosition(e,0,-500),Ot.setVelocity(e,0,0),Ot.setRotation(e,0)},i.update_begin_call=function(){i.save.totalTime=mn.step.level_seconds},i.update_call=function(){return i.save.rotationAccumulated+=e.main_body.get_rotation()-i.save.previousRotation,i.save.previousRotation=e.main_body.get_rotation(),i.save.angularMaxTraced||e.main_body.get_angularVel()>=t.rotation_angular_velocity_max-.1&&(i.save.angularMaxTraced=!0,Nl.trace("reached max angular velocity time: "+(mn.step.level_seconds-i.save.totalTime),{fileName:"AdjustTop.hx",lineNumber:348,className:"bikas.game.AdjustDo",methodName:"testRotate"}),Nl.trace("reached max angular velocity rotation: "+Math.round(i.save.rotationAccumulated/Math.PI*180*10)/10,{fileName:"AdjustTop.hx",lineNumber:349,className:"bikas.game.AdjustDo",methodName:"testRotate"}),Nl.trace("reached max angular velocity rotate(1) count: "+p.string(i.save.appliedTimes),{fileName:"AdjustTop.hx",lineNumber:350,className:"bikas.game.AdjustDo",methodName:"testRotate"})),i.save.rotationAccumulated>=2*Math.PI||(i.save.rotationAccumulated>Math.PI/2&&-1==i.save.piRotationTime?(i.save.piRotationTime=mn.step.level_seconds,i.save.appliedPI=i.save.appliedTimes):i.save.rotationAccumulated>3*Math.PI/2&&0!=i.save.piRotationTime&&(Nl.trace("Math.PI/2 -> Math.PI*3/2, rotation time: "+(mn.step.level_seconds-i.save.piRotationTime),{fileName:"AdjustTop.hx",lineNumber:361,className:"bikas.game.AdjustDo",methodName:"testRotate"}),Nl.trace("Math.PI/2 -> Math.PI*3/2, angularVel: "+e.main_body.get_angularVel(),{fileName:"AdjustTop.hx",lineNumber:362,className:"bikas.game.AdjustDo",methodName:"testRotate"}),Nl.trace("Math.PI/2 -> Math.PI*3/2, rotate(1) count: "+(i.save.appliedTimes-i.save.appliedPI),{fileName:"AdjustTop.hx",lineNumber:363,className:"bikas.game.AdjustDo",methodName:"testRotate"}),i.save.piRotationTime=0),Mt.rotate(e,t,n,1),i.save.appliedTimes++,!1)},i.update_end_call=function(){Nl.trace("0 -> Math.PI*2, rotation time: "+(mn.step.level_seconds-i.save.totalTime),{fileName:"AdjustTop.hx",lineNumber:372,className:"bikas.game.AdjustDo",methodName:"testRotate"}),Nl.trace("0 -> Math.PI*2, angularVel: "+e.main_body.get_angularVel(),{fileName:"AdjustTop.hx",lineNumber:373,className:"bikas.game.AdjustDo",methodName:"testRotate"}),Nl.trace("0 -> Math.PI*2, rotate(1) count: "+p.string(i.save.appliedTimes),{fileName:"AdjustTop.hx",lineNumber:374,className:"bikas.game.AdjustDo",methodName:"testRotate"})},i.adjust_var=function(){return mn.game.world.space.get_gravity().set_y(i.save.gravity),!0},i};var Be=n["bikas.game.AttachmentType"]={__ename__:["bikas","game","AttachmentType"],__constructs__:["AttachmentBalloon","AttachmentAnchor"]};Be.AttachmentBalloon=["AttachmentBalloon",0],Be.AttachmentBalloon.toString=i,(Be.AttachmentBalloon.__enum__=Be).AttachmentAnchor=["AttachmentAnchor",1],Be.AttachmentAnchor.toString=i,(Be.AttachmentAnchor.__enum__=Be).__empty_constructs__=[Be.AttachmentBalloon,Be.AttachmentAnchor];var Le=function(){this.baggages=[],this.anti_gravity_bodies=[],this.anti_gravity_current=y_.get(0,0),this.anti_gravity=y_.get(0,0),this.pivot_joints_to_main_body=[],this.all_pivot_joints=[],this.disconnect_in_seconds=-1};(n["bikas.game.Attachment"]=Le).__name__=["bikas","game","Attachment"],Le.prototype={type:null,prefab:null,disconnect_in_seconds:null,all_pivot_joints:null,pivot_joints_to_main_body:null,anti_gravity:null,anti_gravity_current:null,anti_gravity_bodies:null,baggages:null,__class__:Le};var je=function(){};(n["bikas.game.AttachmentDo"]=je).__name__=["bikas","game","AttachmentDo"],je.createBalloons=function(e,t,n){null==n&&(n=-1);var i=new Le;i.type=Be.AttachmentBalloon,i.prefab=e,i.disconnect_in_seconds=n;var r=i.prefab.group.entities,a=je.findEntity(r,"connection_pivot_joint");i.anti_gravity.set_y(-200);for(var s=1;s<4;){var l=s++,o=je.findEntity(r,"balloon"+l),_=je.findEntity(r,"balloon_line"+l),p=je.findEntity(r,"pivot_joint"+l);o.body.setShapeMaterials(nr.balloons),_.body.setShapeMaterials(nr.balloons_line),o.body.setShapeFilters(Si.car_baggage_self),null!=t.get_group()&&o.body.set_group(t.get_group()),i.baggages.push(o.body),_.body.setShapeFilters(Si.no_interaction);var u=je.connectBodies(_.body,o.body,p.position),h=je.connectBodies(_.body,t,a.position);i.all_pivot_joints.push(u),i.all_pivot_joints.push(h),i.pivot_joints_to_main_body.push(h),i.anti_gravity_bodies.push(o.body)}return i},je.createAnchor=function(e,t,n){null==n&&(n=-1);var i=new Le;i.type=Be.AttachmentAnchor,i.prefab=e,i.disconnect_in_seconds=n;var r=i.prefab.group.entities,a=je.findEntity(r,"anchor"),s=je.findEntity(r,"anchor_rope1"),l=je.findEntity(r,"anchor_rope2"),o=je.findEntity(r,"anchor_rope3");a.body.setShapeMaterials(nr.anchor),s.body.setShapeMaterials(nr.anchor_line),l.body.setShapeMaterials(nr.anchor_line),o.body.setShapeMaterials(nr.anchor_line),a.body.setShapeFilters(Si.only_to_ground),s.body.setShapeFilters(Si.only_to_ground),l.body.setShapeFilters(Si.only_to_ground),o.body.setShapeFilters(Si.only_to_ground);var _=je.findEntity(r,"pivot1"),p=je.findEntity(r,"pivot2"),u=je.findEntity(r,"pivot3"),h=je.findEntity(r,"connection"),c=je.connectBodies(s.body,l.body,_.position),d=je.connectBodies(l.body,o.body,p.position),m=je.connectBodies(o.body,a.body,u.position),f=je.connectBodies(s.body,t,h.position);return i.all_pivot_joints.push(c),i.all_pivot_joints.push(d),i.all_pivot_joints.push(m),i.all_pivot_joints.push(f),i.pivot_joints_to_main_body.push(f),i},je.findEntity=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.name==t)return i}return Nl.trace("warning: couldn't find "+t,{fileName:"AttachmentDo.hx",lineNumber:113,className:"bikas.game.AttachmentDo",methodName:"findEntity"}),null},je.connectBodies=function(e,t,n){var i=y_.get(n.x,n.y),r=e.worldPointToLocal(i),a=t.worldPointToLocal(i),s=new Zo(e,t,r,a);return s.set_frequency(10),s.set_damping(1),i.dispose(),s},je.disconnectAttachment=function(e){for(var t=0,n=e.baggages;t<n.length;){var i=n[t];++t,i.set_group(null),i.setShapeFilters(Si.only_to_ground)}for(var r=0,a=e.pivot_joints_to_main_body;r<a.length;){var s=a[r];++r,null!=s.get_space()&&s.set_space(null)}},je.destroy=function(e){e.prefab=null,e.all_pivot_joints=null,(e.pivot_joints_to_main_body=null)!=e.anti_gravity&&(e.anti_gravity.dispose(),e.anti_gravity=null),null!=e.anti_gravity_current&&(e.anti_gravity_current.dispose(),e.anti_gravity_current=null),e.anti_gravity_bodies=null},je.setSpace=function(e,t){for(var n=0,i=e.all_pivot_joints;n<i.length;){var r=i[n];++n,r.get_space()!=t&&r.set_space(t)}},je.update=function(e,t,n){for(var i=0,r=e.anti_gravity_bodies;i<r.length;){var a=r[i];++i,e.anti_gravity_current.set_x(e.anti_gravity.get_x()*n),e.anti_gravity_current.set_y(e.anti_gravity.get_y()*n),a.applyImpulse(e.anti_gravity_current)}-1!=e.disconnect_in_seconds&&(e.disconnect_in_seconds-=t,e.disconnect_in_seconds<=0&&(e.disconnect_in_seconds=-1,je.disconnectAttachment(e)))};var Fe=function(){this.all_sprites=[],this.horizontal_waves=[],this.background_sprites=[],this.plane=new Re,this.camera=new Gi,this.eye=new Gi,this.sprite_and_position_map=new Ol,this.sprite_and_description_map=new Ol};(n["bikas.game.Background"]=Fe).__name__=["bikas","game","Background"],Fe.prototype={level:null,background_objects:null,sprite_and_description_map:null,sprite_and_position_map:null,plane_container:null,background_container:null,foreground_container:null,eye:null,camera:null,plane:null,default_fov_z:null,current_fov_z:null,y:null,background_sprites:null,horizontal_waves:null,all_sprites:null,__class__:Fe};var Re=function(){this.points=[]};(n["bikas.game.BackgroundPlane"]=Re).__name__=["bikas","game","BackgroundPlane"],Re.prototype={flat:null,sky:null,sky_min_height:null,points:null,__class__:Re};var Ge=function(){this.invisible_waves=[],this.visible_waves=[],this.additional_scale=1};(n["bikas.game.BackgroundHorizontalSeaWaves"]=Ge).__name__=["bikas","game","BackgroundHorizontalSeaWaves"],Ge.prototype={texture:null,z:null,z_max:null,additional_scale:null,visible_waves:null,invisible_waves:null,__class__:Ge};var Ze=function(){this.additional_scale=1,this.current_wave_time=0,this.max_wave_time=60,this.z_max=0,this.z_min=0};(n["bikas.game.BackgroundSeaWave"]=Ze).__name__=["bikas","game","BackgroundSeaWave"],Ze.prototype={sprite:null,z_min:null,z_max:null,max_wave_time:null,current_wave_time:null,additional_scale:null,__class__:Ze};var Ue=function(){this.offset_y=0,this.offset_x=0,this.scale_z=800};(n["bikas.game.BackgroundObjectDescription"]=Ue).__name__=["bikas","game","BackgroundObjectDescription"],Ue.prototype={name:null,scale_z:null,offset_x:null,offset_y:null,__class__:Ue};var Ve=function(){};(n["bikas.game.BackgroundObjectPosition"]=Ve).__name__=["bikas","game","BackgroundObjectPosition"],Ve.prototype={name:null,z:null,x:null,y:null,__class__:Ve};var qe=function(){this.positions=[]};(n["bikas.game.BackgroundLevelObjects"]=qe).__name__=["bikas","game","BackgroundLevelObjects"],qe.prototype={level_name:null,positions:null,__class__:qe};var We=function(){this.levels=[],this.descriptions=[]};(n["bikas.game.BackgroundObjects"]=We).__name__=["bikas","game","BackgroundObjects"],We.prototype={descriptions:null,levels:null,__class__:We};var Xe=function(){};(n["bikas.game.BackgroundDo"]=Xe).__name__=["bikas","game","BackgroundDo"],Xe.createBackground=function(e,t,n,i,r){null==e&&(e=800);var a=new Fe;return a.plane_container=qa.createGroup(),a.background_container=qa.createGroup(),a.foreground_container=qa.createGroup(),a.default_fov_z=e,a.current_fov_z=e,a.eye.z=a.current_fov_z,a.plane.flat=t,a.plane.sky=n,a.plane.sky_min_height=r,Xe.setBackgroundY(a,i),-1==a.plane_container.children.indexOf(n)&&a.plane_container.add(n),-1==a.plane_container.children.indexOf(t)&&a.plane_container.add(t),a},Xe.destroyBackground=function(e){e.background_container.parent.removeChild(e.background_container),e.plane_container.parent.removeChild(e.plane_container),e.foreground_container.parent.removeChild(e.foreground_container),e.plane.flat.parent.removeChild(e.plane.flat),e.plane.sky.parent.removeChild(e.plane.sky);for(var t=0,n=e.all_sprites;t<n.length;){var i=n[t];++t,i.sprite.parent.removeChild(i.sprite),(p.is(i.sprite,gs)||p.is(i.sprite,fs)||p.is(i.sprite,hs))&&i.sprite.destroy(!0)}for(var r=0,a=e.horizontal_waves;r<a.length;){var s=a[r];++r;for(var l=0,o=s.visible_waves;l<o.length;){var _=o[l];++l,_.sprite=null}for(var u=0,h=s.invisible_waves;u<h.length;){var c=h[u];++u,c.sprite=null}s.visible_waves=null,s.invisible_waves=null}for(var d=0,m=e.all_sprites;d<m.length;){var f=m[d];++d,f.init_position=null,f.anchor=null,f.points=null,f.position=null,f.sprite=null}e.plane.flat.destroy(!0),e.plane.sky.destroy(!0),e.background_container.destroy(!0),e.plane_container.destroy(!0),e.foreground_container.destroy(!0),e.eye=null,e.camera=null,e.plane.flat=null,e.plane.sky=null,e.plane=null,e.background_container=null,e.plane_container=null,e.foreground_container=null,e.background_sprites=null,e.horizontal_waves=null,e.sprite_and_description_map=null,e.sprite_and_position_map=null,e.all_sprites=null},Xe.setBackgroundY=function(e,t){e.y=t;var n=_s.createPosition3D(new Gi(300,e.y,800)),i=_s.createPosition3D(new Gi(700,e.y,800)),r=_s.createPosition3D(new Gi(500,e.y,1/0));e.plane.points=[n,i,r];for(var a=0,s=e.all_sprites;a<s.length;){var l=s[a];++a;var o=e.sprite_and_description_map.get(l);l.position.y=n.global.y+o.offset_y,_s.updateSpritePoints(l)}},Xe.serializeBackgroundObjects=function(e){var t="[descriptions]\n";t+="\n";for(var n=0,i=e.descriptions;n<i.length;){var r=i[n];++n,t+=r.name+":"+r.scale_z+","+r.offset_x+","+r.offset_y+";\n"}for(var a=0,s=e.levels;a<s.length;){var l=s[a];++a,t+="\n",t+="[level:"+l.level_name+"]\n",t+="\n";for(var o=0,_=l.positions;o<_.length;){var p=_[o];++o,t+=p.name+":"+p.z+","+p.x+","+p.y+";\n"}}return t},Xe.getBackgroundObjectDefaultZ=function(e,t,n){return e*t/n-e},Xe.getZSpreadOverBackgroundArea=function(e,t,n){for(var i=new Gi(0,0,0),r=(new ea(0,0),[]),a=0,s=e.plane.points;a<s.length;){var l=s[a];++a;var o=ya.copy(l.global);r.push(ya.getProjectionWithCamera(t,i,o))}for(var _=Xe.getPlaneY(e),p=r[0],u=r[2],h=[],c=0,d=n;c<d;){var m=c++,f=new ea(0,0);f.y=va.linear(p.y,u.y,(m+1)/(n+1));var g=ya.getPointZUsingY(f,t,i,_);h.push(g)}return h},Xe.getPlaneY=function(e){return e.plane.points[0].global.y},Xe.getPlaneYMax=function(e){return e.plane.points[1].global.y},Xe.getObjectDescription=function(e,t){for(var n=0,i=e.descriptions;n<i.length;){var r=i[n];if(++n,t==r.name)return r}return Nl.trace("warning: couldn't find "+t,{fileName:"BackgroundDo.hx",lineNumber:201,className:"bikas.game.BackgroundDo",methodName:"getObjectDescription"}),null},Xe.getLevelByName=function(e,t){for(var n=0,i=e.levels;n<i.length;){var r=i[n];if(++n,r.level_name==t)return r}return Nl.trace("warning: couldn't find "+t+" background level",{fileName:"BackgroundDo.hx",lineNumber:211,className:"bikas.game.BackgroundDo",methodName:"getLevelByName"}),null},Xe.overloadBackground=function(e,t,n,i,r){if(e.background_objects=t,e.level=Xe.getLevelByName(e.background_objects,i),null==e.level&&(e.level=Xe.getLevelByName(e.background_objects,n),Nl.trace("using 'default' level for background",{fileName:"BackgroundDo.hx",lineNumber:220,className:"bikas.game.BackgroundDo",methodName:"overloadBackground"})),e.sprite_and_description_map=new Ol,e.sprite_and_position_map=new Ol,null!=e.level){var a=e.level.positions;Xe.removeAllSpritesFromContainer(e);for(var l=0,o=e.background_sprites;l<o.length;){var _=o[l];++l,s.remove(e.all_sprites,_),_.sprite.destroy(!0)}e.background_sprites=[];for(var p=0;p<a.length;){var u=a[p];++p;var h=Xe.getObjectDescription(e.background_objects,u.name);null==h&&((h=new Ue).scale_z=e.default_fov_z,h.offset_y=0);var c=Xe.pushSprite3D(e,r(u.name),u.x,u.y,u.z,h.scale_z,h.offset_x,h.offset_y);e.background_sprites.push(c),e.sprite_and_description_map.set(c,h),e.sprite_and_position_map.set(c,u)}Xe.addAndSortAllSpritesToContainer(e)}},Xe.parseBackgroundObjects=function(e){for(var t=new We,n=ba.splitByLines(e),i=0,r=!1,a=0;a<n.length;){var s=n[a];if(++a,r=!1,s=h.replace(s,"\t",""),"[descriptions]"==(s=ba.removeSpacesAtStartAndEnd(s)))i=1,r=!0;else if((1==i||2==i)&&-1!=s.indexOf("[level")){var l=h.replace(s,"[level","");l=h.replace(l,":",""),l=h.replace(l,"]","");var o=new qe;o.level_name=l,t.levels.push(o),i=2,r=!0}if(!r)if(s=h.replace(s," ",""),1==i)for(var _=s.split(";"),u=0;u<_.length;){var c=_[u];if(++u,0<c.length){var d=c.split(":");if(2==d.length){var m=d[0],f=d[1].split(",");if(3==f.length){var g=f[0],v=f[1],b=f[2],y=new Ue;y.name=m,y.scale_z=p.parseFloat(g),y.offset_x=p.parseFloat(v),y.offset_y=p.parseFloat(b),t.descriptions.push(y)}}}}else if(2==i)for(var x=s.split(";"),z=0;z<x.length;){var w=x[z];if(++z,0<w.length){var k=w.split(":");if(2==k.length){var S=k[0],C=k[1].split(",");if(3==C.length){var N=C[0],P=C[1],M=C[2],I=new Ve;I.name=S,I.z=p.parseFloat(N),I.x=p.parseFloat(P),I.y=p.parseFloat(M),t.levels[t.levels.length-1].positions.push(I)}}}}}return t},Xe.addWaves=function(e,t,n,i,r){if(t.length==n.length){for(var a=-1/0,s=0;s<n.length;){var l=n[s];++s,a<l&&(a=l)}for(var o=0,_=t.length;o<_;){var p=o++,u=new Ge;u.z=n[p],u.z_max=a,u.additional_scale=i,u.texture=r(t[p]),e.horizontal_waves.push(u)}}else Nl.trace("warning: lengths do not match",{fileName:"BackgroundDo.hx",lineNumber:354,className:"bikas.game.BackgroundDo",methodName:"addWaves"})},Xe.pushWave=function(e,t,n){var i,r=null,a=t.z,s=t.z_max,l=-1300;if(i=0<t.invisible_waves.length?!((r=t.invisible_waves.pop()).sprite.sprite.visible=!0):(r=new Ze,!0),0<t.visible_waves.length)if(n){var o=t.visible_waves[t.visible_waves.length-1].sprite;l=o.points[1].global.x+_s.getSprite3DWidth(o)/2,t.visible_waves.push(r)}else{var _=t.visible_waves[0].sprite;l=_.points[0].global.x-_s.getSprite3DWidth(_)/2,t.visible_waves.unshift(r)}else t.visible_waves.push(r);if(i){var p=Xe.pushSprite3D(e,t.texture,l,0,a,a,0,0);r.sprite=p,r.z_min=a+150,r.z_max=a-150,r.max_wave_time=va.linear(180,300,a/s),r.current_wave_time=Math.round(Math.random()*r.max_wave_time),r.additional_scale=t.additional_scale}else r.sprite.position.x=l,_s.updateSpritePoints(r.sprite);return _s.applyProjectionAndUpdateSprite3DPosition(r.sprite,e.eye,e.camera),r},Xe.pushSprite3D=function(e,t,n,i,r,a,s,l){null==l&&(l=0),null==s&&(s=0),null==a&&(a=0);var o=s+n,_=Xe.getPlaneY(e)+l+i,p=r,u=a,h=e.default_fov_z,c=qa.createSprite(t,.5,1),d=_s.createSprite3D(c,new Gi(o,_,p),u,h);return Xe.insertSpriteToList(e,d),d},Xe.insertSpriteToList=function(e,t){for(var n=0,i=0,r=e.all_sprites.length;i<r;){var a=i++,s=e.all_sprites[a].init_position.z;if(!(t.init_position.z<=s))break;n=a+1}e.all_sprites.splice(n,0,t)},Xe.insertSpriteToContainer=function(e,t){var n=e.all_sprites.indexOf(t);if(-1!=n)if(0==n)0<t.position.z?e.background_container.addAt(t.sprite,0):e.foreground_container.addAt(t.sprite,0);else{var i=e.all_sprites[n-1];if(0<t.position.z){var r=e.background_container.children.indexOf(i.sprite);-1==r?e.background_container.addAt(t.sprite,0):e.background_container.addAt(t.sprite,r+1)}else{var a=e.foreground_container.children.indexOf(i.sprite);-1==a?e.foreground_container.addAt(t.sprite,0):e.foreground_container.addAt(t.sprite,a+1)}}else Nl.trace("error: sprite is not added to all_sprites",{fileName:"BackgroundDo.hx",lineNumber:457,className:"bikas.game.BackgroundDo",methodName:"insertSpriteToContainer"})},Xe.updateSpriteOrderAfterZChanged=function(e,t){var n=e.all_sprites.indexOf(t),i=!1;if(0<n){var r=e.all_sprites[n-1];t.init_position.z>r.init_position.z&&(i=!0)}if(n<e.all_sprites.length-1){var a=e.all_sprites[n+1];t.init_position.z<a.init_position.z&&(i=!0)}0<t.init_position.z?-1==e.background_container.children.indexOf(t.sprite)&&(i=!0):-1==e.foreground_container.children.indexOf(t.sprite)&&(i=!0),i&&(s.remove(e.all_sprites,t),t.sprite.parent.removeChild(t.sprite),Xe.insertSpriteToList(e,t),Xe.insertSpriteToContainer(e,t))},Xe.addAndSortAllSpritesToContainer=function(e){e.all_sprites.sort(_s.sortSpritesByZ);for(var t=0,n=e.all_sprites;t<n.length;){var i=n[t];++t,0<i.position.z?e.background_container.add(i.sprite):e.foreground_container.add(i.sprite)}},Xe.removeAllSpritesFromContainer=function(e){for(var t=0,n=e.all_sprites;t<n.length;){var i=n[t];++t,null!=i.sprite.parent&&i.sprite.parent.removeChild(i.sprite)}},Xe.updateBackground=function(e,t,n,i,r,a){e.eye.x=i,e.eye.y=r,e.eye.z=e.current_fov_z,null!=e.plane&&_s.updatePositions(e.eye,e.camera,e.plane.points);var s=e.plane.points[2];e.plane.flat.y=Math.round(s.projection.y),e.plane.sky.y=e.plane.flat.y,e.plane.flat.width!=t&&(e.plane.flat.width=t,e.plane.sky.width=t);var l=n-e.plane.flat.y;e.plane.flat.height!=l&&(e.plane.flat.height=l);var o=e.plane.flat.y;o<e.plane.sky_min_height&&(o=e.plane.sky_min_height),e.plane.sky.height!=o&&(e.plane.sky.height=o),_s.updateSprites(e.eye,e.camera,e.all_sprites);for(var _=0,p=e.background_sprites;_<p.length;){var u=p[_];++_;var h=u.points[0].projection.x,c=u.points[1].projection.x;u.sprite.visible=!(c<-10||t+10<h)}for(var d=0,m=e.horizontal_waves;d<m.length;){var f=m[d];if(++d,0==f.visible_waves.length){var g=Xe.pushWave(e,f,!0);Xe.insertSpriteToContainer(e,g.sprite)}var v=0,b=f.visible_waves[0].sprite.points[1].projection.x;for(v=0;b<-300;){if(100<v++){Nl.trace("warning: loop broke",{fileName:"BackgroundDo.hx",lineNumber:630,className:"bikas.game.BackgroundDo",methodName:"updateBackground"});break}var y=f.visible_waves.shift();if(y.sprite.sprite.visible=!1,f.invisible_waves.push(y),!(0<f.visible_waves.length))break;b=f.visible_waves[0].sprite.points[1].projection.x}if(0==f.visible_waves.length){var x=Xe.pushWave(e,f,!0);Xe.insertSpriteToContainer(e,x.sprite)}var z=f.visible_waves[f.visible_waves.length-1].sprite.points[0].projection.x;for(v=0;t+300<z;){if(100<v++){Nl.trace("warning: loop broke",{fileName:"BackgroundDo.hx",lineNumber:654,className:"bikas.game.BackgroundDo",methodName:"updateBackground"});break}var w=f.visible_waves.pop();if(w.sprite.sprite.visible=!1,f.invisible_waves.push(w),!(0<f.visible_waves.length))break;z=f.visible_waves[f.visible_waves.length-1].sprite.points[0].projection.x}if(0==f.visible_waves.length){var k=Xe.pushWave(e,f,!0);Xe.insertSpriteToContainer(e,k.sprite)}var S=f.visible_waves[0].sprite.points[0].projection.x;for(v=0;-100<S;){if(100<v++){Nl.trace("warning: loop broke",{fileName:"BackgroundDo.hx",lineNumber:679,className:"bikas.game.BackgroundDo",methodName:"updateBackground"});break}var C=Xe.pushWave(e,f,!1);if(Xe.insertSpriteToContainer(e,C.sprite),!(0<f.visible_waves.length))break;S=f.visible_waves[0].sprite.points[0].projection.x}var N=f.visible_waves[f.visible_waves.length-1].sprite.points[1].projection.x;for(v=0;N<t+100;){if(100<v++){Nl.trace("warning: loop broke",{fileName:"BackgroundDo.hx",lineNumber:695,className:"bikas.game.BackgroundDo",methodName:"updateBackground"});break}var P=Xe.pushWave(e,f,!0);if(Xe.insertSpriteToContainer(e,P.sprite),!(0<f.visible_waves.length))break;N=f.visible_waves[f.visible_waves.length-1].sprite.points[1].projection.x}for(var M=0,I=f.visible_waves;M<I.length;){var T=I[M];++M,T.sprite.sprite.visible&&Xe.updateWave(T,a)}}},Xe.updateWave=function(e,t){e.current_wave_time+=t,e.current_wave_time>e.max_wave_time&&(e.current_wave_time=0);var n=e.current_wave_time/e.max_wave_time,i=va.linear(e.z_min,e.z_max,n);e.sprite.position.z=i;for(var r=0,a=e.sprite.points;r<a.length;){var s=a[r];++r,s.global.z=s.local.z+e.sprite.position.z}e.sprite.sprite.alpha=va.linearForwardAndBackward(0,1,n);var l=e.sprite.sprite.scale.y;e.sprite.sprite.scale.y=va.linearForwardAndBackward(.8*l*e.additional_scale,l*e.additional_scale,n)};var He=function(){};(n["bikas.game.BackgroundSpriteDrop"]=He).__name__=["bikas","game","BackgroundSpriteDrop"],He.prototype={description:null,sprite:null,__class__:He};var Ye=n["bikas.game.BackgroundUndoType"]={__ename__:["bikas","game","BackgroundUndoType"],__constructs__:["PositionChanged","PositionAdded","PositionRemoved"]};Ye.PositionChanged=["PositionChanged",0],Ye.PositionChanged.toString=i,(Ye.PositionChanged.__enum__=Ye).PositionAdded=["PositionAdded",1],Ye.PositionAdded.toString=i,(Ye.PositionAdded.__enum__=Ye).PositionRemoved=["PositionRemoved",2],Ye.PositionRemoved.toString=i,(Ye.PositionRemoved.__enum__=Ye).__empty_constructs__=[Ye.PositionChanged,Ye.PositionAdded,Ye.PositionRemoved];var Je=function(){};(n["bikas.game.BackgroundUndo"]=Je).__name__=["bikas","game","BackgroundUndo"],Je.prototype={type:null,original_position:null,position:null,description:null,__class__:Je};var Ke=function(){};(n["bikas.game.BackgroundEditTypeButton"]=Ke).__name__=["bikas","game","BackgroundEditTypeButton"],Ke.prototype={type:null,name:null,button:null,__class__:Ke};var Qe=function(e){this.init=new ea,this.offset=new ea,this.lods=[],this.sprite=e};(n["bikas.game.Sprite3DDrag"]=Qe).__name__=["bikas","game","Sprite3DDrag"],Qe.prototype={sprite:null,lods:null,offset:null,init:null,object_position:null,object_description:null,text_pos:null,text_len:null,__class__:Qe};var $e=n["bikas.game.BackgroundEditType"]={__ename__:["bikas","game","BackgroundEditType"],__constructs__:["EditZX","EditZ","EditX","EditXY","EditY","EditZXVertical","EditSelect","EditSetOriginalZ"]};$e.EditZX=["EditZX",0],$e.EditZX.toString=i,($e.EditZX.__enum__=$e).EditZ=["EditZ",1],$e.EditZ.toString=i,($e.EditZ.__enum__=$e).EditX=["EditX",2],$e.EditX.toString=i,($e.EditX.__enum__=$e).EditXY=["EditXY",3],$e.EditXY.toString=i,($e.EditXY.__enum__=$e).EditY=["EditY",4],$e.EditY.toString=i,($e.EditY.__enum__=$e).EditZXVertical=["EditZXVertical",5],$e.EditZXVertical.toString=i,($e.EditZXVertical.__enum__=$e).EditSelect=["EditSelect",6],$e.EditSelect.toString=i,($e.EditSelect.__enum__=$e).EditSetOriginalZ=["EditSetOriginalZ",7],$e.EditSetOriginalZ.toString=i,($e.EditSetOriginalZ.__enum__=$e).__empty_constructs__=[$e.EditZX,$e.EditZ,$e.EditX,$e.EditXY,$e.EditY,$e.EditZXVertical,$e.EditSelect,$e.EditSetOriginalZ];var et=function(){this.drops=[],this.drop_container_original_height=1,this.drop_container_original_width=1,this.js_info_last_height=0,this.js_info_last_width=0,this.positions_elements=[],this.descriptions_elements=[],this.general_elements=[],this.background_edit_type_buttons=[],this.redo_list=[],this.undo_list=[],this.right_mouse_down_point=null,this.last_drag=null,this.current_drag=null,this.drags=[],this.pointer=null,this.basic=null,this.move_to_sides=0,this.pressed=!1,this.camera_pos=new Gi,this.camera_drag=new ea(0,0),this.editing_enabled=!0,this.type=$e.EditZX};(n["bikas.game.BackgroundEdit"]=et).__name__=["bikas","game","BackgroundEdit"],et.prototype={type:null,editing_enabled:null,element:null,camera_drag:null,camera_pos:null,pressed:null,move_to_sides:null,basic:null,pointer:null,drags:null,current_drag:null,last_drag:null,current_level:null,last_saved:null,right_mouse_down_point:null,undo_list:null,redo_list:null,background_edit_type_buttons:null,general_elements:null,descriptions_elements:null,positions_elements:null,js_info_last_width:null,js_info_last_height:null,drop_background:null,drop_container:null,drop_container_original_width:null,drop_container_original_height:null,drops:null,__class__:et};var tt=function(){};(n["bikas.game.BackgroundEditDo"]=tt).__name__=["bikas","game","BackgroundEditDo"],tt.create=function(e,t,n){t.js_info,Pa.addText(e,"2.5D Backgrounds",!1,!0),Pa.addButton(e,"foreground visibility",function(){var e=!t.entity_container.visible;t.ground_container.visible=e,t.entity_container.visible=e,t.ingame_container.visible=e,t.ability_item_container.visible=e,t.ongoing_powers_container.visible=e}),Pa.addButton(e,"background visibility",function(){var e=!t.background.background_container.visible;t.background.background_container.visible=e,t.background.foreground_container.visible=e,t.background.plane_container.visible=e}),Pa.addButton(e,"print background objects default z",function(){var e=function(e,n,i,r,a){var s=Xe.getBackgroundObjectDefaultZ(t.background.eye.z,n,i);Nl.trace(e+":"+Math.round(s)+","+r+","+a+";",{fileName:"BackgroundEditDo.hx",lineNumber:91,className:"bikas.game.BackgroundEditDo",methodName:"create"})};e("clouds",14800,209,0,-3e3),e("big_volcano",2e4,280,0,1200),e("big_volcano_scale_2",2e4,560,0,1200),e("narrow_volcano",14800,209,0,600),e("long_sand_island",1599.15,76,0,0),e("long_sand_island_scale_3",1599.15,228,0,0),e("long_green_island",1456.35,69,0,0),e("long_green_island_scale_3",1456.35,207,0,0),e("green_island",2009.7,96,0,0),e("green_island_scale_3",2009.7,288,0,0),e("big_sand_island",3200.4,152,0,0),e("big_sand_island_scale_3",3200.4,456,0,0),e("high_sand_island",2733.15,130,0,0),e("high_sand_island_scale_3",2733.15,390,0,0),e("very_big_sand_island",3200.4,152,0,120),e("very_big_sand_island_scale_3",3200.4,456,0,120),e("big_green_island",2009.7,96,0,0),e("big_green_island_scale_3",2009.7,288,0,0),e("sinking_titanic",3664,115,0,1e3),e("sinking_titanic_scale_3",3664,345,0,1e3),e("big_ship",1624.4,69,0,0),e("big_ship_scale_3",1624.4,207,0,0),e("pirate_ship",1600,148,0,0),e("pirate_ship_scale_3",1600,444,0,0),e("sailing_yacht",952.2,96,0,0),e("sailing_yacht_scale_3",952.2,288,0,0),e("fast_yacht",354.7,34,0,0),e("fast_yacht_scale_3",354.7,102,0,0),e("house1",776,388,0,0),e("house1_scale_03",776,116,0,0),e("house1_scale_01",776,39,0,0),e("house2",868,434,0,0),e("house2_scale_03",868,130,0,0),e("house2_scale_01",868,43,0,0),e("house3",838,419,0,0),e("house3_scale_03",838,126,0,0),e("house3_scale_01",838,42,0,0),e("palm_tree1",827,827,0,0),e("palm_tree2",795,795,0,0),e("palm_tree3",849,849,0,0),e("palm_tree4",797,797,0,0)}),Pa.addButton(e,"print z spread over background",function(){for(var e=Xe.getZSpreadOverBackgroundArea(t.background,t.background.eye,13),n=0;n<e.length;){var i=e[n];++n,Nl.trace(Math.round(i),{fileName:"BackgroundEditDo.hx",lineNumber:167,className:"bikas.game.BackgroundEditDo",methodName:"create"})}}),Pa.addButton(e,"undo",function(){null!=t.background_edit&&tt.applyUndoOrRedoAction(t.background_edit,t.background,t.background_edit.undo_list,t.background_edit.redo_list)}),Pa.addButton(e,"redo",function(){null!=t.background_edit&&tt.applyUndoOrRedoAction(t.background_edit,t.background,t.background_edit.redo_list,t.background_edit.undo_list)});var i=function(){null!=t.background_edit&&tt.destroy(t.background_edit),t.background_edit=tt.createBackgroundEdit(t,e),tt.addDragAndDropBackgroundEdit(t,t.background_edit)};(t.background_edit=null)!=t.background&&i(),t.temp.levelloads.push(i),t.temp.updates.push(function(){tt.updateBackgroundEdit(t,t.background_edit)})},tt.createBackgroundEdit=function(e,t){var n=new et;n.element=t,n.pointer=e.pointer.main_pointer_object,n.last_saved=Gs.background_objects_source,n.general_elements.push(Pa.addText(t,"Background Edit",!1,!0)),n.general_elements.push(Pa.addBoolEdit(t,n,"editing_enabled")),n.general_elements.push(Pa.addText(t,"Edit Type (X - Horizontal, Y - Vertical, Z - Distance):",!1,!1)),n.general_elements.push(tt.createAndAddBackgroundEditTypeButton(n,$e.EditZX,"ZX").button),n.general_elements.push(tt.createAndAddBackgroundEditTypeButton(n,$e.EditZ,"Z").button),n.general_elements.push(tt.createAndAddBackgroundEditTypeButton(n,$e.EditX,"X").button),n.general_elements.push(tt.createAndAddBackgroundEditTypeButton(n,$e.EditXY,"XY").button),n.general_elements.push(tt.createAndAddBackgroundEditTypeButton(n,$e.EditY,"Y").button),n.general_elements.push(tt.createAndAddBackgroundEditTypeButton(n,$e.EditZXVertical,"ZXVertical").button),n.general_elements.push(tt.createAndAddBackgroundEditTypeButton(n,$e.EditSelect,"Select").button),n.general_elements.push(tt.createAndAddBackgroundEditTypeButton(n,$e.EditSetOriginalZ,"SetOriginalZ").button),n.general_elements.push(Pa.addButtonCustom(t,"Move to Left",function(i){null!=e.background&&(n.move_to_sides=et.move_to_sides_speed,t.onmouseup=function(e){n.move_to_sides=0,t.onmouseup=null})})),n.general_elements.push(Pa.addButtonCustom(t,"Move Camera",function(i){null!=e.background&&(n.camera_drag.x=i.clientX,n.camera_drag.y=i.clientY,n.camera_pos=ya.copy(e.background.camera),n.pressed=!0,t.onmousemove=function(t){n.pressed&&(e.background.camera.x=100*(t.clientX-n.camera_drag.x)+n.camera_pos.x,e.background.camera.y=100*(t.clientY-n.camera_drag.y)+n.camera_pos.y)},t.onmouseup=function(e){n.pressed=!1,t.onmousemove=null,t.onmouseup=null})},null,100,100)),n.general_elements.push(Pa.addButtonCustom(t,"Move to Right",function(i){null!=e.background&&(n.move_to_sides=-et.move_to_sides_speed,t.onmouseup=function(e){n.move_to_sides=0,t.onmouseup=null})})),tt.refreshDrags(n.drags,e.background),n.general_elements.push(Pa.addButton(t,"Update Background",function(){for(var t=0,i=n.descriptions_elements;t<i.length;){var r=i[t];++t,r.remove()}n.descriptions_elements=[];for(var a=0,s=n.positions_elements;a<s.length;){var l=s[a];++a,l.remove()}n.positions_elements=[],Gs.background_objects_source=Xe.serializeBackgroundObjects(e.background.background_objects),Gs.background_objects_obj=Xe.parseBackgroundObjects(Gs.background_objects_source),Xe.overloadBackground(e.background,Gs.background_objects_obj,"default",e.current_level_save.description.name,function(e){return _.field(Gs,e)}),tt.refreshDrags(n.drags,e.background)})),n.general_elements.push(Pa.addButton(t,"Save To File",function(){var t=Xe.serializeBackgroundObjects(e.background.background_objects);Gs.background_objects_source=t,n.last_saved=t;var i="assets/saves/background_objects.txt",r=Vn.createPostRequest("http://localhost:8000",i,"String",Gs.background_objects_source);r.xhr.send(r.json),Nl.trace("sent file to save: "+i,{fileName:"BackgroundEditDo.hx",lineNumber:397,className:"bikas.game.BackgroundEditDo",methodName:"createBackgroundEdit"})})),n.general_elements.push(Pa.addButton(t,"Reload Last Saved",function(){Gs.background_objects_source=n.last_saved,Gs.background_objects_obj=Xe.parseBackgroundObjects(Gs.background_objects_source);for(var t=0,i=n.descriptions_elements;t<i.length;){var r=i[t];++t,r.remove()}n.descriptions_elements=[];for(var a=0,s=n.positions_elements;a<s.length;){var l=s[a];++a,l.remove()}n.positions_elements=[],Xe.overloadBackground(e.background,Gs.background_objects_obj,"default",e.current_level_save.description.name,function(e){return _.field(Gs,e)}),tt.refreshDrags(n.drags,e.background),Nl.trace("background data reloaded",{fileName:"BackgroundEditDo.hx",lineNumber:428,className:"bikas.game.BackgroundEditDo",methodName:"createBackgroundEdit"})}));var i=function(){for(var t=0,i=n.drags;t<i.length;){var r=i[t];++t,tt.updatePositionView(e.background,r,n.undo_list,n.redo_list)}};return n.general_elements.push(Pa.addButton(t,"Edit Descriptions (no undo)",function(){var r=Pa.addScrollBox(t,420,250);n.descriptions_elements.push(r);for(var a=0,s=e.background.background_objects.descriptions;a<s.length;){var l=s[a];++a;var o=Pa.addFieldEdit(r,l,"name");null!=n.last_drag&&l.name==n.last_drag.object_description.name&&(o.style.fontWeight="700"),n.descriptions_elements.push(o),n.descriptions_elements.push(Pa.addFieldEdit(r,l,"scale_z"," --- scale_z",null,i)),n.descriptions_elements.push(Pa.addFieldEdit(r,l,"offset_x"," --- offset_x",null,i)),n.descriptions_elements.push(Pa.addFieldEdit(r,l,"offset_y"," --- offset_y",null,i))}n.descriptions_elements.push(Pa.addButton(t,"Remove Descriptions",function(){for(var e=0,t=n.descriptions_elements;e<t.length;){var i=t[e];++e,i.remove()}n.descriptions_elements=[]}))})),n.general_elements.push(Pa.addButton(t,"Edit Positions (no undo)",function(){var r=Pa.addScrollBox(t,420,250);n.positions_elements.push(r);for(var a=0,l=e.background.level.positions;a<l.length;){var o=[l[a]];++a;var _=[Pa.addFieldEdit(r,o[0],"name")];null!=n.last_drag&&o[0].name==n.last_drag.object_position.name&&(_[0].style.fontWeight="700");var p=[Pa.addFieldEdit(r,o[0],"z","--- z",null,i)],u=[Pa.addFieldEdit(r,o[0],"x","--- x",null,i)],h=[Pa.addFieldEdit(r,o[0],"y","--- y",null,i)];n.positions_elements.push(_[0]),n.positions_elements.push(p[0]),n.positions_elements.push(u[0]),n.positions_elements.push(h[0]),n.positions_elements.push(Pa.addButton(r,"--- remove",function(t,i,r,a,l){return function(){s.remove(n.positions_elements,a[0]),s.remove(n.positions_elements,r[0]),s.remove(n.positions_elements,i[0]),s.remove(n.positions_elements,t[0]),a[0].remove(),r[0].remove(),i[0].remove(),t[0].remove();for(var o=0,_=n.drags;o<_.length;){var p=_[o];if(++o,p.object_position==l[0]){tt.removeDragObject(e.background_edit,e.background,p,n.undo_list,n.redo_list);break}}}}(h,u,p,_,o)))}n.positions_elements.push(Pa.addButton(t,"Remove Positions",function(){for(var e=0,t=n.positions_elements;e<t.length;){var i=t[e];++e,i.remove()}n.positions_elements=[]}))})),n},tt.addDragAndDropBackgroundEdit=function(e,t){for(var n=0,i=e.background.background_objects.descriptions;n<i.length;){var r=i[n];++n;for(var a=tt.getSpriteNameWithoutScale(r.name),s=!1,l=0,o=t.drops;l<o.length;){var _=o[l];if(++l,a==tt.getSpriteNameWithoutScale(_.description.name)){s=!0;break}}if(!s){var p=new He;p.description=r,p.sprite=qa.createSpriteByName(p.description.name,0,0),t.drops.push(p)}}t.drop_container=qa.createGroup();for(var u=He.spacing,h=He.spacing,c=0,d=0,m=t.drops;d<m.length;){var f=m[d];++d;var g=f.sprite.width/f.sprite.height,v=f.sprite.height/f.sprite.width;f.sprite.height=v<g?(f.sprite.width=He.max_size,He.max_size/g):(f.sprite.width=He.max_size/v,He.max_size),f.sprite.x=u,f.sprite.y=h,u+=He.max_size+He.spacing,He.count_per_row<++c&&(c=0,h+=He.max_size+(u=He.spacing)),t.drop_container.add(f.sprite)}t.drop_container_original_width=t.drop_container.width,t.drop_container_original_height=t.drop_container.height,t.drop_background=qa.createSprite(Gs.menu_background,0,0),t.drop_background.alpha=1,t.drop_background.x=-He.spacing,t.drop_background.y=-He.spacing,t.drop_background.width=t.drop_container_original_width+4*He.spacing,t.drop_background.height=t.drop_container_original_height+4*He.spacing,t.drop_container.addAt(t.drop_background,0),e.menu_container.add(t.drop_container)},tt.destroy=function(e){for(var t=0,n=e.general_elements;t<n.length;){var i=n[t];++t,i.remove()}for(var r=0,a=e.descriptions_elements;r<a.length;){var s=a[r];++r,s.remove()}for(var l=0,o=e.positions_elements;l<o.length;){var _=o[l];++l,_.remove()}for(var p=0,u=e.drops;p<u.length;){var h=u[p];++p,h.sprite.parent.removeChild(h.sprite),h.sprite.destroy(!0)}e.drop_container.destroy(!0),e.drop_container=null,e.element=null,e.camera_drag=null,e.camera_pos=null,e.basic=null,e.drags=null,e.current_drag=null,e.last_drag=null,e.background_edit_type_buttons=null,e.general_elements=null,e.descriptions_elements=null,e.positions_elements=null,e.drops=null},tt.updateBackgroundEdit=function(e,t){if(null!=e.background&&null!=e.background_edit){var n=t.pointer,i=e.step.dc,r=e.js_info;if(0<Math.abs(t.move_to_sides)&&(e.background.camera.x+=t.move_to_sides*i),null!=t.drop_container&&(t.js_info_last_width!=r.current_game_width||t.js_info_last_height!=r.current_game_height)){t.js_info_last_width=r.current_game_width,t.js_info_last_height=r.current_game_height;var a=He.max_width_offset+r.current_game_width,s=He.max_height,l=a/t.drop_container_original_width,o=s/t.drop_container_original_height;t.drop_container.height=l<o?(t.drop_container.width=t.drop_container_original_width*l,t.drop_container_original_height*l):(t.drop_container.width=t.drop_container_original_width*o,t.drop_container_original_height*o),t.drop_container.x=He.offset_x,t.drop_container.y=He.offset_y}var _=t.editing_enabled&&!Ii.isPressed(e.keyboard_keys_pressed,16);if(t.drop_container.visible=!!_,_){var p=$s.right_mouse_button_down;if(!p&&null!=t.right_mouse_down_point){var u=tt.getClosestSpriteOverPointer(n,t.drags);if(null!=u)return tt.removeDragObject(t,e.background,u,t.undo_list,t.redo_list),void(t.right_mouse_down_point=null)}t.right_mouse_down_point=p?n.current:null}if(n.state==Ja.DOWNED&&_){var h=tt.getClosestDropOverPointer(n,t.drops);if(null!=h){var c=h.description,d=e.background.eye,m=e.background.camera,f=n.current,g=Xe.getPlaneY(e.background),v=ya.getPointZUsingY(f,d,m,g),b=ya.getPointXUsingZ(f,d,m,v),y=new Ve;y.name=c.name,y.x=b,y.y=0,y.z=v;for(var x=tt.pushNewBackgroundPositionObject(t,e.background,c,y,t.undo_list,t.redo_list),z=0,w=t.drags;z<w.length;){var k=w[z];if(++z,k.sprite==x){t.current_drag=k;break}}}if(null==h&&(t.current_drag=tt.getClosestSpriteOverPointer(n,t.drags)),null!=t.current_drag)if(t.last_drag=t.current_drag,t.type==$e.EditSelect)null!=t.current_drag&&(t.current_drag=null);else if(t.type==$e.EditSetOriginalZ)null!=t.current_drag&&(t.current_drag.sprite.position.z=t.current_drag.object_description.scale_z,xa.set(t.current_drag.sprite.init_position,t.current_drag.sprite.position),_s.updateSpritePoints(t.current_drag.sprite),Xe.updateSpriteOrderAfterZChanged(e.background,t.current_drag.sprite),tt.updatePosition(e.background,t.current_drag,t.undo_list,t.redo_list),t.current_drag=null);else{var S=ya.getProjectionWithCamera(e.background.eye,e.background.camera,t.current_drag.sprite.position);t.current_drag.offset.x=S.x-n.current.x,t.current_drag.offset.y=S.y-n.current.y,t.current_drag.init.x=S.x,t.current_drag.init.y=S.y}}if(null!=t.current_drag){var C=n.current.x+t.current_drag.offset.x,N=n.current.y+t.current_drag.offset.y,P=t.current_drag.sprite.position,M=e.background.eye,I=e.background.camera,T=new ea(C,N);if(e.background_edit.type==$e.EditZX)P.z=ya.getPointZUsingY(T,M,I,P.y),P.x=ya.getPointXUsingZ(T,M,I,P.z);else if(e.background_edit.type==$e.EditZ)P.z=ya.getPointZUsingY(T,M,I,P.y);else if(e.background_edit.type==$e.EditX){T.y=t.current_drag.init.y;var A=ya.getPointZUsingY(T,M,I,P.y);P.x=ya.getPointXUsingZ(T,M,I,A)}else e.background_edit.type==$e.EditXY?(P.x=ya.getPointXUsingZ(T,M,I,P.z),P.y=ya.getPointYUsingZ(T,M,I,P.z)):e.background_edit.type==$e.EditY?(T.x=t.current_drag.init.x,P.y=ya.getPointYUsingZ(T,M,I,P.z)):e.background_edit.type==$e.EditZXVertical&&(T.x=t.current_drag.init.x,P.z=ya.getPointZUsingY(T,M,I,P.y),P.x=ya.getPointXUsingZ(T,M,I,P.z));P.z=Math.round(P.z),P.x=Math.round(P.x),P.y=Math.round(P.y),tt.updateDragObjectAfterDrag(t,e.background,t.current_drag)}n.state==Ja.UPPED&&null!=t.current_drag&&null!=t.current_drag.sprite&&null!=t.current_drag.sprite.sprite.parent&&(tt.updatePosition(e.background,t.current_drag,t.undo_list,t.redo_list),t.current_drag=null)}},tt.createAndAddBackgroundEditTypeButton=function(e,t,n){var i=new Ke;i.type=t,i.name=n;var r="#ACACAC",a="#000000";return i.button=Pa.addButton(e.element,n,function(){for(var t=0,n=e.background_edit_type_buttons;t<n.length;){var s=n[t];++t,s.button.style.color=r}e.type=i.type,i.button.style.color=a}),i.button.style.fontWeight="800",t==e.type?i.button.style.color=a:i.button.style.color=r,e.background_edit_type_buttons.push(i),i},tt.updateDragObjectAfterDrag=function(e,t,n){for(var i=n.sprite.position,r=n.lods[0],a=0,s=n.lods;a<s.length;){var l=s[a];++a,Math.abs(i.z-l.scale_z)<Math.abs(i.z-r.scale_z)&&(r=l)}n.object_description!=r&&(_s.replaceSprite(n.sprite,Hs.getTexture(r.name),r.scale_z,t.default_fov_z),n.object_description=r,n.object_position.name=r.name),xa.set(n.sprite.init_position,i),_s.updateSpritePoints(n.sprite),Xe.updateSpriteOrderAfterZChanged(t,n.sprite)},tt.getSpriteNameWithoutScale=function(e){var t=e.indexOf("_scale_");return-1!=t?e.substring(0,t):e},tt.pushNewBackgroundPositionObject=function(e,t,n,i,r,a){t.level.positions.push(i);var s=Xe.pushSprite3D(t,Hs.getTexture(i.name),i.x,i.y,i.z,n.scale_z,n.offset_x,n.offset_y);Xe.insertSpriteToContainer(t,s),t.background_sprites.push(s),t.sprite_and_description_map.set(s,n),t.sprite_and_position_map.set(s,i),tt.refreshDrags(e.drags,t);var l=new Je;return l.description=n,l.original_position=i,l.position=i,l.type=Ye.PositionAdded,r.push(l),null!=a&&a.splice(0,a.length),s},tt.removeDragObject=function(e,t,n,i,r){var a=new Je;a.description=n.object_description,a.original_position=n.object_position,a.position=n.object_position,a.type=Ye.PositionRemoved,i.push(a),s.remove(e.drags,n),e.current_drag==n&&(e.current_drag=null),s.remove(t.level.positions,n.object_position),t.sprite_and_description_map.remove(n.sprite),t.sprite_and_position_map.remove(n.sprite),s.remove(t.background_sprites,n.sprite),s.remove(t.all_sprites,n.sprite),n.sprite.sprite.parent.removeChild(n.sprite.sprite),n.sprite.sprite.destroy(!0),null!=r&&r.splice(0,r.length)},tt.applyUndoOrRedoAction=function(e,t,n,i){if(0!=n.length){for(var r=n.pop(),a=null,s=0,l=e.drags;s<l.length;){var o=l[s];if(++s,o.object_position==r.original_position){a=o;break}}if(r.type==Ye.PositionChanged)if(null!=a){var _=Math.round(r.position.x+a.object_description.offset_x),u=Math.round(r.position.y+Xe.getPlaneY(t)+a.object_description.offset_y),h=Math.round(r.position.z);a.sprite.position.x=_,a.sprite.position.y=u,a.sprite.position.z=h,tt.updatePosition(t,a,i),tt.updateDragObjectAfterDrag(e,t,a)}else Nl.trace("warning: drag object not found for "+r.position.name,{fileName:"BackgroundEditDo.hx",lineNumber:1034,className:"bikas.game.BackgroundEditDo",methodName:"applyUndoOrRedoAction"});else r.type==Ye.PositionAdded?null!=a?tt.removeDragObject(e,t,a,i):Nl.trace("warning: drag object not found for "+r.position.name,{fileName:"BackgroundEditDo.hx",lineNumber:1043,className:"bikas.game.BackgroundEditDo",methodName:"applyUndoOrRedoAction"}):r.type==Ye.PositionRemoved?tt.pushNewBackgroundPositionObject(e,t,r.description,r.position,i):Nl.trace("warning: unhandled "+p.string(r.type),{fileName:"BackgroundEditDo.hx",lineNumber:1053,className:"bikas.game.BackgroundEditDo",methodName:"applyUndoOrRedoAction"})}},tt.refreshDrags=function(e,t){var n=t.background_sprites,i=t.background_objects.descriptions;e.splice(0,e.length);for(var r=0;r<n.length;){var a=n[r];++r;var s=new Qe(a);s.object_description=t.sprite_and_description_map.get(a),s.object_position=t.sprite_and_position_map.get(a),s.lods.push(s.object_description);for(var l=s.object_description.name,o=tt.getSpriteNameWithoutScale(l),_=0;_<i.length;){var p=i[_];++_;var u=tt.getSpriteNameWithoutScale(p.name);p.name!=l&&o==u&&s.lods.push(p)}e.push(s)}},tt.updatePositionView=function(e,t,n,i){var r=t.object_position.x+t.object_description.offset_x,a=t.object_position.y+Xe.getPlaneY(e)+t.object_description.offset_y,s=t.object_position.z,l=t.sprite.position;l.x=r,l.y=a,l.z=s,xa.set(t.sprite.init_position,l),_s.updateSpritePoints(t.sprite),Xe.updateSpriteOrderAfterZChanged(e,t.sprite)},tt.updatePosition=function(e,t,n,i){var r=t.sprite.position,a=Math.round(r.x-t.object_description.offset_x),s=Math.round(r.y-Xe.getPlaneY(e)-t.object_description.offset_y),l=Math.round(r.z),o=t.object_position;if(o.z!=l||o.x!=a||o.y!=s){var _=new Je;_.description=t.object_description,_.original_position=o,_.position=new Ve,_.position.name=o.name,_.position.x=o.x,_.position.y=o.y,_.position.z=o.z,_.type=Ye.PositionChanged,n.push(_),null!=i&&i.splice(0,i.length)}o.z=l,o.x=a,o.y=s},tt.getClosestDropOverPointer=function(e,t){for(var n=0;n<t.length;){var i=t[n];++n;var r=e.current,a=qa.getContainerBounds(i.sprite);if(ma.pointInRectangle(r,a))return i}return null},tt.getClosestSpriteOverPointer=function(e,t){for(var n=[],i=0;i<t.length;){var r=t[i];++i;var a=e.current,s=r.sprite.sprite,l=qa.getContainerBounds(s);ma.pointInRectangle(a,l)&&(qa.isSprite(s)&&Nl.trace("TODO: detect pixels under mouse",{fileName:"BackgroundEditDo.hx",lineNumber:1220,className:"bikas.game.BackgroundEditDo",methodName:"getClosestSpriteOverPointer"}),n.push(r))}if(0<n.length){for(var o=n[0],_=0;_<n.length;){var p=n[_];++_,p.sprite.position.z<o.sprite.position.z&&(o=p)}return o}return null};var nt=function(e,t,n,i){this.min=e,this.mid=t,this.max=n,this.current=i};(n["bikas.game.Range"]=nt).__name__=["bikas","game","Range"],nt.prototype={min:null,mid:null,max:null,current:null,__class__:nt};var it=function(){this.count_to_zero=0,this.count=0,this.direction=1};(n["bikas.game.FastestRotation"]=it).__name__=["bikas","game","FastestRotation"],it.prototype={direction:null,count:null,count_to_zero:null,__class__:it};var rt=function(e,t,n,i){null==i&&(i=.1),null==n&&(n=.8),null==t&&(t=.3),null==e&&(e=.9),this.panic=new nt(0,.5,1,.1),this.crazyness=new nt(0,.5,1,.8),this.aggression=new nt(0,.5,1,.3),this.ability=new nt(0,.5,1,.9),this.ability.current=e,this.aggression.current=t,this.crazyness.current=n,this.panic.current=i};(n["bikas.game.Personality"]=rt).__name__=["bikas","game","Personality"],rt.prototype={ability:null,aggression:null,crazyness:null,panic:null,__class__:rt};var at=function(e,t,n,i){this.target_mood=e,this.coeff=t,this.duration=i,this.end_time_stamp=n+i};(n["bikas.game.MoodEvent"]=at).__name__=["bikas","game","MoodEvent"],at.prototype={target_mood:null,coeff:null,duration:null,end_time_stamp:null,update:function(e){var t=(this.end_time_stamp-e)/this.duration;return t<0?(this.target_mood.current=this.target_mood.min,!1):(this.target_mood.current=this.target_mood.min+t*this.coeff*(this.target_mood.max-this.target_mood.min),!0)},__class__:at};var st=function(){this.on_stop=null,this.decision_end_time_stamp=0,this.decision_made_time_stamp=0,this.in_progress=!1,this.allow=!0};(n["bikas.game.Decision"]=st).__name__=["bikas","game","Decision"],st.prototype={allow:null,in_progress:null,make_every:null,do_for:null,decision_made_time_stamp:null,decision_end_time_stamp:null,on_stop:null,__class__:st};var lt=function(){this.rotation_direction_cache=1,this.starting_angle_cache=0,this.additional_started=!1,this.initial_started=!1,st.call(this),this.make_every=new nt(.03333333333333333,.1,.3,.1),this.do_for=new nt(2,4,6,4)};(n["bikas.game.UnstuckDecision"]=lt).__name__=["bikas","game","UnstuckDecision"],lt.__super__=st,lt.prototype=r(st.prototype,{initial_started:null,additional_started:null,starting_angle_cache:null,rotation_direction_cache:null,__class__:lt});var ot=function(){this.recover_mode=!1,this.fastest_way_cache=null,this.rotation_trigger=.16666666666666666*Math.PI,this.wheels_off_time_min=.2,st.call(this),this.make_every=new nt(.03333333333333333,.5,2,.03333333333333333),this.do_for=new nt(5,8,10,8)};(n["bikas.game.AirRotationDecision"]=ot).__name__=["bikas","game","AirRotationDecision"],ot.__super__=st,ot.prototype=r(st.prototype,{wheels_off_time_min:null,rotation_trigger:null,fastest_way_cache:null,recover_mode:null,rotate_until_angle:null,rotate_direction:null,__class__:ot});var _t=function(){this.wheel_index_cache=0,this.angular_velocity_trigger_max=1,this.rotation_trigger=Math.PI/12,this.other_wheel_off_time=.06666666666666667,this.main_wheel_off_time=.2,st.call(this),this.make_every=new nt(.2,.3,.4,.3),this.do_for=new nt(.016666666666666666,.03333333333333333,.05,.016666666666666666)};(n["bikas.game.GroundRotationDecision"]=_t).__name__=["bikas","game","GroundRotationDecision"],_t.__super__=st,_t.prototype=r(st.prototype,{main_wheel_off_time:null,other_wheel_off_time:null,rotation_trigger:null,angular_velocity_trigger_max:null,wheel_index_cache:null,__class__:_t});var pt=function(){this.direction_cache=1,st.call(this),this.make_every=new nt(.5,2,4,2),this.do_for=new nt(.016666666666666666,.06666666666666667,.1,.016666666666666666)};(n["bikas.game.RandomRotationDecision"]=pt).__name__=["bikas","game","RandomRotationDecision"],pt.__super__=st,pt.prototype=r(st.prototype,{direction_cache:null,__class__:pt});var ut=function(){this.chance_of_activation=new nt(.1,.5,1,.5),st.call(this),this.make_every=new nt(3,15,30,15)};(n["bikas.game.RandomJumpDecision"]=ut).__name__=["bikas","game","RandomJumpDecision"],ut.__super__=st,ut.prototype=r(st.prototype,{chance_of_activation:null,__class__:ut});var ht=function(){this.angle_progress_cache=0,this.angle_cache=0,this.direction_cache=1,this.distance_from_ground_min=new nt(350,500,1200,350),this.air_time_min=new nt(.1,.2,.5,.2),this.rotation_max=Math.PI/6,this.velocity_down_max=200,st.call(this),this.make_every=new nt(.2,1,2,.2),this.do_for=new nt(100,100,100,100)};(n["bikas.game.FlipDecision"]=ht).__name__=["bikas","game","FlipDecision"],ht.__super__=st,ht.prototype=r(st.prototype,{velocity_down_max:null,rotation_max:null,air_time_min:null,distance_from_ground_min:null,direction_cache:null,angle_cache:null,angle_progress_cache:null,__class__:ht});var ct=function(){this.chance_of_wheelie=new nt(.2,.5,1,.5),this.wheel_index_cache=0,this.current_rotation_target=.1111111111111111*Math.PI,this.rotation_ok_range=.027777777777777776*Math.PI,this.rotation_target_max=.16666666666666666*Math.PI,this.rotation_target_min=.08333333333333333*Math.PI,this.back_wheel_chance_coeff=.7,this.stable_drive_time=new nt(.5,1.5,4,.5),this.velocity_to_max_coeff_action_cut_min=.8,this.velocity_to_max_coeff_min=.5,this.car_angle_max=5*Math.PI/180,this.accumulated_angle_max=5,st.call(this),this.make_every=new nt(2,4,8,3),this.do_for=new nt(2,3,5,4.4)};(n["bikas.game.WheelieDecision"]=ct).__name__=["bikas","game","WheelieDecision"],ct.__super__=st,ct.prototype=r(st.prototype,{accumulated_angle_max:null,car_angle_max:null,velocity_to_max_coeff_min:null,velocity_to_max_coeff_action_cut_min:null,stable_drive_time:null,back_wheel_chance_coeff:null,rotation_target_min:null,rotation_target_max:null,rotation_ok_range:null,current_rotation_target:null,wheel_index_cache:null,chance_of_wheelie:null,__class__:ct});var dt=function(){this.stable_drive_time=new nt(.03333333333333333,.1,.4,.03333333333333333),st.call(this),this.make_every=new nt(.2,1.5,5,.1),this.do_for=new nt(.3,.7,1,.3)};(n["bikas.game.NitroDecision"]=dt).__name__=["bikas","game","NitroDecision"],dt.__super__=st,dt.prototype=r(st.prototype,{stable_drive_time:null,__class__:dt});var mt=function(){this.chance_of_jump=null,st.call(this),this.make_every=new nt(.1,.3,2,.1)};(n["bikas.game.JumpDecision"]=mt).__name__=["bikas","game","JumpDecision"],mt.__super__=st,mt.prototype=r(st.prototype,{chance_of_jump:null,__class__:mt});var ft=function(){st.call(this),this.make_every=new nt(.1,.3,.5,.1)};(n["bikas.game.AbilityDecision"]=ft).__name__=["bikas","game","AbilityDecision"],ft.__super__=st,ft.prototype=r(st.prototype,{__class__:ft});var gt=function(){this.calculation_time_stamp=0,this.count=0,this.total_velocity=0,this.average_velocity=-1};(n["bikas.game.AverageVelocity"]=gt).__name__=["bikas","game","AverageVelocity"],gt.prototype={average_velocity:null,total_velocity:null,count:null,calculation_time_stamp:null,__class__:gt};var vt=function(){this.average_velocity=new gt,this.front_wheel_off_time=0,this.back_wheel_off_time=0,this.body_collide_time_stamp=0,this.front_wheel_not_collide_time_stamp=0,this.back_wheel_not_collide_time_stamp=0,this.accumulated_angle=0,this.accumulated_angle_check=new st,this.movement_vector=y_.get(),this.angle_changes=[],this.current_position_delta=y_.get(),this.previous_position_delta=y_.get(),this.last_position=y_.get()};(n["bikas.game.BotCache"]=vt).__name__=["bikas","game","BotCache"],vt.prototype={body_angle:null,body_angle_before:null,last_position:null,previous_position_delta:null,current_position_delta:null,angle_changes:null,movement_vector:null,accumulated_angle_check:null,accumulated_angle:null,back_wheel_not_collide_time_stamp:null,front_wheel_not_collide_time_stamp:null,body_collide_time_stamp:null,back_wheel_off_time:null,front_wheel_off_time:null,stable_drive_time_stamp:null,stable_drive_time:null,wheels_off_time:null,distance_x_changed_in_frame:null,average_velocity:null,__class__:vt};var bt=function(){this.ray_cache=null,this.temp_point=y_.get(0,0),this.drive_direction=1,this.finish_time_in_seconds=-1,this.personality_applied=!1,this.constant_drive=!0,this.finished_race=!1,this.behavior_activated=!0,this.active_decisions=[],this.all_decisions=[],this.stunt_decisions=[],this.drive_decisions=[],this.ability_decision=null,this.jump_pickup_decision=null,this.jump_over_decision=null,this.nitro_decision=null,this.wheelie_decision=null,this.flip_decision=null,this.random_jump_decision=null,this.random_rotation_decision=null,this.ground_decision=null,this.air_decision=null,this.unstuck_decision=null,this.mood_events=[]};(n["bikas.game.Bot"]=bt).__name__=["bikas","game","Bot"],bt.prototype={car:null,config:null,cache:null,bot_cache:null,abilities:null,personality:null,mood_events:null,unstuck_decision:null,air_decision:null,ground_decision:null,random_rotation_decision:null,random_jump_decision:null,flip_decision:null,wheelie_decision:null,nitro_decision:null,jump_over_decision:null,jump_pickup_decision:null,ability_decision:null,drive_decisions:null,stunt_decisions:null,all_decisions:null,active_decisions:null,behavior_activated:null,finished_race:null,constant_drive:null,personality_applied:null,finish_time_in_seconds:null,drive_direction:null,current_would_jump_over:null,current_would_not_jump_over:null,current_would_pickup:null,current_would_not_pickup:null,temp_point:null,ray_cache:null,__class__:bt};var yt=function(){};(n["bikas.game.BotDo"]=yt).__name__=["bikas","game","BotDo"],yt.createBot=function(e,t,n,i,r){var a=new bt;a.car=e,a.config=t,a.cache=n,a.abilities=i,a.personality=r;var s=a.bot_cache=new vt;s.accumulated_angle_check.make_every=new nt(.5,.5,.5,.5),e.main_body;for(var l=0;l<60;)l++,s.angle_changes.push(0);return a.ray_cache=new f_(y_.get(),y_.get()),a.ray_cache.get_direction().set_x(0),a.ray_cache.get_direction().set_y(1),a.unstuck_decision=new lt,a.air_decision=new ot,a.ground_decision=new _t,a.random_rotation_decision=new pt,a.random_jump_decision=new ut,a.flip_decision=new ht,a.wheelie_decision=new ct,a.nitro_decision=new dt,a.jump_over_decision=new mt,a.jump_over_decision.make_every=new nt(.05,.1,.2,.1),a.jump_over_decision.chance_of_jump=new nt(.5,.75,1,.75),a.jump_pickup_decision=new mt,a.jump_pickup_decision.make_every=new nt(.1,.2,.5,.1),a.jump_pickup_decision.chance_of_jump=new nt(.6,.8,1,.8),a.ability_decision=new ft,a.all_decisions=[a.unstuck_decision,a.air_decision,a.ground_decision,a.random_rotation_decision,a.random_jump_decision,a.flip_decision,a.wheelie_decision,a.nitro_decision,a.jump_over_decision,a.jump_pickup_decision,a.ability_decision],a.stunt_decisions=[a.flip_decision,a.wheelie_decision],a.drive_decisions=[a.air_decision,a.ground_decision],a.active_decisions=[],a.constant_drive=!0,a},yt.destroy=function(e){if(null!=e.abilities&&(Ae.destroyAbilities(e.abilities),e.abilities=null),null!=e.bot_cache){var t=e.bot_cache;null!=t.last_position&&(t.last_position.dispose(),t.last_position=null),null!=t.current_position_delta&&(t.current_position_delta.dispose(),t.previous_position_delta.dispose()),t.current_position_delta=null,(t.previous_position_delta=null)!=t.movement_vector&&(t.movement_vector.dispose(),t.movement_vector=null),e.bot_cache=null}null!=e.temp_point&&(e.temp_point.dispose(),e.temp_point=null),null!=e.ray_cache&&(e.ray_cache.get_origin().dispose(),e.ray_cache.get_direction().dispose(),e.ray_cache=null),Mt.destroy(e.car,e.config,e.cache),e.car=null,e.config=null,e.cache=null,e.abilities=null,e.personality=null,e.mood_events=null,e.all_decisions=null,e.active_decisions=null,e.current_would_jump_over=null,e.current_would_not_jump_over=null,e.current_would_pickup=null,e.current_would_not_pickup=null},yt.findFastestRotation=function(e,t,n,i){n<t?t=n:t<-n&&(t=n);var r=0,a=0,s=t,l=0;for(a=0<e?2*Math.PI-e:-e;0<a;)if(++l,a-=s,n<(s+=i)&&(s=n),a-(s*s*.5/i+.5*s)<=0){(r=Math.round(s/i))<0&&(r=0);break}a=0<e?e:2*Math.PI+e,s=t;for(var o=0,_=0;0<a;)if(++o,a+=s,(s-=i)<-n&&(s=-n),a-(s*s*.5/i-.5*s)<=0){(_=Math.round(-s/i))<0&&(_=0);break}var p=new it;return p.count_to_zero=l+r<=o+_?(p.direction=1,p.count=l,r):(p.direction=-1,p.count=o,_),p},yt.getRotationCountUntilZeroAngle=function(e,t,n,i,r,a){var s=i*r*a;n*=a;for(var l=0,o=1e3;;){if(o--<0)return Nl.trace("warning: loop broke",{fileName:"BotDo.hx",lineNumber:259,className:"bikas.game.BotDo",methodName:"getRotationCountUntilZeroAngle"}),0;if(n<(t+=s)?t=n:t<-n&&(t=-n),++l,(e=yt.normalizeAngle(e+=t))<=n&&-n<=e)return l}},yt.getClosestRotationDirection=function(e,t){var n=e.bot_cache.body_angle,i=e.car.main_body.get_angularVel(),r=e.config.rotation_angular_velocity_max,a=(e.config.rotation_angular_impulse_coeff,yt.getRotationCountUntilZeroAngle(n,i,r,1,e.car.total_inertia,t));return yt.getRotationCountUntilZeroAngle(n,i,r,-1,e.car.total_inertia,t)<a?-1:1},yt.normalizeAngle=function(e){var t=Qr.PI2;return(e=(e%t+t)%t)>Math.PI&&(e-=t),e},yt.shouldMakeDecision=function(e,t){return null!=e&&!!e.allow&&!e.in_progress&&t-e.decision_made_time_stamp>=e.make_every.current&&(e.decision_made_time_stamp=t,!0)},yt.isInRangeFromOtherCar=function(e,t,n,i){for(var r=0;r<t.length;){var a=t[r];if(++r,a!=e){var s=a.main_body_position_x-e.main_body_position_x;if(n<=s&&s<=i)return!0}}return!1},yt.gatherAndProcessData=function(e,t,n,i,r,a,s){n.body_angle_before=n.body_angle,n.body_angle=yt.normalizeAngle(e.main_body.get_rotation()),n.distance_x_changed_in_frame=e.main_body_position_x-n.last_position.get_x(),n.angle_changes.shift(),n.previous_position_delta.set_x(n.current_position_delta.get_x()),n.previous_position_delta.set_y(n.current_position_delta.get_y()),n.current_position_delta.set_x(e.main_body_position_x-n.last_position.get_x()),n.current_position_delta.set_y(e.main_body_position_y-n.last_position.get_y());var l=n.previous_position_delta,o=n.current_position_delta,_=o.cross(l),p=o.dot(l),u=Math.atan2(_,p);if(n.angle_changes.push(u),n.last_position.set_x(e.main_body_position_x),n.last_position.set_y(e.main_body_position_y),yt.shouldMakeDecision(n.accumulated_angle_check,a)){for(var h=n.accumulated_angle=0,c=n.angle_changes;h<c.length;){var d=c[h];++h,n.accumulated_angle+=d*r}n.accumulated_angle*=1/Math.PI*180}t.body_collide&&(n.body_collide_time_stamp=a),t.back_collide?n.back_wheel_not_collide_time_stamp=0:0==n.back_wheel_not_collide_time_stamp&&(n.back_wheel_not_collide_time_stamp=a),t.front_collide?n.front_wheel_not_collide_time_stamp=0:0==n.front_wheel_not_collide_time_stamp&&(n.front_wheel_not_collide_time_stamp=a),n.back_wheel_off_time=0,(n.front_wheel_off_time=0)<n.back_wheel_not_collide_time_stamp&&(n.back_wheel_off_time=a-n.back_wheel_not_collide_time_stamp),0<n.front_wheel_not_collide_time_stamp&&(n.front_wheel_off_time=a-n.front_wheel_not_collide_time_stamp),.2<n.back_wheel_off_time||.2<n.front_wheel_off_time?n.stable_drive_time_stamp=0:0==n.stable_drive_time_stamp&&(n.stable_drive_time_stamp=a),0==n.stable_drive_time_stamp?n.stable_drive_time=0:n.stable_drive_time=a-n.stable_drive_time_stamp,n.back_wheel_off_time<n.front_wheel_off_time?n.wheels_off_time=n.back_wheel_off_time:n.wheels_off_time=n.front_wheel_off_time;var m=n.average_velocity;i?(m.count++,m.total_velocity+=e.main_body.get_velocity().get_length(),a>=m.calculation_time_stamp+gt.time_frame&&(m.average_velocity=m.total_velocity/m.count,m.calculation_time_stamp=a,m.total_velocity=0,m.count=0)):(m.calculation_time_stamp=a+2,m.average_velocity=-1,m.total_velocity=0,m.count=0)},yt.pushToActiveDecisions=function(e,t,n){-1==e.indexOf(t)&&(t.decision_end_time_stamp=n+t.do_for.current,t.in_progress=!0,e.push(t))},yt.inProgress=function(e){return null!=e&&!!e.allow&&e.in_progress},yt.applyRange=function(e,t){var n=e.current;t.current=n<=.5?t.min+(t.mid-t.min)*n*2:t.mid+(t.max-t.mid)*(n-.5)*2},yt.applyInvertedRange=function(e,t){var n=1-e.current;t.current=n<=.5?t.min+(t.mid-t.min)*n*2:t.mid+(t.max-t.mid)*(n-.5)*2},yt.addPanicMoodEvent=function(e,t,n){t.push(new at(e.panic,1,n,3))},yt.update=function(e,t,n,i,r,a,s,l,o,_,p,u){var h=s.dc,c=s.level_seconds,d=s.step_size;Mt.updateState(h,e.car,e.cache),yt.gatherAndProcessData(e.car,e.cache,e.bot_cache,e.behavior_activated,h,c,d),e.behavior_activated&&(e.personality_applied||(yt.updateDecisionInfluence(e,e.personality),e.personality_applied=!0),0==i.type&&0==i.development.bot_decisions_enabled||yt.updateDecisionMaking(e,t,n,r,a,s,l,o,_,p,u),e.constant_drive&&Mt.drive(e.car,e.config,e.cache,h),yt.updateActiveDecisions(e,n,s))},yt.updateDecisionInfluence=function(e,t){e.air_decision.allow&&yt.applyInvertedRange(t.ability,e.air_decision.make_every),e.ground_decision.allow&&yt.applyInvertedRange(t.ability,e.ground_decision.make_every),e.random_rotation_decision.allow&&yt.applyInvertedRange(t.panic,e.random_rotation_decision.make_every),e.random_jump_decision.allow&&(yt.applyInvertedRange(t.panic,e.random_jump_decision.make_every),yt.applyRange(t.panic,e.random_jump_decision.chance_of_activation)),e.flip_decision.allow&&(yt.applyInvertedRange(t.crazyness,e.flip_decision.make_every),yt.applyInvertedRange(t.crazyness,e.flip_decision.air_time_min),yt.applyInvertedRange(t.crazyness,e.flip_decision.distance_from_ground_min)),e.wheelie_decision.allow&&(yt.applyInvertedRange(t.crazyness,e.wheelie_decision.make_every),yt.applyInvertedRange(t.crazyness,e.wheelie_decision.stable_drive_time),yt.applyRange(t.crazyness,e.wheelie_decision.chance_of_wheelie)),e.nitro_decision.allow&&(yt.applyInvertedRange(t.ability,e.nitro_decision.do_for),yt.applyInvertedRange(t.crazyness,e.nitro_decision.make_every),yt.applyInvertedRange(t.crazyness,e.nitro_decision.stable_drive_time)),e.jump_over_decision.allow&&(yt.applyInvertedRange(t.ability,e.jump_over_decision.make_every),yt.applyRange(t.ability,e.jump_over_decision.chance_of_jump)),e.jump_pickup_decision.allow&&(yt.applyInvertedRange(t.ability,e.jump_pickup_decision.make_every),yt.applyRange(t.ability,e.jump_pickup_decision.chance_of_jump))},yt.tryUnstuckDecision=function(e,t){0<=e.bot_cache.average_velocity.average_velocity&&e.bot_cache.average_velocity.average_velocity<=lt.min_average_velocity_threshold&&(e.unstuck_decision.initial_started=!1,e.unstuck_decision.additional_started=!1,yt.pushToActiveDecisions(e.active_decisions,e.unstuck_decision,t))},yt.tryAirDecision=function(e,t,n){e.bot_cache.wheels_off_time>=e.air_decision.wheels_off_time_min&&Math.abs(e.bot_cache.body_angle)>e.air_decision.rotation_trigger&&(t<e.bot_cache.body_collide_time_stamp+.1&&Math.abs(e.bot_cache.body_angle)>.25*Math.PI&&(e.air_decision.recover_mode||(e.air_decision.recover_mode=!0,e.air_decision.rotate_direction=yt.getClosestRotationDirection(e,n),e.air_decision.rotate_until_angle=ma.getRandomBetween(ot.rotate_until_angle_min,ot.rotate_until_angle_max))),yt.pushToActiveDecisions(e.active_decisions,e.air_decision,t))},yt.tryGroundDecision=function(e,t){var n=e.bot_cache,i=e.ground_decision;n.back_wheel_off_time>i.main_wheel_off_time&&n.front_wheel_off_time<i.other_wheel_off_time&&n.body_angle>i.rotation_trigger&&e.car.main_body.get_angularVel()>=-i.angular_velocity_trigger_max?(i.wheel_index_cache=0,yt.pushToActiveDecisions(e.active_decisions,i,t)):n.front_wheel_off_time>i.main_wheel_off_time&&n.back_wheel_off_time<i.other_wheel_off_time&&-n.body_angle>-i.rotation_trigger&&e.car.main_body.get_angularVel()<=i.angular_velocity_trigger_max&&(i.wheel_index_cache=1,yt.pushToActiveDecisions(e.active_decisions,i,t))},yt.tryFlipDecision=function(e,t){var n=e.bot_cache,i=e.flip_decision;if(n.wheels_off_time>=i.air_time_min.current&&n.body_angle<i.rotation_max&&n.body_angle>-i.rotation_max){e.ray_cache.get_origin().set_x(e.car.main_body_position_x),e.ray_cache.get_origin().set_y(e.car.main_body_position_y);var r=e.car.main_body.get_space().rayCast(e.ray_cache,!1,Si.ray_to_ground);if(null!=r){var a=!1;if(0<e.config.rotation_angular_impulse_coeff){for(var s=66/e.config.rotation_angular_impulse_coeff,l=Math.round(ma.clamp(s,30,300)),o=r.get_distance(),_=e.car.main_body.get_position().get_y()+o,p=e.car.main_body.get_space().get_gravity().get_y()/3600,u=e.car.main_body.get_velocity().get_y()/60,h=e.car.main_body.get_position().get_y(),c=0,d=l;c<d&&(c++,!(_<(h+=u+=p))););h<_&&(a=!0)}a&&(i.direction_cache=2*Math.round(Math.random())-1,i.angle_cache=n.body_angle,i.angle_progress_cache=0,yt.pushToActiveDecisions(e.active_decisions,i,t)),r.dispose()}}},yt.tryWheelieDecision=function(e,t){var n=e.bot_cache;if(n.stable_drive_time>e.wheelie_decision.stable_drive_time.current){var i=e.wheelie_decision;if(Math.abs(n.body_angle)<=i.car_angle_max&&Math.random()<i.chance_of_wheelie.current&&e.car.main_body.get_velocity().get_length()/e.config.drive_velocity_max>=i.velocity_to_max_coeff_min){var r=Math.random();i.current_rotation_target=ma.getRandomBetween(i.rotation_target_min,i.rotation_target_max),r<=i.back_wheel_chance_coeff?(i.wheel_index_cache=0,i.current_rotation_target*=-1):(i.wheel_index_cache=1,i.current_rotation_target*=1),yt.pushToActiveDecisions(e.active_decisions,i,t)}}},yt.tryJumpOverDecision=function(e,t,n){for(var i=e.car.main_body_position_x+e.car.main_body.get_velocity().get_x()*e.config.info_max_height_jump_time,r=0;r<n.length;){var a=n[r];if(++r,null!=a.get_space()&&!(e.car.main_body_position_x>a.get_position().get_x()-50||Math.abs(a.get_position().get_x()-i)>100+e.bot_cache.distance_x_changed_in_frame)){var s=!1;if(0<a.get_shapes().get_length()&&a.get_shapes().at(0).get_filter().shouldCollide(Si.car_body)&&(s=!0),s){a!=e.current_would_jump_over&&a!=e.current_would_not_jump_over&&(Math.random()<e.jump_over_decision.chance_of_jump.current?e.current_would_jump_over=a:e.current_would_not_jump_over=a);var l=a.get_bounds().get_y(),o=l+a.get_bounds().get_height(),_=e.car.main_body.get_bounds().get_y();if(!(_+e.car.main_body.get_bounds().get_height()<l||o<_)&&e.current_would_jump_over==a){Ae.tryJump(e.abilities.jump_power,e.car,e.config,e.cache,t);break}}}}},yt.tryJumpPickupDecision=function(e,t,n){for(var i=e.car.main_body_position_x+e.car.main_body.get_velocity().get_x()*e.config.info_max_height_jump_time,r=0;r<n.length;){var a=n[r];if(++r,a.pickable&&!(e.car.main_body_position_x>a.position.get_x()-a.radius||Math.abs(a.position.get_x()-i)>2*a.radius+e.bot_cache.distance_x_changed_in_frame||-1!=a.picked_by_cars.indexOf(e.car))){e.temp_point.set_x(a.position.get_x()),e.temp_point.set_y(a.position.get_y());var s=e.car.main_body.worldPointToLocal(e.temp_point),l=(s.get_x(),s.get_y());s.dispose(),s=null,a!=e.current_would_pickup&&a!=e.current_would_not_pickup&&(a.is_bad_item?Math.random()<e.jump_over_decision.chance_of_jump.current&&(e.current_would_not_pickup=a):Math.random()<e.jump_pickup_decision.chance_of_jump.current?e.current_would_pickup=a:e.current_would_not_pickup=a);var o=e.car.bounds.min_y-a.radius;if(e.car.bounds.max_y,a.radius,!(l<o-e.config.info_max_height_jump_distance)){if(a.type==Ci.BotJumpIndicator){if(a.position.get_y()>e.car.distance_from_bottom_y_to_top_y+e.config.info_max_height_jump_distance)continue}else if(a.distance_from_the_ground>e.car.distance_from_bottom_y_to_top_y+e.config.info_max_height_jump_distance)continue;var _=a.distance_from_the_ground-a.radius>e.car.distance_from_bottom_y_to_top_y,p=a.distance_from_the_ground-a.radius<=e.car.distance_from_bottom_y_to_top_y;if(!a.is_bad_item&&p&&a==e.current_would_pickup)break;if(a.is_bad_item||!_||a!=e.current_would_pickup){if(a.is_bad_item||a!=e.current_would_pickup)if(a.is_bad_item&&p&&a==e.current_would_not_pickup){if(Ae.tryJump(e.abilities.jump_power,e.car,e.config,e.cache,t))break}else{if(a.is_bad_item&&_&&a==e.current_would_not_pickup)break;!a.is_bad_item||e.current_would_not_pickup}}else if(Ae.tryJump(e.abilities.jump_power,e.car,e.config,e.cache,t))break}}}},yt.updateDecisionMaking=function(e,t,n,i,r,a,s,l,o,_,u){a.dc;var h=a.level_seconds,c=a.step_size,d=e.car,m=d.main_body,f=e.cache,g=e.config,v=e.bot_cache,b=e.active_decisions,y=e.air_decision,x=e.unstuck_decision,z=e.ground_decision,w=e.random_rotation_decision,k=e.random_jump_decision,S=e.flip_decision,C=e.wheelie_decision,N=e.nitro_decision,P=e.jump_over_decision,M=e.jump_pickup_decision,I=e.ability_decision,T=yt.inProgress(C),A=yt.inProgress(x);yt.shouldMakeDecision(x,h)&&!yt.inProgress(y)&&yt.tryUnstuckDecision(e,h),!yt.shouldMakeDecision(y,h)||yt.inProgress(S)||T||A||yt.tryAirDecision(e,h,c),!yt.shouldMakeDecision(z,h)||T||A||yt.tryGroundDecision(e,h),!yt.shouldMakeDecision(w,h)||T||A||(w.direction_cache=2*Math.round(Math.random())-1,yt.pushToActiveDecisions(b,w,h)),!yt.shouldMakeDecision(k,h)||T||A||Math.random()<k.chance_of_activation.current&&Ae.isAllowedToJump(e.abilities.jump_power,h)&&Ae.tryJump(e.abilities.jump_power,d,g,f,h),yt.shouldMakeDecision(S,h)&&yt.tryFlipDecision(e,h),yt.shouldMakeDecision(C,h)&&yt.tryWheelieDecision(e,h),yt.shouldMakeDecision(P,h)&&1==e.drive_direction&&m.get_velocity().get_x()>.25*g.drive_velocity_max&&Ae.isAllowedToJump(e.abilities.jump_power,h)&&yt.tryJumpOverDecision(e,h,i),yt.shouldMakeDecision(M,h)&&1==e.drive_direction&&m.get_velocity().get_x()>.25*g.drive_velocity_max&&Ae.isAllowedToJump(e.abilities.jump_power,h)&&yt.tryJumpPickupDecision(e,h,r),yt.shouldMakeDecision(N,h)&&0<e.abilities.nitro_power_charge&&.1<v.stable_drive_time&&(e.abilities.nitro_power_charge--,Ae.activateOrExtendConstantPower(e.abilities.nitro_power,d,Te.nitro_time_per_1_pick)),null!=e.abilities.received_ability&&h>=e.abilities.bot_ability_receive_time_stamp&&(e.abilities.current_ability=e.abilities.received_ability,e.abilities.received_ability=null),yt.shouldMakeDecision(I,h)&&e.abilities.current_ability!=ye.None&&(e.abilities.current_ability==ye.Bomb?yt.isInRangeFromOtherCar(d,n,300,700)&&Ae.useCurrentAbility(d,t,e.abilities,s,l,o,_,u):e.abilities.current_ability==ye.Dynamite?yt.isInRangeFromOtherCar(d,n,-700,-300)&&m.get_velocity().get_x()>.75*g.drive_velocity_max&&Ae.useCurrentAbility(d,t,e.abilities,s,l,o,_,u):e.abilities.current_ability==ye.Armor?yt.isInRangeFromOtherCar(d,n,-500,500)&&Ae.useCurrentAbility(d,t,e.abilities,s,l,o,_,u):e.abilities.current_ability==ye.Nitro?.1<v.stable_drive_time&&Ae.useCurrentAbility(d,t,e.abilities,s,l,o,_,u):e.abilities.current_ability==ye.Magnet?yt.isInRangeFromOtherCar(d,n,100,Se.magnet_distance)&&Ae.useCurrentAbility(d,t,e.abilities,s,l,o,_,u):Nl.trace("warning: unhandled type "+p.string(e.abilities.current_ability),{fileName:"BotDo.hx",lineNumber:1108,className:"bikas.game.BotDo",methodName:"updateDecisionMaking"}))},yt.updateActiveDecisions=function(e,t,n){var i,r=n.dc,a=n.level_seconds,s=(n.step_size,e.car),l=e.cache,o=e.config,_=e.bot_cache;yt.inProgress(e.unstuck_decision)&&(e.unstuck_decision.in_progress=yt.updateUnstuckAction(e.unstuck_decision,s,l,_),Mt.rotate(s,o,l,e.unstuck_decision.rotation_direction_cache*r)),yt.inProgress(e.air_decision)&&(e.air_decision.in_progress=yt.updateAirAction(e.air_decision,s,o,l,_,a,r)),yt.inProgress(e.ground_decision)&&(e.ground_decision.in_progress=yt.updateGroundAction(e.ground_decision,s,o,l,r)),yt.inProgress(e.random_rotation_decision)&&Mt.rotate(s,o,l,e.random_rotation_decision.direction_cache*r),yt.inProgress(e.flip_decision)&&(e.flip_decision.in_progress=yt.updateFlipAction(e.flip_decision,s,o,l,_,r)),yt.inProgress(e.wheelie_decision)&&(e.wheelie_decision.in_progress=yt.updateWheelieAction(e.wheelie_decision,s,o,l,_,r));for(var p=0,u=e.active_decisions.length;p<u;)(a>=(i=e.active_decisions[p]).decision_end_time_stamp||!i.allow||!i.in_progress)&&(e.active_decisions.splice(p,1),i.in_progress=!1,null!=i.on_stop&&i.on_stop(),--p,--u),++p},yt.updateUnstuckAction=function(e,t,n,i){if(!e.initial_started){e.initial_started=!0,e.starting_angle_cache=t.main_body.get_rotation();var r=57.29577951308232*i.body_angle,a=ma.getRandomBetween(130,140);.2<t.main_body.get_angularVel()?a-=ma.getRandomBetween(5,15):t.main_body.get_angularVel()<-.2&&(a+=ma.getRandomBetween(5,15)),e.rotation_direction_cache=0<=r&&r<=a?-1:1}if(e.initial_started&&!e.additional_started&&Math.abs(ma.angleDifferenceRad(t.main_body.get_rotation(),e.starting_angle_cache))>=lt.initial_rotation&&(e.additional_started=!0),e.additional_started){if(Math.abs(ma.angleDifferenceRad(t.main_body.get_rotation(),e.starting_angle_cache))>=lt.max_rotation)return!1;if(n.back_collide||n.front_collide)return!1}return!0},yt.updateAirAction=function(e,t,n,i,r,a,s){if(e.recover_mode||!i.back_collide&&!i.front_collide){if(e.recover_mode){var l=Math.abs(r.body_angle),o=Math.abs(r.body_angle_before),_=ma.angleDifferenceRad(l,e.rotate_until_angle),p=ma.angleDifferenceRad(o,e.rotate_until_angle);return a-.11>r.body_collide_time_stamp&&r.body_angle<Math.PI/2?e.recover_mode=!1:0<_&&p<0||_<0&&0<p?e.recover_mode=!1:(Mt.rotate(t,n,i,e.rotate_direction*s),!0)}return 0<r.body_angle&&-2<t.main_body.get_angularVel()?(Mt.rotate(t,n,i,-s),!0):r.body_angle<0&&t.main_body.get_angularVel()<2&&(Mt.rotate(t,n,i,s),!0)}return!1},yt.updateGroundAction=function(e,t,n,i,r){return 0==e.wheel_index_cache?(Mt.rotate(t,n,i,-r),!i.back_collide):(Mt.rotate(t,n,i,r),!i.front_collide)},yt.updateFlipAction=function(e,t,n,i,r,a){if(i.front_collide)return!1;if(i.back_collide)return!1;for(var s=t.main_body.get_arbiters().iterator();s.hasNext();)if(s.next().isCollisionArbiter())return!1;Mt.rotate(t,n,i,e.direction_cache*a);var l=Math.atan2(Math.sin(e.angle_cache-r.body_angle),Math.cos(e.angle_cache-r.body_angle));return e.angle_cache=r.body_angle,e.angle_progress_cache+=l,!(Math.abs(e.angle_progress_cache)>=2*Math.PI)},yt.updateWheelieAction=function(e,t,n,i,r,a){var s=t.main_body;if(Math.abs(r.body_angle)>Math.PI/2)return!1;if(s.get_velocity().get_length()/n.drive_velocity_max<e.velocity_to_max_coeff_action_cut_min)return!1;if(.3<r.wheels_off_time)return!1;var l=e.current_rotation_target;return r.body_angle>l+e.rotation_ok_range&&-2<s.get_angularVel()?Mt.rotate(t,n,i,-a):r.body_angle<l-e.rotation_ok_range&&s.get_angularVel()<2&&Mt.rotate(t,n,i,a),!0};var xt=function(){this.offset=y_.get(),this.current_zoom=1,this.camera_target_pos=y_.get(),this.target_pos=y_.get(),this.target_speed=y_.get(),this.current_pos=y_.get(),this.current_speed=y_.get(),this.center=y_.get(320,240),this.follow_position_offset=y_.get(0,0),this.additional_offset=y_.get(0,0),this.view_offset=y_.get(0,0),this.zoom_max_speed=10,this.zoom_max=.75,this.zoom_min=1,this.offset_max_speed=y_.get(10,10),this.offset_max_distance=y_.get(200,200),this.smooth_steps=50};(n["bikas.game.Camera"]=xt).__name__=["bikas","game","Camera"],xt.prototype={smooth_steps:null,offset_max_distance:null,offset_max_speed:null,zoom_min:null,zoom_max:null,zoom_max_speed:null,view_offset:null,additional_offset:null,follow_position_offset:null,center:null,current_speed:null,current_pos:null,target_speed:null,target_pos:null,camera_target_pos:null,current_zoom:null,offset:null,__class__:xt};var zt=function(){};(n["bikas.game.CameraDo"]=zt).__name__=["bikas","game","CameraDo"],zt.createCamera=function(){return new xt},zt.reset=function(e){e.current_speed.setxy(0,0),e.current_pos.setxy(0,0),e.target_speed.setxy(0,0),e.target_pos.setxy(0,0),e.current_zoom=1,e.offset.setxy(0,0),e.camera_target_pos.set_x(0),e.camera_target_pos.set_y(0)},zt.init=function(e,t,n,i){e.offset.setxy(0,0),e.current_speed.setxy(0,0),e.current_pos.setxy(n.x,n.y),e.target_pos.setxy(t.x,t.y),e.current_zoom=i},zt.setCurrentPositionRelativeToTarget=function(e,t,n,i,r,a){e.camera_target_pos.setxy(t.x+r,t.y+a),e.current_pos.set(e.camera_target_pos),zt.updateCamera(e,t,n,i,1)},zt.updateCarCamera=function(e,t,n,i,r,a){null==a&&(a=-1),e.offset.set_x(e.target_speed.get_x()/e.offset_max_speed.get_x()*e.offset_max_distance.get_x()),e.offset.set_y(e.target_speed.get_y()/e.offset_max_speed.get_y()*e.offset_max_distance.get_y()),e.offset.set_x(ma.clamp(e.offset.get_x(),-e.offset_max_distance.get_x(),e.offset_max_distance.get_x())),e.offset.set_y(ma.clamp(e.offset.get_y(),-e.offset_max_distance.get_y(),e.offset_max_distance.get_y())),e.camera_target_pos.setxy(t.x+e.follow_position_offset.get_x()+e.offset.get_x()/i.scale_x,t.y+e.follow_position_offset.get_y()+e.offset.get_y()/i.scale_y),zt.updateCamera(e,t,n,i,r,a,!0)},zt.updateStaticCamera=function(e,t,n,i,r,a){null==a&&(a=-1),e.camera_target_pos.setxy(t.x+e.follow_position_offset.get_x(),t.y+e.follow_position_offset.get_y()),zt.updateCamera(e,t,n,i,r,a,!1)},zt.updateCamera=function(e,t,n,i,r,a,s){if(null==s&&(s=!1),null==a&&(a=-1),s&&(e.target_speed.set_x((t.x-e.target_pos.get_x())/r),e.target_speed.set_y((t.y-e.target_pos.get_y())/r)),0<a)e.current_zoom=a;else{var l=e.zoom_min+e.target_speed.get_length()/e.zoom_max_speed*(e.zoom_max-e.zoom_min);l=ma.clamp(l,e.zoom_max,e.zoom_min);var o=e.current_zoom,_=1/e.smooth_steps,p=l*_,u=1-_,h=o*Math.pow(u,r)+p*((Math.pow(u,r-1+1)-1)/(u-1));e.current_zoom=h}i.scale_x=e.current_zoom,i.scale_y=e.current_zoom;var c=e.current_pos,d=e.target_speed,m=e.camera_target_pos,f=1/e.smooth_steps,g=d.get_x()+m.get_x()*f,v=d.get_y()+m.get_y()*f,b=1-f,y=Math.pow(b,r),x=(Math.pow(b,r-1+1)-1)/(b-1),z=c.get_x()*y+g*x,w=c.get_y()*y+v*x;e.current_pos.set_x(z),e.current_pos.set_y(w),n.x=zt.getStagePositionX(e,i.scale_x),n.y=zt.getStagePositionY(e,i.scale_y),e.target_pos.set_x(t.x),e.target_pos.set_y(t.y)},zt.getStagePositionX=function(e,t){return-(e.current_pos.get_x()+e.view_offset.get_x()+e.additional_offset.get_x())*t+e.center.get_x()},zt.getStagePositionY=function(e,t){return-(e.current_pos.get_y()+e.view_offset.get_y()+e.additional_offset.get_y())*t+e.center.get_y()},zt.getCustomScale=function(e,t){return 1-(1-e.current_zoom)*t},zt.writeCustomPositionByScale=function(e,t,n,i,r){r.x=-(e.current_pos.get_x()+e.view_offset.get_x()+e.additional_offset.get_x()-e.offset.get_x())*i*t+e.center.get_x(),r.y=-(e.current_pos.get_y()+e.view_offset.get_y()+e.additional_offset.get_y()-e.offset.get_y())*i*t+e.center.get_y()};var wt=n["bikas.game.CaptureType"]={__ename__:["bikas","game","CaptureType"],__constructs__:["Gif","Webm","PngImagesInTar"]};wt.Gif=["Gif",0],wt.Gif.toString=i,(wt.Gif.__enum__=wt).Webm=["Webm",1],wt.Webm.toString=i,(wt.Webm.__enum__=wt).PngImagesInTar=["PngImagesInTar",2],wt.PngImagesInTar.toString=i,(wt.PngImagesInTar.__enum__=wt).__empty_constructs__=[wt.Gif,wt.Webm,wt.PngImagesInTar];var kt=n["bikas.game.CaptureGameUI"]={__ename__:["bikas","game","CaptureGameUI"],__constructs__:["ShowEverything","HideEverything","JustHidePauseButton"]};kt.ShowEverything=["ShowEverything",0],kt.ShowEverything.toString=i,(kt.ShowEverything.__enum__=kt).HideEverything=["HideEverything",1],kt.HideEverything.toString=i,(kt.HideEverything.__enum__=kt).JustHidePauseButton=["JustHidePauseButton",2],kt.JustHidePauseButton.toString=i,(kt.JustHidePauseButton.__enum__=kt).__empty_constructs__=[kt.ShowEverything,kt.HideEverything,kt.JustHidePauseButton];var St=function(){};(n["bikas.game.CapturedSound"]=St).__name__=["bikas","game","CapturedSound"],St.prototype={name:null,volume:null,frame:null,__class__:St};var Ct=function(){this.all_command_lines=[],this.captured_sounds=[],this.capturer=null,this.count=0,this.started=!1,this.progress="",this.game_ui=kt.HideEverything,this.time=5,this.file_name="",this.name="",this.type=wt.Webm};(n["bikas.game.CaptureControl"]=Ct).__name__=["bikas","game","CaptureControl"],Ct.prototype={type:null,name:null,file_name:null,time:null,game_ui:null,progress:null,started:null,count:null,capturer:null,captured_sounds:null,all_command_lines:null,__class__:Ct};var Nt=function(){};(n["bikas.game.CaptureDo"]=Nt).__name__=["bikas","game","CaptureDo"],Nt.create=function(e,t){Pa.addText(t,"Capture",!1,!0);var n=e.temp.capture_control;Ct.capture_control_for_sounds=n,e.temp.updates.push(function(){Nt.captureUpdate(n)}),e.temp.levelloads.push(function(){Nt.refreshCaptureUI(n,e)}),Pa.addEnumEdit(t,n,"type","",!1),Pa.addFieldEdit(t,n,"name"),Pa.addFieldEdit(t,n,"time"),Pa.addEnumEdit(t,n,"game_ui","",!1,function(t){Nt.refreshCaptureUI(n,e)}),Pa.addFieldWatch(t,n,"progress"),Pa.addButton(t,"capture video",function(){Nt.startCapture(n)}),Pa.addButton(t,"stop and save video",function(){Nt.stopAndSaveCapture(n)}),Pa.addButton(t,"cancel video",function(){Nt.cancelCapture(n)}),Pa.addButton(t,"print audio command lines",function(){for(var e="\n",t=0,i=n.all_command_lines;t<i.length;){var r=i[t];++t,e+=r+"\n\n"}Nl.trace("all audio command lines:",{fileName:"CaptureDo.hx",lineNumber:62,className:"bikas.game.CaptureDo",methodName:"create"}),Nl.trace(e,{fileName:"CaptureDo.hx",lineNumber:63,className:"bikas.game.CaptureDo",methodName:"create"})}),Pa.addButton(t,"capture screenshot",function(){Nt.captureAndSaveScreenshot(n)})},Nt.setUIVisibility=function(e,t){e.pause_button.visible=t,e.wheel.sprite.visible=t,e.ability_item_container.visible=t,e.coin_display.coin.visible=t,e.coin_display.text.visible=t,e.ongoing_powers_container.visible=t,Nn.coin_display_debug_visibility=t,null!=e.player&&(e.player.jump_button.container.visible=t,e.player.nitro_button.container.visible=t),null!=e.stunt&&(e.stunt.score_container_visible=t,e.stunt.score_container.visible=t),null!=e.runtime_information_container&&(e.runtime_information_container.visible=t)},Nt.refreshCaptureUI=function(e,t){e.game_ui==kt.ShowEverything?Nt.setUIVisibility(t,!0):e.game_ui==kt.HideEverything?Nt.setUIVisibility(t,!1):e.game_ui==kt.JustHidePauseButton&&(Nt.setUIVisibility(t,!0),t.pause_button.visible=!1,null!=t.runtime_information_container&&(t.runtime_information_container.visible=!1))},Nt.captureAndSaveScreenshot=function(e){if($s.renderer.type==Qs.CANVAS){var t=mn.game.temp.runtime_info;null!=t&&(null!=t.build_text&&(t.build_text.visible=!1),null!=t.code_text&&(t.code_text.visible=!1),null!=t.fps_text&&(t.fps_text.visible=!1),null!=t.last_scale_text&&(t.last_scale_text.visible=!1),null!=t.memory_text&&(t.memory_text.visible=!1)),$s.renderer.render($s.game);var n=lo.get_document().createElement("img");n.src=$s.canvas.toDataURL("image/png");var i=lo.get_document().createElement("a");i.href=n.src;var r="adventure_drivers_"+Ma.getCurrentDateForFileSaving("_","_");""!=e.name&&(r="adventure_drivers_"+e.name+"_"+Ma.getCurrentDateForFileSaving("_","_")),i.download=r+".png",lo.get_document().body.appendChild(i),i.click(),lo.get_document().body.removeChild(i),null!=t&&(null!=t.build_text&&(t.build_text.visible=!0),null!=t.code_text&&(t.code_text.visible=!0),null!=t.fps_text&&(t.fps_text.visible=!0),null!=t.last_scale_text&&(t.last_scale_text.visible=!0),null!=t.memory_text&&(t.memory_text.visible=!0))}else Nl.trace("warning: CANVAS is required",{fileName:"CaptureDo.hx",lineNumber:114,className:"bikas.game.CaptureDo",methodName:"captureAndSaveScreenshot"})},Nt.startCapture=function(e){$s.canvas.focus(),$s.renderer.type==Qs.CANVAS?isNaN(e.time)&&e.time<0?Nl.trace("error: invalid capture time",{fileName:"CaptureDo.hx",lineNumber:161,className:"bikas.game.CaptureDo",methodName:"startCapture"}):e.time>60*e.time*2?Nl.trace("error: capture time is over 2 minutes long (it would consume too much RAM)",{fileName:"CaptureDo.hx",lineNumber:165,className:"bikas.game.CaptureDo",methodName:"startCapture"}):e.started?Nl.trace("warning: capture already started",{fileName:"CaptureDo.hx",lineNumber:169,className:"bikas.game.CaptureDo",methodName:"startCapture"}):($s.canvas.focus(),e.capturer=null,e.file_name="video_adventure_drivers_"+Ma.getCurrentDateForFileSaving("_","_"),""!=e.name&&(e.file_name="video_adventure_drivers_"+e.name+"_"+Ma.getCurrentDateForFileSaving("_","_")),e.type==wt.Gif?e.capturer=parent.CCapture({name:e.file_name,format:"gif",workersPath:"libraries/",framerate:60}):e.type==wt.Webm?e.capturer=parent.CCapture({name:e.file_name,format:"webm",framerate:60,quality:99}):e.type==wt.PngImagesInTar&&(e.capturer=parent.CCapture({name:e.file_name,format:"png"})),e.started=!0,e.capturer.start(),Nl.trace("capture: start",{fileName:"CaptureDo.hx",lineNumber:215,className:"bikas.game.CaptureDo",methodName:"startCapture"}),e.progress="started",e.count=0,e.captured_sounds=[]):Nl.trace("error: CANVAS is required",{fileName:"CaptureDo.hx",lineNumber:157,className:"bikas.game.CaptureDo",methodName:"startCapture"})},Nt.cancelCapture=function(e){e.started&&(Nl.trace("capture: stopping...",{fileName:"CaptureDo.hx",lineNumber:223,className:"bikas.game.CaptureDo",methodName:"cancelCapture"}),e.capturer.stop(),Nl.trace("capture: stopped",{fileName:"CaptureDo.hx",lineNumber:225,className:"bikas.game.CaptureDo",methodName:"cancelCapture"}),e.capturer=null,e.started=!1,e.progress="",Nl.trace("canceled",{fileName:"CaptureDo.hx",lineNumber:229,className:"bikas.game.CaptureDo",methodName:"cancelCapture"}))},Nt.stopAndSaveCapture=function(e){if(e.started){e.progress="stoping...",Nl.trace("capture: stopping...",{fileName:"CaptureDo.hx",lineNumber:236,className:"bikas.game.CaptureDo",methodName:"stopAndSaveCapture"}),e.capturer.stop(),e.progress="saving...",Nl.trace("capture: saving...",{fileName:"CaptureDo.hx",lineNumber:239,className:"bikas.game.CaptureDo",methodName:"stopAndSaveCapture"}),e.capturer.save();var t=Nt.generateCommandLineForSounds(e);e.all_command_lines.push(t),e.capturer=null,e.started=!1,e.progress=""}},Nt.generateCommandLineForSounds=function(e){var t="ffmpeg -i";t+=' "'+e.file_name+'.webm"';for(var n=0,i=e.captured_sounds;n<i.length;){var r=i[n];++n,t+=' -i "sounds/'+r.name+'.wav"'}t+=" -filter_complex",t+=' "';for(var a=1,s=0,l=e.captured_sounds;s<l.length;){var o=l[s];++s;var _=Math.round(o.frame/60*1e3);t+="["+a+"]adelay="+_+"|"+_+",volume="+Math.round(1e3*o.volume)/1e3+"[aud"+a+"];",++a}a=1;for(var p=0,u=e.captured_sounds;p<u.length;)u[p],++p,t+="[aud"+a+"]",++a;return t+="amix="+--a,(t+='"')+' -c:v copy "audio_'+e.file_name+'.webm"'},Nt.captureSound=function(e,t,n){if(e.started){var i=new St;i.name=t,i.frame=e.count,i.volume=n,e.captured_sounds.push(i),30<=e.captured_sounds.length?Nl.trace("reached maximum sound limit of 30, recording no more sounds",{fileName:"CaptureDo.hx",lineNumber:291,className:"bikas.game.CaptureDo",methodName:"captureSound"}):Nl.trace("frame: "+e.count+", capture sound: "+t+", volume: "+n,{fileName:"CaptureDo.hx",lineNumber:293,className:"bikas.game.CaptureDo",methodName:"captureSound"})}},Nt.captureUpdate=function(e){e.started&&(e.count++,Nl.trace("TODO: support canvas recording",{fileName:"CaptureDo.hx",lineNumber:305,className:"bikas.game.CaptureDo",methodName:"captureUpdate"}),e.progress="second: "+Math.round(e.count/60*10)/10+"/"+e.time,e.count>=60*e.time&&Nt.stopAndSaveCapture(e))};var Pt=function(){};(n["bikas.game.CarConfigDo"]=Pt).__name__=["bikas","game","CarConfigDo"],Pt.roundConfigFloats=function(e){e.drive_impulse=Math.round(100*e.drive_impulse)/100,e.drive_velocity_max=Math.round(100*e.drive_velocity_max)/100,e.drive_wheel_angular_impulse=Math.round(100*e.drive_wheel_angular_impulse)/100,e.drive_wheel_angular_velocity_max=Math.round(100*e.drive_wheel_angular_velocity_max)/100,e.rotation_angular_impulse_coeff=Math.round(100*e.rotation_angular_impulse_coeff)/100,e.rotation_angular_velocity_max=Math.round(100*e.rotation_angular_velocity_max)/100,e.nitro_impulse=Math.round(100*e.nitro_impulse)/100,e.nitro_velocity_to_drive_velocity_max_coeff=Math.round(100*e.nitro_velocity_to_drive_velocity_max_coeff)/100,e.jump_impulse=Math.round(100*e.jump_impulse)/100,e.jump_forward_min_velocity=Math.round(100*e.jump_forward_min_velocity)/100,e.grip_increase_coeff=Math.round(100*e.grip_increase_coeff)/100,e.grip_decrease_coeff=Math.round(100*e.grip_decrease_coeff)/100,e.info_max_height_jump_time=Math.round(100*e.info_max_height_jump_time)/100,e.info_max_height_jump_distance=Math.round(100*e.info_max_height_jump_distance)/100,e.info_zero_to_max_drive=Math.round(100*e.info_zero_to_max_drive)/100,e.info_zero_to_max_nitro=Math.round(100*e.info_zero_to_max_nitro)/100},Pt.copyConfig=function(e){var t=new It;return t.drive_impulse=e.drive_impulse,t.drive_velocity_max=e.drive_velocity_max,t.drive_wheel_angular_impulse=e.drive_wheel_angular_impulse,t.drive_wheel_angular_velocity_max=e.drive_wheel_angular_velocity_max,t.rotation_angular_impulse_coeff=e.rotation_angular_impulse_coeff,t.rotation_angular_velocity_max=e.rotation_angular_velocity_max,t.nitro_impulse=e.nitro_impulse,t.nitro_velocity_to_drive_velocity_max_coeff=e.nitro_velocity_to_drive_velocity_max_coeff,t.jump_impulse=e.jump_impulse,t.jump_forward_min_velocity=e.jump_forward_min_velocity,t.grip_increase_coeff=e.grip_increase_coeff,t.grip_decrease_coeff=e.grip_decrease_coeff,t.info_max_height_jump_time=e.info_max_height_jump_time,t.info_max_height_jump_distance=e.info_max_height_jump_distance,t.info_zero_to_max_drive=e.info_zero_to_max_drive,t.info_zero_to_max_nitro=e.info_zero_to_max_nitro,t.increase_rotation_angular_velocity_max_if_in_air_coeff=e.increase_rotation_angular_velocity_max_if_in_air_coeff,t},Pt.getFullConfigText=function(e){var t="\n";return t+="---------------------------------\n",t+="var c:CarConfig = new CarConfig();\n",t+="drive_impulse = "+e.drive_impulse+";\n",t+="drive_velocity_max = "+e.drive_velocity_max+";\n",t+="drive_wheel_angular_impulse = "+e.drive_wheel_angular_impulse+";\n",t+="drive_wheel_angular_velocity_max = "+e.drive_wheel_angular_velocity_max+";\n",t+="rotation_angular_impulse_coeff = "+e.rotation_angular_impulse_coeff+";\n",t+="rotation_angular_velocity_max = "+e.rotation_angular_velocity_max+";\n",t+="nitro_impulse = "+e.nitro_impulse+";\n",t+="nitro_velocity_to_drive_velocity_max_coeff = "+e.nitro_velocity_to_drive_velocity_max_coeff+";\n",t+="jump_impulse = "+e.jump_impulse+";\n",t+="// info\n",t+="info_max_height_jump_time = "+e.info_max_height_jump_time+";\n",t+="info_max_height_jump_distance = "+e.info_max_height_jump_distance+";\n",t+="info_zero_to_max_drive = "+e.info_zero_to_max_drive+";\n",t+="info_zero_to_max_nitro = "+e.info_zero_to_max_nitro+";\n",(t+="return c;\n")+"---------------------------------"},Pt.getMinimalConfigText=function(e){var t="\n";return t+="---------------------------------\n",t+="\t\tsuper();\n",t+="\t\t\n",t+="\t\tdrive_impulse = "+e.drive_impulse+";\n",t+="\t\t\n",t+="\t\trotation_angular_impulse_coeff = "+e.rotation_angular_impulse_coeff+";\n",t+="\t\trotation_angular_velocity_max = "+e.rotation_angular_velocity_max+";\n",t+="\t\t\n",t+="\t\tnitro_impulse = "+e.nitro_impulse+";\n",t+="\t\tjump_impulse = "+e.jump_impulse+";\n",t+="\t\t\n",t+="\t\t// info\n",t+="\t\tinfo_max_height_jump_time = "+e.info_max_height_jump_time+";\n",(t+="\t\tinfo_max_height_jump_distance = "+e.info_max_height_jump_distance+";\n")+"---------------------------------"},Pt.getMinimalConfigTextForFunction=function(e){var t="\n";return t+="---------------------------------\n",t+="\t\tvar c:CarConfig = new CarConfig();\n",t+="\t\t\n",t+="\t\tc.drive_impulse = "+e.drive_impulse+";\n",t+="\t\t\n",t+="\t\tc.rotation_angular_impulse_coeff = "+e.rotation_angular_impulse_coeff+";\n",t+="\t\tc.rotation_angular_velocity_max = "+e.rotation_angular_velocity_max+";\n",t+="\t\t\n",t+="\t\tc.nitro_impulse = "+e.nitro_impulse+";\n",t+="\t\tc.jump_impulse = "+e.jump_impulse+";\n",t+="\t\t\n",t+="\t\t// info\n",t+="\t\tc.info_max_height_jump_time = "+e.info_max_height_jump_time+";\n",t+="\t\tc.info_max_height_jump_distance = "+e.info_max_height_jump_distance+";\n",t+="\t\t\n",(t+="\t\treturn c;\n")+"---------------------------------"};var Mt=function(){};(n["bikas.game.CarControlDo"]=Mt).__name__=["bikas","game","CarControlDo"],Mt.drive=function(e,t,n,i){null==i&&(i=1);var r=t.drive_impulse+t.drive_impulse_additional,a=t.drive_velocity_max+t.drive_velocity_max_additional;if(n.impulse.set_x(0),n.impulse.set_y(0),n.front_collide&&n.back_collide){var s=n.impulse;s.set_x(s.get_x()+r*i*e.total_mass*2)}else if(n.front_collide||n.back_collide){var l=n.impulse;l.set_x(l.get_x()+r*i*e.total_mass*2*.75)}if(n.back_collide||n.front_collide){var o=e.main_body.get_velocity().get_length();if(n.impulse.rotate(e.main_body.get_rotation()),o<a/2){var _=1+(a/2-o)/(a/2);n.impulse.muleq(_)}n.velocity.set_x(e.main_body.get_velocity().get_x()+n.impulse.get_x()),n.velocity.set_y(e.main_body.get_velocity().get_y()+n.impulse.get_y()),n.velocity.get_length()>o?o<=a&&e.main_body.applyImpulse(n.impulse):e.main_body.applyImpulse(n.impulse)}var p=.346*Math.pow(e.back_wheel_diameter/2,2),u=.346*Math.pow(e.front_wheel_diameter/2,2);Mt.applySmoothedAngularImpulse(e.back_wheel_body,p,t.drive_wheel_angular_velocity_max),Mt.applySmoothedAngularImpulse(e.front_wheel_body,u,t.drive_wheel_angular_velocity_max)},Mt.rotate=function(e,t,n,i){null==i&&(i=1);var r=1;2<n.updates_since_anything_collided&&(r=va.linearClamped(1,t.increase_rotation_angular_velocity_max_if_in_air_coeff,n.updates_since_anything_collided/20));var a=t.rotation_angular_impulse_coeff*i*e.total_inertia;Mt.applySmoothedAngularImpulse(e.main_body,a,t.rotation_angular_velocity_max*t.rotation_angular_velocity_max_additional_coeff*r)},Mt.applySmoothedAngularImpulse=function(e,t,n){var i=e.get_angularVel();if(0<i&&0<t||i<0&&t<0)if(Math.abs(i)<n/2)e.applyAngularImpulse(t);else{var r=1-va.getT(n/2,n,Math.abs(i));r=ma.clamp(r,0,1),e.applyAngularImpulse(t*r)}else e.applyAngularImpulse(t)},Mt.customAngularImpulse=function(e,t,n){e.main_body.get_angularVel()<=n&&Ot.applyRotationAngularImpulse(e,t)},Mt.nitro=function(e,t,n,i){var r=t.nitro_impulse+t.nitro_impulse_additional;n.impulse.setxy(r*e.total_mass*i,0),n.impulse.rotate(e.main_body.get_rotation());var a=e.main_body.get_velocity().get_length();e.main_body.get_velocity().add(n.impulse).get_length()>a?a<=t.drive_velocity_max*t.nitro_velocity_to_drive_velocity_max_coeff*t.nitro_velocity_additional_coeff&&Ot.applyImpulseToMainBodies(e,n.impulse):Ot.applyImpulseToMainBodies(e,n.impulse)},Mt.customImpulse=function(e,t,n,i){t.impulse.set(n);var r=e.main_body.get_velocity().get_length();e.main_body.get_velocity().add(t.impulse).get_length()>r?r<=i&&Ot.applyImpulseToMainBodies(e,t.impulse):Ot.applyImpulseToMainBodies(e,t.impulse)},Mt.jump=function(e,t,n){var i=0;0<e.main_body.get_velocity().get_x()?e.main_body.get_velocity().get_x()<t.jump_forward_min_velocity&&(i=t.jump_forward_min_velocity-e.main_body.get_velocity().get_x()):i=t.jump_forward_min_velocity,n.impulse.setxy(i*e.total_mass,t.jump_impulse*e.total_mass),e.main_body.applyImpulse(n.impulse)},Mt.updateState=function(e,t,n){n.back_collide=Mt.hasCollisionArbiter(t.back_wheel_body),n.front_collide=Mt.hasCollisionArbiter(t.front_wheel_body),n.body_collide=Mt.hasCollisionArbiter(t.main_body),n.body_collide?n.updates_since_body_collided=0:n.updates_since_body_collided+=e,n.back_collide?n.updates_since_back_wheel_collided=0:n.updates_since_back_wheel_collided+=e,n.front_collide?n.updates_since_front_wheel_collided=0:n.updates_since_front_wheel_collided+=e,n.back_collide||n.front_collide?n.updates_since_any_wheel_collided=0:n.updates_since_any_wheel_collided+=e,n.body_collide||n.back_collide||n.front_collide?n.updates_since_anything_collided=0:n.updates_since_anything_collided+=e},Mt.hasCollisionArbiter=function(e){if(null==e.get_space())return!1;if(e.get_isSleeping())return!1;for(var t=e.get_arbiters().iterator();t.hasNext();)if(t.next().isCollisionArbiter())return!0;return!1},Mt.destroy=function(e,t,n){null!=e&&(e.group_entity=null,e.main_body_entity=null,e.main_body_background_sprite=null,e.front_wheel_body_entity=null,(e.back_wheel_body_entity=null)!=e.main_body&&(null!=e.main_body.get_group()&&(e.main_body.get_group().set_group(null),e.main_body.set_group(null)),e.main_body=null),e.back_wheel_body=null,e.all_bodies=null,e.all_bodies_init_rotations=null,e.main_bodies=null,e.all_constraints=null,e.front_suspension=null,e.back_suspension=null,(e.baggages=null)!=e.exhaust_position&&(e.exhaust_position.dispose(),e.exhaust_position=null),null!=e.initial_main_body_position&&(e.initial_main_body_position.dispose(),e.initial_main_body_position=null),null!=e.distance_from_main_body_to_back_wheel_body&&(e.distance_from_main_body_to_back_wheel_body.dispose(),e.distance_from_main_body_to_back_wheel_body=null),e.bounds=null),null!=n&&(null!=n.impulse&&(n.impulse.dispose(),n.impulse=null),null!=n.velocity&&(n.velocity.dispose(),n.velocity=null))};var It=function(){this.info_zero_to_max_nitro=.5,this.info_zero_to_max_drive=1,this.info_max_height_jump_distance=200,this.info_max_height_jump_time=.72,this.increase_rotation_angular_velocity_max_if_in_air_coeff=1,this.rotation_angular_velocity_max_additional_coeff=1,this.nitro_velocity_additional_coeff=1,this.nitro_impulse_additional=0,this.drive_velocity_max_additional=0,this.drive_impulse_additional=0,this.armor_coeff=0,this.grip_decrease_coeff=1,this.grip_increase_coeff=1,this.jump_forward_min_velocity=150,this.jump_impulse=-600,this.nitro_velocity_to_drive_velocity_max_coeff=1.6,this.nitro_impulse=40,this.rotation_angular_velocity_max=6,this.rotation_angular_impulse_coeff=1,this.drive_wheel_angular_velocity_max=33,this.drive_wheel_angular_impulse=5,this.drive_velocity_max=700,this.drive_impulse=4.5};(n["bikas.game.CarConfig"]=It).__name__=["bikas","game","CarConfig"],It.prototype={drive_impulse:null,drive_velocity_max:null,drive_wheel_angular_impulse:null,drive_wheel_angular_velocity_max:null,rotation_angular_impulse_coeff:null,rotation_angular_velocity_max:null,nitro_impulse:null,nitro_velocity_to_drive_velocity_max_coeff:null,jump_impulse:null,jump_forward_min_velocity:null,grip_increase_coeff:null,grip_decrease_coeff:null,armor_coeff:null,drive_impulse_additional:null,drive_velocity_max_additional:null,nitro_impulse_additional:null,nitro_velocity_additional_coeff:null,rotation_angular_velocity_max_additional_coeff:null,increase_rotation_angular_velocity_max_if_in_air_coeff:null,info_max_height_jump_time:null,info_max_height_jump_distance:null,info_zero_to_max_drive:null,info_zero_to_max_nitro:null,__class__:It};var Tt=function(){this.updates_since_anything_collided=0,this.updates_since_any_wheel_collided=0,this.updates_since_front_wheel_collided=0,this.updates_since_back_wheel_collided=0,this.updates_since_body_collided=0,this.front_collide=!1,this.back_collide=!1,this.body_collide=!1,this.velocity=y_.get(0,0),this.impulse=y_.get(0,0)};(n["bikas.game.CarCache"]=Tt).__name__=["bikas","game","CarCache"],Tt.prototype={impulse:null,velocity:null,body_collide:null,back_collide:null,front_collide:null,updates_since_body_collided:null,updates_since_back_wheel_collided:null,updates_since_front_wheel_collided:null,updates_since_any_wheel_collided:null,updates_since_anything_collided:null,__class__:Tt};var At=function(){this.all_constraints=[]};(n["bikas.game.CarSuspension"]=At).__name__=["bikas","game","CarSuspension"],At.prototype={body:null,pivot_wheel_to_suspension_body:null,pivot_suspension_body_to_main_body:null,weld_suspension_body_to_main_body:null,all_constraints:null,__class__:At};var Dt=function(){this.current_time=60,this.initial_distance_from_main_body=0,this.interactive=!0,this.timeout=!1};(n["bikas.game.CarBaggage"]=Dt).__name__=["bikas","game","CarBaggage"],Dt.prototype={body:null,timeout:null,interactive:null,initial_distance_from_main_body:null,current_time:null,__class__:Dt};var Et=function(){this.main_body_position_y=0,this.main_body_position_x=0,this.total_inertia=0,this.total_mass=0,this.front_wheel_body_inertia=0,this.front_wheel_body_mass=0,this.back_wheel_body_inertia=0,this.back_wheel_body_mass=0,this.main_body_inertia=0,this.main_body_mass=0,this.bounds=new ia,this.exhaust_position=null,this.baggages=[],this.all_constraints=[],this.main_bodies=[],this.all_bodies_init_rotations=[],this.all_bodies=[],this.main_body_background_sprite=null};(n["bikas.game.Car"]=Et).__name__=["bikas","game","Car"],Et.prototype={name:null,stage_name:null,group_entity:null,main_body_entity:null,main_body_background_sprite:null,front_wheel_body_entity:null,back_wheel_body_entity:null,main_body:null,back_wheel_body:null,front_wheel_body:null,all_bodies:null,all_bodies_init_rotations:null,main_bodies:null,all_constraints:null,front_suspension:null,back_suspension:null,baggages:null,back_wheel_diameter:null,front_wheel_diameter:null,exhaust_position:null,initial_main_body_position:null,distance_from_main_body_to_back_wheel_body:null,distance_from_main_body_to_bottom_y:null,distance_from_main_body_to_top_y:null,distance_from_bottom_y_to_top_y:null,bounds:null,main_body_mass:null,main_body_inertia:null,back_wheel_body_mass:null,back_wheel_body_inertia:null,front_wheel_body_mass:null,front_wheel_body_inertia:null,total_mass:null,total_inertia:null,main_body_position_x:null,main_body_position_y:null,__class__:Et};var Ot=function(){};(n["bikas.game.CarDo"]=Ot).__name__=["bikas","game","CarDo"],Ot.createCar=function(e,t,n,i,r){var a=new Et;a.group_entity=e,a.name=a.group_entity.prefab.prefab_name,a.stage_name=a.group_entity.prefab.prefab_link_name,a.main_body_entity=t,a.back_wheel_body_entity=n,a.front_wheel_body_entity=i,a.main_body=t.body,a.back_wheel_body=n.body,a.front_wheel_body=i.body,a.main_body.setShapeFilters(Si.car_body),a.back_wheel_body.setShapeFilters(Si.car_wheel),a.front_wheel_body.setShapeFilters(Si.car_wheel),a.main_body.set_group(new t_(!1)),a.main_body.get_group().set_group(r);for(var s=0,l=a.group_entity.group.entities;s<l.length;){var o=l[s];if(++s,"baggage"==o.name||"baggage_self"==o.name)if(null==o.body)Nl.trace("warning: body == null for "+o.name+" ("+o.guid+")",{fileName:"CarDo.hx",lineNumber:48,className:"bikas.game.CarDo",methodName:"createCar"});else{var _=new Dt;_.body=o.body,"baggage"==o.name?_.body.setShapeFilters(Si.car_baggage):"baggage_self"==o.name&&_.body.setShapeFilters(Si.car_baggage_self),_.body.setShapeMaterials(nr.car_baggage_default),_.interactive=!0;var p=a.main_body.get_position().sub(_.body.get_position());_.initial_distance_from_main_body=p.get_length(),p.dispose(),a.baggages.push(_),_.body.set_group(a.main_body.get_group())}else"exhaust"==o.name&&(a.exhaust_position=y_.get(o.position.x-a.main_body_entity.position.x,o.position.y-a.main_body_entity.position.y))}a.back_wheel_diameter=2*a.back_wheel_body_entity.circle.radius,a.back_wheel_diameter<30&&Nl.trace("warning: back_wheel_diameter:"+a.back_wheel_diameter+" for car "+a.name+" is too small",{fileName:"CarDo.hx",lineNumber:83,className:"bikas.game.CarDo",methodName:"createCar"}),a.back_suspension=Ot.createSuspension(a.main_body,a.back_wheel_body,a.back_wheel_diameter,!0),a.front_wheel_diameter=2*a.front_wheel_body_entity.circle.radius,a.front_wheel_diameter<30&&Nl.trace("warning: front_wheel_diameter:"+a.front_wheel_diameter+" for car "+a.name+" is too small",{fileName:"CarDo.hx",lineNumber:90,className:"bikas.game.CarDo",methodName:"createCar"}),a.front_suspension=Ot.createSuspension(a.main_body,a.front_wheel_body,a.front_wheel_diameter,!1),a.main_body.setShapeMaterials(nr.car_body_default),a.back_wheel_body.setShapeMaterials(nr.car_wheel_default),a.front_wheel_body.setShapeMaterials(nr.car_wheel_default),a.back_suspension.body.setShapeMaterials(nr.car_suspension_default),a.front_suspension.body.setShapeMaterials(nr.car_suspension_default),a.main_bodies.push(a.main_body),a.main_bodies.push(a.back_wheel_body),a.main_bodies.push(a.front_wheel_body),a.main_bodies.push(a.back_suspension.body),a.main_bodies.push(a.front_suspension.body);for(var u=0,h=a.main_bodies;u<h.length;){var c=h[u];++u,c!=a.main_body&&c.set_group(r)}a.initial_main_body_position=a.main_body.get_position().copy(),a.distance_from_main_body_to_back_wheel_body=a.main_body.get_position().sub(a.back_wheel_body.get_position()),a.distance_from_main_body_to_back_wheel_body.set_x(Math.abs(a.distance_from_main_body_to_back_wheel_body.get_x())),a.distance_from_main_body_to_back_wheel_body.set_y(Math.abs(a.distance_from_main_body_to_back_wheel_body.get_y())),a.distance_from_main_body_to_bottom_y=Math.abs(a.distance_from_main_body_to_back_wheel_body.get_y()+a.back_wheel_body.get_bounds().get_height()/2),a.distance_from_main_body_to_top_y=-a.main_body.get_bounds().get_height()/2,a.distance_from_bottom_y_to_top_y=Math.abs(a.distance_from_main_body_to_top_y)+Math.abs(a.distance_from_main_body_to_bottom_y),a.main_body_mass=a.main_body.get_mass(),a.main_body_inertia=a.main_body.get_inertia(),a.back_wheel_body_mass=a.back_wheel_body.get_mass(),a.back_wheel_body_inertia=a.back_wheel_body.get_inertia(),a.front_wheel_body_mass=a.front_wheel_body.get_mass(),a.front_wheel_body_inertia=a.front_wheel_body.get_inertia(),a.total_mass=0;for(var d=a.total_inertia=0,m=a.main_bodies;d<m.length;){var f=m[d];++d,a.total_mass+=f.get_mass(),a.total_inertia+=f.get_inertia()}for(var g=0,v=a.group_entity.group.entities;g<v.length;){var b=v[g];++g,null!=b.body&&a.all_bodies.push(b.body),null!=b.constraint&&a.all_constraints.push(b.constraint)}a.all_bodies.push(a.back_suspension.body),a.all_bodies.push(a.front_suspension.body);for(var y=0,x=a.back_suspension.all_constraints;y<x.length;){var z=x[y];++y,a.all_constraints.push(z)}for(var w=0,k=a.front_suspension.all_constraints;w<k.length;){var S=k[w];++w,a.all_constraints.push(S)}for(var C=0,N=a.all_bodies;C<N.length;){var P=N[C];++C,a.all_bodies_init_rotations.push(P.get_rotation())}return a.bounds=Ot.getBounds(a),de.remove(t),pe.remove(n),pe.remove(i),t.polygon=null,n.circle=null,i.circle=null,Ot.update(a),a},Ot.createSuspension=function(e,t,n,i){var r,a=2.8*n,s=.7*n,l=(a/2-.3*n)*(r=i?1:-1),o=-.078*a*r,_=(-a/2-.078*n)*r;return Ot.createCarSuspension(e,t,a,s,l,o,_)},Ot.createCarSuspension=function(e,t,n,i,r,a,s){var l,o,_=new At,p=t.get_position().get_x()+r,u=t.get_position().get_y();return _.body=new C_(M_.get_DYNAMIC(),y_.get(p,u)),_.body.get_shapes().add(new V_(V_.box(n,i))),_.body.setShapeFilters(Si.car_suspension),_.body.set_disableCCD(!0),l=y_.get(0,0),o=_.body.worldPointToLocal(t.localPointToWorld(y_.get(0,0))),_.pivot_wheel_to_suspension_body=new Zo(t,_.body,l,o),_.pivot_wheel_to_suspension_body.set_frequency(10),_.pivot_wheel_to_suspension_body.set_damping(1),l=y_.get(a,0),o=e.worldPointToLocal(_.body.localPointToWorld(l)),_.pivot_suspension_body_to_main_body=new Zo(_.body,e,l,o),_.pivot_suspension_body_to_main_body.set_frequency(10),_.pivot_suspension_body_to_main_body.set_damping(1),l=y_.get(s,0),o=e.worldPointToLocal(_.body.localPointToWorld(l)),_.weld_suspension_body_to_main_body=new qo(_.body,e,l,o),_.weld_suspension_body_to_main_body.set_stiff(!1),_.weld_suspension_body_to_main_body.set_frequency(12),_.weld_suspension_body_to_main_body.set_damping(2),_.all_constraints.push(_.pivot_wheel_to_suspension_body),_.all_constraints.push(_.pivot_suspension_body_to_main_body),_.all_constraints.push(_.weld_suspension_body_to_main_body),_},Ot.getBounds=function(e){for(var t,n=1e4,i=1e4,r=-1e4,a=-1e4,s=e.main_body.get_position(),l=[e.main_body],o=0;o<l.length;){var _=l[o];++o,(t=_.get_bounds().copy()).get_min().subeq(s),t.get_max().subeq(s),t.get_min().get_x()<n&&(n=t.get_min().get_x()),t.get_min().get_y()<i&&(i=t.get_min().get_y()),t.get_max().get_x()>r&&(r=t.get_max().get_x()),t.get_max().get_y()>a&&(a=t.get_max().get_y())}return 1e4!=n&&1e4!=i&&-1e4!=r&&-1e4!=a||Nl.trace("warning: something ain't right with bounds",{fileName:"CarDo.hx",lineNumber:274,className:"bikas.game.CarDo",methodName:"getBounds"}),new ia(n,i,r,a)},Ot.isWorldPointInBounds=function(e,t){var n=e.main_body.worldPointToLocal(t);return n.get_x()>=e.bounds.min_x&&n.get_x()<=e.bounds.max_x&&n.get_y()>=e.bounds.min_y&&n.get_y()<=e.bounds.max_y?(n.dispose(),!0):(n.dispose(),!1)},Ot.doesWorldCircleTouchCarBounds=function(e,t,n){var i=e.main_body.worldPointToLocal(t),r=n/2;return i.get_x()+r>=e.bounds.min_x&&i.get_x()-r<=e.bounds.max_x&&i.get_y()+r>=e.bounds.min_y&&i.get_y()-r<=e.bounds.max_y?(i.dispose(),!0):(i.dispose(),!1)},Ot.doesWorldBoundsTouchBounds=function(e,t,n){var i=e.main_body.worldPointToLocal(t),r=e.main_body.worldPointToLocal(n),a=!(i.get_x()>e.bounds.max_x||r.get_x()<e.bounds.min_x||i.get_y()>e.bounds.max_y||r.get_y()<e.bounds.min_y);return i.dispose(),r.dispose(),a},Ot.setPosition=function(e,t,n){for(var i=e.main_body.get_position().copy(),r=0,a=e.all_bodies;r<a.length;){var s=a[r];++r;var l=i.sub(s.get_position()),o=y_.get(t+l.get_x(),n+l.get_y());s.get_position().set(o),l.dispose(),o.dispose()}i.dispose(),Ot.update(e)},Ot.setDeltaPosition=function(e,t,n){for(var i=e.main_body.get_position().copy(),r=0,a=e.all_bodies;r<a.length;){var s=a[r];++r;var l=i.sub(s.get_position()),o=y_.get(i.get_x()+t+l.get_x(),i.get_y()+n+l.get_y());s.get_position().set(o),l.dispose(),o.dispose()}i.dispose()},Ot.setRotation=function(e,t){for(var n=e.main_body.get_position().copy(),i=e.main_body.get_rotation(),r=0,a=e.all_bodies.length;r<a;){var s=r++,l=e.all_bodies[s],o=e.all_bodies_init_rotations[s],_=n.sub(l.get_position());_.rotate(-i),l.set_rotation(t+o),l.get_position().setxy(n.get_x()+_.get_x(),n.get_y()+_.get_y()),_.dispose()}n.dispose()},Ot.setVelocity=function(e,t,n){for(var i=0,r=e.all_bodies;i<r.length;){var a=r[i];++i,a.get_velocity().setxy(t,n)}},Ot.setAngularVelocity=function(e,t){for(var n=0,i=e.all_bodies;n<i.length;){var r=i[n];++n,r.set_angularVel(t)}},Ot.applyImpulse=function(e,t){for(var n=t.mul(1/e.all_bodies.length),i=0,r=e.all_bodies;i<r.length;){var a=r[i];++i,a.applyImpulse(n)}},Ot.applyImpulsePerMassUnit=function(e,t){for(var n=0,i=e.all_bodies;n<i.length;){var r=i[n];++n,r.applyImpulse(t.mul(r.get_mass(),!0))}},Ot.applyImpulseToMainBodiesPerMassUnit=function(e,t){for(var n=0,i=e.main_bodies;n<i.length;){var r=i[n];++n,r.applyImpulse(t.mul(r.get_mass(),!0))}},Ot.applyImpulseToMainBodies=function(e,t){for(var n=0,i=0,r=e.main_bodies;i<r.length;){var a=r[i];++i,n+=a.get_mass()}for(var s=0,l=e.main_bodies;s<l.length;){var o=l[s];++s,o.applyImpulse(t.mul(o.get_mass()/n))}},Ot.applyRotationAngularImpulse=function(e,t){e.main_body.applyAngularImpulse(t)},Ot.update=function(e){var t=e.main_body.get_position();e.main_body_position_x=t.get_x(),e.main_body_position_y=t.get_y()},Ot.setCarSpace=function(e,t){for(var n=0,i=e.all_bodies;n<i.length;){var r=i[n];++n,r.get_space()!=t&&r.set_space(t)}for(var a=0,s=e.all_constraints;a<s.length;){var l=s[a];++a,l.get_space()!=t&&l.set_space(t)}};var Bt=function(){this.bot_sheep=[]};(n["bikas.game.EscapeFromWolfChallenge"]=Bt).__name__=["bikas","game","EscapeFromWolfChallenge"],Bt.prototype={challenge_type:null,player_sheep:null,player_wolf:null,bot_wolf:null,bot_sheep:null,wolf_finish_position:null,__class__:Bt};var Lt=function(){};(n["bikas.game.MountainRushChallenge"]=Lt).__name__=["bikas","game","MountainRushChallenge"],Lt.prototype={flips_text:null,mountain_finish_position:null,__class__:Lt};var jt=function(){this.arrow_animation_current_time=0,this.animate_arrow=!1,this.fall_time=-1,this.fall_end_time=-1,this.fall_start_time=-1};(n["bikas.game.BarrelPlatform"]=jt).__name__=["bikas","game","BarrelPlatform"],jt.prototype={barrel:null,ground:null,arrow:null,fall_start_time:null,fall_end_time:null,fall_time:null,animate_arrow:null,arrow_animation_current_time:null,__class__:jt};var Ft=function(){this.current_damage=0,this.barrel_platforms=[]};(n["bikas.game.SurvivalChallenge"]=Ft).__name__=["bikas","game","SurvivalChallenge"],Ft.prototype={barrel_platforms:null,text:null,current_damage:null,__class__:Ft};var Rt=function(){};(n["bikas.game.BalancingChallenge"]=Rt).__name__=["bikas","game","BalancingChallenge"],Rt.prototype={box:null,__class__:Rt};var Gt=function(){this.current_time=0};(n["bikas.game.BulletTaxiChallenge"]=Gt).__name__=["bikas","game","BulletTaxiChallenge"],Gt.prototype={text:null,current_time:null,__class__:Gt};var Zt=function(){};(n["bikas.game.AchievementChallenge"]=Zt).__name__=["bikas","game","AchievementChallenge"],Zt.prototype={__class__:Zt};var Ut=function(){this.balloons_attached=!1};(n["bikas.game.CreditsChallenge"]=Ut).__name__=["bikas","game","CreditsChallenge"],Ut.prototype={balloons_attached:null,__class__:Ut};var Vt=n["bikas.game.ChallengeTextState"]={__ename__:["bikas","game","ChallengeTextState"],__constructs__:["None","PhaseIn","Show","PhaseOut"]};Vt.None=["None",0],Vt.None.toString=i,(Vt.None.__enum__=Vt).PhaseIn=["PhaseIn",1],Vt.PhaseIn.toString=i,(Vt.PhaseIn.__enum__=Vt).Show=["Show",2],Vt.Show.toString=i,(Vt.Show.__enum__=Vt).PhaseOut=["PhaseOut",3],Vt.PhaseOut.toString=i,(Vt.PhaseOut.__enum__=Vt).__empty_constructs__=[Vt.None,Vt.PhaseIn,Vt.Show,Vt.PhaseOut];var qt=function(){this.state=Vt.None};(n["bikas.game.ChallengeText"]=qt).__name__=["bikas","game","ChallengeText"],qt.prototype={state:null,bitmap_text:null,current_time:null,__class__:qt};var Wt=function(){this.credits=null,this.achievement=null,this.bullet_taxi=null,this.balancing=null,this.survival=null,this.mountain_rush=null,this.escape_from_wolf=null,this.current_explosion_animations=[]};(n["bikas.game.Challenges"]=Wt).__name__=["bikas","game","Challenges"],Wt.prototype={current_explosion_animations:null,escape_from_wolf:null,mountain_rush:null,survival:null,balancing:null,bullet_taxi:null,achievement:null,credits:null,__class__:Wt};var Xt=function(){};(n["bikas.game.ChallengeDo"]=Xt).__name__=["bikas","game","ChallengeDo"],Xt.createEscapeFromWolfChallenge=function(e,t,n,i,r,a){var s=new Bt;s.challenge_type=a;var l=n.slice();if(l.sort(Xt.sortBotsByInitialPositionX),3!=l.length)return Nl.trace("warning: there should be exactly 3 bots",{fileName:"ChallengeDo.hx",lineNumber:67,className:"bikas.game.ChallengeDo",methodName:"createEscapeFromWolfChallenge"}),null;for(var o=0;o<l.length;){var _=l[o];++o;for(var p=0,u=_.stunt_decisions;p<u.length;){var h=u[p];++p,h.allow=!1}_.personality_applied=!1}if(a==kr.ChallengeEscapeFromWolf)s.player_sheep=t,s.player_wolf=null,s.bot_wolf=l[0],s.bot_sheep.push(l[1]),s.bot_sheep.push(l[2]);else{s.player_sheep=null,s.player_wolf=t,s.bot_sheep.push(l[0]),s.bot_sheep.push(l[1]),s.bot_sheep.push(l[2]);for(var c=0,d=s.bot_sheep;c<d.length;){var m=d[c];++c,m.personality.ability=new nt(1,1,1,1),m.personality_applied=!1}}s.wolf_finish_position=Xt.findPositionOfEntity(e,"wolf finish position");for(var f=new gr,g=new gr,v=0,b=s.bot_sheep;v<b.length;){var y=b[v];++v,y.config=Pr.getUpgradedCarConfigCopy(i,f,r,y.car.name)}var x=null;return null!=s.player_sheep?(s.player_sheep.config=Pr.getUpgradedCarConfigCopy(i,f,r,t.car.name),s.bot_wolf.config=Pr.getUpgradedCarConfigCopy(i,g,r,t.car.name),x=s.bot_wolf.car):null!=s.player_wolf&&(s.player_wolf.config=Pr.getUpgradedCarConfigCopy(i,g,r,t.car.name),x=s.player_wolf.car),x.main_body.set_group(null),x.main_body.setShapeFilters(Si.car_wolf_body),x.back_wheel_body.setShapeFilters(Si.car_wolf_wheel),x.front_wheel_body.setShapeFilters(Si.car_wolf_wheel),Nl.trace("escape from wolf challenge created",{fileName:"ChallengeDo.hx",lineNumber:123,className:"bikas.game.ChallengeDo",methodName:"createEscapeFromWolfChallenge"}),s},Xt.createMountainRushChallenge=function(e,t,n,i,r){var a=new Lt,s=new gr;t.config=Pr.getUpgradedCarConfigCopy(i,s,r,t.car.name);for(var l=0;l<n.length;){var o=n[l];++l,o.config=Pr.getUpgradedCarConfigCopy(i,s,r,o.car.name)}return a.mountain_finish_position=Xt.findPositionOfEntity(e,"mountain finish position"),a.flips_text=qa.createBitmapText(fn.toonish_36,42,"left","TEXT"),a.flips_text.anchor.set(.5,.5),Nl.trace("mountain rush challenge created",{fileName:"ChallengeDo.hx",lineNumber:147,className:"bikas.game.ChallengeDo",methodName:"createMountainRushChallenge"}),a},Xt.createSurvivalChallenge=function(e,t,n,i,r,a){var s=new Ft;s.text=qa.createBitmapText(fn.toonish_36,42,"left","TEXT"),s.text.anchor.set(.5,.5);var l=new gr;t.config=Pr.getUpgradedCarConfigCopy(i,l,r,t.car.name);for(var o=0,_=e.group.entities;o<_.length;){var p=_[o];if(++o,null!=p.prefab&&"explosive_barrel_on_crate"==p.prefab.prefab_name){for(var u=new jt,h=0,c=p.group.entities;h<c.length;){var d=c[h];if(++h,"explosive_barrel_marker"==d.name)u.arrow=d;else if(null!=d.prefab)if("explosive_metal_barrel"==d.prefab.prefab_name)for(var m=0,f=d.group.entities;m<f.length;){var g=f[m];++m,null!=g.body&&(u.barrel=g)}else if("static_crate"==d.prefab.prefab_name)for(var v=0,b=d.group.entities;v<b.length;){var y=b[v];++v,null!=y.body&&(u.ground=y)}}if(null==u.arrow&&(Nl.trace("warning: platform.arrow == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.ChallengeDo",methodName:"createSurvivalChallenge"}),1))break;if(null==u.barrel&&(Nl.trace("warning: platform.barrel == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.ChallengeDo",methodName:"createSurvivalChallenge"}),1))break;if(null==u.ground&&(Nl.trace("warning: platform.ground == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.ChallengeDo",methodName:"createSurvivalChallenge"}),1))break;for(var x=0;x<a.length;){var z=a[x];if(++x,z.body==u.barrel.body){Nl.trace("success!",{fileName:"ChallengeDo.hx",lineNumber:202,className:"bikas.game.ChallengeDo",methodName:"createSurvivalChallenge"}),z.explosion_radius=150;break}}s.barrel_platforms.push(u)}}return s.barrel_platforms.length!=Ft.barrel_fall_time_array.length&&Nl.trace("warning: barrel fall time and barrel platform array lengths are not equal",{fileName:"ChallengeDo.hx",lineNumber:214,className:"bikas.game.ChallengeDo",methodName:"createSurvivalChallenge"}),s.barrel_platforms.sort(Xt.sortBarrelPlatformsByX),s},Xt.createBalancingChallenge=function(e,t,n,i,r,a){var s=new Rt,l=new gr;return t.config=Pr.getUpgradedCarConfigCopy(i,l,r,t.car.name),0<a.length&&(s.box=a[0]),s},Xt.createBulletTaxiChallenge=function(e,t,n,i,r){var a=new Gt,s=new gr;return s.acceleration=9,s.top_speed=9,t.config=Pr.getUpgradedCarConfigCopy(i,s,r,t.car.name),t.config.nitro_velocity_to_drive_velocity_max_coeff=1.5,a.text=qa.createBitmapText(fn.toonish_36,42,"left","TEXT"),a.text.anchor.set(.5,.5),a},Xt.createAchievementChallenge=function(e,t,n){return new Zt},Xt.createCreditsChallenge=function(e,t,n){return new Ut},Xt.findEntity=function(e,t){for(var n=0,i=e.group.entities;n<i.length;){var r=i[n];if(++n,r.name==t)return r}return Nl.trace("warning: could not find "+t,{fileName:"ChallengeDo.hx",lineNumber:301,className:"bikas.game.ChallengeDo",methodName:"findEntity"}),null},Xt.findPositionOfEntity=function(e,t){for(var n=0,i=e.group.entities;n<i.length;){var r=i[n];if(++n,r.name==t)return r.position}return Nl.trace("warning: could not find "+t,{fileName:"ChallengeDo.hx",lineNumber:311,className:"bikas.game.ChallengeDo",methodName:"findPositionOfEntity"}),new ea(0,0)},Xt.sortBarrelPlatformsByX=function(e,t){return e.ground.position.x>t.ground.position.x?1:e.ground.position.x<t.ground.position.x?-1:0},Xt.sortBotsByInitialPositionX=function(e,t){return e.car.initial_main_body_position.get_x()>t.car.initial_main_body_position.get_x()?1:e.car.initial_main_body_position.get_x()<t.car.initial_main_body_position.get_x()?-1:0},Xt.createExplosionAnimation=function(e,t,n){var i=A.createNewAnimation(Gs.animation_explosion,!0);return i.frame_time_coeff=Gs.animation_explosion.frames.length/Me.total_explosion_time,e.add(i.group),i.group.x=t,i.group.y=n,i.group.scale.x=2,i.group.scale.y=2,i},Xt.endRace=function(e,t,n,i){1==$s.config.type&&3==$s.config.release.sitelock_type&&es.PokiSDK.gameplayStop(),e.finished_race=!0,e.behavior_activated=!1,null!=i&&(i.behavior_activated=!1),Ae.deactivateAbilities(e.abilities),e.nitro_button.state!=lr.Empty&&(e.nitro_button.state=lr.TransitionOut),e.ability_button.state!=be.None&&(e.ability_button.state=be.None,ze.pushToOld(e.ability_button)),t.current_camera_time=0,t.current_time=0,t.state=xn.WaitForFinished,t.type=n},Xt.disableCar=function(e){for(var t=0,n=e.all_bodies;t<n.length;){var i=n[t];++t,i.setShapeFilters(Si.only_to_ground)}for(var r=0,a=e.all_constraints;r<a.length;){var s=a[r];++r,s.set_active(!1)}e.main_body_entity.display.sprite.alpha=0,null!=e.main_body_background_sprite&&(e.main_body_background_sprite.alpha=0)},Xt.applyExplosion=function(e,t,n){Wn.playSoundInGameLevel(Gs.sound_explosion,n,e.get_position(),t,1600,1),Ae.applyExplosionImpulseToBodies(e.get_space(),[],e.get_position(),150,!1,200,600,1,2,.9)},Xt.destroyAllChallenges=function(e){for(var t=0,n=e.current_explosion_animations;t<n.length;){var i=n[t];++t,A.destroyAnimation(i,!0)}e.current_explosion_animations=[],null!=e.escape_from_wolf&&(e.escape_from_wolf.player_sheep=null,e.escape_from_wolf.player_wolf=null,e.escape_from_wolf.bot_wolf=null,e.escape_from_wolf.bot_sheep=null,e.escape_from_wolf=null),null!=e.mountain_rush&&(e.mountain_rush.flips_text.destroy(!0),e.mountain_rush=null),null!=e.survival&&(e.survival.text.destroy(!0),e.survival.barrel_platforms=null,e.survival.text=null,e.survival=null),null!=e.balancing&&(e.balancing.box=null,e.balancing=null),null!=e.bullet_taxi&&(e.bullet_taxi.text.destroy(!0),e.bullet_taxi.text=null,e.bullet_taxi=null),null!=e.achievement&&(e.achievement=null),null!=e.credits&&(e.credits=null)},Xt.updateChallengesCommonStuff=function(e,t){for(var n=0,i=e.current_explosion_animations;n<i.length;){var r=i[n];++n;var a=ma.clamp(t.dc,0,2);if(A.nextFrameStep(r,a)){A.destroyAnimation(r,!0),s.remove(e.current_explosion_animations,r);break}}},Xt.updateEscapeFromWolfChallenge=function(e,t,n,i,r,a,l,o){var _=null;if(e.challenge_type==kr.ChallengeEscapeFromWolf)_=e.bot_wolf.car;else if(e.challenge_type==kr.ChallengeHuntThePrey&&(_=e.player_wolf.car,!e.player_wolf.finished_race))for(var p=0,u=e.bot_sheep;p<u.length;){var h=u[p];++p,h.finished_race&&Xt.endRace(r,i,wn.LevelEndFail,l)}if(_.main_body_position_x>=e.wolf_finish_position.x){null!=e.player_wolf?e.player_wolf.behavior_activated=!1:null!=e.bot_wolf&&(e.bot_wolf.behavior_activated=!1);var c=_.back_wheel_body;c.set_angularVel(.5*c.get_angularVel());var d=_.front_wheel_body;d.set_angularVel(.5*d.get_angularVel())}for(var m=e.player_sheep,f=e.player_wolf,g=_.main_body.get_arbiters().iterator();g.hasNext();){var v=g.next();if(v.isCollisionArbiter()){if(null!=m&&!m.finished_race&&(v.get_body1()==m.car.main_body||v.get_body2()==m.car.main_body)){var b=Xt.createExplosionAnimation(n.group.container,m.car.main_body.get_position().get_x(),e.player_sheep.car.main_body.get_position().get_y());return a.push(b),Xt.applyExplosion(m.car.main_body,m.car,o),m.behavior_activated=!1,Xt.disableCar(m.car),e.player_sheep=null,void Xt.endRace(r,i,wn.LevelEndFail,l)}for(var y=0,x=e.bot_sheep;y<x.length;){var z=x[y];if(++y,v.get_body1()==z.car.main_body||v.get_body2()==z.car.main_body){var w=Xt.createExplosionAnimation(n.group.container,z.car.main_body.get_position().get_x(),z.car.main_body.get_position().get_y());if(a.push(w),null!=m?Xt.applyExplosion(z.car.main_body,m.car,o):null!=f&&Xt.applyExplosion(z.car.main_body,f.car,o),z.behavior_activated=!1,Xt.disableCar(z.car),s.remove(e.bot_sheep,z),e.challenge_type==kr.ChallengeHuntThePrey&&0==e.bot_sheep.length)return void Xt.endRace(r,i,wn.LevelEndWin,l);break}}}}},Xt.updateMountainRushChallenge=function(e,t,n,i,r,a,s,l,o){o&&(null==e.flips_text.parent&&r.add(e.flips_text),e.flips_text.position.x=t.current_game_width-150,e.flips_text.position.y=t.current_game_height/6);var _=Lt.flip_count,p=i.stats.total_back_flips+i.stats.total_front_flips;e.flips_text.text=p+"/"+_+" flips",s.car.main_body_position_x>e.mountain_finish_position.x&&s.behavior_activated&&Xt.endRace(s,a,_<=p?wn.LevelEndWin:wn.LevelEndFail,l)},Xt.updateSurvivalChallenge=function(e,t,n,i,r,a,s,l,o,_,p){for(var u=0,h=e.barrel_platforms.length;u<h;){var c=u++,d=e.barrel_platforms[c];if(d.animate_arrow){d.arrow_animation_current_time+=n.step_size;var m=ma.clamp0to1(d.arrow_animation_current_time/jt.arrow_animation_time);d.arrow.display.sprite.alpha=1-m,d.arrow.position.y+=jt.arrow_speed_y,he.refresh(d.arrow),1==m&&(d.animate_arrow=!1)}if(null!=d.ground.body.get_space()&&!(s.car.main_body.get_velocity().get_x()<=0)){var f=(d.barrel.position.x-s.car.main_body.get_position().get_x())/s.car.main_body.get_velocity().get_x(),g=1;c<Ft.barrel_fall_time_array.length&&(g=Ft.barrel_fall_time_array[c]),f<=g&&(d.animate_arrow=!0,d.ground.display.sprite.alpha=0,d.ground.body.set_space(null))}}if(s.car.main_body.get_userData().just_exploded){s.car.main_body.get_userData().just_exploded=!1;var v=s.car.main_body.get_userData().last_explosion_t,b=s.car.main_body.get_userData().last_final_explosion_modifier*v*Ft.damage_coeff;e.current_damage+=b,e.current_damage=e.current_damage}if(o){var y=Math.ceil(Ft.total_health-e.current_damage);if(y<=0&&(y=0,s.behavior_activated)){var x=Xt.createExplosionAnimation(i.group.container,s.car.main_body.get_position().get_x(),s.car.main_body.get_position().get_y());_.push(x),Xt.applyExplosion(s.car.main_body,s.car,p),s.behavior_activated=!1,Xt.disableCar(s.car),Xt.endRace(s,a,wn.LevelEndFail,l)}null==e.text.parent&&r.add(e.text),e.text.position.x=t.current_game_width+Ft.text_offset,e.text.position.y=t.current_game_height/6,e.text.text="Health: "+y+"/"+Ft.total_health}},Xt.updateBalancingChallenge=function(e,t,n,i,r,a,s,l){null!=e.box&&(e.box.state!=Vi.Broken&&e.box.state!=Vi.Removed||s.behavior_activated&&Xt.endRace(s,a,wn.LevelEndFail,l))},Xt.updateBulletTaxiChallenge=function(e,t,n,i,r,a,s,l){if(s.behavior_activated){null==e.text.parent&&r.add(e.text);var o=ma.clamp0to1(e.current_time/Gt.max_time);e.text.position.x=t.current_game_width+Gt.text_offset,e.text.position.y=t.current_game_height/6;var _=Math.round((1-o)*Gt.max_time);e.text.text=1==_?_+" second left":_+" seconds left",e.current_time+=n.step_size,s.abilities.nitro_power.activated||Ae.activateOrExtendConstantPower(s.abilities.nitro_power,s.car,60*Gt.max_time),1==o&&Xt.endRace(s,a,wn.LevelEndFail,l)}},Xt.updateAchievementChallenge=function(e,t,n,i,r,a,s,l){s.behavior_activated},Xt.updateCreditsChallenge=function(e,t,n,i,r,a,s,l,o){if(t.camera.zoom_min=.7,t.camera.zoom_max=.7,t.temp_dc_coeff=.5,Vn.setInGameControlsAlpha(t,0),l.behavior_activated&&(l.constant_drive=!1,e.balloons_attached||null!=t.partition_top&&null!=t.entity_partition_container&&(Vn.spawnAttachment(t,t.partition_top,t.entity_partition_container,l.car,Be.AttachmentBalloon,-1),Vn.spawnAttachment(t,t.partition_top,t.entity_partition_container,l.car,Be.AttachmentBalloon,-1),e.balloons_attached=!0),e.balloons_attached&&l.car.main_body_position_y<-5e3)){var _=s;if(null==_.challenge_button.parent&&t.menu_container.add(_.challenge_button),_.challenge_button.position.x=t.js_info.current_game_width/2,_.challenge_button.position.y=t.js_info.current_game_height/2,Vn.isObjectDownedInRadius(_.challenge_button,t.pointer,_.challenge_button.height/2+15)&&Vn.gotoNewLevel(t,i,t.inter_level_menu_save))return!1}return!0};var Ht=function(){};(n["bikas.game.ContainerConnection"]=Ht).__name__=["bikas","game","ContainerConnection"],Ht.prototype={source_container:null,connected_container:null,__class__:Ht};var Yt=function(){};(n["bikas.game.ContainerBody"]=Yt).__name__=["bikas","game","ContainerBody"],Yt.prototype={body:null,partition_objects:null,__class__:Yt};var Jt=function(){};(n["bikas.game.ContainerDo"]=Jt).__name__=["bikas","game","ContainerDo"],Jt.createAndConnectContainers=function(e,t){var n=new Ht;return n.source_container=e,n.connected_container=t,n},Jt.updateConnectedContainers=function(e){e.connected_container.x=e.source_container.x,e.connected_container.y=e.source_container.y,e.connected_container.rotation=e.source_container.rotation},Jt.createContainerBody=function(e,t){var n=new Yt;return n.body=null!=t?t:new C_(e,y_.get(0,0)),n.partition_objects=[],n},Jt.addDisplayObject=function(e,t,n,i,r,a){null==a&&(a=-1);var s=Fa.insertNewObjectToLiveTree(t,n,i,!0,r,a);e.partition_objects.push(s)},Jt.setSpace=function(e,t){e.body.set_space(t)},Jt.destroyContainerBody=function(e,t,n){e.body.set_space(null);for(var i=0,r=e.partition_objects;i<r.length;){var a=r[i];++i,Fa.destroyLiveObject(t,a,n)}e.body=null,e.partition_objects=null},Jt.updateContainerBody=function(e){for(var t=e.body,n=0,i=e.partition_objects;n<i.length;){var r=i[n];++n,r.display_object.position.x=t.get_position().get_x(),r.display_object.position.y=t.get_position().get_y(),r.display_object.rotation=t.get_rotation()}};var Kt=function(){this.finish_times=[]};(n["bikas.game.CarRank"]=Kt).__name__=["bikas","game","CarRank"],Kt.prototype={name:null,finish_times:null,total_time:null,average_time:null,median_time:null,worst_time:null,best_time:null,difference_time:null,__class__:Kt};var Qt=n["bikas.game.RestartMode"]={__ename__:["bikas","game","RestartMode"],__constructs__:["Quick","LevelFinish"]};Qt.Quick=["Quick",0],Qt.Quick.toString=i,(Qt.Quick.__enum__=Qt).LevelFinish=["LevelFinish",1],Qt.LevelFinish.toString=i,(Qt.LevelFinish.__enum__=Qt).__empty_constructs__=[Qt.Quick,Qt.LevelFinish];var $t=function(){this.initraces=[],this.levelloads=[],this.updates=[],this.car_ranks=[],this.runtime_info=null,this.camera_control=new rn,this.capture_control=new Ct,this.current_ai_decisions="",this.restart_mode=Qt.Quick};(n["bikas.game.Temp"]=$t).__name__=["bikas","game","Temp"],$t.prototype={restart_mode:null,current_ai_decisions:null,capture_control:null,camera_control:null,runtime_info:null,car_ranks:null,updates:null,levelloads:null,initraces:null,__class__:$t};var en=n["bikas.game.CameraControlType"]={__ename__:["bikas","game","CameraControlType"],__constructs__:["Free","ImitatePlayer","AttachedToPlayer"]};en.Free=["Free",0],en.Free.toString=i,(en.Free.__enum__=en).ImitatePlayer=["ImitatePlayer",1],en.ImitatePlayer.toString=i,(en.ImitatePlayer.__enum__=en).AttachedToPlayer=["AttachedToPlayer",2],en.AttachedToPlayer.toString=i,(en.AttachedToPlayer.__enum__=en).__empty_constructs__=[en.Free,en.ImitatePlayer,en.AttachedToPlayer];var tn=n["bikas.game.InterpolationType"]={__ename__:["bikas","game","InterpolationType"],__constructs__:["Linear","SmoothStart","SmoothEnd","SmoothStartEnd"]};tn.Linear=["Linear",0],tn.Linear.toString=i,(tn.Linear.__enum__=tn).SmoothStart=["SmoothStart",1],tn.SmoothStart.toString=i,(tn.SmoothStart.__enum__=tn).SmoothEnd=["SmoothEnd",2],tn.SmoothEnd.toString=i,(tn.SmoothEnd.__enum__=tn).SmoothStartEnd=["SmoothStartEnd",3],tn.SmoothStartEnd.toString=i,(tn.SmoothStartEnd.__enum__=tn).__empty_constructs__=[tn.Linear,tn.SmoothStart,tn.SmoothEnd,tn.SmoothStartEnd];var nn=function(){this.fixed_zoom_target=1,this.smooth_steps_before=50,this.right_mouse_down_zoom=1,this.right_mouse_down_point=null,this.camera_pos=new ea(0,0),this.drag_down_position=new ea(0,0)};(n["bikas.game.ManualCamera"]=nn).__name__=["bikas","game","ManualCamera"],nn.prototype={drag_down_position:null,camera_pos:null,right_mouse_down_point:null,right_mouse_down_zoom:null,smooth_steps_before:null,fixed_zoom_target:null,__class__:nn};var rn=function(){this.running=!1,this.current_follow_time=0,this.current_time=0,this.current_deattach_coeff=1,this.deattach_point=new ea(0,0),this.camera_position=new ea(0,0),this.offset_end=new ea(0,0),this.offset_start=new ea(0,-300),this.end_zoom=1,this.start_zoom=.3,this.speed=10,this.degrees=0,this.smooth_steps=0,this.interpolation_type=tn.SmoothStartEnd,this.type=en.AttachedToPlayer,this.slow_down_while_following_at=-1};(n["bikas.game.CameraControl"]=rn).__name__=["bikas","game","CameraControl"],rn.prototype={slow_down_while_following_at:null,type:null,interpolation_type:null,smooth_steps:null,degrees:null,speed:null,start_zoom:null,end_zoom:null,offset_start:null,offset_end:null,camera_position:null,deattach_point:null,current_deattach_coeff:null,current_time:null,current_follow_time:null,interpolate_func:null,running:null,__class__:rn};var an=n["bikas.game.TitleTransitionState"]={__ename__:["bikas","game","TitleTransitionState"],__constructs__:["None","Init","FadeIn","PopInTitle","ScaleUpTitle","AlphaOutTitle","Done"]};an.None=["None",0],an.None.toString=i,(an.None.__enum__=an).Init=["Init",1],an.Init.toString=i,(an.Init.__enum__=an).FadeIn=["FadeIn",2],an.FadeIn.toString=i,(an.FadeIn.__enum__=an).PopInTitle=["PopInTitle",3],an.PopInTitle.toString=i,(an.PopInTitle.__enum__=an).ScaleUpTitle=["ScaleUpTitle",4],an.ScaleUpTitle.toString=i,(an.ScaleUpTitle.__enum__=an).AlphaOutTitle=["AlphaOutTitle",5],an.AlphaOutTitle.toString=i,(an.AlphaOutTitle.__enum__=an).Done=["Done",6],an.Done.toString=i,(an.Done.__enum__=an).__empty_constructs__=[an.None,an.Init,an.FadeIn,an.PopInTitle,an.ScaleUpTitle,an.AlphaOutTitle,an.Done];var sn=function(){this.current_time=0};(n["bikas.game.TitleTransition"]=sn).__name__=["bikas","game","TitleTransition"],sn.prototype={state:null,current_time:null,container:null,background:null,title:null,__class__:sn};var ln=function(){this.code=[],this.fps=[]};(n["bikas.game.RuntimeTextInformation"]=ln).__name__=["bikas","game","RuntimeTextInformation"],ln.prototype={fps:null,code:null,build_text:null,last_scale_text:null,fps_text:null,code_text:null,memory_text:null,__class__:ln};var on=function(){};(n["bikas.game.MovingCircle"]=on).__name__=["bikas","game","MovingCircle"],on.prototype={sprite:null,frame:null,min_scale:null,max_scale:null,__class__:on};var _n=function(){};(n["bikas.game.UpgradeValues"]=_n).__name__=["bikas","game","UpgradeValues"],_n.prototype={__class__:_n};var pn=function(e,t,n,i,r){this.level=e,this.step_size=t,this.decay=n,this.width_cut=i,this.height=r};(n["bikas.game.PerlinStuff"]=pn).__name__=["bikas","game","PerlinStuff"],pn.prototype={level:null,step_size:null,decay:null,width_cut:null,height:null,__class__:pn};var un=function(e,t){this.current=e,this.max=t};(n["bikas.game.Wait"]=un).__name__=["bikas","game","Wait"],un.prototype={current:null,max:null,__class__:un};var hn=function(e){this.offset=new ea,this.object=e};(n["bikas.game.ObjectDrag"]=hn).__name__=["bikas","game","ObjectDrag"],hn.prototype={object:null,offset:null,__class__:hn};var cn=function(){this.is_button=!1,this.default_value=null,this.current_value=null,this.values=null,this.field="",this.object=null};(n["bikas.game.DebugOption"]=cn).__name__=["bikas","game","DebugOption"],cn.prototype={text:null,object:null,field:null,values:null,current_value:null,default_value:null,is_button:null,__class__:cn};var dn=function(){};(n["bikas.game.ResolutionOption"]=dn).__name__=["bikas","game","ResolutionOption"],dn.prototype={forced:null,text:null,width:null,height:null,__class__:dn};var mn=e.bikas.game.DebugDo=function(){};(n["bikas.game.DebugDo"]=mn).__name__=["bikas","game","DebugDo"],mn.createDebugMenu=function(e,t,n){var i=e.debug_element,r=e.pointer,a=null,s=e.config.development;Pa.addButton(i,"reload iframe",function(){$s.game.removeAllListeners();for(var t=0,n=$s.top_listeners;t<n.length;){var r=n[t];++t,r.element.removeEventListener(r.type,r.func)}for(;null!=i.firstChild;)i.removeChild(i.firstChild);var a=lo.get_document().getElementById("fps"),s=lo.get_document().getElementById("ms"),l=lo.get_document().getElementById("memory");a.parentNode.removeChild(a),s.parentNode.removeChild(s),l.parentNode.removeChild(l),Vn.destroyLevel(e,!0,!1),$s.game.destroy(),Vn.nullTheExternalFunctionCalls(),lo.get_window().parent.window.is_reload=!0;var o=Vn.getIframeElement();o.contentWindow.location.reload(),o.src=o.src}),e.config.development.show_update_times&&(Pa.addFieldWatch(i,n,"game_update_time"),Pa.addFieldWatch(i,n,"dc"),Pa.addFieldWatch(i,mn,"physics_update_time"),Pa.addFieldWatch(i,mn,"total_space_steps"),Pa.addFieldEdit(i,Un,"physics_velocity_iterations"),Pa.addFieldEdit(i,Un,"physics_position_iterations")),e.temp.updates.push(function(){Ii.isPressed(e.keyboard_keys_pressed,82)?e.temp_dc_coeff=3:Ii.isReleased(e.keyboard_keys_released,82)&&(e.temp_dc_coeff=1),Ii.isReleased(e.keyboard_keys_released,70)&&(e.physics_running=!e.physics_running)}),Pa.addButton(i,"show/hide guideliness",function(){if(null==a){a=qa.createGraphics(),e.game_container.add(a);var n=t.current_game_width,i=t.current_game_height;a.lineStyle(4,0,1),a.moveTo(0,0),a.lineTo(n,0),a.moveTo(0,i/3),a.lineTo(n,i/3),a.moveTo(0,2*i/3),a.lineTo(n,2*i/3),a.moveTo(0,i),a.lineTo(n,i),a.moveTo(0,0),a.lineTo(0,i),a.moveTo(n/3,0),a.lineTo(n/3,i),a.moveTo(2*n/3,0),a.lineTo(2*n/3,i),a.moveTo(n,0),a.lineTo(n,i)}else a.destroy(!0),a=null}),Pa.addButton(i,"pause/unpause",function(){e.game_running=!e.game_running}),Pa.addButton(i,"update once and pause",function(){e.game_running=!0,e.pause_after_1_update=!0});var l=[],o=function(e,t,n,i){null==i&&(i=!0);var r=new dn;r.text=e,r.width=t,r.height=n,r.forced=i,l.push(r)};o("1280x720",1280,720,!1),o("960x720",960,720,!1),o("1280x720 (no scale)",1280,720),o("877x405 (iPhone X)",877,405),o("720x405 (default)",720,405),o("640x360 (no scale)",640,360),o("640x480 (no scale)",640,480),o("480x270 (no scale)",480,270),o("600x300 (no scale)",600,300),o("750x500 (no scale)",750,500),o("600x500 (no scale)",600,500),o("500x500 (no scale)",500,500),o("500x600 (no scale)",500,600),o("500x750 (no scale)",500,750),o("300x600 (no scale)",300,600),o("360x640 (no scale)",360,640),o("283x614 (iPhone X)",283,614);for(var _=[],p=0;p<l.length;){var u=l[p];++p,_.push(u.text)}var h="720x405 (default)";if(null!=t.force_size)for(var c=0;c<l.length;){var d=l[c];if(++c,d.forced&&d.width==t.force_size.width&&d.height==t.force_size.height){h=d.text;break}}Pa.addItemSelect(i,h,_,"resolution",!1,function(n,i){for(var r=i,a=0;a<l.length;){var s=l[a];++a,s.text==r&&(s.forced?t.force_size=new aa(s.width,s.height):(t.max_game_width=s.width,t.max_game_height=s.height,t.force_size=null))}el.scaleAndCenter(e.game_container,t)}),Pa.addText(i,"Gameplay Bot",!1,!0),Pa.addButton(i,"Start Gameplay Bot",function(){e.gameplay_bot_enabled=!0,e.use_bot_to_control_player=!0,Nl.trace("gameplay_bot: ON",{fileName:"DebugDo.hx",lineNumber:729,className:"bikas.game.DebugDo",methodName:"createDebugMenu"})}),Pa.addButton(i,"Stop Gameplay Bot",function(){e.gameplay_bot_enabled=!1,e.use_bot_to_control_player=!1,Nl.trace("gameplay_bot: OFF",{fileName:"DebugDo.hx",lineNumber:738,className:"bikas.game.DebugDo",methodName:"createDebugMenu"})}),e.config.development.capture_mode&&Nt.create(e,i),Pa.addBoolEdit(i,e.config.development,"bot_decisions_enabled"),Pa.addBoolEdit(i,e.config.development,"filter_out_bots"),Pa.addItemSelect(i,e.game_save.current_car,cr.all_cars,"current_car",!1,function(t,n){e.game_save.current_car=cr.all_cars[t]}),Pa.addButton(i,"teleport player to finish",function(){Vn.teleportPlayerToFinish(e)}),Pa.addFieldEdit(i,_r,"down_scale"),Pa.addFieldEdit(i,_r,"down_rotation"),Pa.addFieldEdit(i,_r,"clockwise_rotation"),Pa.addFieldEdit(i,_r,"anti_clockwise_rotation"),Pa.addButton(i,"increase nitro",function(){null!=e.player&&e.player.abilities.nitro_power_charge++});var m=new nn;e.temp.camera_control.type=en.Free,nn.zoom_speed=e.config.development.capture_mode?(nn.smooth_steps=100,nn.scroll_coeff=10,nn.zoom_coeff=.005,.001):(nn.smooth_steps=5,nn.scroll_coeff=30,nn.zoom_coeff=.005,1e3),e.temp.updates.push(function(){if(Ii.isPressed(e.keyboard_keys_released,67))if(s.manual_camera_control)s.manual_camera_control=!1,s.fixed_camera_zoom=-1,e.camera.smooth_steps=m.smooth_steps_before,null!=e.player&&(e.player.behavior_activated=!0),e.level_type==Zn.InRacing&&Vn.setInGameControlsAlpha(e,1);else{s.manual_camera_control=!0,s.fixed_camera_zoom=m.fixed_zoom_target,m.smooth_steps_before=e.camera.smooth_steps,m.fixed_zoom_target=e.camera.current_zoom,e.camera.smooth_steps=nn.smooth_steps,e.temp.camera_control.camera_position.x=e.camera.target_pos.get_x();var t=e.camera.target_pos.get_y();e.temp.camera_control.camera_position.y=t-50,null!=e.player&&(e.player.behavior_activated=!1),e.level_type==Zn.InRacing&&Vn.setInGameControlsAlpha(e,0)}if(s.manual_camera_control){if(Ii.isPressed(e.keyboard_keys_pressed,16)){var n=$s.right_mouse_button_down;if(n){if(null!=m.right_mouse_down_point){var i=nn.zoom_coeff,a=-(r.main_pointer_object.current.y-m.right_mouse_down_point.y)*i+m.right_mouse_down_zoom;m.fixed_zoom_target=ma.clamp(a,.1,1)}}else if(r.main_pointer_object.state==Ja.DOWNED){m.drag_down_position.x=r.main_pointer_object.current.x,m.drag_down_position.y=r.main_pointer_object.current.y;var l=e.camera.target_pos.get_x(),o=e.camera.target_pos.get_y();m.camera_pos=new ea(l,o)}else if(r.main_pointer_object.state==Ja.IS_DOWN){var _=nn.scroll_coeff,p=r.main_pointer_object.current.x-m.drag_down_position.x,u=r.main_pointer_object.current.y-m.drag_down_position.y;e.temp.camera_control.camera_position.x=-p*_+m.camera_pos.x,e.temp.camera_control.camera_position.y=-u*_+m.camera_pos.y}n?null==m.right_mouse_down_point&&(-1==s.fixed_camera_zoom&&(s.fixed_camera_zoom=1),m.right_mouse_down_point=new ea(r.main_pointer_object.current.x,r.main_pointer_object.current.y),m.right_mouse_down_zoom=s.fixed_camera_zoom):m.right_mouse_down_point=null,Ii.isPressed(e.keyboard_keys_pressed,80)&&(null!=e.player?(e.temp.camera_control.camera_position.x=e.player.car.main_body_entity.position.x,e.temp.camera_control.camera_position.y=e.player.car.main_body_entity.position.y):null!=e.menu_camera_position&&(e.temp.camera_control.camera_position.x=e.menu_camera_position.x,e.temp.camera_control.camera_position.y=e.menu_camera_position.y))}s.fixed_camera_zoom<m.fixed_zoom_target?(s.fixed_camera_zoom+=e.step.dc*nn.zoom_speed,s.fixed_camera_zoom>m.fixed_zoom_target&&(s.fixed_camera_zoom=m.fixed_zoom_target)):s.fixed_camera_zoom>m.fixed_zoom_target&&(s.fixed_camera_zoom-=e.step.dc*nn.zoom_speed,s.fixed_camera_zoom<m.fixed_zoom_target&&(s.fixed_camera_zoom=m.fixed_zoom_target))}}),Pa.addButton(i,"reset tutorial in game_save",function(){e.game_save.tutorial_shown_controls=!1,e.game_save.tutorial_shown_jump=!1,e.game_save.tutorial_shown_nitro=!1,e.game_save.tutorial_shown_power=!1})},mn.createRuntimeTextInformation=function(e,t,n,i){var r=0==e.type&&e.development.show_build_information||1==e.type&&e.release.show_build_information,a=0==e.type&&e.development.show_performance_information||1==e.type&&e.release.show_performance_information;if(0==r&&0==a)return null;var s=new ln,l=Ma.getTimer(),o=fn.consolas_24;s.fps_text=new ms($s.game,0,0,o,"",20,"center"),s.fps_text.anchor.set(0,0),s.fps_text.y=5,s.code_text=new ms($s.game,0,0,o,"",20,"center"),s.code_text.anchor.set(0,0),s.code_text.y=5,s.memory_text=new ms($s.game,0,0,o,"",20,"center"),s.memory_text.anchor.set(0,0),s.memory_text.y=5,s.build_text=new ms($s.game,0,0,o,"",20,"center"),s.build_text.anchor.set(0,0);var _=n.build_time,p=new Date(_);s.build_text.x=5,s.build_text.y=5;var u="";if($s.renderer.type==PIXI.RENDERER_TYPE.CANVAS?u="canvas":$s.renderer.type==PIXI.RENDERER_TYPE.WEBGL?u="webgl":Nl.trace("warning: unrecognized renderType "+$s.renderer.type,{fileName:"DebugDo.hx",lineNumber:3082,className:"bikas.game.DebugDo",methodName:"createRuntimeTextInformation"}),r){s.build_text.text="build: ",s.build_text.text+=Ma.getWellFormattedDate(p),s.build_text.text+=" "+u;var h="";n.desktop?h=n.windows?"windows":n.macOS?"macOS":n.linux?"linux":n.chromeOS?"chromeOS":"desktop":n.android?h="android":n.iOS?h="iOS":n.vita?h="vita":n.kindle?h="kindle":n.windowsPhone&&(h="windowsPhone"),s.build_text.text+="-"+h,Howler.usingWebAudio?s.build_text.text+="-web_audio":Howler.noAudio?s.build_text.text+="-no_audio":s.build_text.text+="-html5_audio",1==e.type&&0==e.release.sitelock_type&&(s.build_text.text+="-NO_ST!!!"),t.add(s.build_text)}return a&&(t.add(s.fps_text),t.add(s.code_text)),$s.game_update_data.top_scripts.push(function(){if(a){var e=Ma.getTimer(),t=1e3/(e-l);l=e,s.fps.push(t),60<s.fps.length&&s.fps.shift();for(var n=0,r=999,o=0,_=0,p=s.fps;_<p.length;){var u=p[_];++_,n+=u,u<r&&(r=u),o<u&&(o=u)}var h=n/s.fps.length;s.code.push(i.game_update_time),60<s.code.length&&s.code.shift();for(var c=0,d=999,m=0,f=0,g=s.code;f<g.length;){var v=g[f];++f,c+=v,v<d&&(d=v),m<v&&(m=v)}var b=c/s.code.length,y=(i.game_update_time,Math.round(100*i.level_seconds)/100+""),x=y.split(".");0==x.length?(x.push(y),x.push("")):1==x.length&&x.push(""),x[0];var z=x[1];0==z.length?z="00":1==z.length?z+="0":2<z.length&&(z=z.substring(0,2)),s.fps_text.text=" F:"+Math.round(h)+"/"+Math.round(r)+"/"+Math.round(o),s.code_text.text=" C:"+Math.round(b)+"/"+Math.round(d)+"/"+Math.round(m),s.fps_text.x=650,s.code_text.x=800}}),s},mn.bytesToMegabytesRounded=function(e){return Math.round(e/1048576)},mn.insertAfter=function(e,t){null==e.nextSibling?e.parentNode.appendChild(t):e.nextSibling.parentNode.insertBefore(t,e.nextSibling)},mn.applyLevelUpgradesToAll=function(e,t){var n=new gr,i=(t.car_upgrade_data,(e-1)/29);i=ma.clamp(i,0,1),n.top_speed=va.linearRounded(0,9,i),n.acceleration=va.linearRounded(0,9,i),n.handling=va.linearRounded(0,9,i),n.armor=va.linearRounded(0,9,i),Nl.trace("apply level "+e+" upgrades to all cars: "+p.string(n),{fileName:"DebugDo.hx",lineNumber:3265,className:"bikas.game.DebugDo",methodName:"applyLevelUpgradesToAll"}),null!=Pr.getCarSettingByName(t.car_settings,t.player.car.name)&&(t.player.config=Pr.getUpgradedCarConfigCopy(t.car_upgrade_data,n,t.car_settings,t.player.car.name),null!=t.player_bot&&(t.player_bot.config=Pr.getUpgradedCarConfigCopy(t.car_upgrade_data,n,t.car_settings,t.player.car.name)));for(var r=0,a=t.bots;r<a.length;){var s=a[r];++r,null!=Pr.getCarSettingByName(t.car_settings,s.car.name)&&(s.config=Pr.getUpgradedCarConfigCopy(t.car_upgrade_data,n,t.car_settings,s.car.name))}},mn.createStaticFieldEdits=function(e,t){for(var n=0;n<t.length;){var i=t[n];++n;for(var r=i.split("."),a="",s="",l=0,o=r.length;l<o;){var _=l++;_==r.length-1?s=r[_]:a+=r[_],_<r.length-2&&(a+=".")}var p=d.resolveClass(a);Pa.addFieldEdit(e,p,s)}},mn.createStaticFieldWatches=function(e,t){for(var n=0;n<t.length;){var i=t[n];++n;for(var r=i.split("."),a="",s="",l=0,o=r.length;l<o;){var _=l++;_==r.length-1?s=r[_]:a+=r[_],_<r.length-2&&(a+=".")}var p=d.resolveClass(a);Pa.addFieldWatch(e,p,s)}},mn.addPointDebug=function(e,t,n){Pa.addFieldEdit(e,t,"x",n+".x"),Pa.addFieldEdit(e,t,"y",n+".y")},mn.printDisplayObjectInformation=function(e,t){for(var n=t;null!=n;){var i=mn.getDisplayObjectName(n);Nl.trace("is "+i,{fileName:"DebugDo.hx",lineNumber:3338,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"});var r=n;Nl.trace("object.position.x: "+r.position.x,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),Nl.trace("object.position.y: "+r.position.y,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),Nl.trace("object.width: "+r.width,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),Nl.trace("object.height: "+r.height,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),Nl.trace("object.scale.x: "+r.scale.x,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),Nl.trace("object.scale.y: "+r.scale.y,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),Nl.trace("object.visible: "+(null==r.visible?"null":""+r.visible),{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),Nl.trace("object.alpha: "+r.alpha,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),Nl.trace("goto parent",{fileName:"DebugDo.hx",lineNumber:3352,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),n=n.parent}},mn.getNameOfDisplayObjectWithParentNames=function(e){mn.game;for(var t=e,n=[];null!=t;)n.push(mn.getDisplayObjectName(t)),t=t.parent;return n},mn.getDisplayObjectName=function(e){var t=mn.game;if(null==e)return"null";var n="no_name";null!=t&&(null!=t.stage_group&&e==t.stage_group.group.container&&(n="stage_group.group.container"),e==t.game_container&&(n="game_container"),e==t.background_container&&(n="background_container"),null!=t.background&&(e==t.background.background_container?n="background.background_container":e==t.background.foreground_container?n="background.foreground_container":e==t.background.plane_container&&(n="background.plane_container")),e==t.background_ground_group&&(n="background_ground_group"),e==t.ground_group&&(n="ground_group"),e==t.grass_group&&(n="grass_group"),e==t.ground_container&&(n="ground_container"),e==t.entity_container&&(n="entity_container"),e==t.foreground_container&&(n="foreground_container"),e==t.ingame_container&&(n="ingame_container"),e==t.ability_item_container&&(n="ability_item_container"),e==t.ongoing_powers_container&&(n="ongoing_powers_container"),e==t.menu_container&&(n="menu_container"),e==t.runtime_information_container&&(n="runtime_information_container"));var i=e;null!=i.name&&(n=i.name);var r="",a="",s=!1;if(p.is(e,hs))r="Graphics";else if(p.is(e,fs)){r="Sprite";var l=e;if(null==l.texture)a="null";else{a="could not find";for(var o=0,u=_.fields(Gs);o<u.length;){var h=u[o];if(++o,l.texture==_.field(Gs,h)){a=h;break}}}-1!=fs.destroyed_sprite_list.indexOf(l)&&(s=!0)}else if(p.is(e,gs))r="Group",-1!=gs.destroyed_group_list.indexOf(e)&&(s=!0);else{var c=d.getClass(e);r=null==c?"null":d.getClassName(c)}return n+="(",n+="class:"+r,""!=a&&(n+=",texture:"+a),e.visible||(n+=",visible:false"),s&&(n+=",destroyed!!!"),n+")"},mn.getAllSprites=function(e,t){var n=p.is(e,PIXI.Sprite),i=p.is(e,PIXI.Container);if(n)t.push(e);else if(i)for(var r=so.__cast(e,PIXI.Container).children,a=0;a<r.length;){var s=r[a];++a,mn.getAllSprites(s,t)}},mn.putPoint=function(e,t,n){return null==n&&(n=10),null==t&&(t=16711680),mn.putMarker(e.x,e.y,t,n)},mn.putMarker=function(e,t,n,i){if(null==i&&(i=10),null==n&&(n=16711680),null==mn.debug_container)return null;var r=new hs($s.game),a=i/2;return r.lineStyle(1,n,1),r.moveTo(-a,-a),r.lineTo(a,a),r.moveTo(a,-a),r.lineTo(-a,a),r.position.set(e,t),r.cacheAsBitmap=!0,mn.debug_container.add(r),r},mn.putLinePoints=function(e,t,n){return null==n&&(n=16711680),mn.putLine(e.x,e.y,t.x,t.y,n)},mn.putLine=function(e,t,n,i,r,a){if(null==a&&(a=1),null==r&&(r=16711680),null==mn.debug_container)return null;var s=qa.createGraphics();return s.lineStyle(a,r,1),s.moveTo(e,t),s.lineTo(n,i),mn.debug_container.add(s),s},mn.putRectangle=function(e,t,n,i,r){if(null==i&&(i=16777215),null==n&&(n=!1),null==t&&(t=16711680),null==mn.debug_container&&null==r)return null;null==r&&(r=mn.debug_container);var a=qa.createGraphics();return a.position.set(e.x,e.y),n&&a.beginFill(i),a.lineStyle(2,t,1),a.moveTo(0,0),a.lineTo(e.width,0),a.lineTo(e.width,e.height),a.lineTo(0,e.height),a.lineTo(0,0),n&&a.endFill(),a.cacheAsBitmap=!0,r.add(a),a},mn.putCircle=function(e,t,n,i,r,a){if(null==r&&(r=16777215),null==i&&(i=!1),null==n&&(n=16711680),null==mn.debug_container&&null==a)return null;null==a&&(a=mn.debug_container);var s=new hs($s.game);return s.position.set(e.x,e.y),i&&s.beginFill(r),s.lineStyle(2,n,1),s.drawCircle(0,0,2*t),i&&s.endFill(),s.cacheAsBitmap=!0,a.add(s),s},mn.putTrajectory=function(e,t,n,i,r,a,s){if(null==s&&(s=10),null==a&&(a=-65536),null!=mn.debug_container)for(var l=n,o=t,_=e,p=i,u=r;p<u;){var h=p++,c=l.x*h*h/2+o.x*h+_.x,d=l.y*h*h/2+o.y*h+_.y;mn.putMarker(c,d,a,s)}};var fn=function(){};(n["bikas.game.Fonts"]=fn).__name__=["bikas","game","Fonts"];var gn=function(){};(n["bikas.game.FlyWithGraphics"]=gn).__name__=["bikas","game","FlyWithGraphics"],gn.prototype={container:null,body:null,wings:null,fly:null,__class__:gn};var vn=function(){};(n["bikas.game.AnimBody"]=vn).__name__=["bikas","game","AnimBody"],vn.prototype={anim:null,body:null,__class__:vn};var bn=function(){};(n["bikas.game.PostRequest"]=bn).__name__=["bikas","game","PostRequest"],bn.prototype={xhr:null,json:null,on_finished:null,__class__:bn};var yn=function(){this.transition_current_time=0};(n["bikas.game.LevelLoadScreen"]=yn).__name__=["bikas","game","LevelLoadScreen"],yn.prototype={transition_current_time:null,container:null,background:null,middle_container:null,title:null,loading_track_text:null,loader_background:null,loader_foreground:null,track_loader_foreground_original_frame:null,track_loader_foreground_current_frame:null,__class__:yn};var xn=n["bikas.game.LevelEndState"]={__ename__:["bikas","game","LevelEndState"],__constructs__:["None","WaitForFinished","FinishedAnimation","WaitForLevelStats","InLevelStats","InAd","InNext"]};xn.None=["None",0],xn.None.toString=i,(xn.None.__enum__=xn).WaitForFinished=["WaitForFinished",1],xn.WaitForFinished.toString=i,(xn.WaitForFinished.__enum__=xn).FinishedAnimation=["FinishedAnimation",2],xn.FinishedAnimation.toString=i,(xn.FinishedAnimation.__enum__=xn).WaitForLevelStats=["WaitForLevelStats",3],xn.WaitForLevelStats.toString=i,(xn.WaitForLevelStats.__enum__=xn).InLevelStats=["InLevelStats",4],xn.InLevelStats.toString=i,(xn.InLevelStats.__enum__=xn).InAd=["InAd",5],xn.InAd.toString=i,(xn.InAd.__enum__=xn).InNext=["InNext",6],xn.InNext.toString=i,(xn.InNext.__enum__=xn).__empty_constructs__=[xn.None,xn.WaitForFinished,xn.FinishedAnimation,xn.WaitForLevelStats,xn.InLevelStats,xn.InAd,xn.InNext];var zn=n["bikas.game.LevelEndNextState"]={__ename__:["bikas","game","LevelEndNextState"],__constructs__:["None","NextInterLevelMenu","NextCreditsLevel","NextRestartLevel"]};zn.None=["None",0],zn.None.toString=i,(zn.None.__enum__=zn).NextInterLevelMenu=["NextInterLevelMenu",1],zn.NextInterLevelMenu.toString=i,(zn.NextInterLevelMenu.__enum__=zn).NextCreditsLevel=["NextCreditsLevel",2],zn.NextCreditsLevel.toString=i,(zn.NextCreditsLevel.__enum__=zn).NextRestartLevel=["NextRestartLevel",3],zn.NextRestartLevel.toString=i,(zn.NextRestartLevel.__enum__=zn).__empty_constructs__=[zn.None,zn.NextInterLevelMenu,zn.NextCreditsLevel,zn.NextRestartLevel];var wn=n["bikas.game.LevelEndType"]={__ename__:["bikas","game","LevelEndType"],__constructs__:["LevelEndWin","LevelEndFail"]};wn.LevelEndWin=["LevelEndWin",0],wn.LevelEndWin.toString=i,(wn.LevelEndWin.__enum__=wn).LevelEndFail=["LevelEndFail",1],wn.LevelEndFail.toString=i,(wn.LevelEndFail.__enum__=wn).__empty_constructs__=[wn.LevelEndWin,wn.LevelEndFail];var kn=function(){this.famobi_posted=!1,this.current_time=0,this.current_camera_time=0,this.camera_position=new ea(0,0)};(n["bikas.game.LevelEnd"]=kn).__name__=["bikas","game","LevelEnd"],kn.prototype={type:null,state:null,next_state:null,camera_position:null,current_camera_time:null,finished_text:null,challenge_button:null,current_time:null,famobi_posted:null,__class__:kn};var Sn=function(){this.place_number=-1};(n["bikas.game.CurrentPlace"]=Sn).__name__=["bikas","game","CurrentPlace"],Sn.prototype={container:null,anim:null,place_number:null,player_position:null,__class__:Sn};var Cn=function(){this.challenge_text=null,this.engine_sound_allowed=!1,this.finished=!1,this.current_time=0,this.current_number=5};(n["bikas.game.RaceCountdown"]=Cn).__name__=["bikas","game","RaceCountdown"],Cn.prototype={container:null,animation:null,current_number:null,current_time:null,finished:null,engine_sound_allowed:null,challenge_text:null,__class__:Cn};var Nn=function(){this.current_anim_time=0,this.displayed_amount=-1,this.digit_count=1};(n["bikas.game.CoinDisplay"]=Nn).__name__=["bikas","game","CoinDisplay"],Nn.prototype={coin:null,text:null,digit_count:null,displayed_amount:null,current_anim_time:null,__class__:Nn};var Pn=function(e,t,n,i,r){null==r&&(r=1),null==i&&(i=5),null==n&&(n=10),null==t&&(t=10),null==e&&(e=60),this.current_duration=0,this.current_delay=e,this.duration=t,this.smooth_in_duration=n,this.smooth_out_duration=i,this.time_coeff=r};(n["bikas.game.SlowDownTime"]=Pn).__name__=["bikas","game","SlowDownTime"],Pn.prototype={duration:null,smooth_in_duration:null,smooth_out_duration:null,time_coeff:null,current_delay:null,current_duration:null,__class__:Pn};var Mn=function(){this.amount=0,this.current_time=0};(n["bikas.game.CameraShake"]=Mn).__name__=["bikas","game","CameraShake"],Mn.prototype={current_time:null,amount:null,__class__:Mn};var In=function(){this.wait_time=2,this.wait_before_phase_in_time=0};(n["bikas.game.Notify"]=In).__name__=["bikas","game","Notify"],In.prototype={primary_text:null,secondary_text:null,wait_before_phase_in_time:null,wait_time:null,__class__:In};var Tn=n["bikas.game.NotificationState"]={__ename__:["bikas","game","NotificationState"],__constructs__:["WaitBeforePhaseIn","PhaseIn","Wait","PhaseOut","None"]};Tn.WaitBeforePhaseIn=["WaitBeforePhaseIn",0],Tn.WaitBeforePhaseIn.toString=i,(Tn.WaitBeforePhaseIn.__enum__=Tn).PhaseIn=["PhaseIn",1],Tn.PhaseIn.toString=i,(Tn.PhaseIn.__enum__=Tn).Wait=["Wait",2],Tn.Wait.toString=i,(Tn.Wait.__enum__=Tn).PhaseOut=["PhaseOut",3],Tn.PhaseOut.toString=i,(Tn.PhaseOut.__enum__=Tn).None=["None",4],Tn.None.toString=i,(Tn.None.__enum__=Tn).__empty_constructs__=[Tn.WaitBeforePhaseIn,Tn.PhaseIn,Tn.Wait,Tn.PhaseOut,Tn.None];var An=function(){this.current_time=0,this.show_current=null,this.show_cue=[],this.state=Tn.None};(n["bikas.game.Notifications"]=An).__name__=["bikas","game","Notifications"],An.prototype={state:null,container:null,show_cue:null,show_current:null,primary_text:null,secondary_text:null,current_time:null,__class__:An};var Dn=function(){this.line_sprites=[],this.data=null};(n["bikas.game.TexturedPolygonEntity"]=Dn).__name__=["bikas","game","TexturedPolygonEntity"],Dn.prototype={entity:null,draw_bounds:null,data:null,line_sprites:null,__class__:Dn};var En=function(){this.line_sprites=[],this.sprites=[],this.sprite_objects=[],this.global_polygons_bounds=[],this.global_polygons=[],this.polygons=[],this.entities=[],this.has_physics_body=!1};(n["bikas.game.TerrainPolygon"]=En).__name__=["bikas","game","TerrainPolygon"],En.prototype={texture_name:null,texture:null,main_entity_position:null,has_physics_body:null,entities:null,polygons:null,global_polygons:null,global_polygons_bounds:null,sprite_objects:null,sprites:null,line_sprites:null,terrain:null,global_bounds:null,__class__:En};var On=function(){};(n["bikas.game.Marker"]=On).__name__=["bikas","game","Marker"],On.prototype={name:null,entity:null,position:null,bitmap_text:null,point_graphics:null,__class__:On};var Bn=n["bikas.game.PauseMenuCardConfirmationType"]={__ename__:["bikas","game","PauseMenuCardConfirmationType"],__constructs__:["None","GotoMainMenu","GotoGarage"]};Bn.None=["None",0],Bn.None.toString=i,(Bn.None.__enum__=Bn).GotoMainMenu=["GotoMainMenu",1],Bn.GotoMainMenu.toString=i,(Bn.GotoMainMenu.__enum__=Bn).GotoGarage=["GotoGarage",2],Bn.GotoGarage.toString=i,(Bn.GotoGarage.__enum__=Bn).__empty_constructs__=[Bn.None,Bn.GotoMainMenu,Bn.GotoGarage];var Ln=function(){};(n["bikas.game.PauseDebugOption"]=Ln).__name__=["bikas","game","PauseDebugOption"],Ln.prototype={bitmap_text:null,callback:null,__class__:Ln};var jn=function(){this.pause_debug_options=[],this.confirm_card=null,this.confirm_type=Bn.None};(n["bikas.game.PauseMenu"]=jn).__name__=["bikas","game","PauseMenu"],jn.prototype={container:null,background:null,button_play:null,button_restart:null,button_main_menu:null,button_garage:null,button_sounds:null,button_music:null,confirm_type:null,confirm_card:null,pause_debug_options:null,__class__:jn};var Fn=n["bikas.game.TutorialState"]={__ename__:["bikas","game","TutorialState"],__constructs__:["TutorialNone","TutorialPhaseOut","TutorialControls","TutorialJump","TutorialNitro","TutorialPower"]};Fn.TutorialNone=["TutorialNone",0],Fn.TutorialNone.toString=i,(Fn.TutorialNone.__enum__=Fn).TutorialPhaseOut=["TutorialPhaseOut",1],Fn.TutorialPhaseOut.toString=i,(Fn.TutorialPhaseOut.__enum__=Fn).TutorialControls=["TutorialControls",2],Fn.TutorialControls.toString=i,(Fn.TutorialControls.__enum__=Fn).TutorialJump=["TutorialJump",3],Fn.TutorialJump.toString=i,(Fn.TutorialJump.__enum__=Fn).TutorialNitro=["TutorialNitro",4],Fn.TutorialNitro.toString=i,(Fn.TutorialNitro.__enum__=Fn).TutorialPower=["TutorialPower",5],Fn.TutorialPower.toString=i,(Fn.TutorialPower.__enum__=Fn).__empty_constructs__=[Fn.TutorialNone,Fn.TutorialPhaseOut,Fn.TutorialControls,Fn.TutorialJump,Fn.TutorialNitro,Fn.TutorialPower];var Rn=function(){this.wheel_angle=0,this.wheel_anim_current_time=0,this.phase_in_current_time=0,this.current_time=0,this.jump_marker=null,this.controls_marker=null,this.state=Fn.TutorialNone};(n["bikas.game.TutorialMenu"]=Rn).__name__=["bikas","game","TutorialMenu"],Rn.prototype={state:null,container:null,background:null,white_circle:null,white_circle2:null,text:null,keyboard_controls:null,wheel:null,finger:null,jump_button:null,nitro_button:null,power_button:null,mobile_clockwise_button:null,mobile_anti_clockwise_button:null,controls_marker:null,jump_marker:null,current_time:null,phase_in_current_time:null,wheel_anim_current_time:null,wheel_angle:null,__class__:Rn};var Gn=n["bikas.game.GameState"]={__ename__:["bikas","game","GameState"],__constructs__:["InGameLoad","InTransitionToLevelLoad","InLevelLoad","InTransitionToLevel","InLevel","InPause"]};Gn.InGameLoad=["InGameLoad",0],Gn.InGameLoad.toString=i,(Gn.InGameLoad.__enum__=Gn).InTransitionToLevelLoad=["InTransitionToLevelLoad",1],Gn.InTransitionToLevelLoad.toString=i,(Gn.InTransitionToLevelLoad.__enum__=Gn).InLevelLoad=["InLevelLoad",2],Gn.InLevelLoad.toString=i,(Gn.InLevelLoad.__enum__=Gn).InTransitionToLevel=["InTransitionToLevel",3],Gn.InTransitionToLevel.toString=i,(Gn.InTransitionToLevel.__enum__=Gn).InLevel=["InLevel",4],Gn.InLevel.toString=i,(Gn.InLevel.__enum__=Gn).InPause=["InPause",5],Gn.InPause.toString=i,(Gn.InPause.__enum__=Gn).__empty_constructs__=[Gn.InGameLoad,Gn.InTransitionToLevelLoad,Gn.InLevelLoad,Gn.InTransitionToLevel,Gn.InLevel,Gn.InPause];var Zn=n["bikas.game.LevelType"]={__ename__:["bikas","game","LevelType"],__constructs__:["InRacing","InMainMenu","InInterLevelMenu"]};Zn.InRacing=["InRacing",0],Zn.InRacing.toString=i,(Zn.InRacing.__enum__=Zn).InMainMenu=["InMainMenu",1],Zn.InMainMenu.toString=i,(Zn.InMainMenu.__enum__=Zn).InInterLevelMenu=["InInterLevelMenu",2],Zn.InInterLevelMenu.toString=i,(Zn.InInterLevelMenu.__enum__=Zn).__empty_constructs__=[Zn.InRacing,Zn.InMainMenu,Zn.InInterLevelMenu];var Un=function(){this.car_original_rotations=new Ol,this.camera_free=!1,this.draw_polygon_textures=!0,this.current_drag=null,this.drags=[],this.debug_element=null,this.temp=new $t,this.use_bot_to_control_player=!1,this.gameplay_bot_enabled=!1,this.gameplay_bot=new Xn,this.lagged_logo=null,this.menu_camera_position=null,this.current_gameplay_music=null,this.collected_in_level=null,this.level_stats=null,this.main_menu=null,this.inter_level_menu=null,this.race_countdown=null,this.current_place=null,this.attachments=[],this.jump_over_bodies=[],this.temp_interactive_objects=[],this.pickable_items=[],this.chickens=[],this.looped_animations=[],this.connected_containers=[],this.immune_bodies=[],this.explosives=[],this.forward_ramps=[],this.boxes=[],this.level_bottom_position=null,this.level_end_position=null,this.level_start_position=null,this.terrain_polygons=[],this.textured_polygons=[],this.visible_bounds=new ia,this.bots=[],this.player_bot=null,this.player=null,this.bot_cars=[],this.all_cars=[],this.wheel=null,this.textured_polygon_entities=[],this.camera=null,this.wait=null,this.slow_down_time=null,this.overlay_transitions=[],this.transitions=[],this.stunt=null,this.background=null,this.camera_shake=new Mn,this.markers=null,this.all_body_entities=null,this.challenges=new Wt,this.next_level_save=null,this.current_level_save=null,this.real_time_ground_graphics=[],this.real_time_background_ground_graphics=[],this.marker_group=null,this.mesh_line_sprites=[],this.ground_meshes=[],this.cave_meshes=[],this.notifications=new An,this.moving_circles=[],this.level_descriptions=[],this.all_reward_descs=[],this.background_edit=null,this.music_enabled=!0,this.sounds_enabled=!0,this.ongoing_powers_display=new Ur,this.credits_shown=!1,this.race_seconds=0,this.race_start_at_second=0,this.use_cached_terrain_polygons=!1,this.pre_wait_steps_current=0,this.pre_simulate_world_steps_current=0,this.background_camera_offset=new Gi(0,0,0),this.background_ratio=.3333333333333333,this.camera_view_ratio=.3333333333333333,this.current_camera_refresh_height_cache=0,this.current_camera_refresh_width_cache=0,this.current_camera_height_coeff=.6666666666666666,this.current_camera_width_coeff=.5,this.game_running=!0,this.pause_after_1_update=!1,this.level_end_enabled=!0,this.keyboard_keys_released=[],this.keyboard_keys_pressed=[],this.current_level_index=0,this.delta_update_coeff_by_effect=1,this.debug_dc_coeff=1,this.temp_dc_coeff=1,this.initial_game_save_loaded=!1,this.physics_running=!1,this.level_running=!1,this.is_webgl=!0,this.level_type=null,this.previous_state=null,this.state=null};(n["bikas.game.Game"]=Un).__name__=["bikas","game","Game"],Un.prototype={config:null,state:null,previous_state:null,level_type:null,is_webgl:null,game_container:null,background_container:null,ground_container:null,entity_container:null,foreground_container:null,ingame_container:null,ability_item_container:null,ongoing_powers_container:null,menu_container:null,runtime_information_container:null,engine:null,world:null,level_running:null,physics_running:null,bitmap_assets:null,animation_assets:null,library_group:null,stage_group_original:null,stage_group:null,initial_game_save_loaded:null,size:null,level_area:null,js_info:null,step:null,pointer:null,temp_dc_coeff:null,debug_dc_coeff:null,delta_update_coeff_by_effect:null,current_level_index:null,keyboard_keys_pressed:null,keyboard_keys_released:null,level_end_enabled:null,pause_after_1_update:null,game_running:null,current_camera_width_coeff:null,current_camera_height_coeff:null,current_camera_refresh_width_cache:null,current_camera_refresh_height_cache:null,camera_view_ratio:null,background_ratio:null,background_camera_offset:null,pre_simulate_world_steps_current:null,pre_wait_steps_current:null,use_cached_terrain_polygons:null,race_start_at_second:null,race_seconds:null,game_save:null,credits_shown:null,ongoing_powers_display:null,sounds_enabled:null,music_enabled:null,background_edit:null,game_save_serial_data:null,car_settings:null,car_upgrade_data:null,chest_reward_item_descs:null,achievement_descs:null,challenge_descs:null,all_reward_descs:null,level_descriptions:null,upgrades:null,ability_probabilities:null,first_level_save:null,main_menu_save:null,inter_level_menu_save:null,credits_save:null,achievement_save:null,moving_circles:null,pause_button:null,pause_menu:null,tutorial_menu:null,level_load_screen:null,level_end:null,coin_display:null,notifications:null,background_ground_group:null,ground_group:null,grass_group:null,cave_meshes:null,ground_meshes:null,mesh_line_sprites:null,marker_group:null,real_time_background_ground_graphics:null,real_time_ground_graphics:null,current_level_save:null,next_level_save:null,challenges:null,all_body_entities:null,markers:null,camera_shake:null,background:null,stunt:null,transitions:null,overlay_transitions:null,slow_down_time:null,wait:null,camera:null,textured_polygon_entities:null,wheel:null,all_cars:null,bot_cars:null,player:null,player_bot:null,bots:null,visible_bounds:null,textured_polygons:null,terrain_polygons:null,entity_partition_container:null,partition_top:null,level_start_position:null,level_end_position:null,level_bottom_position:null,boxes:null,forward_ramps:null,explosives:null,immune_bodies:null,connected_containers:null,looped_animations:null,chickens:null,pickable_items:null,temp_interactive_objects:null,jump_over_bodies:null,attachments:null,current_place:null,race_countdown:null,inter_level_menu:null,main_menu:null,level_stats:null,collected_in_level:null,current_gameplay_music:null,menu_camera_position:null,lagged_logo:null,gameplay_bot:null,gameplay_bot_enabled:null,use_bot_to_control_player:null,temp:null,debug_element:null,drags:null,current_drag:null,draw_polygon_textures:null,camera_free:null,car_original_rotations:null,__class__:Un};var Vn=e.bikas.game.GameDo=function(){};(n["bikas.game.GameDo"]=Vn).__name__=["bikas","game","GameDo"],Vn.createGame=function(e,t,n,i,r,a,s){var l=function(e){var t="";return t=(t=-1<e.indexOf("://")?e.split("/")[2]:e.split("/")[0]).split(":")[0],h.replace(t,"www.","")},o=function(e){try{if(null!=window.location.ancestorOrigins)for(var t=window.location.ancestorOrigins,n=0;n<t.length;){var i=t[n],r=l(i);if(-1==e.indexOf(r))return!1;++n}}catch(e){}if(lo.get_window().top!=lo.get_window().self){var a=l(lo.get_document().referrer);if(-1==e.indexOf(a))return!1}var s=l(lo.get_window().location.hostname);return-1!=e.indexOf(s)};if(1!=e.type||3!=e.release.sitelock_type){if(1==e.type&&1==e.release.sitelock_type&&!o(["bikas.net"])&&e.release.game_exit)return null;if(1==e.type&&2==e.release.sitelock_type&&!o(["lagged.com"])&&e.release.game_exit)return null;if(1==e.type&&4==e.release.sitelock_type&&!o(["famobi.com"])&&e.release.game_exit)return null}var _,u,c=new Un;(mn.game=c).pointer=i,c.js_info=t,c.pointer=i,c.config=e,c.engine=a,c.bitmap_assets=s,c.game_save_serial_data=qn.describeData(),c.game_container=r,c.background_container=qa.createGroup(),c.ground_container=qa.createGroup(),c.entity_container=qa.createGroup(),c.foreground_container=qa.createGroup(),c.ingame_container=qa.createGroup(),c.ability_item_container=qa.createGroup(),c.ongoing_powers_container=qa.createGroup(),c.menu_container=qa.createGroup(),c.runtime_information_container=qa.createGroup(),(u=(_=c).game_container).add(_.background_container),u.add(_.ground_container),u.add(_.entity_container),u.add(_.foreground_container),u.add(_.ingame_container),_.ingame_container.add(_.ability_item_container),_.ingame_container.add(_.ongoing_powers_container),u.add(_.menu_container),u.add(_.runtime_information_container),1!=e.type&&(mn.debug_container=qa.createGroup(),u.add(mn.debug_container));var d=0,m=0;d=Ma.getTimer();for(var f=0,g=m=1e4;f<g;){f++;var v=new y_;v.dispose(),v=null}Nl.trace("Vec2 ("+m+") allocation time: "+(Ma.getTimer()-d)+"ms",{fileName:"GameDo.hx",lineNumber:426,className:"bikas.game.GameDo",methodName:"createGame"}),d=Ma.getTimer();for(var b=0,y=m=1e4;b<y;)b++,ea.destroyed_point_list.push(new ea(0,0));Nl.trace("Point ("+m+") allocation time: "+(Ma.getTimer()-d)+"ms",{fileName:"GameDo.hx",lineNumber:433,className:"bikas.game.GameDo",methodName:"createGame"}),null!=Gs.animation_power_bomb_burning&&A.translateAnimationData(Gs.animation_power_bomb_burning,-28.5,11.5),c.temp.runtime_info=mn.createRuntimeTextInformation(c.config,c.runtime_information_container,t,n),c.pause_button=qa.createSprite(Gs.button_pause,.5,.5,0,0),c.pause_button.x=c.pause_button.width/2+40+20,4==e.release.sitelock_type?c.pause_button.x=c.pause_button.width/2+40+20:c.pause_button.x=c.pause_button.width/2+40,c.pause_button.y=c.pause_button.height/2+40,c.ingame_container.add(c.pause_button),c.coin_display=new Nn,c.coin_display.coin=qa.createSpriteByName("coin_pick",.5,.5),c.coin_display.text=qa.createBitmapText(fn.bell_gothic_std_black_very_light_26,36,"left","00001"),c.coin_display.text.anchor.x=1,c.coin_display.text.anchor.y=.5,c.coin_display.coin.scale.x=1.5,c.coin_display.coin.scale.y=1.5,c.coin_display.coin.position.y=c.coin_display.coin.height/2+10,c.coin_display.text.position.y=c.coin_display.coin.position.y+2,c.ingame_container.add(c.coin_display.coin),c.ingame_container.add(c.coin_display.text);var x=c.level_load_screen=new yn;x.track_loader_foreground_original_frame=Gs.track_loader_foreground.frame.clone(),x.track_loader_foreground_current_frame=Gs.track_loader_foreground.frame.clone(),x.container=qa.createGroup(),x.background=qa.createSprite(Gs.menu_background,0,0,0,0),x.middle_container=qa.createGroup(),x.title=qa.createSprite(Gs.logo_small,.5,.5,-60,0),x.loading_track_text=qa.createSprite(Gs.track_loader_text,.5,.5,0,0),x.loader_background=qa.createSprite(Gs.track_loader_background,0,.5,-Gs.track_loader_background.width/2,146),x.loader_foreground=qa.createSprite(Gs.track_loader_foreground,0,.5,-Gs.track_loader_background.width/2,146),x.container.add(x.background),x.container.add(x.middle_container),x.middle_container.add(x.title),x.middle_container.add(x.loading_track_text),x.middle_container.add(x.loader_background),x.middle_container.add(x.loader_foreground);var z=c.pause_menu=new jn;z.container=qa.createGroup(),z.background=qa.createSprite(Gs.menu_background),z.button_play=qa.createSprite(Gs.button_play,.5,.5),z.button_restart=qa.createSprite(Gs.button_restart,.5,.5),z.button_main_menu=qa.createSprite(Gs.button_main_menu,.5,.5),z.button_garage=qa.createSprite(Gs.button_garage,.5,.5),z.button_sounds=qa.createSprite(Gs.button_sounds_on,.5,.5),z.button_music=qa.createSprite(Gs.button_music_on,.5,.5),z.background.alpha=.8,z.container.add(z.background),z.container.add(z.button_play),z.container.add(z.button_restart),z.container.add(z.button_main_menu),z.container.add(z.button_garage),z.container.add(z.button_sounds),z.container.add(z.button_music);var w=function(e,t,n){var i=new Ln;i.bitmap_text=qa.createBitmapText(fn.consolas_24,42,"left",t,0,0),i.bitmap_text.position.x=10,i.bitmap_text.position.y=200+50*e.pause_debug_options.length,i.callback=n,e.pause_debug_options.push(i),e.container.add(i.bitmap_text)};(1==c.config.type||0==c.config.type&&c.config.development.show_same_debug_buttons_in_pause_menu_as_release)&&(c.config.release.add_gameplay_bot_button_in_pause_menu&&w(z,"gameplay_bot: "+(null==c.gameplay_bot_enabled?"null":""+c.gameplay_bot_enabled),function(e){c.gameplay_bot_enabled=!c.gameplay_bot_enabled,e.bitmap_text.text="gameplay_bot: "+(null==c.gameplay_bot_enabled?"null":""+c.gameplay_bot_enabled),c.gameplay_bot_enabled?c.use_bot_to_control_player=!0:c.use_bot_to_control_player=!1}),c.config.release.add_race_finish_button_in_pause_menu&&w(z,"finish race",function(e){if(null!=c.player&&c.level_type==Zn.InRacing){for(var t=0,n=i.pointer_objects;t<n.length;){var r=n[t];++t,r.cancel_upped_and_clicked=!0}c.menu_container.remove(z.container),Vn.setGameState(c,Gn.InLevel),Vn.teleportPlayerToFinish(c),c.all_cars.sort(Vn.sortCarsByPosition),Vn.updateCurrentPlace(c)}}),c.config.release.add_clear_rewarded_ads_in_pause_menu&&w(z,"clear rewarded ads",function(e){c.game_save.rewarded_ads.splice(0,c.game_save.rewarded_ads.length)}),c.config.release.add_complete_all_levels&&w(z,"complete all regular levels with 100%",function(e){if(null!=c.game_save)for(var t=0,n=c.game_save.level_saves;t<n.length;){var i=n[t];++t,1<=i.description.level_number&&i.description.type==wr.LevelRegular&&(i.completed||(i.completed=!0,i.completion_percent=100))}}));var k=c.tutorial_menu=new Rn;k.container=qa.createGroup(),k.background=qa.createSprite(Gs.menu_background),k.background.alpha=.9,k.text=qa.createBitmapText(fn.bell_gothic_std_black_dark_26,42),k.white_circle=qa.createSpriteByName("white_circle",.5,.5),k.white_circle2=qa.createSpriteByName("white_circle",.5,.5),k.keyboard_controls=qa.createSpriteByName("tutorial_controls",.5,.5),k.wheel=qa.createSpriteByName("wheel",.5,.5),k.finger=qa.createSpriteByName("pirstas_visas",0,0),k.jump_button=qa.createSprite(Gs.animation_jump_green_button.frames[0].texture,.5,.5),k.nitro_button=qa.createSprite(Gs.animation_nitro_button.frames[0].texture,.5,.5),k.power_button=qa.createSprite(Gs.animation_power_icons.frames[0].texture,.5,.5),k.mobile_clockwise_button=qa.createSpriteByName("rotate_button",.5,.5),k.mobile_anti_clockwise_button=qa.createSpriteByName("rotate_button",.5,.5),k.container.add(k.background),k.container.add(k.white_circle),k.container.add(k.white_circle2),k.container.add(k.keyboard_controls),k.container.add(k.wheel),k.container.add(k.finger),k.container.add(k.jump_button),k.container.add(k.nitro_button),k.container.add(k.power_button),k.container.add(k.mobile_clockwise_button),k.container.add(k.mobile_anti_clockwise_button),k.container.add(k.text);var S=c.level_end=new kn;if(S.finished_text=qa.createSprite(Gs.finished_text,.5,.5,0,0),kn.challenge_win_button_texture=Hs.getTexture("button_play"),kn.challenge_fail_button_texture=Hs.getTexture("button_restart"),S.challenge_button=qa.createSprite(kn.challenge_win_button_texture,.5,.5),S.famobi_posted=!1,c.level_stats=Oi.create(),c.config.control_type==Fs.ControlFastWheel){var C=qa.createSprite(Gs.wheel,0,0,0,0);C.anchor.x=.5,C.anchor.y=.5,c.ingame_container.add(C),c.wheel=Jr.create(C),c.wheel.sprite.x=Jr.getWheelX(t),c.wheel.sprite.y=Jr.getWheelY(t)}c.level_descriptions=Pr.createLevelDescriptions(c.config),c.game_save=Pr.createGameSave(c.level_descriptions),Vn.applyGameSave(c,c.game_save),c.car_settings=Pr.createCarSettings(c.config),c.car_upgrade_data=Pr.createCarUpgradeData(),c.chest_reward_item_descs=Vr.createRewardsForChests(),c.achievement_descs=Vr.createRewardsForAchievements(),c.challenge_descs=Vr.createRewardsForChallenges();for(var N=0,P=c.chest_reward_item_descs;N<P.length;){var M=P[N];++N;for(var I=0,T=c.all_reward_descs;I<T.length;){var D=T[I];++I,M.id==D.id&&Nl.trace("warning: no 2 reward description can exist with same id: "+M.name+", "+D.name,{fileName:"GameDo.hx",lineNumber:689,className:"bikas.game.GameDo",methodName:"createGame"})}c.all_reward_descs.push(M)}for(var E=0,O=c.achievement_descs;E<O.length;){var B=O[E];++E;for(var L=0,j=c.all_reward_descs;L<j.length;){var F=j[L];++L,B.item.desc.id==F.id&&Nl.trace("warning: no 2 reward description can exist with same id: "+B.item.desc.name+", "+F.name,{fileName:"GameDo.hx",lineNumber:697,className:"bikas.game.GameDo",methodName:"createGame"})}c.all_reward_descs.push(B.item.desc)}for(var R=0,G=c.challenge_descs;R<G.length;){var Z=G[R];++R;for(var U=0,V=c.all_reward_descs;U<V.length;){var q=V[U];++U,Z.item.desc.id==q.id&&Nl.trace("warning: no 2 reward description can exist with same id: "+Z.item.desc.name+", "+q.name,{fileName:"GameDo.hx",lineNumber:705,className:"bikas.game.GameDo",methodName:"createGame"})}c.all_reward_descs.push(Z.item.desc)}c.upgrades=Pr.createUpgrades(),c.ability_probabilities=[];var W=function(e,t,n,i){var r=new Ie;r.type=t,r.first_car_multiplier=n,r.last_car_multiplier=i,e.push(r)};W(c.ability_probabilities,ye.Bomb,.4,.8),W(c.ability_probabilities,ye.Dynamite,1,.2),W(c.ability_probabilities,ye.Armor,1,.2),W(c.ability_probabilities,ye.Nitro,.1,1.1),c.camera=zt.createCamera();var X=y_.get(0,1200);c.world=ie.createWorld(X,.15,.15);var H=function(t){1==e.type&&8==t.keyCode&&null!=c.debug_element&&(c.debug_element.hidden=!c.debug_element.hidden),0==e.type&&p.is(t.target,HTMLTextAreaElement)||Ii.updateKeyboard(c.keyboard_keys_pressed,c.keyboard_keys_released,t)};if(lo.get_document().addEventListener("keydown",H),lo.get_document().addEventListener("keyup",H),Ma.getTimer(),0==e.type){Vn.redirectExternalFunctionCalls();var Y=!1;try{parent.is_reload,Y=!0}catch(t){Y=!1}if(Y&&parent.is_reload){Vn.setGameAndEditorVisibility(c,!0);var J=Vn.getIframeElement();null!=J&&J.focus(),Vn.setupToLoadWorkingStageAndWorkingLibrary(c)}else if(c.config.development.editor_enabled){var K=c.config.development.show_editor_first;if(null==Vn.getEditorElement()&&(K=!1),K){Vn.setGameAndEditorVisibility(c,!1);var Q=Vn.getEditorElement();null!=Q&&Q.focus()}else{Vn.setGameAndEditorVisibility(c,!0);var $=Vn.getIframeElement();null!=$&&$.focus(),Vn.setupToLoadWorkingStageAndWorkingLibrary(c)}}else Vn.setupToLoadWorkingStageAndWorkingLibrary(c);c.debug_element=lo.get_document().getElementById("gamedebug"),$s.top_listeners.push(new Ys(lo.get_document(),"keydown",H)),null==c.debug_element?Nl.trace("no debug menu",{fileName:"GameDo.hx",lineNumber:857,className:"bikas.game.GameDo",methodName:"createGame"}):mn.createDebugMenu(c,t,n)}else if(1==e.type){for(var ee=null,te=0,ne=c.game_save.level_saves;te<ne.length;){var re=ne[te];if(++te,re.description.type==wr.LevelMainMenu&&null!=re.description&&null!=re.description.level_data_save){ee=re.description.level_data_save;break}}for(var ae=null,se=0,oe=Gs.level_data_saves;se<oe.length;){var _e=oe[se];if(++se,"library"==_e.name){ae=_e;break}}null!=ee&&null!=ae?(Un.load_stage_header=le.unserializeStageEngine(c.engine.engine_serial_data,Tl.decode(ee.data)),Un.load_library_header=le.unserializeLibraryEngine(c.engine.engine_serial_data,Tl.decode(ae.data))):(null==ee&&Nl.trace("warning: found_level_data_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"createGame"}),null==ae&&Nl.trace("warning: found_library_data_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"createGame"}),Vn.setupToLoadWorkingStageAndWorkingLibrary(c))}return c},Vn.setupToLoadWorkingStageAndWorkingLibrary=function(e){""!=Gs.working_stage&&""!=Gs.working_library&&(Un.load_stage_header=le.unserializeStageEngine(e.engine.engine_serial_data,Tl.decode(Gs.working_stage)),Un.load_library_header=le.unserializeLibraryEngine(e.engine.engine_serial_data,Tl.decode(Gs.working_library)),Nl.trace("set to load stage and library",{fileName:"GameDo.hx",lineNumber:909,className:"bikas.game.GameDo",methodName:"setupToLoadWorkingStageAndWorkingLibrary"}))},Vn.getEditorElement=function(){var e=lo.get_document().getElementById("BikasEditor2D");if(null!=e||null==lo.get_window().parent)return e;try{e=lo.get_window().parent.document.getElementById("BikasEditor2D")}catch(e){return null}return e},Vn.getIframeElement=function(){if(null==lo.get_window().parent)return null;var e=null;try{e=lo.get_window().parent.document.getElementById("game_iframe")}catch(e){return null}return e},Vn.nullTheExternalFunctionCalls=function(){try{lo.get_window().parent.window.bikas}catch(e){return}if(null!=lo.get_window().parent){var e=lo.get_window().parent.window;null!=e.bikas&&(e.bikas.game.GameDo.loadDataFromEditor=null,e.bikas.game.GameDo.saveDataFromEditor=null,e.bikas.game.GameDo.doPolyBoolOperation=null)}},Vn.redirectExternalFunctionCalls=function(){try{lo.get_window().parent.window.bikas}catch(e){return}if(null!=lo.get_window().parent){var e=lo.get_window().parent.window;null==e.bikas&&(e.bikas={},e.bikas.game={},e.bikas.game.GameDo={}),e.bikas.game.GameDo.loadDataFromEditor=null,e.bikas.game.GameDo.saveDataFromEditor=null,e.bikas.game.GameDo.doPolyBoolOperation=null,e.bikas.game.GameDo.loadDataFromEditor=Vn.loadDataFromEditor,e.bikas.game.GameDo.saveDataFromEditor=Vn.saveDataFromEditor,e.bikas.game.GameDo.doPolyBoolOperation=Vn.doPolyBoolOperation}},Vn.setGameAndEditorVisibility=function(e,t){var n=Vn.getEditorElement();if(null!=n){var i=lo.get_document().getElementById("gamedebug"),r=!n.classList.contains("hidden_class"),a=!i.classList.contains("hidden_class");if(t&&r?(n.classList.remove("hidden_class"),n.focus()):t||r||n.classList.add("hidden_class"),t&&!a){i.classList.remove("hidden_class");var s=Vn.getIframeElement();null!=s&&(s.classList.remove("hidden_class"),s.focus()),$s.canvas.classList.remove("hidden_class"),$s.paused=!1}else if(!t&&a){i.classList.add("hidden_class"),$s.canvas.classList.add("hidden_class");var l=Vn.getIframeElement();null!=l&&l.classList.add("hidden_class"),$s.paused=!0}}},Vn.createPostRequest=function(e,t,n,i,r){null==i&&(i=""),null==n&&(n="String"),null==t&&(t="filename.txt");var a=new bn;return a.xhr=new XMLHttpRequest,a.on_finished=r,a.xhr.addEventListener("load",function(e){Nl.trace("successfully saved: "+t,{fileName:"GameDo.hx",lineNumber:1049,className:"bikas.game.GameDo",methodName:"createPostRequest"}),null!=a.on_finished&&a.on_finished()}),a.xhr.addEventListener("error",function(e){Nl.trace("error while saving: "+t,{fileName:"GameDo.hx",lineNumber:1055,className:"bikas.game.GameDo",methodName:"createPostRequest"})}),a.xhr.open("POST",e,!0),a.xhr.setRequestHeader("Content-Type","application/json"),a.json=JSON.stringify({name:t,type:n,data:i}),a},Vn.saveDataFromEditor=function(e,t,n){for(var i=[],r=0,a=e.length;r<a;){var s=r++,l=Vn.createPostRequest("http://localhost:8000",e[s],t[s],n[s]);i.push(l)}for(var o=1,_=i.length;o<_;){var p=[o++];i[p[0]-1].on_finished=function(e){return function(){i[e[0]].xhr.send(i[e[0]].json)}}(p)}i[i.length-1].on_finished=function(){Nl.trace("saving done",{fileName:"GameDo.hx",lineNumber:1086,className:"bikas.game.GameDo",methodName:"saveDataFromEditor"})},i[0].xhr.send(i[0].json)},Vn.loadDataFromEditor=function(e,t){Nl.trace("Open: Game",{fileName:"GameDo.hx",lineNumber:1095,className:"bikas.game.GameDo",methodName:"loadDataFromEditor"});var n=mn.game;Vn.setGameAndEditorVisibility(n,!0),Un.load_stage_header=le.unserializeStageEngine(n.engine.engine_serial_data,Vn.toBytes(e)),Un.load_library_header=le.unserializeLibraryEngine(n.engine.engine_serial_data,Vn.toBytes(t)),0!=n.config.type||n.config.development.transitions_enabled?(Vn.setGameState(n,Gn.InGameLoad),Vn.setGameState(n,Gn.InTransitionToLevelLoad)):Vn.setGameState(n,Gn.InLevel)},Vn.toBytes=function(e){for(var t=Il.alloc(e.length),n=0,i=e.length;n<i;){var r=n++;t.set(r,e[r])}return t},Vn.hideGameAndOpenEditor=function(e){Nl.trace("Open: Editor",{fileName:"GameDo.hx",lineNumber:1121,className:"bikas.game.GameDo",methodName:"hideGameAndOpenEditor"}),Vn.setGameAndEditorVisibility(e,!1),Vn.destroyLevel(e,!0,!1),Vn.getEditorElement().activateEditor(),lo.get_window().parent.window.focusEditor()},Vn.doPolyBoolOperation=function(e,t,n){null==n&&(n="union");var i=parent.PolyBool,r=null;return null!=i&&("union"==n?r=i.union({regions:e,inverted:!1},{regions:t,inverted:!1}):"intersect"==n?r=i.intersect({regions:e,inverted:!1},{regions:t,inverted:!1}):"difference"==n?r=i.difference({regions:e,inverted:!1},{regions:t,inverted:!1}):"xor"==n&&(r=i.xor({regions:e,inverted:!1},{regions:t,inverted:!1}))),null==r?null:r.regions},Vn.setGameState=function(e,t){e.previous_state=e.state,e.state=t},Vn.showPause=function(e,t){e.state!=Gn.InPause&&(Vn.setGameState(e,Gn.InPause),1==e.config.type&&3==e.config.release.sitelock_type&&e.level_type==Zn.InRacing&&es.PokiSDK.gameplayStop())},Vn.gotoNewLevel=function(e,t,n){return!(null==n&&(Nl.trace("warning: level_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"gotoNewLevel"}),1)||(e.pre_simulate_world_steps_current=0,(e.pre_wait_steps_current=0)!=e.config.type||e.config.development.transitions_enabled?(e.next_level_save=n,Vn.setGameState(e,Gn.InLevel),Vn.setGameState(e,Gn.InTransitionToLevelLoad),1):(Vn.setGameState(e,Gn.InLevel),Vn.loadNewLevel(e,t,n),0)))},Vn.gotoRestartLevel=function(e,t){return!(null==e.current_level_save&&(Nl.trace("warning: game.current_level_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"gotoRestartLevel"}),1)||(e.pre_simulate_world_steps_current=0,(e.pre_wait_steps_current=0)!=e.config.type||e.config.development.transitions_enabled?(e.next_level_save=e.current_level_save,Vn.setGameState(e,Gn.InLevel),Vn.setGameState(e,Gn.InTransitionToLevelLoad),1):(Vn.setGameState(e,Gn.InLevel),Vn.reloadLevel(e,t),0)))},Vn.saveGameSaveToStorage=function(e,t){var n="adventure_drivers";t.save_date=Ma.getCurrentDateForFileSaving(),qn.saveToStorage(e,t,n)?Nl.trace("saved game: "+n+" (version: "+t.save_data_version+", date: "+t.save_date+")",{fileName:"GameDo.hx",lineNumber:1255,className:"bikas.game.GameDo",methodName:"saveGameSaveToStorage"}):Nl.trace("failed to save game: "+n,{fileName:"GameDo.hx",lineNumber:1257,className:"bikas.game.GameDo",methodName:"saveGameSaveToStorage"})},Vn.loadGameSaveFromStorage=function(e){var t="adventure_drivers",n=qn.loadFromStorage(e,t);if(null==n)return Nl.trace("failed to load game or the save does not exist yet: "+t,{fileName:"GameDo.hx",lineNumber:1265,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),null;Nl.trace("loaded game save: "+t+" (version: "+n.save_data_version+", date: "+n.save_date+")",{fileName:"GameDo.hx",lineNumber:1268,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),Nl.trace("\tcurrent_car: "+n.current_car,{fileName:"GameDo.hx",lineNumber:1269,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),Nl.trace("\tchests: "+n.chests,{fileName:"GameDo.hx",lineNumber:1270,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),Nl.trace("\tcoins: "+n.coins,{fileName:"GameDo.hx",lineNumber:1271,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),Nl.trace("\tupgrade_points: "+n.upgrade_points,{fileName:"GameDo.hx",lineNumber:1272,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),Nl.trace("\tcar_own_list: "+p.string(n.car_own_list),{fileName:"GameDo.hx",lineNumber:1273,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),Nl.trace("\tachievements_completed: "+p.string(n.achievements_completed),{fileName:"GameDo.hx",lineNumber:1274,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),Nl.trace("\tchallenges_completed: "+p.string(n.challenges_completed),{fileName:"GameDo.hx",lineNumber:1275,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),Nl.trace("\ttotal ongoing_powers: "+(n.ongoing_powers.level_items.length+n.ongoing_powers.permanent_items.length),{fileName:"GameDo.hx",lineNumber:1276,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"});for(var i=0,r=0,a=n.level_saves;r<a.length;){var s=a[r];++r,s.completed&&++i}return Nl.trace("\ttotal levels completed: "+i,{fileName:"GameDo.hx",lineNumber:1284,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),n},Vn.applyGameSave=function(e,t){if(null!=t){Nl.trace("applied game save:  (version: "+t.save_data_version+", date: "+t.save_date+")",{fileName:"GameDo.hx",lineNumber:1296,className:"bikas.game.GameDo",methodName:"applyGameSave"}),e.game_save=t;for(var n=[],i=0,r=e.game_save.level_saves;i<r.length;){var a=r[i];if(++i,null==a.description)for(var l=0,o=e.level_descriptions;l<o.length;){var _=o[l];if(++l,_.name==a.description_name){a.description=_;break}}null==a.description&&(Nl.trace("warning: could not find description for "+a.description_name+" (removing level_save from the list)",{fileName:"GameDo.hx",lineNumber:1313,className:"bikas.game.GameDo",methodName:"applyGameSave"}),n.push(a))}for(var p=0;p<n.length;){var u=n[p];++p,s.remove(e.game_save.level_saves,u)}for(var h=0,c=e.game_save.level_saves;h<c.length;){var d=c[h];++h,d.description.type==wr.LevelMainMenu?e.main_menu_save=d:d.description.type==wr.LevelInterLevelMenu?e.inter_level_menu_save=d:d.description.type==wr.LevelRegular?1==d.description.level_number&&(e.first_level_save=d):d.description.type==wr.LevelChallenge&&(d.description.challenge_type==kr.ChallengeAchievement?e.achievement_save=d:d.description.challenge_type==kr.ChallengeCredits&&(e.credits_save=d))}null==e.inter_level_menu_save&&Nl.trace("warning: game.inter_level_menu_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"applyGameSave"}),null==e.main_menu_save&&Nl.trace("warning: game.main_menu_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"applyGameSave"}),null==e.first_level_save&&Nl.trace("warning: game.first_level_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"applyGameSave"}),null==e.achievement_save&&Nl.trace("warning: game.achievement_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"applyGameSave"}),null==e.credits_save&&Nl.trace("warning: game.credits_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"applyGameSave"});for(var m=e.game_save.ongoing_powers.level_items.concat(e.game_save.ongoing_powers.permanent_items),f=[],g=0;g<m.length;){var v=m[g];++g;for(var b=0,y=e.all_reward_descs;b<y.length;){var x=y[b];if(++b,v.id==x.id){v.desc=x;break}}null==v.desc&&(Nl.trace("warning: reward item has no matching id "+v.id+" ("+v.description_text+") - removing from gongoing powers",{fileName:"GameDo.hx",lineNumber:1363,className:"bikas.game.GameDo",methodName:"applyGameSave"}),f.push(v))}for(var z=0;z<f.length;){var w=f[z];++z,s.remove(e.game_save.ongoing_powers.level_items,w),s.remove(e.game_save.ongoing_powers.permanent_items,w)}if(null!=e.ongoing_powers_display){e.ongoing_powers_display.current_items=[];for(var k=0,S=e.game_save.ongoing_powers.permanent_items;k<S.length;){var C=S[k];++k,e.ongoing_powers_display.current_items.push(C)}for(var N=0,P=e.game_save.ongoing_powers.level_items;N<P.length;){var M=P[N];++N,e.ongoing_powers_display.current_items.push(M)}}}else Nl.trace("warning: game_save == null",{fileName:"GameDo.hx",lineNumber:1293,className:"bikas.game.GameDo",methodName:"applyGameSave"})},Vn.loadEngineAndLevel=function(e,t,n,i,r){var a=i.group;if(Ma.getTimer(),null!=r){var s=r.group;null!=s&&(e.library_group=ie.overloadLibrary(n,s,e.library_group,e.bitmap_assets))}e.stage_group_original=ie.copyEntity(a,n,!1);for(var l=null,o=0,_=e.game_save.level_saves;o<_.length;){var p=_[o];if(++o,p.description.name==i.save.name){l=p;break}}if(null==l){if(!(0<e.game_save.level_saves.length))return Nl.trace("warning: couldn't find level save for level "+i.save.name+" (and no other level saves exist)",{fileName:"GameDo.hx",lineNumber:1414,className:"bikas.game.GameDo",methodName:"loadEngineAndLevel"}),!1;Nl.trace("warning: couldn't find level save for level "+i.save.name+" (using first level save instead)",{fileName:"GameDo.hx",lineNumber:1411,className:"bikas.game.GameDo",methodName:"loadEngineAndLevel"}),l=e.game_save.level_saves[0]}return Vn.loadLevel(e,t,a,n,l)},Vn.loadNewLevel=function(e,t,n){if(Vn.destroyLevel(e,!1,!1),null==n&&(Nl.trace("warning: level_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"loadNewLevel"}),1))return!1;if(null==n.description.level_data_save&&(Nl.trace("warning: level_save.description.level_data_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"loadNewLevel"}),1))return!1;var i=e.engine.engine_serial_data,r=le.unserializeStageEngine(i,Tl.decode(n.description.level_data_save.data));return!(null==r&&(Nl.trace("warning: stage_header == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"loadNewLevel"}),1))&&(e.stage_group_original=ie.copyEntity(r.group,i,!1),Vn.loadLevel(e,t,r.group,i,n))},Vn.reloadLevel=function(e,t){Vn.destroyLevel(e,!1,!0);var n=e.engine.engine_serial_data,i=ie.copyEntity(e.stage_group_original,n,!1);return Vn.loadLevel(e,t,i,n,e.current_level_save,!1,!0)},Vn.loadLevel=function(e,t,n,i,r,a,s){if(0==r.description.level_number||a){var l=Ma.getTimer();if(Nl.trace("loadLevel: "+r.description.name+" ("+r.description.nice_name+")",{fileName:"GameDo.hx",lineNumber:1463,className:"bikas.game.GameDo",methodName:"loadLevel"}),!Vn.makeLevel(e,n,i,r))return Nl.trace("warning: failed to make level",{fileName:"GameDo.hx",lineNumber:1467,className:"bikas.game.GameDo",methodName:"loadLevel"}),Vn.destroyLevel(e,!1,!1),!1;e.physics_running=!0,e.level_running=!0,e.coin_display.text.visible=Nn.coin_display_debug_visibility,e.coin_display.coin.visible=Nn.coin_display_debug_visibility,e.ongoing_powers_container.visible=Nn.coin_display_debug_visibility,e.level_type==Zn.InMainMenu?(e.coin_display.text.visible=!1,e.coin_display.coin.visible=!1,e.ongoing_powers_container.visible=!1,Vn.initMenu(e,t)):e.level_type==Zn.InInterLevelMenu?Vn.initMenu(e,t):e.level_type==Zn.InRacing?null!=e.player?((r.description.level_number-1)%2==0?e.current_gameplay_music=Gs.music_stereospice_fun_surf_rock_142_sec:e.current_gameplay_music=Gs.music_stereospice_fun_surf_rock_92_sec,Vn.initRace(e,t)):Nl.trace("warning: game.player == null",{fileName:"GameDo.hx",lineNumber:1499,className:"bikas.game.GameDo",methodName:"loadLevel"}):Nl.trace("warning: unhandled "+p.string(e.current_level_save.description.type),{fileName:"GameDo.hx",lineNumber:1502,className:"bikas.game.GameDo",methodName:"loadLevel"});var o=new Js;return o.dc=1,o.level_seconds=0,o.step_size=.016666666666666666,Vn.updateLevel(e,o),Vn.updateBackground(e,1),Nl.trace("loadLevel finished in "+(Ma.getTimer()-l)+"ms",{fileName:"GameDo.hx",lineNumber:1516,className:"bikas.game.GameDo",methodName:"loadLevel"}),!0}window.famobi_analytics.trackEvent(s?"EVENT_LEVELRESTART":"EVENT_LEVELSTART",{levelName:r.description.name}).then(function(){Vn.loadLevel(e,t,n,i,r,!0)})},Vn.makeLevel=function(e,t,n,i){if(e.all_body_entities=[],e.markers=[],t.position.x=0,t.position.y=0,t.transform.scale_x=1,t.transform.scale_y=1,t.transform.rotation=0,null!=e.current_level_save&&e.current_level_save.description.name!=i.description.name&&(e.game_save.previous_level_name=e.current_level_save.description.name),e.current_level_save=i,e.game_save.current_level_name=e.current_level_save.description.name,ie.linkPrefabLinks(t,e.library_group),!Vn.preprocessEntities(t,e.library_group,i,e))return!1;var r=ie.overloadStage(n,t,e.stage_group,e.library_group,e.bitmap_assets);if(null==r)return!1;if(e.stage_group=r,!Vn.sortGraphicsInStageGroup(t,e.config))return!1;if(e.stage_group.group.container=qa.createGroup(),ie.flattenAndAddStage(n,e.stage_group,e.entity_container),!ie.createBodiesForEntities(e.stage_group,e.all_body_entities,new er,new wi))return!1;if(!Vn.createObjectsBasedOnEntities(e,e.stage_group,new t_(!0)))return!1;if(e.current_level_save.description.type==wr.LevelMainMenu?e.level_type=Zn.InMainMenu:e.current_level_save.description.type==wr.LevelInterLevelMenu?e.level_type=Zn.InInterLevelMenu:e.level_type=Zn.InRacing,!Vn.createLevelObjects(e))return!1;if(null!=e.player&&null==e.level_start_position&&(e.level_start_position=new ea,Nl.trace("warning: level_start_position == null",{fileName:"GameDo.hx",lineNumber:1621,className:"bikas.game.GameDo",methodName:"makeLevel"})),!Vn.createLevelObjectsBasedOnObjects(e))return!1;Vn.centerStage(e,1),Vn.setSpace(e,e.world.space);for(var a=0,s=e.temp.levelloads;a<s.length;){var l=s[a];++a,l()}return null!=e.player&&Vn.refreshCameraCenter(e,e.camera,e.js_info,e.player.car.main_body_entity.position),!0},Vn.preprocessEntities=function(e,t,n,i){for(var r=function(e,t,n){-1==e.indexOf(n)&&(s.remove(t.group.entities,n),e.push(n))},a=null,l=a=function(e,t,n){for(var i=e.group.entities.slice(),s=0;s<i.length;){var l=i[s];if(++s,-1!=n.indexOf(l.name)&&r(t,e,l),null!=l.bitmap_images&&null!=l.bitmap_images.images)for(var o=0,_=l.bitmap_images.images;o<_.length;){var p=_[o];if(++o,-1!=n.indexOf(p.source_name)){r(t,e,l);break}}null!=l.prefab_link&&null!=l.prefab_link.prefab_entity&&-1!=n.indexOf(l.prefab_link.prefab_entity.name)&&r(t,e,l),null!=l.prefab&&-1!=n.indexOf(l.prefab.prefab_name)&&r(t,e,l),null!=l.group&&a(l,t,n)}},o=i.game_save,_=[],u=[],h=null,c=0==i.config.type&&i.config.development.filter_out_bots,d=0,m=e.group.entities;d<m.length;){var f=m[d];++d,"car"!=f.name&&"player"!=f.name||(i.car_original_rotations.set(f,f.transform.rotation),f.transform.rotation=0,null==h?h=f:"player"==f.name?h=f:"player"!=h.name&&f.position.y<=h.position.y&&(h=f),u.push(f))}if(n.description.type==wr.LevelChallenge){if(0==u.length)return Nl.trace("warning: no cars recognized (note: car prefab_links should be named 'car')",{fileName:"GameDo.hx",lineNumber:1733,className:"bikas.game.GameDo",methodName:"preprocessEntities"}),!1;for(var g=0;g<u.length;){var v=u[g];++g,v.name="bot"}null!=h&&(h.name="player")}else if(0==i.config.type&&i.config.development.use_editor_cars){for(var b=0;b<u.length;){var y=u[b];++b,y.name="bot",c&&r(_,e,y)}null!=h&&(h.name="player")}else if(n.description.type==wr.LevelRegular){for(var x=0;x<u.length;){var z=u[x];++x,r(_,e,z)}var w=[];if(!c){Pr.setBotCarLineup(o,i.game_save.level_saves);for(var k=0,S=o.current_bot_car_lineup;k<S.length;){var C=S[k];++k,w.push(C)}}var N=Math.floor(w.length/2);w.splice(N,0,o.current_car);for(var P=[],M=null,I=0,T=0,A=w.length;T<A;){var D=T++,E=w[D],O=ie.createDefaultEntity();D==N?(O.name="player",M=O):(O.name="bot",P.push(O)),O.position.x=I,O.position.y=0,I+=100,O.prefab_link=new Q;for(var B=0,L=t.group.entities;B<L.length;){var j=L[B];if(++B,j.name==E){O.prefab_link.guid=j.guid,O.prefab_link.prefab_entity=j;break}}null==O.prefab_link.prefab_entity&&Nl.trace("warning: couldn't find "+E+" prefab",{fileName:"GameDo.hx",lineNumber:1806,className:"bikas.game.GameDo",methodName:"preprocessEntities"})}for(var F=0;F<P.length;){var R=P[F];++F,e.group.entities.push(R)}null!=M&&e.group.entities.push(M)}else n.description.type!=wr.LevelMainMenu&&n.description.type!=wr.LevelInterLevelMenu&&Nl.trace("warning: unhandled "+p.string(n.description.type),{fileName:"GameDo.hx",lineNumber:1825,className:"bikas.game.GameDo",methodName:"preprocessEntities"});var G=[];0==i.config.type&&i.config.development.filter_out_interactive_objects&&(G=["box1","barrel","shack","fruit_stand","crate","forward_ramp","booster","bar","explosive_metal_barrel"]),0<G.length&&l(e,_,G);for(var Z=e.group.entities.slice(),U=0;U<Z.length;){var V=Z[U];++U,"treasure_chest_pick"==V.name&&-1!=n.chests_collected_guids.indexOf(V.guid)&&(s.remove(e.group.entities,V),_.push(V))}for(var q=0;q<_.length;){var W=_[q];++q,ie.destroyEntityIncludingChildren(W)}return!0},Vn.sortGraphicsInStageGroup=function(e,t){var n;n=[["background_ground"],["root1","root2","root3","root4"],["mushroom1","mushroom2","mushroom3","mushroom4","mushroom5"],["totem"],["map","map_item_empty","map_item_finished","map_item_finished100","map_item_locked"],["palm_tree1","palm_tree2","palm_tree3","palm_tree4","small_palm_tree1","small_palm_tree2","small_palm_tree3"],["surfboard1","surfboard2","surfboard3","dressing_cabin","table_with_umbrella","minishop"],["banana_tree1","banana_tree2","banana_tree3","banana_tree4"],["bar"],["car_upgrades_board"],["simple_ramp","forward_ramp"],["cars"],["grass1","grass2","grass3","grass4","grass5","grass6","small_plant1","rock","coconuts"],["prefabs"],["power_question"],["ground"],["markers"]];for(var i=[],r=0;r<n.length;)++r,i.push([]);i.push([]);for(var a=function(e,t,n,i,r){null==r&&(r="");for(var a=-1,s=0,l=t.length;s<l;){var o=s++;if(-1!=t[o].indexOf(i)){a=o;break}}if(-1==a)for(var _=0,p=t.length;_<p;){var u=_++;if(-1!=t[u].indexOf(r)){a=u;break}}return-1!=a&&(n[a].push(e),!0)},l=0,o=e.group.entities;l<o.length;){var _=o[l];++l;var p=!1;if(null!=_.polygon&&_.polygon.draw_type==U.TEXTURE)p=a(_,n,i,"ground");else if("bot"==_.name||"player"==_.name||"car"==_.name)p=a(_,n,i,"cars");else if(null!=_.bitmap_images)1==_.bitmap_images.images.length&&(p=a(_,n,i,_.bitmap_images.images[0].source_name));else if(null!=_.prefab_link)p=a(_,n,i,_.prefab_link.prefab_entity.name,"prefabs");else if(null==_.prefab&&null==_.prefab_link&&null==_.bitmap_images&&null==_.body&&null==_.polygon&&null==_.group){var u=_.name;0==t.type&&t.development.render_markers&&(p=a(_,n,i,u,"markers"))}p||i[i.length-1].push(_)}for(var h=0;h<i.length;){var c=i[h];++h;for(var d=0;d<c.length;){var m=c[d];++d,s.remove(e.group.entities,m)}}for(var f=0;f<i.length;){var g=i[f];++f;for(var v=0;v<g.length;){var b=g[v];++v,e.group.entities.push(b)}}return!0},Vn.createObjectsBasedOnEntities=function(e,t,n){if(null!=t.prefab_link)return Nl.trace("warning: entity shouldn't have prefab_link, all prefab_links should be flattened "+t.name,{fileName:"GameDo.hx",lineNumber:2023,className:"bikas.game.GameDo",methodName:"createObjectsBasedOnEntities"}),!1;if("player"==t.name||"bot"==t.name){for(var i=null,r=null,a=null,s=0,l=t.group.entities;s<l.length;){var o=l[s];switch(++s,o.name){case"back_wheel_body":r=o;break;case"front_wheel_body":a=o;break;case"main_body":i=o}}if(null==i&&Nl.trace("warning: car does not have main_body",{fileName:"GameDo.hx",lineNumber:2043,className:"bikas.game.GameDo",methodName:"createObjectsBasedOnEntities"}),null==r&&Nl.trace("warning: car does not have back_wheel_body",{fileName:"GameDo.hx",lineNumber:2046,className:"bikas.game.GameDo",methodName:"createObjectsBasedOnEntities"}),null==a&&Nl.trace("warning: car does not have front_wheel_body",{fileName:"GameDo.hx",lineNumber:2049,className:"bikas.game.GameDo",methodName:"createObjectsBasedOnEntities"}),null!=i&&null!=r&&null!=a)if("player"==t.name&&null==e.player){var _=Ot.createCar(t,i,r,a,n),p=Pr.getUpgradedCarConfigCopy(e.car_upgrade_data,e.game_save.car_upgrades,e.car_settings,_.name),u=new Tt,h=Ae.createAbilities(),c=!1;(!e.js_info.desktop||0==e.config.type&&e.config.development.test_famobi_mobile_controls)&&(e.config.control_type!=Fs.ControlSlowRotateButtons&&e.config.control_type!=Fs.ControlSlowRotateButtonsSide||(c=!0)),e.player=hr.createPlayer(_,p,u,h,e.ingame_container,c),e.player_bot=yt.createBot(_,p,u,h,new rt),e.all_cars.push(_),Vn.connectAdditionalCarGraphicsToMainCarBodyEntity(e,_)}else if("bot"==t.name){var d=Ot.createCar(t,i,r,a,n),m=new gr,f=0;e.current_level_save.description.type==wr.LevelRegular&&e.current_level_save.description.level_number<5&&(f=-1),m.top_speed=ma.clamp0toInfinityInt(e.game_save.car_upgrades.top_speed+f),m.acceleration=ma.clamp0toInfinityInt(e.game_save.car_upgrades.acceleration+f),m.handling=ma.clamp0toInfinityInt(e.game_save.car_upgrades.handling+f),m.armor=ma.clamp0toInfinityInt(e.game_save.car_upgrades.armor+f);var g=Pr.getUpgradedCarConfigCopy(e.car_upgrade_data,m,e.car_settings,d.name),v=new Tt,b=Ae.createAbilities(),y=Pr.getBotPersonalityByName(e.car_settings,d.name),x=yt.createBot(d,g,v,b,y);x.personality_applied=!1,e.bots.push(x),e.all_cars.push(d),e.bot_cars.push(d),Vn.connectAdditionalCarGraphicsToMainCarBodyEntity(e,d)}}else if("level start"==t.name)e.level_start_position=za.copy(t.position);else if("level end"==t.name)e.level_end_position=za.copy(t.position);else if("bottom"==t.name)e.level_bottom_position=za.copy(t.position);else if("menu camera"==t.name)e.menu_camera_position=za.copy(t.position);else if(null!=t.bitmap_images&&1==t.bitmap_images.images.length){var z=t.bitmap_images.images[0].source_name;if("chicken"==z){var w=t.display.sprite,k=A.createAnimationUsingSprite(Gs.animation_chicken,w,.5);A.gotoFrame(k,Math.floor(Math.random()*k.data.frames.length));var S=new vn;S.anim=k,S.body=t.body,e.chickens.push(S)}else"power_question"==z?e.pickable_items.push(Mi.createPickableItem(t,Ci.PowerQuestion)):"coin_pick"==z?e.pickable_items.push(Mi.createPickableItem(t,Ci.Coin)):"nitro_pick"==z?e.pickable_items.push(Mi.createPickableItem(t,Ci.Nitro)):"treasure_chest_pick"==z?e.pickable_items.push(Mi.createPickableItem(t,Ci.TreasureChest)):"power_nitro"==z?e.pickable_items.push(Mi.createPickableItem(t,Ci.Nitro)):"bot_jump_pick"==z?e.pickable_items.push(Mi.createPickableItem(t,Ci.BotJumpIndicator)):"attachment_balloons"==z?e.pickable_items.push(Mi.createPickableItem(t,Ci.AttachmentBalloons)):"attachment_anchor"==z?e.pickable_items.push(Mi.createPickableItem(t,Ci.AttachmentAnchor)):"booster"==z&&e.forward_ramps.push($i.createForwardRamp(t,Ji.Booster))}if(null!=t.prefab)if("box1"==t.prefab.prefab_name||"barrel"==t.prefab.prefab_name||"shack"==t.prefab.prefab_name||"fruit_stand"==t.prefab.prefab_name||"crate"==t.prefab.prefab_name){var C=$i.createBox(t);e.boxes.push(C),e.jump_over_bodies.push(C.body)}else if("forward_ramp"==t.prefab.prefab_name){var N=$i.createForwardRamp(t,Ji.Ramp);e.forward_ramps.push(N)}else if("booster"==t.prefab.prefab_name){var P=$i.createForwardRamp(t,Ji.Booster);e.forward_ramps.push(P)}else if("bar"!=t.prefab.prefab_name&&"explosive_metal_barrel"==t.prefab.prefab_name){var M=t.group.entities[0],I=$i.createTempInteractiveObject(M,Hi.Explosive);e.temp_interactive_objects.push(I),e.jump_over_bodies.push(I.body)}if(null!=t.polygon&&t.polygon.draw_type==U.TEXTURE&&(null!=t.body&&t.body.setShapeFilters(Si.ground),e.textured_polygon_entities.push(t)),null==t.prefab&&null==t.prefab_link&&null==t.bitmap_images&&null==t.body&&null==t.polygon&&null==t.group){for(var T=0,D=t.name,E=0,O=e.markers;E<O.length;){var B=O[E];++E,t.name==B.name&&++T}0<T&&(D=t.name+" ("+T+")");var L=0==e.config.type&&e.config.development.render_markers,j=Vn.createMarker(t,D,L);e.markers.push(j)}if(null!=t.group)for(var F=0,R=t.group.entities;F<R.length;){var G=R[F];if(++F,!Vn.createObjectsBasedOnEntities(e,G,n))return!1}return!0},Vn.connectAdditionalCarGraphicsToMainCarBodyEntity=function(e,t){t.main_body_entity;for(var n=0,i=t.group_entity.group.entities;n<i.length;){var r=i[n];if(++n,null!=r.bitmap_images&&2<=r.bitmap_images.images.length)return void Nl.trace("warning: car "+t.name+" has at least 2 bitmap images in it - the game no longer supports it!",{fileName:"GameDo.hx",lineNumber:2255,className:"bikas.game.GameDo",methodName:"connectAdditionalCarGraphicsToMainCarBodyEntity"})}for(var a=0,s=t.group_entity.group.entities;a<s.length;){var l=s[a];if(++a,l!=t.main_body_entity&&null==l.body&&null!=l.bitmap_images&&0<l.bitmap_images.images.length){var o=l.bitmap_images.images[0];-1==o.source_name.indexOf("background")&&-1==o.source_name.indexOf("top")||(t.main_body_background_sprite=l.display.sprite,Vn.connectEntitiesByPositionAndRotation(e.connected_containers,t.main_body_entity,l))}}},Vn.connectEntitiesByPositionAndRotation=function(e,t,n){var i=t.display.sprite,r=i.position.x,a=i.position.y,s=n.display.sprite,l=r-s.x,o=a-s.y,_=s.width,p=s.height;if(0==_||0==p)Nl.trace("warning: width: "+_+", height: "+p,{fileName:"GameDo.hx",lineNumber:2299,className:"bikas.game.GameDo",methodName:"connectEntitiesByPositionAndRotation"});else{var u=s.anchor.x+l/_,h=s.anchor.y+o/p;n.position.x-=l,n.position.y-=o,he.refresh(n),s.anchor.x=u,s.anchor.y=h,n.bitmap_images.images[0].offset_x=u*_,n.bitmap_images.images[0].offset_y=h*_;var c=Jt.createAndConnectContainers(i,s);Jt.updateConnectedContainers(c),e.push(c)}},Vn.createLevelObjectsBasedOnObjects=function(e){if($s.renderer.type==PIXI.RENDERER_TYPE.CANVAS)for(var t=0,n=e.textured_polygon_entities;t<n.length;){var i=n[t];++t;var r=Vn.createAndAddTexturedPolygonEntity(i,2*e.js_info.max_game_width,2*e.js_info.max_game_height);null!=r?e.textured_polygons.push(r):Nl.trace("warning: textured polygon for "+i.name+" was not created",{fileName:"GameDo.hx",lineNumber:2335,className:"bikas.game.GameDo",methodName:"createLevelObjectsBasedOnObjects"})}else{for(var a=0,s=e.textured_polygon_entities;a<s.length;){var l=s[a];++a;var o=l.polygon.texture.fill_source_name+"_separate",_=Hs.getTexture(o),p=null;null!=_&&((p=ir.createMesh(_,l.polygon.points)).position.x=l.position.x,p.position.y=l.position.y),_==Gs.tile_dark_separate?e.cave_meshes.push(p):_==Gs.tile_separate?e.ground_meshes.push(p):Nl.trace("warning: texture "+o+" is not supported or does not exist",{fileName:"GameDo.hx",lineNumber:2356,className:"bikas.game.GameDo",methodName:"createLevelObjectsBasedOnObjects"}),Vn.createAndAddGrass(e.mesh_line_sprites,l)}e.use_cached_terrain_polygons}return null!=e.player&&(e.stunt=Hr.create(e.ingame_container,e.player.car)),e.tutorial_menu.controls_marker=Vn.findMarker(e.markers,"controls tutorial"),e.tutorial_menu.jump_marker=Vn.findMarker(e.markers,"jump tutorial"),e.background=Vn.createBackground(e.current_level_save.description.name,e.background_container,e.foreground_container,e.js_info,e.level_bottom_position.y),!0},Vn.createLevelObjects=function(e){if(1==e.config.type&&2==e.config.release.sitelock_type&&(e.level_type!=Zn.InMainMenu&&e.level_type!=Zn.InRacing||(e.lagged_logo=qa.createSpriteByName("lagged_logo",0,.5,0,0),e.lagged_logo.anchor.x=0,e.lagged_logo.anchor.y=.5,e.lagged_logo.hitArea=new PIXI.Rectangle(-5,-30,200,60),e.lagged_logo.interactive=!0,e.lagged_logo.buttonMode=!0,e.lagged_logo.interactiveChildren=!1,e.lagged_logo.pointerdown=function(e){lo.get_window().open("http://lagged.com/","_blank")},e.menu_container.addAt(e.lagged_logo,0),e.lagged_logo.x=e.pause_button.x+80,e.lagged_logo.y=e.pause_button.y+3)),e.level_type==Zn.InRacing||e.level_type==Zn.InInterLevelMenu){e.ongoing_powers_display.current_items=[];for(var t=0,n=e.game_save.ongoing_powers.permanent_items;t<n.length;){var i=n[t];++t,e.ongoing_powers_display.current_items.push(i)}for(var r=0,a=e.game_save.ongoing_powers.level_items;r<a.length;){var s=a[r];++r,e.ongoing_powers_display.current_items.push(s)}}if(e.level_type==Zn.InRacing){if(e.collected_in_level=new zr,e.race_countdown=new Cn,e.race_countdown.container=qa.createGroup(),e.race_countdown.animation=A.createNewAnimation(Gs.animation_race_start,!1),e.race_countdown.container.add(e.race_countdown.animation.sprite),e.race_countdown.current_number=Cn.max_countdown_state,e.race_countdown.current_time=Cn.init_wait,e.current_place=new Sn,e.current_place.container=qa.createGroup(),e.current_place.anim=A.createNewAnimation(Gs.animation_current_position,!1),e.current_place.container.add(e.current_place.anim.sprite),e.current_place.player_position=new PIXI.Point,e.ingame_container.add(e.current_place.container),e.current_level_save.description.type!=wr.LevelRegular)if(e.current_level_save.description.type==wr.LevelChallenge){e.race_countdown.challenge_text=qa.createBitmapText(fn.toonish_36,42,"left","TEXT"),e.race_countdown.challenge_text.anchor.set(.5,.5);var l=e.current_level_save.description.challenge_type;l==kr.ChallengeEscapeFromWolf?(e.challenges.escape_from_wolf=Xt.createEscapeFromWolfChallenge(e.stage_group,e.player,e.bots,e.car_upgrade_data,e.car_settings,e.current_level_save.description.challenge_type),e.race_countdown.challenge_text.text="Challenge: Escape From Wolf!"):l==kr.ChallengeHuntThePrey?(e.challenges.escape_from_wolf=Xt.createEscapeFromWolfChallenge(e.stage_group,e.player,e.bots,e.car_upgrade_data,e.car_settings,e.current_level_save.description.challenge_type),e.race_countdown.challenge_text.text="Challenge: Hunt The Prey!"):l==kr.ChallengeMountainRush?(e.challenges.mountain_rush=Xt.createMountainRushChallenge(e.stage_group,e.player,e.bots,e.car_upgrade_data,e.car_settings),e.race_countdown.challenge_text.text="Challenge: Do "+Lt.flip_count+" Flips!"):l==kr.ChallengeSurvival?(e.challenges.survival=Xt.createSurvivalChallenge(e.stage_group,e.player,e.bots,e.car_upgrade_data,e.car_settings,e.temp_interactive_objects),e.race_countdown.challenge_text.text="Challenge: Survive!"):l==kr.ChallengeBalancing?(e.challenges.balancing=Xt.createBalancingChallenge(e.stage_group,e.player,e.bots,e.car_upgrade_data,e.car_settings,e.boxes),e.race_countdown.challenge_text.text="Challenge: Don't Break The Box!"):l==kr.ChallengeBulletTaxi?(e.challenges.bullet_taxi=Xt.createBulletTaxiChallenge(e.stage_group,e.player,e.bots,e.car_upgrade_data,e.car_settings),e.race_countdown.challenge_text.text="Challenge: Reach Destination in "+Gt.max_time+" Seconds!"):l==kr.ChallengeAchievement?(e.challenges.achievement=Xt.createAchievementChallenge(e.stage_group,e.player,e.bots),e.race_countdown.challenge_text.text=""):l==kr.ChallengeCredits?(e.challenges.credits=Xt.createCreditsChallenge(e.stage_group,e.player,e.bots),e.race_countdown.challenge_text.text=""):Nl.trace("warning: unhandled "+p.string(l),{fileName:"GameDo.hx",lineNumber:2496,className:"bikas.game.GameDo",methodName:"createLevelObjects"})}else Nl.trace("warning: unhandled "+p.string(e.current_level_save.description.type),{fileName:"GameDo.hx",lineNumber:2499,className:"bikas.game.GameDo",methodName:"createLevelObjects"});return!0}if(e.level_type==Zn.InInterLevelMenu)return e.inter_level_menu=zi.create(e.game_save,e.stage_group,e.game_save.level_saves,e.upgrades,e.car_settings,e.chest_reward_item_descs,e.achievement_descs,e.challenge_descs,e.markers),Vn.saveGameSaveToStorage(e.game_save_serial_data,e.game_save),!0;if(e.level_type!=Zn.InMainMenu)return Nl.trace("warning: unhandled level_type == "+p.string(e.level_type),{fileName:"GameDo.hx",lineNumber:2537,className:"bikas.game.GameDo",methodName:"createLevelObjects"}),!1;var o=null,_=Fi.LoadedGameNoSave;return _=e.initial_game_save_loaded?(o=e.game_save,Fi.ContinueGame):(e.initial_game_save_loaded=!0,null==(o=Vn.loadGameSaveFromStorage(e.game_save_serial_data))?(o=null,Fi.LoadedGameNoSave):Fi.LoadedGameWithSave),e.main_menu=Ui.create(e.config,e.markers,_,o),!0},Vn.createAndAddTexturedPolygonEntity=function(e,t,n){var i=Ra.PatternFill,r=new Dn,a=(r.entity=e).polygon.texture.fill_source_name;Vn.createAndAddGrass(r.line_sprites,e);for(var s=[],l=0,o=e.polygon.points;l<o.length;){var _=o[l];++l,s.push(ea.create(_.x,_.y))}if(i==Ra.PatternFill){var p=qa.createGraphics();p.x=e.position.x,p.y=e.position.y;var u=Hs.retrieveAsset(a+"_pattern"),h=!1;null==e.body&&(h=!0),r.data=Ua.createPolygonTextureDataUsingPatternFill(p,s,u,h)}else if(i==Ra.Tiles)return Nl.trace("warning: not supported",{fileName:"GameDo.hx",lineNumber:2583,className:"bikas.game.GameDo",methodName:"createAndAddTexturedPolygonEntity"}),null;return r.draw_bounds=new ia(0,0,0,0),r},Vn.createTerrainPolygons=function(e,t,n){null==n&&(n=300);for(var i=[],r=0;r<e.length;){var a=e[r];if(++r,null==a.polygon)Nl.trace("warning: entity.polygon == null",{fileName:"GameDo.hx",lineNumber:2634,className:"bikas.game.GameDo",methodName:"createTerrainPolygons"});else if(null==a.polygon.texture)Nl.trace("warning: entity.polygon.texture == null",{fileName:"GameDo.hx",lineNumber:2637,className:"bikas.game.GameDo",methodName:"createTerrainPolygons"});else{for(var s=a.polygon.texture.fill_source_name,l=null,o=0;o<i.length;){var _=i[o];if(++o,_.texture_name==s){l=_;break}}var p=null;null==l?((p=new En).texture_name=s,p.texture=Hs.retrieveAsset(s),i.push(p)):p=l,p.entities.push(a)}}for(var u=0;u<i.length;){var h=i[u];++u;var c=h.entities[0];h.main_entity_position=za.copy(c.position),null!=c.body?h.has_physics_body=!0:h.has_physics_body=!1;for(var d=[],m=0,f=c.polygon.points;m<f.length;){var g=f[m];++m,d.push(ea.create(g.x,g.y))}h.polygons.push(d);for(var v=1,b=h.entities.length;v<b;){for(var y=v++,x=h.entities[y],z=[],w=0,k=x.polygon.points;w<k.length;){var S=k[w];++w;var C=S.x+x.position.x-h.main_entity_position.x,N=S.y+x.position.y-h.main_entity_position.y;z.push(ea.create(C,N))}h.polygons.push(z)}}for(var P=0;P<i.length;){var M=i[P];++P,M.terrain=Es.create(M.polygons,Math.floor(t-M.main_entity_position.y+n),M.texture)}return i},Vn.createSpritesForTerrainPolygons=function(e){for(var t=0;t<e.length;){var n=e[t];if(++t,null!=n.terrain){var i=n.main_entity_position.x,r=n.main_entity_position.y;n.sprite_objects=Es.createSpriteObjects(n.terrain.all_terrain_rects,i,r,Un.texture_offset_add),n.global_bounds=ma.copyBounds(n.terrain.bounds),ga.moveBounds(n.global_bounds,i,r),n.global_polygons_bounds=[],n.global_polygons=[];for(var a=0,s=n.polygons;a<s.length;){var l=s[a];++a;for(var o=[],_=0;_<l.length;){var p=l[_];++_,o.push(ea.create(p.x+i,p.y+r))}n.global_polygons.push(o);var u=ns.getPolygonBounds(o);n.global_polygons_bounds.push(u)}}}for(var h=[],c=[],d=0;d<e.length;){var m=e[d];++d,m.has_physics_body?c.push(m):h.push(m)}for(var f=0;f<h.length;){var g=h[f];++f;for(var v=0;v<c.length;){var b=c[v];if(++v,ma.boundsIntersectOrContain(g.global_bounds,b.global_bounds))for(var y=g.sprite_objects.length,x=0;x<y;){var z=g.sprite_objects[x];if(ma.boundsIntersectOrContain(z.global_bounds,b.global_bounds))for(var w=0,k=b.global_polygons_bounds.length;w<k;){var S=w++,C=b.global_polygons_bounds[S];if(ma.boundsIntersectOrContain(z.global_bounds,C)){var N=b.global_polygons[S];if(!ns.boundsIntersectWithPolygon(z.global_bounds,N)){var P=new ea(z.global_bounds.min_x,z.global_bounds.min_y);if(ns.pointInPolygon(P,N)){Es.destroySpriteObject(g.sprite_objects[x]),g.sprite_objects.splice(x,1),--x,--y;break}}}}++x}}}for(var M=0,I=0;I<e.length;){var T=e[I];++I,T.sprites=Es.createSprites(T.sprite_objects);for(var A=0,D=T.entities;A<D.length;){var E=D[A];++A,Vn.createAndAddGrass(T.line_sprites,E)}T.entities=null,M+=T.line_sprites.length,M+=T.sprites.length}Nl.trace("total sprites created for all terrains: "+M,{fileName:"GameDo.hx",lineNumber:2813,className:"bikas.game.GameDo",methodName:"createSpritesForTerrainPolygons"})},Vn.createBackground=function(e,t,n,i,r){var a=qa.createSprite(Gs.background_sea),s=qa.createSprite(Gs.background_sky,0,1);a.x=0,a.width=i.current_game_width,s.x=0,s.width=i.current_game_width,new Gi(0,0,800),new Gi(0,0,800);var l=Xe.createBackground(800,a,s,r+300,642);t.add(l.plane_container),t.add(l.background_container),n.add(l.foreground_container);var o=Gs.background_objects_obj;return Xe.overloadBackground(l,o,"default",e,function(e){return _.field(Gs,e)}),Vn.addWavesToBackground(l),l},Vn.addWavesToBackground=function(e){var t=["background_waves_1","background_waves_2","background_waves_3","background_waves_4","background_waves_5","background_waves_6","background_waves_7","background_waves_8","background_waves_9","background_waves_10","background_waves_11","background_waves_12","background_waves_13"],n=[923,1067,1236,1440,1689,2e3,2400,2933,3680,4800,6667,10400,21600];if($s.js_info.android||$s.js_info.iOS||!$s.js_info.desktop)for(var i=1,r=Math.ceil(t.length/2);i<r;){var a=i++;t.splice(a,1),n.splice(a,1)}Xe.removeAllSpritesFromContainer(e),Xe.addWaves(e,t,n,1,function(e){return _.field(Gs,e)}),Xe.addAndSortAllSpritesToContainer(e)},Vn.centerStage=function(e,t){e.entity_container.x=0,e.entity_container.y=0},Vn.createTreePartition=function(e){for(var t=[],n=[],i=[],r=[],a=[t,n,i,r],s=0,l=e.terrain_polygons;s<l.length;){var o=l[s];if(++s,null!=o.sprites)for(var _=0,p=o.sprites;_<p.length;){var u=p[_];++_,o.has_physics_body?n.push(Da.create(u,!1)):t.push(Da.create(u,!1))}}var h=null,c=h=function(e,t,n){if(null!=n.group)for(var i=0,r=n.group.entities;i<r.length;){var a=r[i];++i,h(e,t,a)}if(null!=n.bitmap_images){var s=!1;null!=n.body&&n.body.isDynamic()&&(s=!0);for(var l=0;l<t.length;){var o=t[l];if(++l,o.connected_container==n.display.sprite){s=!0;break}}e.push(Da.create(n.display.sprite,s,n.name))}};null==e.stage_group?Nl.trace("error: game.stage_group == null",{fileName:"GameDo.hx",lineNumber:2966,className:"bikas.game.GameDo",methodName:"createTreePartition"}):c(i,e.connected_containers,e.stage_group);var d=i;d.sort(function(e,t){var n=e.display_object.parent.getChildIndex(e.display_object),i=t.display_object.parent.getChildIndex(t.display_object);return i<n?1:n<i?-1:0});for(var m=0;m<d.length;){var f=d[m];++m,null!=f.display_object.parent&&f.display_object.parent.removeChild(f.display_object)}for(var g=0,v=e.terrain_polygons;g<v.length;){var b=v[g];++g;for(var y=0,x=b.line_sprites;y<x.length;){var z=x[y];++y,r.push(Da.create(z,!1))}}var w=[];if(0==e.config.type&&e.config.development.render_markers)for(var k=0,S=e.markers;k<S.length;){var C=S[k];++k,null!=C.point_graphics&&w.push(Da.create(C.point_graphics,!1)),null!=C.bitmap_text&&w.push(Da.create(C.bitmap_text,!1))}e.background_ground_group=qa.createGroup(),e.entity_container.addAt(e.background_ground_group,0),e.grass_group=qa.createGroup(),e.entity_container.add(e.grass_group),e.ground_group=qa.createGroup(),e.entity_container.add(e.ground_group),0<w.length&&(e.marker_group=qa.createGroup(),e.entity_container.add(e.marker_group));for(var N=0,P=e.textured_polygons;N<P.length;){var M=P[N];++N,M.data.is_background_ground?e.background_ground_group.add(M.data.real_time_graphics):e.ground_group.add(M.data.real_time_graphics)}for(var I=0,T=e.textured_polygons;I<T.length;){var A=T[I];++I;for(var D=0,E=A.line_sprites;D<E.length;){var O=E[D];++D,r.push(Da.create(O,!1))}}for(var B=0,L=e.cave_meshes;B<L.length;){var j=L[B];++B,e.background_ground_group.add(j)}for(var F=0,R=e.ground_meshes;F<R.length;){var G=R[F];++F,e.ground_group.add(G)}for(var Z=0,U=e.mesh_line_sprites;Z<U.length;){var V=U[Z];++Z,r.push(Da.create(V,!1))}var q=[],W=Fa.createPartitionContainer(e.stage_group.group.container,d);if(0<t.length){var X=Fa.createPartitionContainer(e.background_ground_group,t);q.push(X)}if(q.push(W),0<r.length){var H=Fa.createPartitionContainer(e.grass_group,r);q.push(H)}if(0<n.length){var Y=Fa.createPartitionContainer(e.ground_group,n);q.push(Y)}if(0<w.length){var J=Fa.createPartitionContainer(e.marker_group,w);q.push(J)}e.entity_partition_container=W,e.partition_top=Fa.createPartition(q,La.HorizontalBinaryTree,512,512,5120);for(var K=0;K<a.length;){var Q=a[K];++K;for(var $=0;$<Q.length;){var ee=Q[$];++$,Da.destroy(ee)}}a=null},Vn.destroyLevel=function(e,t,n){e.level_end.state=xn.None,e.level_end.famobi_posted=!1,Ms.setVolume(Gs.music_avocado_easy_times_in_hawaii,0),Ms.setVolume(Gs.music_beach_waves,0),Ms.setVolume(Gs.music_stereospice_fun_surf_rock_142_sec,0),Ms.setVolume(Gs.music_stereospice_fun_surf_rock_92_sec,0),Ms.stopMusic(Gs.music_avocado_easy_times_in_hawaii),Ms.stopMusic(Gs.music_beach_waves),Ms.stopMusic(Gs.music_stereospice_fun_surf_rock_142_sec),Ms.stopMusic(Gs.music_stereospice_fun_surf_rock_92_sec),Vn.safeRemove(e.pause_menu.container),Vn.safeRemove(e.level_end.finished_text),Vn.safeRemove(e.level_end.challenge_button),De.cancelAll(),null!=e.lagged_logo&&(e.lagged_logo.destroy(!0),e.lagged_logo=null),Vn.setTutorial(e,Fn.TutorialNone),null!=e.stage_group&&Vn.setSpace(e,null);for(var i=0,r=e.textured_polygons;i<r.length;){var a=r[i];if(++i,null!=a.data.points){for(var s=0,l=a.data.points;s<l.length;){var o=l[s];++s,ea.destroy(o)}a.data.points=null}null!=a.data.tiles&&a.data.tiles.parent.removeChild(a.data.tiles),null!=a.data.mask_graphics&&a.data.mask_graphics.parent.removeChild(a.data.mask_graphics),null!=a.data.line_group&&a.data.line_group.parent.removeChild(a.data.line_group);for(var _=0,p=a.line_sprites;_<p.length;){var u=p[_];++_,u.destroy(!0)}a.line_sprites=null,Ua.destroy(a.data)}e.textured_polygons=[];for(var h=0,c=e.cave_meshes;h<c.length;){var d=c[h];++h,d.parent.removeChild(d),d.destroy()}e.cave_meshes=[];for(var m=0,f=e.ground_meshes;m<f.length;){var g=f[m];++m,g.parent.removeChild(g),g.destroy()}e.ground_meshes=[];for(var v=0,b=e.mesh_line_sprites;v<b.length;){var y=b[v];++v,y.destroy(!0)}if(e.mesh_line_sprites=[],n){for(var x=0,z=e.terrain_polygons;x<z.length;){var w=z[x];++x;for(var k=0,S=w.sprites;k<S.length;){var C=S[k];++k,null!=C.parent&&C.parent.removeChild(C)}for(var N=0,P=w.line_sprites;N<P.length;){var M=P[N];++N,null!=M.parent&&M.parent.removeChild(M)}}e.use_cached_terrain_polygons=!0}else{for(var I=0,T=e.terrain_polygons;I<T.length;){var D=T[I];if(++I,D.entities=null,(D.texture=null)!=D.main_entity_position&&(ea.destroy(D.main_entity_position),D.main_entity_position=null),(D.global_bounds=null)!=D.polygons)for(var E=0,O=D.polygons;E<O.length;){var B=O[E];++E;for(var L=0;L<B.length;){var j=B[L];++L,ea.destroy(j)}}if((D.polygons=null)!=D.global_polygons)for(var F=0,R=D.global_polygons;F<R.length;){var G=R[F];++F;for(var Z=0;Z<G.length;){var U=G[Z];++Z,ea.destroy(U)}}D.global_polygons=null;for(var V=0,q=D.sprite_objects;V<q.length;){var W=q[V];++V,Es.destroySpriteObject(W)}D.sprite_objects=null;for(var X=0,H=D.sprites;X<H.length;){var Y=H[X];++X,Y.destroy(!0)}D.sprites=null;for(var J=0,K=D.line_sprites;J<K.length;){var Q=K[J];++J,Q.destroy(!0)}(D.line_sprites=null)!=D.terrain&&Es.destroy(D.terrain),D.terrain=null}e.terrain_polygons=[],e.use_cached_terrain_polygons=!1}if(e.textured_polygon_entities=[],null!=e.markers)for(var $=0,ee=e.markers;$<ee.length;){var te=ee[$];++$,Vn.destroyMarker(te)}(e.markers=null)!=e.background_ground_group&&(e.background_ground_group.destroy(!1),e.background_ground_group=null),null!=e.ground_group&&(e.ground_group.destroy(!1),e.ground_group=null),null!=e.grass_group&&(e.grass_group.destroy(!0),e.grass_group=null),null!=e.marker_group&&(e.marker_group.destroy(!0),e.marker_group=null),null!=e.player&&(hr.destroy(e.player),null!=e.player_bot&&(e.player_bot.abilities=null)),e.player=null;for(var ne=0,ie=e.bots;ne<ie.length;){var re=ie[ne];++ne,yt.destroy(re)}e.bots=[],null!=e.player_bot&&yt.destroy(e.player_bot),e.all_cars=[],e.bot_cars=[],null!=e.camera&&zt.reset(e.camera);for(var ae=0,se=e.boxes;ae<se.length;){var le=se[ae];++ae,$i.destroyBox(le)}e.boxes=[];for(var oe=0,_e=e.forward_ramps;oe<_e.length;){var pe=_e[oe];++oe,$i.destroyForwardRamp(pe)}e.forward_ramps=[];for(var ue=0,he=e.pickable_items;ue<he.length;){var ce=he[ue];++ue,Mi.destroyPickableItem(ce)}e.pickable_items=[];for(var de=0,me=e.explosives;de<me.length;){var fe=me[de];++de,Ae.destroyExplosive(fe,e.partition_top)}e.immune_bodies=[],e.explosives=[],null!=e.background&&(Xe.destroyBackground(e.background),e.background=null);for(var ge=0,ve=e.connected_containers;ge<ve.length;){var be=ve[ge];++ge,be.connected_container=null,be.source_container=null}e.connected_containers=[];for(var ye=0,xe=e.looped_animations;ye<xe.length;){var ze=xe[ye];++ye,A.destroyAnimation(ze)}e.looped_animations=[];for(var we=0,ke=e.chickens;we<ke.length;){var Se=ke[we];++we,A.destroyAnimation(Se.anim),Se.anim=null,Se.body=null}e.chickens=[];for(var Ce=0,Ne=e.temp_interactive_objects;Ce<Ne.length;){var Pe=Ne[Ce];++Ce,$i.destroyTempInteractiveObject(Pe)}e.temp_interactive_objects=[];for(var Me=0,Ie=e.attachments;Me<Ie.length;){var Te=Ie[Me];++Me,je.destroy(Te)}e.attachments=[],null!=e.stunt&&(Hr.destroy(e.stunt),e.stunt=null),null!=e.main_menu&&(Ui.destroy(e.main_menu),e.main_menu=null),null!=e.inter_level_menu&&(zi.destroy(e.inter_level_menu,e.partition_top),e.inter_level_menu=null),Xt.destroyAllChallenges(e.challenges),null!=e.partition_top&&(Fa.destroy(e.partition_top),e.partition_top=null),(e.entity_partition_container=null)!=e.race_countdown&&(null!=e.race_countdown.container.parent&&e.race_countdown.container.parent.removeChild(e.race_countdown.container),A.destroyAnimation(e.race_countdown.animation,!0),e.race_countdown.container.destroy(!0),null!=e.race_countdown.challenge_text&&(Vn.safeRemove(e.race_countdown.challenge_text),e.race_countdown.challenge_text.destroy(!0),e.race_countdown.challenge_text=null),e.race_countdown=null),null!=e.current_place&&(A.destroyAnimation(e.current_place.anim,!0),e.current_place.container.destroy(!0),e.current_place=null),Vr.clearOngoingPowersDisplay(e.ongoing_powers_display),null!=e.level_stats&&Oi.remove(e.level_stats);for(var Ee=e.car_original_rotations.keys();Ee.hasNext();){var Oe=Ee.next();e.car_original_rotations.remove(Oe)}e.camera_shake.amount=0,e.camera_shake.current_time=0,e.level_start_position=null,e.level_end_position=null,e.physics_running=!1,e.level_running=!1,e.all_body_entities=null,e.menu_camera_position=null,e.collected_in_level=null,e.jump_over_bodies=[],Vn.destroyEngine(e,t)},Vn.destroyEngine=function(e,t){null!=e.stage_group&&(Vn.removeAndDestroyEntityIncludingChildren(e.stage_group),e.stage_group=null),t&&null!=e.library_group&&(Vn.removeAndDestroyEntityIncludingChildren(e.library_group),e.library_group=null),null!=e.world&&e.world.space.clear()},Vn.removeAndDestroyEntityIncludingChildren=function(e){oe.removeEntityIncludingChildren(e),ie.destroyEntityIncludingChildren(e)},Vn.resetCamera=function(e,t){t.camera_target_pos.set_x(0),t.camera_target_pos.set_y(0),t.target_pos.set_x(0),t.target_pos.set_y(0),null!=e.stage_group&&(e.stage_group.position.x=0,e.stage_group.position.y=0,e.stage_group.transform.scale_x=1,e.stage_group.transform.scale_y=1,e.stage_group.transform.rotation=0),zt.reset(t)},Vn.setSpace=function(e,t){ie.setSpaceIncludingChildren(e.stage_group,e.world.space),null!=e.player&&Ot.setCarSpace(e.player.car,t);for(var n=0,i=e.bots;n<i.length;){var r=i[n];++n,Ot.setCarSpace(r.car,t)}for(var a=0,s=e.attachments;a<s.length;){var l=s[a];++a,je.setSpace(l,t)}},Vn.initRace=function(e,t){if(e.camera.smooth_steps=Un.countdown_camera_smooth_steps,e.camera.offset_max_speed.set_x(12),e.camera.offset_max_speed.set_y(12),e.camera.offset_max_distance.set_x(300),e.camera.offset_max_distance.set_y(300),e.camera.zoom_min=Un.race_zoom_min,e.camera.zoom_max=Un.race_zoom_max,e.camera.zoom_max_speed=12,Vn.setInGameControlsAlpha(e,1),t.level_seconds=0,Vn.resetCamera(e,e.camera),za.add(e.player.car.main_body_entity.position,new ea(0,0)),e.current_level_save.description.type==wr.LevelRegular){var n=!1;if(null!=e.game_save.ongoing_powers){for(var i=null,r=0,a=e.ongoing_powers_display.current_items;r<a.length;){var l=a[r];++r,l.desc.type==Mr.OneTimeStartFirst&&(n=!0,null==i&&(i=[]),i.push(l))}if(null!=i)for(var o=0;o<i.length;){var _=i[o];++o,s.remove(e.ongoing_powers_display.current_items,_)}}if(n){for(var u=0,h=0,c=e.bots;h<c.length;){var d=c[h];++h,d.car.initial_main_body_position.get_x()>u&&(u=d.car.initial_main_body_position.get_x())}e.player.car.initial_main_body_position.set_x(u+1)}Vn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!0,!0,!1)}else e.current_level_save.description.type==wr.LevelChallenge?e.current_level_save.description.challenge_type==kr.ChallengeEscapeFromWolf?(e.camera.offset_max_distance.set_x(100),e.camera.offset_max_distance.set_y(100),Vn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!1,!0,!1)):e.current_level_save.description.challenge_type==kr.ChallengeHuntThePrey?Vn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!1,!0,!1):e.current_level_save.description.challenge_type==kr.ChallengeMountainRush?Vn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!1,!1,!0):e.current_level_save.description.challenge_type==kr.ChallengeSurvival?(e.camera.offset_max_distance.set_x(400),e.camera.offset_max_distance.set_y(100),Vn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!0,!0,!1)):e.current_level_save.description.challenge_type==kr.ChallengeBalancing?(e.camera.offset_max_distance.set_x(1),e.camera.offset_max_distance.set_y(1),Vn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!1,!1,!1)):e.current_level_save.description.challenge_type==kr.ChallengeBulletTaxi?(e.camera.offset_max_distance.set_x(300),e.camera.offset_max_distance.set_y(1),Vn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!0,!0,!1)):e.current_level_save.description.challenge_type==kr.ChallengeAchievement?Vn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!1,!0,!1):e.current_level_save.description.challenge_type==kr.ChallengeCredits?Vn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!1,!0,!1):Nl.trace("warning: unhandled "+p.string(e.current_level_save.description.challenge_type),{fileName:"GameDo.hx",lineNumber:3626,className:"bikas.game.GameDo",methodName:"initRace"}):Nl.trace("warning: unhandled "+p.string(e.current_level_save.description.type),{fileName:"GameDo.hx",lineNumber:3629,className:"bikas.game.GameDo",methodName:"initRace"});e.player.finished_race=!1;for(var m=0,f=e.bots;m<f.length;){var g=f[m];++m,g.finished_race=!1}if(0!=e.config.type||e.config.development.race_countdown_enabled){Vn.refreshCameraCenter(e,e.camera,e.js_info,e.player.car.main_body_entity.position,.5),e.race_countdown.finished=!1,e.player.behavior_activated=!1,null!=e.player_bot&&(e.player_bot.behavior_activated=!1);for(var v=0,b=e.bots;v<b.length;){var y=b[v];++v,y.behavior_activated=!1}}else Vn.refreshCameraCenter(e,e.camera,e.js_info,e.player.car.main_body_entity.position,e.camera.zoom_max),e.race_countdown.finished=!0,e.race_countdown.engine_sound_allowed=!0,Vn.startRace(e,t);0==e.config.type&&(e.player.constant_drive=!1);for(var x=0,z=e.all_body_entities;x<z.length;){var w=z[x];++x,ce.refresh(w)}Vn.updateCamera(e,t),Vn.updatePolygonDraw(e);for(var k=0,S=e.temp.initraces;k<S.length;){var C=S[k];++k,C()}4==e.config.release.sitelock_type&&null!=e.current_level_save&&ve.trackStart(e.current_level_save.description_name)},Vn.initMenu=function(e,t){t.level_seconds=0,Vn.setInGameControlsAlpha(e,0),e.camera.smooth_steps=Un.camera_smooth_steps,e.camera.offset_max_speed.set_x(0),e.camera.offset_max_speed.set_y(0),e.camera.offset_max_distance.set_x(0),e.camera.offset_max_distance.set_y(0),e.camera.zoom_min=1,e.camera.zoom_max=1,e.camera.current_zoom=1,e.camera.zoom_max_speed=12,e.camera.camera_target_pos.set_x(0),e.camera.camera_target_pos.set_y(0),e.camera.target_pos.set_x(0),e.camera.target_pos.set_y(0),Vn.resetCamera(e,e.camera),e.camera.smooth_steps=xi.camera_smooth_steps,null!=e.menu_camera_position&&Vn.refreshCameraCenter(e,e.camera,e.js_info,e.menu_camera_position,1),null!=e.inter_level_menu&&(wa.set(e.inter_level_menu.scroll_target,e.menu_camera_position),e.inter_level_menu.downed=!1,e.inter_level_menu.dragging=!1);for(var n=0,i=e.all_body_entities;n<i.length;){var r=i[n];++n,ce.refresh(r)}Vn.updateCamera(e,t),Vn.updatePolygonDraw(e)},Vn.startRace=function(e,t){e.camera.smooth_steps=Un.camera_smooth_steps,e.race_start_at_second=t.level_seconds,e.player.behavior_activated=!0,null!=e.player_bot&&(e.player_bot.behavior_activated=!0);for(var n=0,i=e.bots;n<i.length;){var r=i[n];++n,r.behavior_activated=!0;for(var a=0,s=r.all_decisions;a<s.length;){var l=s[a];++a,l.decision_made_time_stamp=t.level_seconds}}1==e.config.type&&3==e.config.release.sitelock_type&&es.PokiSDK.gameplayStart()},Vn.lineUpCarsRelativeToPosition=function(e,t,n,i,r,a,s,l){null==l&&(l=!1),null==s&&(s=!0),null==a&&(a=!0),null==r&&(r=!1);var o=0;null!=n&&++o,null!=i&&(o+=i.length);var _=e.x-200*(o-1)/2,p=0,u=[];if(null!=n&&u.push(n.car),null!=i)for(var h=0;h<i.length;){var c=i[h];++h,u.push(c.car)}r?ga.shuffleArray(u):u.sort(Vn.sortCarsByInitialPositionX);for(var d=0;d<u.length;){var m=u[d];++d,p=s?e.y-m.distance_from_main_body_to_bottom_y:m.main_body.get_position().get_y();var f=0;a?(f=_,r&&(f=e.x+ma.getRandomBetween(-600,600))):f=m.main_body.get_position().get_x();var g=t.get(m.group_entity);null!=g?Vn.teleportCar(m,f,p,.017453292519943*g):Vn.teleportCar(m,f,p),_+=200}},Vn.teleportCar=function(e,t,n,i){null==i&&(i=0),Ot.setPosition(e,t,n),Ot.setRotation(e,i),Ot.setVelocity(e,0,0),Ot.setAngularVelocity(e,0)},Vn.teleportPlayerToFinish=function(e){if(null!=e.player&&null!=e.level_end_position){var t=e.level_end_position.x+250,n=e.level_end_position.y;Vn.teleportCar(e.player.car,t,n),e.stage_group.position.x=t,e.stage_group.position.y=n,e.camera.target_speed.set_x(t),e.camera.target_speed.set_y(n),e.camera.current_pos.set_x(t),e.camera.current_pos.set_y(n),e.camera.target_pos.set_x(t),e.camera.target_pos.set_y(n)}},Vn.isObjectClickedInRadius=function(e,t,n){return $a.isClicked(e.x,e.y,t,n)},Vn.isObjectDownedInRadius=function(e,t,n){return $a.isDowned(e.x,e.y,t,n)},Vn.isBitmapTextDownedInBounds=function(e,t,n){var i=e.x-e.anchor.x*e.width-n,r=e.y-e.anchor.y*e.height-n,a=i+e.width+n,s=r+e.height+n;return $a.isDownedInBounds(e.x,e.y,t,i,r,a,s)},Vn.moreGamesClick=function(){ka.trackMoreGamesClicked(),lo.get_window().open("http://www.bikas.net","_blank")},Vn.bikasNetClick=function(){ka.trackBikasNetClicked(),lo.get_window().open("http://www.bikas.net","_blank")},Vn.createMarker=function(e,t,n){var i=new On;return i.entity=e,i.name=t,i.position=i.entity.position,n&&(i.bitmap_text=new ms($s.game,0,0,"consolas_24",t,42,"center"),i.bitmap_text.x=-i.bitmap_text.width/2,i.bitmap_text.y=-69.72,i.point_graphics=qa.createGraphics(),Va.drawCross(i.point_graphics,25.2,1651777,3),Va.drawCircle(i.point_graphics,42,3,1651777)),i},Vn.destroyMarker=function(e){null!=e.bitmap_text&&e.bitmap_text.destroy(!0),null!=e.point_graphics&&e.point_graphics.destroy(!0),e.entity=null,e.bitmap_text=null,e.point_graphics=null},Vn.findMarker=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.name==t)return i}return null},Vn.setInGameControlsAlpha=function(e,t){null!=e.wheel&&(e.wheel.sprite.alpha=t),e.ability_item_container.alpha=t,null!=e.player&&(e.player.jump_button.container.alpha=t,null!=e.player.mobile_controls&&(e.player.mobile_controls.clockwise.container.alpha=t,e.player.mobile_controls.anti_clockwise.container.alpha=t))},Vn.applyCameraShake=function(e,t,n,i,r){if(null==i||null==r)return e.amount=t,void(e.current_time=n);var a=ma.distance(r.get_x(),r.get_y(),i.main_body_position_x,i.main_body_position_y);if(a<800)e.amount=t,e.current_time=n;else if(a<1600){var s=(a-800)/800;e.amount=ma.interpolate(t,0,s),e.current_time=ma.interpolate(n,0,s)}},Vn.pushNotification=function(e,t,n,i,r){null==r&&(r=2),null==i&&(i=0),null==n&&(n="");var a=new In;a.primary_text=t,a.secondary_text=n,a.wait_before_phase_in_time=i,a.wait_time=r,e.show_cue.push(a)},Vn.setTutorial=function(e,t){var n=e.js_info.desktop;0==e.config.type&&e.config.development.test_famobi_mobile_controls&&(n=!1);var i=e.tutorial_menu;i.current_time=0,i.phase_in_current_time=0,i.state,(i.state=t)!=Fn.TutorialNone?(null==i.container.parent&&e.menu_container.add(i.container),t!=Fn.TutorialPhaseOut?(i.container.alpha=1,i.white_circle.visible=!1,i.white_circle2.visible=!1,i.text.visible=!1,i.keyboard_controls.visible=!1,i.wheel.visible=!1,i.finger.visible=!1,i.jump_button.visible=!1,i.nitro_button.visible=!1,i.power_button.visible=!1,i.mobile_clockwise_button.visible=!1,i.mobile_anti_clockwise_button.visible=!1,t==Fn.TutorialControls?n?i.keyboard_controls.visible=!0:null!=e.wheel?(i.text.text="Drag wheel to control the car",i.text.visible=!0,i.wheel.visible=!0,i.finger.visible=!0):null!=e.player.mobile_controls?(i.text.text="Touch & Hold here to control the car",i.text.visible=!0,i.mobile_clockwise_button.visible=!0,i.mobile_anti_clockwise_button.visible=!0,i.white_circle.visible=!0,i.white_circle2.visible=!0):Nl.trace("warning: no controls tutorial for mobile, this can't happen!",{fileName:"GameDo.hx",lineNumber:4038,className:"bikas.game.GameDo",methodName:"setTutorial"}):t==Fn.TutorialJump?(i.white_circle.visible=!0,i.text.visible=!0,i.jump_button.visible=!0,i.text.text=n?"Click here or press SPACE to jump":"Touch here to jump"):t==Fn.TutorialNitro?(i.white_circle.visible=!0,i.text.visible=!0,i.nitro_button.visible=!0,i.text.text=n?"Click here or press SHIFT or Q to use nitro boost":"Touch here to use nitro boost"):t==Fn.TutorialPower&&(i.white_circle.visible=!0,i.text.visible=!0,i.power_button.visible=!0,i.text.text=n?"Click here or press ENTER to use power":"Touch here to use power",4==e.config.release.sitelock_type&&ve.trackTutorialCompleted())):i.current_time=0):null!=i.container.parent&&i.container.parent.removeChild(i.container)},Vn.animateTutorialCircle=function(e,t,n,i){t.current_time+=e.step.step_size,t.current_time>Rn.white_circle_time&&(t.current_time-=Rn.white_circle_time);var r=ma.clamp0to1(t.current_time/Rn.white_circle_time),a=i.width+30,s=i.width+60,l=va.smoothForwardAndBackward(a,s,r);n.position.x=i.position.x,n.position.y=i.position.y,n.width=l,n.height=l},Vn.mirrorTransform=function(e,t){e.position.x=t.position.x,e.position.y=t.position.y,e.scale.x=t.scale.x,e.scale.y=t.scale.y,e.rotation=t.rotation},Vn.createAndAddGrass=function(e,t){if(null!=t.polygon){var n=Hs.retrieveAsset(t.polygon.texture.line_source_name);null==n&&(n=Gs.zole);var i=.9*n.height,r=Math.PI/3;if(null!=t.body)for(var a=Ua.createSpritesOnPolygon(t.polygon.points,n,r,i),s=0;s<a.length;){var l=a[s];++s,l.x+=t.position.x,l.y+=t.position.y,e.push(l)}}else Nl.trace("warning: entity.polygon == null",{fileName:"GameDo.hx",lineNumber:4117,className:"bikas.game.GameDo",methodName:"createAndAddGrass"})},Vn.sortCarsByPosition=function(e,t){var n=e.main_body_position_x,i=t.main_body_position_x;return i<n?1:n<i?-1:0},Vn.sortCarsByInitialPositionX=function(e,t){return e.initial_main_body_position.get_x()>t.initial_main_body_position.get_x()?1:e.initial_main_body_position.get_x()<t.initial_main_body_position.get_x()?-1:0},Vn.calculateSpeedIncreaseBasedOnDistance=function(e,t,n,i,r,a){var s=e.main_body_position_x-t.main_body_position_x,l=ma.clamp(va.getT(n,i,s),0,1);return va.linear(r,a,l)},Vn.refreshCameraCenter=function(e,t,n,i,r){if(null==r&&(r=-1),null!=t){t.center.set_x(.5*n.current_game_width);var a=n.current_game_width/n.current_game_height,s=.3333333333333333,l=.3333333333333333,o=.5;if(e.level_type==Zn.InMainMenu&&(l=Zi.ratio_start,o=Zi.ratio_end),a<1.2){var _=va.getT(1.2,.4618015963511973,a);_=ma.clamp(_,0,1),s=va.linear(l,o,_),t.follow_position_offset.set_y(va.smoothStart(0,760,_))}else s=l,t.follow_position_offset.set_y(0);e.camera_view_ratio=s,e.background_ratio=s,t.center.set_y(n.current_game_height*s),-1==r&&(r=e.camera.current_zoom),zt.init(e.camera,i,e.stage_group.position,r),zt.setCurrentPositionRelativeToTarget(e.camera,i,e.stage_group.position,e.stage_group.transform,0,e.camera.follow_position_offset.get_y()),e.current_camera_refresh_width_cache=n.current_game_width,e.current_camera_refresh_height_cache=n.current_game_height}},Vn.createFly=function(e){var t=25*Math.random(),n=Math.random()*Math.PI*2-Math.PI,i=e.x+Math.cos(n)*t,r=e.y+Math.sin(n)*t,a=E.create(new ea(i,r),e,2,0,new ha(.12,.18),new ha(1.57,3.14),25),s=new gn;return s.fly=a,s.container=qa.createGroup(),s.body=qa.createSprite(Gs.fly_no_wings,.5,.5),s.wings=qa.createSprite(Gs.fly_wings,.5,.5),s.wings.alpha=.5,s.container.add(s.body),s.container.add(s.wings),s},Vn.updateFly=function(e,t){E.update(e.fly,t),e.container.position.x=e.fly.position.x,e.container.position.y=e.fly.position.y,e.container.rotation=e.fly.angle+Math.PI/2},Vn.updateDisplayTransition=function(e,t,n,i,r){return null==r&&(r=.1),n&&null==t.parent&&(t.alpha=0,e.add(t)),null==t.parent||(n?(t.alpha=ma.clamp(t.alpha+i*r,0,1),1==t.alpha):(t.alpha=ma.clamp(t.alpha-i*r,0,1),0==t.alpha&&(e.remove(t),!0)))},Vn.updateMovingCircle=function(e,t){e.frame=k.getNextFrame(0,1,e.frame+.03*t);var n=va.linearForwardAndBackward(e.min_scale,e.max_scale,e.frame);e.sprite.scale.set(n,n)},Vn.wait=function(e,t,n){return null==e.wait?(e.wait=new un(0,n),!1):(e.wait.current+=t,e.wait.current>=e.wait.max&&!(e.wait=null))},Vn.safeAdd=function(e,t){null==t.parent&&e.add(t)},Vn.safeRemove=function(e){null!=e.parent&&e.parent.removeChild(e)},Vn.spawnAttachment=function(e,t,n,i,r,a){if(null==a&&(a=-1),(null!=t||(Nl.trace("warning: partition_top == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"spawnAttachment"}),0))&&(null!=n||(Nl.trace("warning: entity_partition_container == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"spawnAttachment"}),0))){var s=y_.get(),l="";r==Be.AttachmentBalloon?(s.set_x(ma.boundsMiddleX(i.bounds)),s.set_y(i.bounds.min_y),l="balloons"):r==Be.AttachmentAnchor&&(null!=i.exhaust_position?(s.set_x(i.exhaust_position.get_x()+12),s.set_y(i.exhaust_position.get_y())):(s.set_x(i.bounds.min_x),s.set_y(ma.boundsMiddleY(i.bounds))),l="anchor");var o=i.main_body.localPointToWorld(s),_=Vn.spawnPrefabLink(e,t,n,l,o.get_x(),o.get_y());if(null!=_){var p=null;r==Be.AttachmentBalloon?p=je.createBalloons(_,i.main_body,a):r==Be.AttachmentAnchor&&(p=je.createAnchor(_,i.main_body,a)),je.setSpace(p,e.world.space),e.attachments.push(p),s.dispose(),o.dispose()}}},Vn.spawnPrefabLink=function(e,t,n,i,r,a){var s=e.stage_group,l=e.library_group,o=e.engine.engine_serial_data,_=ie.createDefaultEntity();_.position.x=r,_.position.y=a,_.prefab_link=new Q;for(var p=0,u=l.group.entities;p<u.length;){var h=u[p];if(++p,h.name==i){_.prefab_link.guid=h.guid,_.prefab_link.prefab_entity=h;break}}if(null==_.prefab_link.prefab_entity)return Nl.trace("warning: couldn't find "+i+" prefab",{fileName:"GameDo.hx",lineNumber:4400,className:"bikas.game.GameDo",methodName:"spawnPrefabLink"}),null;s.group.entities.push(_),_.parent=s,ie.flatten(o,_),ie.flattenPolygonEntities(_);var c=null;if((c=function(e,t){if(null!=e.group)for(var n=0,i=e.group.entities;n<i.length;){var r=i[n];++n,c(r,t)}else e.container_link=t})(_,s.group.container),oe.addEntityIncludingChildren(_),!ie.createBodiesForEntities(_,e.all_body_entities,new er,new wi))return Nl.trace("error: couldn't create bodies for "+i,{fileName:"GameDo.hx",lineNumber:4428,className:"bikas.game.GameDo",methodName:"spawnPrefabLink"}),null;if(!Vn.createObjectsBasedOnEntities(e,_,new t_(!0)))return null;ie.setSpaceIncludingChildren(_,e.world.space);var d=null,m=[];(d=function(e,t){if(null!=t.group)for(var n=0,i=t.group.entities;n<i.length;){var r=i[n];++n,d(e,r)}null!=t.bitmap_images&&e.push(t)})(m,_);for(var f=0;f<m.length;){var g=m[f];++f,null!=g.display.sprite&&null!=g.display.sprite.parent&&g.display.sprite.parent.removeChild(g.display.sprite),null!=g.group?Nl.trace("warning: can't add group here",{fileName:"GameDo.hx",lineNumber:4457,className:"bikas.game.GameDo",methodName:"spawnPrefabLink"}):Fa.insertNewObjectToLiveTree(t,n,g.display.sprite,!0)}return _},Vn.update=function(e,t){if((4!=e.config.release.sitelock_type||!ve.famobi_paused)&&!$s.paused&&(0==e.config.type&&Ii.isReleased(e.keyboard_keys_released,13)&&Ii.isPressed(e.keyboard_keys_pressed,17)&&Vn.hideGameAndOpenEditor(e),e.game_running)){e.pause_after_1_update&&(e.game_running=!1,e.pause_after_1_update=!1),(e.step=t).original_dc=t.delta/16.666666666666668,t.ui_dc=t.original_dc,t.dc=t.original_dc*e.temp_dc_coeff*e.delta_update_coeff_by_effect*e.debug_dc_coeff,e.temp_dc_coeff=1,t.dc<.1&&(t.dc=.1),t.step_size=.016666666666666666*t.dc,t.game_seconds+=t.step_size,Ma.getTimer(),$s.game,mn.step=t;var n=e.current_gameplay_music;if(null!=n){var i=!1;e.state==Gn.InLevel&&null!=e.player&&(e.current_level_save==e.credits_save&&(e.race_countdown.engine_sound_allowed=!1),e.player.behavior_activated&&(i=!0,e.current_level_save==e.credits_save&&(n=Gs.music_beach_waves))),i?Ms.isMusicPlaying(n)||Ms.fadeInMusic(n):Ms.isMusicPlaying(n)&&Ms.fadeOutMusic(n,.008333333333333333),Ms.updateMusic(n,e.music_enabled)}if(0!=e.config.type||e.config.development.transitions_enabled){if(!Vn.updateTransitions(e,t,e.js_info))return}else Vn.updateStageAndLibraryReload(e,t);if(null==e.partition_top&&null!=e.stage_group){var r=!0;if(!e.use_cached_terrain_polygons)for(var a=0,s=e.terrain_polygons;a<s.length;){var l=s[a];if(++a,null!=l.terrain&&!l.terrain.finished){Es.drawPortionOfTerrainRects(l.terrain,Un.terrain_draw_count)&&Es.finish(l.terrain,Un.texture_offset_add),r=!1;break}}if(!r)return;e.use_cached_terrain_polygons||Vn.createSpritesForTerrainPolygons(e.terrain_polygons),Vn.createTreePartition(e)}if(null!=e.stage_group){if(e.state==Gn.InLevel){var o=!0;e.level_type==Zn.InInterLevelMenu&&(e.inter_level_menu.state==yi.InRewardSelection&&(o=!1),null!=e.level_end&&e.level_end.state==xn.InAd&&(o=!1),null!=e.main_menu&&e.main_menu.in_ad&&(o=!1),null!=e.inter_level_menu&&e.inter_level_menu.in_ad&&(o=!1)),o&&Vn.isObjectClickedInRadius(e.pause_button,e.pointer,70)&&(Ms.playSound(Gs.sound_click,e.sounds_enabled),Vn.showPause(e,t))}if(e.state!=Gn.InPause){if(e.level_type==Zn.InRacing)Vn.updateTutorial(e);else if(e.level_type==Zn.InMainMenu){if(Ui.update(e.main_menu,e.game_save,e.background,e.background_camera_offset,e.menu_camera_position,e.camera,e.partition_top,e.entity_partition_container,e.all_body_entities,e.menu_container,e.js_info,e.pointer,e.step,e.sounds_enabled,e.music_enabled),e.main_menu.trigger_game_type!=Ri.None)if(e.main_menu.trigger_game_type==Ri.ResumeGame)Vn.gotoNewLevel(e,t,e.inter_level_menu_save);else if(e.main_menu.trigger_game_type==Ri.ContinueToFirstLevel)Vn.gotoNewLevel(e,t,e.first_level_save);else if(e.main_menu.trigger_game_type==Ri.LoadGame){if(null!=e.main_menu.game_save||(Nl.trace("warning: game.main_menu.game_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"update"}),0)){Vn.applyGameSave(e,e.main_menu.game_save);for(var _=null,p=0,u=e.game_save.level_saves;p<u.length;){var h=u[p];if(++p,h.description.name==e.game_save.current_level_name){_=h;break}}if(null==_&&(_=e.inter_level_menu_save),Vn.gotoNewLevel(e,t,_))return}}else if(e.main_menu.trigger_game_type==Ri.StartNewGame&&(e.game_save=Pr.createGameSave(e.level_descriptions),Vn.applyGameSave(e,e.game_save),Vn.gotoNewLevel(e,t,e.first_level_save)))return}else if(e.level_type==Zn.InInterLevelMenu&&(Vn.updateChallengesState(e.game_save,e.ongoing_powers_display,e.challenge_descs,e.notifications,t,e.inter_level_menu,e.camera),zi.update(e),e.inter_level_menu.trigger_game_save&&(e.inter_level_menu.trigger_game_save=!1,Vn.saveGameSaveToStorage(e.game_save_serial_data,e.game_save)),null!=e.inter_level_menu.level_map_next_level_save&&Vn.gotoNewLevel(e,t,e.inter_level_menu.level_map_next_level_save)))return;e.level_running&&null==e.tutorial_menu.container.parent&&Vn.updateLevel(e,t),Vn.updateDebugStuff(e,t)}else Vn.updatePause(e,e.pause_menu,e.pointer,t,e.js_info)}}},Vn.updateChallengesState=function(e,t,n,i,r,a,s){for(var l=0,o=0,_=e.level_saves;o<_.length;){var u=_[o];if(++o,u.description.type==wr.LevelRegular&&u.completed&&++l,u.description.type==wr.LevelChallenge&&u.completed)for(var h=0;h<n.length;){var c=n[h];if(++h,c.type==u.description.challenge_type){-1==e.challenges_completed.indexOf(c.id)&&e.challenges_completed.push(c.id);break}}}for(var d=0;d<n.length;){var m=n[d];++d,-1==e.challenges_unlocked.indexOf(m.id)&&(m.type==kr.ChallengeEscapeFromWolf?4<=l&&e.challenges_unlocked.push(m.id):m.type==kr.ChallengeMountainRush?8<=l&&e.challenges_unlocked.push(m.id):m.type==kr.ChallengeBalancing?12<=l&&e.challenges_unlocked.push(m.id):m.type==kr.ChallengeSurvival?16<=l&&e.challenges_unlocked.push(m.id):m.type==kr.ChallengeBulletTaxi?20<=l&&e.challenges_unlocked.push(m.id):m.type==kr.ChallengeHuntThePrey?24<=l&&e.challenges_unlocked.push(m.id):Nl.trace("warning: unhandled "+p.string(m.type),{fileName:"GameDo.hx",lineNumber:4852,className:"bikas.game.GameDo",methodName:"updateChallengesState"}))}if(e.challenges_unlocked.length!=e.challenges_unlocked_shown.length)for(var f=0,g=e.challenges_unlocked;f<g.length;){var v=g[f];if(++f,-1==e.challenges_unlocked_shown.indexOf(v)){for(var b=null,y=0;y<n.length;){var x=n[y];if(++y,x.id==v){b=x;break}}null==b&&(Nl.trace("warning: found_desc == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"updateChallengesState"}),!0)||Vn.pushNotification(i,b.name+" Unlocked!"),e.challenges_unlocked_shown.push(v)}}var z=!1;if(null!=a.nearest_place&&"map"==a.nearest_place.marker.name&&ma.distance(a.nearest_place.marker.position.x,a.nearest_place.marker.position.y,s.current_pos.get_x(),s.current_pos.get_y())<5&&(z=!0),z&&e.challenges_unlocked.length!=e.challenges_unlocked_shown_on_map.length)for(var w=0,k=e.challenges_unlocked;w<k.length;){var S=k[w];if(++w,-1==e.challenges_unlocked_shown_on_map.indexOf(S)){for(var C=null,N=0;N<n.length;){var P=n[N];if(++N,P.id==S){C=P;break}}if(null!=C||(Nl.trace("warning: found_desc == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"updateChallengesState"}),0)){for(var M=null,I=0,T=a.level_map.levels;I<T.length;){var A=T[I];if(++I,A.challenge_desc==C){M=A;break}}null==M&&(Nl.trace("warning: found_item == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"updateChallengesState"}),1)||(M.animate_in=!0,M.current_time=-di.animate_in_wait_time)}e.challenges_unlocked_shown_on_map.push(S)}}if(z&&e.challenges_completed.length!=e.challenges_completed_claimed.length)for(var D=0,E=e.challenges_completed;D<E.length;){var O=E[D];if(++D,-1==e.challenges_completed_claimed.indexOf(O)){for(var B=null,L=0;L<n.length;){var j=n[L];if(++L,j.id==O){B=j;break}}if(null!=B||(Nl.trace("warning: found_desc == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"updateChallengesState"}),0)){for(var F=null,R=0,G=a.level_map.levels;R<G.length;){var Z=G[R];if(++R,Z.challenge_desc==B){F=Z;break}}null==F&&(Nl.trace("warning: found_item == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"updateChallengesState"}),1)||(Vn.pushNotification(i,B.name+" Completed!"),Pr.applyRewardItem(e,t,B.item,i))}e.challenges_completed_claimed.push(O)}}},Vn.updateStageAndLibraryReload=function(e,t){if(null!=Un.load_stage_header){var n=Un.load_stage_header,i=Un.load_library_header;Un.load_stage_header=null,Un.load_library_header=null,Vn.loadEngineAndLevel(e,t,e.engine.engine_serial_data,n,i)}},Vn.updateTransitions=function(e,t,n){if(e.state==Gn.InTransitionToLevelLoad||e.state==Gn.InLevelLoad||e.state==Gn.InTransitionToLevel){var i=e.level_load_screen;i.background.x=-5,i.background.y=-5,i.background.width=n.current_game_width+10,i.background.height=n.current_game_height+10,i.middle_container.position.x=0,i.middle_container.position.y=0,i.title.position.x=n.current_game_width/2,i.title.position.y=n.current_game_height/2,i.loading_track_text.position.x=n.current_game_width/2,i.loading_track_text.position.y=n.current_game_height-60-Gs.track_loader_text.height,i.loader_background.position.x=n.current_game_width/2-Gs.track_loader_background.width/2,i.loader_foreground.position.x=n.current_game_width/2-Gs.track_loader_foreground.width/2,i.loader_background.position.y=n.current_game_height-60,i.loader_foreground.position.y=n.current_game_height-60}if(e.state==Gn.InTransitionToLevelLoad){if(!Vn.updateTransitionToLevelLoad(e,t))return!1}else if(e.state==Gn.InLevelLoad){if(!Vn.updateLevelLoad(e,t))return!1;e.level_load_screen.transition_current_time=0}else if(e.state==Gn.InTransitionToLevel&&!Vn.updateTransitionToLevel(e,t))return!1;return!0},Vn.updateTransitionToLevelLoad=function(e,t){var n=e.level_load_screen;null==n.container.parent&&(e.menu_container.add(n.container),n.transition_current_time=0,e.previous_state==Gn.InGameLoad?(n.container.alpha=1,n.middle_container.alpha=0,n.middle_container.alpha=1,n.transition_current_time=yn.transition_time):e.previous_state==Gn.InLevel?(n.container.alpha=0,n.middle_container.alpha=1):Nl.trace("warning: unhandled state: "+p.string(e.previous_state),{fileName:"GameDo.hx",lineNumber:5061,className:"bikas.game.GameDo",methodName:"updateTransitionToLevelLoad"}),n.loader_foreground.scale.x=.25),n.transition_current_time>yn.transition_time&&(n.transition_current_time=yn.transition_time,e.previous_state==Gn.InGameLoad?Vn.updateStageAndLibraryReload(e,t):e.previous_state==Gn.InLevel&&(null!=e.pause_menu.container.parent&&e.pause_menu.container.parent.removeChild(e.pause_menu.container),null==e.next_level_save||e.current_level_save==e.next_level_save?Vn.reloadLevel(e,t):Vn.loadNewLevel(e,t,e.next_level_save)),Vn.setGameState(e,Gn.InLevelLoad)),n.transition_current_time+=t.ui_dc;var i=va.linearClamped(0,1,n.transition_current_time/yn.transition_time);return e.previous_state==Gn.InGameLoad?n.middle_container.alpha=i:e.previous_state==Gn.InLevel&&(n.container.alpha=i),!1},Vn.updateLevelLoad=function(e,t){e.js_info;for(var n=!0,i=0,r=0,a=0,s=e.terrain_polygons;a<s.length;){var l=s[a];if(++a,null!=l.terrain&&!l.terrain.finished){Es.drawPortionOfTerrainRects(l.terrain,Un.terrain_draw_count)&&Es.finish(l.terrain,Un.texture_offset_add),n=!1;break}}for(var o=0,_=e.terrain_polygons;o<_.length;){var p=_[o];++o,null!=p.terrain&&(i+=Es.getCutCount(p.terrain),r+=p.terrain.current_drawn_rect_count)}var u=!0;if(e.pre_simulate_world_steps_current<Un.pre_simulate_world_steps){var h=!1;if(u=0==e.config.type&&!e.config.development.loader_enabled&&(h=!0),h){for(var c=0,d=e.pre_simulate_world_steps_current;c<d;)c++,e.world.space.step(.016666666666666666,10,10);e.pre_simulate_world_steps_current=Un.pre_simulate_world_steps}else if(n)if(e.js_info.desktop)for(var m=0;m<4;)m++,e.pre_simulate_world_steps_current++,e.world.space.step(.016666666666666666,10,10);else e.pre_simulate_world_steps_current++,e.world.space.step(.016666666666666666,10,10)}var f=!0;if(e.pre_wait_steps_current<Un.pre_wait_steps&&(f=!1,u&&e.pre_wait_steps_current++,f=0==e.config.type&&!e.config.development.loader_enabled&&(e.pre_wait_steps_current=Un.pre_wait_steps,!0)),n&&u&&f){if(null==e.partition_top)return Ma.getTimer(),e.use_cached_terrain_polygons||Vn.createSpritesForTerrainPolygons(e.terrain_polygons),Vn.createTreePartition(e),Vn.updateLevel(e,t),Vn.setGameState(e,Gn.InTransitionToLevel),e.pre_simulate_world_steps_current=0,!(e.pre_wait_steps_current=0)}else{var g=4,v=1,b=1,y=2+g+v+b;0<i&&(g*=ma.clamp0to1(r/i)),0<Un.pre_simulate_world_steps&&(v*=ma.clamp0to1(e.pre_simulate_world_steps_current/Un.pre_simulate_world_steps)),0<Un.pre_wait_steps&&(b*=ma.clamp0to1(e.pre_wait_steps_current/Un.pre_wait_steps));var x=(2+g+v+b)/y,z=e.level_load_screen;z.loader_foreground.scale.x=x,z.transition_current_time=0}return!1},Vn.updateTransitionToLevel=function(e,t){var n=e.level_load_screen;n.transition_current_time+=t.ui_dc,n.transition_current_time>yn.transition_time&&(n.transition_current_time=yn.transition_time,null!=n.container.parent&&n.container.parent.removeChild(n.container),Vn.setGameState(e,Gn.InLevel));var i=n.transition_current_time/yn.transition_time;return n.container.alpha=1-i,!1},Vn.updatePause=function(e,t,n,i,r){if(t.background.x=-5,t.background.y=-5,t.background.width=r.current_game_width+10,t.background.height=r.current_game_height+10,e.level_type==Zn.InMainMenu?(t.button_main_menu.visible=!1,t.button_restart.visible=!1,t.button_play.visible=!0,t.button_play.x=r.current_game_width/2,t.button_play.y=r.current_game_height/2):e.level_type==Zn.InInterLevelMenu?(t.button_main_menu.visible=!0,t.button_restart.visible=!1,t.button_play.visible=!0,t.button_main_menu.x=r.current_game_width/2-78.75,t.button_main_menu.y=r.current_game_height/2,t.button_play.x=r.current_game_width/2+78.75,t.button_play.y=r.current_game_height/2):e.level_type==Zn.InRacing&&(t.button_main_menu.visible=!0,t.button_restart.visible=!0,t.button_play.visible=!0,t.button_main_menu.x=r.current_game_width/2-157.5,t.button_main_menu.y=r.current_game_height/2,t.button_restart.x=r.current_game_width/2,t.button_restart.y=r.current_game_height/2,t.button_play.x=r.current_game_width/2+157.5,t.button_play.y=r.current_game_height/2),t.button_garage.visible=!1,t.button_music.x=r.current_game_width-90*2.7,t.button_music.y=90,t.button_sounds.x=r.current_game_width-90,t.button_sounds.y=90,null==t.container.parent)e.menu_container.add(t.container);else{if(null!=t.confirm_card){t.confirm_card.container.x=e.js_info.current_game_width/2-t.confirm_card.container.width/2,t.confirm_card.container.y=e.js_info.current_game_height/2-t.confirm_card.container.height/2;var a=zi.processCardClick(n,e.sounds_enabled,t.confirm_card.container,t.confirm_card.button_close,t.confirm_card.button_main);return void(a==gi.DownedCloseButton||a==gi.DownedOutside?(zi.destroyConfirmationCard(t.confirm_card),t.confirm_card=null):a==gi.DownedMainButton&&(zi.destroyConfirmationCard(t.confirm_card),t.confirm_card=null,t.confirm_type==Bn.GotoMainMenu?Vn.gotoNewLevel(e,i,e.main_menu_save):t.confirm_type==Bn.GotoGarage?Vn.gotoNewLevel(e,i,e.inter_level_menu_save):Nl.trace("warning: unhandled type "+p.string(t.confirm_type),{fileName:"GameDo.hx",lineNumber:5348,className:"bikas.game.GameDo",methodName:"updatePause"}),Ms.playSound(Gs.sound_click,e.sounds_enabled)))}if(Vn.isObjectClickedInRadius(e.pause_button,n,70)){for(var s=0,l=n.pointer_objects;s<l.length;){var o=l[s];++s,o.cancel_upped_and_clicked=!0}e.menu_container.remove(t.container),Vn.setGameState(e,Gn.InLevel),1==e.config.type&&3==e.config.release.sitelock_type&&e.level_type==Zn.InRacing&&es.PokiSDK.gameplayStart(),Ms.playSound(Gs.sound_click,e.sounds_enabled)}else if(Vn.isObjectDownedInRadius(t.button_play,n,80)&&t.button_play.visible){for(var _=0,u=n.pointer_objects;_<u.length;){var h=u[_];++_,h.cancel_upped_and_clicked=!0}e.menu_container.remove(t.container),Vn.setGameState(e,Gn.InLevel),1==e.config.type&&3==e.config.release.sitelock_type&&e.level_type==Zn.InRacing&&es.PokiSDK.gameplayStart(),Ms.playSound(Gs.sound_click,e.sounds_enabled)}else if(Vn.isObjectDownedInRadius(t.button_restart,n,80)&&t.button_restart.visible){for(var c=0,d=n.pointer_objects;c<d.length;){var m=d[c];++c,m.cancel_upped_and_clicked=!0}4==e.config.release.sitelock_type&&null!=e.current_level_save&&ve.trackRestart(e.current_level_save.description_name),0!=e.config.type||e.config.development.transitions_enabled?(e.next_level_save=e.current_level_save,Vn.setGameState(e,Gn.InLevel),Vn.setGameState(e,Gn.InTransitionToLevelLoad)):(e.menu_container.remove(t.container),Vn.setGameState(e,Gn.InLevel),Vn.reloadLevel(e,i)),Ms.playSound(Gs.sound_click,e.sounds_enabled)}else if(Vn.isObjectDownedInRadius(t.button_main_menu,n,80)&&t.button_main_menu.visible){var f="";e.current_level_save.description.type==wr.LevelRegular?f="Quit Level and\ngo to Main Menu?":e.current_level_save.description.type==wr.LevelChallenge?f="Quit Challenge and\ngo to Main Menu?":e.current_level_save.description.type==wr.LevelInterLevelMenu?f="Go to Main Menu?":e.current_level_save.description.type==wr.LevelMainMenu?f="":Nl.trace("warning: unhandled "+p.string(e.current_level_save.description.type),{fileName:"GameDo.hx",lineNumber:5436,className:"bikas.game.GameDo",methodName:"updatePause"}),""!=f?(t.confirm_card=zi.createConfirmationCard("button_go",f),e.menu_container.add(t.confirm_card.container),t.confirm_type=Bn.GotoMainMenu):e.current_level_save==e.main_menu_save?Vn.gotoRestartLevel(e,i):(Nl.trace("warning: game.current_level_save != game.main_menu_save",{fileName:"GameDo.hx",lineNumber:5446,className:"bikas.game.GameDo",methodName:"updatePause"}),Vn.gotoNewLevel(e,i,e.main_menu_save)),Ms.playSound(Gs.sound_click,e.sounds_enabled)}else Vn.isObjectDownedInRadius(t.button_garage,n,80)&&t.button_garage.visible||(Vn.isObjectDownedInRadius(t.button_music,n,80)?(e.music_enabled=!e.music_enabled,e.music_enabled?t.button_music.setTexture(Gs.button_music_on):t.button_music.setTexture(Gs.button_music_off),4==e.config.release.sitelock_type&&ve.trackVolumeEvent(e.music_enabled,e.sounds_enabled)):Vn.isObjectDownedInRadius(t.button_sounds,n,80)&&(e.sounds_enabled=!e.sounds_enabled,e.sounds_enabled?t.button_sounds.setTexture(Gs.button_sounds_on):t.button_sounds.setTexture(Gs.button_sounds_off),4==e.config.release.sitelock_type&&ve.trackVolumeEvent(e.music_enabled,e.sounds_enabled)));for(var g=0,v=t.pause_debug_options;g<v.length;){var b=v[g];if(++g,Vn.isBitmapTextDownedInBounds(b.bitmap_text,n,10)){b.callback(b);break}}null!=t.confirm_card&&(t.confirm_card.container.x=r.current_game_width/2-t.confirm_card.container.width/2,t.confirm_card.container.y=r.current_game_height/2-t.confirm_card.container.height/2)}},Vn.updateLevel=function(e,t){var n=e.js_info,i=e.pointer,r=t.dc;t.level_seconds+=t.step_size,e.race_seconds=t.level_seconds-e.race_start_at_second,De.update(t);var a=1==e.config.type||0==e.config.type&&e.config.development.bots_enabled;if(e.config.control_type==Fs.ControlSlowRotateButtonsSide&&null!=e.player&&null!=e.player.mobile_controls?(e.ability_item_container.x=n.current_game_width-105,e.ability_item_container.y=n.current_game_height-210-60):(e.ability_item_container.x=n.current_game_width-106,e.ability_item_container.y=n.current_game_height-400),null!=e.wheel&&null!=e.player&&Jr.update(e.wheel,n,e.player.car,e.player.config,e.player.cache,i,t,e.keyboard_keys_pressed,e.player.behavior_activated,e.player.finished_race),Vn.updateCarBaggage(e.all_cars,r),null!=e.player){if(hr.update(e.player,e.all_cars,t,n,i,e.config,e.keyboard_keys_pressed,e.race_countdown.engine_sound_allowed,e.use_bot_to_control_player,e.sounds_enabled),a)for(var s=0,l=e.bots;s<l.length;){var o=l[s];++s,yt.update(o,e.player,e.all_cars,e.config,e.jump_over_bodies,e.pickable_items,t,e.partition_top,e.entity_partition_container,e.world.space,e.explosives,e.sounds_enabled)}e.use_bot_to_control_player&&yt.update(e.player_bot,e.player,e.all_cars,e.config,e.jump_over_bodies,e.pickable_items,t,e.partition_top,e.entity_partition_container,e.world.space,e.explosives,e.sounds_enabled)}if(null!=e.player&&Vn.updateExplosives(e),null!=e.player){for(var _=0,u=e.boxes;_<u.length;){var h=u[_];++_,$i.updateBox(h,e.partition_top,e.all_body_entities,e.camera_shake,e.player.car,e.all_cars,e.world.space,t,e.config,e.sounds_enabled)}for(var c=!1,d=0,m=e.forward_ramps;d<m.length;){var f=m[d];++d,$i.updateForwardRamp(f,r,e.player,e.all_cars)&&(c=!0)}c?Ms.isMusicPlaying(Gs.sound_loop_acceleration_boost)||Ms.fadeInMusic(Gs.sound_loop_acceleration_boost,.1):Ms.isMusicPlaying(Gs.sound_loop_acceleration_boost)&&Ms.fadeOutMusic(Gs.sound_loop_acceleration_boost,.03333333333333333),Ms.updateMusic(Gs.sound_loop_acceleration_boost,e.sounds_enabled);for(var g=0,v=e.temp_interactive_objects;g<v.length;){var b=v[g];++g,$i.updateTempInteractiveObject(b,e.all_body_entities,e.partition_top,e.entity_partition_container,e.player.car,e.explosives,t,e.config)}for(var y=0,x=e.pickable_items;y<x.length;){var z=x[y];++y,Mi.updatePickableItem(z,e,e.world.space,t.dc,t.level_seconds,e.sounds_enabled)}ze.updateAbilityItem(e.player,i,e.js_info,e.partition_top,e.entity_partition_container,e.world.space,e.explosives,r,e.sounds_enabled)}for(var w=0,k=e.attachments;w<k.length;){var S=k[w];++w,je.update(S,t.step_size,t.dc)}null!=e.stunt&&null!=e.player&&Hr.update(n.current_game_width,n.current_game_height,e.coin_display.coin.position.y,t,e.stunt,e.player.car,e.player.config,e.player.cache,e.current_level_save.description.max_stunt_score,e.player.finished_race,e.coin_display.digit_count,e.sounds_enabled),null!=e.game_save.ongoing_powers&&Vr.updateOngoingPowersDisplay(e.ongoing_powers_container,e.ongoing_powers_display,e.camera_shake,n,i,e.step,e.coin_display.coin.position.x,e.coin_display.coin.position.y,e.sounds_enabled),Vn.updateAchievements(e,t),Vn.updateNotifications(e,n,t,e.notifications,e.sounds_enabled);for(var C=0;C<e.chickens.length;){var N=e.chickens[C];150<N.body.get_velocity().get_length()&&(e.looped_animations.push(N.anim),e.chickens.splice(C,1),--C),++C}for(var P=0,M=e.looped_animations;P<M.length;){var I=M[P];++P,A.nextFrameStep(I,r)}if(e.physics_running){Vn.updatePhysics(e.world.space,r);for(var T=0,D=e.all_cars;T<D.length;){var E=D[T];++T,Ot.update(E)}}for(var O=0,B=e.all_body_entities;O<B.length;){var L=B[O];++O,ce.refresh(L)}for(var j=0,F=e.connected_containers;j<F.length;){var R=F[j];++j,Jt.updateConnectedContainers(R)}if(null!=e.player){if(a)for(var G=0,Z=e.bots;G<Z.length;){var U=Z[G];++G,Ae.updateConstantPowerAbilities(e.partition_top,e.entity_partition_container,U.abilities,U.car,U.config,U.cache,e.all_cars,t)}if(e.use_bot_to_control_player){var V=e.player_bot;null!=V&&Ae.updateConstantPowerAbilities(e.partition_top,e.entity_partition_container,V.abilities,V.car,V.config,V.cache,e.all_cars,t)}else{var q=e.player;Ae.updateConstantPowerAbilities(e.partition_top,e.entity_partition_container,q.abilities,q.car,q.config,q.cache,e.all_cars,t),q.abilities.nitro_power.activated?Ms.isMusicPlaying(Gs.sound_loop_nitro_use)||Ms.fadeInMusic(Gs.sound_loop_nitro_use,.1):Ms.isMusicPlaying(Gs.sound_loop_nitro_use)&&Ms.fadeOutMusic(Gs.sound_loop_nitro_use,.2),Ms.updateMusic(Gs.sound_loop_nitro_use,e.sounds_enabled)}}if(e.all_cars.sort(Vn.sortCarsByPosition),null!=e.player&&!Vn.updateChallenges(e,n,t))return!1;if(null!=e.player){if(Vn.updateLevelEnd(e,t,e.sounds_enabled),e.level_end.state==xn.InAd)return!1;if(e.level_end.state==xn.InNext){if(e.level_end.next_state==zn.NextInterLevelMenu){if(Vn.saveGameSaveToStorage(e.game_save_serial_data,e.game_save),Vn.gotoNewLevel(e,t,e.inter_level_menu_save))return!1}else if(e.level_end.next_state==zn.NextRestartLevel){if(Vn.gotoRestartLevel(e,t))return!1}else if(e.level_end.next_state==zn.NextCreditsLevel){if(e.level_end.next_state=zn.NextInterLevelMenu,e.game_save.credits_shown=!0,Vn.saveGameSaveToStorage(e.game_save_serial_data,e.game_save),Vn.gotoNewLevel(e,t,e.credits_save))return!1}else e.level_end.next_state!=zn.None&&Nl.trace("warning: unhandled state "+p.string(e.level_end.next_state),{fileName:"GameDo.hx",lineNumber:5870,className:"bikas.game.GameDo",methodName:"updateLevel"});e.level_end.next_state=zn.None}}return Vn.updateCamera(e,t),Vn.updateGameVisibleBounds(e),Vn.updatePolygonDraw(e),null!=e.race_countdown&&(e.race_countdown.finished||Vn.updateCountdownAnimation(e,t,e.sounds_enabled)),null!=e.current_place&&Vn.updateCurrentPlace(e),Vn.updateBackground(e,r),null!=e.partition_top&&Fa.update(e.partition_top,e.visible_bounds),null!=e.player&&null!=e.partition_top&&null!=e.entity_partition_container&&e.player.behavior_activated&&Vn.updateCarModifiers(e,e.partition_top,e.entity_partition_container),null!=e.slow_down_time&&Vn.updateSlowDownEffect(e,t),null!=e.coin_display&&Vn.updateCoinDisplay(t,e.js_info,e.coin_display,e.game_save,e.collected_in_level),!0},Vn.updateExplosives=function(e){for(var t=0,n=null;t<e.explosives.length;){var i=e.explosives[t];if(Ae.updateExplosive(i,e.partition_top,e.step),0<i.explosion_events_buffer.length){null==n&&(n=[]);for(var r=0,a=i.explosion_events_buffer;r<a.length;){var s=a[r];++r,n.push(s)}i.explosion_events_buffer=[]}i.state==Pe.ExplosionExploded?(Vn.applyCameraShake(e.camera_shake,10,40,e.player.car,i.cbody.body.get_position()),Wn.playSoundInGameLevel(Gs.sound_explosion,e.sounds_enabled,i.cbody.body.get_position(),e.player.car,1600,1)):i.state==Pe.Done&&(Ae.destroyExplosive(i,e.partition_top),e.explosives.splice(t,1),--t),++t}if(null!=n)for(var l=0;l<n.length;){var o=n[l];++l,Vn.updateExplosionEvent(o,e.player,e.bots,e.ongoing_powers_display)}},Vn.updatePhysics=function(e,t){var n=Ma.getTimer();mn.total_space_steps=0,t*=Un.physics_dc_coeff,e.step(.016666666666666666*t,Un.physics_velocity_iterations,Un.physics_position_iterations),mn.physics_update_time=Math.round(10*(Ma.getTimer()-n))/10},Vn.updateChallenges=function(e,t,n){var i=n,r=t;if(Xt.updateChallengesCommonStuff(e.challenges,i),null!=e.challenges.escape_from_wolf)Xt.updateEscapeFromWolfChallenge(e.challenges.escape_from_wolf,i,e.stage_group,e.level_end,e.player,e.challenges.current_explosion_animations,e.player_bot,e.sounds_enabled);else if(null!=e.challenges.mountain_rush)Xt.updateMountainRushChallenge(e.challenges.mountain_rush,r,i,e.stunt,e.ingame_container,e.level_end,e.player,e.player_bot,e.race_countdown.finished);else if(null!=e.challenges.survival)Xt.updateSurvivalChallenge(e.challenges.survival,r,i,e.stage_group,e.ingame_container,e.level_end,e.player,e.player_bot,e.race_countdown.finished,e.challenges.current_explosion_animations,e.sounds_enabled);else if(null!=e.challenges.balancing)Xt.updateBalancingChallenge(e.challenges.balancing,r,i,e.stage_group,e.ingame_container,e.level_end,e.player,e.player_bot);else if(null!=e.challenges.bullet_taxi)Xt.updateBulletTaxiChallenge(e.challenges.bullet_taxi,r,i,e.stage_group,e.ingame_container,e.level_end,e.player,e.player_bot);else if(null!=e.challenges.achievement)Xt.updateAchievementChallenge(e.challenges.achievement,r,i,e.stage_group,e.ingame_container,e.level_end,e.player,e.player_bot);else if(null!=e.challenges.credits)return Xt.updateCreditsChallenge(e.challenges.credits,e,r,i,e.stage_group,e.ingame_container,e.level_end,e.player,e.player_bot);return!0},Vn.updateCoinDisplay=function(e,t,n,i,r){n.coin.position.x=t.current_game_width-n.coin.texture.width/2-20,n.text.position.x=n.coin.position.x-25;var a=i.coins;if(null!=r&&(a+=r.coins),n.displayed_amount!=a&&(n.current_anim_time>=Nn.anim_time&&(n.current_anim_time=0),n.displayed_amount=a,n.text.text=n.displayed_amount+"",n.digit_count=n.text.text.length),n.current_anim_time<Nn.anim_time){n.current_anim_time+=e.step_size;var s=ma.clamp0to1(n.current_anim_time/Nn.anim_time),l=va.smoothForwardAndBackward(1,Nn.anim_scale,s);n.coin.scale.x=l,n.coin.scale.y=l,n.text.scale.x=l,n.text.scale.y=l}},Vn.updateExplosionEvent=function(e,t,n,i){var r=e.space.bodiesInCircle(e.explosion_center,e.explosion_radius,e.body_containment),a=1;if(a+=e.power_add_coeff,e.source_car==t.car)for(var l=0,o=i.current_items;l<o.length;){var _=o[l];++l,_.desc.type==Mr.ConstantBombAndDynamitePower&&(a+=_.generated_amounts[0]/100,i.just_used_items.push(_))}for(var p=i.current_items.slice(),u=r.iterator();u.hasNext();){var h=u.next();if(!h.isStatic()){var c=1;if(-1!=t.car.all_bodies.indexOf(h)){c-=t.config.armor_coeff,t.abilities.shield_power.activated&&(c=0);for(var d=0;d<p.length;){var m=p[d];++d;var f=m.desc.type;f==Mr.ConstantAllExplosivesImmunity||f==Mr.OneTimeAllExplosivesImmunity?(c-=m.generated_amounts[0]/100,f==Mr.OneTimeAllExplosivesImmunity?s.remove(i.current_items,m):i.just_used_items.push(m)):f==Mr.ConstantExplosiveBarrelImmunity||f==Mr.OneTimeExplosiveBarrelImmunity?e.type==Ne.Barrel&&(c-=m.generated_amounts[0]/100,f==Mr.OneTimeExplosiveBarrelImmunity?s.remove(i.current_items,m):i.just_used_items.push(m)):f!=Mr.ConstantBombAndDynamiteImmunity&&f!=Mr.OneTimeBombAndDynamiteImmunity||e.type!=Ne.Bomb&&e.type!=Ne.Dynamite||(c-=m.generated_amounts[0]/100,f==Mr.OneTimeBombAndDynamiteImmunity?s.remove(i.current_items,m):i.just_used_items.push(m))}}else for(var g=0;g<n.length;){var v=n[g];++g,-1!=v.car.all_bodies.indexOf(h)&&(c-=v.config.armor_coeff,v.abilities.shield_power.activated&&(c=0))}var b=a*(c=ma.clamp0to1(c));if(!(b<=0)){var y=h.get_position().sub(e.explosion_center),x=y.get_length();y.dispose();var z=ma.clamp0to1(1-x/(2*e.explosion_radius)),w=va.getTClamped(0,1,b),k=va.linear(1,e.one_time_velocity_friction,w*z);k<0&&1<k&&(Nl.trace("warning: friction can't be: "+k,{fileName:"GameDo.hx",lineNumber:6260,className:"bikas.game.GameDo",methodName:"updateExplosionEvent"}),k=ma.clamp0to1(k)),h.get_velocity().muleq(k);var S=va.linear(e.min_impulse,e.max_impulse,z),C=y_.get(0,-S*h.get_mass());C.muleq(b),h.applyImpulse(C);var N=va.linear(2,10,z)*h.get_inertia(),P=ma.getRandomSign();N*=b,h.applyAngularImpulse(N*P),h.isStatic()&&(h.get_userData().just_applied_impulse_length=C.get_length()),h.get_userData().just_exploded=!0,h.get_userData().last_explosion_t=z,h.get_userData().last_final_explosion_modifier=b,C.dispose()}}}},Vn.updateCarBaggage=function(e,t){for(var n=0;n<e.length;){var i=e[n];++n;for(var r=0,a=i.baggages;r<a.length;){var s=a[r];if(++r,s.interactive)if(s.timeout)s.current_time-=t,s.current_time<=0&&(s.interactive=!1,s.body.setShapeFilters(Si.only_to_ground));else{var l=ma.distance(i.main_body_position_x,i.main_body_position_y,s.body.get_position().get_x(),s.body.get_position().get_y());50<Math.abs(s.initial_distance_from_main_body-l)&&(s.timeout=!0)}}}},Vn.updateCountdownAnimation=function(e,t,n){var i=t.dc,r=e.race_countdown;if(null!=r.challenge_text&&(null==r.challenge_text.parent&&e.ingame_container.add(r.challenge_text),r.challenge_text.position.x=e.js_info.current_game_width/2,r.challenge_text.position.y=.4*e.js_info.current_game_height),r.container.x=e.js_info.current_game_width/2,r.container.y=.2*e.js_info.current_game_height,r.current_time<=0)if(r.current_time=Cn.time_per_count+Cn.time_per_wait,5==r.current_number)e.camera.additional_offset.set_y(Cn.camera_additional_offset),e.ingame_container.add(r.container),A.gotoFrame(r.animation,0),r.current_number=4,Ms.playSound(Gs.sound_countdown_number,n);else if(4==r.current_number)A.gotoFrame(r.animation,1),r.current_number=3,r.engine_sound_allowed=!0,Ms.playSound(Gs.sound_countdown_number,n);else if(3==r.current_number)A.gotoFrame(r.animation,2),r.current_number=2,Ms.playSound(Gs.sound_countdown_number,n);else if(2==r.current_number)Vn.startRace(e,t),A.gotoFrame(r.animation,3),r.current_number=1,Ms.playSound(Gs.sound_countdown_go,n);else if(1==r.current_number)r.engine_sound_allowed=!0,r.current_number=0;else if(0==r.current_number)return r.engine_sound_allowed=!0,e.ingame_container.remove(r.container),null!=r.challenge_text&&(Vn.safeRemove(r.challenge_text),r.challenge_text.destroy(!0),r.challenge_text=null),void(r.finished=!0);if(r.current_number<=5&&1<=r.current_number){var a=1-(r.current_time-Cn.time_per_wait)/Cn.time_per_count;1<a&&(a=1);var s=va.smoothStart(2.3,1,a),l=va.smoothStart(0,1,a);r.container.scale.x=s,r.container.scale.y=s,r.container.alpha=l;var o=e.camera.additional_offset;o.set_y(o.get_y()+Cn.camera_additional_offset_step*i),0<e.camera.additional_offset.get_y()&&e.camera.additional_offset.set_y(0),e.camera.additional_offset.set_y(0)}else if(0==r.current_number){e.camera.additional_offset.set_y(0);var _=1-(r.current_time-Cn.time_per_wait)/Cn.time_per_count;1<_&&(_=1),e.camera.additional_offset.set_y(0);var p=va.smoothStart(1,0,_);r.container.alpha=p}r.current_time-=i},Vn.updateCurrentPlace=function(e){var t=e.current_place.player_position;if(t.x=e.player.car.main_body_position_x,t.y=e.player.car.main_body_position_y,qa.toGlobal(e.stage_group.group.container,t),qa.toLocal(e.ingame_container,t),e.current_place.container.x=t.x,e.current_place.container.y=t.y+e.player.car.distance_from_main_body_to_top_y-78,!e.player.finished_race){var n=e.all_cars.length-e.all_cars.indexOf(e.player.car);if(e.current_place.place_number!=n){var i=(e.current_place.place_number=n)-1;A.gotoFrame(e.current_place.anim,i)}}},Vn.updateTutorial=function(e){var t=e.tutorial_menu,n=e.js_info.desktop;if(0==e.config.type&&e.config.development.test_famobi_mobile_controls&&(n=!1),t.state==Fn.TutorialNone&&null!=t.controls_marker&&null!=t.jump_marker&&null!=e.player&&"level_1"==e.game_save.current_level_name&&(t.state==Fn.TutorialNone&&(e.game_save.tutorial_shown_controls||e.player.car.main_body.get_position().get_x()>t.controls_marker.position.x&&(Vn.setTutorial(e,Fn.TutorialControls),e.game_save.tutorial_shown_controls=!0)),t.state==Fn.TutorialNone&&(e.game_save.tutorial_shown_jump||e.player.car.main_body.get_position().get_x()>t.jump_marker.position.x&&Ae.isAbleToJump(e.player.cache)&&Ae.isAllowedToJump(e.player.abilities.jump_power,e.step.level_seconds)&&(Vn.setTutorial(e,Fn.TutorialJump),e.game_save.tutorial_shown_jump=!0)),t.state==Fn.TutorialNone&&(e.game_save.tutorial_shown_nitro||0<e.player.abilities.nitro_power_charge&&(Vn.setTutorial(e,Fn.TutorialNitro),e.game_save.tutorial_shown_nitro=!0)),t.state==Fn.TutorialNone&&(e.game_save.tutorial_shown_power||e.player.abilities.current_ability!=ye.None&&e.player.ability_button.state==be.ButtonMode&&(Vn.setTutorial(e,Fn.TutorialPower),e.game_save.tutorial_shown_power=!0))),null!=t.container.parent)if(t.background.width=e.js_info.current_game_width,t.background.height=e.js_info.current_game_height,t.state!=Fn.TutorialPhaseOut){if(t.phase_in_current_time+=e.step.step_size,t.container.alpha=va.linearClamped(0,1,t.phase_in_current_time/Rn.phase_in_time),t.state==Fn.TutorialControls)if(n){if(t.keyboard_controls.position.x=e.js_info.current_game_width/2,t.keyboard_controls.position.y=e.js_info.current_game_height/2,$a.isAnyDowned(e.pointer))return void Vn.setTutorial(e,Fn.TutorialPhaseOut);if(Ii.isAnyPressed(e.keyboard_keys_pressed,[65,68,37,39]))return void Vn.setTutorial(e,Fn.TutorialPhaseOut)}else if(null!=e.wheel){if(Jr.update(e.wheel,e.js_info,e.player.car,e.player.config,e.player.cache,e.pointer,e.step,e.keyboard_keys_pressed,e.player.behavior_activated,e.player.finished_race),null!=e.wheel.downed)return void Vn.setTutorial(e,Fn.TutorialNone);Vn.mirrorTransform(t.wheel,e.wheel.sprite),t.wheel_anim_current_time+=e.step.step_size;var i=ma.clamp0to1(t.wheel_anim_current_time/Rn.wheel_anim_time);t.wheel_angle=va.smoothForwardAndBackward(Rn.wheel_anim_angle_start,Rn.wheel_anim_angle_end,i),t.wheel_angle*=.017453292519943,1==i&&(t.wheel_anim_current_time=0);var r=t.wheel.width/2;t.wheel.rotation=t.wheel_angle,t.finger.position.x=t.wheel.x+Math.cos(t.wheel_angle)*r,t.finger.position.y=t.wheel.y+Math.sin(t.wheel_angle)*r,t.text.position.x=t.wheel.x-t.text.width,t.text.position.y=t.wheel.y-t.wheel.height/2-t.text.height-20}else{if(Vn.mirrorTransform(t.mobile_clockwise_button,e.player.mobile_controls.clockwise.container),Vn.mirrorTransform(t.mobile_anti_clockwise_button,e.player.mobile_controls.anti_clockwise.container),e.config.control_type==Fs.ControlSlowRotateButtonsSide?(t.text.position.x=e.js_info.current_game_width/2-t.text.width/2,t.text.position.y=t.mobile_clockwise_button.y-t.text.height-105):(t.text.position.x=t.mobile_clockwise_button.x-t.mobile_clockwise_button.width/2-t.text.width-50,t.text.position.y=t.mobile_clockwise_button.y-t.text.height/2),Vn.animateTutorialCircle(e,t,t.white_circle,t.mobile_clockwise_button),t.current_time-=e.step.step_size,Vn.animateTutorialCircle(e,t,t.white_circle2,t.mobile_anti_clockwise_button),$a.isDowned(t.mobile_clockwise_button.x,t.mobile_clockwise_button.y,e.pointer,_r.radius)||$a.isDowned(t.mobile_anti_clockwise_button.x,t.mobile_anti_clockwise_button.y,e.pointer,_r.radius))return void Vn.setTutorial(e,Fn.TutorialNone);if(Ii.isAnyPressed(e.keyboard_keys_pressed,rr.keys_jump))return void Vn.setTutorial(e,Fn.TutorialNone)}else if(t.state==Fn.TutorialJump){if(Vn.mirrorTransform(t.jump_button,e.player.jump_button.container),t.text.position.x=t.jump_button.position.x-t.jump_button.width/2,t.text.position.y=t.jump_button.position.y-150,Vn.animateTutorialCircle(e,t,t.white_circle,t.jump_button),$a.isDowned(e.player.jump_button.container.x,e.player.jump_button.container.y,e.pointer,sr.radius))return void Vn.setTutorial(e,Fn.TutorialNone);if(Ii.isAnyPressed(e.keyboard_keys_pressed,rr.keys_jump))return void Vn.setTutorial(e,Fn.TutorialNone)}else if(t.state==Fn.TutorialNitro){if(Vn.mirrorTransform(t.nitro_button,e.player.nitro_button.container),t.text.position.x=t.nitro_button.position.x-t.nitro_button.width/2,t.text.position.y=t.nitro_button.position.y-150,Vn.animateTutorialCircle(e,t,t.white_circle,t.nitro_button),$a.isDowned(e.player.nitro_button.container.x,e.player.nitro_button.container.y,e.pointer,or.radius))return void Vn.setTutorial(e,Fn.TutorialNone);if(Ii.isAnyPressed(e.keyboard_keys_pressed,rr.keys_nitro))return void Vn.setTutorial(e,Fn.TutorialNone)}else if(t.state==Fn.TutorialPower){if(t.power_button.texture!=e.player.ability_button.icon.sprite.texture&&t.power_button.setTexture(e.player.ability_button.icon.sprite.texture),Vn.mirrorTransform(t.power_button,e.player.ability_button.container),t.power_button.position.x=e.player.ability_button.parent_cache_x,t.power_button.position.y=e.player.ability_button.parent_cache_y,t.text.position.x=t.power_button.position.x-t.power_button.width/2-t.text.width-50,t.text.position.y=t.power_button.position.y-t.text.height/2,Vn.animateTutorialCircle(e,t,t.white_circle,t.power_button),$a.isDowned(t.power_button.position.x,t.power_button.position.y,e.pointer,e.player.ability_button.radius))return void Vn.setTutorial(e,Fn.TutorialNone);if(Ii.isAnyPressed(e.keyboard_keys_pressed,rr.keys_power))return void Vn.setTutorial(e,Fn.TutorialNone)}}else{t.current_time+=e.step.step_size;var a=va.linearClamped(1,0,t.current_time/Rn.phase_out_time);0==(t.container.alpha=a)&&Vn.setTutorial(e,Fn.TutorialNone)}},Vn.updateCarModifiers=function(e,t,n){if(0<e.all_cars.length&&null!=e.player){for(var i=e.all_cars[e.all_cars.length-1],r=0,a=e.bots;r<a.length;){var l=a[r];++r;var o=Vn.calculateSpeedIncreaseBasedOnDistance(i,l.car,500,3e3,0,.1);l.config.drive_velocity_max_additional=l.config.drive_velocity_max*o}var _=Vn.calculateSpeedIncreaseBasedOnDistance(i,e.player.car,500,3e3,0,.1);e.player.config.drive_velocity_max_additional=e.player.config.drive_velocity_max*_;var p=1,u=1,h=1,c=1;if(null!=e.game_save.ongoing_powers){for(var d=null,m=0,f=e.ongoing_powers_display.current_items;m<f.length;){var g=f[m];++m;var v=g.desc.type;if(v==Mr.ConstantFasterAcceleration)p+=g.generated_amounts[0]/100;else if(v==Mr.ConstantMoreBoost)u+=g.generated_amounts[0]/100,h+=g.generated_amounts[0]/100;else if(v==Mr.ConstantHandling)c+=g.generated_amounts[0]/100;else if(v==Mr.OneTimeMoreBoost)e.player.abilities.nitro_power_charge+=Math.round(g.generated_amounts[0]),null==d&&(d=[]),d.push(g);else if(v==Mr.OneTimeMoreBombs){var b=e.player;ze.pickItem(b.ability_button,new PIXI.Point(0,0),new PIXI.Point(1,1),e.ability_item_container,!0),b.abilities.current_ability=ye.None,b.abilities.received_ability=ye.Bomb,null!=e.player_bot&&(e.player_bot.abilities.bot_ability_receive_time_stamp=e.step.level_seconds+1),null==d&&(d=[]),d.push(g)}else if(v==Mr.OneTimeMoreDynamites){var y=e.player;ze.pickItem(y.ability_button,new PIXI.Point(0,0),new PIXI.Point(1,1),e.ability_item_container,!0),y.abilities.current_ability=ye.None,y.abilities.received_ability=ye.Dynamite,null!=e.player_bot&&(e.player_bot.abilities.bot_ability_receive_time_stamp=e.step.level_seconds+1),null==d&&(d=[]),d.push(g)}else if(v==Mr.OneTimeAtomicBomb){var x=e.player;ze.pickItem(x.ability_button,new PIXI.Point(0,0),new PIXI.Point(1,1),e.ability_item_container,!0),x.abilities.current_ability=ye.None,x.abilities.current_ability_power_add_coeff=g.generated_amounts[0]/100,x.abilities.received_ability=ye.Bomb,null!=e.player_bot&&(e.player_bot.abilities.bot_ability_receive_time_stamp=e.step.level_seconds+1),null==d&&(d=[]),d.push(g)}else if(v==Mr.OneTimePartyTime){for(var z=e.player,w=0,k=e.all_cars;w<k.length;){var S=k[w];++w,S!=z.car&&Vn.spawnAttachment(e,t,n,S,Be.AttachmentBalloon,Le.balloon_time)}null==d&&(d=[]),d.push(g)}}if(null!=d)for(var C=0;C<d.length;){var N=d[C];++C,s.remove(e.ongoing_powers_display.current_items,N)}}var P=e.player.config;P.drive_impulse_additional=P.drive_impulse*(p-1),P.nitro_impulse_additional=P.nitro_impulse*(u-1),P.nitro_velocity_additional_coeff=h,P.rotation_angular_velocity_max_additional_coeff=c}},Vn.updateAchievements=function(e,t){for(var n=0,i=e.achievement_descs;n<i.length;){var r=i[n];++n;for(var a=!1,s=0,l=e.game_save.achievements_completed;s<l.length;){var o=l[s];if(++s,r.id==o){a=!0;break}}if(!a){if(e.level_type==Zn.InRacing)if(r.type==Lr.Stunt3xFrontFlip)3<=e.stunt.stats.max_front_flips&&e.game_save.achievements_completed.push(r.id);else if(r.type==Lr.Stunt3xCombo)3<=e.stunt.stats.max_combos&&e.game_save.achievements_completed.push(r.id);else if(r.type==Lr.Stunt10BackFlipsInALevel)10<=e.stunt.stats.total_back_flips&&e.game_save.achievements_completed.push(r.id);else if(r.type==Lr.Stunt100Flips){for(var _=0,p=0,u=e.game_save.level_saves;p<u.length;){var h=u[p];++p,h.completed&&(_+=h.stunt_stats.total_back_flips,_+=h.stunt_stats.total_front_flips)}_+=e.stunt.stats.total_back_flips,100<=(_+=e.stunt.stats.total_front_flips)&&e.game_save.achievements_completed.push(r.id)}else r.type==Lr.Stunt10xCombo&&10<=e.stunt.stats.max_combos&&e.game_save.achievements_completed.push(r.id);else if(e.level_type==Zn.InInterLevelMenu){for(var c=0,d=0,m=0,f=0,g=e.game_save.level_saves;f<g.length;){var v=g[f];++f,v.description.type==wr.LevelRegular&&v.completed&&(++c,100==v.completion_percent&&++m,1==v.place&&++d)}r.type==Lr.Finish2Levels?2<=c&&e.game_save.achievements_completed.push(r.id):r.type==Lr.Finish6Levels?6<=c&&e.game_save.achievements_completed.push(r.id):r.type==Lr.Finish10LevelsWith100Score?10<=m&&e.game_save.achievements_completed.push(r.id):r.type==Lr.Finish20Levels1st?20<=d&&e.game_save.achievements_completed.push(r.id):r.type==Lr.Finish30LevelsWith100Score&&30<=m&&e.game_save.achievements_completed.push(r.id)}1==e.config.type&&2==e.config.release.sitelock_type&&Ta.updateAllAwards(e)}}if(e.game_save.achievements_shown.length!=e.game_save.achievements_completed.length)for(var b=0,y=e.game_save.achievements_completed;b<y.length;){var x=y[b];if(++b,-1==e.game_save.achievements_shown.indexOf(x)){for(var z=null,w=0,k=0,S=e.achievement_descs;k<S.length;){var C=S[k];if(++k,C.id==x){z=C;break}++w}if(null!=z||(Nl.trace("warning: found_desc == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"updateAchievements"}),0)){if(1==e.config.type&&3==e.config.release.sitelock_type){var N=(w+1)/e.achievement_descs.length;N=ma.clamp(N,.1,1),es.PokiSDK.happyTime(N)}Vn.pushNotification(e.notifications,"Achievement Unlocked!","("+z.name+": "+z.requirement+")")}e.game_save.achievements_shown.push(x)}}},Vn.updateNotifications=function(e,t,n,i,r){if(0<i.show_cue.length?(null==i.container&&(i.container=qa.createGroup(),i.primary_text=qa.createBitmapText(fn.toonish_36,An.primary_text_font_size,"left","Text",.5,.5),i.secondary_text=qa.createBitmapText(fn.toonish_36,An.secondary_text_font_size,"left","Text",.5,.5),i.container.add(i.primary_text),i.container.add(i.secondary_text),i.container.alpha=0),i.state==Tn.None&&(null!=i.container.parent&&e.menu_container.remove(i.container),e.menu_container.add(i.container),i.container.alpha=0,i.primary_text.position.x=0,i.secondary_text.position.y=0,i.show_current=i.show_cue.shift(),i.current_time=0,i.state=Tn.WaitBeforePhaseIn,i.primary_text.text=i.show_current.primary_text,i.secondary_text.text=i.show_current.secondary_text)):i.state==Tn.None&&null!=i.container&&(null!=i.primary_text&&i.primary_text.destroy(!0),null!=i.secondary_text&&i.secondary_text.destroy(!0),i.container.destroy(!0),i.container=null,i.primary_text=null,i.secondary_text=null),i.state==Tn.WaitBeforePhaseIn&&(i.current_time+=n.step_size,i.current_time>=i.show_current.wait_before_phase_in_time&&(i.current_time=0,i.state=Tn.PhaseIn)),i.state==Tn.PhaseIn){i.current_time+=n.step_size;var a=ma.clamp0to1(i.current_time/An.phase_in_time),s=va.smoothStart(2.5,1,a);i.container.scale.x=s,i.container.scale.y=s,1==(i.container.alpha=a)&&(Vn.applyCameraShake(e.camera_shake,10,5),i.state=Tn.Wait,i.current_time=0,Ms.playSound(Gs.sound_notification,r))}else if(i.state==Tn.Wait)i.current_time+=n.step_size,i.current_time>=i.show_current.wait_time&&(i.state=Tn.PhaseOut,i.current_time=0);else if(i.state==Tn.PhaseOut){i.current_time+=n.step_size;var l=ma.clamp0to1(i.current_time/An.phase_out_time);va.smoothStart(1,0,l),i.container.alpha=1-l,1==l&&(i.state=Tn.None,i.show_current=null,i.current_time=0)}null!=i.container&&null!=i.container.parent&&(""==i.secondary_text.text?(i.primary_text.position.y=0,i.secondary_text.visible&&(i.secondary_text.visible=!1)):(i.primary_text.position.y=-An.distance_between_text/2,i.secondary_text.position.y=An.distance_between_text/2,i.secondary_text.visible||(i.secondary_text.visible=!0)),i.container.position.x=t.current_game_width/2,i.container.position.y=t.current_game_height*An.stage_height_coeff)},Vn.updateLevelEnd=function(e,t,n){if(e.level_end_enabled){if(e.player.car.main_body_position_x>=e.level_end_position.x){var i=e.player.car,r=Math.pow(.5,t.dc),a=i.front_wheel_body;a.set_angularVel(a.get_angularVel()*r);var l=i.back_wheel_body;l.set_angularVel(l.get_angularVel()*r),i.front_wheel_body.get_angularVel()<10&&i.front_wheel_body.set_angularVel(0),i.back_wheel_body.get_angularVel()<10&&i.back_wheel_body.set_angularVel(0),0==i.back_wheel_body.get_angularVel()&&0==i.front_wheel_body.get_angularVel()&&(i.main_body.get_velocity().muleq(Math.pow(.98,t.dc)),i.main_body.get_velocity().get_length()<.05&&i.main_body.get_velocity().setxy(0,0)),e.player.nitro_button.state==lr.TransitionOut&&hr.updateNitroTransitionOut(e.player.nitro_button,t.ui_dc)}for(var o=0,_=e.bots;o<_.length;){var u=_[o];if(++o,u.car.main_body_position_x>=e.level_end_position.x){var h=u.car,c=Math.pow(.5,t.dc),d=h.front_wheel_body;d.set_angularVel(d.get_angularVel()*c);var m=h.back_wheel_body;m.set_angularVel(m.get_angularVel()*c),h.front_wheel_body.get_angularVel()<10&&h.front_wheel_body.set_angularVel(0),h.back_wheel_body.get_angularVel()<10&&h.back_wheel_body.set_angularVel(0),0==h.back_wheel_body.get_angularVel()&&0==h.front_wheel_body.get_angularVel()&&(h.main_body.get_velocity().muleq(Math.pow(.98,t.dc)),h.main_body.get_velocity().get_length()<.05&&h.main_body.get_velocity().setxy(0,0)),u.finished_race||(Nl.trace("finished race: "+u.car.name+" (bot) in "+Math.round(e.race_seconds)+" seconds",{fileName:"GameDo.hx",lineNumber:7148,className:"bikas.game.GameDo",methodName:"updateLevelEnd"}),u.finished_race=!0,u.behavior_activated=!1,u.finish_time_in_seconds=e.race_seconds,Ae.deactivateAbilities(u.abilities))}}}if(!e.player.finished_race&&e.level_end_enabled){var f=e.player;if(f.car.main_body_position_x>=e.level_end_position.x&&!f.finished_race){1==e.config.type&&3==e.config.release.sitelock_type&&es.PokiSDK.gameplayStop();var g=e.game_save.current_level_name;Nl.trace("finished race: "+f.car.name+" (player, level: "+g+") in "+Math.round(e.race_seconds)+" seconds, stunt_score: "+e.stunt.stats.total_level_score+", coins: "+e.collected_in_level.coins+", chests: "+e.collected_in_level.chests_collected_guids.length,{fileName:"GameDo.hx",lineNumber:7169,className:"bikas.game.GameDo",methodName:"updateLevelEnd"}),f.finished_race=!0,f.behavior_activated=!1,null!=e.player_bot&&(e.player_bot.behavior_activated=!1),Ae.deactivateAbilities(e.player.abilities),f.nitro_button.state!=lr.Empty&&(f.nitro_button.state=lr.TransitionOut),f.ability_button.state!=be.None&&(f.ability_button.state=be.None,ze.pushToOld(f.ability_button)),e.level_end.current_camera_time=0,e.level_end.current_time=0,e.level_end.state=xn.WaitForFinished,e.level_end.type=wn.LevelEndWin,e.level_end.famobi_posted=!1,Ms.playSound(Gs.sound_across_the_line,n)}}if(e.player.finished_race){var v=e.level_end;if(v.current_time+=t.ui_dc,v.state==xn.WaitForFinished&&(e.stunt.previous_stunt_time_stamp=0,v.current_time>=kn.wait_for_finish_time&&(v.state=xn.FinishedAnimation,v.current_time=0,v.finished_text.alpha=0,v.famobi_posted=!1,v.type==wn.LevelEndWin?(e.current_level_save.description.type==wr.LevelRegular?v.finished_text.setTexture(Hs.getTexture("finished_text")):v.finished_text.setTexture(Hs.getTexture("challenge_completed_text")),ka.trackLevelFinish(e.current_level_save.description.name)):v.type==wn.LevelEndFail?(v.finished_text.setTexture(Hs.getTexture("failed_text")),ka.trackLevelFailed(e.current_level_save.description.name)):Nl.trace("warning: unhandled "+p.string(v.type),{fileName:"GameDo.hx",lineNumber:7231,className:"bikas.game.GameDo",methodName:"updateLevelEnd"}),Vn.safeAdd(e.ingame_container,v.finished_text))),v.state==xn.FinishedAnimation){var b=va.clamp(v.current_time/kn.finished_animation_time,0,1),y=va.smoothStart(kn.finished_start_scale,kn.finished_end_scale,b),x=va.smoothStart(0,1,b);v.finished_text.scale.x=y,v.finished_text.scale.y=y,v.finished_text.alpha=x,Vn.setInGameControlsAlpha(e,1-x),e.player.nitro_button.state=lr.TransitionOut,v.current_time>=kn.finished_animation_time&&(v.state=xn.WaitForLevelStats,v.current_time=0,Vn.applyCameraShake(e.camera_shake,kn.camera_shake_amount,kn.camera_shake_time,e.player.car,e.player.car.main_body.get_position()),Ms.playSound(Gs.sound_bang,n),v.type==wn.LevelEndWin&&1==e.current_place.place_number&&Vn.pushNotification(e.notifications,"1st Place!","",.5))}if(v.state==xn.WaitForLevelStats&&v.current_time>=kn.wait_for_level_stats_time&&(v.state=xn.InLevelStats,v.current_time=0),v.state==xn.InLevelStats){var z=0,w=Di.None,k=e.current_place.place_number;if(e.current_level_save.description.type==wr.LevelRegular){var S;0!=e.stunt.current_score&&Nl.trace("warning: stunt.current_score is still "+e.stunt.current_score,{fileName:"GameDo.hx",lineNumber:7288,className:"bikas.game.GameDo",methodName:"updateLevelEnd"});var C=e.stunt.stats.total_level_score,N=e.current_level_save.description.max_stunt_score;if(S=ma.clamp(C/N,0,1),Oi.update(e,e.level_stats,e.current_level_save,k,S,e.collected_in_level,e.game_save,e.all_cars.length,e.menu_container,e.js_info,e.pointer,e.step,e.sounds_enabled),4==e.config.release.sitelock_type&&e.level_stats.famobi_score_counting_completed&&!e.level_stats.famobi_score_posted){e.level_stats.famobi_score_posted=!0;var P=e.current_level_save.description_name;e.level_stats.famobi_score_success?ve.trackSuccess(P):ve.trackFail(P,"timeout")}z=e.level_stats.final_level_percent,w=e.level_stats.click_action}else if(e.current_level_save.description.type==wr.LevelChallenge){var M=e.current_level_save.description_name;if(v.type==wn.LevelEndWin){if(v.challenge_button.texture!=kn.challenge_win_button_texture&&v.challenge_button.setTexture(kn.challenge_win_button_texture),4==e.config.release.sitelock_type&&!v.famobi_posted)return v.famobi_posted=!0,ve.trackSuccess(M),void(null!=v.challenge_button&&(v.challenge_button.visible=!1))}else if(v.type==wn.LevelEndFail){if(v.challenge_button.texture!=kn.challenge_fail_button_texture&&v.challenge_button.setTexture(kn.challenge_fail_button_texture),!v.famobi_posted)return v.famobi_posted=!0,ve.trackFail(M,"timeout"),void(null!=v.challenge_button&&(v.challenge_button.visible=!1))}else Nl.trace("warning: unhandled "+p.string(v.type),{fileName:"GameDo.hx",lineNumber:7357,className:"bikas.game.GameDo",methodName:"updateLevelEnd"});null==v.challenge_button.parent&&e.menu_container.add(v.challenge_button),v.challenge_button.visible=!0,v.challenge_button.position.x=e.js_info.current_game_width/2,v.challenge_button.position.y=e.js_info.current_game_height/2,Ii.isReleased(e.keyboard_keys_released,32)&&(v.type==wn.LevelEndWin?(z=100,w=Di.StatsClickContinue):v.type==wn.LevelEndFail?w=Di.StatsClickRestart:Nl.trace("warning: unhandled "+p.string(v.type),{fileName:"GameDo.hx",lineNumber:7383,className:"bikas.game.GameDo",methodName:"updateLevelEnd"})),Vn.isObjectDownedInRadius(v.challenge_button,e.pointer,v.challenge_button.height/2+15)&&(v.type==wn.LevelEndWin?(z=100,w=Di.StatsClickContinue):v.type==wn.LevelEndFail?w=Di.StatsClickRestart:Nl.trace("warning: unhandled "+p.string(v.type),{fileName:"GameDo.hx",lineNumber:7401,className:"bikas.game.GameDo",methodName:"updateLevelEnd"}))}else Nl.trace("warning: unhandled state",{fileName:"GameDo.hx",lineNumber:7406,className:"bikas.game.GameDo",methodName:"updateLevelEnd"});if(w!=Di.None)if(w==Di.StatsClickRestart)1==e.config.type&&2==e.config.release.sitelock_type?v.state=xn.InNext:1==e.config.type&&3==e.config.release.sitelock_type?(v.state=xn.InAd,es.PokiSDK.commercialBreak().then(function(){v.state=xn.InNext})):v.state=xn.InNext,4==e.config.release.sitelock_type&&ve.trackRestart(e.current_level_save.description_name),v.next_state=zn.NextRestartLevel;else if(w==Di.StatsClickContinue)if(null==e.inter_level_menu_save)Nl.trace("warning: couldn't find inter_level_menu_save",{fileName:"GameDo.hx",lineNumber:7447,className:"bikas.game.GameDo",methodName:"updateLevelEnd"});else{for(var I=[],T=0,A=e.game_save.ongoing_powers.level_items;T<A.length;){var D=A[T];++T,-1==e.ongoing_powers_display.current_items.indexOf(D)?I.push(D):D.desc.expiration_type==Ar.OneLevel&&I.push(D)}for(var E=0;E<I.length;){var O=I[E];++E,s.remove(e.game_save.ongoing_powers.level_items,O),s.remove(e.ongoing_powers_display.current_items,O)}var B=e.current_level_save.description.level_number-1;if(0<=B&&B<e.upgrades.points_per_level.length&&(e.game_save.upgrade_points+=e.upgrades.points_per_level[B]),e.game_save.coins+=e.collected_in_level.coins,e.current_level_save.completed=!0,-1==e.current_level_save.place)e.current_level_save.place=ma.clamp0toInfinityInt(k);else{var L=ma.clamp0toInfinityInt(e.current_level_save.place),j=ma.clamp0toInfinityInt(k);e.current_level_save.place=ma.minInt(L,j)}e.current_level_save.completion_percent=ma.maxInt(e.current_level_save.completion_percent,z),null!=e.current_level_save.stunt_stats?e.current_level_save.stunt_stats=Hr.getHighestStunts(e.current_level_save.stunt_stats,e.stunt.stats):e.current_level_save.stunt_stats=e.stunt.stats,e.current_level_save.coins=ma.maxInt(e.current_level_save.coins,e.collected_in_level.coins),e.current_level_save.chests_rewarded+=e.collected_in_level.chests_rewarded;for(var F=0,R=e.collected_in_level.chests_collected_guids;F<R.length;){var G=R[F];++F,e.current_level_save.chests_collected_guids.push(G)}if(v.next_state=zn.NextInterLevelMenu,e.credits_shown||e.game_save.credits_shown||null==e.credits_save||30<=Pr.getTotalRegularLevelsCompleted(e.game_save)&&(e.game_save.credits_shown=!0,e.credits_shown=!0,v.next_state=zn.NextCreditsLevel),1==e.config.type&&2==e.config.release.sitelock_type?(v.state=xn.InAd,Ta.showAd(function(){e.level_end.state=xn.InNext})):1==e.config.type&&3==e.config.release.sitelock_type?(v.state=xn.InAd,es.PokiSDK.commercialBreak().then(function(){v.state=xn.InNext})):v.state=xn.InNext,4==e.config.release.sitelock_type){e.current_level_save.description_name;for(var Z=0,U=e.game_save.level_saves;Z<U.length;){var V=U[Z];++Z,V.completion_percent}}}else Nl.trace("warning: unhandled "+p.string(w),{fileName:"GameDo.hx",lineNumber:7577,className:"bikas.game.GameDo",methodName:"updateLevelEnd"})}else v.state!=xn.InAd&&(v.state,xn.InNext);null!=v.finished_text.parent&&(v.finished_text.position.x=e.js_info.current_game_width/2,v.finished_text.position.y=e.js_info.current_game_height/3*.5),v.current_camera_time+=t.ui_dc,v.current_camera_time>=kn.camera_time&&(v.current_camera_time=kn.camera_time);var q=e.player.car.main_body_entity.position,W=v.current_camera_time/kn.camera_time,X=e.player.car.distance_from_main_body_to_bottom_y,H=e.level_end_position.x+.2666666666666667*e.js_info.current_game_width,Y=e.level_end_position.y-X,J=va.linear(q.x,H,W),K=va.linear(q.y,Y,W);e.current_level_save.description.type==wr.LevelRegular&&(v.camera_position.x=J,v.camera_position.y=K,e.camera.camera_target_pos.set_x(v.camera_position.x),e.camera.camera_target_pos.set_y(v.camera_position.y),e.camera.target_pos.set_x(v.camera_position.x),e.camera.target_pos.set_y(v.camera_position.y),e.camera.smooth_steps=100)}},Vn.updateSlowDownEffect=function(e,t){var n=e.slow_down_time,i=t.original_dc*e.temp_dc_coeff;if(n.current_delay-=i,n.current_delay<=0){n.current_duration+=i;var r=1;if(n.current_duration<=n.smooth_in_duration){var a=ma.range(n.current_duration,0,n.smooth_in_duration);r=va.linear(1,n.time_coeff,a)}else if(n.current_duration>=n.duration-n.smooth_out_duration){var s=ma.range(n.current_duration,n.duration-n.smooth_out_duration,n.duration);r=va.linear(n.time_coeff,1,s)}else r=n.time_coeff;n.current_duration>=n.duration?(e.delta_update_coeff_by_effect=1,e.slow_down_time=null):e.delta_update_coeff_by_effect=r}},Vn.updateCamera=function(e,t){var n=t.dc,i=e.js_info;if(null!=e.camera){var r=-1;0==e.config.type&&(r=e.config.development.fixed_camera_zoom);var a=0==e.config.type&&e.config.development.manual_camera_control;if(i.current_game_width==e.current_camera_refresh_width_cache&&i.current_game_height==e.current_camera_refresh_height_cache||(null!=e.player&&null!=e.camera&&null!=e.stage_group?Vn.refreshCameraCenter(e,e.camera,i,e.player.car.main_body_entity.position):null!=e.menu_camera_position&&null!=e.camera&&null!=e.stage_group&&Vn.refreshCameraCenter(e,e.camera,i,e.menu_camera_position)),0<=e.camera_shake.current_time&&(e.camera_shake.current_time-=n,a&&(e.camera.additional_offset.set_x(Math.random()*e.camera_shake.amount*2-e.camera_shake.amount),e.camera.additional_offset.set_y(Math.random()*e.camera_shake.amount*2-e.camera_shake.amount),e.camera_shake.current_time<0&&(e.camera.additional_offset.set_x(0),e.camera.additional_offset.set_y(0)))),e.level_type==Zn.InRacing&&null!=e.camera&&null!=e.stage_group&&null!=e.player){var s=e.player.car.distance_from_main_body_to_bottom_y,l=e.camera.zoom_max,o=e.camera.zoom_min-l,_=100;if(0!=o){var p=(e.camera.current_zoom-l)/o;_=va.linear(100,0,p)}e.camera.view_offset.set_y(-e.js_info.current_game_height*e.camera_view_ratio+s-_);var u=e.player.car.main_body_entity.position;a?e.temp.camera_control.type==en.ImitatePlayer?u=e.temp.camera_control.camera_position:e.temp.camera_control.type==en.Free&&(u=e.temp.camera_control.camera_position,e.camera.camera_target_pos.set_x(u.x),e.camera.camera_target_pos.set_y(u.y),e.camera.target_pos.set_x(u.x),e.camera.target_pos.set_y(u.y)):e.player.finished_race&&e.current_level_save.description.type==wr.LevelRegular&&(u=e.level_end.camera_position),zt.updateCarCamera(e.camera,u,e.stage_group.position,e.stage_group.transform,n,r)}else if((e.level_type==Zn.InMainMenu||e.level_type==Zn.InInterLevelMenu)&&null!=e.menu_camera_position&&null!=e.camera&&null!=e.stage_group){var h=e.camera.zoom_max,c=1-h,d=100;if(0!=c){var m=(e.camera.current_zoom-h)/c;d=va.linear(100,0,m)}e.camera.view_offset.set_x(0),d=0,e.camera.view_offset.set_y(-e.js_info.current_game_height*e.camera_view_ratio-d);var f=e.menu_camera_position;a&&(f=e.temp.camera_control.camera_position,e.camera.camera_target_pos.set_x(f.x),e.camera.camera_target_pos.set_y(f.y),e.camera.target_pos.set_x(f.x),e.camera.target_pos.set_y(f.y)),zt.updateStaticCamera(e.camera,f,e.stage_group.position,e.stage_group.transform,n,r)}if(null!=e.stage_group){var g=e.stage_group,v=g.group.container,b=g.transform;v.x=g.position.x,v.y=g.position.y,v.scale.x!=b.scale_x&&(v.scale.x=b.scale_x),v.scale.y!=b.scale_y&&(v.scale.y=b.scale_y)}}else Nl.trace("warning: game.camera == null",{fileName:"GameDo.hx",lineNumber:7652,className:"bikas.game.GameDo",methodName:"updateCamera"})},Vn.updateGameVisibleBounds=function(e){var t=e.stage_group.transform.scale_x;e.visible_bounds.min_x=-e.stage_group.position.x/t,e.visible_bounds.min_y=-e.stage_group.position.y/t,e.visible_bounds.max_x=e.visible_bounds.min_x+e.js_info.current_game_width/t,e.visible_bounds.max_y=e.visible_bounds.min_y+e.js_info.current_game_height/t,0==e.config.type&&e.config.development.reduce_visible_bounds_by_100_pixels&&(e.visible_bounds.min_x+=100,e.visible_bounds.min_y+=100,e.visible_bounds.max_x-=100,e.visible_bounds.max_y-=100)},Vn.updatePolygonDraw=function(e){for(var t=e.stage_group.transform.scale_x,n=e.stage_group.group.container,i=0,r=e.textured_polygons;i<r.length;){var a=r[i];++i;var s=a.data.real_time_graphics.position;a.draw_bounds.min_x=e.visible_bounds.min_x-s.x,a.draw_bounds.min_y=e.visible_bounds.min_y-s.y,a.draw_bounds.max_x=e.visible_bounds.max_x-s.x,a.draw_bounds.max_y=e.visible_bounds.max_y-s.y,Ua.draw(a.data,a.draw_bounds,t,!0)}null!=e.background_ground_group&&(e.background_ground_group.x=n.x,e.background_ground_group.y=n.y,e.background_ground_group.scale.x=n.scale.x,e.background_ground_group.scale.y=n.scale.y),null!=e.ground_group&&(e.ground_group.x=n.x,e.ground_group.y=n.y,e.ground_group.scale.x=n.scale.x,e.ground_group.scale.y=n.scale.y),null!=e.grass_group&&(e.grass_group.x=n.x,e.grass_group.y=n.y,e.grass_group.scale.x=n.scale.x,e.grass_group.scale.y=n.scale.y),null!=e.marker_group&&(e.marker_group.x=n.x,e.marker_group.y=n.y,e.marker_group.scale.x=n.scale.x,e.marker_group.scale.y=n.scale.y)},Vn.updateBackground=function(e,t){if(null!=e.background){var n=e.js_info,i=e.background,r=e.camera;e.stage_group.transform.scale_x,e.camera_free||(i.camera.x=zt.getStagePositionX(r,1),i.camera.y=zt.getStagePositionY(r,1),i.camera.x+=e.background_camera_offset.x,i.camera.y+=e.background_camera_offset.y),i.camera.z=i.eye.z/r.current_zoom-i.eye.z,i.camera.z+=e.background_camera_offset.z;var a=n.current_game_width/2,s=n.current_game_height*e.background_ratio;Xe.updateBackground(i,n.current_game_width,n.current_game_height,a,s,t)}},Vn.updateDebugStuff=function(e,t){e.js_info,e.pointer,e.gameplay_bot_enabled&&Hn.update(e,e.gameplay_bot);for(var n=0,i=e.temp.updates;n<i.length;){var r=i[n];++n,r()}};var qn=function(){};(n["bikas.game.GameSerializerDo"]=qn).__name__=["bikas","game","GameSerializerDo"],qn.describeData=function(){re.pushClass;var e=re.pushBool,t=re.pushInt,n=(re.pushDouble,re.pushString),i=(re.pushEnum,re.pushArray),r=re.pushInstance,a=re.pushIgnore,s=re.createSerialData(),l=re.pushClass(s,Nr,null);return t(l,"save_data_version"),n(l,"save_date"),n(l,"current_level_name"),n(l,"previous_level_name"),i(l,"level_saves",[12]),e(l,"credits_shown"),t(l,"chests"),t(l,"coins"),t(l,"upgrade_points"),r(l,"car_upgrades"),n(l,"current_car"),i(l,"car_own_list",[5]),i(l,"current_bot_car_lineup",[5]),i(l,"locked_cars",[5]),t(l,"bot_replaced_at_level_count"),i(l,"achievements_completed",[5]),i(l,"achievements_shown",[5]),i(l,"achievements_claimed",[5]),i(l,"challenges_unlocked",[5]),i(l,"challenges_unlocked_shown",[5]),i(l,"challenges_unlocked_shown_on_map",[5]),i(l,"challenges_completed",[5]),i(l,"challenges_completed_claimed",[5]),r(l,"ongoing_powers"),i(l,"rewarded_ads",[12]),e(l,"tutorial_shown_controls"),e(l,"tutorial_shown_jump"),e(l,"tutorial_shown_nitro"),e(l,"tutorial_shown_power"),n(l=re.pushClass(s,Cr,null),"description_name"),a(l,"description"),e(l,"completed"),e(l,"locked"),t(l,"place"),t(l,"completion_percent"),r(l,"stunt_stats"),t(l,"coins"),t(l,"chests_rewarded"),i(l,"chests_collected_guids",[5]),t(l=re.pushClass(s,Wr,null),"max_front_flips"),t(l,"max_back_flips"),t(l,"max_front_wheelies"),t(l,"max_back_wheelies"),t(l,"max_combos"),t(l,"max_level_score"),t(l,"total_front_flips"),t(l,"total_back_flips"),t(l,"total_front_wheelies"),t(l,"total_back_wheelies"),t(l,"total_combos"),t(l,"total_perfect_landings"),t(l,"total_level_score"),t(l=re.pushClass(s,gr,null),"top_speed"),t(l,"acceleration"),t(l,"handling"),t(l,"armor"),i(l=re.pushClass(s,yr,null),"permanent_items",[12]),i(l,"level_items",[12]),n(l=re.pushClass(s,Er,null),"id"),a(l,"desc"),i(l,"generated_amounts",[4]),n(l,"description_text"),e(l,"shown"),t(l=re.pushClass(s,xr,null),"type"),t(l,"levels_completed"),re.validateSerialData(s),re.createTypeTableForSerialData(s),s},qn.saveToStorage=function(e,t,n){null==n&&(n="adventure_drivers");var i=re.serialize(e,t,[12]),r=Tl.encode(i);if(4==$s.config.release.sitelock_type){var a=!1;try{a=ve.saveToStorage(n,r)}catch(e){return e instanceof ao&&(e=e.val),Nl.trace(e,{fileName:"GameSerializerDo.hx",lineNumber:190,className:"bikas.game.GameSerializerDo",methodName:"saveToStorage"}),!1}return a}try{lo.get_window().localStorage.setItem(n,r)}catch(e){return e instanceof ao&&(e=e.val),Nl.trace(e,{fileName:"GameSerializerDo.hx",lineNumber:199,className:"bikas.game.GameSerializerDo",methodName:"saveToStorage"}),!1}return!0},qn.loadFromStorage=function(e,t){null==t&&(t="adventure_drivers");var n=null;if(4==$s.config.release.sitelock_type)try{n=ve.loadFromStorage(t)}catch(e){return e instanceof ao&&(e=e.val),Nl.trace(e,{fileName:"GameSerializerDo.hx",lineNumber:212,className:"bikas.game.GameSerializerDo",methodName:"loadFromStorage"}),null}else try{n=lo.get_window().localStorage.getItem(t)}catch(e){return e instanceof ao&&(e=e.val),Nl.trace(e,{fileName:"GameSerializerDo.hx",lineNumber:219,className:"bikas.game.GameSerializerDo",methodName:"loadFromStorage"}),null}if(null==n)return null;var i=so.__cast(n,String),r=Tl.decode(i);if(null==r)return null;var a=re.unserialize(e,r);return so.__cast(a,Nr)},qn.clearStorage=function(){if(4==$s.config.release.sitelock_type)try{ve.clearStorage()}catch(e){e instanceof ao&&(e=e.val),Nl.trace(e,{fileName:"GameSerializerDo.hx",lineNumber:255,className:"bikas.game.GameSerializerDo",methodName:"clearStorage"})}else try{lo.get_window().localStorage.clear()}catch(e){e instanceof ao&&(e=e.val),Nl.trace(e,{fileName:"GameSerializerDo.hx",lineNumber:262,className:"bikas.game.GameSerializerDo",methodName:"clearStorage"})}},qn.stringToBinary=function(e){for(var t=e.split(","),n=Il.alloc(t.length),i=0,r=n.length;i<r;){var a=i++;n.set(a,p.parseInt(t[a]))}return n},qn.binaryToString=function(e){for(var t=[],n=0,i=e.length;n<i;){var r=n++;t.push(e.get(r))}return t.join(",")};var Wn=function(){};(n["bikas.game.GameSoundDo"]=Wn).__name__=["bikas","game","GameSoundDo"],Wn.playSoundInGameLevel=function(e,t,n,i,r,a){var s=i.main_body_position_x,l=i.main_body_position_y,o=ma.distance(n.get_x(),n.get_y(),s,l),_=va.getTClamped(a,0,o/r);0<_&&Ms.playSound(e,t,_)};var Xn=function(){this.current_wait_time=0};(n["bikas.game.GameplayBot"]=Xn).__name__=["bikas","game","GameplayBot"],Xn.prototype={current_wait_time:null,__class__:Xn};var Hn=function(){};(n["bikas.game.GameplayBotDo"]=Hn).__name__=["bikas","game","GameplayBotDo"],Hn.gotoTargetPlace=function(e,t,n){var i=zi.findPlaceByName(e.places,n);return null!=i&&(e.scroll_target.x=i.marker.position.x,Math.abs(t.current_pos.get_x()-e.scroll_target.x)<1)},Hn.update=function(e,t){var n=e.camera,i=e.game_save,r=e.sounds_enabled;if(e.level_type==Zn.InRacing){if(e.level_end.state==xn.InLevelStats){var a=e.level_stats;a.state==Ai.StatsWaiting&&(a.continue_available?1==a.continue_button.alpha&&Oi.clickContinue(e.collected_in_level,a,i,r):1==a.restart_button.alpha&&Oi.clickRestart(a,e.sounds_enabled))}}else if(e.level_type==Zn.InInterLevelMenu){var s=e.inter_level_menu;if(s.state==yi.InFreeScroll){if(t.current_wait_time+=e.step.step_size,t.current_wait_time>=Xn.wait_in_menu_time&&0<s.chests.length&&(t.current_wait_time=0,Hn.gotoTargetPlace(s,n,xi.place_treasure)))for(var l=0,o=s.chests;l<o.length;){var _=o[l];if(++l,_.state==Yn.Closed){zi.clickChest(s,_);break}}if(t.current_wait_time>=Xn.wait_in_menu_time){for(var p=null,u=0,h=s.achievements;u<h.length;){var c=h[u];if(++u,-1!=i.achievements_completed.indexOf(c.desc.id)&&-1==i.achievements_claimed.indexOf(c.desc.id)){p=c;break}}null!=p&&(t.current_wait_time=0,Hn.gotoTargetPlace(s,n,xi.place_achievements)&&zi.clickAchievement(s,p,i,e.ongoing_powers_display,e.notifications,e.achievement_save,r))}if(t.current_wait_time>=Xn.wait_in_menu_time)for(var d=0,m=e.upgrades.upgrade_costs;d<m.length;){var f=m[d];++d;var g=f.costs.length,v=0;if("top_speed"==f.name?v=i.car_upgrades.top_speed:"acceleration"==f.name?v=i.car_upgrades.acceleration:"handling"==f.name?v=i.car_upgrades.handling:"armor"==f.name&&(v=i.car_upgrades.armor),v<g){var b=f.costs[v];if(b<=e.game_save.upgrade_points){t.current_wait_time=0,Hn.gotoTargetPlace(s,n,xi.place_upgrades)&&zi.clickUpgrade(s,f.name,b,i,r);break}}}if(t.current_wait_time>=Xn.wait_in_menu_time&&(t.current_wait_time=Xn.wait_in_menu_time),t.current_wait_time>=Xn.wait_in_menu_time)for(var y=0,x=s.level_map.levels;y<x.length;){var z=x[y];if(++y,z.could_be_next_level){var w=i.level_saves[z.level_save_index];if(w.description.type==wr.LevelRegular){t.current_wait_time=0,Hn.gotoTargetPlace(s,n,xi.place_map)&&zi.clickLevel(s,w,r);break}}}}else if(s.state==yi.InRewardSelection){var k=s.reward_display;if(k.state==Kn.RewardSelect&&0<k.reward_selection.cards.length){var S=ma.getRandomBetweenInt(0,k.reward_selection.cards.length-1),C=k.reward_selection.cards[S];zi.clickRewardCard(e.partition_top,s,k,C,e.game_save,e.ongoing_powers_display,e.notifications,e.sounds_enabled)}}}};var Yn=n["bikas.game.ChestState"]={__ename__:["bikas","game","ChestState"],__constructs__:["Closed","Opened"]};Yn.Closed=["Closed",0],Yn.Closed.toString=i,(Yn.Closed.__enum__=Yn).Opened=["Opened",1],Yn.Opened.toString=i,(Yn.Opened.__enum__=Yn).__empty_constructs__=[Yn.Closed,Yn.Opened];var Jn=function(){this.additional_sprites_added=!1,this.state=Yn.Closed};(n["bikas.game.Chest"]=Jn).__name__=["bikas","game","Chest"],Jn.prototype={state:null,additional_sprites_added:null,chest_partition_object:null,chest:null,current_time:null,__class__:Jn};var Kn=n["bikas.game.RewardSelectionState"]={__ename__:["bikas","game","RewardSelectionState"],__constructs__:["RewardAnimateIn","RewardSelect","RewardAnimateOut"]};Kn.RewardAnimateIn=["RewardAnimateIn",0],Kn.RewardAnimateIn.toString=i,(Kn.RewardAnimateIn.__enum__=Kn).RewardSelect=["RewardSelect",1],Kn.RewardSelect.toString=i,(Kn.RewardSelect.__enum__=Kn).RewardAnimateOut=["RewardAnimateOut",2],Kn.RewardAnimateOut.toString=i,(Kn.RewardAnimateOut.__enum__=Kn).__empty_constructs__=[Kn.RewardAnimateIn,Kn.RewardSelect,Kn.RewardAnimateOut];var Qn=function(){this.selected_card_start_scale=0,this.current_time=0,this.chest_position=null,this.chest=null,this.reward_selection=null};(n["bikas.game.RewardSelectionDisplay"]=Qn).__name__=["bikas","game","RewardSelectionDisplay"],Qn.prototype={state:null,reward_selection:null,chest:null,chest_position:null,current_time:null,selected_card_start_scale:null,selected_card:null,__class__:Qn};var $n=function(){this.main_button=null,this.icon=null};(n["bikas.game.RequirementAndRewardCard"]=$n).__name__=["bikas","game","RequirementAndRewardCard"],$n.prototype={container:null,background:null,close_button:null,icon:null,name_text:null,requirement_text:null,reward_text:null,requirement_highlight:null,reward_highlight:null,main_button:null,__class__:$n};var ei=n["bikas.game.AchievementDisplayState"]={__ename__:["bikas","game","AchievementDisplayState"],__constructs__:["Closed","Opened"]};ei.Closed=["Closed",0],ei.Closed.toString=i,(ei.Closed.__enum__=ei).Opened=["Opened",1],ei.Opened.toString=i,(ei.Opened.__enum__=ei).__empty_constructs__=[ei.Closed,ei.Opened];var ti=function(){this.card=null,this.white_circle_current_time=0,this.white_circle_partition_object=null,this.white_circle=null,this.state=ei.Closed};(n["bikas.game.AchievementDisplay"]=ti).__name__=["bikas","game","AchievementDisplay"],ti.prototype={state:null,desc:null,entity:null,white_circle:null,white_circle_partition_object:null,white_circle_current_time:null,card:null,__class__:ti};var ni=n["bikas.game.UpgradeUnitState"]={__ename__:["bikas","game","UpgradeUnitState"],__constructs__:["None","Downed","Clicked"]};ni.None=["None",0],ni.None.toString=i,(ni.None.__enum__=ni).Downed=["Downed",1],ni.Downed.toString=i,(ni.Downed.__enum__=ni).Clicked=["Clicked",2],ni.Clicked.toString=i,(ni.Clicked.__enum__=ni).__empty_constructs__=[ni.None,ni.Downed,ni.Clicked];var ii=function(){this.upgrade_point_costs=[],this.filled=[],this.additional_sprites_added=!1,this.state=ni.None};(n["bikas.game.UpgradeUnit"]=ii).__name__=["bikas","game","UpgradeUnit"],ii.prototype={state:null,name:null,unfilled_entity:null,fill_start_position:null,plus_entity:null,plus_init_pos:null,plus_points_background_entity:null,additional_sprites_added:null,plus_points_text:null,filled:null,upgrade_point_costs:null,__class__:ii};var ri=function(){this.current_car=null,this.current_car_name="",this.units=[],this.additional_sprites_added=!1};(n["bikas.game.UpgradeDisplay"]=ri).__name__=["bikas","game","UpgradeDisplay"],ri.prototype={prefab_entity:null,points_background_entity:null,additional_sprites_added:null,points_text:null,units:null,car_location:null,current_car_name:null,current_car:null,__class__:ri};var ai=n["bikas.game.CarCardState"]={__ename__:["bikas","game","CarCardState"],__constructs__:["Select","AlreadySelected","Buy","CantBuy"]};ai.Select=["Select",0],ai.Select.toString=i,(ai.Select.__enum__=ai).AlreadySelected=["AlreadySelected",1],ai.AlreadySelected.toString=i,(ai.AlreadySelected.__enum__=ai).Buy=["Buy",2],ai.Buy.toString=i,(ai.Buy.__enum__=ai).CantBuy=["CantBuy",3],ai.CantBuy.toString=i,(ai.CantBuy.__enum__=ai).__empty_constructs__=[ai.Select,ai.AlreadySelected,ai.Buy,ai.CantBuy];var si=function(){this.green_or_red_bar=null};(n["bikas.game.CarMetric"]=si).__name__=["bikas","game","CarMetric"],si.prototype={container:null,background_bar:null,foreground_bar:null,green_or_red_bar:null,text:null,__class__:si};var li=function(){this.metrics=[],this.state=ai.Select};(n["bikas.game.CarCard"]=li).__name__=["bikas","game","CarCard"],li.prototype={state:null,container:null,background:null,close_button:null,main_button:null,coin:null,text_background:null,text:null,metrics:null,__class__:li};var oi=n["bikas.game.CarInShopState"]={__ename__:["bikas","game","CarInShopState"],__constructs__:["Closed","Opened"]};oi.Closed=["Closed",0],oi.Closed.toString=i,(oi.Closed.__enum__=oi).Opened=["Opened",1],oi.Opened.toString=i,(oi.Opened.__enum__=oi).__empty_constructs__=[oi.Closed,oi.Opened];var _i=n["bikas.game.CarInShopShowType"]={__ename__:["bikas","game","CarInShopShowType"],__constructs__:["None","Locked","Owned","Selected","Priced"]};_i.None=["None",0],_i.None.toString=i,(_i.None.__enum__=_i).Locked=["Locked",1],_i.Locked.toString=i,(_i.Locked.__enum__=_i).Owned=["Owned",2],_i.Owned.toString=i,(_i.Owned.__enum__=_i).Selected=["Selected",3],_i.Selected.toString=i,(_i.Selected.__enum__=_i).Priced=["Priced",4],_i.Priced.toString=i,(_i.Priced.__enum__=_i).__empty_constructs__=[_i.None,_i.Locked,_i.Owned,_i.Selected,_i.Priced];var pi=function(){this.card=null,this.additional_sprites_added=!1,this.car_shop_name="",this.car_name="",this.show_type=_i.None,this.state=oi.Closed};(n["bikas.game.CarInShop"]=pi).__name__=["bikas","game","CarInShop"],pi.prototype={state:null,show_type:null,car_name:null,car_shop_name:null,car_setting:null,car_entity:null,car_sprite:null,regular_texture:null,locked_texture:null,name_tag_entity:null,additional_sprites_added:null,name_tag_text:null,name_tag_coin:null,card:null,__class__:pi};var ui=function(){this.cars=[]};(n["bikas.game.CarShop"]=ui).__name__=["bikas","game","CarShop"],ui.prototype={cars:null,__class__:ui};var hi=function(){};(n["bikas.game.ConfirmationCard"]=hi).__name__=["bikas","game","ConfirmationCard"],hi.prototype={container:null,background:null,bitmap_text:null,text_background:null,button_close:null,button_main:null,__class__:hi};var ci=n["bikas.game.LevelMapItemState"]={__ename__:["bikas","game","LevelMapItemState"],__constructs__:["Closed","Opened"]};ci.Closed=["Closed",0],ci.Closed.toString=i,(ci.Closed.__enum__=ci).Opened=["Opened",1],ci.Opened.toString=i,(ci.Opened.__enum__=ci).__empty_constructs__=[ci.Closed,ci.Opened];var di=function(){this.could_be_next_level=!1,this.animate_in=!1,this.click_position=new ea(0,0),this.challenge_card=null,this.level_card=null,this.challenge_desc=null,this.current_time=0,this.previous_level=null,this.level_save_index=-1,this.selected_circle_added_to_partition=!1,this.state=ci.Closed};(n["bikas.game.LevelMapItem"]=di).__name__=["bikas","game","LevelMapItem"],di.prototype={state:null,entity:null,sprite:null,selected_circle:null,selected_circle_added_to_partition:null,level_save_index:null,previous_level:null,current_time:null,challenge_desc:null,level_card:null,challenge_card:null,click_position:null,animate_in:null,could_be_next_level:null,__class__:di};var mi=function(){this.levels=[]};(n["bikas.game.LevelMap"]=mi).__name__=["bikas","game","LevelMap"],mi.prototype={map_entity:null,levels:null,__class__:mi};var fi=function(){this.reward_ad_type=0,this.closed=!1};(n["bikas.game.RewardedAdMenu"]=fi).__name__=["bikas","game","RewardedAdMenu"],fi.prototype={confirm_card:null,closed:null,reward_ad_type:null,ad:null,text:null,show_time_stamp:null,__class__:fi};var gi=n["bikas.game.CardPointerEventType"]={__ename__:["bikas","game","CardPointerEventType"],__constructs__:["DownedOutside","DownedInside","DownedCloseButton","DownedMainButton","None"]};gi.DownedOutside=["DownedOutside",0],gi.DownedOutside.toString=i,(gi.DownedOutside.__enum__=gi).DownedInside=["DownedInside",1],gi.DownedInside.toString=i,(gi.DownedInside.__enum__=gi).DownedCloseButton=["DownedCloseButton",2],gi.DownedCloseButton.toString=i,(gi.DownedCloseButton.__enum__=gi).DownedMainButton=["DownedMainButton",3],gi.DownedMainButton.toString=i,(gi.DownedMainButton.__enum__=gi).None=["None",4],gi.None.toString=i,(gi.None.__enum__=gi).__empty_constructs__=[gi.DownedOutside,gi.DownedInside,gi.DownedCloseButton,gi.DownedMainButton,gi.None];var vi=function(){this.backward_button=null,this.forward_button=null,this.place=null,this.level_map_item=null,this.car_in_shop=null,this.upgrade_unit=null,this.achievement=null,this.chest=null,this.entity=null,this.distance=-1};(n["bikas.game.ClosestObject"]=vi).__name__=["bikas","game","ClosestObject"],vi.prototype={distance:null,entity:null,chest:null,achievement:null,upgrade_unit:null,car_in_shop:null,level_map_item:null,place:null,forward_button:null,backward_button:null,__class__:vi};var bi=function(){this.button=null};(n["bikas.game.InterLevelMenuPlace"]=bi).__name__=["bikas","game","InterLevelMenuPlace"],bi.prototype={marker:null,current_zoom:null,zoom_min:null,zoom_max:null,normal_texture:null,dark_texture:null,button:null,__class__:bi};var yi=n["bikas.game.InterLevelMenuState"]={__ename__:["bikas","game","InterLevelMenuState"],__constructs__:["InFreeScroll","InMapScroll","InRewardSelection","InAchievementShow","InCarBuyShow","InLevelMapItem"]};yi.InFreeScroll=["InFreeScroll",0],yi.InFreeScroll.toString=i,(yi.InFreeScroll.__enum__=yi).InMapScroll=["InMapScroll",1],yi.InMapScroll.toString=i,(yi.InMapScroll.__enum__=yi).InRewardSelection=["InRewardSelection",2],yi.InRewardSelection.toString=i,(yi.InRewardSelection.__enum__=yi).InAchievementShow=["InAchievementShow",3],yi.InAchievementShow.toString=i,(yi.InAchievementShow.__enum__=yi).InCarBuyShow=["InCarBuyShow",4],yi.InCarBuyShow.toString=i,(yi.InCarBuyShow.__enum__=yi).InLevelMapItem=["InLevelMapItem",5],yi.InLevelMapItem.toString=i,(yi.InLevelMapItem.__enum__=yi).__empty_constructs__=[yi.InFreeScroll,yi.InMapScroll,yi.InRewardSelection,yi.InAchievementShow,yi.InCarBuyShow,yi.InLevelMapItem];var xi=function(){this.current_rewarded_ad_menu=null,this.initial_chest_count=0,this.in_ad=!1,this.level_map_next_level_save=null,this.achievements=[],this.chests=[],this.trigger_game_save=!1,this.closest_click=null,this.closest_down=null,this.animate_forward_button_time=0,this.animate_forward_button=!1,this.animate_forward_wait_time=-1,this.scroll_help_wait_time_stamp=-1,this.auto_scrolled_from_tresure_chests=!1,this.camera_smooth_steps_init_current_time=0,this.map_zoom_wait_current_time=0,this.map_max_place=null,this.map_min_place=null,this.map_place=null,this.places=[],this.dragging=!1,this.downed=!1,this.scroll_border=null,this.scroll_target=new ea(0,0),this.scroll_start_place=null,this.current_speed=0,this.seconds_before=0,this.down_point=new ea(0,0),this.down_menu_camera_position=new ea(0,0),this.skipped_initial_locations=!1,this.scrolled_to_debug_location=!1,this.state=yi.InFreeScroll};(n["bikas.game.InterLevelMenu"]=xi).__name__=["bikas","game","InterLevelMenu"],xi.prototype={state:null,stage_group:null,scrolled_to_debug_location:null,skipped_initial_locations:null,down_menu_camera_position:null,down_point:null,seconds_before:null,current_speed:null,scroll_start_place:null,scroll_target:null,scroll_border:null,downed:null,dragging:null,places:null,nearest_place:null,map_place:null,map_min_place:null,map_max_place:null,map_zoom_wait_current_time:null,camera_smooth_steps_init_current_time:null,auto_scrolled_from_tresure_chests:null,scroll_help_wait_time_stamp:null,animate_forward_wait_time:null,animate_forward_button:null,animate_forward_button_time:null,closest_down:null,closest_click:null,forward_button:null,backward_button:null,trigger_game_save:null,chests:null,available_descs:null,reward_display:null,achievements:null,upgrade_display:null,car_shop:null,level_map:null,level_map_next_level_save:null,in_ad:null,initial_chest_count:null,current_rewarded_ad_menu:null,__class__:xi};var zi=function(){};(n["bikas.game.InterLevelMenuDo"]=zi).__name__=["bikas","game","InterLevelMenuDo"],zi.create=function(e,t,n,i,r,a,l,o,_){var u=new xi;u.initial_chest_count=e.chests,u.stage_group=t,u.available_descs=a.slice();var h=function(e,t,n,i,r,a){null==a&&(a=""),null==r&&(r="");var s=Vn.findMarker(e,t);if(null==s&&(Nl.trace("warning: marker == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"create"}),1))return null;var l=new bi;return l.marker=s,l.current_zoom=n,l.zoom_min=n,l.zoom_max=i,l.normal_texture=Hs.getTexture(r),l.dark_texture=Hs.getTexture(a),l.button=qa.createSprite(l.normal_texture,0,0),l};u.places.push(h(_,xi.place_treasure,1,1,"scroll_treasure","scroll_treasure_with_background")),u.places.push(h(_,xi.place_achievements,.8,.8,"scroll_trophies","scroll_trophies_with_background")),u.places.push(h(_,xi.place_upgrades,1,1,"scroll_upgrades","scroll_upgrades_with_background")),u.places.push(h(_,xi.place_shop,1,.75,"scroll_shop","scroll_shop_with_background")),u.places.push(h(_,xi.place_map,1.25,1,"scroll_map","scroll_map_with_background")),u.scroll_border=qa.createSpriteByName("scroll_border",0,0),xi.forward_button_arrow=Hs.getTexture("next_button"),xi.forward_button_go=Hs.getTexture("button_go_circle"),u.forward_button=qa.createSpriteByName("next_button",.5,.5),u.backward_button=qa.createSpriteByName("next_button",.5,.5),u.forward_button.scale.x=1,u.backward_button.scale.x=-1,Jn.chest_closed_texture=Hs.getTexture("treasure_chest_closed"),Jn.chest_opened_texture=Hs.getTexture("treasure_chest_opened");var c=function(e,t,n,i,r){for(var a=0,s=t.group.entities;a<s.length;){var l=s[a];if(++a,l.name==n){for(var o=0;o<i.length;){var _=i[o];if(++o,_.type==r){var u=new ti;return u.entity=l,u.desc=_,void e.achievements.push(u)}}return void Nl.trace("warning: couldn't find "+p.string(r),{fileName:"InterLevelMenuDo.hx",lineNumber:170,className:"bikas.game.InterLevelMenuDo",methodName:"create"})}}Nl.trace("warning: couldn't find "+n,{fileName:"InterLevelMenuDo.hx",lineNumber:174,className:"bikas.game.InterLevelMenuDo",methodName:"create"})};c(u,t,"achievement_level_1_place_1",l,Lr.Finish2Levels),c(u,t,"achievement_level_1_place_2",l,Lr.Finish6Levels),c(u,t,"achievement_level_1_place_3",l,Lr.Stunt3xFrontFlip),c(u,t,"achievement_level_1_place_4",l,Lr.Stunt3xCombo),c(u,t,"achievement_level_2_place_1",l,Lr.Finish10LevelsWith100Score),c(u,t,"achievement_level_2_place_2",l,Lr.Stunt10BackFlipsInALevel),c(u,t,"achievement_level_2_place_3",l,Lr.Stunt100Flips),c(u,t,"achievement_level_3_place_1",l,Lr.Finish20Levels1st),c(u,t,"achievement_level_3_place_2",l,Lr.Stunt10xCombo),c(u,t,"achievement_level_4_place_1",l,Lr.Finish30LevelsWith100Score);var d,m,f,g,v,b,y,x=u.upgrade_display=new ri;if(x.prefab_entity=zi.findPrefabEntityByName("car_upgrades",t),x.points_background_entity=zi.findEntityByName("car_upgrades_point_background",t),x.points_text=qa.createBitmapText(fn.tw_cen_mt_condensed_extra_bold_dark_29,42,"left","TEXT"),x.points_text.anchor.x=.5,x.points_text.anchor.y=.5,x.additional_sprites_added=!1,x.points_text.x=x.points_background_entity.position.x,x.points_text.y=x.points_background_entity.position.y,x.car_location=zi.findEntityByName("upgrades_car_location",t),null!=x.prefab_entity)for(var z=x.units,w=x.prefab_entity,k=1,S=0,C=i.upgrade_costs;S<C.length;){var N=C[S];++S,d=z,m=t,f=w,g=k,v=N.name,b=N.costs,y=void 0,(y=new ii).name=v,y.upgrade_point_costs=b,y.unfilled_entity=zi.findEntityByName("car_upgrades_unfilled_"+v,f),y.fill_start_position=new ea,y.fill_start_position.x=-y.unfilled_entity.display.sprite.width/2,y.fill_start_position.y=-y.unfilled_entity.display.sprite.height/2,y.plus_entity=zi.findEntityByName("car_upgrades_plus_"+v,f),y.plus_init_pos=ma.copyPoint(y.plus_entity.position),y.plus_points_background_entity=zi.findEntityByName("car_upgrades_plus_points_background"+g,m),y.plus_points_text=qa.createBitmapText(fn.tw_cen_mt_condensed_extra_bold_dark_29,36,"left","TEXT"),y.plus_points_text.anchor.x=.5,y.plus_points_text.anchor.y=.5,y.plus_points_text.position.x=y.plus_points_background_entity.position.x,y.plus_points_text.position.y=y.plus_points_background_entity.position.y,y.filled=[],d.push(y),++k}li.buy_texture=Hs.getTexture("button_buy"),li.select_texture=Hs.getTexture("button_select"),u.car_shop=new ui;var P=function(e,t,n,i,r){var a=zi.findEntityByName("name_tag_"+i,t);if(null!=a||(Nl.trace("warning: name_tag_entity == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"create"}),0)){var s=zi.findEntityByName(i+"_full",t);if(null!=s||(Nl.trace("warning: car_entity == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"create"}),0)){var l=new pi;l.car_name=i,l.car_shop_name=r,l.car_entity=s,l.car_sprite=s.display.sprite,l.regular_texture=l.car_sprite.texture,Hs.doesTextureExist(l.car_name+"_locked")&&(l.locked_texture=Hs.getTexture(l.car_name+"_locked")),l.name_tag_entity=a;for(var o=0;o<n.length;){var _=n[o];if(++o,_.name==i){l.car_setting=_;break}}null==l.car_setting&&Nl.trace("warning: car "+i+" has no car_setting",{fileName:"InterLevelMenuDo.hx",lineNumber:304,className:"bikas.game.InterLevelMenuDo",methodName:"create"}),l.name_tag_text=qa.createBitmapText(fn.bell_gothic_std_black_very_light_26,24,"left","TEXT"),l.name_tag_text.anchor.set(.5,.5),l.name_tag_coin=qa.createSpriteByName("coin_pick",.5,.5),l.name_tag_coin.scale.x=.75,l.name_tag_coin.scale.y=.75,l.additional_sprites_added=!1,l.name_tag_text.position.x=l.name_tag_entity.position.x+10,l.name_tag_text.position.y=l.name_tag_entity.position.y,l.name_tag_coin.position.x=l.name_tag_entity.position.x,l.name_tag_coin.position.y=l.name_tag_entity.position.y,l.name_tag_entity.display.sprite.alpha=0,e.car_shop.cars.push(l)}}};P(u,t,r,"car_rudolf","Rudolf"),P(u,t,r,"car_bus","Folksgarden"),P(u,t,r,"car_farm_truck","Chickenship"),P(u,t,r,"car_semioval","Semioval"),P(u,t,r,"car_tourcycle","Tourcycle"),P(u,t,r,"car_ice_cream_truck","Coldwagon"),P(u,t,r,"car_bug","Bug"),P(u,t,r,"car_coyote","Coyote"),P(u,t,r,"car_cow","Cow"),P(u,t,r,"car_rider","Swordsman"),P(u,t,r,"car_taxi","Carrier"),di.map_item_empty=Hs.getTexture("map_item_empty"),di.map_item_empty_big=Hs.getTexture("map_item_empty_big"),di.map_item_finished=Hs.getTexture("map_item_finished"),di.map_item_finished100=Hs.getTexture("map_item_finished100"),di.map_item_not_available=Hs.getTexture("map_item_not_available"),di.map_item_challenge_locked=Hs.getTexture("map_item_challenge_locked"),di.map_item_challenge_unlocked=Hs.getTexture("map_item_challenge_unlocked"),di.map_item_challenge_completed=Hs.getTexture("map_item_challenge_completed"),u.level_map=new mi;for(var M=null,I=[],T=0,A=t.group.entities;T<A.length;){var D=A[T];++T,"level1"==D.name?M=D:"level"==D.name&&I.push(D)}var E=[],O=M;for(E.push(O);0<I.length;){for(var B=I[0],L=-1,j=0;j<I.length;){var F=I[j];++j;var R=ma.distance(O.position.x,O.position.y,F.position.x,F.position.y);(-1==L||R<L)&&(B=F,L=R)}s.remove(I,O=B),E.push(O)}for(var G=0,Z=null,U=0;U<E.length;){var V=E[U];++U;var q=new di;q.entity=V,q.sprite=V.display.sprite,q.selected_circle=qa.createSpriteByName("white_circle",.5,.5),q.selected_circle.position.x=q.entity.position.x,q.selected_circle.position.y=q.entity.position.y,q.selected_circle.width=2*q.sprite.width,q.selected_circle.height=2*q.sprite.height;for(var W=0,X=0;X<n.length;){var H=n[X];++X,H.description.level_number-1==G&&(q.level_save_index=W),++W}u.level_map.levels.push(q),q.previous_level=Z,Z=q,++G}for(var Y=0,J=0;J<n.length;){var K=n[J];if(++J,K.description.type==wr.LevelChallenge)for(var Q=0,$=t.group.entities;Q<$.length;){var ee=$[Q];if(++Q,ee.name==K.description.name){var te=new di;te.level_save_index=Y;for(var ne=0;ne<o.length;){var ie=o[ne];if(++ne,ie.type==K.description.challenge_type){te.challenge_desc=ie;break}}null==te.challenge_desc&&Nl.trace("warning: item.challenge_desc == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"create"}),te.entity=ee,te.sprite=ee.display.sprite,te.selected_circle=qa.createSpriteByName("white_circle",.5,.5),te.selected_circle.position.x=te.entity.position.x,te.selected_circle.position.y=te.entity.position.y,te.selected_circle.width=2*te.sprite.width,te.selected_circle.height=2*te.sprite.height,u.level_map.levels.push(te);break}}++Y}return u},zi.tryToAddSpriteAfterThisDisplayObject=function(e,t,n,i,r,a,s){if(null==e||null==t)return null;var l=0,o=-1;if(null!=n){for(var _=0,p=t.all;_<p.length;){var u=p[_];if(++_,u.display_object==n){o=l;break}++l}-1==o&&Nl.trace("warning: could not find index",{fileName:"InterLevelMenuDo.hx",lineNumber:479,className:"bikas.game.InterLevelMenuDo",methodName:"tryToAddSpriteAfterThisDisplayObject"})}var h=ma.clampInt(o+i,-1,t.all.length);return Fa.insertNewObjectToLiveTree(e,t,r,a,s,h)},zi.moveInterLevelMenuCamera=function(e,t){e.places[0],e.places[e.places.length-1];var n=e.scroll_target.x,i=e.nearest_place,r=0,a=n-i.marker.position.x;r=Math.abs(a)<=xi.snap_distance?0<t?e.places.indexOf(i)+1:e.places.indexOf(i)-1:0<t?a<=0?e.places.indexOf(i):e.places.indexOf(i)+1:a<=0?e.places.indexOf(i)-1:e.places.indexOf(i),r=ma.clampInt(r,0,e.places.length-1);var s=e.places[r];e.scroll_target.x=s.marker.position.x},zi.findInterLevelMenuNearestPlace=function(e){for(var t=e.scroll_target.x,n=e.places[0],i=0,r=e.places;i<r.length;){var a=r[i];++i,Math.abs(t-a.marker.position.x)<=Math.abs(t-n.marker.position.x)&&(n=a)}return n},zi.findPlaceByName=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.marker.name==t)return i}return null},zi.findPrefabEntityByName=function(e,t){for(var n=0,i=t.group.entities;n<i.length;){var r=i[n];if(++n,null!=r.prefab&&r.prefab.prefab_name==e)return r}return Nl.trace("warning: couldn't find "+e,{fileName:"InterLevelMenuDo.hx",lineNumber:559,className:"bikas.game.InterLevelMenuDo",methodName:"findPrefabEntityByName"}),null},zi.findEntityByName=function(e,t){for(var n=0,i=t.group.entities;n<i.length;){var r=i[n];if(++n,r.name==e)return r}return Nl.trace("warning: couldn't find "+e,{fileName:"InterLevelMenuDo.hx",lineNumber:569,className:"bikas.game.InterLevelMenuDo",methodName:"findEntityByName"}),null},zi.moveToIndex=function(e,t){return e!=t&&(-1==e?e=t:Math.abs(e-t)<.1?e=t:e<t?e+=.1:e-=.1),e},zi.isRectangularButtonDowned=function(e,t,n,i){if(null==n)return!1;if(!n.visible)return!1;if(0==n.alpha)return!1;var r=t.position.x+n.position.x-n.width*n.anchor.x-i/2,a=t.position.y+n.position.y-n.height*n.anchor.y-i/2,s=n.width*t.scale.x+i,l=n.height*t.scale.y+i;return!!$a.isPointerObjectDownedRect(e,r,a,s,l)},zi.createConfirmationCard=function(e,t){var n=new hi;return n.container=qa.createGroup(),n.background=qa.createSpriteByName("map_card_background",0,0),n.bitmap_text=qa.createBitmapText(fn.bell_gothic_std_black_dark_26,32,"center","TEXT"),n.text_background=qa.createSpriteByName("map_card_text_background"),n.button_main=qa.createSpriteByName(e,.5,.5),n.button_close=qa.createSpriteByName("button_close"),n.text_background.anchor.x=.5,n.text_background.anchor.y=.5,n.text_background.position.x=n.background.width/2,n.text_background.position.y=100,n.bitmap_text.anchor.x=.5,n.bitmap_text.anchor.y=.5,n.bitmap_text.position.x=.5*n.background.width,n.bitmap_text.position.y=n.text_background.position.y,n.bitmap_text.text=t,n.button_main.position.x=n.background.width/2,n.button_main.position.y=n.background.height-n.button_main.height/2-35,n.button_close.anchor.x=xi.close_button_anchor_x,n.button_close.anchor.y=xi.close_button_anchor_y,n.button_close.position.x=n.background.width,n.button_close.position.y=0,n.container.add(n.background),n.container.add(n.text_background),n.container.add(n.bitmap_text),n.container.add(n.button_main),n.container.add(n.button_close),n},zi.processCardClick=function(e,t,n,i,r,a){null==a&&(a=!0);var s=$a.getPointerDowned(e);if(null==s)return gi.None;if(s.cancel_upped_and_clicked)return gi.None;if(null!=i){var l=n.position.x+i.position.x,o=n.position.y+i.position.y,_=i.width/2*n.scale.x+xi.finger_radius/2;if($a.isPointerObjectDowned(l,o,s,_))return s.cancel_upped_and_clicked=!0,null!=n.parent&&n.parent.removeChild(n),Ms.playSound(Gs.sound_click,t),gi.DownedCloseButton}if(null!=r&&(n.position.x,r.position.x,r.width,xi.finger_radius,n.position.y,r.position.y,r.height,xi.finger_radius,r.width,n.scale.x,xi.finger_radius,r.height,n.scale.y,xi.finger_radius,zi.isRectangularButtonDowned(s,n,r,xi.finger_radius)))return s.cancel_upped_and_clicked=!0,r.visible&&1==r.alpha&&Ms.playSound(Gs.sound_click,t),gi.DownedMainButton;var p=n.position.x,u=n.position.y,h=p+n.width,c=u+n.height;return ma.pointInBoundedArea(s.current,p,u,h,c)?(s.cancel_upped_and_clicked=!0,gi.DownedInside):(a&&(s.cancel_upped_and_clicked=!0,null!=n.parent&&n.parent.removeChild(n)),gi.DownedOutside)},zi.processClosestObject=function(e,t,n,i,r,a,s,l,o,_,p,u){null==n&&(n=-1),null==t&&(t=-1),-1!=n&&t<=n&&(-1==e.distance||t<e.distance)&&(e.distance=t,e.entity=i,e.chest=r,e.achievement=a,e.upgrade_unit=s,e.car_in_shop=l,e.level_map_item=o,e.place=_,e.forward_button=p,e.backward_button=u)},zi.getClosestObjectToPointer=function(e,t){var n=new PIXI.Point(t.x,t.y),i=e.stage_group.group.container.toLocal(n,e.stage_group.group.container.parent),r=(xi.finger_radius,e.stage_group.group.container.scale.x,new vi);if(null!=e.forward_button){var a=ma.distance(t.x,t.y,e.forward_button.position.x,e.forward_button.position.y),s=e.forward_button.width/2;if(-1!=s&&a<=s)return r.distance=a,r.forward_button=e.forward_button,r}if(null!=e.backward_button){var l=ma.distance(t.x,t.y,e.backward_button.position.x,e.backward_button.position.y),o=Math.abs(e.backward_button.width/2);if(-1!=o&&l<=o)return r.distance=l,r.backward_button=e.backward_button,r}for(var _=0,p=e.stage_group.group.entities;_<p.length;){var u=p[_];if(++_,"some_entity_name_example"==u.name){var h=ma.distance(i.x,i.y,u.position.x,u.position.y),c=u.display.sprite.width/2;zi.processClosestObject(r,h,c,u)}}for(var d=0,m=e.chests;d<m.length;){var f=m[d];++d;var g=ma.distance(i.x,i.y,f.chest.x,f.chest.y),v=f.chest.width/2+xi.finger_radius/2;zi.processClosestObject(r,g,v,null,f)}for(var b=0,y=e.achievements;b<y.length;){var x=y[b];++b;var z=ma.distance(i.x,i.y,x.entity.position.x,x.entity.position.y),w=x.entity.display.sprite.width/2+xi.finger_radius/2,k=x.entity.display.sprite.height/2+xi.finger_radius/2;zi.processClosestObject(r,z,ma.max(w,k),null,null,x)}for(var S=0,C=e.upgrade_display.units;S<C.length;){var N=C[S];++S;var P=ma.distance(i.x,i.y,N.plus_entity.position.x,N.plus_entity.position.y),M=N.plus_entity.display.sprite.width/2+xi.finger_radius/2;zi.processClosestObject(r,P,M,null,null,null,N)}for(var I=0,T=e.car_shop.cars;I<T.length;){var A=T[I];++I;var D=ma.distance(i.x,i.y,A.car_entity.position.x,A.car_entity.position.y),E=A.car_entity.display.sprite.width/2+xi.finger_radius/2;zi.processClosestObject(r,D,E,null,null,null,null,A)}for(var O=0,B=e.level_map.levels;O<B.length;){var L=B[O];++O;var j=ma.distance(i.x,i.y,L.entity.position.x,L.entity.position.y),F=L.entity.display.sprite.width/2+xi.finger_radius/2;zi.processClosestObject(r,j,F,null,null,null,null,null,L)}for(var R=0,G=e.places;R<G.length;){var Z=G[R];++R;var U=Z.button.position.x-xi.finger_radius/2,V=Z.button.position.y-xi.finger_radius/2,q=U+Z.button.width+xi.finger_radius,W=V+Z.button.height+xi.finger_radius,X=(U+q)/2,H=(V+W)/2;if(ma.pointInBoundedArea(t,U,V,q,W)){var Y=ma.distance(t.x,t.y,X,H),J=Y+1;zi.processClosestObject(r,Y,J,null,null,null,null,null,null,Z)}}return 0<=r.distance?r:null},zi.updateAnimateNextTrigger=function(e,t,n){Math.abs(e.nearest_place.marker.position.x-e.scroll_target.x)<25?(-1==e.animate_forward_wait_time&&(e.animate_forward_wait_time=0),e.animate_forward_wait_time+=t.step_size,e.animate_forward_wait_time>n&&(e.animate_forward_button=!0)):e.animate_forward_wait_time=-1},zi.createRewardedAdMenu=function(e,t,n,i,r){Ms.playSound(Gs.sound_coin,r);var a=new fi;return a.ad=new xr,a.ad.levels_completed=Pr.getTotalRegularLevelsCompleted(t),a.ad.type=0,t.rewarded_ads.push(a.ad),a.reward_ad_type=i,a.show_time_stamp=Ma.getTimer(),a.text="",2==a.reward_ad_type?a.text="Watch an ad\nto get 3 chests!":1==a.reward_ad_type?a.text="Watch an ad\nto get 50 coins!":Nl.trace("warning: unhandled ad.type "+a.ad.type,{fileName:"InterLevelMenuDo.hx",lineNumber:893,className:"bikas.game.InterLevelMenuDo",methodName:"createRewardedAdMenu"}),a.confirm_card=zi.createConfirmationCard("button_watch",a.text+" (60)"),n.add(a.confirm_card.container),e.trigger_game_save=!0,a},zi.destroyRewardedAdMenu=function(e){null!=e.confirm_card&&(zi.destroyConfirmationCard(e.confirm_card),e.ad=null,e.confirm_card=null,e.closed=!0)},zi.clickChest=function(e,t){t.state=Yn.Opened,e.state=yi.InRewardSelection;var n=t.chest.toGlobal(new PIXI.Point(0,0)),i=e.stage_group.group.container.parent.toLocal(n);e.reward_display=new Qn,e.reward_display.reward_selection=null,e.reward_display.chest_position=new ea(i.x,i.y),e.reward_display.chest=t},zi.clickRewardCard=function(e,t,n,i,r,a,l,o){r.chests--,zi.destroyChest(e,n.chest),s.remove(t.chests,n.chest),n.chest=null,n.chest_position=null,n.selected_card=i,n.selected_card_start_scale=n.selected_card.container.scale.x,n.state=Kn.RewardAnimateOut,n.current_time=0,Pr.applyRewardItem(r,a,n.selected_card.item,l),Ms.playSound(Gs.sound_reward_select,o),t.trigger_game_save=!0},zi.clickUpgrade=function(e,t,n,i,r){"top_speed"==t?i.car_upgrades.top_speed++:"acceleration"==t?i.car_upgrades.acceleration++:"handling"==t?i.car_upgrades.handling++:"armor"==t&&i.car_upgrades.armor++,i.upgrade_points-=n,Ms.playSound(Gs.sound_upgrade,r,.6),e.trigger_game_save=!0},zi.clickAchievement=function(e,t,n,i,r,a,s){-1!=n.achievements_completed.indexOf(t.desc.id)&&-1==n.achievements_claimed.indexOf(t.desc.id)&&(n.achievements_claimed.push(t.desc.id),t.desc.item.desc.type==Mr.AchievementLevel?e.level_map_next_level_save=a:Pr.applyRewardItem(n,i,t.desc.item,r),Ms.playSound(Gs.sound_achievement_claimed,s),e.trigger_game_save=!0)},zi.clickLevel=function(e,t,n){e.state=yi.InFreeScroll,e.level_map_next_level_save=t,Ms.playSound(Gs.sound_level_select,n)},zi.createRequirementAndRewardCard=function(e,t,n,i,r,a,s,l,o,_,p,u,h,c,d,m,f){null==m&&(m=""),null==d&&(d="Reward"),null==c&&(c=""),null==h&&(h="."),null==u&&(u="Requirement");var g=new $n;g.container=qa.createGroup(),g.background=qa.createSpriteByName(e,0,0),g.close_button=qa.createSpriteByName("button_close"),null!=t&&(g.icon=qa.createSpriteByName(t)),null!=n&&(g.main_button=qa.createSpriteByName(n)),g.name_text=qa.createBitmapText(fn.bell_gothic_std_black_dark_26,32,"center","TEXT"),g.requirement_text=qa.createBitmapText(fn.avantgarde_lt_medium_dark_26,26,"left","TEXT"),g.reward_text=qa.createBitmapText(fn.avantgarde_lt_medium_dark_26,26,"left","TEXT"),g.requirement_highlight=qa.createSpriteByName("color_bar_yellow"),g.reward_highlight=qa.createSpriteByName("color_bar_orange"),g.name_text.text=_,g.name_text.maxWidth=p,g.requirement_text.text=u+": ";var v=g.requirement_text.width,b=g.requirement_text.height+4;g.requirement_text.text+=c+h,g.reward_text.text=d+": ";var y=g.reward_text.width,x=g.reward_text.height+4;return g.reward_text.text+=m,g.close_button.anchor.x=xi.close_button_anchor_x,g.close_button.anchor.y=xi.close_button_anchor_y,g.close_button.position.x=g.background.width,g.close_button.position.y=0,null!=g.icon&&(g.icon.anchor.x=.5,g.icon.anchor.y=.5,g.icon.scale.x=1,g.icon.scale.y=1,null!=r&&(g.icon.position.x=r.x,g.icon.position.y=r.y)),null!=g.main_button&&(g.main_button.anchor.x=.5,g.main_button.anchor.y=.5,g.main_button.alpha=null!=i?i?1:xi.main_button_deactivated_alpha:1,null!=o&&(g.main_button.position.x=o.x,g.main_button.position.y=o.y)),g.name_text.anchor.x=.5,g.name_text.anchor.y=.5,g.name_text.position.x=a.x,g.name_text.position.y=a.y,g.requirement_highlight.width=v,g.requirement_highlight.height=b,g.requirement_highlight.anchor.x=g.requirement_text.anchor.x=0,g.requirement_highlight.anchor.y=g.requirement_text.anchor.y=0,g.requirement_highlight.position.x=g.requirement_text.position.x=s.x,g.requirement_highlight.position.y=g.requirement_text.position.y=s.y,g.requirement_text.maxWidth=f,g.reward_highlight.width=y,g.reward_highlight.height=x,g.reward_highlight.anchor.x=g.reward_text.anchor.x=0,g.reward_highlight.anchor.y=g.reward_text.anchor.y=0,g.reward_highlight.position.x=g.reward_text.position.x=l.x,g.reward_highlight.position.y=g.reward_text.position.y=l.y,g.reward_text.maxWidth=f,g.container.add(g.background),g.container.add(g.close_button),null!=g.icon&&g.container.add(g.icon),g.container.add(g.name_text),g.container.add(g.requirement_highlight),g.container.add(g.requirement_text),g.container.add(g.reward_highlight),g.container.add(g.reward_text),null!=g.main_button&&g.container.add(g.main_button),g},zi.destroyEntity=function(e,t,n){null!=e.body&&(s.remove(n,e),null!=e.body.get_space()&&e.body.set_space(null));for(var i=null,r=0,a=t.all_objects;r<a.length;){var l=a[r];++r,l.display_object==e.display.sprite&&(i=l)}null!=i&&Fa.destroyLiveObject(t,i,!1),oe.removeEntity(e),ie.destroyEntityIncludingChildren(e)},zi.destroyChest=function(e,t){Fa.destroyLiveObject(e,t.chest_partition_object,!0),t.chest_partition_object=null,t.chest=null},zi.destroyRewardDisplay=function(e){null!=e.reward_selection&&Vr.destroyRewardSelection(e.reward_selection),e.reward_selection=null,e.chest=null,e.chest_position=null,e.selected_card=null},zi.destroyAchievement=function(e){null!=e.card&&(zi.destroyRequirementAndRewardCard(e.card),e.card=null),null!=e.white_circle&&(e.white_circle.destroy(!0),e.white_circle=null)},zi.destroyUpgradeDisplay=function(e){for(var t=0,n=e.units;t<n.length;){var i=n[t];++t;for(var r=0,a=i.filled;r<a.length;){var s=a[r];++r,s.display_object.destroy(!0)}i.plus_points_text.destroy(!0),i.plus_points_text=null,i.unfilled_entity=null,i.fill_start_position=null,i.plus_entity=null,i.plus_init_pos=null,i.filled=null}e.prefab_entity=null,e.units=null},zi.destroyRequirementAndRewardCard=function(e){e.background.destroy(!0),e.close_button.destroy(!0),null!=e.icon&&(e.icon.destroy(!0),e.icon=null),null!=e.main_button&&(e.main_button.destroy(!0),e.main_button=null),e.name_text.destroy(!0),e.requirement_text.destroy(!0),e.reward_text.destroy(!0),e.requirement_highlight.destroy(!0),e.reward_highlight.destroy(!0),e.container.destroy(!0),e.background=null,e.close_button=null,e.icon=null,e.name_text=null,e.requirement_text=null,e.reward_text=null,e.requirement_highlight=null,e.reward_highlight=null,e.container=null},zi.destroyCarCard=function(e){for(var t=0,n=e.metrics;t<n.length;){var i=n[t];++t,i.background_bar.destroy(!0),i.foreground_bar.destroy(!0),i.text.destroy(!0),null!=i.green_or_red_bar&&i.green_or_red_bar.destroy(!0),i.container.destroy(!0),i.background_bar=null,i.foreground_bar=null,i.green_or_red_bar=null,i.text=null,i.container=null}e.metrics=null,e.background.destroy(!0),e.close_button.destroy(!0),e.main_button.destroy(!0),e.coin.destroy(!0),e.text.destroy(!0),e.background=null,e.close_button=null,e.main_button=null,e.coin=null,e.text=null,e.container.destroy(!0),e.container=null},zi.destroyCarInShop=function(e){e.name_tag_coin.destroy(!0),e.name_tag_text.destroy(!0),e.name_tag_coin=null,e.name_tag_text=null,e.name_tag_entity=null,(e.car_entity=null)!=e.card&&(zi.destroyCarCard(e.card),e.card=null)},zi.destroyConfirmationCard=function(e){e.background.destroy(!0),e.button_close.destroy(!0),e.button_main.destroy(!0),e.bitmap_text.destroy(!0),null!=e.container.parent&&e.container.parent.removeChild(e.container),e.container.destroy(!0),e.background=null,e.button_close=null,e.button_main=null,e.bitmap_text=null,e.container=null},zi.destroyLevelMapItem=function(e){e.entity=null,e.sprite=null,e.selected_circle.destroy(!0),null!=e.level_card&&(zi.destroyConfirmationCard(e.level_card),e.level_card=null),null!=e.challenge_card&&(zi.destroyRequirementAndRewardCard(e.challenge_card),e.challenge_card=null)},zi.destroyLevelMap=function(e){for(var t=0,n=e.levels;t<n.length;){var i=n[t];++t,zi.destroyLevelMapItem(i)}e.map_entity=null,e.levels=null},zi.destroy=function(e,t){if(null!=e.forward_button.parent&&(e.backward_button.parent.removeChild(e.backward_button),e.forward_button.parent.removeChild(e.forward_button)),null!=e.forward_button&&(e.backward_button.destroy(!0),e.forward_button.destroy(!0),e.backward_button=null,e.forward_button=null),null!=e.reward_display&&(zi.destroyRewardDisplay(e.reward_display),e.reward_display=null),null!=e.chests){for(var n=0,i=e.chests;n<i.length;){var r=i[n];++n,zi.destroyChest(t,r)}e.chests=null}if(null!=e.achievements){for(var a=0,s=e.achievements;a<s.length;){var l=s[a];++a,zi.destroyAchievement(l)}e.achievements=null}if(null!=e.upgrade_display&&(zi.destroyUpgradeDisplay(e.upgrade_display),e.upgrade_display.points_text.destroy(!0),e.upgrade_display.points_text=null,e.upgrade_display=null),null!=e.car_shop){for(var o=0,_=e.car_shop.cars;o<_.length;){var p=_[o];++o,zi.destroyCarInShop(p)}e.car_shop=null}if(null!=e.level_map&&(zi.destroyLevelMap(e.level_map),e.level_map=null),null!=e.places){for(var u=0,h=e.places;u<h.length;){var c=h[u];++u,c.button.destroy(!0)}e.places=null}null!=e.scroll_border&&(e.scroll_border.destroy(!0),e.scroll_border=null),null!=e.current_rewarded_ad_menu&&(zi.destroyRewardedAdMenu(e.current_rewarded_ad_menu),e.current_rewarded_ad_menu=null),e.down_menu_camera_position=null,e.down_point=null,e.scroll_target=null,e.stage_group=null,e.closest_click=null,e.available_descs=null},zi.update=function(e){var t=e.inter_level_menu;if(!t.in_ad){if(t.camera_smooth_steps_init_current_time<=xi.camera_smooth_steps_init_time){t.camera_smooth_steps_init_current_time+=e.step.step_size;var n=ma.clamp0to1(t.camera_smooth_steps_init_current_time/xi.camera_smooth_steps_init_time);e.camera.smooth_steps=va.linear(xi.camera_smooth_steps_init,xi.camera_smooth_steps,n)}var i=Gs.music_beach_waves;null!=i&&(Ms.isMusicPlaying(i)||Ms.fadeInMusic(i),Ms.updateMusic(i,e.music_enabled));var r=Gs.music_avocado_easy_times_in_hawaii;null!=r&&(Ms.isMusicPlaying(r)||Ms.fadeInMusic(r),Ms.updateMusic(r,e.music_enabled)),zi.updateScrollButtons(e,t);var a=$a.getPointerDown(e.pointer);zi.updateScrolling(e,t,a),zi.updatePointerInteractions(e,t,a),zi.updateChests(e,t),zi.updateAchievements(e,t),zi.updateUpgrades(e,t),zi.updateCarShop(e,t),zi.updateLevelMap(e,t),zi.updateRewardCardSelection(e,t),t.state==yi.InFreeScroll&&1==$s.config.type&&3==$s.config.release.sitelock_type&&zi.updateRewardedAds(t,e.menu_container,e.js_info,e.pointer,e.game_save,e.sounds_enabled)}},zi.updateScrollButtons=function(e,t){if(null!=t.places){if(null==t.forward_button.parent&&(e.menu_container.addAt(t.backward_button,0),e.menu_container.addAt(t.forward_button,0)),t.animate_forward_button){t.forward_button.texture!=xi.forward_button_go&&t.forward_button.setTexture(xi.forward_button_go),t.animate_forward_button_time+=e.step.step_size;var n=ma.clamp0to1(t.animate_forward_button_time/.6),i=va.smoothForwardAndBackward(.8,1.1,n);t.forward_button.scale.x=i,t.forward_button.scale.y=i,1==n&&(t.animate_forward_button_time=0)}else t.forward_button.texture!=xi.forward_button_arrow&&t.forward_button.setTexture(xi.forward_button_arrow),t.forward_button.scale.x=1,t.forward_button.scale.y=1,t.animate_forward_button_time=0;t.forward_button.position.x=e.js_info.current_game_width-t.forward_button.texture.width/2,t.forward_button.position.y=e.js_info.current_game_height/2,t.backward_button.position.x=t.backward_button.texture.width/2,t.backward_button.position.y=e.js_info.current_game_height/2;var r=t.places.length,a=e.js_info.current_game_width;t.nearest_place=t.places[0];for(var s=0,l=t.places.length;s<l;){var o=s++,_=t.places[o];null==_.button.parent&&e.menu_container.addAt(_.button,0);var p=(o+0)/r,u=va.linear(0,a,p),h=a-(va.linear(0,a,(r-1)/r)+_.button.width);if(_.button.position.x=u+h/2,_.button.position.y=e.js_info.current_game_height-_.button.height-xi.place_button_space,Math.abs(e.camera.current_pos.get_x()-_.marker.position.x)<=Math.abs(e.camera.current_pos.get_x()-t.nearest_place.marker.position.x)&&(t.nearest_place=_),_.zoom_min!=_.zoom_max){var c=e.js_info.current_game_width/e.js_info.current_game_height,d=va.getTClamped(1.7777777777777777,1.3333333333333333,c),m=va.linear(t.nearest_place.zoom_min,t.nearest_place.zoom_max,d);m!=t.nearest_place.current_zoom&&(t.nearest_place.current_zoom=m)}}if(null!=t.scroll_border){null==t.scroll_border.parent&&e.menu_container.addAt(t.scroll_border,e.menu_container.children.length-1);var f,g=t.places.indexOf(t.nearest_place),v=ma.clampInt(g-1,0,t.places.length-1),b=ma.clampInt(g+1,0,t.places.length-1),y=t.places[v].marker.position.x,x=t.nearest_place.marker.position.x,z=t.places[b].marker.position.x,w=t.places[v].button.x,k=t.nearest_place.button.position.x,S=t.places[b].button.x;f=e.camera.current_pos.get_x()<y?0:e.camera.current_pos.get_x()>z?1:va.getTFromABC(y,x,z,e.camera.current_pos.get_x());for(var C=va.linearToABC(w,k,S,.5,f),N=-1.5,P=-1.5,M=0,I=t.places;M<I.length;){var T=I[M];++M,Math.abs(e.camera.current_pos.get_x()-T.marker.position.x)<100?(N=3,P=-6,0==g&&(P=-1),T.button.texture!=T.dark_texture&&T.button.setTexture(T.dark_texture)):T.button.texture!=T.normal_texture&&T.button.setTexture(T.normal_texture)}t.scroll_border.x=C+N,t.scroll_border.y=t.places[0].button.position.y+P,t.forward_button.alpha=g==b?.25:1,t.backward_button.alpha=g==v?.25:1}}},zi.updateScrolling=function(e,t,n){if(""!=xi.init_debug_scroll_location&&!t.scrolled_to_debug_location){var i=zi.findPlaceByName(t.places,xi.init_debug_scroll_location);null!=i&&(t.scroll_target.x=i.marker.position.x),t.scrolled_to_debug_location=!0}if(""==xi.init_debug_scroll_location&&!t.skipped_initial_locations){var r=!(t.skipped_initial_locations=!0);if(""!=e.game_save.previous_level_name)for(var a=0,s=e.game_save.level_saves;a<s.length;){var l=s[a];if(++a,l.description.name==e.game_save.previous_level_name){r=l.description.type==wr.LevelChallenge;break}}if(r)t.scroll_target.x=zi.findPlaceByName(t.places,xi.place_map).marker.position.x;else if(0==e.game_save.chests){t.scroll_target.x=zi.findPlaceByName(t.places,xi.place_achievements).marker.position.x;for(var o=!0,_=0,p=e.game_save.achievements_completed;_<p.length;){var u=p[_];if(++_,-1==e.game_save.achievements_claimed.indexOf(u)){o=!1;break}}o&&(t.scroll_target.x=zi.findPlaceByName(t.places,xi.place_upgrades).marker.position.x,0==e.game_save.upgrade_points&&(t.scroll_target.x=zi.findPlaceByName(t.places,xi.place_shop).marker.position.x))}e.menu_camera_position.x=t.scroll_target.x,e.camera.current_pos.set_x(e.menu_camera_position.x)}null==n?(t.downed=!1,t.dragging=!1):t.downed||(t.downed=!0,wa.set(t.down_point,n.current)),(t.state==yi.InFreeScroll||t.state==yi.InMapScroll)&&t.downed&&!t.dragging&&Math.abs(n.current.x-t.down_point.x)>=xi.start_drag_distance&&(t.dragging=!0,t.seconds_before=e.step.level_seconds,wa.set(t.down_menu_camera_position,e.menu_camera_position),wa.set(t.down_point,n.current),t.scroll_start_place=t.nearest_place);var h=t.places[0].marker.position.x,c=t.places[t.places.length-1].marker.position.x;if(null!=n&&t.dragging){var d=n.current.x-t.down_point.x;t.scroll_target.x=t.down_menu_camera_position.x-d,t.scroll_target.x=ma.clamp(t.scroll_target.x,h-xi.max_scroll_to_sides,c+xi.max_scroll_to_sides);var m=e.step.level_seconds-t.seconds_before;d=ma.clamp(d,-xi.max_distance_for_speed,xi.max_distance_for_speed),t.current_speed=0<m?-d/m*xi.speed_coeff:0,t.current_speed=ma.clamp(t.current_speed,-xi.max_speed,xi.max_speed)}else{if(t.state==yi.InFreeScroll){if(t.animate_forward_button=!1,t.nearest_place.marker.name==xi.place_treasure?(0<t.chests.length&&(t.auto_scrolled_from_tresure_chests=!1),t.auto_scrolled_from_tresure_chests||0==t.chests.length&&0<=t.scroll_help_wait_time_stamp&&1.5<e.step.level_seconds-t.scroll_help_wait_time_stamp&&(Math.abs(t.nearest_place.marker.position.x-e.menu_camera_position.x)<25&&zi.moveInterLevelMenuCamera(t,1),t.scroll_help_wait_time_stamp=-1,t.auto_scrolled_from_tresure_chests=!0)):0==t.chests.length?0==e.game_save.chests&&(t.auto_scrolled_from_tresure_chests=!0):t.auto_scrolled_from_tresure_chests=!1,t.nearest_place.marker.name==xi.place_treasure&&0==t.chests.length&&zi.updateAnimateNextTrigger(t,e.step,1),t.nearest_place.marker.name==xi.place_achievements&&Math.abs(t.nearest_place.marker.position.x-t.scroll_target.x)<25){for(var f=!0,g=0,v=t.achievements;g<v.length;){var b=v[g];if(++g,null!=b.card){f=!1;break}if(null!=b.white_circle){f=!1;break}}f&&zi.updateAnimateNextTrigger(t,e.step,1)}t.nearest_place.marker.name==xi.place_upgrades&&(0==e.game_save.upgrade_points?zi.updateAnimateNextTrigger(t,e.step,1):zi.updateAnimateNextTrigger(t,e.step,5)),t.nearest_place.marker.name==xi.place_shop&&zi.updateAnimateNextTrigger(t,e.step,6)}if(t.scroll_target.x+=t.current_speed,t.current_speed*=xi.speed_decrease_coeff,Math.abs(t.current_speed)<1&&(t.current_speed=0),t.scroll_target.x=ma.clamp(t.scroll_target.x,h,c),Math.abs(t.current_speed)>=xi.speed_for_scroll_threshold&&null!=t.scroll_start_place){var y=t.places.indexOf(t.scroll_start_place);0<t.current_speed?++y:--y,y=ma.clampInt(y,0,t.places.length-1),t.scroll_target.x=t.places[y].marker.position.x,t.scroll_start_place=null,Ms.playSound(Gs.sound_swoosh,e.sounds_enabled)}}if(null!=t.scroll_target)if(e.menu_camera_position.x+=(t.scroll_target.x-e.menu_camera_position.x)*xi.scroll_speed_coeff,e.menu_camera_position.y+=(t.scroll_target.y-e.menu_camera_position.y)*xi.scroll_speed_coeff,t.state==yi.InMapScroll)t.map_zoom_wait_current_time-=e.step.step_size,t.map_zoom_wait_current_time<0&&(t.map_zoom_wait_current_time=0,e.camera.zoom_min=t.map_place.current_zoom,e.camera.zoom_max=t.map_place.current_zoom);else{var x=zi.findInterLevelMenuNearestPlace(t);Math.abs(t.scroll_target.x-x.marker.position.x)<=xi.snap_distance&&(t.scroll_target.x=x.marker.position.x);var z=e.menu_camera_position.x-x.marker.position.x,w=t.places.indexOf(x);z<0?--w:++w,w=ma.clampInt(w,0,t.places.length-1);var k=t.places[w],S=x.current_zoom,C=x.marker.position.y;if(k!=x){var N=va.getT(k.marker.position.x,x.marker.position.x,e.menu_camera_position.x);S=va.linear(k.current_zoom,x.current_zoom,N),C=va.linear(k.marker.position.y,x.marker.position.y,N)}e.camera.zoom_min=S,e.camera.zoom_max=S,t.scroll_target.y=C}},zi.updatePointerInteractions=function(e,t,n){if(!t.dragging&&t.state==yi.InFreeScroll){null!=n?null==t.closest_down&&(t.closest_down=zi.getClosestObjectToPointer(t,n.current)):null!=t.closest_down&&(null!=t.closest_down.upgrade_unit&&t.closest_down.upgrade_unit.state==ni.Downed&&(t.closest_down.upgrade_unit.state=ni.None),t.closest_down=null);var i=$a.getPointerClicked(e.pointer,xi.start_drag_distance);if(null!=i?null==t.closest_click&&(t.closest_click=zi.getClosestObjectToPointer(t,i.current)):t.closest_click=null,null!=t.closest_down&&null!=t.closest_down.upgrade_unit&&(t.closest_down.upgrade_unit.state=ni.Downed),null!=t.closest_click)if(Ms.playSound(Gs.sound_click,e.sounds_enabled),null!=t.closest_click.entity)t.closest_click.entity.name;else if(null!=t.closest_click.chest)t.closest_click.chest.state==Yn.Closed&&zi.clickChest(t,t.closest_click.chest);else if(null!=t.closest_click.achievement){for(var r=0,a=t.achievements;r<a.length;){var s=a[r];++r,s.state=ei.Closed}t.closest_click.achievement.state=ei.Opened,t.state=yi.InAchievementShow}else if(null!=t.closest_click.upgrade_unit)t.closest_click.upgrade_unit.state=ni.Clicked;else if(null!=t.closest_click.car_in_shop)-1==e.game_save.locked_cars.indexOf(t.closest_click.car_in_shop.car_name)&&(t.closest_click.car_in_shop.state=oi.Opened,t.state=yi.InCarBuyShow);else if(null!=t.closest_click.level_map_item){var l=null;if(0<=t.closest_click.level_map_item.level_save_index&&t.closest_click.level_map_item.level_save_index<e.game_save.level_saves.length&&(l=e.game_save.level_saves[t.closest_click.level_map_item.level_save_index]),null!=l){t.closest_click.level_map_item.state=ci.Opened,t.state=yi.InLevelMapItem;var o=t.closest_click.level_map_item.entity.display.sprite.toGlobal(new PIXI.Point(0,0)),_=t.stage_group.group.container.parent.toLocal(o);t.closest_click.level_map_item.click_position.x=_.x,t.closest_click.level_map_item.click_position.y=_.y}else null==l&&Nl.trace("warning: level_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"updatePointerInteractions"})}else null!=t.closest_click.place?(t.scroll_target.x!=t.closest_click.place.marker.position.x&&Ms.playSound(Gs.sound_swoosh,e.sounds_enabled),t.scroll_target.x=t.closest_click.place.marker.position.x):null!=t.closest_click.forward_button?1==t.closest_click.forward_button.alpha&&(zi.moveInterLevelMenuCamera(t,1),t.nearest_place!=t.places[t.places.length-1]&&Ms.playSound(Gs.sound_swoosh,e.sounds_enabled)):null!=t.closest_click.backward_button&&1==t.closest_click.backward_button.alpha&&(zi.moveInterLevelMenuCamera(t,-1),t.nearest_place!=t.places[0]&&Ms.playSound(Gs.sound_swoosh,e.sounds_enabled))}},zi.updateChests=function(e,t){if(0<e.game_save.chests){var n=zi.findPlaceByName(t.places,"treasure").marker.position;if(99999<t.chests.length)return void Nl.trace("warning: something went wrong with chest spwaning",{fileName:"InterLevelMenuDo.hx",lineNumber:2032,className:"bikas.game.InterLevelMenuDo",methodName:"updateChests"});if(t.chests.length<e.game_save.chests)for(var i=t.chests.length,r=e.game_save.chests;i<r;){i++;var a=new Jn;a.chest=qa.createSprite(Jn.chest_closed_texture,.5,.5),a.chest.scale.x=Jn.scale,a.chest.scale.y=Jn.scale,a.current_time=ma.getRandomBetween(0,Jn.floating_time),t.chests.push(a)}for(var s=ma.minInt(t.chests.length,Jn.max_column_count),l=-(s-1)/2*Jn.x_distance,o=0,_=t.chests.length;o<_;){var p=o++,u=t.chests[p];u.additional_sprites_added||(u.chest_partition_object=zi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,null,-1,u.chest,!0),null!=u.chest_partition_object&&(u.additional_sprites_added=!0));var h=p%s,c=Math.floor(p/s);1==u.chest.alpha&&(u.current_time+=e.step.step_size,u.current_time>Jn.floating_time&&(u.current_time-=Jn.floating_time)),u.state==Yn.Closed?u.chest.texture!=Jn.chest_closed_texture&&(u.chest.setTexture(Jn.chest_closed_texture),u.chest.anchor.x=.5,u.chest.anchor.y=.5):u.state==Yn.Opened&&u.chest.texture!=Jn.chest_opened_texture&&(u.chest.setTexture(Jn.chest_opened_texture),u.chest.anchor.x=.5,u.chest.anchor.y=.6,Ms.playSound(Gs.sound_chest_open,e.sounds_enabled,.4));var d=ma.clamp(u.current_time/Jn.floating_time,0,1),m=va.smoothForwardAndBackward(0,Jn.floating_distance,d),f=n.x+h*Jn.x_distance+l,g=n.y-c*Jn.y_distance-Jn.distance_from_ground-m;u.chest.position.x=f,u.chest.position.y=g}}},zi.updateAchievements=function(e,t){for(var n=0,i=t.achievements;n<i.length;){var r=i[n];++n;var a=!1;if(null!=r.white_circle&&null==r.white_circle_partition_object&&(r.white_circle_partition_object=zi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,null,-1,r.white_circle,!0)),-1!=e.game_save.achievements_completed.indexOf(r.desc.id))if(a=!0,-(r.entity.display.sprite.alpha=1)==e.game_save.achievements_claimed.indexOf(r.desc.id)){null==r.white_circle&&(r.white_circle=qa.createSpriteByName("white_circle",.5,.5),r.white_circle.position.x=r.entity.position.x,r.white_circle.position.y=r.entity.position.y),r.white_circle_current_time+=e.step.step_size,r.white_circle_current_time>ti.white_circle_animation_time&&(r.white_circle_current_time-=ti.white_circle_animation_time);var s=r.white_circle_current_time/ti.white_circle_animation_time,l=va.smoothForwardAndBackward(ti.white_circle_min_scale,ti.white_circle_max_scale,s);r.white_circle.scale.x=l,r.white_circle.scale.y=l}else null!=r.white_circle_partition_object&&(Fa.destroyLiveObject(e.partition_top,r.white_circle_partition_object,!0),r.white_circle_partition_object=null,r.white_circle=null);else r.entity.display.sprite.alpha=ti.locked_alpha,null!=r.white_circle_partition_object&&(Fa.destroyLiveObject(e.partition_top,r.white_circle_partition_object,!0),r.white_circle_partition_object=null,r.white_circle=null);if(r.state==ei.Closed)null!=r.card&&(zi.destroyRequirementAndRewardCard(r.card),r.card=null);else if(r.state==ei.Opened){if(null==r.card){var o=".";a&&(o=" (Achieved).");var _=r.card=zi.createRequirementAndRewardCard("achievement_card",r.desc.texture_name,null,null,new ea(256.9,55),new ea(256.9,140.4),new ea(61,218),new ea(61,328),null,r.desc.name,400,"Requirement",o,r.desc.requirement,"Reward",r.desc.item.description_text+".",400);e.menu_container.add(_.container)}var p=r.card;zi.clickAchievement(t,r,e.game_save,e.ongoing_powers_display,e.notifications,e.achievement_save,e.sounds_enabled),p.container.position.x=e.js_info.current_game_width/2-p.background.width/2,p.container.position.y=e.js_info.current_game_height/2-p.background.height/2;var u=zi.processCardClick(e.pointer,e.sounds_enabled,p.container,p.close_button,null);u==gi.DownedCloseButton?(r.state=ei.Closed,t.state=yi.InFreeScroll):u==gi.DownedOutside&&(r.state=ei.Closed,t.state=yi.InFreeScroll)}}},zi.updateUpgrades=function(e,t){if(null!=t.upgrade_display){var n=t.upgrade_display;n.additional_sprites_added||null!=zi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,n.points_background_entity.display.sprite,1,n.points_text,!1)&&(n.additional_sprites_added=!0);var i=e.game_save.upgrade_points+"p";if(n.points_text.text!=i&&(n.points_text.text=i),n.current_car_name!=e.game_save.current_car){n.current_car_name=e.game_save.current_car;var r=n.current_car_name+"_full";if(null==n.current_car){n.current_car=qa.createSpriteByName(r,.5,1);var a=new PIXI.Rectangle(-500,-500,1500,1500);Fa.insertNewObjectToLiveTree(e.partition_top,e.entity_partition_container,n.current_car,!1,a,-1)}else n.current_car.setTexture(Hs.getTexture(r));n.current_car.position.x=n.car_location.position.x,n.current_car.position.y=n.car_location.position.y}for(var s=0,l=n.units;s<l.length;){var o=l[s];++s,o.additional_sprites_added||null!=zi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,o.plus_points_background_entity.display.sprite,1,o.plus_points_text,!1)&&(o.additional_sprites_added=!0);var _=!0,p=o.upgrade_point_costs.length,u=0;"top_speed"==o.name?u=e.game_save.car_upgrades.top_speed:"acceleration"==o.name?u=e.game_save.car_upgrades.acceleration:"handling"==o.name?u=e.game_save.car_upgrades.handling:"armor"==o.name&&(u=e.game_save.car_upgrades.armor);var h=!1;if(u<o.upgrade_point_costs.length){var c=o.upgrade_point_costs[u];_=!(p<=u)&&c<=e.game_save.upgrade_points}else h=!(_=!1);o.plus_points_background_entity.display.sprite.alpha=_?o.plus_entity.display.sprite.alpha=1:h?o.plus_entity.display.sprite.alpha=0:(o.plus_entity.display.sprite.alpha=.5,1),o.state==ni.Downed?_&&(o.plus_entity.position.x=o.plus_init_pos.x-5,o.plus_entity.position.y=o.plus_init_pos.y,he.refresh(o.plus_entity)):o.state==ni.Clicked&&(o.state=ni.None,_&&(zi.clickUpgrade(t,o.name,o.upgrade_point_costs[u],e.game_save,e.sounds_enabled),++u));var d;if(d=u<o.upgrade_point_costs.length?o.upgrade_point_costs[u]+"p":"",o.plus_points_text.text!=d&&(o.plus_points_text.text=d),o.state==ni.None&&(o.plus_entity.position.x=o.plus_init_pos.x,o.plus_entity.position.y=o.plus_init_pos.y,he.refresh(o.plus_entity)),o.filled.length<u){var m=qa.createSpriteByName("car_upgrades_filled",0,0);m.position.x=o.unfilled_entity.position.x+o.fill_start_position.x+15*o.filled.length,m.position.y=o.unfilled_entity.position.y+o.fill_start_position.y;var f=zi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,o.unfilled_entity.display.sprite,1,m,!1);null!=f&&o.filled.push(f)}else if(o.filled.length>u){var g=o.filled.pop();Fa.destroyLiveObject(e.partition_top,g,!0)}}}},zi.updateCarShop=function(e,t){if(null!=t.car_shop){for(var n=0,i=0,r=e.game_save.level_saves;i<r.length;){var a=r[i];++i,a.description.type==wr.LevelRegular&&a.completed&&++n}10<=n&&-1!=e.game_save.locked_cars.indexOf("car_semioval")&&(s.remove(e.game_save.locked_cars,"car_semioval"),Vn.pushNotification(e.notifications,'Unlocked "Semioval" Car!',"")),20<=n&&-1!=e.game_save.locked_cars.indexOf("car_rider")&&(s.remove(e.game_save.locked_cars,"car_rider"),Vn.pushNotification(e.notifications,'Unlocked "Swordsman" Car!',""));for(var l=0,o=t.car_shop.cars;l<o.length;){var _=o[l];if(++l,_.additional_sprites_added||(null!=zi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,_.name_tag_entity.display.sprite,1,_.name_tag_text,!1)&&(_.additional_sprites_added=!0),zi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,_.name_tag_entity.display.sprite,2,_.name_tag_coin,!0)),-1!=e.game_save.car_own_list.indexOf(_.car_name)&&_.show_type!=_i.Owned&&(_.name_tag_coin.visible=!1,_.name_tag_text.text=_.car_shop_name+": Own",_.show_type=_i.Owned),-1!=e.game_save.car_own_list.indexOf(_.car_name)&&_.car_name==e.game_save.current_car&&_.show_type!=_i.Selected&&(_.name_tag_coin.visible=!1,_.name_tag_text.text=_.car_shop_name+": Selected",_.show_type=_i.Selected),-1==e.game_save.car_own_list.indexOf(_.car_name)&&_.show_type!=_i.Priced){_.name_tag_coin.visible=!0;var p=_.car_setting.price+"";_.name_tag_text.text=_.car_shop_name+": "+p,_.name_tag_coin.position.x=_.name_tag_text.position.x+_.name_tag_text.width/2+_.name_tag_coin.width/2+5,_.show_type=_i.Priced}if(-1!=e.game_save.locked_cars.indexOf(_.car_name)?(_.name_tag_coin.visible=!1,_.name_tag_text.text=_.car_shop_name+": Locked",_.show_type=_i.Locked,null==_.locked_texture?Nl.trace("warning: locked car does not have locked_texture "+_.car_name,{fileName:"InterLevelMenuDo.hx",lineNumber:2454,className:"bikas.game.InterLevelMenuDo",methodName:"updateCarShop"}):_.car_sprite.texture!=_.locked_texture&&_.car_sprite.setTexture(_.locked_texture)):_.car_sprite.texture!=_.regular_texture&&_.car_sprite.setTexture(_.regular_texture),_.show_type==_i.Priced&&e.game_save.coins<_.car_setting.price||_.show_type==_i.Locked?(_.name_tag_coin.alpha=.5,_.name_tag_text.alpha=.5,_.car_entity.display.sprite.alpha=.5):(_.name_tag_coin.alpha=1,_.name_tag_text.alpha=1,_.car_entity.display.sprite.alpha=1),_.state==oi.Opened){if(t.animate_forward_wait_time=0,null==_.card){var u=new li,h=_.car_setting.price+"";u.container=qa.createGroup(),u.background=qa.createSpriteByName("shop_card",0,0),u.close_button=qa.createSpriteByName("button_close"),u.main_button=qa.createSpriteByName("button_buy",.5,.5),u.text=qa.createBitmapText(fn.bell_gothic_std_black_dark_26,36,"left","TEXT",0,0),u.text_background=qa.createSpriteByName("shop_card_name_background",.5,.5),u.coin=qa.createSpriteByName("coin_pick",.5,.5);var c=function(e,t,n,i){var r=new si;r.container=qa.createGroup(),r.background_bar=qa.createSpriteByName("color_bar_orange"),r.foreground_bar=qa.createSpriteByName("color_bar_yellow"),r.text=qa.createBitmapText(fn.bell_gothic_std_black_dark_26,26,"left","TEXT"),r.text.text=i;var a=Pr.getCarSettingByName(e,t),s=Pr.getCarSettingByName(e,n);if(null==a&&(Nl.trace("warning: current_car_setting == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"updateCarShop"}),1))return null;if(null==s&&(Nl.trace("warning: opened_car_setting == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"updateCarShop"}),1))return null;var l=0,o=0,_=0,p=0;"Acceleration"==i?(_=3.8,p=5.1,l=a.initial_config.drive_impulse,o=s.initial_config.drive_impulse):"Handling"==i?(_=0,p=2,l=a.initial_config.rotation_angular_impulse_coeff,o=s.initial_config.rotation_angular_impulse_coeff):"Armor"==i&&(_=-.2,p=1.2,l=a.initial_config.armor_coeff,o=s.initial_config.armor_coeff);var u=va.getT(_,p,l),h=va.getT(_,p,o);if(u<h?r.green_or_red_bar=qa.createSpriteByName("color_bar_green"):h<u&&(r.green_or_red_bar=qa.createSpriteByName("color_bar_red")),r.background_bar.anchor.x=0,r.background_bar.anchor.y=.5,r.foreground_bar.anchor.x=0,r.foreground_bar.anchor.y=.5,r.text.anchor.x=.5,r.text.anchor.y=.5,r.text.position.y=2,r.foreground_bar.x=-li.metric_width/2,r.background_bar.x=-li.metric_width/2,r.foreground_bar.width=h*li.metric_width,r.foreground_bar.height=li.metric_height,r.background_bar.width=li.metric_width,r.background_bar.height=li.metric_height,null!=r.green_or_red_bar){var c=h-u;r.green_or_red_bar.alpha=li.metric_green_or_red_alpha,r.green_or_red_bar.width=li.metric_width*Math.abs(c),r.green_or_red_bar.height=li.metric_height,r.green_or_red_bar.anchor.x=0<c?1:0,r.green_or_red_bar.anchor.y=.5,r.green_or_red_bar.x=r.foreground_bar.x+r.foreground_bar.width}return r.container.add(r.background_bar),r.container.add(r.foreground_bar),null!=r.green_or_red_bar&&r.container.add(r.green_or_red_bar),r.container.add(r.text),r};u.metrics.push(c(e.car_settings,e.game_save.current_car,_.car_name,"Acceleration")),u.metrics.push(c(e.car_settings,e.game_save.current_car,_.car_name,"Handling")),u.metrics.push(c(e.car_settings,e.game_save.current_car,_.car_name,"Armor"));var d=0;_.show_type==_i.Locked?(u.text.text=_.car_shop_name+" (Locked)",u.coin.visible=!1):_.show_type==_i.Priced?(u.text.text=h+"",u.text.width,d=u.coin.width/2+5,u.text.text=_.car_shop_name+": "+h):_.show_type==_i.Owned?(u.text.text=_.car_shop_name+" (Own)",u.coin.visible=!1):_.show_type==_i.Selected&&(u.text.text=_.car_shop_name+" (Selected)",u.coin.visible=!1),u.close_button.anchor.x=xi.close_button_anchor_x,u.close_button.anchor.y=xi.close_button_anchor_y,u.close_button.position.x=u.background.width,u.close_button.position.y=0,u.main_button.position.x=u.background.width/2,u.main_button.position.y=u.background.height-75,u.text.anchor.x=.5,u.text.anchor.y=.5,u.text.position.x=.5*u.background.width,u.text.position.y=100,u.text_background.anchor.x=.5,u.text_background.anchor.y=.5,u.text_background.width=li.metric_width,u.text_background.height=2*li.metric_height,u.text_background.position.x=u.text.position.x,u.text_background.position.y=u.text.position.y,_.show_type==_i.Priced?(u.coin.position.x=u.text.position.x+u.text.width/2+d,u.coin.position.y=u.text.position.y,u.coin.visible=!0):u.coin.visible=!1;for(var m=0,f=u.metrics.length;m<f;){var g=m++,v=u.metrics[g];v.container.x=u.background.width/2;var b=u.text_background.position.y+u.text_background.height/2+v.background_bar.height/2+li.metric_offset;v.container.y=b+(v.background_bar.height+li.metric_space)*g}u.container.add(u.background),u.container.add(u.close_button),u.container.add(u.main_button),u.container.add(u.text_background),u.container.add(u.text),u.container.add(u.coin);for(var y=0,x=u.metrics;y<x.length;){var z=x[y];++y,u.container.add(z.container)}e.menu_container.add(u.container),_.card=u}var w=_.card;_.show_type==_i.Locked?(w.coin.visible=!1,w.main_button.visible=!1):_.show_type==_i.Priced?(w.coin.visible=!0,w.main_button.visible=!0,w.main_button.texture!=li.buy_texture&&w.main_button.setTexture(li.buy_texture),_.car_setting.price<=e.game_save.coins?(w.main_button.alpha=1,w.state=ai.Buy):(w.main_button.alpha=xi.main_button_deactivated_alpha,w.state=ai.CantBuy)):_.show_type==_i.Owned?(w.coin.visible=!1,w.main_button.visible=!0,w.main_button.texture!=li.select_texture&&w.main_button.setTexture(li.select_texture),w.state=ai.Select):_.show_type==_i.Selected&&(w.coin.visible=!1,w.main_button.visible=!1,w.state=ai.AlreadySelected),w.container.position.x=e.js_info.current_game_width/2-w.container.width/2,w.container.position.y=e.js_info.current_game_height/2-w.container.height/2;var k=zi.processCardClick(e.pointer,e.sounds_enabled,w.container,w.close_button,w.main_button);k==gi.DownedCloseButton?(_.state=oi.Closed,t.state=yi.InFreeScroll):k==gi.DownedMainButton?(w.state!=ai.Select&&w.state!=ai.Buy||(w.container.parent.removeChild(w.container),_.state=oi.Closed,t.state=yi.InFreeScroll),w.state==ai.Buy?(e.game_save.coins-=_.car_setting.price,e.game_save.current_car=_.car_name,e.game_save.car_own_list.push(_.car_name),Ms.playSound(Gs.sound_buy_car,e.sounds_enabled),t.trigger_game_save=!0):w.state==ai.Select&&(e.game_save.current_car=_.car_name,t.trigger_game_save=!0)):k==gi.DownedOutside&&(_.state=oi.Closed,t.state=yi.InFreeScroll)}else _.state==oi.Closed&&null!=_.card&&(zi.destroyCarCard(_.card),_.card=null)}}},zi.updateLevelMap=function(e,t){if(null!=t.level_map)for(var n=0,i=t.level_map.levels;n<i.length;){var r=i[n];if(++n,r.selected_circle_added_to_partition||null!=zi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,null,-1,r.selected_circle,!0)&&(r.selected_circle_added_to_partition=!0),0<=r.level_save_index&&r.level_save_index<e.game_save.level_saves.length){var a=e.game_save.level_saves[r.level_save_index];if(r.could_be_next_level=!1,!a.completed)if(null==r.previous_level)r.could_be_next_level=!0;else{var s=null;0<=r.previous_level.level_save_index&&r.previous_level.level_save_index<e.game_save.level_saves.length&&(s=e.game_save.level_saves[r.previous_level.level_save_index]),null!=s&&s.completed&&(r.could_be_next_level=!0)}a.description.available_in_final_game||(r.could_be_next_level=!1),a.description.type==wr.LevelRegular?a.description.available_in_final_game?a.completed&&100==a.completion_percent?r.sprite.texture!=di.map_item_finished100&&r.sprite.setTexture(di.map_item_finished100):a.completed?r.sprite.texture!=di.map_item_finished&&r.sprite.setTexture(di.map_item_finished):r.could_be_next_level?r.sprite.texture!=di.map_item_empty_big&&r.sprite.setTexture(di.map_item_empty_big):r.sprite.texture!=di.map_item_empty&&r.sprite.setTexture(di.map_item_empty):r.sprite.texture!=di.map_item_not_available&&r.sprite.setTexture(di.map_item_not_available):a.description.type==wr.LevelChallenge&&(-1!=e.game_save.challenges_completed.indexOf(r.challenge_desc.id)?r.sprite.texture!=di.map_item_challenge_completed&&r.sprite.setTexture(di.map_item_challenge_completed):-1!=e.game_save.challenges_unlocked.indexOf(r.challenge_desc.id)?r.sprite.texture!=di.map_item_challenge_unlocked&&r.sprite.setTexture(di.map_item_challenge_unlocked):r.sprite.texture!=di.map_item_challenge_locked&&r.sprite.setTexture(di.map_item_challenge_locked));var l=1;if(r.state==ci.Opened)l=1,r.selected_circle.visible=!0;else if(r.state==ci.Closed){if(a.description.type==wr.LevelRegular)if(r.could_be_next_level){r.current_time+=e.step.step_size;var o=ma.clamp0to1(r.current_time/di.scale_anim_time);l=va.smoothForwardAndBackward(.9,1.1,o),1==o&&(r.current_time=0)}else l=1;else if(a.description.type==wr.LevelChallenge)if(-1!=e.game_save.challenges_completed.indexOf(r.challenge_desc.id)||-1==e.game_save.challenges_unlocked.indexOf(r.challenge_desc.id)||r.animate_in)r.animate_in||(l=1);else{r.current_time+=e.step.step_size;var _=ma.clamp0to1(r.current_time/di.scale_anim_time);l=va.smoothForwardAndBackward(1,1.1,_),1==_&&(r.current_time=0)}r.selected_circle.visible=!1}if(r.animate_in){r.current_time+=e.step.step_size;var p=ma.clamp0to1(r.current_time/di.animate_in_time);l=va.smoothForwardAndBackward(1,di.animate_in_start_scale,p),1==p&&(r.animate_in=!1)}if(r.entity.transform.scale_x!=l&&(r.entity.transform.scale_x=l,r.entity.transform.scale_y=l,me.refresh(r.entity)),r.state==ci.Opened){if(null==r.level_card&&a.description.type==wr.LevelRegular){var u="Level "+a.description.level_number+"\n";u+=a.description.nice_name,a.completed&&(u+="\nScore: "+a.completion_percent+"%"),a.description.available_in_final_game||(u="Not available \nin Demo :)"),r.level_card=zi.createConfirmationCard("button_go",u),e.menu_container.add(r.level_card.container)}if(null!=r.level_card){var h=r.level_card;(a.completed||r.could_be_next_level)&&a.description.available_in_final_game?h.button_main.visible=!0:h.button_main.visible=!1,r.click_position.x<=e.js_info.current_game_width/2?h.container.position.x=r.click_position.x+40:h.container.position.x=r.click_position.x-40-h.background.width,h.container.position.y=r.click_position.y-h.container.height/2;var c=zi.processCardClick(e.pointer,e.sounds_enabled,h.container,h.button_close,h.button_main);c==gi.DownedCloseButton?(r.state=ci.Closed,t.state=yi.InFreeScroll):c==gi.DownedMainButton?(h.container.parent.removeChild(h.container),r.state=ci.Closed,t.state=yi.InFreeScroll,(a.completed||r.could_be_next_level)&&zi.clickLevel(t,a,e.sounds_enabled)):c==gi.DownedOutside&&(r.state=ci.Closed,t.state=yi.InFreeScroll)}if(null==r.challenge_card&&a.description.type==wr.LevelChallenge){var d=r.challenge_desc.name;a.description.available_in_final_game?-1!=e.game_save.challenges_completed.indexOf(r.challenge_desc.id)?d+=" (Completed)":-1!=e.game_save.challenges_unlocked.indexOf(r.challenge_desc.id)?d+=" (Unlocked)":d+=" (Locked)":d+=" (Not Available in Demo)";var m=-1!=e.game_save.challenges_unlocked.indexOf(r.challenge_desc.id)&&a.description.available_in_final_game,f=r.challenge_desc.item.description_text+".";r.challenge_card=zi.createRequirementAndRewardCard("challenge_card",null,"button_go",m,null,new ea(256.9,98.4),new ea(58.4,219.6),new ea(58.4,299.6),new ea(256.6,449.1),d,380,"Unlock",".",r.challenge_desc.requirement,"Reward",f,400),e.menu_container.add(r.challenge_card.container)}if(null!=r.challenge_card){var g=r.challenge_card;g.container.position.x=e.js_info.current_game_width/2-g.background.width/2,g.container.position.y=e.js_info.current_game_height/2-g.background.height/2;var v=zi.processCardClick(e.pointer,e.sounds_enabled,g.container,g.close_button,g.main_button);v==gi.DownedMainButton?-1!=e.game_save.challenges_unlocked.indexOf(r.challenge_desc.id)&&(g.container.parent.removeChild(g.container),r.state=ci.Closed,zi.clickLevel(t,a,e.sounds_enabled)):v==gi.DownedCloseButton?(r.state=ci.Closed,t.state=yi.InFreeScroll):v==gi.DownedOutside&&(r.state=ci.Closed,t.state=yi.InFreeScroll)}}else r.state==ci.Closed&&(null!=r.level_card&&(zi.destroyConfirmationCard(r.level_card),r.level_card=null),null!=r.challenge_card&&(zi.destroyRequirementAndRewardCard(r.challenge_card),r.challenge_card=null))}}},zi.updateRewardCardSelection=function(e,t){if(t.state==yi.InRewardSelection){var n=t.reward_display,i=e.js_info.current_game_width/2,r=e.js_info.current_game_height/2;if(null==n.reward_selection&&(t.available_descs.length<Math.round(e.chest_reward_item_descs.length/2)&&(t.available_descs=e.chest_reward_item_descs.slice()),n.reward_selection=Vr.createRewardSelection(e.js_info,t.available_descs,0),e.menu_container.add(n.reward_selection.container),n.state=Kn.RewardAnimateIn,n.current_time=-Qn.wait_in_time,Ms.playSound(Gs.sound_reward_phase_in,e.sounds_enabled)),n.reward_selection.background.width!=e.js_info.current_game_width&&(n.reward_selection.background.width=e.js_info.current_game_width),n.reward_selection.background.height!=e.js_info.current_game_height&&(n.reward_selection.background.height=e.js_info.current_game_height),n.state==Kn.RewardAnimateIn){n.current_time+=e.step.step_size;var a=ma.clamp0to1(n.current_time/Qn.anim_in_time),s=va.smoothStartEnd(0,1,a);n.reward_selection.container.alpha=s,n.reward_selection.middle_container.scale.x=s,n.reward_selection.middle_container.scale.y=s,n.chest.chest.alpha=va.linear(1,.5,a);var l=va.linear(n.chest_position.x,i,s),o=va.linear(n.chest_position.y,r,s);n.reward_selection.middle_container.x=l,n.reward_selection.middle_container.y=o,1==a&&(n.state=Kn.RewardSelect)}if(n.state==Kn.RewardSelect){n.reward_selection.middle_container.x=i,n.reward_selection.middle_container.y=r;var _=$a.getPointerClicked(e.pointer,xi.start_drag_distance);if(null!=_){for(var p=null,u=-1,h=0,c=n.reward_selection.cards;h<c.length;){var d=c[h];++h;var m,f=n.reward_selection.middle_container.x+d.container.x-d.container.width/2,g=n.reward_selection.middle_container.y+d.container.y-d.container.height/2,v=f+d.container.width,b=g+d.container.height;m=ma.pointInBoundedArea(_.current,f,g,v,b)?0:ma.distanceBetweenPointAndBoundedArea(_.current,f,g,v,b),null==p?(u=m,p=d):m<u&&(u=m,p=d)}null!=p&&u<=xi.finger_radius&&(t.scroll_help_wait_time_stamp=e.step.level_seconds,zi.clickRewardCard(e.partition_top,t,n,p,e.game_save,e.ongoing_powers_display,e.notifications,e.sounds_enabled))}}if(n.state==Kn.RewardAnimateOut){n.current_time+=e.step.step_size;var y=ma.clamp0to1(n.current_time/Qn.anim_out_time);n.reward_selection.container.alpha=1-y;var x=va.linear(n.selected_card_start_scale,1.2,y);n.selected_card.container.scale.x=x,n.selected_card.container.scale.y=x,1==y&&(zi.destroyRewardDisplay(n),t.reward_display=null,t.state=yi.InFreeScroll)}}},zi.updateRewardedAds=function(e,t,n,i,r,a){if(null==e.current_rewarded_ad_menu){var s=Pr.getTotalRegularLevelsCompleted(r);if(2<=s){for(var l=-1,o=0,_=0,p=0,u=r.rewarded_ads;p<u.length;){var h=u[p];++p,h.levels_completed>l&&(l=h.levels_completed),0!=h.type&&(2==h.type?++o:1==h.type&&++_)}var c=!1;o<5&&3<=s-l&&1==e.initial_chest_count&&(c=!0);var d=!1;c||_<5&&3<=s-l&&null!=e.nearest_place&&e.nearest_place.marker.name==xi.place_shop&&(d=!0),c?e.current_rewarded_ad_menu=zi.createRewardedAdMenu(e,r,t,2,a):d&&(e.current_rewarded_ad_menu=zi.createRewardedAdMenu(e,r,t,1,a))}}if(null!=e.current_rewarded_ad_menu&&!e.current_rewarded_ad_menu.closed){var m=e.current_rewarded_ad_menu.confirm_card,f=(Ma.getTimer()-e.current_rewarded_ad_menu.show_time_stamp)/1e3;f=ma.clamp(f,0,30),m.bitmap_text.text=e.current_rewarded_ad_menu.text+" ("+Math.round(30-f)+")",m.container.position.x=n.current_game_width/2-m.background.width/2,m.container.position.y=n.current_game_height/3-m.background.height/2;var g=zi.processCardClick(i,a,m.container,m.button_close,m.button_main,!1);30<=f&&(g=gi.DownedCloseButton),g==gi.DownedCloseButton?(e.current_rewarded_ad_menu.closed=!0,zi.destroyRewardedAdMenu(e.current_rewarded_ad_menu)):g==gi.DownedMainButton?(e.current_rewarded_ad_menu.closed=!0,e.in_ad=!0,es.PokiSDK.rewardedBreak().then(function(t){e.in_ad=!1,e.current_rewarded_ad_menu.ad.type=e.current_rewarded_ad_menu.reward_ad_type,2==e.current_rewarded_ad_menu.ad.type?r.chests+=3:1==e.current_rewarded_ad_menu.ad.type?r.coins+=50:Nl.trace("warning: unhandled ad.type "+e.current_rewarded_ad_menu.ad.type,{fileName:"InterLevelMenuDo.hx",lineNumber:3304,className:"bikas.game.InterLevelMenuDo",methodName:"updateRewardedAds"}),zi.destroyRewardedAdMenu(e.current_rewarded_ad_menu),e.trigger_game_save=!0})):gi.DownedOutside}};var wi=function(e,t,n,i,r,a){null==a&&(a=-1),null==r&&(r=1),null==i&&(i=-1),null==n&&(n=1),null==t&&(t=-1),null==e&&(e=1),(this.zpp_inner=null)==ki.zpp_pool?this.zpp_inner=new ki:(this.zpp_inner=ki.zpp_pool,ki.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null),this.zpp_inner.alloc(),(this.zpp_inner.outer=this).set_collisionGroup(e),this.set_collisionMask(t),this.set_sensorGroup(n),this.set_sensorMask(i),this.set_fluidGroup(r),this.set_fluidMask(a)};(n["nape.dynamics.InteractionFilter"]=wi).__name__=["nape","dynamics","InteractionFilter"],wi.prototype={zpp_inner:null,get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_shapes:function(){return null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=pc.get(this.zpp_inner.shapes,!0)),this.zpp_inner.wrap_shapes},get_collisionGroup:function(){return this.zpp_inner.collisionGroup},set_collisionGroup:function(e){return this.get_collisionGroup()!=e&&(this.zpp_inner.collisionGroup=e,this.zpp_inner.invalidate()),this.get_collisionGroup()},get_collisionMask:function(){return this.zpp_inner.collisionMask},set_collisionMask:function(e){return this.get_collisionMask()!=e&&(this.zpp_inner.collisionMask=e,this.zpp_inner.invalidate()),this.get_collisionMask()},get_sensorGroup:function(){return this.zpp_inner.sensorGroup},set_sensorGroup:function(e){return this.get_sensorGroup()!=e&&(this.zpp_inner.sensorGroup=e,this.zpp_inner.invalidate()),this.get_sensorGroup()},get_sensorMask:function(){return this.zpp_inner.sensorMask},set_sensorMask:function(e){return this.get_sensorMask()!=e&&(this.zpp_inner.sensorMask=e,this.zpp_inner.invalidate()),this.get_sensorMask()},get_fluidGroup:function(){return this.zpp_inner.fluidGroup},set_fluidGroup:function(e){return this.get_fluidGroup()!=e&&(this.zpp_inner.fluidGroup=e,this.zpp_inner.invalidate()),this.get_fluidGroup()},get_fluidMask:function(){return this.zpp_inner.fluidMask},set_fluidMask:function(e){return this.get_fluidMask()!=e&&(this.zpp_inner.fluidMask=e,this.zpp_inner.invalidate()),this.get_fluidMask()},shouldCollide:function(e){return this.zpp_inner.shouldCollide(e.zpp_inner)},shouldSense:function(e){return this.zpp_inner.shouldSense(e.zpp_inner)},shouldFlow:function(e){return this.zpp_inner.shouldFlow(e.zpp_inner)},copy:function(){return new wi(this.get_collisionGroup(),this.get_collisionMask(),this.get_sensorGroup(),this.get_sensorMask(),this.get_fluidGroup(),this.get_fluidMask())},toString:function(){return"{ collision: "+h.hex(this.get_collisionGroup(),8)+"~"+h.hex(this.get_collisionMask(),8)+" sensor: "+h.hex(this.get_sensorGroup(),8)+"~"+h.hex(this.get_sensorMask(),8)+" fluid: "+h.hex(this.get_fluidGroup(),8)+"~"+h.hex(this.get_fluidMask(),8)+" }"},__class__:wi,__properties__:{set_fluidMask:"set_fluidMask",get_fluidMask:"get_fluidMask",set_fluidGroup:"set_fluidGroup",get_fluidGroup:"get_fluidGroup",set_sensorMask:"set_sensorMask",get_sensorMask:"get_sensorMask",set_sensorGroup:"set_sensorGroup",get_sensorGroup:"get_sensorGroup",set_collisionMask:"set_collisionMask",get_collisionMask:"get_collisionMask",set_collisionGroup:"set_collisionGroup",get_collisionGroup:"get_collisionGroup",get_shapes:"get_shapes",get_userData:"get_userData"}};var ki=function(){this.fluidMask=0,this.fluidGroup=0,this.sensorMask=0,this.sensorGroup=0,this.collisionMask=0,this.collisionGroup=0,this.wrap_shapes=null,this.shapes=null,this.outer=null,this.userData=null,this.next=null,this.feature_cons(),this.collisionGroup=this.sensorGroup=this.fluidGroup=1,this.collisionMask=this.sensorMask=this.fluidMask=-1};(n["zpp_nape.dynamics.ZPP_InteractionFilter"]=ki).__name__=["zpp_nape","dynamics","ZPP_InteractionFilter"],ki.prototype={next:null,userData:null,outer:null,wrapper:function(){if(null==this.outer){this.outer=new wi;var e=this.outer.zpp_inner;e.free(),e.next=ki.zpp_pool,ki.zpp_pool=e,this.outer.zpp_inner=this}return this.outer},free:function(){this.outer=null},alloc:function(){},shapes:null,wrap_shapes:null,feature_cons:function(){this.shapes=new qu},addShape:function(e){this.shapes.add(e)},remShape:function(e){this.shapes.remove(e)},copy:function(){var e;return null==ki.zpp_pool?e=new ki:(e=ki.zpp_pool,ki.zpp_pool=e.next,e.next=null),e.alloc(),e.collisionGroup=this.collisionGroup,e.collisionMask=this.collisionMask,e.sensorGroup=this.sensorGroup,e.sensorMask=this.sensorMask,e.fluidGroup=this.fluidGroup,e.fluidMask=this.fluidMask,e},collisionGroup:null,collisionMask:null,shouldCollide:function(e){return 0!=(this.collisionMask&e.collisionGroup)&&0!=(e.collisionMask&this.collisionGroup)},sensorGroup:null,sensorMask:null,shouldSense:function(e){return 0!=(this.sensorMask&e.sensorGroup)&&0!=(e.sensorMask&this.sensorGroup)},fluidGroup:null,fluidMask:null,shouldFlow:function(e){return 0!=(this.fluidMask&e.fluidGroup)&&0!=(e.fluidMask&this.fluidGroup)},invalidate:function(){for(var e=this.shapes.begin();null!=e;)e.elem().invalidate_filter(),e=e.next},__class__:ki};var Si=function(){};(n["bikas.game.InteractionFilters"]=Si).__name__=["bikas","game","InteractionFilters"],Si.create=function(e,t){var n=function(e){for(var t=[],n=0;n<e.length;){var i=e[n];++n,0==i?t.push(!1):t.push(!0)}return t},i=Si.getAsBinary(n(e),!1),r=Si.getAsBinary(n(t),!0);return new wi(i,r)},Si.setFromBinary=function(e,t){for(var n=0,i=e.length;n<i;){var r=n++;e[r]=0!=(1<<r&t)}},Si.getAsBinary=function(e,t){null==t&&(t=!1);for(var n=0,i=0,r=e.length;i<r;){var a=i++;e[a]==!t&&(n|=Math.round(Math.pow(2,a)))}return t&&(n=~n),n};var Ci=n["bikas.game.PickableItemType"]={__ename__:["bikas","game","PickableItemType"],__constructs__:["PowerQuestion","Coin","Nitro","TreasureChest","BotJumpIndicator","AttachmentBalloons","AttachmentAnchor"]};Ci.PowerQuestion=["PowerQuestion",0],Ci.PowerQuestion.toString=i,(Ci.PowerQuestion.__enum__=Ci).Coin=["Coin",1],Ci.Coin.toString=i,(Ci.Coin.__enum__=Ci).Nitro=["Nitro",2],Ci.Nitro.toString=i,(Ci.Nitro.__enum__=Ci).TreasureChest=["TreasureChest",3],Ci.TreasureChest.toString=i,(Ci.TreasureChest.__enum__=Ci).BotJumpIndicator=["BotJumpIndicator",4],Ci.BotJumpIndicator.toString=i,(Ci.BotJumpIndicator.__enum__=Ci).AttachmentBalloons=["AttachmentBalloons",5],Ci.AttachmentBalloons.toString=i,(Ci.AttachmentBalloons.__enum__=Ci).AttachmentAnchor=["AttachmentAnchor",6],Ci.AttachmentAnchor.toString=i,(Ci.AttachmentAnchor.__enum__=Ci).__empty_constructs__=[Ci.PowerQuestion,Ci.Coin,Ci.Nitro,Ci.TreasureChest,Ci.BotJumpIndicator,Ci.AttachmentBalloons,Ci.AttachmentAnchor];var Ni=n["bikas.game.PickableItemState"]={__ename__:["bikas","game","PickableItemState"],__constructs__:["Normal","TransitionOut","Picked"]};Ni.Normal=["Normal",0],Ni.Normal.toString=i,(Ni.Normal.__enum__=Ni).TransitionOut=["TransitionOut",1],Ni.TransitionOut.toString=i,(Ni.TransitionOut.__enum__=Ni).Picked=["Picked",2],Ni.Picked.toString=i,(Ni.Picked.__enum__=Ni).__empty_constructs__=[Ni.Normal,Ni.TransitionOut,Ni.Picked];var Pi=function(){this.transition_out_current_time=0,this.shine_effect_current_pause_time=0,this.pickup_scale_current_time=0,this.picked_by_cars=[],this.distance_from_the_ground=0,this.ray_casted=!1,this.ray_cache=null,this.light_is_added=!1,this.radius=0,this.height=0,this.width=0,this.is_bad_item=!1,this.pickable=!0,this.only_one_character_can_pickup=!1};(n["bikas.game.PickableItem"]=Pi).__name__=["bikas","game","PickableItem"],Pi.prototype={type:null,state:null,only_one_character_can_pickup:null,pickable:null,is_bad_item:null,entity:null,width:null,height:null,radius:null,anim:null,light:null,light_is_added:null,position:null,coin_entity_container:null,ray_cache:null,ray_casted:null,distance_from_the_ground:null,picked_by_cars:null,pickup_scale_current_time:null,shine_effect_current_pause_time:null,transition_out_current_time:null,__class__:Pi};var Mi=function(){};(n["bikas.game.ItemDo"]=Mi).__name__=["bikas","game","ItemDo"],Mi.createPickableItem=function(e,t){var n=new Pi;return n.type=t,n.entity=e,n.width=n.entity.display.sprite.width,n.height=n.entity.display.sprite.height,n.radius=ma.max(n.width,n.height)/2,n.position=y_.get(n.entity.position.x,n.entity.position.y),n.state=Ni.Normal,n.ray_cache=new f_(y_.get(),y_.get()),n.ray_cache.get_direction().set_x(0),n.ray_cache.get_direction().set_y(1),n.ray_casted=!1,t==Ci.PowerQuestion?(n.anim=A.createAnimationUsingSprite(Gs.animation_power_question,e.display.sprite),n.light=qa.createSprite(Gs.animation_power_question_light.frames[0].texture,.5,.5,0,0),n.light.position.x=n.entity.position.x,n.light.position.y=n.entity.position.y):t==Ci.Coin?n.anim=A.createAnimationUsingSprite(Gs.animation_coin_pick,e.display.sprite):t==Ci.Nitro?n.anim=A.createAnimationUsingSprite(Gs.animation_nitro_pick,e.display.sprite):t!=Ci.TreasureChest&&(t==Ci.BotJumpIndicator?(e.display.sprite.visible=!1,n.anim=null):t==Ci.AttachmentBalloons?(n.only_one_character_can_pickup=!0,n.is_bad_item=!0):t==Ci.AttachmentAnchor?(n.only_one_character_can_pickup=!0,n.is_bad_item=!0):Nl.trace("warning: unhandled type "+p.string(t),{fileName:"ItemDo.hx",lineNumber:75,className:"bikas.game.ItemDo",methodName:"createPickableItem"})),n},Mi.destroyPickableItem=function(e){null!=e.anim&&(A.destroyAnimation(e.anim,!1),e.anim=null),null!=e.light&&(e.light.destroy(!0),e.light=null),null!=e.position&&(e.position.dispose(),e.position=null),null!=e.ray_cache&&(e.ray_cache.get_origin().dispose(),e.ray_cache.get_direction().dispose(),e.ray_cache=null),null!=e.position&&(e.position.dispose(),e.position=null),e.coin_entity_container=null,e.entity=null,e.position=null,e.picked_by_cars=null},Mi.getRandomAbility=function(e,t,n){if(1==n.length)return e[ma.getRandomBetweenInt(0,e.length-1)].type;for(var i=(n.length-n.indexOf(t)-1)/(n.length-1),r=0,a=0;a<e.length;){var s=e[a];++a,r+=va.linear(s.first_car_multiplier,s.last_car_multiplier,i)}for(var l=r*Math.random(),o=0,_=0;_<e.length;){var p=e[_];if(++_,l<=(o+=va.linear(p.first_car_multiplier,p.last_car_multiplier,i)))return p.type}return Nl.trace("warning: something went wrong with probabilities",{fileName:"ItemDo.hx",lineNumber:136,className:"bikas.game.ItemDo",methodName:"getRandomAbility"}),ye.Armor},Mi.updatePickableItem=function(e,t,n,i,r,a){var s=t.ability_item_container,l=t.all_cars,o=t.bots,_=t.player,u=t.player_bot;if(!e.ray_casted){e.ray_casted=!0,e.ray_cache.get_origin().set_x(e.position.get_x()),e.ray_cache.get_origin().set_y(e.position.get_y());var h=n.rayCast(e.ray_cache,!1,Si.ray_to_ground);null!=h&&(e.distance_from_the_ground=h.get_distance(),h.dispose())}if(e.state==Ni.Normal&&null!=e.entity.display.sprite.parent&&e.entity.display.sprite.visible){if(null!=e.light){if(!e.light_is_added&&null!=t.partition_top&&null!=t.entity_partition_container){for(var c=-1,d=0,m=0,f=t.entity_partition_container.all;m<f.length;){var g=f[m];++m,g.display_object==e.entity.display.sprite&&(c=d),++d}c=0,Fa.insertNewObjectToLiveTree(t.partition_top,t.entity_partition_container,e.light,!1,null,c),e.light_is_added=!0}e.light.rotation+=Math.PI/180*i}null!=e.anim&&(e.shine_effect_current_pause_time+=i,e.shine_effect_current_pause_time>=Pi.shine_effect_total_pause_time&&(A.nextFrameStep(e.anim,i),0==e.anim.current_frame&&(e.shine_effect_current_pause_time=0)))}for(var v=0;v<l.length;){var b=l[v];if(++v,e.pickable){var y=b.main_body_position_x-e.entity.position.x,x=b.main_body_position_y-e.entity.position.y;if(!(500<y||y<-500)&&!(500<x||x<-500)&&Ot.doesWorldCircleTouchCarBounds(b,e.position,75)&&-1==e.picked_by_cars.indexOf(b)){e.picked_by_cars.push(b);var z=r+(Te.transition_time+Te.shuffle_time)/60;if(b==_.car)if(e.state!=Ni.Normal&&Nl.trace("warning: item state should be normal, because item is not yet picked by the player's car",{fileName:"ItemDo.hx",lineNumber:238,className:"bikas.game.ItemDo",methodName:"updatePickableItem"}),e.state=Ni.TransitionOut,e.only_one_character_can_pickup&&(e.pickable=!1),e.type==Ci.Coin)t.collected_in_level.coins++,Ms.playSound(Gs.sound_coin,a,.2);else if(e.type==Ci.Nitro)_.abilities.nitro_power_charge+=1,Ms.playSound(Gs.sound_nitro_pick,a);else if(e.type==Ci.TreasureChest)t.collected_in_level.chests_collected_guids.push(e.entity.guid),Ms.playSound(Gs.sound_treasure,a);else if(e.type==Ci.PowerQuestion){A.gotoFrame(e.anim,0);var w=new PIXI.Point(0,0),k=new PIXI.Point(1,1);qa.toGlobal(e.anim.sprite,w,k),qa.toLocal(s,w,k),ze.pickItem(_.ability_button,w,k,s,!1),_.abilities.current_ability=ye.None,_.abilities.received_ability=Mi.getRandomAbility(t.ability_probabilities,t.player.car,l),null!=u&&(u.abilities.bot_ability_receive_time_stamp=z),Ms.playSound(Gs.sound_power_pick2,a)}else e.type!=Ci.BotJumpIndicator&&(e.type==Ci.AttachmentBalloons?(Vn.spawnAttachment(t,t.partition_top,t.entity_partition_container,t.player.car,Be.AttachmentBalloon,Le.balloon_time),Ms.playSound(Gs.sound_balloons,a,.6)):e.type==Ci.AttachmentAnchor&&(Vn.spawnAttachment(t,t.partition_top,t.entity_partition_container,t.player.car,Be.AttachmentAnchor,Le.balloon_time),Ms.playSound(Gs.sound_anchor,a)));else{e.only_one_character_can_pickup?(e.state=Ni.TransitionOut,e.pickable=!1):e.pickup_scale_current_time=Pi.pickup_scale_time;for(var S=null,C=0;C<o.length;){var N=o[C];if(++C,N.car==b){S=N;break}}null==S?Nl.trace("warning: couldn't find a bot to which the car belongs to",{fileName:"ItemDo.hx",lineNumber:319,className:"bikas.game.ItemDo",methodName:"updatePickableItem"}):e.type==Ci.PowerQuestion?(S.abilities.current_ability=ye.None,S.abilities.received_ability=Mi.getRandomAbility(t.ability_probabilities,S.car,l),S.abilities.bot_ability_receive_time_stamp=z):e.type==Ci.Nitro?S.abilities.nitro_power_charge+=1:e.type!=Ci.BotJumpIndicator&&(e.type==Ci.AttachmentBalloons?Vn.spawnAttachment(t,t.partition_top,t.entity_partition_container,S.car,Be.AttachmentBalloon,Le.balloon_time):e.type==Ci.AttachmentAnchor&&Vn.spawnAttachment(t,t.partition_top,t.entity_partition_container,S.car,Be.AttachmentAnchor,Le.balloon_time))}}}}if(e.state==Ni.TransitionOut){e.transition_out_current_time+=i;var P=0;1<(P=e.type==Ci.TreasureChest?e.transition_out_current_time/Pi.transition_out_treasure_chest_total_time:e.transition_out_current_time/Pi.transition_out_total_time)&&(P=1);var M=va.linear(1,4,P),I=va.linear(1,.4,P),T=1-P;e.type==Ci.PowerQuestion?(e.light.alpha=T,e.light.scale.x=M,e.light.scale.y=M,e.anim.sprite.alpha=I):e.type==Ci.Coin?(e.anim.sprite.alpha=T,e.entity.display.sprite.scale.x=M,e.entity.display.sprite.scale.y=M):e.type==Ci.Nitro?(e.anim.sprite.alpha=T,e.entity.display.sprite.scale.x=M,e.entity.display.sprite.scale.y=M):e.type==Ci.TreasureChest?(e.entity.display.sprite.alpha=T,e.entity.display.sprite.scale.x=M,e.entity.display.sprite.scale.y=M):e.type!=Ci.BotJumpIndicator&&(e.type==Ci.AttachmentBalloons?(e.entity.display.sprite.alpha=T,e.entity.display.sprite.scale.x=M,e.entity.display.sprite.scale.y=M):e.type==Ci.AttachmentAnchor?(e.entity.display.sprite.alpha=T,e.entity.display.sprite.scale.x=M,e.entity.display.sprite.scale.y=M):Nl.trace("warning: unhandled type "+p.string(e.type),{fileName:"ItemDo.hx",lineNumber:390,className:"bikas.game.ItemDo",methodName:"updatePickableItem"})),1==P&&(e.state=Ni.Picked,null!=e.entity&&e.type!=Ci.PowerQuestion&&(e.entity.display.sprite.visible=!1),null!=e.light&&(e.light.visible=!1))}if(0<e.pickup_scale_current_time){e.pickup_scale_current_time-=i;var D=e.pickup_scale_current_time/Pi.pickup_scale_time;D<0&&(D=0);var E=va.linearForwardAndBackward(1,1.3,1-D);null!=e.anim&&(e.anim.sprite.scale.x=E,e.anim.sprite.scale.y=E)}};var Ii=function(){};(n["bikas.game.KeyboardDo"]=Ii).__name__=["bikas","game","KeyboardDo"],Ii.isPressed=function(e,t){return-1!=e.indexOf(t)},Ii.isReleased=function(e,t){return-1!=e.indexOf(t)},Ii.isAnyPressed=function(e,t){for(var n=0;n<t.length;){var i=t[n];if(++n,-1!=e.indexOf(i))return!0}return!1},Ii.isAnyReleased=function(e,t){for(var n=0;n<t.length;){var i=t[n];if(++n,-1!=e.indexOf(i))return!0}return!1},Ii.updateKeyboard=function(e,t,n){"keydown"==n.type?-1==e.indexOf(n.keyCode)&&e.push(n.keyCode):"keyup"==n.type&&(-1!=e.indexOf(n.keyCode)&&s.remove(e,n.keyCode),-1==t.indexOf(n.keyCode)&&t.push(n.keyCode))};var Ti=function(){};(n["bikas.game.Indicator"]=Ti).__name__=["bikas","game","Indicator"],Ti.prototype={threshold:null,sprite:null,__class__:Ti};var Ai=n["bikas.game.LevelStatsState"]={__ename__:["bikas","game","LevelStatsState"],__constructs__:["StatsPlace","StatsStunts","StatsFinished","StatsWaiting"]};Ai.StatsPlace=["StatsPlace",0],Ai.StatsPlace.toString=i,(Ai.StatsPlace.__enum__=Ai).StatsStunts=["StatsStunts",1],Ai.StatsStunts.toString=i,(Ai.StatsStunts.__enum__=Ai).StatsFinished=["StatsFinished",2],Ai.StatsFinished.toString=i,(Ai.StatsFinished.__enum__=Ai).StatsWaiting=["StatsWaiting",3],Ai.StatsWaiting.toString=i,(Ai.StatsWaiting.__enum__=Ai).__empty_constructs__=[Ai.StatsPlace,Ai.StatsStunts,Ai.StatsFinished,Ai.StatsWaiting];var Di=n["bikas.game.LevelStatsClickAction"]={__ename__:["bikas","game","LevelStatsClickAction"],__constructs__:["None","StatsClickRestart","StatsClickContinue"]};Di.None=["None",0],Di.None.toString=i,(Di.None.__enum__=Di).StatsClickRestart=["StatsClickRestart",1],Di.StatsClickRestart.toString=i,(Di.StatsClickRestart.__enum__=Di).StatsClickContinue=["StatsClickContinue",2],Di.StatsClickContinue.toString=i,(Di.StatsClickContinue.__enum__=Di).__empty_constructs__=[Di.None,Di.StatsClickRestart,Di.StatsClickContinue];var Ei=function(){this.actual_chests_rewarded=0,this.want_to_reward_chests=0,this.famobi_score_posted=!1,this.famobi_score_success=!1,this.famobi_score_counting_completed=!1,this.final_level_percent=0,this.text_alpha_current_time=0,this.text_alpha_start=0,this.text_alpha_end=1,this.button_anim_current_scale_time=0,this.button_anim_current_time=0,this.already_animated_indicators=[],this.indicator_anim_target=null,this.indicator_anim_current_time=0,this.menu_in_anim_current_time=0,this.pause_time=0,this.current_time=0,this.wait=!1,this.happy_shown=!1,this.indicators=[],this.continue_available=!1,this.click_action=Di.None,this.state=Ai.StatsPlace};(n["bikas.game.LevelStats"]=Ei).__name__=["bikas","game","LevelStats"],Ei.prototype={state:null,click_action:null,continue_available:null,container:null,bar_container:null,chest_container:null,background:null,stat_background:null,chest:null,chest_text:null,continue_button:null,restart_button:null,empty_bar:null,full_bar:null,indicators:null,above_bar_text:null,inside_bar_text:null,bar_line:null,percentage_text:null,happy_shown:null,bar_x:null,bar_y:null,bar_width:null,bar_height:null,wait:null,current_time:null,pause_time:null,menu_in_anim_current_time:null,indicator_anim_current_time:null,indicator_anim_target:null,already_animated_indicators:null,button_anim_current_time:null,button_anim_current_scale_time:null,text_alpha_end:null,text_alpha_start:null,text_alpha_current_time:null,final_level_percent:null,famobi_score_counting_completed:null,famobi_score_success:null,famobi_score_posted:null,want_to_reward_chests:null,actual_chests_rewarded:null,__class__:Ei};var Oi=function(){};(n["bikas.game.LevelStatsDo"]=Oi).__name__=["bikas","game","LevelStatsDo"],Oi.create=function(){var e=new Ei;Ei.full_bar_red_texture=Hs.retrieveAsset("stat_full_bar_red"),Ei.full_bar_green_texture=Hs.retrieveAsset("stat_full_bar_green"),Ei.stat_indicator_empty=Hs.retrieveAsset("stat_indicator_empty"),Ei.stat_indicator_full=Hs.retrieveAsset("stat_indicator_full"),e.container=qa.createGroup(),e.bar_container=qa.createGroup(),e.chest_container=qa.createGroup(),e.background=qa.createSprite(Gs.menu_background,0,0),e.background.position.x=-1,e.background.position.y=-1,e.container.add(e.background),e.stat_background=qa.createSpriteByName("stat_background",0,0),e.continue_button=qa.createSprite(Gs.button_play,.5,.5),e.restart_button=qa.createSprite(Gs.button_restart,.5,.5),e.chest_text=new ms($s.game,0,0,fn.toonish_36,"",64),e.chest_text.anchor.x=.5,e.chest_text.anchor.y=.5,e.chest_text.text="0 x",e.chest=qa.createSpriteByName("treasure_chest_closed",.5,.5),e.chest.scale.x=2,e.chest.scale.y=2,e.chest.x=e.chest.width/2-35,e.chest_text.x=-e.chest.width/2+35,e.chest_container.add(e.chest_text),e.chest_container.add(e.chest),e.empty_bar=qa.createSpriteByName("stat_empty_bar",0,0),e.full_bar=qa.createSprite(Ei.full_bar_red_texture,0,0);var t=function(e,t,n,i,r){var a=new Ti;return a.sprite=qa.createSprite(Ei.stat_indicator_empty,.5,0),a.threshold=r,a.sprite.position.x=e+n*a.threshold,a.sprite.position.y=t+i,a};e.above_bar_text=new ms($s.game,0,0,fn.bell_gothic_std_black_light_26,"",42),e.above_bar_text.alpha=0,e.inside_bar_text=new ms($s.game,0,0,fn.bell_gothic_std_black_dark_26,"",42),e.inside_bar_text.alpha=0,e.bar_line=qa.createSpriteByName("stat_bar_line",0,0),e.bar_line.alpha=0,e.percentage_text=new ms($s.game,0,0,fn.avantgarde_lt_medium_light_26,"0%",42),e.percentage_text.alpha=0;var n=e.bar_width=e.empty_bar.width,i=e.bar_height=e.empty_bar.height,r=e.bar_x=-n/2,a=e.bar_y=-i/2;e.indicators.push(t(r,a,n,i,.6*Ei.place_coeff)),e.indicators.push(t(r,a,n,i,.9)),e.empty_bar.position.x=r,e.empty_bar.position.y=a,e.full_bar.position.x=r+5.5,e.full_bar.position.y=a+5.5,e.full_bar.scale.x=0,e.full_bar.scale.y=1,e.percentage_text.x=r+n+10,e.percentage_text.y=a+i/2-e.percentage_text.height/2,e.bar_container.add(e.empty_bar),e.bar_container.add(e.full_bar);for(var s=0,l=e.indicators;s<l.length;){var o=l[s];++s,e.bar_container.add(o.sprite)}return e.bar_container.add(e.above_bar_text),e.bar_container.add(e.inside_bar_text),e.bar_container.add(e.bar_line),e.bar_container.add(e.percentage_text),e.container.add(e.stat_background),e.container.add(e.chest_container),e.container.add(e.bar_container),e.container.add(e.continue_button),e.container.add(e.restart_button),e},Oi.clickContinue=function(e,t,n,i){e.chests_rewarded=t.actual_chests_rewarded,n.chests+=e.chests_collected_guids.length+e.chests_rewarded,t.want_to_reward_chests=0,t.actual_chests_rewarded=0,t.click_action=Di.StatsClickContinue,Ms.playSound(Gs.sound_click,i),Nl.trace("click continue",{fileName:"LevelStatsDo.hx",lineNumber:189,className:"bikas.game.LevelStatsDo",methodName:"clickContinue"})},Oi.clickRestart=function(e,t){e.click_action=Di.StatsClickRestart,Ms.playSound(Gs.sound_click,t)},Oi.remove=function(e){null!=e.container.parent&&e.container.parent.removeChild(e.container),e.state=Ai.StatsPlace,e.click_action=Di.None,e.current_time=0,e.menu_in_anim_current_time=0},Oi.update=function(e,t,n,i,r,a,s,l,o,_,p,u,h){t.container.parent!=o&&(null!=t.container.parent&&t.container.parent.removeChild(t.container),o.add(t.container),t.current_time=0,t.menu_in_anim_current_time=0),0<Ei.test_overwrite_place&&(i=Ei.test_overwrite_place),0<Ei.test_overwrite_stunts&&(r=Ei.test_overwrite_stunts);var c=_.current_game_width+2,d=_.current_game_height+2;if(t.background.width==c&&t.background.height==d||(t.background.width=c,t.background.height=d),t.background.alpha!=Ei.background_alpha&&(t.background.alpha=Ei.background_alpha),0==t.current_time&&0==t.menu_in_anim_current_time){t.state=Ai.StatsPlace,t.click_action=Di.None,t.bar_container.alpha=0,t.chest_container.alpha=0,t.chest_text.text="0 x",t.full_bar.width=0,t.above_bar_text.alpha=0,t.inside_bar_text.alpha=0,t.percentage_text.alpha=0,t.bar_line.alpha=0,t.pause_time=0,t.already_animated_indicators=[],t.wait=!1,t.button_anim_current_time=0,t.button_anim_current_scale_time=0,t.continue_button.alpha=0,t.restart_button.alpha=0,t.restart_button.scale.x=1,t.restart_button.scale.y=1,t.continue_button.scale.x=1,t.continue_button.scale.y=1,t.text_alpha_start=0,t.text_alpha_end=1,t.text_alpha_current_time=0,t.final_level_percent=-1,t.want_to_reward_chests=0,t.actual_chests_rewarded=0,t.menu_in_anim_current_time=u.step_size,t.happy_shown=!1,t.famobi_score_posted=!1,t.famobi_score_counting_completed=!1;for(var m=0,f=t.indicators;m<f.length;){var g=f[m];++m,g.sprite.setTexture(Ei.stat_indicator_empty)}Ms.playSound(Gs.sound_menu_phase_in,h)}else if(t.menu_in_anim_current_time<=Ei.menu_in_time){t.menu_in_anim_current_time+=u.step_size;var v=ma.clamp0to1(t.menu_in_anim_current_time/Ei.menu_in_time),b=va.linear(0,1,v),y=va.smoothStart(Ei.menu_initial_scale,Ei.chest_scale,v),x=va.smoothStart(Ei.menu_initial_scale,Ei.bar_scale,v);t.chest_container.alpha=b,t.chest_container.scale.x=y,t.chest_container.scale.y=y,t.stat_background.alpha=b,t.stat_background.scale.x=x,t.stat_background.scale.y=x,t.bar_container.alpha=b,t.bar_container.scale.x=x,t.bar_container.scale.y=x,t.pause_time=-Ei.pause_time_in_seconds}else{t.text_alpha_current_time+=u.step_size;var z=va.linearClamped(t.text_alpha_start,t.text_alpha_end,t.text_alpha_current_time/Ei.text_alpha_time);t.above_bar_text.alpha=z,t.inside_bar_text.alpha=z,t.bar_line.alpha=z,t.percentage_text.alpha=1,t.pause_time<0?t.pause_time+=u.step_size:t.current_time+=u.step_size;var w=va.linear(1/l,1,1-(i-1)/(l-1))*Ei.place_coeff,k=r*Ei.stunt_coeff;t.final_level_percent=Math.floor(100*(w+k));var S=Ei.bar_time_in_seconds,C=ma.clamp(t.current_time/S,0,1),N="",P="";t.state==Ai.StatsPlace?(N="Place",P=Ei.place_names[i],w<=C&&(C=w,t.wait?0<=t.pause_time&&(t.state=Ai.StatsStunts,t.wait=!1):(t.pause_time=-Ei.pause_time_in_seconds,t.wait=!0))):(N="Stunts",P=Math.round(100*r)+"%",t.state==Ai.StatsStunts?w+k<=C&&(C=w+k,t.wait?0<=t.pause_time&&(t.state=Ai.StatsFinished,t.wait=!1):(t.pause_time=-Ei.pause_time_in_seconds,t.wait=!0)):t.state==Ai.StatsFinished?(C=w+k,t.text_alpha_start=1,t.text_alpha_end=0,t.text_alpha_current_time=0,t.state=Ai.StatsWaiting):t.state==Ai.StatsWaiting&&(C=w+k)),t.inside_bar_text.text!=P&&(t.inside_bar_text.text=P),t.above_bar_text.text!=N&&(t.above_bar_text.text=N),(t.state==Ai.StatsPlace||t.state==Ai.StatsStunts)&&!t.wait&&0<C?Ms.isMusicPlaying(Gs.sound_loop_score)||Ms.fadeInMusic(Gs.sound_loop_score,.1):Ms.isMusicPlaying(Gs.sound_loop_score)&&Ms.fadeOutMusic(Gs.sound_loop_score,.1),Ms.updateMusic(Gs.sound_loop_score,h);var M=va.linear(t.bar_x,t.bar_x+t.bar_width,C),I=Math.round(100*C)+"%";t.percentage_text.text!=I&&(100!=Math.round(100*C)||1!=$s.config.type||3!=$s.config.release.sitelock_type||t.happy_shown||(t.happy_shown=!0,es.PokiSDK.happyTime(.1)),t.percentage_text.text=I),t.above_bar_text.x=M-t.above_bar_text.width-20,t.above_bar_text.y=t.bar_y-t.above_bar_text.height-10,t.inside_bar_text.x=M-t.inside_bar_text.width-20,t.inside_bar_text.y=t.bar_y+t.bar_height/2-t.inside_bar_text.height/2,t.bar_line.x=va.linear(t.bar_x,t.bar_x+t.bar_width,C),t.bar_line.y=t.bar_y+t.bar_height-t.bar_line.height,t.full_bar.scale.x=C;for(var T=function(e,t,n,i,r){if(n<=C){var a=e.indicators[i];if(-1==e.already_animated_indicators.indexOf(a)){e.indicator_anim_target=a,e.indicator_anim_current_time=0,e.already_animated_indicators.push(a),a.sprite.setTexture(Ei.stat_indicator_full),e.want_to_reward_chests+=1;var s=e.actual_chests_rewarded;e.actual_chests_rewarded=e.want_to_reward_chests,e.actual_chests_rewarded>s&&Ms.playSound(Gs.sound_treasure,r),Ms.playSound(Gs.sound_stat_threshold_pass,r)}}},A=0,D=t.indicators.length;A<D;){var E=A++;T(t,0,t.indicators[E].threshold-.0095,E,h)}var O=a.chests_collected_guids.length+t.actual_chests_rewarded+" x";if(t.chest_text.text!=O&&(t.chest_text.text=O),null!=t.indicator_anim_target){t.indicator_anim_current_time+=u.step_size;var B=ma.clamp(t.indicator_anim_current_time/Ei.indicator_anim_time,0,1),L=va.smoothForwardAndBackward(1,Ei.indicator_anim_scale,B),j=va.smoothForwardAndBackward(1,Ei.chest_anim_scale,B);t.indicator_anim_target.sprite.scale.x=L,t.indicator_anim_target.sprite.scale.y=L,t.chest.scale.x=j*Ei.chest_default_scale,t.chest.scale.y=j*Ei.chest_default_scale,t.chest_text.scale.x=j,t.chest_text.scale.y=j,1==B&&(t.indicator_anim_target=null)}var F=1;if(C>=t.indicators[0].threshold-.0095?t.full_bar.texture!=Ei.full_bar_green_texture&&t.full_bar.setTexture(Ei.full_bar_green_texture):t.full_bar.texture!=Ei.full_bar_red_texture&&t.full_bar.setTexture(Ei.full_bar_red_texture),t.state==Ai.StatsWaiting&&(t.above_bar_text.alpha=1,t.above_bar_text.x=t.bar_x,t.above_bar_text.text="Place: "+Ei.place_names[i]+", Stunts: "+Math.round(100*r)+"%",t.button_anim_current_time+=u.step_size,t.famobi_score_counting_completed=!0,C>=t.indicators[0].threshold-.0095?(t.continue_available=!0,t.famobi_score_success=!0):(t.continue_available=!1,t.famobi_score_success=!1),F=ma.clamp(t.button_anim_current_time/Ei.button_anim_time,0,1),t.continue_available?t.continue_button.alpha=va.linear(0,1,F):t.continue_button.alpha=va.linear(0,Ei.continue_button_inactive_alpha,F),t.restart_button.alpha=va.smoothStartEnd(0,1,F),t.continue_button.scale.x=Ei.button_scale,t.continue_button.scale.y=Ei.button_scale,t.restart_button.scale.x=Ei.button_scale,t.restart_button.scale.y=Ei.button_scale,1==F)){t.button_anim_current_scale_time+=u.step_size,t.button_anim_current_scale_time>=Ei.button_scale_anim_time&&(t.button_anim_current_scale_time=0);var R=ma.clamp(t.button_anim_current_scale_time/Ei.button_scale_anim_time,0,1),G=va.smoothForwardAndBackward(Ei.button_scale,Ei.button_anim_scale,R);if(t.continue_available){if(t.continue_button.scale.x=G,t.continue_button.scale.y=G,t.restart_button.scale.x=Ei.button_scale,t.restart_button.scale.y=Ei.button_scale,Ii.isReleased(e.keyboard_keys_released,32))return void Oi.clickContinue(a,t,s,h);if(Vn.isObjectDownedInRadius(t.continue_button,p,80))return void Oi.clickContinue(a,t,s,h)}else t.restart_button.scale.x=G,t.restart_button.scale.y=G,t.continue_button.scale.x=Ei.button_scale,t.continue_button.scale.y=Ei.button_scale;if(Vn.isObjectDownedInRadius(t.restart_button,p,80))return void Oi.clickRestart(t,h)}}t.bar_container.position.x=_.current_game_width/2;var Z=_.current_game_height*Ei.bar_placement_y_coeff;t.bar_container.position.y=va.linear(Z+Ei.bar_offset_middle_y,Z+Ei.bar_offset_top_y,t.restart_button.alpha),t.stat_background.position.x=_.current_game_width/2-t.stat_background.width/2,t.stat_background.position.y=_.current_game_height*Ei.bar_placement_y_coeff-t.stat_background.height/2,t.chest_container.position.x=_.current_game_width/2,t.chest_container.position.y=_.current_game_height/2+Ei.chest_offset_y,t.continue_button.position.x=_.current_game_width/2+Ei.distance_between_buttons/2,t.continue_button.position.y=t.bar_container.position.y+Ei.buttons_offset_y,t.restart_button.position.x=_.current_game_width/2-Ei.distance_between_buttons/2,t.restart_button.position.y=t.continue_button.position.y};var Bi=n["bikas.game.MainMenuState"]={__ename__:["bikas","game","MainMenuState"],__constructs__:["StartZoomIn","ZoomingIn","PhasingInMenu","Idle"]};Bi.StartZoomIn=["StartZoomIn",0],Bi.StartZoomIn.toString=i,(Bi.StartZoomIn.__enum__=Bi).ZoomingIn=["ZoomingIn",1],Bi.ZoomingIn.toString=i,(Bi.ZoomingIn.__enum__=Bi).PhasingInMenu=["PhasingInMenu",2],Bi.PhasingInMenu.toString=i,(Bi.PhasingInMenu.__enum__=Bi).Idle=["Idle",3],Bi.Idle.toString=i,(Bi.Idle.__enum__=Bi).__empty_constructs__=[Bi.StartZoomIn,Bi.ZoomingIn,Bi.PhasingInMenu,Bi.Idle];var Li=n["bikas.game.MainMenuClickAction"]={__ename__:["bikas","game","MainMenuClickAction"],__constructs__:["ContinueTheGame","StartNewGame","None"]};Li.ContinueTheGame=["ContinueTheGame",0],Li.ContinueTheGame.toString=i,(Li.ContinueTheGame.__enum__=Li).StartNewGame=["StartNewGame",1],Li.StartNewGame.toString=i,(Li.StartNewGame.__enum__=Li).None=["None",2],Li.None.toString=i,(Li.None.__enum__=Li).__empty_constructs__=[Li.ContinueTheGame,Li.StartNewGame,Li.None];var ji=n["bikas.game.CreditsState"]={__ename__:["bikas","game","CreditsState"],__constructs__:["Opened","Closed"]};ji.Opened=["Opened",0],ji.Opened.toString=i,(ji.Opened.__enum__=ji).Closed=["Closed",1],ji.Closed.toString=i,(ji.Closed.__enum__=ji).__empty_constructs__=[ji.Opened,ji.Closed];var Fi=n["bikas.game.GameSaveType"]={__ename__:["bikas","game","GameSaveType"],__constructs__:["LoadedGameNoSave","LoadedGameWithSave","ContinueGame"]};Fi.LoadedGameNoSave=["LoadedGameNoSave",0],Fi.LoadedGameNoSave.toString=i,(Fi.LoadedGameNoSave.__enum__=Fi).LoadedGameWithSave=["LoadedGameWithSave",1],Fi.LoadedGameWithSave.toString=i,(Fi.LoadedGameWithSave.__enum__=Fi).ContinueGame=["ContinueGame",2],Fi.ContinueGame.toString=i,(Fi.ContinueGame.__enum__=Fi).__empty_constructs__=[Fi.LoadedGameNoSave,Fi.LoadedGameWithSave,Fi.ContinueGame];var Ri=n["bikas.game.TriggerGameType"]={__ename__:["bikas","game","TriggerGameType"],__constructs__:["None","ResumeGame","ContinueToFirstLevel","LoadGame","StartNewGame"]};Ri.None=["None",0],Ri.None.toString=i,(Ri.None.__enum__=Ri).ResumeGame=["ResumeGame",1],Ri.ResumeGame.toString=i,(Ri.ResumeGame.__enum__=Ri).ContinueToFirstLevel=["ContinueToFirstLevel",2],Ri.ContinueToFirstLevel.toString=i,(Ri.ContinueToFirstLevel.__enum__=Ri).LoadGame=["LoadGame",3],Ri.LoadGame.toString=i,(Ri.LoadGame.__enum__=Ri).StartNewGame=["StartNewGame",4],Ri.StartNewGame.toString=i,(Ri.StartNewGame.__enum__=Ri).__empty_constructs__=[Ri.None,Ri.ResumeGame,Ri.ContinueToFirstLevel,Ri.LoadGame,Ri.StartNewGame];var Gi=function(e,t,n){null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=n};(n["bikas.global.Point3"]=Gi).__name__=["bikas","global","Point3"],Gi.prototype={x:null,y:null,z:null,__class__:Gi};var Zi=function(){this.sounds_enabled=!0,this.current_time=0,this.clouds=[],this.yachts=[],this.new_game_card=null,this.credits_card=null,this.credits_state=ji.Closed,this.all_buttons=[],this.famobi_reference=null,this.famobi_more_games_button_scaled=!1,this.famobi_more_games_button=null,this.credits_button=null,this.start_new_game_button=null,this.continue_button=null,this.button_group=null,this.logo_camera_marker=null,this.menu_camera_marker=null,this.trigger_game_type=Ri.None,this.game_save=null,this.game_save_type=Fi.LoadedGameNoSave,this.in_ad=!1,this.click_action=Li.None,this.state=Bi.StartZoomIn};(n["bikas.game.MainMenu"]=Zi).__name__=["bikas","game","MainMenu"],Zi.prototype={state:null,click_action:null,in_ad:null,game_save_type:null,game_save:null,trigger_game_type:null,menu_camera_marker:null,logo_camera_marker:null,button_group:null,continue_button:null,start_new_game_button:null,credits_button:null,famobi_more_games_button:null,famobi_more_games_button_scaled:null,famobi_reference:null,all_buttons:null,credits_state:null,credits_card:null,new_game_card:null,yachts:null,clouds:null,current_time:null,sounds_enabled:null,__class__:Zi};var Ui=function(){};(n["bikas.game.MainMenuDo"]=Ui).__name__=["bikas","game","MainMenuDo"],Ui.create=function(e,t,n,i){var r=new Zi;if(r.game_save_type=n,r.game_save=i,r.menu_camera_marker=Vn.findMarker(t,"menu camera"),r.logo_camera_marker=Vn.findMarker(t,"logo camera"),r.button_group=qa.createGroup(),r.continue_button=null!=i?qa.createSpriteByName("button_continue",.5,0):null,r.start_new_game_button=qa.createSpriteByName("button_new_game",.5,0),r.credits_button=qa.createSpriteByName("button_credits",.5,0),null!=r.continue_button?(r.start_new_game_button.setTexture(Hs.getTexture("button_new_game")),r.all_buttons=[r.continue_button,r.start_new_game_button,r.credits_button]):(r.start_new_game_button.setTexture(Hs.getTexture("button_new_game_light")),r.all_buttons=[r.start_new_game_button,r.credits_button]),4==e.release.sitelock_type){window.famobi.hasFeature("credits")||r.all_buttons.splice(r.all_buttons.indexOf(r.credits_button),1);var a=lo.get_window();if(null!=a.famobi){r.famobi_reference=a.famobi;var s=a.famobi.getMoreGamesButtonImage(!0),l=PIXI.Texture.fromImage(s);null!=l&&(r.famobi_more_games_button=qa.createSprite(l,.5,0,0,0),r.famobi_more_games_button.buttonMode=!0,r.famobi_more_games_button.interactive=!0,r.famobi_more_games_button.on("pointerdown",function(e){r.famobi_reference.moreGamesLink(),Ms.playSound(Gs.sound_click,r.sounds_enabled),Nl.trace("famobi moreGamesClick",{fileName:"MainMenuDo.hx",lineNumber:97,className:"bikas.game.MainMenuDo",methodName:"create"})}),r.all_buttons.push(r.famobi_more_games_button))}}for(var o=0,_=r.all_buttons;o<_.length;){var p=_[o];++o,r.button_group.add(p)}return r.button_group.alpha=0,r},Ui.sortButtons=function(e){for(var t=0,n=e.all_buttons;t<n.length;){var i=n[t];++t,i.visible=!1}for(var r=-e.all_buttons.length/2*Zi.button_distance_y,a=0,s=e.all_buttons.length;a<s;){var l=a++,o=e.all_buttons[l];o.visible=!0,o.position.x=0,o.position.y=r+l*Zi.button_distance_y}},Ui.continueClick=function(e,t){e.game_save_type==Fi.LoadedGameNoSave?Nl.trace("warning: continue button should not exist if menu.game_save_type == "+p.string(e.game_save_type),{fileName:"MainMenuDo.hx",lineNumber:145,className:"bikas.game.MainMenuDo",methodName:"continueClick"}):e.game_save_type==Fi.LoadedGameWithSave?null==e.game_save?Nl.trace("warning: menu.game_save == null",{fileName:"MainMenuDo.hx",lineNumber:149,className:"bikas.game.MainMenuDo",methodName:"continueClick"}):(Ms.playSound(Gs.sound_level_select,t),e.trigger_game_type=Ri.LoadGame):e.game_save_type==Fi.ContinueGame?e.trigger_game_type=Ri.ResumeGame:Nl.trace("warning: unhandled "+p.string(e.game_save_type),{fileName:"MainMenuDo.hx",lineNumber:159,className:"bikas.game.MainMenuDo",methodName:"continueClick"})},Ui.destroy=function(e){e.menu_camera_marker=null,e.logo_camera_marker=null;for(var t=0,n=e.all_buttons;t<n.length;){var i=n[t];++t,i.buttonMode=!1,i.interactive=!1,i.destroy(!0)}e.button_group.destroy(!0),e.button_group=null,e.continue_button=null,e.start_new_game_button=null,e.credits_button=null,(e.all_buttons=null)!=e.credits_card&&(zi.destroyRequirementAndRewardCard(e.credits_card),e.credits_card=null),null!=e.new_game_card&&(zi.destroyConfirmationCard(e.new_game_card),e.new_game_card=null),e.yachts=null,e.clouds=null},Ui.update=function(e,t,n,i,r,a,s,l,o,_,u,h,c,d,m){if((null!=e.menu_camera_marker||(Nl.trace("warning: menu.menu_camera_marker == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.MainMenuDo",methodName:"update"}),0))&&!e.in_ad){if(e.sounds_enabled=d,null!=e.famobi_more_games_button&&!e.famobi_more_games_button_scaled&&null!=e.famobi_more_games_button.texture&&10<e.famobi_more_games_button.width){e.famobi_more_games_button_scaled=!0;var f=e.credits_button.width;if(e.famobi_more_games_button.width>f){var g=f/e.famobi_more_games_button.width;e.famobi_more_games_button.scale.x=g,e.famobi_more_games_button.scale.y=g}}var v=Gs.music_beach_waves;null!=v&&(Ms.isMusicPlaying(v)||Ms.fadeInMusic(v),Ms.updateMusic(v,m));var b=Gs.music_avocado_easy_times_in_hawaii;if(null!=b&&(Ms.isMusicPlaying(b)||Ms.fadeInMusic(b),Ms.updateMusic(b,m)),0==e.yachts.length&&0==e.clouds.length)for(var y=0,x=n.background_sprites;y<x.length;){var z=x[y];++y,z.sprite.texture==Gs.sailing_yacht||z.sprite.texture==Gs.sailing_yacht_scale_3?e.yachts.push(z):z.sprite.texture==Gs.clouds&&e.clouds.push(z)}for(var w=0,k=e.yachts;w<k.length;){var S=k[w];++w,S.position.x+=Zi.yacht_speed*c.dc,_s.updateSpritePoints(S)}for(var C=0,N=e.clouds;C<N.length;){var P=N[C];++C,P.position.x+=Zi.cloud_speed*c.dc,_s.updateSpritePoints(P)}if(e.button_group.position.x=Zi.button_position_x_width_coeff*u.current_game_width,e.button_group.position.y=Zi.button_position_y_height_coeff*u.current_game_height,e.state==Bi.StartZoomIn&&(e.current_time=0,e.game_save_type!=Fi.LoadedGameNoSave?(r.x=e.menu_camera_marker.position.x,r.y=e.menu_camera_marker.position.y,i.z=0,e.state=Bi.PhasingInMenu):(a.current_pos.set_x(Zi.start_point.x),a.current_pos.set_y(Zi.start_point.y),e.state=Bi.ZoomingIn),e.button_group.alpha=0),e.state==Bi.ZoomingIn){e.current_time+=c.step_size;var M=ma.clamp0to1(e.current_time/Zi.zoom_time);M=va.smoothEnd(0,1,M),r.x=va.smoothStartEnd(Zi.start_point.x,e.menu_camera_marker.position.x,M),r.y=va.smoothStartEnd(Zi.start_point.y,e.menu_camera_marker.position.y,M),i.z=va.smoothStartEnd(Zi.start_point.z,0,M),Zi.camera_tied&&(a.current_pos.set_x(r.x),a.current_pos.set_y(r.y)),1==M&&(e.state=Bi.PhasingInMenu,e.current_time=0)}if(e.state==Bi.PhasingInMenu){null==e.button_group.parent&&_.addAt(e.button_group,0),0==e.current_time&&Ui.sortButtons(e),e.current_time+=c.step_size;var I=ma.clamp0to1(e.current_time/Zi.button_time);1==(e.button_group.alpha=I)&&(e.state=Bi.Idle)}if(e.state,Bi.Idle,e.state==Bi.PhasingInMenu||e.state==Bi.Idle){var T=$a.getPointerDowned(h);null!=T&&(zi.isRectangularButtonDowned(T,e.button_group,e.continue_button,xi.finger_radius)?(T.cancel_upped_and_clicked=!0,Ms.playSound(Gs.sound_click,d),$s.config.release.sitelock_type,1==$s.config.type&&3==$s.config.release.sitelock_type?(e.in_ad=!0,es.PokiSDK.commercialBreak().then(function(){e.in_ad=!1,Ui.continueClick(e,d)})):Ui.continueClick(e,d)):zi.isRectangularButtonDowned(T,e.button_group,e.start_new_game_button,xi.finger_radius)?(T.cancel_upped_and_clicked=!0,e.game_save_type==Fi.LoadedGameNoSave?(e.trigger_game_type=Ri.ContinueToFirstLevel,Ms.playSound(Gs.sound_level_select,d)):e.game_save_type==Fi.LoadedGameWithSave?(null!=e.new_game_card&&zi.destroyConfirmationCard(e.new_game_card),e.new_game_card=zi.createConfirmationCard("button_go","Delete Progress and\nStart New Game?"),_.add(e.new_game_card.container),e.credits_state=ji.Closed):e.game_save_type==Fi.ContinueGame?(null!=e.new_game_card&&zi.destroyConfirmationCard(e.new_game_card),e.new_game_card=zi.createConfirmationCard("button_go","Delete Progress and\nStart New Game?"),_.add(e.new_game_card.container),e.credits_state=ji.Closed):Nl.trace("warning: unhandled "+p.string(e.game_save_type),{fileName:"MainMenuDo.hx",lineNumber:433,className:"bikas.game.MainMenuDo",methodName:"update"}),Ms.playSound(Gs.sound_click,d)):zi.isRectangularButtonDowned(T,e.button_group,e.credits_button,xi.finger_radius)&&(T.cancel_upped_and_clicked=!0,e.credits_state==ji.Opened?e.credits_state=ji.Closed:(e.credits_state=ji.Opened,ka.trackCreditsClicked()),Ms.playSound(Gs.sound_click,d)))}if(null!=e.new_game_card){var A=e.new_game_card;A.container.position.x=u.current_game_width*Zi.credits_menu_x_coeff-A.background.width/2,A.container.position.y=u.current_game_height*Zi.credits_menu_y_coeff-A.background.height/2;var D=zi.processCardClick(h,d,A.container,A.button_close,A.button_main);D==gi.DownedMainButton?(e.trigger_game_type=Ri.StartNewGame,Ms.playSound(Gs.sound_level_select,d)):D==gi.DownedCloseButton?(zi.destroyConfirmationCard(e.new_game_card),e.new_game_card=null):D==gi.DownedOutside&&(zi.destroyConfirmationCard(e.new_game_card),e.new_game_card=null)}if(window.famobi.hasFeature("credits")&&(e.credits_state==ji.Closed&&null!=e.credits_card&&(zi.destroyRequirementAndRewardCard(e.credits_card),e.credits_card=null),e.credits_state==ji.Opened)){if(null!=e.new_game_card&&(zi.destroyConfirmationCard(e.new_game_card),e.new_game_card=null),null==e.credits_card){var E=new ea(256.9,55),O=new ea(256.9,140.4),B=new ea(61,218),L=e.credits_card=zi.createRequirementAndRewardCard("achievement_card","achievement_balloons",null,null,E,O,B,new ea(61,328),null,"Credits",400,"","","","","",400);e.credits_card.requirement_text.text="Code by Bikas.net (bikasflash@yahoo.com) \n\nArt by Gudo1 \n\nMusic by StereoSpice and Avocado",e.credits_card.reward_text.text="",e.credits_card.requirement_highlight.visible=!1,e.credits_card.reward_highlight.visible=!1,_.add(L.container)}var j=e.credits_card,F=zi.processCardClick(h,d,j.container,j.close_button,null);F==gi.DownedCloseButton?e.credits_state=ji.Closed:F==gi.DownedOutside&&(e.credits_state=ji.Closed),j.container.position.x=u.current_game_width*Zi.credits_menu_x_coeff-j.background.width/2,j.container.position.y=u.current_game_height*Zi.credits_menu_y_coeff-j.background.height/2}}};var Vi=n["bikas.game.BoxState"]={__ename__:["bikas","game","BoxState"],__constructs__:["Normal","Broken","Passive","Removed"]};Vi.Normal=["Normal",0],Vi.Normal.toString=i,(Vi.Normal.__enum__=Vi).Broken=["Broken",1],Vi.Broken.toString=i,(Vi.Broken.__enum__=Vi).Passive=["Passive",2],Vi.Passive.toString=i,(Vi.Passive.__enum__=Vi).Removed=["Removed",3],Vi.Removed.toString=i,(Vi.Removed.__enum__=Vi).__empty_constructs__=[Vi.Normal,Vi.Broken,Vi.Passive,Vi.Removed];var qi=function(){this.impulses=[],this.temp_impulse=0,this.current_alpha_out_time=0,this.velocity_before=0,this.pieces_interaction_time=30,this.pieces=[]};(n["bikas.game.Box"]=qi).__name__=["bikas","game","Box"],qi.prototype={state:null,group:null,main_entity:null,body:null,pieces:null,pieces_interaction_time:null,velocity_before:null,current_alpha_out_time:null,temp_impulse:null,impulses:null,__class__:qi};var Wi=n["bikas.game.BoxPieceState"]={__ename__:["bikas","game","BoxPieceState"],__constructs__:["Hidden","Active","Passive"]};Wi.Hidden=["Hidden",0],Wi.Hidden.toString=i,(Wi.Hidden.__enum__=Wi).Active=["Active",1],Wi.Active.toString=i,(Wi.Active.__enum__=Wi).Passive=["Passive",2],Wi.Passive.toString=i,(Wi.Passive.__enum__=Wi).__empty_constructs__=[Wi.Hidden,Wi.Active,Wi.Passive];var Xi=function(){};(n["bikas.game.BoxPiece"]=Xi).__name__=["bikas","game","BoxPiece"],Xi.prototype={state:null,group:null,main_entity:null,body:null,relative_pos:null,relative_rot:null,init_pos:null,init_rot:null,__class__:Xi};var Hi=n["bikas.game.TempInteractiveObjectType"]={__ename__:["bikas","game","TempInteractiveObjectType"],__constructs__:["Obstacle","Explosive"]};Hi.Obstacle=["Obstacle",0],Hi.Obstacle.toString=i,(Hi.Obstacle.__enum__=Hi).Explosive=["Explosive",1],Hi.Explosive.toString=i,(Hi.Explosive.__enum__=Hi).__empty_constructs__=[Hi.Obstacle,Hi.Explosive];var Yi=function(){this.interaction_time_beyond_distance=15,this.interactive_distance=10,this.only_to_ground=!1,this.timeout=!1,this.explosion_radius=300};(n["bikas.game.TempInteractiveObject"]=Yi).__name__=["bikas","game","TempInteractiveObject"],Yi.prototype={type:null,main_entity:null,body:null,init_pos:null,explosive:null,explosion_radius:null,timeout:null,only_to_ground:null,interactive_distance:null,interaction_time_beyond_distance:null,__class__:Yi};var Ji=n["bikas.game.ForwardRampType"]={__ename__:["bikas","game","ForwardRampType"],__constructs__:["Ramp","Booster"]};Ji.Ramp=["Ramp",0],Ji.Ramp.toString=i,(Ji.Ramp.__enum__=Ji).Booster=["Booster",1],Ji.Booster.toString=i,(Ji.Booster.__enum__=Ji).__empty_constructs__=[Ji.Ramp,Ji.Booster];var Ki=function(){this.anim_current_wait=0,this.anim_total_wait=15,this.texture_index=0,this.textures=[],this.applied_impulses=[],this.max_velocity=1500,this.total_impulse=200};(n["bikas.game.ForwardRamp"]=Ki).__name__=["bikas","game","ForwardRamp"],Ki.prototype={total_impulse:null,max_velocity:null,type:null,group:null,main_entity:null,body:null,top_left_bound:null,bottom_right_bound:null,force_angle:null,impulse:null,applied_impulses:null,impulse_cache:null,sprite:null,textures:null,texture_index:null,anim_total_wait:null,anim_current_wait:null,__class__:Ki};var Qi=function(){this.count=0};(n["bikas.game.ImpulseAppliedCount"]=Qi).__name__=["bikas","game","ImpulseAppliedCount"],Qi.prototype={car:null,count:null,__class__:Qi};var $i=function(){};(n["bikas.game.MapObjectDo"]=$i).__name__=["bikas","game","MapObjectDo"],$i.createBox=function(e){var t=new qi;t.state=Vi.Normal;for(var n=0,i=(t.group=e).group.entities;n<i.length;){var r=i[n];if(++n,null!=r.prefab)if(1!=r.group.entities.length)Nl.trace("something wrong with box piece",{fileName:"MapObjectDo.hx",lineNumber:51,className:"bikas.game.MapObjectDo",methodName:"createBox"});else if(null==r.group.entities[0].body)Nl.trace("something wrong with box piece",{fileName:"MapObjectDo.hx",lineNumber:54,className:"bikas.game.MapObjectDo",methodName:"createBox"});else{var a=new Xi;a.group=r,a.main_entity=r.group.entities[0],a.body=a.main_entity.body,a.body.setShapeMaterials(nr.box),t.pieces.push(a)}else null==r.body?Nl.trace("warning: something wrong with box",{fileName:"MapObjectDo.hx",lineNumber:66,className:"bikas.game.MapObjectDo",methodName:"createBox"}):(t.main_entity=r,t.body=r.body,t.body.setShapeMaterials(nr.box))}for(var s=0,l=t.pieces;s<l.length;){var o=l[s];++s,o.init_pos=y_.get(o.body.get_position().get_x(),o.body.get_position().get_y()),o.init_rot=o.body.get_rotation(),o.relative_pos=y_.get(),o.relative_pos.set_x(t.body.get_position().get_x()-o.body.get_position().get_x()),o.relative_pos.set_y(t.body.get_position().get_y()-o.body.get_position().get_y()),o.relative_rot=t.body.get_rotation()-o.body.get_rotation(),$i.setPieceState(t,o,Wi.Hidden)}return null==t.main_entity&&Nl.trace("warning: something wrong with box",{fileName:"MapObjectDo.hx",lineNumber:83,className:"bikas.game.MapObjectDo",methodName:"createBox"}),t},$i.destroyBox=function(e){if(null!=e.pieces)for(var t=0,n=e.pieces;t<n.length;){var i=n[t];++t,null!=i.relative_pos&&(i.relative_pos.dispose(),i.relative_pos=null),null!=i.init_pos&&(i.init_pos.dispose(),i.init_pos=null)}e.pieces=null,e.main_entity=null,e.body=null},$i.shouldBreakBox=function(e){var t=0;if(e.body.get_type()==M_.get_DYNAMIC()){t=Aa.getHighestImpulseFromCollisionArbitersOfDynamicBody(e.body);var n=e.body.get_velocity().get_length(),i=Math.abs(e.velocity_before-n);if(e.velocity_before=n,300<i)return!0}else if(t=Aa.getHighestImpulseFromCollisionArbitersOfStaticBody(e.body),null!=e.body.get_userData().just_applied_impulse_length){if(3e3<e.body.get_userData().just_applied_impulse_length)return!0;e.body.get_userData().just_applied_impulse_length=0}return 700<t},$i.breakBox=function(e,t,n){for(var i=0,r=e.pieces;i<r.length;){var a=r[i];++i,$i.setPieceState(e,a,Wi.Active),ce.refresh(a.main_entity)}$i.destroyLiveEntity(e.main_entity,t,n),e.main_entity=null,e.body=null,e.state=Vi.Broken},$i.destroyLiveEntity=function(e,t,n){s.remove(t,e);for(var i=0,r=n.all_objects;i<r.length;){var a=r[i];if(++i,a.display_object==e.display.sprite){Fa.destroyLiveObject(n,a,!1);break}}e.body.set_space(null),ie.destroyEntityIncludingChildren(e),e.body=null},$i.setPieceState=function(e,t,n){var i=t.body;if(n==Wi.Hidden?(t.main_entity.display.sprite.visible=!1,i.set_allowMovement(!1),i.set_allowRotation(!1),i.set_disableCCD(!0),i.setShapeFilters(Si.no_interaction)):n==Wi.Active?(t.main_entity.display.sprite.visible=!0,i.set_allowMovement(!0),i.set_allowRotation(!0),i.set_disableCCD(!1),i.setShapeFilters(Si.normal)):i.setShapeFilters(Si.only_to_ground),t.state==Wi.Hidden&&(n==Wi.Active||n==Wi.Passive)){var r=e.body.get_rotation()-t.relative_rot,a=t.relative_pos.copy().rotate(r-t.init_rot),s=e.body.get_position().sub(a);if(i.get_position().set(s),a.dispose(),s.dispose(),i.set_rotation(r),i.get_velocity().set(e.body.get_velocity()),n==Wi.Active){i.applyAngularImpulse((Math.random()*Math.PI*2-Math.PI)*i.get_inertia()*2);var l=200;i.get_userData().just_exploded&&(l=500,i.get_userData().just_exploded=!1);var o=y_.get(l*i.get_mass(),0);o.rotate(Math.random()*Math.PI*2),i.applyImpulse(o),o.dispose()}}t.state=n},$i.updateBox=function(e,t,n,i,r,a,s,l,o,_){var p=l.dc;if(e.state==Vi.Normal){if($i.shouldBreakBox(e)){var u=Gs.sound_box_break;"crate"==e.group.name?u=Gs.sound_board_break:"box1"==e.group.name?u=Gs.sound_box_break:"barrel"==e.group.name?u=Gs.sound_barrel_break:"fruit_stand"==e.group.name?u=Gs.sound_barrel_break:"shack"==e.group.name&&(u=Gs.sound_barrel_break),0==o.type&&o.development.trace_obstacle_break_event&&Nl.trace("box: "+e.group.name+" (x:"+Math.round(e.body.get_position().get_x())+", y:"+Math.round(e.body.get_position().get_y())+") broke at "+Math.round(l.level_seconds)+" level second",{fileName:"MapObjectDo.hx",lineNumber:310,className:"bikas.game.MapObjectDo",methodName:"updateBox"}),Wn.playSoundInGameLevel(u,_,e.body.get_position(),r,1600,1),Vn.applyCameraShake(i,5,4,r,e.body.get_position()),$i.breakBox(e,n,t)}}else if(e.state==Vi.Broken){if(e.pieces_interaction_time-=p,e.pieces_interaction_time<=0){for(var h=0,c=e.pieces;h<c.length;){var d=c[h];++h,$i.setPieceState(e,d,Wi.Passive)}e.state=Vi.Passive}}else if(e.state==Vi.Passive){for(var m=r.main_body_position_x,f=!0,g=0,v=e.pieces;g<v.length;){var b=v[g];++g,null!=b.body&&(b.body.get_position().get_x()<m-qi.pieces_destroy_distance?($i.destroyLiveEntity(b.main_entity,n,t),b.main_entity=null,b.body=null,b.group=null):f=!1)}f&&(e.state=Vi.Removed,e.pieces=null)}},$i.createTempInteractiveObject=function(e,t){var n=new Yi;return n.type=t,n.main_entity=e,n.body=n.main_entity.body,n.init_pos=y_.get(n.body.get_position().get_x(),n.body.get_position().get_y()),n.explosion_radius=300,n},$i.destroyTempInteractiveObject=function(e){null!=e.init_pos&&(e.init_pos.dispose(),e.init_pos=null),e.body=null,e.main_entity=null,e.explosive=null},$i.updateTempInteractiveObject=function(e,t,n,i,r,a,s,l){var o=s.dc;if(e.type==Hi.Obstacle)if(e.timeout)if(e.interaction_time_beyond_distance<=0)if(e.only_to_ground){if(null!=e.body){var _=r.main_body_position_x;e.body.get_position().get_x()<_-qi.pieces_destroy_distance&&($i.destroyLiveEntity(e.main_entity,t,n),e.main_entity=null,e.body=null)}}else e.body.setShapeFilters(Si.only_to_ground),e.only_to_ground=!0;else e.interaction_time_beyond_distance-=o;else{var p=e.body.get_position().get_x()-e.init_pos.get_x(),u=e.body.get_position().get_y()-e.init_pos.get_y();Math.sqrt(p*p+u*u)>e.interactive_distance&&(e.timeout=!0)}else e.type==Hi.Explosive&&500<Aa.getHighestImpulseFromCollisionArbitersOfDynamicBody(e.body)&&null==e.explosive&&(0==l.type&&l.development.trace_explosive_barrel_event&&Nl.trace("explosive barrel: "+e.main_entity.name+" (x:"+Math.round(e.body.get_position().get_x())+", y:"+Math.round(e.body.get_position().get_y())+") broke at "+Math.round(s.level_seconds)+" level second",{fileName:"MapObjectDo.hx",lineNumber:414,className:"bikas.game.MapObjectDo",methodName:"updateTempInteractiveObject"}),e.explosive=Ae.createExplosive(n,i,e.explosion_radius,0,0,Ne.Barrel,0,e.body,e.main_entity.display.sprite),a.push(e.explosive),Jt.updateContainerBody(e.explosive.cbody))},$i.createForwardRamp=function(e,t){var n=new Ki;if(n.type=t,n.type==Ji.Ramp)n.total_impulse=200,n.max_velocity=1500,n.group=e,n.main_entity=n.group.group.entities[0],n.sprite=n.main_entity.display.sprite,n.body=n.main_entity.body,n.top_left_bound=y_.get(n.body.get_bounds().get_min().get_x(),n.body.get_bounds().get_min().get_y()),n.bottom_right_bound=y_.get(n.body.get_bounds().get_max().get_x(),n.body.get_bounds().get_max().get_y()),n.force_angle=.017453292519943*(-Ki.ramp_angle_in_degrees+n.main_entity.transform.rotation),n.impulse=y_.get(n.total_impulse,0).rotate(n.force_angle),n.textures.push(Hs.getTexture("ramp_accelerated_0001")),n.textures.push(Hs.getTexture("ramp_accelerated_0002"));else if(n.type==Ji.Booster){n.total_impulse=120,n.max_velocity=1200,null!=e.group?(n.group=e,n.main_entity=n.group.group.entities[0]):n.main_entity=e,n.sprite=n.main_entity.display.sprite,n.sprite.setTexture(Hs.retrieveAsset("booster"));var i=n.main_entity.position.x,r=n.main_entity.position.y;n.top_left_bound=y_.get(i-n.sprite.width/2,r-n.sprite.height/2),n.bottom_right_bound=y_.get(i+n.sprite.width/2,r+n.sprite.height/2);var a=n.main_entity.transform.rotation;n.main_entity.transform.scale_x<0&&(a+=180),n.force_angle=.017453292519943*a,n.impulse=y_.get(n.total_impulse,0).rotate(n.force_angle),n.textures.push(Hs.retrieveAsset("booster")),n.textures.push(Hs.retrieveAsset("booster_0002")),n.textures.push(Hs.retrieveAsset("booster_0003"))}else Nl.trace("warning: unhandled type "+p.string(t),{fileName:"MapObjectDo.hx",lineNumber:478,className:"bikas.game.MapObjectDo",methodName:"createForwardRamp"});return n.impulse_cache=y_.get(0,0),n.anim_current_wait=0,n.texture_index=0,n},$i.updateForwardRamp=function(e,t,n,i){null!=e.main_entity.display.sprite.parent&&(e.anim_current_wait+=t,e.anim_current_wait>=e.anim_total_wait&&(e.anim_current_wait=0,e.texture_index++,e.texture_index>=e.textures.length&&(e.texture_index=0),e.sprite.setTexture(e.textures[e.texture_index])));for(var r=!1,a=0;a<i.length;){var s=i[a];++a;var l=s.main_body_position_x-(e.top_left_bound.get_x()+e.bottom_right_bound.get_x())/2,o=s.main_body_position_y-(e.top_left_bound.get_y()+e.bottom_right_bound.get_y())/2;750<l||l<-750||750<o||o<-750||Ot.doesWorldBoundsTouchBounds(s,e.top_left_bound,e.bottom_right_bound)&&(s==n.car&&(r=!0),s.main_body.get_velocity().get_length()<=e.max_velocity&&(e.impulse_cache.set_x(e.impulse.get_x()*t),e.impulse_cache.set_y(e.impulse.get_y()*t),Ot.applyImpulseToMainBodiesPerMassUnit(s,e.impulse_cache)))}return r},$i.destroyForwardRamp=function(e){e.group=null,e.main_entity=null,(e.body=null)!=e.top_left_bound&&(e.top_left_bound.dispose(),e.top_left_bound=null),null!=e.bottom_right_bound&&(e.bottom_right_bound.dispose(),e.bottom_right_bound=null),null!=e.impulse&&(e.impulse.dispose(),e.impulse=null),null!=e.impulse_cache&&(e.impulse_cache.dispose(),e.impulse_cache=null),e.applied_impulses=null,e.sprite=null,e.textures=null};var er=function(e,t,n,i,r){null==r&&(r=.001),null==i&&(i=1),null==n&&(n=2),null==t&&(t=1),null==e&&(e=0),(this.zpp_inner=null)==tr.zpp_pool?this.zpp_inner=new tr:(this.zpp_inner=tr.zpp_pool,tr.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null),this.zpp_inner.alloc(),(this.zpp_inner.outer=this).set_elasticity(e),this.set_dynamicFriction(t),this.set_staticFriction(n),this.set_density(i),this.set_rollingFriction(r)};(n["nape.phys.Material"]=er).__name__=["nape","phys","Material"],er.wood=function(){return new er(.4,.2,.38,.7,.005)},er.steel=function(){return new er(.2,.57,.74,7.8,.001)},er.ice=function(){return new er(.3,.03,.1,.9,1e-4)},er.rubber=function(){return new er(.8,1,1.4,1.5,.01)},er.glass=function(){return new er(.4,.4,.94,2.6,.002)},er.sand=function(){return new er(-1,.45,.6,1.6,16)},er.prototype={zpp_inner:null,get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_shapes:function(){return null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=pc.get(this.zpp_inner.shapes,!0)),this.zpp_inner.wrap_shapes},copy:function(){var e=new er(this.get_elasticity(),this.get_dynamicFriction(),this.get_staticFriction(),this.get_density(),this.get_rollingFriction());return null!=this.zpp_inner.userData&&(e.zpp_inner.userData=_.copy(this.zpp_inner.userData)),e},get_elasticity:function(){return this.zpp_inner.elasticity},set_elasticity:function(e){return e!=this.get_elasticity()&&(this.zpp_inner.elasticity=e/1,this.zpp_inner.invalidate(tr.WAKE|tr.ARBITERS)),this.get_elasticity()},get_dynamicFriction:function(){return this.zpp_inner.dynamicFriction},set_dynamicFriction:function(e){return e!=this.get_dynamicFriction()&&(this.zpp_inner.dynamicFriction=e/1,this.zpp_inner.invalidate(tr.WAKE|tr.ANGDRAG|tr.ARBITERS)),this.get_dynamicFriction()},get_staticFriction:function(){return this.zpp_inner.staticFriction},set_staticFriction:function(e){return e!=this.get_staticFriction()&&(this.zpp_inner.staticFriction=e/1,this.zpp_inner.invalidate(tr.WAKE|tr.ARBITERS)),this.get_staticFriction()},get_density:function(){return 1e3*this.zpp_inner.density},set_density:function(e){return e!=this.get_density()&&(this.zpp_inner.density=e/1e3,this.zpp_inner.invalidate(tr.WAKE|tr.PROPS)),this.get_density()},get_rollingFriction:function(){return this.zpp_inner.rollingFriction},set_rollingFriction:function(e){return e!=this.get_rollingFriction()&&(this.zpp_inner.rollingFriction=e/1,this.zpp_inner.invalidate(tr.WAKE|tr.ARBITERS)),this.get_rollingFriction()},toString:function(){return"{ elasticity: "+this.get_elasticity()+" dynamicFriction: "+this.get_dynamicFriction()+" staticFriction: "+this.get_staticFriction()+" density: "+this.get_density()+" rollingFriction: "+this.get_rollingFriction()+" }"},__class__:er,__properties__:{set_rollingFriction:"set_rollingFriction",get_rollingFriction:"get_rollingFriction",set_density:"set_density",get_density:"get_density",set_staticFriction:"set_staticFriction",get_staticFriction:"get_staticFriction",set_dynamicFriction:"set_dynamicFriction",get_dynamicFriction:"get_dynamicFriction",set_elasticity:"set_elasticity",get_elasticity:"get_elasticity",get_shapes:"get_shapes",get_userData:"get_userData"}};var tr=function(){this.rollingFriction=0,this.elasticity=0,this.density=0,this.staticFriction=0,this.dynamicFriction=0,this.wrap_shapes=null,this.shapes=null,this.outer=null,this.userData=null,this.next=null,this.feature_cons(),this.elasticity=0,this.dynamicFriction=1,this.staticFriction=2,this.density=.001,this.rollingFriction=.01};(n["zpp_nape.phys.ZPP_Material"]=tr).__name__=["zpp_nape","phys","ZPP_Material"],tr.prototype={next:null,userData:null,outer:null,wrapper:function(){if(null==this.outer){this.outer=new er;var e=this.outer.zpp_inner;e.free(),e.next=tr.zpp_pool,tr.zpp_pool=e,this.outer.zpp_inner=this}return this.outer},free:function(){this.outer=null},alloc:function(){},shapes:null,wrap_shapes:null,feature_cons:function(){this.shapes=new qu},addShape:function(e){this.shapes.add(e)},remShape:function(e){this.shapes.remove(e)},dynamicFriction:null,staticFriction:null,density:null,elasticity:null,rollingFriction:null,copy:function(){var e=new tr;return e.dynamicFriction=this.dynamicFriction,e.staticFriction=this.staticFriction,e.density=this.density,e.elasticity=this.elasticity,e.rollingFriction=this.rollingFriction,e},set:function(e){this.dynamicFriction=e.dynamicFriction,this.staticFriction=e.staticFriction,this.density=e.density,this.elasticity=e.elasticity,this.rollingFriction=e.rollingFriction},invalidate:function(e){for(var t=this.shapes.begin();null!=t;)t.elem().invalidate_material(e),t=t.next},__class__:tr};var nr=function(){};(n["bikas.game.Materials"]=nr).__name__=["bikas","game","Materials"];var ir=function(){};(n["bikas.game.MeshDo"]=ir).__name__=["bikas","game","MeshDo"],ir.createMesh=function(e,t){e.baseTexture.wrapMode=1;for(var n=ns.pointsToVertices(t),i=e.baseTexture.width,r=e.baseTexture.height,a=(e.width,e.height,0),s=e.frame.x,l=e.frame.y,o=[];a<n.length;){var _=(s+n[a])/i,p=(l+n[a+1])/r;o.push(_),o.push(p),a+=2}var u=$l.earcut(n),h=new Lc(n),c=new Lc(o),d=new Uint16Array(u);return new PIXI.mesh.Mesh(e,h,c,d,PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES)},ir.update=function(e){ir.total_size+=1;for(var t=ir.total_size,n=[new ea(0,0),new ea(t,0),new ea(t+100,t/2),new ea(t,t),new ea(0,t),new ea(-100,t/2)],i=(Math.random(),ns.pointsToVertices(n)),r=e.texture,a=r.baseTexture.width,s=r.baseTexture.height,l=(r.width,r.height,0),o=r.frame.x,_=r.frame.y,p=[];l<i.length;){var u=(o+i[l])/a,h=(_+i[l+1])/s;p.push(u),p.push(h),l+=2}var c=$l.earcut(i),d=new Lc(i),m=new Lc(p),f=new Int16Array(c);e.vertices=d,e.uvs=m,e.indices=f,e.dirty++,e.indexDirty++};var rr=function(){this.constant_drive=!0,this.finished_race=!1,this.behavior_activated=!0,this.mobile_controls=null};(n["bikas.game.Player"]=rr).__name__=["bikas","game","Player"],rr.prototype={car:null,config:null,cache:null,abilities:null,ability_button:null,jump_button:null,nitro_button:null,mobile_controls:null,engine_sound:null,behavior_activated:null,finished_race:null,constant_drive:null,__class__:rr};var ar=function(){};(n["bikas.game.KeyboardShortcutDisplay"]=ar).__name__=["bikas","game","KeyboardShortcutDisplay"],ar.prototype={container:null,background:null,text:null,__class__:ar};var sr=function(){this.downed=null};(n["bikas.game.JumpButton"]=sr).__name__=["bikas","game","JumpButton"],sr.prototype={container:null,button:null,keyboard_shortcut_display:null,downed:null,__class__:sr};var lr=n["bikas.game.NitroButtonState"]={__ename__:["bikas","game","NitroButtonState"],__constructs__:["Empty","TransitionIn","Normal","TransitionOut"]};lr.Empty=["Empty",0],lr.Empty.toString=i,(lr.Empty.__enum__=lr).TransitionIn=["TransitionIn",1],lr.TransitionIn.toString=i,(lr.TransitionIn.__enum__=lr).Normal=["Normal",2],lr.Normal.toString=i,(lr.Normal.__enum__=lr).TransitionOut=["TransitionOut",3],lr.TransitionOut.toString=i,(lr.TransitionOut.__enum__=lr).__empty_constructs__=[lr.Empty,lr.TransitionIn,lr.Normal,lr.TransitionOut];var or=function(){this.pickup_current_time=0,this.transition_current_time=0,this.downed=null,this.nitro_points=[],this.container=null,this.state=lr.Empty};(n["bikas.game.NitroButton"]=or).__name__=["bikas","game","NitroButton"],or.prototype={state:null,container:null,button:null,keyboard_shortcut_display:null,nitro_points:null,downed:null,transition_current_time:null,pickup_current_time:null,__class__:or};var _r=function(){this.downed=null,this.original_rotation=0,this.original_scale_y=1,this.original_scale_x=1};(n["bikas.game.MobileButton"]=_r).__name__=["bikas","game","MobileButton"],_r.prototype={container:null,sprite:null,original_scale_x:null,original_scale_y:null,original_rotation:null,downed:null,__class__:_r};var pr=function(){};(n["bikas.game.MobileControls"]=pr).__name__=["bikas","game","MobileControls"],pr.prototype={clockwise:null,anti_clockwise:null,__class__:pr};var ur=function(){};(n["bikas.game.EngineSound"]=ur).__name__=["bikas","game","EngineSound"],ur.prototype={slow_loop:null,__class__:ur};var hr=function(){};(n["bikas.game.PlayerDo"]=hr).__name__=["bikas","game","PlayerDo"],hr.createPlayer=function(e,t,n,i,r,a){var s=new rr;s.car=e,s.config=t,s.cache=n,s.abilities=i,s.ability_button=new xe,s.jump_button=new sr,s.jump_button.container=qa.createGroup(),s.jump_button.button=A.createNewAnimation(Gs.animation_jump_green_button,!1),s.jump_button.keyboard_shortcut_display=hr.createKeyboardShortcutDisplay("(SPACE)",2,24),s.jump_button.container.add(s.jump_button.button.sprite),s.jump_button.container.add(s.jump_button.keyboard_shortcut_display.container),r.add(s.jump_button.container),s.nitro_button=new or,s.nitro_button.container=qa.createGroup(),s.nitro_button.button=A.createNewAnimation(Gs.animation_nitro_button,!1),s.nitro_button.keyboard_shortcut_display=hr.createKeyboardShortcutDisplay("(SHIFT)",2,24),s.nitro_button.container.add(s.nitro_button.button.sprite),s.nitro_button.container.add(s.nitro_button.keyboard_shortcut_display.container),r.add(s.nitro_button.container),s.nitro_button.container.alpha=0,s.nitro_button.state=lr.Empty;var l=function(e,t,n){var i=new _r;return i.container=qa.createGroup(),i.sprite=qa.createSpriteByName("rotate_button",.5,.5),i.container.add(i.sprite),i.container.scale.x=t,i.container.scale.y=n,i.original_scale_x=t,i.original_scale_y=n,e.add(i.container),i};a&&(s.mobile_controls=new pr,s.mobile_controls.clockwise=l(r,1,1),s.mobile_controls.anti_clockwise=l(r,-1,1),s.mobile_controls.clockwise.container.rotation=.017453292519943*_r.clockwise_rotation,s.mobile_controls.anti_clockwise.container.rotation=.017453292519943*_r.anti_clockwise_rotation),s.engine_sound=new ur;var o=function(e,t){e.slow_loop=Hs.retrieveAsset("sound_loop_"+t+"_slow")},_=e.name;return"car_rudolf"==_?o(s.engine_sound,"car_rudolf"):"car_bus"==_?o(s.engine_sound,"car_bus"):"car_farm_truck"==_?o(s.engine_sound,"car_farm_truck"):"car_semioval"==_?o(s.engine_sound,"car_semioval"):"car_tourcycle"==_?o(s.engine_sound,"car_tourcycle"):"car_ice_cream_truck"==_?o(s.engine_sound,"car_ice_cream_truck"):"car_bug"==_?o(s.engine_sound,"car_bug"):"car_coyote"==_?o(s.engine_sound,"car_rudolf"):"car_cow"==_?o(s.engine_sound,"car_rudolf"):"car_rider"==_?o(s.engine_sound,"car_rider"):"car_taxi"==_&&o(s.engine_sound,"car_rudolf"),s},hr.createKeyboardShortcutDisplay=function(e,t,n){var i=new ar;return i.container=qa.createGroup(),i.background=qa.createSpriteByName("shortcut_background",.5,.5),i.background.scale.x=t,i.background.scale.y=t,i.background.alpha=.6,i.text=qa.createBitmapText(fn.bell_gothic_std_black_dark_26,n,"center"),i.text.anchor.x=.5,i.text.anchor.y=.5,i.text.text=e,i.container.add(i.background),i.container.add(i.text),i.container.visible=!1,i},hr.destroy=function(e){if(null!=e.ability_button&&ze.destroy(e.ability_button),null!=e.abilities&&(Ae.destroyAbilities(e.abilities),e.abilities=null),null!=e.jump_button&&(null!=e.jump_button.button&&(A.destroyAnimation(e.jump_button.button),e.jump_button.button=null),null!=e.jump_button.container&&e.jump_button.container.destroy(),e.jump_button=null),null!=e.nitro_button){for(var t=0,n=e.nitro_button.nitro_points;t<n.length;){var i=n[t];++t,e.nitro_button.container.remove(i),i.destroy(!0)}(e.nitro_button.nitro_points=null)!=e.nitro_button.button&&(A.destroyAnimation(e.nitro_button.button),e.nitro_button.button=null),null!=e.nitro_button.container&&e.nitro_button.container.destroy(),e.nitro_button=null}null!=e.mobile_controls&&(e.mobile_controls.clockwise.sprite.destroy(!0),e.mobile_controls.anti_clockwise.sprite.destroy(!0),e.mobile_controls.clockwise.container.destroy(!0),e.mobile_controls.anti_clockwise.container.destroy(!0),e.mobile_controls=null),null!=e.engine_sound&&null!=e.engine_sound.slow_loop&&(Ms.stopMusic(e.engine_sound.slow_loop),e.engine_sound.slow_loop=null),Mt.destroy(e.car,e.config,e.cache),e.car=null,e.config=null,e.cache=null,e.abilities=null},hr.update=function(e,t,n,i,r,a,s,l,o,_){var p=n.dc,u=n.level_seconds;n.step_size,Mt.updateState(p,e.car,e.cache);var h=e.car,c=e.config,d=e.cache,m=e.jump_button;if(a.control_type==Fs.ControlFastWheel?(m.container.x=105,m.container.y=Jr.getWheelY(i)):a.control_type==Fs.ControlSlowRotateButtons||null==e.mobile_controls?(m.container.x=105,m.container.y=i.current_game_height-105):a.control_type==Fs.ControlSlowRotateButtonsSide&&(m.container.x=105,m.container.y=i.current_game_height-210-60),null!=e.mobile_controls){var f=e.mobile_controls.anti_clockwise.container,g=e.mobile_controls.clockwise.container;if(a.control_type==Fs.ControlSlowRotateButtons){f.x=i.current_game_width-230,f.y=m.container.y;var v=i.current_game_height-f.y;g.x=i.current_game_width-v,g.y=i.current_game_height-230}else a.control_type==Fs.ControlSlowRotateButtonsSide&&(f.x=105,f.y=i.current_game_height-105,g.x=i.current_game_width-105,g.y=f.y)}if(!e.finished_race&&l&&hr.updateEngineSound(h,c,d,e.engine_sound,_),e.behavior_activated){if(e.constant_drive&&!o&&Mt.drive(h,e.config,e.cache,p),i.desktop){e.constant_drive||(Ii.isAnyPressed(s,rr.keys_forward)?Mt.drive(h,c,d,p):Ii.isAnyPressed(s,rr.keys_backward)&&Mt.drive(h,c,d,-p)),Ii.isAnyPressed(s,rr.keys_left)?Mt.rotate(h,c,d,-p):Ii.isAnyPressed(s,rr.keys_right)&&Mt.rotate(h,c,d,p);var b=e.abilities;Ii.isAnyPressed(s,rr.keys_nitro)&&(b.nitro_power.activated||0<b.nitro_power_charge&&(b.nitro_power_charge--,Ae.activateOrExtendConstantPower(b.nitro_power,h,Te.nitro_time_per_1_pick),b.nitro_power_charge<=0&&null!=e.nitro_button&&(e.nitro_button.state=lr.TransitionOut))),Ii.isAnyPressed(s,rr.keys_power)&&null!=e.ability_button&&e.ability_button.state==be.ButtonMode&&(e.ability_button.use_ability_click=!0),Ii.isAnyPressed(s,rr.keys_jump)&&Ae.isAllowedToJump(e.abilities.jump_power,u)&&Ae.tryJump(e.abilities.jump_power,h,c,d,u)&&Ms.playSound(Gs.sound_jump,_),$a.isOver(m.container.x,m.container.y,r,sr.radius)?m.keyboard_shortcut_display.container.visible=!0:m.keyboard_shortcut_display.container.visible=!1,$a.isOver(e.nitro_button.container.x,e.nitro_button.container.y,r,or.radius)?e.nitro_button.keyboard_shortcut_display.container.visible=!0:e.nitro_button.keyboard_shortcut_display.container.visible=!1}if(null==m.downed&&(m.downed=$a.getDowned(m.container.x,m.container.y,r,sr.radius),null!=m.downed&&(A.gotoFrame(m.button,1),Ae.isAllowedToJump(e.abilities.jump_power,u)&&Ae.tryJump(e.abilities.jump_power,h,c,d,u)&&Ms.playSound(Gs.sound_jump,_))),null!=m.downed&&m.downed.state==Ja.IS_UP&&(m.downed=null,0!=m.button.current_frame&&A.gotoFrame(m.button,0)),null!=e.mobile_controls){var y=e.mobile_controls.clockwise,x=e.mobile_controls.anti_clockwise,z=_r.down_scale;$a.isDownOrDowned(y.container.x,y.container.y,r,_r.radius)?(y.container.scale.set(y.original_scale_x*z,y.original_scale_y*z),y.container.rotation=.017453292519943*(_r.clockwise_rotation+_r.down_rotation),Mt.rotate(h,c,d,p)):(y.container.scale.set(y.original_scale_x,y.original_scale_y),y.container.rotation=.017453292519943*_r.clockwise_rotation),$a.isDownOrDowned(x.container.x,x.container.y,r,_r.radius)?(x.container.scale.set(x.original_scale_x*z,x.original_scale_y*z),x.container.rotation=.017453292519943*(_r.anti_clockwise_rotation-_r.down_rotation),Mt.rotate(h,c,d,-p)):(x.container.scale.set(x.original_scale_x,x.original_scale_y),x.container.rotation=.017453292519943*_r.anti_clockwise_rotation)}hr.updateNitroButton(e.nitro_button,e.abilities,e.car,m,r,p),e.nitro_button.container.x=270,e.nitro_button.container.y=i.current_game_height-105}},hr.updateNitroButton=function(e,t,n,i,r,a){if(0<t.nitro_power_charge&&e.state==lr.Empty&&(e.state=lr.TransitionIn,e.transition_current_time=0,A.gotoFrame(e.button,0)),e.state==lr.TransitionIn){e.transition_current_time+=a,e.transition_current_time>=or.transtion_in_time&&(e.transition_current_time=or.transtion_in_time,e.state=lr.Normal);var s=e.transition_current_time/or.transtion_in_time;e.container.alpha=s;var l=va.linearToABC(.5,1.4,1,.6,s);e.container.scale.x=l,e.container.scale.y=l}if(e.state==lr.Normal||e.state==lr.TransitionIn)if(null==e.downed&&(e.downed=$a.getDowned(e.container.x,e.container.y,r,or.radius)),null!=e.downed&&(e.downed.state==Ja.DOWNED||e.downed.state==Ja.IS_DOWN?(A.gotoFrame(e.button,1),t.nitro_power.activated||(t.nitro_power_charge-=1,Ae.activateOrExtendConstantPower(t.nitro_power,n,Te.nitro_time_per_1_pick),t.nitro_power_charge<=0&&(e.state=lr.TransitionOut))):e.downed.state==Ja.IS_UP&&(e.downed=null,0!=e.button.current_frame&&A.gotoFrame(e.button,0))),t.nitro_power_charge<=0&&(e.state=lr.TransitionOut),e.nitro_points.length<t.nitro_power_charge-1){for(var o=0,_=Math.ceil(t.nitro_power_charge-1-e.nitro_points.length);o<_;){o++;var p=qa.createSprite(Gs.nitro_1_point);p.anchor.x=.5,p.anchor.y=.5,p.position.x=.39*e.button.sprite.width+12*e.nitro_points.length,e.container.addAt(p,0),e.nitro_points.push(p)}e.pickup_current_time=or.pickup_time}else if(e.nitro_points.length>t.nitro_power_charge-1&&0<e.nitro_points.length){var u=e.nitro_points.pop();e.container.remove(u),u.destroy(!0)}if(0<=e.pickup_current_time){e.pickup_current_time-=a;var h=1-e.pickup_current_time/or.pickup_time,c=ma.interpolateForwardAndBackward(1,1.1,h);1<h&&(h=1),e.container.scale.x=c,e.container.scale.y=c}hr.updateNitroTransitionOut(e,a)},hr.updateNitroTransitionOut=function(e,t){if(e.state==lr.TransitionOut){e.downed=null,e.transition_current_time-=t,e.transition_current_time<0&&(e.transition_current_time=0,e.state=lr.Empty);var n=e.transition_current_time/or.transtion_in_time;e.container.alpha=n;var i=va.linear(.5,1,n);e.container.scale.x=i,e.container.scale.y=i}},hr.updateEngineSound=function(e,t,n,i,r){var a=i.slow_loop;if(null!=a){t.drive_velocity_max,t.nitro_velocity_to_drive_velocity_max_coeff;var s=ma.max(Math.abs(e.back_wheel_body.get_angularVel()),Math.abs(e.front_wheel_body.get_angularVel())),l=va.getTClamped(0,ur.max_angular_vel,s);va.linear(1,0,l),va.linear(0,1,l),a.max_volume=ur.slow_volume_coeff;var o=va.linear(1,2,l);r&&a.howl.rate(o),Ms.isMusicPlaying(a)||Ms.fadeInMusic(a,.016666666666666666),Ms.updateMusic(a,r)}};var cr=function(){};(n["bikas.game.CarNames"]=cr).__name__=["bikas","game","CarNames"];var dr=function(e,t){this.to_rank=0,this.from_rank=0,this.from_rank=e,this.to_rank=t};(n["bikas.game.CarReplace"]=dr).__name__=["bikas","game","CarReplace"],dr.prototype={from_rank:null,to_rank:null,__class__:dr};var mr=function(){this.price=10,this.bot_upgrades=[]};(n["bikas.game.CarSetting"]=mr).__name__=["bikas","game","CarSetting"],mr.prototype={name:null,initial_config:null,personality:null,bot_upgrades:null,price:null,__class__:mr};var fr=function(){this.nitro_velocity_coeff_coeffs=[],this.nitro_impulse_coeffs=[],this.armor_coeffs=[],this.grip_decrease_coeffs=[],this.grip_increase_coeffs=[],this.rotation_angular_velocity_max_coeffs=[],this.rotation_angular_impulse_coeff_coeffs=[],this.drive_velocity_max_coeffs=[],this.drive_impulse_coeffs=[]};(n["bikas.game.CarUpgradeData"]=fr).__name__=["bikas","game","CarUpgradeData"],fr.prototype={drive_impulse_coeffs:null,drive_velocity_max_coeffs:null,rotation_angular_impulse_coeff_coeffs:null,rotation_angular_velocity_max_coeffs:null,grip_increase_coeffs:null,grip_decrease_coeffs:null,armor_coeffs:null,nitro_impulse_coeffs:null,nitro_velocity_coeff_coeffs:null,__class__:fr};var gr=function(){this.armor=0,this.handling=0,this.acceleration=0,this.top_speed=0};(n["bikas.game.CarUpgradeValues"]=gr).__name__=["bikas","game","CarUpgradeValues"],gr.prototype={top_speed:null,acceleration:null,handling:null,armor:null,__class__:gr};var vr=function(e){this.costs=[],this.name="",this.name=e};(n["bikas.game.UpgradeCosts"]=vr).__name__=["bikas","game","UpgradeCosts"],vr.prototype={name:null,costs:null,__class__:vr};var br=function(){this.upgrade_costs=[],this.points_per_level=[]};(n["bikas.game.Upgrades"]=br).__name__=["bikas","game","Upgrades"],br.prototype={points_per_level:null,upgrade_costs:null,__class__:br};var yr=function(){this.level_items=[],this.permanent_items=[]};(n["bikas.game.OngoingPowers"]=yr).__name__=["bikas","game","OngoingPowers"],yr.prototype={permanent_items:null,level_items:null,__class__:yr};var xr=function(){this.levels_completed=0,this.type=0};(n["bikas.game.RewardedAd"]=xr).__name__=["bikas","game","RewardedAd"],xr.prototype={type:null,levels_completed:null,__class__:xr};var zr=function(){this.coins=0,this.chests_collected_guids=[],this.chests_rewarded=0};(n["bikas.game.ResourcesCollected"]=zr).__name__=["bikas","game","ResourcesCollected"],zr.prototype={chests_rewarded:null,chests_collected_guids:null,coins:null,__class__:zr};var wr=n["bikas.game.LevelDescriptionType"]={__ename__:["bikas","game","LevelDescriptionType"],__constructs__:["LevelRegular","LevelChallenge","LevelInterLevelMenu","LevelMainMenu"]};wr.LevelRegular=["LevelRegular",0],wr.LevelRegular.toString=i,(wr.LevelRegular.__enum__=wr).LevelChallenge=["LevelChallenge",1],wr.LevelChallenge.toString=i,(wr.LevelChallenge.__enum__=wr).LevelInterLevelMenu=["LevelInterLevelMenu",2],wr.LevelInterLevelMenu.toString=i,(wr.LevelInterLevelMenu.__enum__=wr).LevelMainMenu=["LevelMainMenu",3],wr.LevelMainMenu.toString=i,(wr.LevelMainMenu.__enum__=wr).__empty_constructs__=[wr.LevelRegular,wr.LevelChallenge,wr.LevelInterLevelMenu,wr.LevelMainMenu];var kr=n["bikas.game.ChallengeType"]={__ename__:["bikas","game","ChallengeType"],__constructs__:["None","ChallengeEscapeFromWolf","ChallengeMountainRush","ChallengeBalancing","ChallengeSurvival","ChallengeBulletTaxi","ChallengeHuntThePrey","ChallengeAchievement","ChallengeCredits"]};kr.None=["None",0],kr.None.toString=i,(kr.None.__enum__=kr).ChallengeEscapeFromWolf=["ChallengeEscapeFromWolf",1],kr.ChallengeEscapeFromWolf.toString=i,(kr.ChallengeEscapeFromWolf.__enum__=kr).ChallengeMountainRush=["ChallengeMountainRush",2],kr.ChallengeMountainRush.toString=i,(kr.ChallengeMountainRush.__enum__=kr).ChallengeBalancing=["ChallengeBalancing",3],kr.ChallengeBalancing.toString=i,(kr.ChallengeBalancing.__enum__=kr).ChallengeSurvival=["ChallengeSurvival",4],kr.ChallengeSurvival.toString=i,(kr.ChallengeSurvival.__enum__=kr).ChallengeBulletTaxi=["ChallengeBulletTaxi",5],kr.ChallengeBulletTaxi.toString=i,(kr.ChallengeBulletTaxi.__enum__=kr).ChallengeHuntThePrey=["ChallengeHuntThePrey",6],kr.ChallengeHuntThePrey.toString=i,(kr.ChallengeHuntThePrey.__enum__=kr).ChallengeAchievement=["ChallengeAchievement",7],kr.ChallengeAchievement.toString=i,(kr.ChallengeAchievement.__enum__=kr).ChallengeCredits=["ChallengeCredits",8],kr.ChallengeCredits.toString=i,(kr.ChallengeCredits.__enum__=kr).__empty_constructs__=[kr.None,kr.ChallengeEscapeFromWolf,kr.ChallengeMountainRush,kr.ChallengeBalancing,kr.ChallengeSurvival,kr.ChallengeBulletTaxi,kr.ChallengeHuntThePrey,kr.ChallengeAchievement,kr.ChallengeCredits];var Sr=function(){this.level_data_save=null};(n["bikas.game.LevelDescription"]=Sr).__name__=["bikas","game","LevelDescription"],Sr.prototype={name:null,type:null,challenge_type:null,nice_name:null,level_number:null,max_stunt_score:null,available_in_final_game:null,level_data_save:null,__class__:Sr};var Cr=function(){this.chests_collected_guids=[],this.chests_rewarded=0,this.coins=0,this.stunt_stats=new Wr,this.completion_percent=0,this.place=-1,this.locked=!1,this.completed=!1,this.description=null,this.description_name=""};(n["bikas.game.LevelSave"]=Cr).__name__=["bikas","game","LevelSave"],Cr.prototype={description_name:null,description:null,completed:null,locked:null,place:null,completion_percent:null,stunt_stats:null,coins:null,chests_rewarded:null,chests_collected_guids:null,__class__:Cr};var Nr=function(){this.tutorial_shown_power=!1,this.tutorial_shown_nitro=!1,this.tutorial_shown_jump=!1,this.tutorial_shown_controls=!1,this.rewarded_ads=[],this.ongoing_powers=new yr,this.challenges_completed_claimed=[],this.challenges_completed=[],this.challenges_unlocked_shown_on_map=[],this.challenges_unlocked_shown=[],this.challenges_unlocked=[],this.achievements_claimed=[],this.achievements_shown=[],this.achievements_completed=[],this.bot_replaced_at_level_count=0,this.locked_cars=["car_rider","car_semioval","car_bug"],this.current_bot_car_lineup=["car_ice_cream_truck","car_farm_truck","car_tourcycle","car_cow"],this.car_own_list=["car_bus"],this.current_car="car_bus",this.car_upgrades=new gr,this.upgrade_points=0,this.coins=0,this.chests=0,this.credits_shown=!1,this.level_saves=[],this.previous_level_name="",this.current_level_name="level_1",this.save_date="",this.save_data_version=1};(n["bikas.game.GameSave"]=Nr).__name__=["bikas","game","GameSave"],Nr.prototype={save_data_version:null,save_date:null,current_level_name:null,previous_level_name:null,level_saves:null,credits_shown:null,chests:null,coins:null,upgrade_points:null,car_upgrades:null,current_car:null,car_own_list:null,current_bot_car_lineup:null,locked_cars:null,bot_replaced_at_level_count:null,achievements_completed:null,achievements_shown:null,achievements_claimed:null,challenges_unlocked:null,challenges_unlocked_shown:null,challenges_unlocked_shown_on_map:null,challenges_completed:null,challenges_completed_claimed:null,ongoing_powers:null,rewarded_ads:null,tutorial_shown_controls:null,tutorial_shown_jump:null,tutorial_shown_nitro:null,tutorial_shown_power:null,__class__:Nr};var Pr=function(){};(n["bikas.game.ProgressionDo"]=Pr).__name__=["bikas","game","ProgressionDo"],Pr.createCarSettings=function(e){var t=function(e,t,n,i){for(var r=0;r<e.length;){var a=e[r];if(++r,a.name==t)return void Nl.trace("warning: car with name "+t+" already exists in car_setting array",{fileName:"ProgressionDo.hx",lineNumber:44,className:"bikas.game.ProgressionDo",methodName:"createCarSettings"})}var s=new mr;s.name=t,s.initial_config=i,s.price=n,e.push(s)},n=function(e,t,n){for(var i=0;i<e.length;){var r=e[i];if(++i,r.name==t)return void(r.personality=n)}Nl.trace("warning: couldn't find "+t,{fileName:"ProgressionDo.hx",lineNumber:62,className:"bikas.game.ProgressionDo",methodName:"createCarSettings"})},i=function(e,t,n,i,r,a,s,l,o,_){null==_&&(_=0),null==o&&(o=1),null==l&&(l=1),null==s&&(s=-723),null==a&&(a=1.6),null==r&&(r=35),null==i&&(i=6),null==n&&(n=1),null==t&&(t=700),null==e&&(e=5.5);var p=new It;return p.drive_impulse=e,p.drive_velocity_max=t,p.rotation_angular_impulse_coeff=n,p.rotation_angular_velocity_max=i,p.nitro_impulse=r,p.nitro_velocity_to_drive_velocity_max_coeff=a,p.jump_impulse=s,p.grip_increase_coeff=l,p.grip_decrease_coeff=o,p.armor_coeff=_,p.drive_wheel_angular_impulse=5*e/5.5,p.drive_wheel_angular_velocity_max=33*t/700,p.info_max_height_jump_time=.58,p.info_max_height_jump_distance=200,p},r=[];if(t(r,"car_rider",600,i(5,700,1,7,35,1.6,-723,1.1,.9,.35)),t(r,"car_semioval",500,i(4.8,700,.9,5,35,1.6,-723,1,1,.2)),t(r,"car_bug",400,i(4.6,700,1.05,6,35,1.6,-750,1.1,.9,.1)),t(r,"car_rudolf",200,i(4.3,700,.85,5,35,1.6,-723,1,1,.1)),t(r,"car_bus",190,i(4.05,700,.8,4,35,1.6,-650,.9,1.1,.4)),t(r,"car_taxi",250,i(4.4,700,1,5,35,1.6,-700,1,1,.3)),t(r,"car_farm_truck",160,i(3.9,700,.85,5,35,1.6,-650,.8,1.2,.5)),t(r,"car_cow",130,i(4,700,.7,5,35,1.6,-650,.8,1.2,.15)),t(r,"car_ice_cream_truck",140,i(4,700,.6,4,35,1.6,-550,.8,1.2,.3)),t(r,"car_coyote",160,i(4.15,700,.85,5,35,1.6,-723,.95,1.15,.1)),t(r,"car_tourcycle",150,i(4,700,1.1,8,35,1.6,-800,1.2,.8,.05)),e.control_type==Fs.ControlSlowRotateButtons||e.control_type==Fs.ControlSlowRotateButtonsSide)for(var a=0;a<r.length;){var s=r[a];++a,s.initial_config.rotation_angular_velocity_max*=.25,s.initial_config.increase_rotation_angular_velocity_max_if_in_air_coeff=3.2}return n(r,"car_rudolf",new rt(.8,.2,.4,.5)),n(r,"car_bus",new rt(.2,.2,.3,.1)),n(r,"car_farm_truck",new rt(.2,.7,.6,.1)),n(r,"car_semioval",new rt(.7,.5,.5,.3)),n(r,"car_tourcycle",new rt(.2,.2,.8,.8)),n(r,"car_ice_cream_truck",new rt(.2,.1,.5,.3)),n(r,"car_bug",new rt(.6,.2,.5,.3)),n(r,"car_coyote",new rt(.3,0,.1,.7)),n(r,"car_cow",new rt(.1,.1,.1,.5)),n(r,"car_rider",new rt(1,1,.1,.1)),n(r,"car_taxi",new rt(.8,.8,.1,.1)),r},Pr.createCarUpgradeData=function(){var e=new fr,t=function(e,t,n){for(var i=[],r=0,a=n;r<a;){var s=r++;i.push(va.linear(e,t,s/(n-1)))}return i};return e.drive_impulse_coeffs=t(1.2,1.6,10),e.drive_velocity_max_coeffs=t(1.2,1.6,10),e.rotation_angular_impulse_coeff_coeffs=t(1,1.54,10),e.rotation_angular_velocity_max_coeffs=t(1,1.54,10),e.grip_increase_coeffs=t(1,1.54,10),e.grip_decrease_coeffs=t(1,.75,10),e.nitro_impulse_coeffs=t(1,1.54,10),e.armor_coeffs=t(0,.5,10),e.nitro_velocity_coeff_coeffs=t(1,.75,10),e},Pr.getCarSettingByName=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.name==t)return i}return Nl.trace("warning: car setting with name "+t+" does not exist",{fileName:"ProgressionDo.hx",lineNumber:251,className:"bikas.game.ProgressionDo",methodName:"getCarSettingByName"}),null},Pr.getBotPersonalityByName=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.name==t)return i.personality}return Nl.trace("warning: couldn't find "+t+" personality",{fileName:"ProgressionDo.hx",lineNumber:261,className:"bikas.game.ProgressionDo",methodName:"getBotPersonalityByName"}),new rt(.5,.5,.5,.5)},Pr.getUpgradedCarConfigCopy=function(e,t,n,i){for(var r=0;r<n.length;){var a=n[r];if(++r,a.name==i){var s=Pt.copyConfig(a.initial_config),l=function(e,t){return null==e&&(Nl.trace("warning: float_array == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.ProgressionDo",methodName:"getUpgradedCarConfigCopy"}),1)?1:0==e.length?(Nl.trace("warning: float_array.length == 0",{fileName:"ProgressionDo.hx",lineNumber:278,className:"bikas.game.ProgressionDo",methodName:"getUpgradedCarConfigCopy"}),1):t>=e.length?(Nl.trace("warning: index >= float_array.length",{fileName:"ProgressionDo.hx",lineNumber:282,className:"bikas.game.ProgressionDo",methodName:"getUpgradedCarConfigCopy"}),e[e.length-1]):t<0?(Nl.trace("warning: index < 0",{fileName:"ProgressionDo.hx",lineNumber:286,className:"bikas.game.ProgressionDo",methodName:"getUpgradedCarConfigCopy"}),e[0]):e[t]};return s.drive_impulse*=l(e.drive_impulse_coeffs,t.acceleration),s.drive_velocity_max*=l(e.drive_velocity_max_coeffs,t.top_speed),s.rotation_angular_impulse_coeff*=l(e.rotation_angular_impulse_coeff_coeffs,t.handling),s.rotation_angular_velocity_max*=l(e.rotation_angular_velocity_max_coeffs,t.handling),s.nitro_impulse*=l(e.nitro_impulse_coeffs,t.acceleration),s.nitro_velocity_to_drive_velocity_max_coeff*=l(e.nitro_velocity_coeff_coeffs,t.top_speed),s.grip_increase_coeff*=l(e.grip_increase_coeffs,t.handling),s.grip_decrease_coeff*=l(e.grip_decrease_coeffs,t.handling),s.armor_coeff+=l(e.armor_coeffs,t.armor),s.armor_coeff=ma.clamp0to1(s.armor_coeff),s.drive_wheel_angular_impulse=5*s.drive_impulse/5.5,s.drive_wheel_angular_velocity_max=33*s.drive_velocity_max/700,s}}return Nl.trace("warning: couldn't find "+i+" car config",{fileName:"ProgressionDo.hx",lineNumber:316,className:"bikas.game.ProgressionDo",methodName:"getUpgradedCarConfigCopy"}),new It},Pr.createUpgrades=function(){var e=new br,t=[];t.push(new vr("top_speed")),t.push(new vr("acceleration")),t.push(new vr("handling")),t.push(new vr("armor"));for(var n=0;n<9;){var i=n++/8,r=va.linear;t[0].costs.push(Math.round(r(4,20,i))),t[1].costs.push(Math.round(r(2,12,i))),t[2].costs.push(Math.round(r(1,5,i))),t[3].costs.push(Math.round(r(1,7,i)))}for(var a,s=0,l=0;l<t.length;){var o=t[l];++l,s+=(a=o,ma.sumIntArray(a.costs))}for(var _=function(e,t,n){null==n&&(n=.5),null==t&&(t=30);for(var i=e/t,r=Math.round(va.linear(i,0,n)),a=[],s=0,l=0,o=t;l<o;){var _=l++/(t-1),p=Math.round(ma.interpolate(-r,r,_)),u=Math.round(i+p);s+=u,a.push(u)}if(0<a.length){var h=e-s;a[a.length-1]+=h}return a}(s,30,.2),p=[],u=0,h=0;h<_.length;){var c=_[h];++h,u+=c,p.push(u)}return t[0].costs[t[0].costs.length-1]-=2,e.upgrade_costs=t,e.points_per_level=_,e},Pr.createGameSave=function(e){var t=new Nr;t.level_saves=[];for(var n=0;n<e.length;){var i=e[n];++n;var r=new Cr;r.description_name=i.name,r.description=i,t.level_saves.push(r)}return t},Pr.createLevelDescriptions=function(e){for(var t=function(t,n,i,r,a,s,l,o,_){for(var p=0;p<t.length;){var u=t[p];if(++p,u.name==s)return void Nl.trace("warning: description with exactly the same name already exists: "+s+" (can't have the same names because names are used as unique ID's for the levels)",{fileName:"ProgressionDo.hx",lineNumber:426,className:"bikas.game.ProgressionDo",methodName:"createLevelDescriptions"})}var h=new Sr;h.type=r,h.challenge_type=a,h.name=s,h.nice_name=_;var c=1,d=(h.level_number=l)-1;0<=d&&d<n.length&&(c=n[d]),h.max_stunt_score=100*Math.ceil(o*c/100),0==e.type?h.available_in_final_game=!0:h.available_in_final_game=i,h.level_data_save=null;for(var m=0,f=Gs.level_data_saves;m<f.length;){var g=f[m];if(++m,g.name==s){h.level_data_save=g;break}}i&&null==h.level_data_save&&Nl.trace("warning: could not find level_save for "+s,{fileName:"ProgressionDo.hx",lineNumber:459,className:"bikas.game.ProgressionDo",methodName:"createLevelDescriptions"}),t.push(h)},n=[],i=[],r=0;r<30;){var a=r++,s=va.getT(0,29,a);s=va.linear(.25,1,s),i.push(Math.round(100*s)/100)}t(n,i,!0,wr.LevelMainMenu,kr.None,"main_menu",0,0,"Main Menu"),t(n,i,!0,wr.LevelInterLevelMenu,kr.None,"inter_level_menu",0,0,"Inter Level Menu"),t(n,i,!0,wr.LevelChallenge,kr.ChallengeEscapeFromWolf,"challenge_escape_from_wolf",0,0,"Escape From Wolf Challenge"),t(n,i,!0,wr.LevelChallenge,kr.ChallengeMountainRush,"challenge_mountain_rush",0,0,"Mountain Rush Challenge"),t(n,i,!0,wr.LevelChallenge,kr.ChallengeBalancing,"challenge_balancing",0,0,"Balancing Challenge"),t(n,i,!0,wr.LevelChallenge,kr.ChallengeSurvival,"challenge_survival",0,0,"Survival Challenge"),t(n,i,!0,wr.LevelChallenge,kr.ChallengeBulletTaxi,"challenge_bullet_taxi",0,0,"Bullet Taxi Challenge"),t(n,i,!0,wr.LevelChallenge,kr.ChallengeHuntThePrey,"challenge_hunt_the_prey",0,0,"Hunt The Prey Challenge"),t(n,i,!0,wr.LevelChallenge,kr.ChallengeAchievement,"challenge_achievement",0,0,"100%"),t(n,i,!0,wr.LevelChallenge,kr.ChallengeCredits,"challenge_credits",0,0,"Credits");var l=!0;return 1==e.type&&(l=!e.release.is_demo),t(n,i,!0,wr.LevelRegular,kr.None,"level_1",1,6e3,"The Island"),t(n,i,!0,wr.LevelRegular,kr.None,"level_2",2,7e3,"The Sailing Bay"),t(n,i,!0,wr.LevelRegular,kr.None,"level_3",3,9e3,"The Failed Ship"),t(n,i,!0,wr.LevelRegular,kr.None,"level_4",4,1e4,"The Narrow Passage"),t(n,i,!0,wr.LevelRegular,kr.None,"level_5",5,15e3,"The Sea Village"),t(n,i,!0,wr.LevelRegular,kr.None,"level_6_dip",6,13e3,"The Forgotten Caves"),t(n,i,!0,wr.LevelRegular,kr.None,"level_7",7,9300,"The Pirate Bay"),t(n,i,!0,wr.LevelRegular,kr.None,"level_8",8,11800,"The High Hills"),t(n,i,!0,wr.LevelRegular,kr.None,"level_9_peak",9,11300,"The Peak"),t(n,i,l,wr.LevelRegular,kr.None,"level_10",10,7400,"The Beach Village"),t(n,i,l,wr.LevelRegular,kr.None,"level_11",11,11900,"The Valley"),t(n,i,l,wr.LevelRegular,kr.None,"level_12",12,6900,"The Flat Roads"),t(n,i,l,wr.LevelRegular,kr.None,"level_13",13,10800,"The Modest Caves"),t(n,i,l,wr.LevelRegular,kr.None,"level_14",14,14200,"The Sea Town"),t(n,i,l,wr.LevelRegular,kr.None,"level_15",15,6400,"The Empty Sea"),t(n,i,l,wr.LevelRegular,kr.None,"level_16",16,10100,"The Volcano Bay"),t(n,i,l,wr.LevelRegular,kr.None,"level_17",17,12100,"The Sea Lane"),t(n,i,l,wr.LevelRegular,kr.None,"level_18",18,8e3,"The Rigged Caves"),t(n,i,l,wr.LevelRegular,kr.None,"level_19",19,12100,"The Dip"),t(n,i,l,wr.LevelRegular,kr.None,"level_20",20,16500,"The Bumpy Road"),t(n,i,l,wr.LevelRegular,kr.None,"level_21",21,4500,"The Graveyard"),t(n,i,l,wr.LevelRegular,kr.None,"level_22",22,10200,"The Island"),t(n,i,l,wr.LevelRegular,kr.None,"level_23",23,11200,"The Mountain"),t(n,i,l,wr.LevelRegular,kr.None,"level_24",24,8300,"The Dangerous Heights"),t(n,i,l,wr.LevelRegular,kr.None,"level_25",25,11100,"The Hills And Caves"),t(n,i,l,wr.LevelRegular,kr.None,"level_26",26,5700,"The Top"),t(n,i,l,wr.LevelRegular,kr.None,"level_27",27,24e3,"The Smooth Slopes"),t(n,i,l,wr.LevelRegular,kr.None,"level_28",28,7e3,"The Rugged Lands"),t(n,i,l,wr.LevelRegular,kr.None,"level_29",29,100,"The Treasure"),t(n,i,l,wr.LevelRegular,kr.None,"level_30",30,15400,"The End"),t(n,i,!1,wr.LevelRegular,kr.None,"test",50,1e3,"The Island"),t(n,i,!1,wr.LevelRegular,kr.None,"test_empty",51,1e3,"The Island"),t(n,i,!1,wr.LevelRegular,kr.None,"test_full",52,1e3,"The Island"),n},Pr.getTotalRegularLevelsCompleted=function(e){for(var t=0,n=0,i=e.level_saves;n<i.length;){var r=i[n];++n,r.description.type==wr.LevelRegular&&r.completed&&++t}return t},Pr.setBotCarLineup=function(e,t){for(var n=[],i=0;i<t.length;){var r=t[i];++i,r.completed&&r.description.type==wr.LevelRegular&&n.push(r)}var a=function(t){return t!=e.current_car&&-1==e.current_bot_car_lineup.indexOf(t)},s=function(t){return t!=e.current_car&&-1!=e.current_bot_car_lineup.indexOf(t)},l=cr.rank_1_cars.slice().filter(a),o=cr.rank_2_cars.slice().filter(a),_=cr.rank_3_cars.slice().filter(a),p=cr.rank_1_cars.slice().filter(s),u=cr.rank_2_cars.slice().filter(s),h=cr.rank_3_cars.slice().filter(s);if(-1!=e.current_bot_car_lineup.indexOf(e.current_car)){var c=e.current_bot_car_lineup.indexOf(e.current_car);-1!=cr.rank_1_cars.indexOf(e.current_car)&&0<l.length?e.current_bot_car_lineup[c]=ma.getRandomArrayElement(l):-1!=cr.rank_2_cars.indexOf(e.current_car)&&0<o.length?e.current_bot_car_lineup[c]=ma.getRandomArrayElement(o):-1!=cr.rank_3_cars.indexOf(e.current_car)&&0<_.length?e.current_bot_car_lineup[c]=ma.getRandomArrayElement(_):0<_.length?e.current_bot_car_lineup[c]=ma.getRandomArrayElement(_):0<o.length?e.current_bot_car_lineup[c]=ma.getRandomArrayElement(o):0<l.length?e.current_bot_car_lineup[c]=ma.getRandomArrayElement(l):Nl.trace("warning: no cars to replace to? something went wrong here...",{fileName:"ProgressionDo.hx",lineNumber:642,className:"bikas.game.ProgressionDo",methodName:"setBotCarLineup"}),ga.shuffleArray(e.current_bot_car_lineup)}else if(0<n.length&&n.length!=e.bot_replaced_at_level_count){var d=n[n.length-1],m=!1;if(e.bot_replaced_at_level_count=n.length,1==d.place?0<h.length&&0<o.length?e.current_bot_car_lineup[ma.getRandomArrayIndex(h)]=ma.getRandomArrayElement(o):0<u.length&&0<l.length?e.current_bot_car_lineup[ma.getRandomArrayIndex(u)]=ma.getRandomArrayElement(l):0<h.length&&0<l.length?e.current_bot_car_lineup[ma.getRandomArrayIndex(h)]=ma.getRandomArrayElement(l):m=!0:2==d.place?m=!0:0<p.length&&0<o.length?e.current_bot_car_lineup[ma.getRandomArrayIndex(p)]=ma.getRandomArrayElement(o):0<u.length&&0<_.length?e.current_bot_car_lineup[ma.getRandomArrayIndex(u)]=ma.getRandomArrayElement(_):0<p.length&&0<_.length?e.current_bot_car_lineup[ma.getRandomArrayIndex(p)]=ma.getRandomArrayElement(_):m=!0,m){var f=[];if(0<p.length&&0<l.length&&f.push(1),0<u.length&&0<o.length&&f.push(2),0<h.length&&0<_.length&&f.push(3),0==f.length)Nl.trace("warning: something went wrong, there should be available cars to replace to with same rank",{fileName:"ProgressionDo.hx",lineNumber:716,className:"bikas.game.ProgressionDo",methodName:"setBotCarLineup"});else{var g=ma.getRandomArrayElement(f);1==g?e.current_bot_car_lineup[ma.getRandomArrayIndex(p)]=ma.getRandomArrayElement(l):2==g?e.current_bot_car_lineup[ma.getRandomArrayIndex(u)]=ma.getRandomArrayElement(o):3==g?e.current_bot_car_lineup[ma.getRandomArrayIndex(h)]=ma.getRandomArrayElement(_):Nl.trace("warning: invalid rank",{fileName:"ProgressionDo.hx",lineNumber:728,className:"bikas.game.ProgressionDo",methodName:"setBotCarLineup"})}}ga.shuffleArray(e.current_bot_car_lineup)}},Pr.applyRewardItem=function(e,t,n,i){if(n.desc.type==Mr.ReceiveCoins){var r=Math.round(n.generated_amounts[0]);e.coins+=r,Vn.pushNotification(i,"Received "+r+" Coins!', ")}else if(n.desc.type==Mr.OneTimeUnlockBugCar)-1!=e.locked_cars.indexOf("car_bug")&&s.remove(e.locked_cars,"car_bug"),Vn.pushNotification(i,'Unlocked "Bug" Car!',"");else{n.desc.expiration_type==Ar.Permanent?e.ongoing_powers.permanent_items.push(n):n.desc.expiration_type==Ar.OneLevel||n.desc.expiration_type==Ar.OneTime?e.ongoing_powers.level_items.push(n):Nl.trace("warning: unhandled item.desc.expiration_type: "+p.string(n.desc.expiration_type),{fileName:"ProgressionDo.hx",lineNumber:767,className:"bikas.game.ProgressionDo",methodName:"applyRewardItem"});var a=h.replace(n.desc.name,"(rare)","");Vn.pushNotification(i,"Added: "+a,""),t.current_items.push(n)}};var Mr=n["bikas.game.RewardItemType"]={__ename__:["bikas","game","RewardItemType"],__constructs__:["ConstantAllExplosivesImmunity","ConstantExplosiveBarrelImmunity","ConstantBombAndDynamiteImmunity","ConstantFasterAcceleration","ConstantMoreBoost","ConstantBombAndDynamitePower","ConstantHandling","OneTimeAllExplosivesImmunity","OneTimeExplosiveBarrelImmunity","OneTimeBombAndDynamiteImmunity","OneTimeMoreBoost","OneTimeMoreBombs","OneTimeMoreDynamites","OneTimeAtomicBomb","OneTimePartyTime","OneTimeStartFirst","OneTimeUnlockBugCar","AchievementLevel","ReceiveCoins"]};Mr.ConstantAllExplosivesImmunity=["ConstantAllExplosivesImmunity",0],Mr.ConstantAllExplosivesImmunity.toString=i,(Mr.ConstantAllExplosivesImmunity.__enum__=Mr).ConstantExplosiveBarrelImmunity=["ConstantExplosiveBarrelImmunity",1],Mr.ConstantExplosiveBarrelImmunity.toString=i,(Mr.ConstantExplosiveBarrelImmunity.__enum__=Mr).ConstantBombAndDynamiteImmunity=["ConstantBombAndDynamiteImmunity",2],Mr.ConstantBombAndDynamiteImmunity.toString=i,(Mr.ConstantBombAndDynamiteImmunity.__enum__=Mr).ConstantFasterAcceleration=["ConstantFasterAcceleration",3],Mr.ConstantFasterAcceleration.toString=i,(Mr.ConstantFasterAcceleration.__enum__=Mr).ConstantMoreBoost=["ConstantMoreBoost",4],Mr.ConstantMoreBoost.toString=i,(Mr.ConstantMoreBoost.__enum__=Mr).ConstantBombAndDynamitePower=["ConstantBombAndDynamitePower",5],Mr.ConstantBombAndDynamitePower.toString=i,(Mr.ConstantBombAndDynamitePower.__enum__=Mr).ConstantHandling=["ConstantHandling",6],Mr.ConstantHandling.toString=i,(Mr.ConstantHandling.__enum__=Mr).OneTimeAllExplosivesImmunity=["OneTimeAllExplosivesImmunity",7],Mr.OneTimeAllExplosivesImmunity.toString=i,(Mr.OneTimeAllExplosivesImmunity.__enum__=Mr).OneTimeExplosiveBarrelImmunity=["OneTimeExplosiveBarrelImmunity",8],Mr.OneTimeExplosiveBarrelImmunity.toString=i,(Mr.OneTimeExplosiveBarrelImmunity.__enum__=Mr).OneTimeBombAndDynamiteImmunity=["OneTimeBombAndDynamiteImmunity",9],Mr.OneTimeBombAndDynamiteImmunity.toString=i,(Mr.OneTimeBombAndDynamiteImmunity.__enum__=Mr).OneTimeMoreBoost=["OneTimeMoreBoost",10],Mr.OneTimeMoreBoost.toString=i,(Mr.OneTimeMoreBoost.__enum__=Mr).OneTimeMoreBombs=["OneTimeMoreBombs",11],Mr.OneTimeMoreBombs.toString=i,(Mr.OneTimeMoreBombs.__enum__=Mr).OneTimeMoreDynamites=["OneTimeMoreDynamites",12],Mr.OneTimeMoreDynamites.toString=i,(Mr.OneTimeMoreDynamites.__enum__=Mr).OneTimeAtomicBomb=["OneTimeAtomicBomb",13],Mr.OneTimeAtomicBomb.toString=i,(Mr.OneTimeAtomicBomb.__enum__=Mr).OneTimePartyTime=["OneTimePartyTime",14],Mr.OneTimePartyTime.toString=i,(Mr.OneTimePartyTime.__enum__=Mr).OneTimeStartFirst=["OneTimeStartFirst",15],Mr.OneTimeStartFirst.toString=i,(Mr.OneTimeStartFirst.__enum__=Mr).OneTimeUnlockBugCar=["OneTimeUnlockBugCar",16],Mr.OneTimeUnlockBugCar.toString=i,(Mr.OneTimeUnlockBugCar.__enum__=Mr).AchievementLevel=["AchievementLevel",17],Mr.AchievementLevel.toString=i,(Mr.AchievementLevel.__enum__=Mr).ReceiveCoins=["ReceiveCoins",18],Mr.ReceiveCoins.toString=i,(Mr.ReceiveCoins.__enum__=Mr).__empty_constructs__=[Mr.ConstantAllExplosivesImmunity,Mr.ConstantExplosiveBarrelImmunity,Mr.ConstantBombAndDynamiteImmunity,Mr.ConstantFasterAcceleration,Mr.ConstantMoreBoost,Mr.ConstantBombAndDynamitePower,Mr.ConstantHandling,Mr.OneTimeAllExplosivesImmunity,Mr.OneTimeExplosiveBarrelImmunity,Mr.OneTimeBombAndDynamiteImmunity,Mr.OneTimeMoreBoost,Mr.OneTimeMoreBombs,Mr.OneTimeMoreDynamites,Mr.OneTimeAtomicBomb,Mr.OneTimePartyTime,Mr.OneTimeStartFirst,Mr.OneTimeUnlockBugCar,Mr.AchievementLevel,Mr.ReceiveCoins];var Ir=function(){};(n["bikas.game.RewardItemRange"]=Ir).__name__=["bikas","game","RewardItemRange"],Ir.prototype={min:null,max:null,__class__:Ir};var Tr=function(){this.char_end_index=0,this.char_start_index=0,this.ranges=[]};(n["bikas.game.RewardItemRanges"]=Tr).__name__=["bikas","game","RewardItemRanges"],Tr.prototype={ranges:null,char_start_index:null,char_end_index:null,__class__:Tr};var Ar=n["bikas.game.RewardItemExpirationType"]={__ename__:["bikas","game","RewardItemExpirationType"],__constructs__:["OneTime","OneLevel","Permanent"]};Ar.OneTime=["OneTime",0],Ar.OneTime.toString=i,(Ar.OneTime.__enum__=Ar).OneLevel=["OneLevel",1],Ar.OneLevel.toString=i,(Ar.OneLevel.__enum__=Ar).Permanent=["Permanent",2],Ar.Permanent.toString=i,(Ar.Permanent.__enum__=Ar).__empty_constructs__=[Ar.OneTime,Ar.OneLevel,Ar.Permanent];var Dr=function(){this.ranges=[],this.probability=1};(n["bikas.game.RewardItemDesc"]=Dr).__name__=["bikas","game","RewardItemDesc"],Dr.prototype={id:null,name:null,type:null,expiration_type:null,reward_texture_name:null,ongoing_texture_name:null,description:null,probability:null,ranges:null,__class__:Dr};var Er=function(){this.shown=!1,this.desc=null};(n["bikas.game.RewardItem"]=Er).__name__=["bikas","game","RewardItem"],Er.prototype={id:null,desc:null,generated_amounts:null,description_text:null,shown:null,__class__:Er};var Or=function(){};(n["bikas.game.RewardCard"]=Or).__name__=["bikas","game","RewardCard"],Or.prototype={item:null,container:null,background:null,item_sprite:null,name_text:null,description_text:null,__class__:Or};var Br=function(){this.cards=[]};(n["bikas.game.RewardSelection"]=Br).__name__=["bikas","game","RewardSelection"],Br.prototype={container:null,middle_container:null,background:null,title_text:null,or_text:null,cards:null,__class__:Br};var Lr=n["bikas.game.AchievementType"]={__ename__:["bikas","game","AchievementType"],__constructs__:["Finish2Levels","Finish6Levels","Stunt3xFrontFlip","Stunt3xCombo","Finish10LevelsWith100Score","Stunt10BackFlipsInALevel","Stunt100Flips","Finish20Levels1st","Stunt10xCombo","Finish30LevelsWith100Score"]};Lr.Finish2Levels=["Finish2Levels",0],Lr.Finish2Levels.toString=i,(Lr.Finish2Levels.__enum__=Lr).Finish6Levels=["Finish6Levels",1],Lr.Finish6Levels.toString=i,(Lr.Finish6Levels.__enum__=Lr).Stunt3xFrontFlip=["Stunt3xFrontFlip",2],Lr.Stunt3xFrontFlip.toString=i,(Lr.Stunt3xFrontFlip.__enum__=Lr).Stunt3xCombo=["Stunt3xCombo",3],Lr.Stunt3xCombo.toString=i,(Lr.Stunt3xCombo.__enum__=Lr).Finish10LevelsWith100Score=["Finish10LevelsWith100Score",4],Lr.Finish10LevelsWith100Score.toString=i,(Lr.Finish10LevelsWith100Score.__enum__=Lr).Stunt10BackFlipsInALevel=["Stunt10BackFlipsInALevel",5],Lr.Stunt10BackFlipsInALevel.toString=i,(Lr.Stunt10BackFlipsInALevel.__enum__=Lr).Stunt100Flips=["Stunt100Flips",6],Lr.Stunt100Flips.toString=i,(Lr.Stunt100Flips.__enum__=Lr).Finish20Levels1st=["Finish20Levels1st",7],Lr.Finish20Levels1st.toString=i,(Lr.Finish20Levels1st.__enum__=Lr).Stunt10xCombo=["Stunt10xCombo",8],Lr.Stunt10xCombo.toString=i,(Lr.Stunt10xCombo.__enum__=Lr).Finish30LevelsWith100Score=["Finish30LevelsWith100Score",9],Lr.Finish30LevelsWith100Score.toString=i,(Lr.Finish30LevelsWith100Score.__enum__=Lr).__empty_constructs__=[Lr.Finish2Levels,Lr.Finish6Levels,Lr.Stunt3xFrontFlip,Lr.Stunt3xCombo,Lr.Finish10LevelsWith100Score,Lr.Stunt10BackFlipsInALevel,Lr.Stunt100Flips,Lr.Finish20Levels1st,Lr.Stunt10xCombo,Lr.Finish30LevelsWith100Score];var jr=function(){};(n["bikas.game.AchievementDesc"]=jr).__name__=["bikas","game","AchievementDesc"],jr.prototype={id:null,name:null,type:null,requirement:null,item:null,texture_name:null,__class__:jr};var Fr=function(){};(n["bikas.game.ChallengeDesc"]=Fr).__name__=["bikas","game","ChallengeDesc"],Fr.prototype={id:null,name:null,type:null,requirement:null,item:null,__class__:Fr};var Rr=function(){};(n["bikas.game.OngoingPowerDisplayDescription"]=Rr).__name__=["bikas","game","OngoingPowerDisplayDescription"],Rr.prototype={container:null,background:null,icon:null,text:null,item:null,__class__:Rr};var Gr=n["bikas.game.OngoingPowerDisplayItemAnimType"]={__ename__:["bikas","game","OngoingPowerDisplayItemAnimType"],__constructs__:["ItemDefault","ItemPhaseIn","ItemPhaseOut","ItemWasJustUsed"]};Gr.ItemDefault=["ItemDefault",0],Gr.ItemDefault.toString=i,(Gr.ItemDefault.__enum__=Gr).ItemPhaseIn=["ItemPhaseIn",1],Gr.ItemPhaseIn.toString=i,(Gr.ItemPhaseIn.__enum__=Gr).ItemPhaseOut=["ItemPhaseOut",2],Gr.ItemPhaseOut.toString=i,(Gr.ItemPhaseOut.__enum__=Gr).ItemWasJustUsed=["ItemWasJustUsed",3],Gr.ItemWasJustUsed.toString=i,(Gr.ItemWasJustUsed.__enum__=Gr).__empty_constructs__=[Gr.ItemDefault,Gr.ItemPhaseIn,Gr.ItemPhaseOut,Gr.ItemWasJustUsed];var Zr=function(){this.items=[]};(n["bikas.game.OngoingPowerDisplayItem"]=Zr).__name__=["bikas","game","OngoingPowerDisplayItem"],Zr.prototype={type:null,container:null,sprite:null,items:null,item_icon_texture_name:null,width:null,height:null,current_time:null,__class__:Zr};var Ur=function(){this.remove_display_items=[],this.display_items=[],this.skip_expand_display_item=null,this.expand_display_item=null,this.just_used_items=[],this.current_items=[]};(n["bikas.game.OngoingPowersDisplay"]=Ur).__name__=["bikas","game","OngoingPowersDisplay"],Ur.prototype={current_items:null,just_used_items:null,expand_display_item:null,skip_expand_display_item:null,display_items:null,remove_display_items:null,__class__:Ur};var Vr=function(){};(n["bikas.game.RewardDo"]=Vr).__name__=["bikas","game","RewardDo"],Vr.createRewardsForChests=function(){var e=[];return Vr.pushRewardItemDesc(e,"explosion_armor_id","Explosion Armor",Mr.ConstantAllExplosivesImmunity,Ar.OneLevel,Vr.armor_texture,1,"+{5-10,11-15,16-25}% constant immunity against all explosives (expires after 1 level)"),Vr.pushRewardItemDesc(e,"explosion_defense_id","Explosion Defense",Mr.OneTimeAllExplosivesImmunity,Ar.OneTime,Vr.armor_texture,1,"One time +{21-40,40-60,60-80}% immunity against any explosive"),Vr.pushRewardItemDesc(e,"barrel_barrier_id","Barrel Barrier",Mr.ConstantExplosiveBarrelImmunity,Ar.OneLevel,Vr.armor_texture,1,"+{11-15,16-30,31-50}% constant immunity against explosive barrels (expires after 1 level)"),Vr.pushRewardItemDesc(e,"barrel_insurance_id","Barrel Insurance",Mr.OneTimeExplosiveBarrelImmunity,Ar.OneTime,Vr.armor_texture,1,"One time +{41-60,61-80,81-100}% immunity against 1 explosive barrel"),Vr.pushRewardItemDesc(e,"defense_id","Defense",Mr.ConstantBombAndDynamiteImmunity,Ar.OneLevel,Vr.armor_texture,1,"+{11-15,16-30,31-50}% constant immunity against bombs and dynamites (expires after 1 level)"),Vr.pushRewardItemDesc(e,"deflection_id","Deflection",Mr.OneTimeBombAndDynamiteImmunity,Ar.OneTime,Vr.armor_texture,1,"One time +{41-60,61-80,81-100}% immunity against 1 bomb or 1 dynamite"),Vr.pushRewardItemDesc(e,"more_power_id","More Power",Mr.ConstantBombAndDynamitePower,Ar.OneLevel,Vr.bomb_texture,1,"Increase power of your bombs and dynamites by +{11-15,16-30,31-50}% (expires after 1 level)"),Vr.pushRewardItemDesc(e,"aggressive_start_id","Agressive Start",Mr.OneTimeMoreBombs,Ar.OneLevel,Vr.bomb_texture,1,"Start next level with 1 bomb"),Vr.pushRewardItemDesc(e,"split_the_drivers_id","Split The Drivers",Mr.OneTimeMoreDynamites,Ar.OneLevel,Vr.dynamite_texture,1,"Start next level with 1 dynamite"),Vr.pushRewardItemDesc(e,"acceleration_id","Acceleration",Mr.ConstantFasterAcceleration,Ar.OneLevel,Vr.acceleration_texture,1,"+{2-4,5-7,8-10}% faster acceleration (expires after 1 level)"),Vr.pushRewardItemDesc(e,"boosted_boost_id","Boosted Boost",Mr.ConstantMoreBoost,Ar.OneLevel,Vr.boost_texture,1,"+{5-10,11-15,16-25}% faster boost (expires after 1 level)"),Vr.pushRewardItemDesc(e,"boosted_start_id","Boosted Start",Mr.OneTimeMoreBoost,Ar.OneLevel,Vr.boost_texture,1,"Add +{1,2,3}x boost for the next level"),Vr.pushRewardItemDesc(e,"more_money_id","More Money",Mr.ReceiveCoins,Ar.OneTime,Vr.coin_texture,1,"+{20-40} coins"),Vr.pushRewardItemDesc(e,"atomic_bomb_id","Atomic Bomb (rare)",Mr.OneTimeAtomicBomb,Ar.OneLevel,Vr.bomb_texture,.3,"Start next level with a bomb which is {250}% more powerful than the regular one"),Vr.pushRewardItemDesc(e,"party_time_id","Party Time (rare)",Mr.OneTimePartyTime,Ar.OneLevel,Vr.balloons_texture,.3,"Attach balloons to all other cars except yours in the next level"),Vr.pushRewardItemDesc(e,"start_first_id","Start First (rare)",Mr.OneTimeStartFirst,Ar.OneLevel,Vr.first_texture,.3,"Start first in the next level"),Vr.pushRewardItemDesc(e,"pile_of_gold_id","Pile of Gold (rare)",Mr.ReceiveCoins,Ar.OneTime,Vr.coin_texture,.07,"+{200-400} coins"),e},Vr.pushRewardItemDesc=function(e,t,n,i,r,a,s,l){var o=new Dr;o.id=t,o.name=n,o.type=i,o.expiration_type=r,o.reward_texture_name=Vr.reward_prefix+a,o.ongoing_texture_name=Vr.ongoing_prefix+a,o.probability=s,o.description=l,o.ranges=Vr.parseDescriptionIntoRanges(o.description),e.push(o)},Vr.createRewardsForAchievements=function(){var e=[];return Vr.pushAchievementDesc(e,"beginner_id","Beginner",Lr.Finish2Levels,"Finish 2 levels","More Money",Mr.ReceiveCoins,Vr.coin_texture,"+{150} coins"),Vr.pushAchievementDesc(e,"adventurer_id","Adventurer",Lr.Finish6Levels,"Finish 6 levels",'Unlock "Bug" car',Mr.OneTimeUnlockBugCar,Vr.unlock_car_texture,'Unlock "Bug" car'),Vr.pushAchievementDesc(e,"spinner_id","Spinner",Lr.Stunt3xFrontFlip,"Do a 3x front flip in one take","Permanent Defense",Mr.ConstantBombAndDynamiteImmunity,Vr.armor_texture,"+{10}% immunity against bombs and dynamites (permanent)"),Vr.pushAchievementDesc(e,"combo_pro_id","Combo Pro",Lr.Stunt3xCombo,"Do a 3x stunt combo in one take","Permanent Barrel Barrier",Mr.ConstantExplosiveBarrelImmunity,Vr.armor_texture,"+{10}% immunity against explosive barrels (permanent)"),Vr.pushAchievementDesc(e,"completionist_id","Completionist",Lr.Finish10LevelsWith100Score,"Complete 10 levels with 100% score","More Money",Mr.ReceiveCoins,Vr.coin_texture,"+{600} coins"),Vr.pushAchievementDesc(e,"back_flip_expert_id","Back Flip Expert",Lr.Stunt10BackFlipsInALevel,"Do a total of 10 back flips in any level","Permanent +Handling",Mr.ConstantHandling,Vr.handling_texture,"+{10}% handling (permanent)"),Vr.pushAchievementDesc(e,"flip_master_id","Flip Master",Lr.Stunt100Flips,"Do a total of 100 flips throughout all levels","Permanent Explosion Armor",Mr.ConstantAllExplosivesImmunity,Vr.armor_texture,"+{20}% immunity against all explosives (permanent)"),Vr.pushAchievementDesc(e,"number_one_id","Number One",Lr.Finish20Levels1st,"Finish 20 levels in the 1st position","Permanent +Power",Mr.ConstantBombAndDynamitePower,Vr.bomb_texture,"Increase power of your bombs and dynamites by +{40}% (permanent)"),Vr.pushAchievementDesc(e,"combo_expert_id","Combo Expert",Lr.Stunt10xCombo,"Do a 10x combo in one take","Permanent Barrel Barrier",Mr.ConstantExplosiveBarrelImmunity,Vr.armor_texture,"+{40}% immunity against explosive barrels (permanent)"),Vr.pushAchievementDesc(e,"one_hundred_id","100%",Lr.Finish30LevelsWith100Score,"Complete 30 levels with 100% score","???",Mr.AchievementLevel,Vr.coin_texture,"???"),e},Vr.pushAchievementDesc=function(e,t,n,i,r,a,s,l,o){var _=new Dr;_.id=t,_.name=a,_.type=s,_.reward_texture_name=Vr.reward_prefix+l,_.ongoing_texture_name=Vr.ongoing_prefix+l,_.description=o,_.probability=1,_.expiration_type=Ar.Permanent,_.ranges=Vr.parseDescriptionIntoRanges(_.description);var p=new jr;p.id=t,p.name=n,p.type=i,p.item=Vr.generateRewardItem(_,0),p.requirement=r,p.texture_name=Vr.achievement_prefix+l,e.push(p)},Vr.createRewardsForChallenges=function(){var e=[];return Vr.pushChallengeDesc(e,"escape_from_wolf_challenge_id","Escape From Wolf Challenge",kr.ChallengeEscapeFromWolf,"Finish 4 levels","Permanent Explosion Armor",Mr.ConstantAllExplosivesImmunity,Vr.armor_texture,"+{10}% immunity against all explosives (permanent)"),Vr.pushChallengeDesc(e,"mountain_rush_challenge_id","Mountain Rush Challenge",kr.ChallengeMountainRush,"Finish 8 levels","Permanent +Acceleration",Mr.ConstantFasterAcceleration,Vr.acceleration_texture,"+{5}% faster acceleration (permanent)"),Vr.pushChallengeDesc(e,"balancing_challenge_id","Balancing Challenge",kr.ChallengeBalancing,"Finish 12 levels","Permanent +Handling",Mr.ConstantHandling,Vr.handling_texture,"+{10}% handling (permanent)"),Vr.pushChallengeDesc(e,"survival_challenge_id","Survival Challenge",kr.ChallengeSurvival,"Finish 16 levels","Permanent Barrel Barrier",Mr.ConstantExplosiveBarrelImmunity,Vr.armor_texture,"+{25}% immunity against explosive barrels (permanent)"),Vr.pushChallengeDesc(e,"bullet_taxi_challenge_id","Bullet Taxi Challenge",kr.ChallengeBulletTaxi,"Finish 20 levels","Permanent Boosted Boost",Mr.ConstantMoreBoost,Vr.boost_texture,"+{10}% faster boost (permanent)"),Vr.pushChallengeDesc(e,"hunt_the_prey_challenge_id","Hunt The Prey Challenge",kr.ChallengeHuntThePrey,"Finish 24 levels","Permanent +Power",Mr.ConstantBombAndDynamitePower,Vr.bomb_texture,"+{25}% power to bombs and dynamites (permanent)"),e},Vr.pushChallengeDesc=function(e,t,n,i,r,a,s,l,o){var _=new Dr;_.id=t,_.name=a,_.type=s,_.reward_texture_name=Vr.reward_prefix+l,_.ongoing_texture_name=Vr.ongoing_prefix+l,_.description=o,_.probability=1,_.expiration_type=Ar.Permanent,_.ranges=Vr.parseDescriptionIntoRanges(_.description);var p=new Fr;p.id=t,p.name=n,p.type=i,p.item=Vr.generateRewardItem(_,0),p.requirement=r,e.push(p)},Vr.parseDescriptionIntoRanges=function(e){for(var t=[],n=0;n<e.length;){if("{"==e.charAt(n)){var i=new Tr;i.char_start_index=n;var r="";for(++n;n<e.length;){var a=e.charAt(n);if("}"==a){i.char_end_index=n+1;break}r+=a,++n}for(var s=r.split(","),l=0;l<s.length;){var o=s[l];++l;var _=o.split("-"),u=new Ir;1==_.length?u.max=u.min=p.parseFloat(h.trim(_[0])):2==_.length?(u.min=p.parseFloat(h.trim(_[0])),u.max=p.parseFloat(h.trim(_[1]))):Nl.trace("warning: unsupported syntax in "+o,{fileName:"RewardDo.hx",lineNumber:700,className:"bikas.game.RewardDo",methodName:"parseDescriptionIntoRanges"}),i.ranges.push(u)}t.push(i)}++n}return t},Vr.generateItemByType=function(e,t,n){null==n&&(n=-1);for(var i=0;i<e.length;){var r=e[i];if(++i,r.type==t)return Vr.generateRewardItem(r,n)}return null},Vr.generateAnyItem=function(e,t){null==t&&(t=-1),0==e.length&&Nl.trace("warning: descs.length == 0",{fileName:"RewardDo.hx",lineNumber:728,className:"bikas.game.RewardDo",methodName:"generateAnyItem"});for(var n=0,i=0;i<e.length;){var r=e[i];++i,n+=r.probability}for(var a=ma.getRandomBetween(0,n),s=0,l=null,o=0;o<e.length;){var _=e[o];if(++o,a<=(s+=_.probability)){l=_;break}}return null==l&&(Nl.trace("warning: something went wrong while generating probability",{fileName:"RewardDo.hx",lineNumber:750,className:"bikas.game.RewardDo",methodName:"generateAnyItem"}),l=e[0]),-1==t&&(t=ma.getRandomBetweenInt(0,2)),Vr.generateRewardItem(l,t)},Vr.generateRewardItem=function(e,t){var n=new Er;n.desc=e,n.id=e.id,n.generated_amounts=[];for(var i=0,r=[],a=0,s=e.ranges;a<s.length;){var l=s[a];++a;var o=ma.clampInt(t,0,l.ranges.length-1),_=l.ranges[o],p=Math.round(ma.getRandomBetween(_.min,_.max)),u=e.description.substring(i,l.char_start_index),h=null==p?"null":""+p;i=l.char_end_index,r.push(u),r.push(h),n.generated_amounts.push(p)}var c=e.description.substring(i,e.description.length);r.push(c),n.description_text="";for(var d=0;d<r.length;){var m=r[d];++d,n.description_text+=m}return n},Vr.createRewardSelection=function(e,t,n){null==n&&(n=-1);var i=new Br;i.container=qa.createGroup(),i.middle_container=qa.createGroup(),i.background=qa.createSprite(Gs.menu_background),i.background.x=-1,i.background.y=-1,i.background.width=e.current_game_width+2,i.background.height=e.current_game_height+2,i.background.alpha=.75,i.title_text=new ms($s.game,0,0,fn.toonish_36,"",50,"center"),i.title_text.anchor.set(.5,.5),i.title_text.text="Pick Your Reward",i.title_text.x=0,i.title_text.y=Or.title_text_y,i.or_text=new ms($s.game,0,0,fn.toonish_36,"",50,"center"),i.or_text.anchor.set(.5,.5),i.or_text.text="OR",i.or_text.x=0,i.or_text.y=0,i.container.add(i.background),i.container.add(i.middle_container);for(var r=0;r<2;){var a=r++,l=Vr.generateAnyItem(t,n);s.remove(t,l.desc);var o=Vr.createRewardCard(l);i.cards.push(o),o.container.scale.x=Br.card_scale,o.container.scale.y=Br.card_scale,(o.container.y=0)==a?o.container.x=-o.container.width/2-Br.distance_between_cards/2:1==a&&(o.container.x=o.background.width/2+Br.distance_between_cards/2),i.middle_container.add(o.container)}return i.middle_container.add(i.title_text),i.middle_container.add(i.or_text),i},Vr.createRewardCard=function(e){var t=new Or;if(t.item=e,t.container=qa.createGroup(),t.background=qa.createSpriteByName("reward_card",.5,.5),t.background.scale.x=Or.background_scale,t.background.scale.y=Or.background_scale,""!=e.desc.reward_texture_name){var n=Hs.retrieveAsset(e.desc.reward_texture_name);null!=n&&(t.item_sprite=qa.createSprite(n,.5,.5),t.item_sprite.scale.x=1,t.item_sprite.scale.y=1,t.item_sprite.position.x=0,t.item_sprite.position.y=Or.icon_y)}return t.name_text=new ms($s.game,0,0,fn.bell_gothic_std_black_dark_26,"",Or.name_text_font_size,"center"),t.name_text.anchor.set(.5,0),t.name_text.text=e.desc.name,t.name_text.position.x=0,t.name_text.position.y=Or.name_text_y,t.description_text=new ms($s.game,0,0,fn.bell_gothic_std_bold_dark_26,"",Or.description_text_font_size,"left"),t.description_text.text=e.description_text+".",t.description_text.anchor.set(.5,0),t.description_text.maxWidth=Or.description_text_max_width,t.description_text.position.x=0,t.description_text.position.y=Or.description_text_y,t.container.add(t.background),null!=t.item_sprite&&t.container.add(t.item_sprite),t.container.add(t.name_text),t.container.add(t.description_text),t},Vr.destroyRewardSelection=function(e){if(null!=e.container){for(var t=0,n=e.cards;t<n.length;){var i=n[t];++t,Vr.destroyRewardCard(i)}null!=e.container.parent&&e.container.parent.removeChild(e.container),e.middle_container.destroy(!0),e.background.destroy(!0),e.background=null,e.title_text.destroy(!0),e.title_text=null,e.or_text.destroy(!0),e.or_text=null,e.container.destroy(!0),e.cards=null}},Vr.destroyRewardCard=function(e){(e.item=null)!=e.container&&(null!=e.container.parent&&e.container.parent.removeChild(e.container),e.background.destroy(!0),(e.background=null)!=e.item_sprite&&(e.item_sprite.destroy(!0),e.item_sprite=null),e.name_text.destroy(!0),e.name_text=null,e.description_text.destroy(!0),e.description_text=null,e.container.destroy(!0),e.container=null)},Vr.clearOngoingPowersDisplay=function(e){for(var t=0,n=e.display_items;t<n.length;){var i=n[t];++t;for(var r=i.items.slice(),a=0;a<r.length;){var s=r[a];++a,Vr.removeItemFromDisplayItem(i,s)}i.sprite.destroy(!0),i.container.destroy(!0),i.container=null,i.sprite=null,i.items=null}e.display_items=[],e.just_used_items=[],e.remove_display_items=[]},Vr.animateDisplayItemAlphaAndScale=function(e,t,n,i,r,a){var s=e.current_time,l=va.getTClamped(0,a,s);e.sprite.alpha=va.linear(t,n,l);var o=va.linear(i,r,l);return e.sprite.width=e.width*o,e.sprite.height=e.height*o,1==l},Vr.createOngoingPowerDisplayItem=function(e){var t=new Zr;return t.container=qa.createGroup(),e.shown?t.type=Gr.ItemDefault:t.type=Gr.ItemPhaseIn,e.shown=!0,Vr.addItemToDisplayItem(t,e),t.item_icon_texture_name=e.desc.ongoing_texture_name,t.sprite=qa.createSpriteByName(t.item_icon_texture_name,.5,.5),t.container.add(t.sprite),t.width=Zr.item_size,t.height=Zr.item_size,t.sprite.width=t.width,t.sprite.height=t.height,t.current_time=0,t},Vr.addItemToDisplayItem=function(e,t){var n=new Rr;n.item=t,n.container=qa.createGroup(),n.background=qa.createSpriteByName("white_bar",1,.5,0,0),n.icon=qa.createSpriteByName(t.desc.ongoing_texture_name,.5,.5),n.text=qa.createBitmapText(fn.consolas_24,Rr.text_size,"left",t.description_text,1,.5),n.icon.width=Zr.item_size,n.icon.height=Zr.item_size,n.icon.position.x=0,n.icon.position.y=0,n.text.position.x=Rr.text_offset_x,n.text.position.y=0,n.background.width=n.text.width+n.icon.width,n.background.height=n.icon.height,n.background.alpha=.85,e.items.push(n);var i=e.items.indexOf(n);n.container.position.x=0,n.container.position.y=Rr.offset_y+i*Rr.spacing,n.container.add(n.background),n.container.add(n.icon),n.container.add(n.text)},Vr.removeItemFromDisplayItem=function(e,t){t.background.destroy(!0),t.icon.destroy(!0),t.text.destroy(!0),t.container.destroy(!0),s.remove(e.items,t);for(var n=0,i=0,r=e.items;i<r.length;){var a=r[i];++i,a.container.position.y=Rr.offset_y+n*Rr.spacing,++n}},Vr.updateOngoingPowersDisplay=function(e,t,n,i,r,a,l,o,_){for(var p=0,u=t.current_items;p<u.length;){var h=u[p];++p;for(var c=!1,d=0,m=t.display_items;d<m.length;){var f=m[d];if(++d,h.desc.ongoing_texture_name==f.item_icon_texture_name){for(var g=!(c=!0),v=0,b=f.items;v<b.length;){var y=b[v];if(++v,y.item==h){g=!0;break}}g||(Vr.addItemToDisplayItem(f,h),h.shown?f.type=Gr.ItemDefault:f.type=Gr.ItemPhaseIn,h.shown=!0,f.current_time=0)}}if(!c){var x=Vr.createOngoingPowerDisplayItem(h);e.add(x.container),t.display_items.push(x)}}for(var z=i.current_game_width-l,w=0,k=t.display_items;w<k.length;){var S=k[w];if(++w,S.type!=Gr.ItemWasJustUsed){for(var C=!1,N=0,P=t.just_used_items;N<P.length;){var M=P[N];if(++N,M.desc.ongoing_texture_name==S.item_icon_texture_name){C=!0;break}}if(C){for(var I=0;I<t.just_used_items.length;){for(var T=0,A=S.items;T<A.length;){var D=A[T];if(++T,D.item==t.just_used_items[I]){t.just_used_items.splice(I,1),--I;break}}++I}S.type=Gr.ItemWasJustUsed,S.current_time=0}}if(S.type!=Gr.ItemPhaseOut){for(var E=null,O=0,B=S.items;O<B.length;){var L=B[O];++O,-1==t.current_items.indexOf(L.item)&&(null==E&&(E=[]),E.push(L))}if(null!=E)for(var j=0;j<E.length;){var F=E[j];++j,Vr.removeItemFromDisplayItem(S,F)}0==S.items.length&&(S.type=Gr.ItemPhaseOut,S.current_time=0)}if(S.container.x=i.current_game_width-z,S.container.y=o+50,null!=$a.getClicked(S.container.x,S.container.y,r,Zr.item_size/2))if(t.skip_expand_display_item==S)t.skip_expand_display_item=null,Ms.playSound(Gs.sound_click,_);else{if(null!=t.expand_display_item)for(var R=0,G=t.expand_display_item.items;R<G.length;){var Z=G[R];++R,null!=Z.container.parent&&Z.container.parent.removeChild(Z.container)}t.expand_display_item!=S&&(t.expand_display_item=S,Ms.playSound(Gs.sound_click,_))}if(z+=Zr.item_distance,S.current_time+=a.dc,S.type!=Gr.ItemDefault)if(S.type==Gr.ItemPhaseIn)Vr.animateDisplayItemAlphaAndScale(S,0,1,Zr.phase_in_scale,1,Zr.phase_in_time)&&(S.type=Gr.ItemDefault,S.current_time=0,Vn.applyCameraShake(n,Zr.phase_in_camera_shake_amount,Zr.phase_in_camera_shake_time),Ms.playSound(Gs.sound_ongoing_power,_));else if(S.type==Gr.ItemPhaseOut)Vr.animateDisplayItemAlphaAndScale(S,1,0,1,Zr.phase_out_scale,Zr.phase_out_time)&&(t.remove_display_items.push(S),S.current_time=0);else if(S.type==Gr.ItemWasJustUsed){var U=va.getTClamped(0,Zr.phase_use_time,S.current_time),V=va.linearForwardAndBackward(1,Zr.phase_use_scale,U);S.sprite.width=S.width*V,S.sprite.height=S.height*V,1==U&&(S.type=Gr.ItemDefault,S.current_time=0)}}if(null!=t.expand_display_item){for(var q=0,W=t.expand_display_item.items;q<W.length;){var X=W[q];++q,null==X.container.parent&&t.expand_display_item.container.add(X.container)}if(null!=$a.getPointerDowned(r)){$a.isDowned(t.expand_display_item.container.x,t.expand_display_item.container.y,r,Zr.item_size/2)&&(t.skip_expand_display_item=t.expand_display_item);for(var H=0,Y=t.expand_display_item.items;H<Y.length;){var J=Y[H];++H,null!=J.container.parent&&J.container.parent.removeChild(J.container)}t.expand_display_item=null}}if(0<t.remove_display_items.length){for(var K=0,Q=t.remove_display_items;K<Q.length;){var $=Q[K];++K,$.sprite.destroy(!0),$.container.destroy(!0),$==t.expand_display_item&&(t.expand_display_item=null),$==t.skip_expand_display_item&&(t.skip_expand_display_item=null),$.items=null,$.sprite=null,s.remove(t.display_items,$)}t.remove_display_items=[]}};var qr=function(){};(n["bikas.game.StuntObject"]=qr).__name__=["bikas","game","StuntObject"],qr.prototype={id:null,name:null,text:null,points:null,current_min_display_time:null,__class__:qr};var Wr=function(){this.total_level_score=0,this.total_perfect_landings=0,this.total_combos=0,this.total_back_wheelies=0,this.total_front_wheelies=0,this.total_back_flips=0,this.total_front_flips=0,this.max_level_score=0,this.max_combos=0,this.max_back_wheelies=0,this.max_front_wheelies=0,this.max_back_flips=0,this.max_front_flips=0};(n["bikas.game.StuntStats"]=Wr).__name__=["bikas","game","StuntStats"],Wr.prototype={max_front_flips:null,max_back_flips:null,max_front_wheelies:null,max_back_wheelies:null,max_combos:null,max_level_score:null,total_front_flips:null,total_back_flips:null,total_front_wheelies:null,total_back_wheelies:null,total_combos:null,total_perfect_landings:null,total_level_score:null,__class__:Wr};var Xr=function(){this.score_container_visible=!0,this.phase_out=!1,this.current_interpolate_scale=1,this.current_interpolate_time_max=0,this.current_interpolate_time=0,this.previous_stunt_object_for_sounds=null,this.que=[],this.accumulated_front_wheelies=0,this.accumulated_back_wheelies=0,this.previous_stunt_time_stamp=0,this.last_front_wheelies=0,this.last_back_wheelies=0,this.stats=new Wr,this.combos=0,this.back_flips=0,this.front_flips=0,this.previous_stunt_flag=-1,this.flip_combo_can_happen=!1,this.current_score=0,this.front_wheel_collide_time=0,this.back_wheel_collide_time=0,this.last_air_time=0,this.air_time=0,this.accumulated_back_wheel_time=0,this.accumulated_front_wheel_time=0,this.accumulated_angle=0,this.previous_angle=0};(n["bikas.game.Stunt"]=Xr).__name__=["bikas","game","Stunt"],Xr.prototype={previous_angle:null,accumulated_angle:null,accumulated_front_wheel_time:null,accumulated_back_wheel_time:null,air_time:null,last_air_time:null,back_wheel_collide_time:null,front_wheel_collide_time:null,current_score:null,flip_combo_can_happen:null,previous_stunt_flag:null,front_flips:null,back_flips:null,combos:null,stats:null,last_back_wheelies:null,last_front_wheelies:null,previous_stunt_time_stamp:null,accumulated_back_wheelies:null,accumulated_front_wheelies:null,que:null,previous_stunt_object_for_sounds:null,current_interpolate_time:null,current_interpolate_time_max:null,current_interpolate_scale:null,phase_out:null,name_text:null,score_text:null,score_container_visible:null,score_container:null,score_background:null,score_foreground:null,score_percent_text:null,__class__:Xr};var Hr=function(){};(n["bikas.game.StuntDo"]=Hr).__name__=["bikas","game","StuntDo"],Hr.create=function(e,t){var n=new Xr;return n.name_text=new ms($s.game,0,0,"toonish_36","1x Front Flip",42,"center"),n.score_text=new ms($s.game,0,0,"toonish_36","1000",42,"center"),e.add(n.name_text),e.add(n.score_text),n.name_text.alpha=0,n.score_text.alpha=0,n.name_text.anchor.x=.5,n.name_text.anchor.y=.5,n.score_text.anchor.x=.5,n.score_text.anchor.y=.5,n.score_container=qa.createGroup(),n.score_background=qa.createSpriteByName("stunt_bar_empty",0,0),n.score_foreground=qa.createSpriteByName("stunt_bar_full",0,0),n.score_background.scale.x=1,n.score_background.scale.y=1,n.score_foreground.scale.x=0,n.score_foreground.scale.y=1,n.score_background.x=-n.score_background.width,n.score_foreground.x=n.score_background.x,n.score_percent_text=new ms($s.game,0,0,fn.avantgarde_lt_medium_dark_26,"0%",22,"center"),n.score_percent_text.anchor.x=.5,n.score_percent_text.anchor.y=.5,n.score_percent_text.position.x=-n.score_background.width/2,n.score_percent_text.position.y=n.score_background.height/2+5,n.score_container.add(n.score_foreground),n.score_container.add(n.score_background),n.score_container.add(n.score_percent_text),e.add(n.score_container),n},Hr.getHighestStunts=function(e,t){var n=new Wr;return n.max_front_flips=ma.maxInt(e.max_front_flips,t.max_front_flips),n.max_back_flips=ma.maxInt(e.max_back_flips,t.max_back_flips),n.max_front_wheelies=ma.maxInt(e.max_front_wheelies,t.max_front_wheelies),n.max_back_wheelies=ma.maxInt(e.max_back_wheelies,t.max_back_wheelies),n.max_combos=ma.maxInt(e.max_combos,t.max_combos),n.max_level_score=ma.maxInt(e.max_level_score,t.max_level_score),n.total_front_flips=ma.maxInt(e.total_front_flips,t.total_front_flips),n.total_back_flips=ma.maxInt(e.total_back_flips,t.total_back_flips),n.total_front_wheelies=ma.maxInt(e.total_front_wheelies,t.total_front_wheelies),n.total_back_wheelies=ma.maxInt(e.total_back_wheelies,t.total_back_wheelies),n.total_combos=ma.maxInt(e.total_combos,t.total_combos),n.total_perfect_landings=ma.maxInt(e.total_perfect_landings,t.total_perfect_landings),n.total_level_score=ma.maxInt(e.total_level_score,t.total_level_score),n},Hr.setTextScale=function(e,t){e.score_text.scale.x=t,e.score_text.scale.y=t,e.name_text.scale.x=t,e.name_text.scale.y=t},Hr.pushStunt=function(e,t,n,i){var r=!1;0<e.que.length&&t==e.que[e.que.length-1].id&&(r=!0);var a=null;r?a=e.que[e.que.length-1]:((a=new qr).id=t,a.name=Hr.getStuntNameByID(t),e.que.push(a)),a.current_min_display_time=Xr.score_name_min_display_time,a.points=n,0<a.points?a.text=a.points+"X "+a.name:a.text=a.name},Hr.getStuntNameByID=function(e){return e==Xr.stunt_front_wheelie?"Front Wheelie":e==Xr.stunt_back_wheelie?"Back Wheelie":e==Xr.stunt_front_flip?"Front Flip":e==Xr.stunt_back_flip?"Back Flip":e==Xr.stunt_wheelie_to_flip_combo?"Wheelie To Flip Combo":e==Xr.stunt_flip_to_wheelie_combo?"Flip To Wheelie Combo":e==Xr.stunt_wheelie_combo?"Wheelie Combo":e==Xr.stunt_flip_combo?"Flip Combo":e==Xr.stunt_perfect_landing?"Perfect Landing":(Nl.trace("warning: id "+e+" does not have equivalent name",{fileName:"StuntDo.hx",lineNumber:145,className:"bikas.game.StuntDo",methodName:"getStuntNameByID"}),"")},Hr.destroy=function(e){e.name_text.destroy(!0),e.score_text.destroy(!0),null!=e.score_container&&(e.score_background.destroy(!0),e.score_foreground.destroy(!0),e.score_percent_text.destroy(!0),e.score_container.destroy(!0)),e.que=null,e.stats=null},Hr.update=function(e,t,n,i,r,a,s,l,o,_,p,u){var h=i.level_seconds,c=i.step_size,d=r.stats;if(0<o){!r.score_container.visible&&r.score_container_visible&&(r.score_container.visible=!0),r.score_container.x=e-(Xr.bar_offset+Xr.bar_offset_per_digit*p),r.score_container.y=n-r.score_background.texture.height/2;var m=ma.clamp((d.total_level_score+r.current_score)/o,0,1),f="Stunts: "+(d.total_level_score+r.current_score)+"/"+o;r.score_percent_text.text!=f&&(r.score_percent_text.text=f,r.score_foreground.scale.x=va.linear(0,r.score_background.scale.x,m))}else r.score_container.visible&&(r.score_container.visible=!1);var g=ma.normalizeAngle(a.main_body.get_rotation()),v=g-r.previous_angle;v>Math.PI?v-=Qr.PI2:v<-Math.PI&&(v+=Qr.PI2),r.accumulated_angle+=v,r.previous_angle=g;var b=r.previous_stunt_time_stamp+Xr.combo_expiration_time;if(i.level_seconds>=b-Xr.phase_out_time?r.phase_out=!0:r.phase_out=!1,b<h&&0!=r.current_score&&(d.total_level_score+=r.current_score,d.total_combos+=r.combos,r.current_score=0,r.combos=0,r.last_back_wheelies=0,r.last_front_wheelies=0,r.previous_stunt_flag=-1,r.accumulated_back_wheel_time=0,r.accumulated_front_wheel_time=0,r.accumulated_front_wheelies=0,r.accumulated_back_wheelies=0,r.current_interpolate_time=0,r.current_interpolate_scale=1,r.que=[],r.previous_stunt_object_for_sounds=null),!_){var y=!1,x=!1;if(a.main_body.get_velocity().get_length()>s.drive_velocity_max*Xr.min_speed_coeff&&(l.updates_since_back_wheel_collided<6&&(y=!0),l.updates_since_front_wheel_collided<6&&(x=!0)),l.updates_since_anything_collided<6&&(0<r.air_time&&(r.last_air_time=r.air_time),r.air_time=0),l.updates_since_anything_collided,0<l.updates_since_anything_collided&&(a.back_wheel_body.get_isSleeping()||(r.last_air_time=0,r.air_time+=c)),l.updates_since_back_wheel_collided<6?r.back_wheel_collide_time+=c:r.back_wheel_collide_time=0,l.updates_since_front_wheel_collided<6?r.front_wheel_collide_time+=c:r.front_wheel_collide_time=0,r.last_air_time>=Xr.perfect_landing_time&&0<r.back_wheel_collide_time&&0<r.front_wheel_collide_time&&(r.back_wheel_collide_time<=Xr.perfect_landing_wheel_time&&r.front_wheel_collide_time<=Xr.perfect_landing_wheel_time&&(r.last_air_time=0,d.total_perfect_landings++,r.previous_stunt_time_stamp=h,Hr.pushStunt(r,Xr.stunt_perfect_landing,0,c),r.current_score+=Xr.points_perfect_landing),r.back_wheel_collide_time>Xr.perfect_landing_wheel_time&&(r.last_air_time=0),r.front_wheel_collide_time>Xr.perfect_landing_wheel_time&&(r.last_air_time=0)),l.updates_since_anything_collided<6){if(r.accumulated_angle=0,r.flip_combo_can_happen=!1,r.front_flips=0,(r.back_flips=0)<r.air_time&&(r.last_air_time=r.air_time,r.air_time=0),x&&!y){if(r.accumulated_front_wheel_time+=c,r.accumulated_front_wheel_time>=Xr.wheelie_start_min_time){r.accumulated_back_wheel_time=0,r.last_back_wheelies=0,r.previous_stunt_flag==Xr.stunt_back_wheelie?(Hr.pushStunt(r,Xr.stunt_wheelie_combo,0,c),r.current_score+=Xr.points_wheelie_combo,r.combos++):r.previous_stunt_flag!=Xr.stunt_front_flip&&r.previous_stunt_flag!=Xr.stunt_back_flip||(Hr.pushStunt(r,Xr.stunt_flip_to_wheelie_combo,0,c),r.current_score+=Xr.points_flip_to_wheelie_combo,r.combos++),r.previous_stunt_flag=Xr.stunt_front_wheelie;var z=Math.floor((r.accumulated_front_wheel_time-Xr.wheelie_start_min_time)/Xr.wheelie_point_per_time_step);if(r.previous_stunt_time_stamp=h,z>r.last_front_wheelies){var w=z-r.last_front_wheelies;r.accumulated_front_wheelies+=w,d.total_front_wheelies+=w,r.current_score+=w*Xr.points_wheelie,Hr.pushStunt(r,Xr.stunt_front_wheelie,r.accumulated_front_wheelies,c),r.last_front_wheelies=z}}}else 0<r.que.length&&r.que[0].id,r.accumulated_front_wheelies=0,r.accumulated_front_wheel_time=0,r.last_front_wheelies=0;if(y&&!x){if(r.accumulated_back_wheel_time+=c,r.accumulated_back_wheel_time>=Xr.wheelie_start_min_time){r.accumulated_front_wheel_time=0,r.last_front_wheelies=0,r.previous_stunt_flag==Xr.stunt_front_wheelie?(r.current_score+=Xr.points_wheelie_combo,r.combos++,Hr.pushStunt(r,Xr.stunt_wheelie_combo,0,c)):r.previous_stunt_flag!=Xr.stunt_front_flip&&r.previous_stunt_flag!=Xr.stunt_back_flip||(r.current_score+=Xr.points_flip_to_wheelie_combo,r.combos++,Hr.pushStunt(r,Xr.stunt_flip_to_wheelie_combo,0,c)),r.previous_stunt_flag=Xr.stunt_back_wheelie;var k=Math.floor((r.accumulated_back_wheel_time-Xr.wheelie_start_min_time)/Xr.wheelie_point_per_time_step);if(r.previous_stunt_time_stamp=h,k>r.last_back_wheelies){var S=k-r.last_back_wheelies;r.accumulated_back_wheelies+=S,d.total_back_wheelies+=S,r.current_score+=S*Xr.points_wheelie,Hr.pushStunt(r,Xr.stunt_back_wheelie,r.accumulated_back_wheelies,c),r.last_back_wheelies=k}}}else 0<r.que.length&&r.que[0].id,r.accumulated_back_wheelies=0,r.accumulated_back_wheel_time=0,r.last_back_wheelies=0}else r.accumulated_angle>2*Math.PI*3/4?(r.accumulated_back_wheel_time=0,r.accumulated_front_wheel_time=0,r.last_front_wheelies=0,r.last_back_wheelies=0,r.accumulated_angle=0,r.previous_stunt_flag==Xr.stunt_front_wheelie||r.previous_stunt_flag==Xr.stunt_back_wheelie?(r.current_score+=Xr.points_wheelie_to_flip_combo,r.combos++,Hr.pushStunt(r,Xr.stunt_wheelie_to_flip_combo,0,c)):r.flip_combo_can_happen&&r.previous_stunt_flag==Xr.stunt_back_flip&&(r.current_score+=Xr.points_flip_combo,r.combos++,Hr.pushStunt(r,Xr.stunt_flip_combo,0,c)),r.previous_stunt_flag=Xr.stunt_front_flip,r.front_flips++,d.total_front_flips++,r.previous_stunt_time_stamp=h,r.flip_combo_can_happen=!0,Hr.pushStunt(r,Xr.stunt_front_flip,r.front_flips,c),r.current_score+=Xr.points_flip):r.accumulated_angle<2*-Math.PI*3/4&&(r.accumulated_back_wheel_time=0,r.accumulated_front_wheel_time=0,r.last_front_wheelies=0,r.last_back_wheelies=0,r.accumulated_angle=0,r.previous_stunt_flag==Xr.stunt_front_wheelie||r.previous_stunt_flag==Xr.stunt_back_wheelie?(r.current_score+=Xr.points_wheelie_to_flip_combo,r.combos++,Hr.pushStunt(r,Xr.stunt_wheelie_to_flip_combo,0,c)):r.flip_combo_can_happen&&r.previous_stunt_flag==Xr.stunt_front_flip&&(r.current_score+=Xr.points_flip_combo,r.combos++,Hr.pushStunt(r,Xr.stunt_flip_combo,0,c)),r.previous_stunt_flag=Xr.stunt_back_flip,r.back_flips++,d.total_back_flips++,r.previous_stunt_time_stamp=h,r.flip_combo_can_happen=!0,Hr.pushStunt(r,Xr.stunt_back_flip,r.back_flips,c),r.current_score+=Xr.points_flip)}if(d.max_front_flips<r.front_flips&&(d.max_front_flips=r.front_flips),d.max_back_flips<r.back_flips&&(d.max_back_flips=r.back_flips),d.max_front_wheelies<r.accumulated_front_wheelies&&(d.max_front_wheelies=r.accumulated_front_wheelies),d.max_back_wheelies<r.accumulated_back_wheelies&&(d.max_back_wheelies=r.accumulated_back_wheelies),d.max_combos<r.combos&&(d.max_combos=r.combos),d.max_level_score<r.current_score&&(d.max_level_score=r.current_score),r.phase_out&&0<r.score_text.alpha){var C=1/(Xr.phase_out_time/c);r.score_text.alpha-=C,r.name_text.alpha-=C,r.score_text.alpha<0&&(r.score_text.alpha=0,r.name_text.alpha=0);var N=va.smoothStart(.5,1,r.score_text.alpha);Hr.setTextScale(r,N)}if(0<r.current_score){if(r.score_text.text!=r.current_score+""&&(r.score_text.text=r.current_score+"",Ms.playSound(Gs.sound_stunt_point,u,.6)),0<r.que.length){var P=r.que[0];null==r.previous_stunt_object_for_sounds?(r.previous_stunt_object_for_sounds=P,Ms.playSound(Gs.sound_stunt,u)):(P.id!=r.previous_stunt_object_for_sounds.id&&Ms.playSound(Gs.sound_stunt,u),r.previous_stunt_object_for_sounds=P),0<P.current_min_display_time&&(P.current_min_display_time-=c,P.current_min_display_time<=0&&(P.current_min_display_time=0)),2<=r.que.length&&0==P.current_min_display_time&&(r.current_interpolate_scale=1.2,r.current_interpolate_time_max=12*c,r.current_interpolate_time=r.current_interpolate_time_max,r.que.shift()),r.name_text.text!=P.text&&(r.name_text.text=P.text)}if(r.name_text.x=e/2,r.name_text.y=t/6-r.name_text.height/2-5,r.score_text.x=r.name_text.x,r.score_text.y=r.name_text.y+r.name_text.height+10,r.score_text.alpha<1){if(!r.phase_out){var M=1/(Xr.phase_out_time/c);r.score_text.alpha+=M,r.name_text.alpha+=M,1<r.score_text.alpha&&(r.score_text.alpha=1,r.name_text.alpha=1);var I=va.smoothToABCWithSmoothB(.5,1.2,1,.6,r.score_text.alpha);Hr.setTextScale(r,I)}}else if(1<r.current_interpolate_scale){var T=r.current_interpolate_time/r.current_interpolate_time_max,A=va.linearForwardAndBackward(1,r.current_interpolate_scale,T);r.current_interpolate_time-=c,r.current_interpolate_time<0&&(r.current_interpolate_time=0,r.current_interpolate_scale=1),Hr.setTextScale(r,A)}}};var Yr=function(){this.grip=0,this.swipe_steps=0,this.downed=null,this.total_angle_difference=0,this.car_angle_downed=0,this.finger_angle_downed=0,this.finger_angle=0,this.finger_last_angle=0};(n["bikas.game.Wheel"]=Yr).__name__=["bikas","game","Wheel"],Yr.prototype={sprite:null,min_distance:null,max_distance:null,finger_last_angle:null,finger_angle:null,finger_angle_downed:null,car_angle_downed:null,total_angle_difference:null,downed:null,swipe_steps:null,grip:null,__class__:Yr};var Jr=function(){};(n["bikas.game.WheelDo"]=Jr).__name__=["bikas","game","WheelDo"],Jr.create=function(e){var t=new Yr;return t.sprite=e,t.min_distance=Math.max(t.sprite.width,t.sprite.height)/2*.1,t.max_distance=Math.max(t.sprite.width,t.sprite.height)/2*1.2,t},Jr.getWheelX=function(e){return e.current_game_width-Gs.wheel.width*Yr.corner_distance_coeff},Jr.getWheelY=function(e){return e.current_game_height-Gs.wheel.height*Yr.corner_distance_coeff},Jr.update=function(e,t,n,i,r,a,s,l,o,_){var p=s.dc,u=Jr.getWheelX(t),h=Jr.getWheelY(t);if(e.sprite.x!=u&&(e.sprite.x=u),e.sprite.y!=h&&(e.sprite.y=h),!_&&o){if(null==e.downed)for(var c=0,d=a.pointer_objects;c<d.length;){var m=d[c];if(++c,m.state==Ja.DOWNED){var f=m.current.x-e.sprite.x,g=m.current.y-e.sprite.y,v=Math.sqrt(f*f+g*g);if(v<=e.max_distance&&v>=e.min_distance){e.downed=m;break}}}if(null!=e.downed&&e.downed.state==Ja.IS_UP&&(e.downed=null),Ii.isAnyPressed(l,rr.keys_left)?(e.downed=null,e.swipe_steps=0):Ii.isAnyPressed(l,rr.keys_right)&&(e.downed=null,e.swipe_steps=0),null!=e.downed){var b=e.downed.current.x-e.sprite.x,y=e.downed.current.y-e.sprite.y;if(e.finger_angle=Math.atan2(y,b),e.downed.state==Ja.DOWNED)e.grip=.1,e.finger_angle_downed=e.finger_angle,e.car_angle_downed=n.main_body.get_rotation();else if(e.downed.state==Ja.IS_DOWN){var x=ma.angleDifferenceRad(e.finger_angle,e.finger_last_angle);Math.abs(x)<Yr.grip_min_delta_angle?(e.grip-=Yr.grip_decrease*i.grip_decrease_coeff*s.dc,e.grip<0&&(e.grip=0)):(e.grip+=Yr.grip_increase*i.grip_increase_coeff*s.dc,1<e.grip&&(e.grip=1))}e.total_angle_difference=ma.angleDifferenceRad(e.finger_angle,e.finger_angle_downed),e.swipe_steps=2*Math.round(60*e.total_angle_difference/Qr.PI2),Yr.debug_swipe_steps=e.swipe_steps,e.finger_last_angle=e.finger_angle}else 0<e.swipe_steps?(e.swipe_steps-=s.dc,e.swipe_steps<0&&(e.swipe_steps=0),Mt.rotate(n,i,r,p)):e.swipe_steps<0&&(e.swipe_steps+=s.dc,0<e.swipe_steps&&(e.swipe_steps=0),Mt.rotate(n,i,r,-p)),e.grip=0;if(0<e.grip){var z=ma.normalizeAngle(e.car_angle_downed+e.total_angle_difference),w=ma.angleDifferenceRad(z,n.main_body.get_rotation()),k=ma.clamp(w/Yr.wheel_max_force_angle,-1,1),S=Math.atan(k*Yr.atan_smoothing_multiplier)/(Math.PI/2);Mt.rotate(n,i,r,S*e.grip*p);var C=va.linear(Yr.max_friction,1,Math.abs(k)),N=n.main_body;N.set_angularVel(N.get_angularVel()*Math.pow(C,p)),Yr.debug_grip=e.grip,Yr.debug_angle_difference=e.total_angle_difference,e.finger_angle_downed=va.angleShortestLinear(e.finger_angle_downed,e.finger_angle,1-e.grip),e.car_angle_downed=va.angleShortestLinear(e.car_angle_downed,n.main_body.get_rotation(),1-e.grip)}else e.finger_angle_downed=e.finger_angle,e.car_angle_downed=n.main_body.get_rotation();e.sprite.rotation=n.main_body.get_rotation()}};var Kr=function(){};(n["bikas.global.ColorFunc"]=Kr).__name__=["bikas","global","ColorFunc"],Kr.rgbToHex=function(e,t,n){return(e<<16)+(t<<8)+n},Kr.hexToARGB=function(e){var t=new oa;return t.blue=255&e,t.green=e>>8&255,t.red=e>>16&255,t.alpha=e>>24&255,t},Kr.intToColor=function(e){var t=new oa;return t.red=Math.round(e/65536),t.green=Math.round(e/256%256),t.blue=e%256,t};var Qr=function(){};(n["bikas.global.MathConstants"]=Qr).__name__=["bikas","global","MathConstants"];var $r=function(){};(n["bikas.global.GlobalFlags"]=$r).__name__=["bikas","global","GlobalFlags"];var ea=function(e,t){null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t};(n["bikas.global.Point"]=ea).__name__=["bikas","global","Point"],ea.createDefault=function(){if(0<ea.destroyed_point_list.length){var e=ea.destroyed_point_list.pop();return e.x=0,e.y=0,e}return new ea(0,0)},ea.create=function(e,t){if(null==t&&(t=0),null==e&&(e=0),0<ea.destroyed_point_list.length){var n=ea.destroyed_point_list.pop();return n.x=e,n.y=t,n}return new ea(e,t)},ea.destroy=function(e){$r.validate_reusable_objects&&-1!=ea.destroyed_point_list.indexOf(e)?Nl.trace("warning: object is already added to destroyed list",{fileName:"GlobalData.hx",lineNumber:68,className:"bikas.global.Point",methodName:"destroy"}):ea.destroyed_point_list.push(e)},ea.prototype={x:null,y:null,toString:function(){return"{x:"+Math.round(1e3*this.x)/1e3+",y:"+Math.round(1e3*this.y)/1e3+"}"},__class__:ea};var ta=function(e,t){this.time=e,this.point=t};(n["bikas.global.PointTime"]=ta).__name__=["bikas","global","PointTime"],ta.prototype={time:null,point:null,__class__:ta};var na=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.width=n,this.height=i};(n["bikas.global.Rectangle"]=na).__name__=["bikas","global","Rectangle"],na.prototype={x:null,y:null,width:null,height:null,toString:function(){return"{x:"+Math.round(1e3*this.x)/1e3+",y:"+Math.round(1e3*this.y)/1e3+",width:"+Math.round(1e3*this.width)/1e3+",height:"+Math.round(1e3*this.height)/1e3+"}"},__class__:na};var ia=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.min_x=e,this.min_y=t,this.max_x=n,this.max_y=i};(n["bikas.global.Bounds"]=ia).__name__=["bikas","global","Bounds"],ia.create=function(e,t,n,i){if(null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),0<ia.destroyed_bounds_list.length){var r=ia.destroyed_bounds_list.pop();return r.min_x=e,r.min_y=t,r.max_x=n,r.max_y=i,r}return new ia(e,t,n,i)},ia.destroy=function(e){$r.validate_reusable_objects&&-1!=ia.destroyed_bounds_list.indexOf(e)?Nl.trace("warning: object is already added to destroyed list",{fileName:"GlobalData.hx",lineNumber:153,className:"bikas.global.Bounds",methodName:"destroy"}):ia.destroyed_bounds_list.push(e)},ia.prototype={min_x:null,min_y:null,max_x:null,max_y:null,toString:function(){return"{min_x:"+Math.round(1e3*this.min_x)/1e3+",min_y:"+Math.round(1e3*this.min_y)/1e3+",max_x:"+Math.round(1e3*this.max_x)/1e3+",max_y:"+Math.round(1e3*this.max_y)/1e3+"}"},__class__:ia};var ra=function(e,t,n,i,r,a,s,l){null==l&&(l=0),null==s&&(s=0),null==a&&(a=0),null==r&&(r=0),null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.p1=new ea(e,t),this.p2=new ea(n,i),this.p3=new ea(r,a),this.p4=new ea(s,l)};(n["bikas.global.Quad"]=ra).__name__=["bikas","global","Quad"],ra.create=function(e,t,n,i,r,a,s,l){if(null==l&&(l=0),null==s&&(s=0),null==a&&(a=0),null==r&&(r=0),null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),0<ra.destroyed_quad_list.length){var o=ra.destroyed_quad_list.pop();return o.p1.x=e,o.p1.y=t,o.p2.x=n,o.p2.y=i,o.p3.x=r,o.p3.y=a,o.p4.x=s,o.p4.y=l,o}return new ra(e,t,n,i,r,a,s,l)},ra.destroy=function(e){$r.validate_reusable_objects&&-1!=ra.destroyed_quad_list.indexOf(e)?Nl.trace("warning: object is already added to destroyed list",{fileName:"GlobalData.hx",lineNumber:216,className:"bikas.global.Quad",methodName:"destroy"}):ra.destroyed_quad_list.push(e)},ra.prototype={p1:null,p2:null,p3:null,p4:null,__class__:ra};var aa=function(e,t){null==t&&(t=0),null==e&&(e=0),this.width=e,this.height=t};(n["bikas.global.Size"]=aa).__name__=["bikas","global","Size"],aa.prototype={width:null,height:null,toString:function(){return"{width:"+Math.round(1e3*this.width)/1e3+",height:"+Math.round(1e3*this.height)/1e3+"}"},__class__:aa};var sa=function(){this.rotation=0,this.scale_y=1,this.scale_x=1};(n["bikas.global.Transform"]=sa).__name__=["bikas","global","Transform"],sa.prototype={scale_x:null,scale_y:null,rotation:null,toString:function(){return"{scale_x:"+Math.round(1e3*this.scale_x)/1e3+",scale_y:"+Math.round(1e3*this.scale_y)/1e3+",rotation:"+Math.round(1e3*this.rotation)/1e3+"}"},__class__:sa};var la=function(e,t,n,i,r,a){null==a&&(a=0),null==r&&(r=0),null==i&&(i=1),null==n&&(n=0),null==t&&(t=0),null==e&&(e=1),this.a=e,this.b=t,this.c=n,this.d=i,this.tx=r,this.ty=a};(n["bikas.global.Matrix"]=la).__name__=["bikas","global","Matrix"],la.create=function(e,t,n,i,r,a){if(null==a&&(a=0),null==r&&(r=0),null==i&&(i=1),null==n&&(n=0),null==t&&(t=0),null==e&&(e=1),0<la.destroyed_matrix_list.length){var s=la.destroyed_matrix_list.pop();return s.a=e,s.b=t,s.c=n,s.d=i,s.tx=r,s.ty=a,s}return new la(e,t,n,i,r,a)},la.destroy=function(e){$r.validate_reusable_objects&&-1!=la.destroyed_matrix_list.indexOf(e)?Nl.trace("warning: object is already added to destroyed list",{fileName:"GlobalData.hx",lineNumber:289,className:"bikas.global.Matrix",methodName:"destroy"}):la.destroyed_matrix_list.push(e)},la.prototype={a:null,b:null,c:null,d:null,tx:null,ty:null,__class__:la};var oa=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.red=e,this.green=t,this.blue=n,this.alpha=i};(n["bikas.global.Color"]=oa).__name__=["bikas","global","Color"],oa.prototype={red:null,green:null,blue:null,alpha:null,__class__:oa};var _a=function(e,t,n,i,r,a,s,l){null==l&&(l=0),null==s&&(s=0),null==a&&(a=0),null==r&&(r=0),null==i&&(i=1),null==n&&(n=1),null==t&&(t=1),null==e&&(e=1),this.alpha_offset=0,this.blue_offset=0,this.green_offset=0,this.red_offset=0,this.alpha_multiplier=1,this.blue_multiplier=1,this.green_multiplier=1,this.red_multiplier=1,this.red_multiplier=e,this.green_multiplier=t,this.blue_multiplier=n,this.alpha_multiplier=i,this.red_offset=r,this.green_offset=a,this.blue_offset=s,this.alpha_offset=l};(n["bikas.global.ColorTransform"]=_a).__name__=["bikas","global","ColorTransform"],_a.prototype={red_multiplier:null,green_multiplier:null,blue_multiplier:null,alpha_multiplier:null,red_offset:null,green_offset:null,blue_offset:null,alpha_offset:null,__class__:_a};var pa=function(e,t){this.point=e,this.time=t};(n["bikas.global.Intersection"]=pa).__name__=["bikas","global","Intersection"],pa.prototype={point:null,time:null,__class__:pa};var ua=function(e,t){this.start=e,this.end=t};(n["bikas.global.Range"]=ua).__name__=["bikas","global","Range"],ua.prototype={start:null,end:null,__class__:ua};var ha=function(e,t){this.min=e,this.max=t};(n["bikas.global.MinMax"]=ha).__name__=["bikas","global","MinMax"],ha.prototype={min:null,max:null,__class__:ha};var ca=function(e,t,n){this.min=e,this.max=t,this.current=n};(n["bikas.global.MinMaxCurrent"]=ca).__name__=["bikas","global","MinMaxCurrent"],ca.prototype={min:null,max:null,current:null,__class__:ca};var da=function(){};(n["bikas.global.PolygonIntersection"]=da).__name__=["bikas","global","PolygonIntersection"],da.prototype={intersection:null,distance:null,index:null,__class__:da};var ma=function(){};(n["bikas.global.GlobalFunc"]=ma).__name__=["bikas","global","GlobalFunc"],ma.angleDifferenceRad=function(e,t){return Math.atan2(Math.sin(e-t),Math.cos(e-t))},ma.angleDifferenceDeg=function(e,t){var n=(e-t)*Math.PI/180;return Math.atan2(Math.sin(n),Math.cos(n))/Math.PI*180},ma.normalizeAngle=function(e){return(e=(e%Qr.PI2+Qr.PI2)%Qr.PI2)>Math.PI&&(e-=Qr.PI2),e},ma.findGreatestCommonDivisor=function(e,t){for(var n;0!=e;)e=t%(n=e),t=n;return t},ma.clamp=function(e,t,n){return e<t?t:n<e?n:e},ma.clampMin=function(e,t){return e<t?t:e},ma.clampMax=function(e,t){return t<e?t:e},ma.clamp0to1=function(e){return e<0?0:1<e?1:e},ma.clamp0toInfinityInt=function(e){return e<0?0:e},ma.clampInt=function(e,t,n){return e<t?t:n<e?n:e},ma.isValueBetween=function(e,t,n){return t<=e&&e<=n},ma.didValuePass=function(e,t,n){return e<=n&&n<=t||n<=e&&t<=n},ma.isInRange=function(e,t,n,i){return!(e<n&&t<n||i<e&&i<t)},ma.range=function(e,t,n){return(e-t)/(n-t)},ma.rangeCoeff=function(e,t,n){return(e-t)/(n-t)},ma.rangeCoeffClamped=function(e,t,n){return ma.clamp((e-t)/(n-t),0,1)},ma.distance=function(e,t,n,i){var r=n-e,a=i-t;return Math.sqrt(r*r+a*a)},ma.distanceBetweenPoints=function(e,t){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)},ma.dot=function(e,t,n,i){return e*n+t*i},ma.direction=function(e,t,n,i){var r=ma.distance(e,t,n,i);return ma.dot(e,t,n,i)/(r*r)},ma.rectanglesIntersect=function(e,t){return!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y)},ma.boundsIntersectOrContain=function(e,t){return!(e.min_x>t.max_x||e.min_y>t.max_y||e.max_x<t.min_x||e.max_y<t.min_y)},ma.boundsMiddleX=function(e){return(e.min_x+e.max_x)/2},ma.boundsMiddleY=function(e){return(e.min_y+e.max_y)/2},ma.getTotalRectangle=function(e){if(0==e.length)return null;for(var t=e[0].x,n=e[0].y,i=e[0].x+e[0].width,r=e[0].y+e[0].height,a=0;a<e.length;){var s=e[a];++a,s.x<t&&(t=s.x),s.y<n&&(n=s.y),s.x+s.width>i&&(i=s.x+s.width),s.y+s.height>r&&(r=s.y+s.height)}return new na(t,n,i-t,r-n)},ma.distanceFloat=function(e,t){return Math.abs(e-t)},ma.getInvertedPoint=function(e){return new ea(-e.x,-e.y)},ma.getTransformX=function(e,t,n,i,r){return e*n*Math.cos(r)-t*i*Math.sin(r)},ma.getTransformY=function(e,t,n,i,r){return e*n*Math.sin(r)+t*i*Math.cos(r)},ma.getInvertedTransform=function(e){var t=new sa;return t.scale_x=1/e.scale_x,t.scale_y=1/e.scale_y,t.rotation=-e.rotation,t},ma.isPointBetween=function(e,t,n){return!(n.x<e.x&&n.x<t.x||n.x>e.x&&n.x>t.x||n.y<e.y&&n.y<t.y||n.y>e.y&&n.y>t.y)},ma.isPointInLineRange=function(e,t,n){var i=t.x-e.x,r=t.y-e.y,a=(n.x-e.x)*i+(n.y-e.y)*r;return 0<=a&&a<=i*i+r*r},ma.distanceBetweenLineAndPoint=function(e,t,n){var i=n.x-e.x,r=n.y-e.y,a=t.x-e.x,s=t.y-e.y;return Math.abs(i*s-a*r)/Math.sqrt(a*a+s*s)},ma.distanceBetweenPointAndRectangle=function(e,t){var n=ma.clamp(e.x,t.x,t.x+t.width),i=ma.clamp(e.y,t.y,t.y+t.height);return ma.distance(e.x,e.y,n,i)},ma.distanceBetweenPointAndRectangleArea=function(e,t){if(ma.pointInRectangle(e,t))return 0;var n=ma.clamp(e.x,t.x,t.x+t.width),i=ma.clamp(e.y,t.y,t.y+t.height);return ma.distance(e.x,e.y,n,i)},ma.isRectangleAndCircleIntersect=function(e,t,n){return!!ma.pointInRectangle(t,e)||ma.distanceBetweenPointAndRectangle(t,e)<=n},ma.distanceBetweenPointAndBoundedArea=function(e,t,n,i,r){var a=ma.clamp(e.x,t,i),s=ma.clamp(e.y,n,r);return ma.distance(e.x,e.y,a,s)},ma.getPointPerpendicularToLine=function(e,t,n){var i=n.x-e.x,r=n.y-e.y,a=t.x-e.x,s=t.y-e.y,l=a*a+s*s;if(0==l)return Nl.trace("warning: (C * C + D * D) == 0",{fileName:"GlobalFunc.hx",lineNumber:384,className:"bikas.global.GlobalFunc",methodName:"getPointPerpendicularToLine"}),null;var o=(i*s-a*r)/l;return new ea(n.x-o*s,n.y+o*a)},ma.pointInRectangle=function(e,t){return!(e.x<t.x||e.y<t.y||e.x>t.x+t.width||e.y>t.y+t.height)},ma.positionInRect=function(e,t,n,i,r,a){return!(e<n||t<i||n+r<e||i+a<t)},ma.pointInBounds=function(e,t){return!(e.x<t.min_x||e.y<t.min_y||e.x>t.max_x||e.y>t.max_y)},ma.pointInBoundedArea=function(e,t,n,i,r){return!(e.x<t||e.y<n||e.x>i||e.y>r)},ma.rectangleInRectangle=function(e,t){return!(e.x<t.x||e.y<t.y||e.x+e.width>t.x+t.width||e.y+e.height>t.y+t.height)},ma.expandRectangle=function(e,t){return new na(e.x-t,e.y-t,e.width+2*t,e.height+2*t)},ma.getRectangleMiddle=function(e){return new ea(e.x+e.width/2,e.y+e.height/2)},ma.logX=function(e,t){return null==t&&(t=10),Math.round(Math.log(e)/Math.log(t))},ma.logFloat=function(e,t){return Math.log(e)/Math.log(t)},ma.near=function(e,t,n){return t-n<=e&&e<=t+n},ma.min=function(e,t){return e<t?e:t},ma.min4=function(e,t,n,i){var r=e;return t<r&&(r=t),n<r&&(r=n),i<r&&(r=i),r},ma.max3=function(e,t,n){var i=e;return i<t&&(i=t),i<n&&(i=n),i},ma.max4=function(e,t,n,i){var r=e;return r<t&&(r=t),r<n&&(r=n),r<i&&(r=i),r},ma.minInt=function(e,t){return e<t?e:t},ma.max=function(e,t){return t<e?e:t},ma.maxInt=function(e,t){return t<e?e:t},ma.rotatePoint=function(e,t,n){var i=Math.cos(n)*(t.x-e.x)-Math.sin(n)*(t.y-e.y)+e.x,r=Math.sin(n)*(t.x-e.x)+Math.cos(n)*(t.y-e.y)+e.y;return new ea(i,r)},ma.round=function(e,t){return null==t&&(t=.01),Math.round(e/t)*t},ma.snap=function(e,t){return 0<t?Math.round(Math.round(e/t)*t):e},ma.getAngleBetweenPoints=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},ma.interpolateSmoothOutIn=function(e,t,n){var i=.5*(1-Math.cos(n*Math.PI));return e*(1-i)+t*i},ma.interpolateSmoothIn=function(e,t,n){return(1-(n=Math.sin(n*Math.PI*.5)))*e+n*t},ma.interpolateSmoothOut=function(e,t,n){return(n=Math.cos(n*Math.PI*.5))*e+(1-n)*t},ma.interpolate=function(e,t,n){return e+(t-e)*n},ma.interpolateClamped=function(e,t,n){return e+(t-e)*ma.clamp(n,0,1)},ma.interpolateForwardAndBackward=function(e,t,n){return n<.5?ma.interpolate(e,t,2*n):ma.interpolate(t,e,2*n-1)},ma.findIndexOfNearestValue=function(e,t){for(var n=t[0],i=Math.abs(n-e),r=0,a=0,s=t.length;a<s;){var l=a++;n=t[l],Math.abs(n-e)<i&&(i=Math.abs(n-e),r=l)}return r},ma.sumFloatArray=function(e){for(var t=0,n=0;n<e.length;){var i=e[n];++n,t+=i}return t},ma.sumIntArray=function(e){for(var t=0,n=0;n<e.length;){var i=e[n];++n,t+=i}return t},ma.copyPoint=function(e){return new ea(e.x,e.y)},ma.copyRectangle=function(e){return new na(e.x,e.y,e.width,e.height)},ma.copyTransform=function(e){var t=new sa;return t.scale_x=e.scale_x,t.scale_y=e.scale_y,t.rotation=e.rotation,t},ma.copyBounds=function(e){return new ia(e.min_x,e.min_y,e.max_x,e.max_y)},ma.copySize=function(e){return new aa(e.width,e.height)},ma.copyPoints=function(e){for(var t=[],n=0;n<e.length;){var i=e[n];++n,t.push(ma.copyPoint(i))}return t},ma.spaceText=function(e,t){for(;e.length<t;)e+=" ";return e},ma.getRandomBetween=function(e,t){return e+Math.random()*(t-e)},ma.getSign=function(e){return 0<e?1:e<0?-1:0},ma.getRandomSign=function(){return.5<Math.random()?1:-1},ma.getRandomSignInt=function(){return.5<Math.random()?1:-1},ma.getRandomBetweenInt=function(e,t){return e+Math.floor(Math.random()*(t-e+1))},ma.getRandomPointInRectangle=function(e){return new ea(e.x+e.width*Math.random(),e.y+e.height*Math.random())},ma.getRandomArrayIndex=function(e){return 0==e.length?-1:ma.getRandomBetweenInt(0,e.length-1)},ma.getRandomArrayElement=function(e){return 0==e.length?null:e[ma.getRandomBetweenInt(0,e.length-1)]},ma.createRectangleFrom2Points=function(e,t){var n,i;return n=e.x<t.x?e.x:t.x,i=e.y<t.y?e.y:t.y,new na(n,i,Math.abs(e.x-t.x),Math.abs(e.y-t.y))},ma.createBoundsFrom2Points=function(e,t){return new ia(ma.min(e.x,t.x),ma.min(e.y,t.y),ma.max(e.x,t.x),ma.max(e.y,t.y))},ma.boundsToRectangle=function(e){var t=e.min_x,n=e.min_y,i=e.max_x-e.min_x,r=e.max_y-e.min_y;return new na(t,n,i,r)},ma.rectangleToBounds=function(e){return new ia(e.x,e.y,e.x+e.width,e.y+e.height)},ma.pointInPolygon=function(e,t){if(t.length<3)return!1;for(var n=e.x,i=e.y,r=t[t.length-1],a=!1,s=0;s<t.length;){var l=t[s];++s,(l.y<i&&r.y>=i||r.y<i&&l.y>=i)&&(l.x<=n||r.x<=n)&&l.x+(i-l.y)/(r.y-l.y)*(r.x-l.x)<n&&(a=!a),r=l}return a},ma.intersectPointX=function(e,t,n){return new ea(e.x+(n-e.y)/(t.y-e.y)*(t.x-e.x),n)},ma.intersectPointY=function(e,t,n){return new ea(n,e.y+(n-e.x)/(t.x-e.x)*(t.y-e.y))},ma.canInfiniteLinesIntersect=function(e,t,n,i){var r=e.x,a=e.y,s=t.x,l=t.y,o=n.x,_=n.y,p=i.x;return 0!=(i.y-_)*(s-r)-(p-o)*(l-a)},ma.getInfiniteLineIntersection=function(e,t,n,i){var r=e.x,a=e.y,s=t.x,l=t.y,o=n.x,_=n.y,p=i.x,u=i.y,h=(u-_)*(s-r)-(p-o)*(l-a);if(0==h)return null;var c=((p-o)*(a-_)-(u-_)*(r-o))/h;return new ea(r+c*(s-r),a+c*(l-a))},ma.getLineSegmentIntersection=function(e,t,n,i){var r=e.x,a=e.y,s=t.x,l=t.y,o=n.x,_=n.y,p=i.x,u=i.y,h=(u-_)*(s-r)-(p-o)*(l-a);if(0==h)return null;var c=((p-o)*(a-_)-(u-_)*(r-o))/h,d=((s-r)*(a-_)-(l-a)*(r-o))/h;return 0<=c&&c<=1&&0<=d&&d<=1?new ea(r+c*(s-r),a+c*(l-a)):null},ma.lineSegmentsIntersect=function(e,t,n,i){var r=e.x,a=e.y,s=t.x,l=t.y,o=n.x,_=n.y,p=i.x,u=i.y,h=(u-_)*(s-r)-(p-o)*(l-a);if(0==h)return!1;var c=((p-o)*(a-_)-(u-_)*(r-o))/h,d=((s-r)*(a-_)-(l-a)*(r-o))/h;return 0<=c&&c<=1&&0<=d&&d<=1},ma.pointsEqual=function(e,t){return e.x==t.x&&e.y==t.y},ma.sizesEqual=function(e,t){return e.width==t.width&&e.height==t.height},ma.boundsEqual=function(e,t){return e.min_x==t.min_x&&e.min_y==t.min_y&&e.max_x==t.max_x&&e.max_y==t.max_y},ma.rectanglesEqual=function(e,t){return e.x==t.x&&e.y==t.y&&e.width==t.width&&e.height==t.height},ma.sortByIncreasingValue=function(e,t){return t<e?1:e<t?-1:0},ma.gamma_lanczos=function(e){var t=Qr.GAMMA_LANCZOS_P;if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*ma.gamma_lanczos(1-e));--e;for(var n=t[0],i=e+7+.5,r=1,a=t.length;r<a;){var s=r++;n+=t[s]/(e+s)}return Math.sqrt(2*Math.PI)*Math.pow(i,e+.5)*Math.exp(-i)*n};(n["bikas.global.GlobalMacro"]=function(){}).__name__=["bikas","global","GlobalMacro"];var fa=function(){};(n["bikas.global.GlobalParse"]=fa).__name__=["bikas","global","GlobalParse"],fa.stringToFloatArray=function(e){if("["!=e.charAt(0)||"]"!=e.charAt(e.length-1))return Nl.trace("warning: invalid array",{fileName:"GlobalParse.hx",lineNumber:8,className:"bikas.global.GlobalParse",methodName:"stringToFloatArray"}),null;for(var t=s.substr(e,1,e.length-2).split(",").map(p.parseFloat),n=0,i=t.length;n<i;){var r=n++;isNaN(t[r])&&(t[r]=0)}return t},fa.stringToIntArray=function(e){if("["!=e.charAt(0)||"]"!=e.charAt(e.length-1))return Nl.trace("warning: invalid array",{fileName:"GlobalParse.hx",lineNumber:25,className:"bikas.global.GlobalParse",methodName:"stringToIntArray"}),null;for(var t=s.substr(e,1,e.length-2).split(",").map(p.parseInt),n=0,i=t.length;n<i;){var r=n++;null==t[r]&&(t[r]=0)}return t},fa.floatArrayToString=function(e){for(var t="[",n=0,i=e.length-1;n<i;)t+=e[n++]+",";return t+(e[e.length-1]+"]")},fa.intArrayToString=function(e){for(var t="[",n=0,i=e.length-1;n<i;)t+=e[n++]+",";return t+(e[e.length-1]+"]")};var ga=function(){};(n["bikas.global.GlobalProc"]=ga).__name__=["bikas","global","GlobalProc"],ga.applyTransform=function(e,t,n,i){var r=ma.getTransformX(e.x,e.y,i.scale_x,i.scale_y,.017453292519943*i.rotation),a=ma.getTransformY(e.x,e.y,i.scale_x,i.scale_y,.017453292519943*i.rotation);e.x=n.x+r,e.y=n.y+a,t.scale_x*=i.scale_x,t.scale_y*=i.scale_y,t.rotation+=i.rotation},ga.transformPoint=function(e,t){var n=ma.getTransformX(e.x,e.y,t.scale_x,t.scale_y,.017453292519943*t.rotation),i=ma.getTransformY(e.x,e.y,t.scale_x,t.scale_y,.017453292519943*t.rotation);e.x=n,e.y=i},ga.applySeveralTransformsToPoint=function(e,t,n){if(t.length!=n.length)Nl.trace("error: position and transform length mismatch",{fileName:"GlobalProc.hx",lineNumber:29,className:"bikas.global.GlobalProc",methodName:"applySeveralTransformsToPoint"});else for(var i=0,r=t.length;i<r;){var a=i++;ga.applyTransformToPoint(e,t[a],n[a])}},ga.applyTransformToPoint=function(e,t,n){var i=ma.getTransformX(e.x,e.y,n.scale_x,n.scale_y,.017453292519943*n.rotation),r=ma.getTransformY(e.x,e.y,n.scale_x,n.scale_y,.017453292519943*n.rotation);e.x=t.x+i,e.y=t.y+r},ga.expandRectangle=function(e,t){return e.x-=t,e.y-=t,e.width+=2*t,e.height+=2*t,e},ga.expandRectangleWidth=function(e,t){return e.x-=t,e.width+=2*t,e},ga.expandRectangleHeight=function(e,t){return e.y-=t,e.height+=2*t,e},ga.expandBounds=function(e,t){return e.min_x-=t,e.min_y-=t,e.max_x+=t,e.max_y+=t,e},ga.moveBounds=function(e,t,n){return e.min_x+=t,e.min_y+=n,e.max_x+=t,e.max_y+=n,e},ga.scaleRectangle=function(e,t){e.x*=t,e.y*=t,e.width*=t,e.height*=t},ga.setRectanglePosition=function(e,t){e.x=t.x,e.y=t.y},ga.setPoint=function(e,t){e.x=t.x,e.y=t.y},ga.combineBounds=function(e,t){e.min_x=ma.min(e.min_x,t.min_x),e.min_y=ma.min(e.min_y,t.min_y),e.max_x=ma.max(e.max_x,t.max_x),e.max_y=ma.max(e.max_y,t.max_y)},ga.setBounds=function(e,t){e.min_x=t.min_x,e.min_y=t.min_y,e.max_x=t.max_x,e.max_y=t.max_y},ga.roundBounds=function(e){e.min_x=Math.round(e.min_x),e.min_y=Math.round(e.min_y),e.max_x=Math.round(e.max_x),e.max_y=Math.round(e.max_y)},ga.setBoundsFromRotatedBounds=function(e,t,n,i,r,a){var s=Math.sin(a),l=Math.cos(a),o=t*l-n*s,_=t*s+n*l,p=i*l-n*s,u=i*s+n*l,h=i*l-r*s,c=i*s+r*l,d=t*l-r*s,m=t*s+r*l;return e.min_x=ma.min4(o,p,h,d),e.min_y=ma.min4(_,u,c,m),e.max_x=ma.max4(o,p,h,d),e.max_y=ma.max4(_,u,c,m),e},ga.setPointPerpendicularToLine=function(e,t,n,i){var r=n.x-e.x,a=n.y-e.y,s=t.x-e.x,l=t.y-e.y,o=s*s+l*l;if(0!=o){var _=(r*l-s*a)/o;i.x=n.x-_*l,i.y=n.y+_*s}else Nl.trace("warning: (C * C + D * D) == 0",{fileName:"GlobalProc.hx",lineNumber:157,className:"bikas.global.GlobalProc",methodName:"setPointPerpendicularToLine"})},ga.randomizeMinMaxCurrent=function(e){e.current=ma.getRandomBetween(e.min,e.max)},ga.roundFloatArray=function(e){for(var t=0,n=e.length;t<n;){var i=t++;e[i]=Math.round(e[i])}return e},ga.shuffleArray=function(e){for(var t=0,n=e.length;t<n;){var i=t++,r=ma.getRandomBetweenInt(0,e.length-1),a=e[i],s=e[r];e[i]=s,e[r]=a}return e};var va=function(){};(n["bikas.global.InterpolateFunc"]=va).__name__=["bikas","global","InterpolateFunc"],va.linear=function(e,t,n){return e+(t-e)*n},va.linearClamped=function(e,t,n){return e+(t-e)*va.clamp(n,0,1)},va.linearRounded=function(e,t,n){return Math.round(e+(t-e)*n)},va.linearForwardAndBackward=function(e,t,n){return n<.5?va.linear(e,t,2*n):va.linear(t,e,2*n-1)},va.linearToABC=function(e,t,n,i,r){return r<i?va.linear(e,t,r/i):va.linear(t,n,(r-i)/(1-i))},va.smoothStart=function(e,t,n){return(n=Math.cos(n*Math.PI*.5))*e+(1-n)*t},va.smoothEnd=function(e,t,n){return(1-(n=Math.sin(n*Math.PI*.5)))*e+n*t},va.smoothStartEnd=function(e,t,n){var i=.5*(1-Math.cos(n*Math.PI));return e*(1-i)+t*i},va.smoothForwardAndBackward=function(e,t,n){return n<.5?va.smoothStartEnd(e,t,2*n):va.smoothStartEnd(t,e,2*n-1)},va.smoothToABCWithSmoothB=function(e,t,n,i,r){return r<i?va.smoothEnd(e,t,r/i):va.smoothStart(t,n,(r-i)/(1-i))},va.cubicStart=function(e,t,n){return(t-e)*n*n*n+e},va.cubicEnd=function(e,t,n){return(t-e)*(--n*n*n+1)+e},va.cubicStartEnd=function(e,t,n){return n<.5?va.cubicStart(e,(e+t)/2,2*n):va.cubicEnd((e+t)/2,t,2*n-1)},va.cubicForwardAndBackward=function(e,t,n){return n<.5?va.cubicStartEnd(e,t,2*n):va.cubicStartEnd(t,e,2*n-1)},va.cubicToABC=function(e,t,n,i,r){return r<i?va.cubicStartEnd(e,t,r/i):va.cubicStartEnd(t,n,(r-i)/(1-i))},va.expoStart=function(e,t,n){return(t-e)*Math.pow(2,10*(n-1))+e},va.expoEnd=function(e,t,n){return(t-e)*(1-Math.pow(2,-10*n))+e},va.expoStartEnd=function(e,t,n){return n<.5?va.expoStart(e,(e+t)/2,2*n):va.expoEnd((e+t)/2,t,2*n-1)},va.expoForwardAndBackward=function(e,t,n){return n<.5?va.expoStartEnd(e,t,2*n):va.expoStartEnd(t,e,2*n-1)},va.angleShortestLinear=function(e,t,n){return e+Math.atan2(Math.sin(t-e),Math.cos(t-e))*n},va.getT=function(e,t,n){return(n-e)/(t-e)},va.getTFromABC=function(e,t,n,i){return i<=t?.5*va.getT(e,t,i):.5*va.getT(t,n,i)+.5},va.getTClamped=function(e,t,n){var i=(n-e)/(t-e);return i<0?0:1<i?1:i},va.integrateSmoothEnd=function(e,t,n){null==n&&(n=60);for(var i=(t-e)/n,r=e+i/2,a=0,s=0,l=n;s<l;)s++,a+=Math.sin(.5*Math.PI*r)*i,r+=i;return a},va.integrateLinear=function(e,t,n){null==n&&(n=60);for(var i=(t-e)/n,r=e+i/2,a=0,s=0,l=n;s<l;)s++,a+=r*i,r+=i;return a},va.clamp=function(e,t,n){return e<t?t:n<e?n:e};var ba=function(){};(n["bikas.global.StringFunc"]=ba).__name__=["bikas","global","StringFunc"],ba.intToBinaryString=function(e,t){null==t&&(t=8);for(var n="",i=Math.abs(e);0<i;)n=i%2==0?"0"+n:"1"+n,i=p.int(i/2);if(n.length<t)for(var r=n.length,a=t;r<a;)r++,n="0"+n;return e<0&&(n="-"+n),n},ba.splitByLines=function(e){return h.replace(e,"\r\n","\n").split("\n")},ba.prependZerosToNumber=function(e,t){for(null==t&&(t=4);e.length<t;)e="0"+e;return e},ba.appendZerosToNumber=function(e,t){for(null==t&&(t=4);e.length<t;)e+="0";return e},ba.removeSpacesAtStartAndEnd=function(e){return h.trim(e)},ba.nameSort=function(e,t){return(e=e.toLowerCase())<(t=t.toLowerCase())?-1:t<e?1:0},ba.reverse=function(e){for(var t=new u,n=1-e.length;n<1;){var i=n++;t.addChar(s.cca(e,-i))}return t.toString()};var ya=function(){};(n["bikas.global.Vec3Func"]=ya).__name__=["bikas","global","Vec3Func"],ya.getProjection=function(e,t){return new ea(e.z*(t.x-e.x)/(e.z+t.z)+e.x,e.z*(t.y-e.y)/(e.z+t.z)+e.y)},ya.getProjectionWithCamera=function(e,t,n){return new ea(e.z*(n.x+t.x-e.x)/(e.z+(n.z+t.z))+e.x,e.z*(n.y+t.y-e.y)/(e.z+(n.z+t.z))+e.y)},ya.getPointZUsingY=function(e,t,n,i){return t.z*(i+n.y-t.y)/(e.y-t.y)-n.z-t.z},ya.getPointXUsingZ=function(e,t,n,i){return(e.x-t.x)*(t.z+i+n.z)/t.z+t.x-n.x},ya.getPointYUsingZ=function(e,t,n,i){return(e.y-t.y)*(t.z+i+n.z)/t.z+t.y-n.y},ya.copy=function(e){return new Gi(e.x,e.y,e.z)},ya.add=function(e,t){return new Gi(e.x+t.x,e.y+t.y,e.z+t.z)},ya.rotateX=function(e,t){var n=e.y*Math.cos(t)-e.z*Math.sin(t),i=e.y*Math.sin(t)+e.z*Math.cos(t),r=e.x;return new Gi(r,n,i)},ya.rotateY=function(e,t){var n=e.z*Math.cos(t)-e.x*Math.sin(t),i=e.z*Math.sin(t)+e.x*Math.cos(t),r=e.y;return new Gi(i,r,n)},ya.rotateZ=function(e,t){var n=e.x*Math.cos(t)-e.y*Math.sin(t),i=e.x*Math.sin(t)+e.y*Math.cos(t),r=e.z;return new Gi(n,i,r)};var xa=function(){};(n["bikas.global.Vec3Proc"]=xa).__name__=["bikas","global","Vec3Proc"],xa.set=function(e,t){return e.x=t.x,e.y=t.y,e.z=t.z,e},xa.setxyz=function(e,t,n,i){return e.x=t,e.y=n,e.z=i,e},xa.add=function(e,t){return e.x+=t.x,e.y+=t.y,e.z+=t.z,e},xa.applyProjection=function(e,t,n){return e.x=t.z*(n.x-t.x)/(t.z+n.z)+t.x,e.y=t.z*(n.y-t.y)/(t.z+n.z)+t.y,e},xa.applyProjectionWithCamera=function(e,t,n,i){return e.x=t.z*(i.x+n.x-t.x)/(t.z+(i.z+n.z))+t.x,e.y=t.z*(i.y+n.y-t.y)/(t.z+(i.z+n.z))+t.y,e},xa.rotateX=function(e,t){var n=e.y*Math.cos(t)-e.z*Math.sin(t),i=e.y*Math.sin(t)+e.z*Math.cos(t),r=e.x;return xa.setxyz(e,r,n,i),e},xa.rotateY=function(e,t){var n=e.z*Math.cos(t)-e.x*Math.sin(t),i=e.z*Math.sin(t)+e.x*Math.cos(t),r=e.y;return xa.setxyz(e,i,r,n),e},xa.rotateZ=function(e,t){var n=e.x*Math.cos(t)-e.y*Math.sin(t),i=e.x*Math.sin(t)+e.y*Math.cos(t),r=e.z;return xa.setxyz(e,n,i,r),e};var za=function(){};(n["bikas.global.VecFunc"]=za).__name__=["bikas","global","VecFunc"],za.add=function(e,t){return new ea(e.x+t.x,e.y+t.y)},za.addxy=function(e,t,n){return new ea(e.x+t,e.y+n)},za.add2=function(e,t,n){return new ea(e.x+t.x+n.x,e.y+t.y+n.y)},za.subtract=function(e,t){return new ea(e.x-t.x,e.y-t.y)},za.multiply=function(e,t){return new ea(e.x*t,e.y*t)},za.$length=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},za.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},za.normalize=function(e){var t=new ea,n=za.$length(e);return 0!=n&&(t.x=e.x/n,t.y=e.y/n),t},za.dot=function(e,t){return e.x*t.x+e.y*t.y},za.dotUsingLengthsAndAngle=function(e,t,n){return e*t*Math.cos(n)},za.angle=function(e){return Math.atan2(e.y,e.x)},za.direction=function(e){return Math.atan2(e.y,e.x)},za.rotation=function(e){return Math.atan2(e.y,e.x)},za.rotate=function(e,t){var n=Math.cos(t),i=Math.sin(t);return new ea(e.x*n-e.y*i,e.x*i+e.y*n)},za.scalarProjection=function(e,t){return za.dot(t,e)/za.$length(e)},za.vectorProjection=function(e,t){return za.multiply(e,za.dot(t,e)/(t.x*t.x+t.y*t.y))},za.cross=function(e,t){return e.x*t.y-e.y*t.x},za.interpolate=function(e,t,n){var i=e.x+(t.x-e.x)*n,r=e.y+(t.y-e.y)*n;return new ea(i,r)},za.middle=function(e,t){return za.interpolate(e,t,.5)},za.copy=function(e){return new ea(e.x,e.y)},za.isZero=function(e){return 0==e.x&&0==e.y};var wa=function(){};(n["bikas.global.VecProc"]=wa).__name__=["bikas","global","VecProc"],wa.set=function(e,t){return e.x=t.x,e.y=t.y,e},wa.setxy=function(e,t,n){return e.x=t,e.y=n,e},wa.add=function(e,t){return e.x+=t.x,e.y+=t.y,e},wa.addMultiplied=function(e,t,n){return e.x+=t.x*n,e.y+=t.y*n,e},wa.addxy=function(e,t,n){return e.x+=t,e.y+=n,e},wa.subtract=function(e,t){return e.x-=t.x,e.y-=t.y,e},wa.multiply=function(e,t){return e.x*=t,e.y*=t,e},wa.rotate=function(e,t){var n=Math.cos(t),i=Math.sin(t),r=n*e.x-i*e.y,a=i*e.x+n*e.y;return e.x=r,e.y=a,e},wa.normalize=function(e){var t=za.$length(e);if(0!=t){var n=e.x,i=e.y;e.x=n/t,e.y=i/t}return e};var ka=function(){};(n["bikas.google.GoogleAnalyticsWrapper"]=ka).__name__=["bikas","google","GoogleAnalyticsWrapper"],ka.init=function(e,t){},ka.trackPage=function(e){ka.exists&&pl.trackPageview("/"+e)},ka.trackEvent=function(e,t,n){ka.exists&&pl.trackEvent(e,t,n)},ka.trackLevelStart=function(e){ka.trackPage("level start: "+e)},ka.trackLevelFinish=function(e){ka.trackPage("level finished: "+e)},ka.trackLevelFailed=function(e){ka.trackPage("level failed "+e)},ka.trackGameFinish=function(){ka.trackPage("game finished")},ka.trackCreditsClicked=function(){ka.trackEvent("click","credits","")},ka.trackMoreGamesClicked=function(){ka.trackEvent("click","more games","")},ka.trackBikasNetClicked=function(){ka.trackEvent("click","bikas.net","")};var Sa=function(e,t,n,i){null==i&&(i=768),null==n&&(n=1382),null==t&&(t=768),null==e&&(e=1024),this.desktop=!1,this.windowsPhone=!1,this.windows=!1,this.macOS=!1,this.linux=!1,this.iOS=!1,this.chromeOS=!1,this.android=!1,this.kindle=!1,this.vita=!1,this.build_time=0,this.scale_listeners=[],this.scale_count=0,this.last_scale_date=null,this.fullscreened=!1,this.device_scale=1,this.window_scale=1,this.height_offset=0,this.game_position=new ea(0,0),this.force_size=null,this.min_game_width=e,this.min_game_height=t,this.max_game_width=n,this.max_game_height=i,this.original_max_game_width=n,this.original_max_game_height=i,this.current_game_width=e,this.current_game_height=t,this.canvas_game_width=e,this.canvas_game_height=t};(n["bikas.javascript.JsGameInfo"]=Sa).__name__=["bikas","javascript","JsGameInfo"],Sa.prototype={gamecanvas:null,pointer_container:null,loader:null,min_game_width:null,min_game_height:null,max_game_width:null,max_game_height:null,original_max_game_width:null,original_max_game_height:null,force_size:null,game_position:null,height_offset:null,window_scale:null,device_scale:null,fullscreened:null,current_game_width:null,current_game_height:null,canvas_game_width:null,canvas_game_height:null,last_scale_date:null,scale_count:null,scale_listeners:null,build_time:null,vita:null,kindle:null,android:null,chromeOS:null,iOS:null,linux:null,macOS:null,windows:null,windowsPhone:null,desktop:null,__class__:Sa};var Ca=function(){this.position=new ea(0,0)};(n["bikas.javascript.GameSize"]=Ca).__name__=["bikas","javascript","GameSize"],Ca.prototype={position:null,width:null,height:null,canvas_width:null,canvas_height:null,scale:null,__class__:Ca};var Na=n["bikas.javascript.CustomType"]={__ename__:["bikas","javascript","CustomType"],__constructs__:["FloatArray","IntArray"]};Na.FloatArray=["FloatArray",0],Na.FloatArray.toString=i,(Na.FloatArray.__enum__=Na).IntArray=["IntArray",1],Na.IntArray.toString=i,(Na.IntArray.__enum__=Na).__empty_constructs__=[Na.FloatArray,Na.IntArray];var Pa=function(){};(n["bikas.javascript.JsDebug"]=Pa).__name__=["bikas","javascript","JsDebug"],Pa.exportReflectStuff=function(){Nl.trace(_.field,{fileName:"JsDebug.hx",lineNumber:22,className:"bikas.javascript.JsDebug",methodName:"exportReflectStuff"}),Nl.trace(_.fields,{fileName:"JsDebug.hx",lineNumber:23,className:"bikas.javascript.JsDebug",methodName:"exportReflectStuff"}),Nl.trace(_.setProperty,{fileName:"JsDebug.hx",lineNumber:24,className:"bikas.javascript.JsDebug",methodName:"exportReflectStuff"}),Nl.trace(_.getProperty,{fileName:"JsDebug.hx",lineNumber:25,className:"bikas.javascript.JsDebug",methodName:"exportReflectStuff"}),Nl.trace(_.setField,{fileName:"JsDebug.hx",lineNumber:26,className:"bikas.javascript.JsDebug",methodName:"exportReflectStuff"})},Pa.addScrollBox=function(e,t,n){var i=lo.get_document().createElement("div");return i.style.overflow="scroll",i.style.width=t+"px",i.style.height=n+"px",e.appendChild(i),i},Pa.addButton=function(e,t,n){var i=lo.get_document().createElement("button");return i.textContent=t,e.appendChild(i),i.onclick=function(e){n()},i.onkeydown=function(e){32!=e.keyCode&&13!=e.keyCode||e.preventDefault()},i},Pa.addButtonCustom=function(e,t,n,i,r,a){var s=lo.get_document().createElement("button");return s.style.alignSelf="center",s.style.alignContent="center",s.style.textAlign="center",null!=r&&(s.style.width=r+"px"),null!=a&&(s.style.height=a+"px"),s.textContent=t,e.appendChild(s),null!=n&&(s.onmousedown=function(e){n(e)}),null!=i&&(s.onmouseup=function(e){i(e)}),s},Pa.addTextInputArea=function(e){var t=lo.get_document().createElement("textarea");return e.appendChild(t),e.onkeydown=function(e){if(13!=e.keyCode)return!0;e.preventDefault();var n=t.value.substring(0,t.selectionStart),i=t.value.substring(t.selectionStart,t.value.length);return t.value=n+"\n"+i,t.setSelectionRange(n.length+1,n.length+1),!1},t},Pa.addFieldWatch=function(e,t,n,i){null==i&&(i="");var r=lo.get_document(),a=_.field(t,n),s=r.createElement("ul"),l=r.createElement("li"),o=r.createElement("div"),p=lo.get_document().createTextNode("");o.className="textinnerbox",l.appendChild(o),o.appendChild(p);var u=null;return(new Pl(Math.round(250)).run=function(){if((a=_.field(t,n))!=u){var e=d.typeof(u=a);if(2==d.enumIndex(e)){var r=so.__cast(a,Mc);r=Math.round(1e3*r)/1e3,a=r}p.textContent=""!=i?i+" = "+a:n+" = "+a}})(),s.appendChild(l),e.appendChild(s),s},Pa.addText=function(e,t,n,i){null==i&&(i=!1),null==n&&(n=!1);var r=lo.get_document(),a=r.createTextNode(t),s=r.createElement("div");return s.style.margin="0",s.style.padding="0",n&&(s.style.textAlign="center"),i&&(s.style.fontWeight="bold"),s.appendChild(a),e.appendChild(s),s},Pa.addBoolEdit=function(e,t,n,i,r){null==i&&(i="");var a=lo.get_document(),s=_.field(t,n),l=a.createElement("ul"),o=a.createElement("li"),p=a.createElement("div"),u=lo.get_document().createTextNode("");p.className="textinnerbox",o.appendChild(p),p.appendChild(u),u.textContent=""!=i?i:n;var h=a.createElement("input");h.type="checkbox",h.checked=s,l.appendChild(o),l.appendChild(h),e.appendChild(l),h.onclick=function(e){var i=h.checked;_.setField(t,n,i),null!=r&&r(i)};return(new Pl(Math.round(250)).run=function(){h.checked!=_.field(t,n)&&(h.checked=_.field(t,n))})(),l},Pa.addEnumEdit=function(e,t,n,i,r,a){null==i&&(i="");var s=_.field(t,n);if(null==s)return Nl.trace("warning: can't edit null enum value",{fileName:"JsDebug.hx",lineNumber:234,className:"bikas.javascript.JsDebug",methodName:"addEnumEdit"}),null;""==i&&(i=n),Na.FloatArray;var l=d.getEnum(s),o=d.getEnumConstructs(l);return Pa.addItemSelect(e,s,o,i,r,function(e,i){var r=d.createEnum(l,so.__cast(i,String));_.setField(t,n,r),null!=a&&a(r)})},Pa.addItemSelect=function(e,t,n,i,r,a){var s=lo.get_document(),l=s.createElement("ul"),o=s.createElement("li"),_=s.createElement("div"),p=lo.get_document().createTextNode("");_.className="textinnerbox",o.appendChild(_),_.appendChild(p),p.textContent=i;var u=s.createElement("li"),h=s.createElement("select");h.className="selectelement",h.id="mySelect",h.value=t;for(var c=0,d=n.length;c<d;){var m=c++,f=s.createElement("option");f.value=n[m],f.text=n[m],h.appendChild(f)}if(h.value=t,u.appendChild(h),l.appendChild(o),l.appendChild(u),r){var g=s.createElement("li"),v=s.createElement("button");g.className="applyvalue",v.textContent="Apply",g.appendChild(v),l.appendChild(g),v.onclick=function(e){if(null!=a){var t=h.selectedIndex,n=h.selectedOptions.item(0).value;a(t,n)}}}else h.onchange=function(e){var t=h.selectedIndex,n=h.selectedOptions.item(0).value;a(t,n)};return e.appendChild(l),l},Pa.addFieldEdit=function(e,t,n,i,r,a){null==i&&(i="");var s=lo.get_document(),l=_.field(t,n),o=s.createElement("ul"),u=s.createElement("li"),h=s.createElement("div"),c=lo.get_document().createTextNode("");h.className="textinnerbox",u.appendChild(h),h.appendChild(c),c.textContent=""!=i?i:n;var m=s.createElement("li"),f=s.createElement("input");m.className="inputvalue",null!=r&&(r==Na.FloatArray?f.value=fa.floatArrayToString(l):r==Na.IntArray?f.value=fa.intArrayToString(l):Nl.trace("unsupported custom_type: "+p.string(r),{fileName:"JsDebug.hx",lineNumber:359,className:"bikas.javascript.JsDebug",methodName:"addFieldEdit"})),f.value=p.string(l),m.appendChild(f);var g=s.createElement("li"),v=s.createElement("button");g.className="applyvalue",v.textContent="Apply",g.appendChild(v),o.appendChild(u),o.appendChild(m),o.appendChild(g),e.appendChild(o);var b=d.typeof(l);return v.onclick=function(e){var i=f.value;if(null!=r)if(r==Na.FloatArray){var s=fa.stringToFloatArray(i);_.setField(t,n,s)}else if(r==Na.IntArray){var o=fa.stringToIntArray(i);_.setField(t,n,o)}else Nl.trace("unsupported custom_type: "+p.string(r),{fileName:"JsDebug.hx",lineNumber:388,className:"bikas.javascript.JsDebug",methodName:"addFieldEdit"});else switch(d.enumIndex(b)){case 1:case 2:var u=p.parseFloat(i);isNaN(u)?(f.value=p.string(l),Nl.trace("invalid value: "+u,{fileName:"JsDebug.hx",lineNumber:407,className:"bikas.javascript.JsDebug",methodName:"addFieldEdit"})):_.setField(t,n,u);break;case 3:"true"==i?_.setField(t,n,!0):"false"==i?_.setField(t,n,!1):(Nl.trace("invalid value: "+i,{fileName:"JsDebug.hx",lineNumber:399,className:"bikas.javascript.JsDebug",methodName:"addFieldEdit"}),f.value=p.string(l));break;case 7:b[2],Nl.trace("enum: not yet implemented",{fileName:"JsDebug.hx",lineNumber:413,className:"bikas.javascript.JsDebug",methodName:"addFieldEdit"});break;default:"string"==typeof l&&_.setField(t,n,i)}null!=a&&a()},o};var Ma=function(){};(n["bikas.javascript.JsDo"]=Ma).__name__=["bikas","javascript","JsDo"],Ma.getTimer=function(){return null!=lo.get_window().performance?Math.round(lo.get_window().performance.now()):(new Date).getTime()},Ma.delay=function(e,t){Pl.delay(t,Math.round(1e3*e))},Ma.getWellFormattedDate=function(e){var t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate(),r=e.getHours(),a=e.getMinutes(),s=e.getSeconds();return Ma.addZerosToNumber(t,4)+" "+Ma.addZerosToNumber(n,2)+" "+Ma.addZerosToNumber(i,2)+", "+Ma.addZerosToNumber(r,2)+":"+Ma.addZerosToNumber(a,2)+":"+Ma.addZerosToNumber(s,2)},Ma.getCurrentDateForFileSaving=function(e,t){null==t&&(t=", "),null==e&&(e=" ");var n=new Date,i=n.getFullYear(),r=n.getMonth()+1,a=n.getDate(),s=n.getHours(),l=n.getMinutes(),o=n.getSeconds();return Ma.addZerosToNumber(i,4)+e+Ma.addZerosToNumber(r,2)+e+Ma.addZerosToNumber(a,2)+t+Ma.addZerosToNumber(s,2)+e+Ma.addZerosToNumber(l,2)+e+Ma.addZerosToNumber(o,2)},Ma.addZerosToNumber=function(e,t){for(var n=e+"",i=n.length,r=t;i<r;)i++,n="0"+n;return n},Ma.copyTextToClipboard=function(e){var t=lo.get_document().createElement("textarea");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="2em",t.style.height="2em",t.style.padding="0",t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=e,lo.get_document().body.appendChild(t),t.select();try{lo.get_document().execCommand("copy")}catch(e){Nl.trace("unable to copy",{fileName:"JsDo.hx",lineNumber:86,className:"bikas.javascript.JsDo",methodName:"copyTextToClipboard"})}lo.get_document().body.removeChild(t)},Ma.copyPublicStaticVarsToClipboard=function(e,t,n){null==n&&(n=1);for(var i="",r="",a=0,s=n;a<s;)a++,r+="\t";for(var l=0,o=t.length;l<o;){var u=l++,h=t[u];i+=r+"public static var "+h+":Float = "+p.string(_.field(e,h))+";",u<t.length-1&&(i+="\n")}Ma.copyTextToClipboard(i)};var Ia=function(e,t){this.submitted=!1,this.name="",this.name=e,this.achievement_type=t};(n["bikas.lagged.LaggedAward"]=Ia).__name__=["bikas","lagged","LaggedAward"],Ia.prototype={name:null,achievement_type:null,submitted:null,__class__:Ia};var Ta=function(){};(n["bikas.lagged.LaggedWrapperDo"]=Ta).__name__=["bikas","lagged","LaggedWrapperDo"],Ta.init=function(){"undefined"==typeof LaggedAPI?Nl.trace("LaggedAPI is undefined",{fileName:"LaggedWrapperDo.hx",lineNumber:86,className:"bikas.lagged.LaggedWrapperDo",methodName:"init"}):(Nl.trace("lagged init",{fileName:"LaggedWrapperDo.hx",lineNumber:88,className:"bikas.lagged.LaggedWrapperDo",methodName:"init"}),LaggedAPI.init("adventure_drivers_init","lagdevaF3001"))},Ta.updateAllAwards=function(e){for(var t=[],n=0,i=Ta.all_awards;n<i.length;){var r=i[n];++n;for(var a=0,s=e.achievement_descs;a<s.length;){var l=s[a];if(++a,l.type==r.achievement_type&&-1!=e.game_save.achievements_completed.indexOf(l.id)){Ta.pushSubmit(t,r);break}}}0<t.length&&Ta.submitAwards(t)},Ta.pushSubmit=function(e,t){t.submitted||(t.submitted=!0,e.push(t.name))},Ta.submitAwards=function(e){Nl.trace("submit awards: "+p.string(e),{fileName:"LaggedWrapperDo.hx",lineNumber:122,className:"bikas.lagged.LaggedWrapperDo",methodName:"submitAwards"}),"undefined"==typeof LaggedAPI?Nl.trace("LaggedAPI undefined",{fileName:"LaggedWrapperDo.hx",lineNumber:125,className:"bikas.lagged.LaggedWrapperDo",methodName:"submitAwards"}):LaggedAPI.Achievements.save(e,function(e){e.success?Nl.trace("achievement saved",{fileName:"LaggedWrapperDo.hx",lineNumber:129,className:"bikas.lagged.LaggedWrapperDo",methodName:"submitAwards"}):Nl.trace(e.errormsg,{fileName:"LaggedWrapperDo.hx",lineNumber:131,className:"bikas.lagged.LaggedWrapperDo",methodName:"submitAwards"})})},Ta.showAd=function(e){"undefined"==typeof prerollStart?(Nl.trace("skip ad, prerollStart not found",{fileName:"LaggedWrapperDo.hx",lineNumber:140,className:"bikas.lagged.LaggedWrapperDo",methodName:"showAd"}),e()):(Nl.trace("show ad",{fileName:"LaggedWrapperDo.hx",lineNumber:143,className:"bikas.lagged.LaggedWrapperDo",methodName:"showAd"}),LaggedAPI.APIAds.show("interstitial","adventure-drivers","adventure-drivers-game.jpg",function(t){t.success?Nl.trace("ad done",{fileName:"LaggedWrapperDo.hx",lineNumber:146,className:"bikas.lagged.LaggedWrapperDo",methodName:"showAd"}):Nl.trace("ad error, continue",{fileName:"LaggedWrapperDo.hx",lineNumber:149,className:"bikas.lagged.LaggedWrapperDo",methodName:"showAd"}),e()}))};var Aa=function(){};(n["bikas.nape.NapeDo"]=Aa).__name__=["bikas","nape","NapeDo"],Aa.hasCollisionArbiterDynamicBody=function(e){if(null==e.get_space())return!1;if(e.get_isSleeping())return!1;for(var t=e.get_arbiters().iterator();t.hasNext();)if(t.next().isCollisionArbiter())return!0;return!1},Aa.getHighestImpulseFromCollisionArbitersOfDynamicBody=function(e){if(null==e.get_space())return 0;if(e.get_isSleeping())return 0;for(var t=0,n=e.get_arbiters().iterator();n.hasNext();){var i=n.next();if(i.isCollisionArbiter()){var r=i.totalImpulse().get_length();t<r&&(t=r)}}return t},Aa.getHighestImpulseFromCollisionArbitersOfStaticBody=function(e){if(null==e.get_space())return 0;for(var t=0,n=e.get_arbiters().iterator();n.hasNext();){var i=n.next();if(i.isCollisionArbiter()){var r=i.totalImpulse().get_length();t<r&&(t=r)}}return t},Aa.getHighestImpulseFromAllArbiters=function(e){if(null==e.get_space())return 0;if(e.get_isSleeping())return 0;for(var t=0,n=e.get_arbiters().iterator();n.hasNext();){var i=n.next().totalImpulse().get_length();t<i&&(t=i)}return t};var Da=function(e,t,n){this.name="",this.display_object=e,this.is_dynamic=t,this.name=n};(n["bikas.partitiontree.PartitionObjectDescription"]=Da).__name__=["bikas","partitiontree","PartitionObjectDescription"],Da.create=function(e,t,n){if(null==n&&(n=""),0<Da.destroyed_description_list.length){var i=Da.destroyed_description_list.pop();return i.display_object=e,i.is_dynamic=t,i.name=n,i}return new Da(e,t,n)},Da.destroy=function(e){e.display_object=null,$r.validate_reusable_objects&&-1!=Da.destroyed_description_list.indexOf(e)?Nl.trace("warning: object is already added to destroyed list",{fileName:"PartitionTreeData.hx",lineNumber:33,className:"bikas.partitiontree.PartitionObjectDescription",methodName:"destroy"}):Da.destroyed_description_list.push(e)},Da.prototype={display_object:null,is_dynamic:null,name:null,__class__:Da};var Ea=function(){this.in_trees=[],this.name=""};(n["bikas.partitiontree.PartitionObject"]=Ea).__name__=["bikas","partitiontree","PartitionObject"],Ea.prototype={name:null,in_trees:null,container:null,added:null,display_object:null,index:null,bounds:null,rect:null,is_dynamic:null,__class__:Ea};var Oa=function(){this.added=[],this.all=[]};(n["bikas.partitiontree.PartitionContainer"]=Oa).__name__=["bikas","partitiontree","PartitionContainer"],Oa.prototype={container:null,all:null,added:null,__class__:Oa};var Ba=function(){this.objects=null,this.sub_trees=null};(n["bikas.partitiontree.PartitionTree"]=Ba).__name__=["bikas","partitiontree","PartitionTree"],Ba.prototype={bounds:null,sub_trees:null,objects:null,__class__:Ba};var La=n["bikas.partitiontree.PartitionType"]={__ename__:["bikas","partitiontree","PartitionType"],__constructs__:["QuadTree","HorizontalBinaryTree"]};La.QuadTree=["QuadTree",0],La.QuadTree.toString=i,(La.QuadTree.__enum__=La).HorizontalBinaryTree=["HorizontalBinaryTree",1],La.HorizontalBinaryTree.toString=i,(La.HorizontalBinaryTree.__enum__=La).__empty_constructs__=[La.QuadTree,La.HorizontalBinaryTree];var ja=function(){this.added=[],this.dynamic_objects=[],this.all_objects=[],this.all_containers=null};(n["bikas.partitiontree.PartitionTop"]=ja).__name__=["bikas","partitiontree","PartitionTop"],ja.prototype={type:null,all_containers:null,all_objects:null,dynamic_objects:null,added:null,tree:null,__class__:ja};var Fa=function(){};(n["bikas.partitiontree.PartitionTreeDo"]=Fa).__name__=["bikas","partitiontree","PartitionTreeDo"],Fa.createPartitionContainer=function(e,t){var n=0,i=new Oa;i.container=e;for(var r=0;r<t.length;){var a=t[r];++r,i.all.push(Fa.createPartitionObject(i,n,a,null)),++n}return i},Fa.createPartitionObject=function(e,t,n,i){var r,a=n.display_object;null==i&&((i=a.getLocalBounds()).x*=a.scale.x,i.y*=a.scale.y,i.width*=a.scale.x,i.height*=a.scale.y),0<Fa.destroyed_partition_objects.length?r=Fa.destroyed_partition_objects.pop():((r=new Ea).rect=new na,r.bounds=new ia),r.name=n.name,r.in_trees=[],r.container=e,r.added=!1,r.display_object=a,r.index=t,r.is_dynamic=n.is_dynamic,r.rect.x=i.x,r.rect.y=i.y,r.rect.width=i.width,r.rect.height=i.height;var s=r.rect;if(n.is_dynamic){var l=ma.max(Math.abs(s.x),Math.abs(s.width)),o=ma.max(Math.abs(s.y),Math.abs(s.height)),_=Math.sqrt(l*l+o*o);s.x=-_,s.y=-_,s.width=2*_,s.height=2*_,r.bounds.min_x=a.x+s.x,r.bounds.min_y=a.y+s.y,r.bounds.max_x=r.bounds.min_x+s.width,r.bounds.max_y=r.bounds.min_y+s.height}else ga.setBoundsFromRotatedBounds(r.bounds,s.x,s.y,s.x+s.width,s.y+s.height,a.rotation),ga.moveBounds(r.bounds,a.x,a.y);return null!=a.parent&&Nl.trace("warning: object is already added somewhere, width:"+a.width+",height:"+a.height,{fileName:"PartitionTreeDo.hx",lineNumber:119,className:"bikas.partitiontree.PartitionTreeDo",methodName:"createPartitionObject"}),r},Fa.insertNewObjectToLiveTree=function(e,t,n,i,r,a){null==a&&(a=-1);var s=Da.create(n,i),l=Fa.createPartitionObject(t,a,s,r);Da.destroy(s),s=null;var o=!1;if(0<=a)for(var _=0,p=0,u=t.all;p<u.length;){var h=u[p];if(++p,a==h.index){t.all.splice(_,0,l),o=!0;for(var c=_+1,d=t.all.length;c<d;){var m=c++;t.all[m].index++}break}++_}return o||(l.index=t.all[t.all.length-1].index+1,t.all.push(l)),-1==e.all_objects.indexOf(l)&&e.all_objects.push(l),i&&e.dynamic_objects.push(l),Fa.addObjectToTree(e.tree,l),l},Fa.destroyLiveObject=function(e,t,n){for(var i=0,r=t.in_trees;i<r.length;){var a=r[i];++i,s.remove(a.objects,t)}-1!=e.added.indexOf(t)&&s.remove(e.added,t),t.is_dynamic&&-1!=e.dynamic_objects.indexOf(t)&&s.remove(e.dynamic_objects,t),-1!=e.all_objects.indexOf(t)&&s.remove(e.all_objects,t),s.remove(t.container.all,t),-1!=t.container.added.indexOf(t)&&s.remove(t.container.added,t),n&&t.display_object.destroy(!0),Fa.destroyPartitionObject(t)},Fa.createPartition=function(e,t,n,i,r){null==r&&(r=0),null==i&&(i=0),null==n&&(n=512);var a=new ja;a.type=t,a.all_containers=e;for(var s=new ia,l=0;l<e.length;){var o=e[l];++l;for(var _=0,u=o.all;_<u.length;){var h=u[_];++_;var c=h.bounds;c.min_x<s.min_x&&(s.min_x=c.min_x),c.min_y<s.min_y&&(s.min_y=c.min_y),c.max_x>s.max_x&&(s.max_x=c.max_x),c.max_y>s.max_y&&(s.max_y=c.max_y),h.is_dynamic&&a.dynamic_objects.push(h),a.all_objects.push(h)}}s.min_x-=i,s.max_x+=i,s.min_y-=r,s.max_y+=r,s.min_x==s.max_x&&(Nl.trace("warning: total_bounds.min_x == total_bounds.max_x == "+s.min_x,{fileName:"PartitionTreeDo.hx",lineNumber:267,className:"bikas.partitiontree.PartitionTreeDo",methodName:"createPartition"}),s.min_x-=10),s.min_y==s.max_y&&(s.min_y-=10,Nl.trace("warning: total_bounds.min_y == total_bounds.max_y == "+s.min_y,{fileName:"PartitionTreeDo.hx",lineNumber:272,className:"bikas.partitiontree.PartitionTreeDo",methodName:"createPartition"}));var d=s.max_x-s.min_x,m=Math.ceil(ma.logFloat(d/n,2));if(!isFinite(s.max_x)||!isFinite(s.max_y))return Nl.trace("warning: bounds are "+p.string(s),{fileName:"PartitionTreeDo.hx",lineNumber:280,className:"bikas.partitiontree.PartitionTreeDo",methodName:"createPartition"}),null;a.type==La.QuadTree?a.tree=Fa.createQuadTree(n,m,s.min_x,s.min_y):a.type==La.HorizontalBinaryTree?a.tree=Fa.createHorizontalBinaryTree(n,m,s.min_x,s.min_y,s.max_y):Nl.trace("warning: unhandled type "+p.string(a.type),{fileName:"PartitionTreeDo.hx",lineNumber:291,className:"bikas.partitiontree.PartitionTreeDo",methodName:"createPartition"});for(var f=0;f<e.length;){var g=e[f];++f;for(var v=0,b=g.all;v<b.length;){var y=b[v];++v,Fa.addObjectToTree(a.tree,y)}}var x=0,z=0,w=0,k=1/0,S=0,C=null;return(C=function(e){if(w+=1,null!=e.sub_trees)for(var t=0,n=e.sub_trees;t<n.length;){var i=n[t];++t,C(i)}else{var r=e.objects.length;r<k&&(k=r),S<r&&(S=r),x+=r,z+=1}})(a.tree),Nl.trace("trees:"+w+", objects(can be duplicate):"+x+" (min:"+k+",max:"+S+",avg:"+Math.round(x/z)+")",{fileName:"PartitionTreeDo.hx",lineNumber:333,className:"bikas.partitiontree.PartitionTreeDo",methodName:"createPartition"}),a},Fa.destroyPartitionObject=function(e){null!=e.display_object.parent&&e.display_object.parent.removeChild(e.display_object),e.in_trees=null,e.container=null,e.display_object=null,e.added=!1,Fa.destroyed_partition_objects.push(e)},Fa.destroy=function(e){for(var t=0,n=e.all_objects;t<n.length;){var i=n[t];++t,Fa.destroyPartitionObject(i)}Fa.destroyTree(e.tree);for(var r=0,a=e.all_containers;r<a.length;){var s=a[r];++r,s.container=null,s.added=null,s.all=null}e.all_containers=null,e.all_objects=null,e.dynamic_objects=null,e.added=null,e.tree=null},Fa.destroyTree=function(e){if(null!=e.sub_trees)for(var t=0,n=e.sub_trees;t<n.length;){var i=n[t];++t,Fa.destroyTree(i)}e.bounds=null,e.objects=null,e.sub_trees=null},Fa.createQuadTree=function(e,t,n,i){var r=new Ba,a=e*Math.pow(2,t);r.bounds=new ia(n,i,n+a,i+a);for(var s=0,l=5-t;s<l;)s++;var o=t-1,_=e*Math.pow(2,o);return 0<=o?(r.sub_trees=[],r.sub_trees.push(Fa.createQuadTree(e,o,n,i)),r.sub_trees.push(Fa.createQuadTree(e,o,n+_,i)),r.sub_trees.push(Fa.createQuadTree(e,o,n,i+_)),r.sub_trees.push(Fa.createQuadTree(e,o,n+_,i+_))):r.objects=[],r},Fa.createHorizontalBinaryTree=function(e,t,n,i,r){var a=new Ba,s=e*Math.pow(2,t);a.bounds=new ia(n,i,n+s,r);for(var l=0,o=5-t;l<o;)l++;var _=t-1,p=e*Math.pow(2,_);return 0<=_?(a.sub_trees=[],a.sub_trees.push(Fa.createHorizontalBinaryTree(e,_,n,i,r)),a.sub_trees.push(Fa.createHorizontalBinaryTree(e,_,n+p,i,r))):a.objects=[],a},Fa.addObjectToTree=function(e,t){if(Fa.boundsIntersectOrContain(t.bounds,e.bounds))if(ja.debug_dynamic_checks++,null!=e.sub_trees)for(var n=0,i=e.sub_trees;n<i.length;){var r=i[n];++n,Fa.addObjectToTree(r,t)}else-1==t.in_trees.indexOf(e)&&(e.objects.push(t),t.in_trees.push(e))},Fa.boundsIntersectOrContain=function(e,t){return!(e.min_x>t.max_x||e.max_x<t.min_x||e.min_y>t.max_y||e.max_y<t.min_y)},Fa.update=function(e,t){var n=0;ja.debug_on&&(n=Ma.getTimer());for(var i=e.tree,r=ja.debug_dynamic_checks=0,a=e.dynamic_objects;r<a.length;){var l=a[r];++r,ja.debug_dynamic_checks++;var o=l.rect,_=l.display_object.x+o.x,p=l.display_object.y+o.y,u=_+o.width,h=p+o.height,c=l.bounds;if(c.min_x!=_||c.min_y!=p||c.max_x!=u||c.max_y!=h){c.min_x=_,c.min_y=p,c.max_x=u,c.max_y=h;for(var d=0;d<l.in_trees.length;){var m=l.in_trees[d];Fa.boundsIntersectOrContain(l.bounds,m.bounds)||(ja.debug_dynamic_checks++,s.remove(m.objects,l),s.remove(l.in_trees,m),--d),++d}Fa.addObjectToTree(i,l)}}for(var f=0,g=e.added.length;f<g;){var v=e.added[f];Fa.boundsIntersectOrContain(v.bounds,t)||(s.remove(v.container.added,v),v.container.container.remove(v.display_object),s.remove(e.added,v),v.added=!1,--f,--g),++f}ja.debug_add_checks=0,ja.debug_index_checks=0,Fa.updateTree(e,i,t),ja.debug_total_objects=e.added.length,ja.debug_on&&(ja.debug_tree_update_ms=Ma.getTimer()-n)},Fa.updateTree=function(e,t,n){if(Fa.boundsIntersectOrContain(t.bounds,n))if(ja.debug_add_checks++,null!=t.sub_trees)for(var i=0,r=t.sub_trees;i<r.length;){var a=r[i];++i,Fa.updateTree(e,a,n)}else for(var s=0,l=t.objects;s<l.length;){var o=l[s];if(++s,ja.debug_add_checks++,!(o.bounds.min_x>n.max_x||o.bounds.max_x<n.min_x||o.bounds.min_y>n.max_y||o.bounds.max_y<n.min_y||o.added)){for(var _=o.container,p=o.container.container.children.length,u=_.added.length,h=0,c=_.added;h<c.length;){var d=c[h];if(++h,ja.debug_index_checks++,o.index<d.index){-1==_.container.children.indexOf(d.display_object)?Nl.trace("warning: added.display_object is not added to container, but should be",{fileName:"PartitionTreeDo.hx",lineNumber:592,className:"bikas.partitiontree.PartitionTreeDo",methodName:"updateTree"}):(p=_.container.getChildIndex(d.display_object),u=_.added.indexOf(d));break}}_.container.addAt(o.display_object,p),_.added.splice(u,0,o),e.added.push(o),o.added=!0}}};var Ra=n["bikas.phaser.PolygonTextureType"]={__ename__:["bikas","phaser","PolygonTextureType"],__constructs__:["Tiles","SingleTile","PatternFill"]};Ra.Tiles=["Tiles",0],Ra.Tiles.toString=i,(Ra.Tiles.__enum__=Ra).SingleTile=["SingleTile",1],Ra.SingleTile.toString=i,(Ra.SingleTile.__enum__=Ra).PatternFill=["PatternFill",2],Ra.PatternFill.toString=i,(Ra.PatternFill.__enum__=Ra).__empty_constructs__=[Ra.Tiles,Ra.SingleTile,Ra.PatternFill];var Ga=function(){this.sol=null,this.draw_area_bounds_cache=new ia,this.line_offset_y=0,this.line_max_placement_angle=2*Math.PI,this.real_time_graphics=null,this.line_group=null,this.line_texture=null,this.single_tile=null,this.tiles=null};(n["bikas.phaser.PolygonTextureData"]=Ga).__name__=["bikas","phaser","PolygonTextureData"],Ga.prototype={type:null,tiles:null,single_tile:null,single_tile_width:null,single_tile_height:null,line_texture:null,line_group:null,mask_graphics:null,real_time_graphics:null,is_background_ground:null,temp_sprite_for_pattern:null,pattern_hack:null,points:null,line_max_placement_angle:null,line_offset_y:null,polygon_bounds:null,draw_area_bounds_cache:null,sol:null,__class__:Ga};var Za=function(){this.graphics=[],this.bounds=[],this.sprites=[]};(n["bikas.phaser.SpritesOnLines"]=Za).__name__=["bikas","phaser","SpritesOnLines"],Za.prototype={sprites:null,bounds:null,graphics:null,__class__:Za};var Ua=function(){};(n["bikas.phaser.PolygonTextureDrawDo"]=Ua).__name__=["bikas","phaser","PolygonTextureDrawDo"],Ua.createPolygonTextureDataUsingTiles=function(e,t,n){var i=new Ga;i.type=Ra.Tiles,i.mask_graphics=n,i.points=e,i.tiles=t,i.tiles.mask=i.mask_graphics,i.polygon_bounds=ns.getPolygonBounds(e);var r=i.tiles.texture.width;n.x=e[0].x-e[0].x%r,n.y=e[0].y-e[0].y%r;var a=n.x,s=n.y;n.beginFill(5713423,1),n.moveTo(e[0].x-a,e[0].y-s);for(var l=0;l<e.length;){var o=e[l];++l,n.lineTo(o.x-a,o.y-s)}return n.endFill(),i.tiles.visible=!1,i},Ua.createPolygonTextureDataUsingSingleTile=function(e,t,n,i,r){var a=new Ga;a.type=Ra.SingleTile,a.mask_graphics=r,a.points=e,a.single_tile=t,a.single_tile.mask=a.mask_graphics,a.single_tile_width=n,a.single_tile_height=i,a.polygon_bounds=ns.getPolygonBounds(e);var s=512;null!=a.single_tile&&(s=a.single_tile.texture.width),r.x=e[0].x-e[0].x%s,r.y=e[0].y-e[0].y%s;var l=r.x,o=r.y;r.beginFill(5713423,1),r.moveTo(e[0].x-l,e[0].y-o);for(var _=0;_<e.length;){var p=e[_];++_,r.lineTo(p.x-l,p.y-o)}return r.endFill(),null!=a.single_tile&&(a.single_tile.visible=!1),a},Ua.createPolygonTextureDataUsingPatternFill=function(e,t,n,i){var r=new Ga;r.type=Ra.PatternFill,r.real_time_graphics=e,r.is_background_ground=i,r.points=t,r.polygon_bounds=ns.getPolygonBounds(t);var a=e;return r.pattern_hack=a.pattern_hack={},r.pattern_hack.points=[],r.pattern_hack.pattern=n,r},Ua.drawPolygonToCanvasContext=function(e,t,n,i){t.beginPath(),t.moveTo(e[0].x+n,e[0].y+i);for(var r=0;r<e.length;){var a=e[r];++r,t.lineTo(a.x+n,a.y+i)}t.closePath(),t.fill()},Ua.destroy=function(e){if(null!=e.sol)for(var t=0,n=e.sol.sprites;t<n.length;){var i=n[t];++t,e.line_group.remove(i),i.texture.destroy(!1),i.destroy(!0)}null!=e.line_group&&e.line_group.destroy(!0),null!=e.tiles&&(e.tiles.mask=null,e.tiles.destroy()),null!=e.single_tile&&(e.single_tile.mask=null,e.single_tile.destroy(!0)),null!=e.mask_graphics&&(e.mask_graphics.clear(),e.mask_graphics.destroy(!0)),null!=e.temp_sprite_for_pattern&&(null!=e.temp_sprite_for_pattern.parent&&e.temp_sprite_for_pattern.parent.removeChild(e.temp_sprite_for_pattern),e.temp_sprite_for_pattern.destroy(!0)),null!=e.real_time_graphics&&(null!=e.real_time_graphics.parent&&e.real_time_graphics.parent.removeChild(e.real_time_graphics),e.real_time_graphics.pattern_hack=null,e.real_time_graphics.destroy(!0),e.real_time_graphics=null),null!=e.pattern_hack&&(e.pattern_hack.points=null,e.pattern_hack.pattern=null,e.pattern_hack=null),e.sol=null,e.tiles=null,e.line_texture=null,e.points=null},Ua.resetBoundsCache=function(e){e.draw_area_bounds_cache.min_x=0,e.draw_area_bounds_cache.min_y=0,e.draw_area_bounds_cache.max_x=0,e.draw_area_bounds_cache.max_y=0},Ua.createAndPushSpritesOnSingleLine=function(e,t,n,i,r,a,s){null==s&&(s=0);for(var l=r.x-i.x,o=r.y-i.y,_=Math.round(Math.sqrt(l*l+o*o)),p=Math.atan2(o,l),u=p-Math.PI/2,h=0,c=0,d=n.width;h<_;){_<(c+=Math.round(n.width)-a)&&(c=_);var m=Math.cos(p)*h,f=Math.sin(p)*h;m+=Math.cos(u)*s,f+=Math.sin(u)*s;var g=new PIXI.Texture(t,new PIXI.Rectangle(n.x+a,n.y,c-h,n.height)),v=qa.createSprite(g,0,0,i.x+m,i.y+f);d=c-h+a,a=0,v.rotation=p,e.push(v),h=c}return d},Ua.createSpritesOnPolygon=function(e,t,n,i){null==i&&(i=0),null==n&&(n=1.047);for(var r=t.baseTexture,a=t.frame,s=0,l=[],o=0,_=e.length;o<_;){var p,u,h=o++;u=0==h?(p=e[e.length-1],e[0]):(p=e[h-1],e[h]),s=Math.abs(ma.getAngleBetweenPoints(p,u))<n?Ua.createAndPushSpritesOnSingleLine(l,r,a,p,u,s,i):0}return l},Ua.createSol=function(e){var t=Ua.createSpritesOnPolygon(e.points,e.line_texture,e.line_max_placement_angle,e.line_offset_y),n=new Za;n.sprites=t;for(var i=0,r=n.sprites;i<r.length;){var a=r[i];++i;var s=a.getLocalBounds(),l=new ia;ga.setBoundsFromRotatedBounds(l,s.x,s.y,s.x+s.width,s.y+s.height,a.rotation),ga.moveBounds(l,a.x,a.y),n.bounds.push(l),e.line_group.add(a)}return n},Ua.setVisibility=function(e,t){null!=e.tiles&&e.tiles.visible!=t&&(e.tiles.visible=t),null!=e.single_tile&&e.single_tile.visible!=t&&(e.single_tile.visible=t),null!=e.line_group&&e.line_group.visible!=t&&(e.line_group.visible=t)},Ua.draw=function(e,t,n,i){var r=ma.copyBounds(t);if(ga.roundBounds(r),!ma.boundsEqual(r,e.draw_area_bounds_cache)){var a=e.points;if(e.mask_graphics,ga.setBounds(e.draw_area_bounds_cache,r),!(a.length<3))if(ma.boundsIntersectOrContain(r,e.polygon_bounds)){var s;if(Ua.setVisibility(e,!0),e.type==Ra.PatternFill&&null!=e.pattern_hack.points)for(var l=e.pattern_hack.points,o=0;o<l.length;){var _=l[o];++o,ea.destroy(_)}if(i){var p=rs.clip(a,Math.round(r.min_y-1),Math.round(r.max_x+1),Math.round(r.max_y+1),Math.round(r.min_x-1));if(null==p)return void Ua.setVisibility(e,!1);s=[p]}else s=ts.cutPolygonByRectangle(a,r.min_x-1,r.max_x+1,r.min_y-1,r.max_y+1,1,0,3,2);e.type!=Ra.PatternFill?(null!=e.tiles&&(e.tiles.position.x=r.min_x,e.tiles.position.y=r.min_y,e.tiles.tilePosition.x=-r.min_x,e.tiles.tilePosition.y=-r.min_y),null!=e.single_tile&&(e.single_tile.position.x=r.min_x,e.single_tile.position.y=r.min_y,e.single_tile.width=1024,e.single_tile.height=1024)):e.pattern_hack.points=s}else Ua.setVisibility(e,!1)}};var Va=function(){};(n["bikas.pixi.GraphicsDo"]=Va).__name__=["bikas","pixi","GraphicsDo"],Va.drawRectangle=function(e,t,n,i,r,a,s,l){return null==l&&(l=1),null==s&&(s=16777215),null==a&&(a=!1),null==r&&(r=1),null==i&&(i=16711680),null==n&&(n=1),a&&e.beginFill(s),e.lineStyle(n,i,r),e.moveTo(t.x,t.y),e.lineTo(t.x+t.width,t.y),e.lineTo(t.x+t.width,t.y+t.height),e.lineTo(t.x,t.y+t.height),e.lineTo(t.x,t.y),a&&e.endFill(),e},Va.drawCircle=function(e,t,n,i,r,a,s,l){return null==l&&(l=1),null==s&&(s=16777215),null==a&&(a=!1),null==r&&(r=1),null==i&&(i=16711680),null==n&&(n=1),a&&e.beginFill(s),e.lineStyle(n,i,r),e.drawCircle(0,0,t),a&&e.endFill(),e},Va.drawBounds=function(e,t,n,i,r,a,s,l){return null==l&&(l=1),null==s&&(s=16777215),null==a&&(a=!1),null==r&&(r=1),null==i&&(i=16711680),null==n&&(n=1),a&&e.beginFill(s),e.lineStyle(n,i,r),e.moveTo(t.min_x,t.min_y),e.lineTo(t.max_x,t.min_y),e.lineTo(t.max_x,t.max_y),e.lineTo(t.min_x,t.max_y),e.lineTo(t.min_x,t.min_y),a&&e.endFill(),e},Va.drawMarker=function(e,t,n,i,r){null==r&&(r=10),null==i&&(i=16711680);var a=r/2;return e.lineStyle(1,i,1),e.moveTo(-a,-a),e.lineTo(a,a),e.moveTo(a,-a),e.lineTo(-a,a),e.position.set(t,n),e},Va.drawCross=function(e,t,n,i,r){null==r&&(r=1),null==i&&(i=1),null==n&&(n=0),null==t&&(t=10),e.lineStyle(i,n,r),e.moveTo(0,-t/2),e.lineTo(0,t/2),e.moveTo(-t/2,0),e.lineTo(t/2,0)};var qa=function(){};(n["bikas.pixi.PixiDo"]=qa).__name__=["bikas","pixi","PixiDo"],qa.pickSpriteFromPool=function(e,t,n,i,r){if(0<fs.destroyed_sprite_list.length){var a=fs.destroyed_sprite_list.pop();return null==e?a.texture=null:(a.texture,a.setTexture(e)),a.setTransform(i,r,1,1,0,0,0,0,0),a.mask=null,a.anchor.x=t,a.anchor.y=n,a.rotation=0,a.tint=16777215,a.renderable=!0,a.visible=!0,a.alpha=1,a}var s=new fs($s.game,i,r,e,0);return s.anchor.x=t,s.anchor.y=n,s},qa.createSpriteByName=function(e,t,n,i,r){null==r&&(r=0),null==i&&(i=0),null==n&&(n=0),null==t&&(t=0);var a=Hs.retrieveAsset(e);return null==a&&(Nl.trace("-------------------------",{fileName:"PixiDo.hx",lineNumber:115,className:"bikas.pixi.PixiDo",methodName:"createSpriteByName"}),Nl.trace("warning: texture == null ("+e+")",{fileName:"PixiDo.hx",lineNumber:116,className:"bikas.pixi.PixiDo",methodName:"createSpriteByName"}),Nl.trace("-------------------------",{fileName:"PixiDo.hx",lineNumber:117,className:"bikas.pixi.PixiDo",methodName:"createSpriteByName"})),qa.pickSpriteFromPool(a,t,n,i,r)},qa.createSprite=function(e,t,n,i,r){return null==r&&(r=0),null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(Nl.trace("-------------------------",{fileName:"PixiDo.hx",lineNumber:127,className:"bikas.pixi.PixiDo",methodName:"createSprite"}),Nl.trace("warning: texture == null",{fileName:"PixiDo.hx",lineNumber:128,className:"bikas.pixi.PixiDo",methodName:"createSprite"}),Nl.trace("-------------------------",{fileName:"PixiDo.hx",lineNumber:129,className:"bikas.pixi.PixiDo",methodName:"createSprite"})),qa.pickSpriteFromPool(e,t,n,i,r)},qa.createEmptySprite=function(){return qa.pickSpriteFromPool(null,0,0,0,0)},qa.createGraphics=function(e,t){return null==t&&(t=0),null==e&&(e=0),new hs($s.game,e,t)},qa.collectSpritesWithNoTexture=function(e,t){for(var n=0,i=e.children;n<i.length;){var r=i[n];if(++n,p.is(r,fs)){var a=so.__cast(r,fs);null==a.texture&&t.push(a)}else if(p.is(r,PIXI.Container)){var s=qa.collectSpritesWithNoTexture(r,t);t=t.concat(s)}}return t},qa.createBitmapText=function(e,t,n,i,r,a,s,l){null==l&&(l=0),null==s&&(s=0),null==a&&(a=0),null==r&&(r=0),null==i&&(i=""),null==n&&(n="left");var o=new ms($s.game,0,0,e,i,t,n);return o.anchor.set(r,a),o.position.set(s,l),o},qa.createAndAddButton=function(e,t,n,i,r,a,s,l){null==s&&(s=0),null==a&&(a=0),null==r&&(r=0);var o=new fs(null,0,0,t);return o.interactive=!0,null!=l&&(o.pointerdown=function(e){l()}),o.anchor.set(n,i),o.position.set(r,a),o.rotation=s,e.add(o),o},qa.pickGroupFromPool=function(){if(0<gs.destroyed_group_list.length){var e=gs.destroyed_group_list.pop();return e.mask=null,e.position.x=0,e.position.y=0,e.scale.x=1,e.scale.y=1,e.skew.x=0,e.skew.y=0,e.rotation=0,e.renderable=!0,e.visible=!0,e.alpha=1,e}return new gs($s.game)},qa.createGroup=function(){return qa.pickGroupFromPool()},qa.convertRectangle=function(e){return new na(e.x,e.y,e.width,e.height)},qa.convertRectangleTo=function(e){return new PIXI.Rectangle(e.x,e.y,e.width,e.height)},qa.convertRectangleToPixi=function(e){return new PIXI.Rectangle(e.x,e.y,e.width,e.height)},qa.convertPoint=function(e){return new ea(e.x,e.y)},qa.isSprite=function(e){return!!p.is(e,fs)},qa.castSprite=function(e){return so.__cast(e,fs)},qa.isPointInsideContainer=function(e,t){return p.is(t,fs),ma.pointInRectangle(e,qa.getContainerBounds(t))},qa.toGlobal=function(e,t,n){null!=e.parent&&e.parent!=$s.game&&(null!=n&&(n.x*=e.scale.x,n.y*=e.scale.y),t.x=t.x*e.scale.x+e.x,t.y=t.y*e.scale.y+e.y,qa.toGlobal(e.parent,t,n))},qa.toLocal=function(e,t,n){for(var i=e,r=[];null!=i&&i!=$s.game;)r.unshift(i),i=i.parent;for(var a=0;a<r.length;){var s=r[a];++a,null!=n&&(n.x/=s.scale.x,n.y/=s.scale.y),t.x=t.x/s.scale.x-s.x,t.y=t.y/s.scale.y-s.y}},qa.getContainerBounds=function(e){var t=qa.convertRectangle(e.getLocalBounds()),n=new PIXI.Point(t.x,t.y),i=new PIXI.Point(t.x+t.width,t.y+t.height);qa.toGlobal(e,n),qa.toGlobal(e,i);var r=n.x,a=n.y,s=i.x,l=i.y;return i.x<n.x&&(r=i.x,s=n.x),i.y<n.y&&(a=i.y,l=n.y),t=new na(r,a,s-r,l-a),$s.container,t},qa.getLocalContainerBounds=function(e){for(var t=qa.convertRectangle(e.getLocalBounds()),n=e;null!=n.parent;)n=n.parent;return n!=e&&(t.x*=n.scale.x,t.y*=n.scale.y,t.width*=n.scale.x,t.height*=n.scale.y),t},qa.createGraphicsRectangle=function(e,t,n,i){null==i&&(i=16777215),null==n&&(n=!1),null==t&&(t=16711680);var r=new hs($s.game);return r.position.set(e.x,e.y),n&&r.beginFill(i),r.lineStyle(2,t,1),r.moveTo(0,0),r.lineTo(e.width,0),r.lineTo(e.width,e.height),r.lineTo(0,e.height),r.lineTo(0,0),n&&r.endFill(),r.cacheAsBitmap=!0,r},qa.findOrCreatePointerObject=function(e,t){for(var n=0,i=e.pointer_objects;n<i.length;){var r=i[n];if(++n,r.id==t)return r}var a=new Qa(t);return e.pointer_objects.push(a),e.main_pointer_object=e.pointer_objects[0],a},qa.updatePointerPosition=function(e,t,n,i){isNaN(n)||isNaN(i)||(t.current.x=n/e.window_scale,t.current.y=i/e.window_scale)},qa.pointerDown=function(e,t,n,i,r){var a=qa.findOrCreatePointerObject(t,n);qa.updatePointerPosition(e,a,i,r),ga.setPoint(a.downed,a.current),a.state=Ja.DOWNED},qa.pointerUp=function(e,t,n,i,r){var a=qa.findOrCreatePointerObject(t,n);if(a.state==Ja.IS_UP)return a.is_leave=!0,a.current.x=-9999,a.current.y=-9999,a.state=Ja.IS_UP,void ga.setPoint(a.upped,a.current);qa.updatePointerPosition(e,a,i,r),ga.setPoint(a.upped,a.current);var s=Math.abs(a.upped.x-a.downed.x),l=Math.abs(a.upped.y-a.downed.y);a.state==Ja.DOWNED||a.state==Ja.IS_DOWN&&s<=Ka.CLICK_EVENT_DISTANCE&&l<=Ka.CLICK_EVENT_DISTANCE?a.cancel_upped_and_clicked?a.state=Ja.IS_UP:a.state=Ja.CLICKED:a.cancel_upped_and_clicked?a.state=Ja.IS_UP:a.state=Ja.UPPED},qa.addPointerEvents=function(e,t,n){e.pointermove=function(i){if(3!=i.data.originalEvent.which){var r=qa.findOrCreatePointerObject(t,i.data.identifier),a=i.data.global.x,s=i.data.global.y;e.hitArea.contains(a/n.window_scale,s/n.window_scale)&&qa.updatePointerPosition(n,r,a,s)}},e.pointerdown=function(i){if(3!=i.data.originalEvent.which){lo.get_window().focus();var r=i.data.global.x,a=i.data.global.y;e.hitArea.contains(r/n.window_scale,a/n.window_scale)&&(i.data.originalEvent.preventDefault(),qa.pointerDown(n,t,i.data.identifier,r,a))}else $s.right_mouse_button_down=!0},e.pointerup=function(e){if(3!=e.data.originalEvent.which){var i=e.data.global.x,r=e.data.global.y;qa.pointerUp(n,t,e.data.identifier,i,r)}else $s.right_mouse_button_down=!1},e.pointerout=Cc(e,e.pointerup),e.pointerupoutside=Cc(e,e.pointerup)},qa.updatePointer=function(e){for(var t=0,n=e.pointer_objects;t<n.length;){var i=n[t];++t,i.state==Ja.DOWNED?i.state=Ja.IS_DOWN:i.state==Ja.CLICKED?i.cancel_upped_and_clicked?i.state=Ja.IS_UP:i.state=Ja.UPPED:i.state==Ja.UPPED?i.state=Ja.IS_UP:i.state==Ja.IS_UP&&(i.cancel_upped_and_clicked=!1),i.is_leave&&(i.is_leave=!1)}};var Wa=n["bikas.pixi.InterpolationType"]={__ename__:["bikas","pixi","InterpolationType"],__constructs__:["Linear","SmoothStart","SmoothEnd","SmoothStartEnd","Random","RandomNearStartEnd"]};Wa.Linear=["Linear",0],Wa.Linear.toString=i,(Wa.Linear.__enum__=Wa).SmoothStart=["SmoothStart",1],Wa.SmoothStart.toString=i,(Wa.SmoothStart.__enum__=Wa).SmoothEnd=["SmoothEnd",2],Wa.SmoothEnd.toString=i,(Wa.SmoothEnd.__enum__=Wa).SmoothStartEnd=["SmoothStartEnd",3],Wa.SmoothStartEnd.toString=i,(Wa.SmoothStartEnd.__enum__=Wa).Random=["Random",4],Wa.Random.toString=i,(Wa.Random.__enum__=Wa).RandomNearStartEnd=["RandomNearStartEnd",5],Wa.RandomNearStartEnd.toString=i,(Wa.RandomNearStartEnd.__enum__=Wa).__empty_constructs__=[Wa.Linear,Wa.SmoothStart,Wa.SmoothEnd,Wa.SmoothStartEnd,Wa.Random,Wa.RandomNearStartEnd];var Xa=function(){this.alpha=null,this.rotation=null,this.scale=null,this.position=null,this.time=0,this.type=null};(n["bikas.pixi.TransitionState"]=Xa).__name__=["bikas","pixi","TransitionState"],Xa.prototype={type:null,time:null,position:null,scale:null,rotation:null,alpha:null,__class__:Xa};var Ha=n["bikas.pixi.TransitionCategoryType"]={__ename__:["bikas","pixi","TransitionCategoryType"],__constructs__:["InGame","Menu"]};Ha.InGame=["InGame",0],Ha.InGame.toString=i,(Ha.InGame.__enum__=Ha).Menu=["Menu",1],Ha.Menu.toString=i,(Ha.Menu.__enum__=Ha).__empty_constructs__=[Ha.InGame,Ha.Menu];var Ya=function(){this.on_finish=null,this.finished=!1,this.remove_from_container=!0,this.states=[]};(n["bikas.pixi.Transition"]=Ya).__name__=["bikas","pixi","Transition"],Ya.prototype={category:null,container:null,states:null,remove_from_container:null,current_time:null,finished:null,on_finish:null,__class__:Ya};var Ja=n["bikas.pointer.PointerStateType"]={__ename__:["bikas","pointer","PointerStateType"],__constructs__:["DOWNED","IS_DOWN","CLICKED","UPPED","IS_UP"]};Ja.DOWNED=["DOWNED",0],Ja.DOWNED.toString=i,(Ja.DOWNED.__enum__=Ja).IS_DOWN=["IS_DOWN",1],Ja.IS_DOWN.toString=i,(Ja.IS_DOWN.__enum__=Ja).CLICKED=["CLICKED",2],Ja.CLICKED.toString=i,(Ja.CLICKED.__enum__=Ja).UPPED=["UPPED",3],Ja.UPPED.toString=i,(Ja.UPPED.__enum__=Ja).IS_UP=["IS_UP",4],Ja.IS_UP.toString=i,(Ja.IS_UP.__enum__=Ja).__empty_constructs__=[Ja.DOWNED,Ja.IS_DOWN,Ja.CLICKED,Ja.UPPED,Ja.IS_UP];var Ka=function(){this.main_pointer_object=new Qa(""),this.pointer_objects=[]};(n["bikas.pointer.Pointer"]=Ka).__name__=["bikas","pointer","Pointer"],Ka.prototype={pointer_objects:null,main_pointer_object:null,__class__:Ka};var Qa=function(e){this.cancel_upped_and_clicked=!1,this.upped=new ea(0,0),this.downed=new ea(0,0),this.current=new ea(0,0),this.is_leave=!1,this.state=Ja.IS_UP,this.id="",this.id=e};(n["bikas.pointer.PointerObject"]=Qa).__name__=["bikas","pointer","PointerObject"],Qa.prototype={id:null,state:null,is_leave:null,current:null,downed:null,upped:null,cancel_upped_and_clicked:null,__class__:Qa};var $a=function(){};(n["bikas.pointer.PointerDo"]=$a).__name__=["bikas","pointer","PointerDo"],$a.isClicked=function(e,t,n,i){for(var r=0,a=n.pointer_objects;r<a.length;){var s=a[r];if(++r,s.state==Ja.UPPED){var l=s.downed,o=s.upped,_=ma.distance(l.x,l.y,e,t),p=ma.distance(o.x,o.y,e,t);if(_<=i&&p<=i)return!0}}return!1},$a.isOver=function(e,t,n,i){for(var r=0,a=n.pointer_objects;r<a.length;){var s=a[r];++r;var l=s.current;if(ma.distance(l.x,l.y,e,t)<=i)return!0}return!1},$a.getClicked=function(e,t,n,i){for(var r=0,a=n.pointer_objects;r<a.length;){var s=a[r];if(++r,s.state==Ja.UPPED){var l=s.downed,o=s.upped,_=ma.distance(l.x,l.y,e,t),p=ma.distance(o.x,o.y,e,t);if(_<=i&&p<=i)return s}}return null},$a.isDowned=function(e,t,n,i){for(var r=0,a=n.pointer_objects;r<a.length;){var s=a[r];if(++r,s.state==Ja.DOWNED&&ma.distance(s.current.x,s.current.y,e,t)<=i)return!0}return!1},$a.isDownOrDowned=function(e,t,n,i){for(var r=0,a=n.pointer_objects;r<a.length;){var s=a[r];if(++r,(s.state==Ja.IS_DOWN||s.state==Ja.DOWNED)&&ma.distance(s.current.x,s.current.y,e,t)<=i)return!0}return!1},$a.isAnyDowned=function(e){for(var t=0,n=e.pointer_objects;t<n.length;){var i=n[t];if(++t,i.state==Ja.DOWNED)return!0}return!1},$a.isDownedInBounds=function(e,t,n,i,r,a,s){for(var l=0,o=n.pointer_objects;l<o.length;){var _=o[l];if(++l,_.state==Ja.DOWNED&&ma.pointInBoundedArea(_.current,i,r,a,s))return!0}return!1},$a.getDowned=function(e,t,n,i){for(var r=0,a=n.pointer_objects;r<a.length;){var s=a[r];if(++r,s.state==Ja.DOWNED&&ma.distance(s.current.x,s.current.y,e,t)<=i)return s}return null},$a.isPointerObjectDowned=function(e,t,n,i){return ma.distance(n.current.x,n.current.y,e,t)<=i},$a.isPointerObjectDownedRect=function(e,t,n,i,r){return!!ma.positionInRect(e.current.x,e.current.y,t,n,i,r)},$a.getPointerDowned=function(e){for(var t=0,n=e.pointer_objects;t<n.length;){var i=n[t];if(++t,i.state==Ja.DOWNED)return i}return null},$a.getPointerDown=function(e){for(var t=0,n=e.pointer_objects;t<n.length;){var i=n[t];if(++t,i.state==Ja.DOWNED||i.state==Ja.IS_DOWN)return i}return null},$a.getPointerClicked=function(e,t){for(var n=0,i=e.pointer_objects;n<i.length;){var r=i[n];if(++n,r.state==Ja.UPPED){var a=r.downed,s=r.upped;if(ma.distanceBetweenPoints(a,s)<=t)return r}}return null};var es=e.bikas.poki.PokiWrapperDo=function(){};(n["bikas.poki.PokiWrapperDo"]=es).__name__=["bikas","poki","PokiWrapperDo"],es.enableAdblockWarning=function(){es.show_adblock_warning=!0},es.updateAdblockWarning=function(e,t){},es.pokiSitelock=function(){},es.init=function(e){return"undefined"==typeof PokiSDK?(Nl.trace("PokiSDK is undefined",{fileName:"PokiWrapperDo.hx",lineNumber:95,className:"bikas.poki.PokiWrapperDo",methodName:"init"}),!1):(es.PokiSDK=PokiSDK,PokiSDK.init().then(function(){console.log("PokiSDK initialized")}).catch(function(){console.log("Adblock enabled"),bikas.poki.PokiWrapperDo.enableAdblockWarning()}),e.release.sitelock_poki_debug_enabled?PokiSDK.setDebug(!0):PokiSDK.setDebug(!1),!0)};var ts=function(){};(n["bikas.polygon.PolygonCutterByRectangle"]=ts).__name__=["bikas","polygon","PolygonCutterByRectangle"],ts.intersectPointX=function(e,t,n){return new ea(e.x+(n-e.y)/(t.y-e.y)*(t.x-e.x),n)},ts.intersectPointY=function(e,t,n){return new ea(n,e.y+(n-e.x)/(t.x-e.x)*(t.y-e.y))},ts.copyPoint=function(e){return new ea(e.x,e.y)},ts.checkIfOutOfBounds=function(e,t,n,i,r){for(var a=1/0,s=-1/0,l=1/0,o=-1/0,_=0,p=e.length;_<p;){var u=_++;e[u].x<a?a=e[u].x:e[u].x>s&&(s=e[u].x),e[u].y<l?l=e[u].y:e[u].y>o&&(o=e[u].y)}return n<a||s<t||i<l||o<r},ts.transferPoints=function(e,t){for(var n=0,i=e.length;n<i;){var r=n++;t.push(e[r])}},ts.transferVectorPoints=function(e,t){for(var n=0,i=e.length;n<i;){var r=n++;t.push(e[r])}},ts.cutPolygonsByLeftX=function(e,t){for(var n,i=[],r=0,a=e.length;r<a;){var s=r++;null!=(n=ts.cutByLeftX(e[s],t))&&ts.transferVectorPoints(n,i)}return i},ts.cutPolygonsByRightX=function(e,t){for(var n,i=[],r=0,a=e.length;r<a;){var s=r++;null!=(n=ts.cutByRightX(e[s],t))&&ts.transferVectorPoints(n,i)}return i},ts.cutPolygonsByTopY=function(e,t){for(var n,i=[],r=0,a=e.length;r<a;){var s=r++;null!=(n=ts.cutByTopY(e[s],t))&&ts.transferVectorPoints(n,i)}return i},ts.cutPolygonsByBottomY=function(e,t){for(var n,i=[],r=0,a=e.length;r<a;){var s=r++;null!=(n=ts.cutByBottomY(e[s],t))&&ts.transferVectorPoints(n,i)}return i},ts.cutByLeftX=function(e,t){if(null==e)return null;if(e.length<3)return null;for(var n,i,r,a,s,l,o,_,p,u,h,c=[],d=e.length,m=null,f=0,g=0,v=d;g<v;){var b=g++;if(r=e[b],a=b<d-1?e[b+1]:e[0],r.x<=t&&a.x>t){(i=[]).push(ts.intersectPointY(r,a,t)),c.push(i),m=i,f=b;break}}if(null==m){if(e[0].x>t){i=[];for(var y=0,x=d;y<x;){var z=y++;i.push(ts.copyPoint(e[z]))}return c.push(i),c}return null}for(d<=(n=f+1)&&(n=0);n!=f;)r=e[n],a=n<d-1?e[n+1]:e[0],r.x<=t&&a.x>t?((i=[]).push(ts.intersectPointY(r,a,t)),c.push(i),m=i):r.x>t&&a.x>t?m.push(r):a.x<=t&&r.x>t&&(m.push(r),m.push(ts.intersectPointY(r,a,t))),d<=++n&&(n=0);if(1==(d=c.length))return c;for(n=0;n<d;){if((o=(s=c[n])[0].y)<(_=s[s.length-1].y))for((h=n-1)<0&&(h=d-1);h!=n;){if(p=(l=c[h])[0].y,(u=l[l.length-1].y)<=p){if(o<=u&&p<=_){ts.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(o<=u&&p<=_)break;--h<0&&(h=d-1)}else for((h=n-1)<0&&(h=d-1);h!=n;){if((p=(l=c[h])[0].y)<(u=l[l.length-1].y)){if(p<_&&o<u){ts.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(p<_&&o<u)break;--h<0&&(h=d-1)}++n}return c},ts.cutByRightX=function(e,t){if(null==e)return null;if(e.length<3)return null;for(var n,i,r,a,s,l,o,_,p,u,h,c=[],d=e.length,m=null,f=0,g=0,v=d;g<v;){var b=g++;if(r=e[b],a=b<d-1?e[b+1]:e[0],r.x>=t&&a.x<t){(i=[]).push(ts.intersectPointY(r,a,t)),c.push(i),m=i,f=b;break}}if(null==m){if(e[0].x<t){i=[];for(var y=0,x=d;y<x;){var z=y++;i.push(ts.copyPoint(e[z]))}return c.push(i),c}return null}for(d<=(n=f+1)&&(n=0);n!=f;)r=e[n],a=n<d-1?e[n+1]:e[0],r.x>=t&&a.x<t?((i=[]).push(ts.intersectPointY(r,a,t)),c.push(i),m=i):r.x<t&&a.x<t?m.push(r):a.x>=t&&r.x<t&&(m.push(r),m.push(ts.intersectPointY(r,a,t))),d<=++n&&(n=0);if(1==(d=c.length))return c;for(n=0;n<d;){if((o=(s=c[n])[0].y)<=(_=s[s.length-1].y))for((h=n-1)<0&&(h=d-1);h!=n;){if(p=(l=c[h])[0].y,(u=l[l.length-1].y)<p){if(u<=o&&_<=p){ts.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(u<=o&&_<=p)break;--h<0&&(h=d-1)}else if(_<o)for((h=n-1)<0&&(h=d-1);h!=n;){if((p=(l=c[h])[0].y)<=(u=l[l.length-1].y)){if(_<=p&&u<=o){ts.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(_<=p&&u<=o)break;--h<0&&(h=d-1)}++n}return c},ts.cutByBottomY=function(e,t){if(null==e)return null;if(e.length<3)return null;for(var n,i,r,a,s,l,o,_,p,u,h,c=[],d=e.length,m=null,f=0,g=0,v=d;g<v;){var b=g++;if(r=e[b],a=b<d-1?e[b+1]:e[0],r.y>=t&&a.y<t){(i=[]).push(ts.intersectPointX(r,a,t)),c.push(i),m=i,f=b;break}}if(null==m){if(e[0].y<t){i=[];for(var y=0,x=d;y<x;){var z=y++;i.push(ts.copyPoint(e[z]))}return c.push(i),c}return null}for(d<=(n=f+1)&&(n=0);n!=f;)r=e[n],a=n<d-1?e[n+1]:e[0],r.y>=t&&a.y<t?((i=[]).push(ts.intersectPointX(r,a,t)),c.push(i),m=i):r.y<t&&a.y<t?m.push(r):a.y>=t&&r.y<t&&(m.push(r),m.push(ts.intersectPointX(r,a,t))),d<=++n&&(n=0);if(1==(d=c.length))return c;for(n=0;n<d;){if((o=(s=c[n])[0].x)<(_=s[s.length-1].x))for((h=n-1)<0&&(h=d-1);h!=n;){if(p=(l=c[h])[0].x,(u=l[l.length-1].x)<=p){if(o<=u&&p<=_){ts.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(o<=u&&p<=_)break;--h<0&&(h=d-1)}else for((h=n-1)<0&&(h=d-1);h!=n;){if((p=(l=c[h])[0].x)<(u=l[l.length-1].x)){if(p<=_&&o<=u){ts.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(p<=_&&o<=u)break;--h<0&&(h=d-1)}++n}return c},ts.cutByTopY=function(e,t){if(null==e)return null;if(e.length<3)return null;for(var n,i,r,a,s,l,o,_,p,u,h,c=[],d=e.length,m=null,f=0,g=0,v=d;g<v;){var b=g++;if(r=e[b],a=b<d-1?e[b+1]:e[0],r.y<=t&&a.y>t){(i=[]).push(ts.intersectPointX(r,a,t)),c.push(i),m=i,f=b;break}}if(null==m){if(e[0].y>t){i=[];for(var y=0,x=d;y<x;){var z=y++;i.push(ts.copyPoint(e[z]))}return c.push(i),c}return null}for(d<=(n=f+1)&&(n=0);n!=f;)r=e[n],a=n<d-1?e[n+1]:e[0],r.y<=t&&a.y>t?((i=[]).push(ts.intersectPointX(r,a,t)),c.push(i),m=i):r.y>t&&a.y>t?m.push(r):a.y<=t&&r.y>t&&(m.push(r),m.push(ts.intersectPointX(r,a,t))),d<=++n&&(n=0);if(1==(d=c.length))return c;for(n=0;n<d;){if(o=(s=c[n])[0].x,(_=s[s.length-1].x)<o)for((h=n-1)<0&&(h=d-1);h!=n;){if((p=(l=c[h])[0].x)<=(u=l[l.length-1].x)){if(u<=o&&_<p){ts.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(u<=o&&_<p)break;--h<0&&(h=d-1)}else for((h=n-1)<0&&(h=d-1);h!=n;){if(p=(l=c[h])[0].x,(u=l[l.length-1].x)<p){if(_<=p&&u<=o){ts.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(_<=p&&u<=o)break;--h<0&&(h=d-1)}++n}return c},ts.cutPolygonByRectangle=function(e,t,n,i,r,a,s,l,o){null==o&&(o=3),null==l&&(l=2),null==s&&(s=1),null==a&&(a=0);var _=[a,s,l,o],p=[];p.push(e);for(var u=0;u<4;)switch(_[u++]){case 0:p=ts.cutPolygonsByLeftX(p,t);break;case 1:p=ts.cutPolygonsByRightX(p,n);break;case 2:p=ts.cutPolygonsByTopY(p,i);break;case 3:p=ts.cutPolygonsByBottomY(p,r);break;default:Nl.trace("warning: unknown cut side",{fileName:"PolygonCutterByRectangle.hx",lineNumber:864,className:"bikas.polygon.PolygonCutterByRectangle",methodName:"cutPolygonByRectangle"})}return p};var ns=function(){};(n["bikas.polygon.PolygonFunc"]=ns).__name__=["bikas","polygon","PolygonFunc"],ns.pointsToVertices=function(e){for(var t=[],n=0;n<e.length;){var i=e[n];++n,t.push(i.x),t.push(i.y)}return t},ns.createSymetricalPolygon=function(e,t,n){for(var i=[],r=0,a=e;r<a;){var s=r++;i.push(new ea(Math.cos(2*Math.PI*s/e+.017453292519943*n)*t,Math.sin(2*Math.PI*s/e+.017453292519943*n)*t))}return i},ns.getPolygonBounds=function(e){for(var t=1/0,n=-1/0,i=1/0,r=-1/0,a=0;a<e.length;){var s=e[a];++a,s.x<t&&(t=s.x),s.x>n&&(n=s.x),s.y<i&&(i=s.y),s.y>r&&(r=s.y)}return new ia(t,i,n,r)},ns.copyPolygonWithOffset=function(e,t){for(var n=[],i=0;i<e.length;){var r=e[i];++i,n.push(new ea(r.x+t.x,r.y+t.y))}return n},ns.copyPolygonWithTransform=function(e,t,n){for(var i=[],r=0;r<e.length;){var a=e[r];++r;var s=new ea(a.x,a.y);ga.applyTransformToPoint(s,t,n),i.push(s)}return i},ns.getPolygonArea=function(e){for(var t=0,n=0,i=e.length;n<i;){var r=n++,a=(r+1)%e.length;t+=e[r].x*e[a].y,t-=e[a].x*e[r].y}return t/2},ns.isPolygonClockwise=function(e){return 0<ns.getPolygonArea(e)},ns.getBoundsFromSeveralPolygons=function(e){for(var t=1/0,n=-1/0,i=1/0,r=-1/0,a=0;a<e.length;){var s=e[a];++a;for(var l=0;l<s.length;){var o=s[l];++l,o.x<t&&(t=o.x),o.x>n&&(n=o.x),o.y<i&&(i=o.y),o.y>r&&(r=o.y)}}return new ia(t,i,n,r)},ns.pointInPolygon=function(e,t){if(t.length<3)return!1;for(var n=e.x,i=e.y,r=t[t.length-1],a=!1,s=0;s<t.length;){var l=t[s];++s,(l.y<i&&r.y>=i||r.y<i&&l.y>=i)&&(l.x<=n||r.x<=n)&&l.x+(i-l.y)/(r.y-l.y)*(r.x-l.x)<n&&(a=!a),r=l}return a},ns.boundsIntersectWithPolygon=function(e,t){for(var n=new ea(e.min_x,e.min_y),i=new ea(e.max_x,e.min_y),r=new ea(e.max_x,e.max_y),a=new ea(e.min_x,e.max_y),s=0,l=t.length;s<l;){var o,_=s++;o=0==_?t[t.length-1]:t[_-1];var p=t[_];if(!(o.x<n.x&&p.x<n.x||o.x>i.x&&p.x>i.x||o.y<n.y&&p.y<n.y||o.y>a.y&&p.y>a.y)){if(ma.lineSegmentsIntersect(n,i,o,p))return!0;if(ma.lineSegmentsIntersect(i,r,o,p))return!0;if(ma.lineSegmentsIntersect(r,a,o,p))return!0;if(ma.lineSegmentsIntersect(a,n,o,p))return!0}}return!1},ns.getClosestPointToSpecifiedBound=function(e,t,n){var i=ns.getPolygonBounds(e),r=new ea;r.y=t?i.min_y:i.max_y,r.x=n?i.min_x:i.max_x;for(var a=1/0,s=null,l=0;l<e.length;){var o=e[l];++l;var _=ma.distanceBetweenPoints(o,r);null==s?(a=_,s=o):_<a&&(a=_,s=o)}return s},ns.merge2Polygons=function(e,t){for(var n=-1,i=0,r=e.length;i<r;){var a=i++;if(!ns.pointInPolygon(e[a],t)){n=a;break}}if(-1==n)return ma.copyPoints(t);for(var s=[],l=e,o=t,_=n,p=l[_],u=null,h=e.length*t.length,c=!1;;){if(0==h--)return Nl.trace("warning: merge2Polygons algorithm broke",{fileName:"PolygonFunc.hx",lineNumber:236,className:"bikas.polygon.PolygonFunc",methodName:"merge2Polygons"}),null;if(s.push(p),(u=_+1==l.length?l[0]:l[_+1])==e[n])break;for(var d=null,m=0,f=o.length;m<f;){var g,v=m++;g=v+1==o.length?0:v+1;var b=o[v],y=o[g],x=ma.getLineSegmentIntersection(p,u,b,y);if(null!=x)if(ma.pointsEqual(p,x))x=null;else{c=!0;var z=ma.distanceBetweenPoints(b,x);(null==d||d.distance>z)&&((d=new da).intersection=x,d.index=v,d.distance=z)}}if(null!=d){var w=l;l=o,o=w,p=d.intersection,_=d.index}else++_>=l.length&&(_=0),p=l[_]}return c?s.length<3?null:s:null};var is=function(){this.leftEdge=0,this.bottomEdge=0,this.rightEdge=0,this.topEdge=0};(n["bikas.polygon.Edges"]=is).__name__=["bikas","polygon","Edges"],is.prototype={topEdge:null,rightEdge:null,bottomEdge:null,leftEdge:null,__class__:is};var rs=function(){};(n["bikas.polygon.SutherlandHodgmanPolygonCutter"]=rs).__name__=["bikas","polygon","SutherlandHodgmanPolygonCutter"],rs.clip=function(e,t,n,i,r){var a=new is;if(a.topEdge=t,a.rightEdge=n,a.bottomEdge=i,a.leftEdge=r,e.length<3)return Nl.trace("warning: polygon.length < 3",{fileName:"SutherlandHodgmanPolygonCutter.hx",lineNumber:29,className:"bikas.polygon.SutherlandHodgmanPolygonCutter",methodName:"clip"}),null;if(e[0].x==e[e.length-1].x&&e[0].y==e[e.length-1].y)return Nl.trace("warning: is closed polygon",{fileName:"SutherlandHodgmanPolygonCutter.hx",lineNumber:33,className:"bikas.polygon.SutherlandHodgmanPolygonCutter",methodName:"clip"}),null;var s,l,o=[],_=e.slice();_.push(e[0]);for(var p=0;p<4;){var u=p++;o=[];for(var h=0,c=_.length-1;h<c;){var d=h++;s=_[d],l=_[d+1],rs.isInsideClipWindow(a,s,u)?rs.isInsideClipWindow(a,l,u)?o.push(new ea(l.x,l.y)):o.push(rs.intersectionPoint(a,u,s,l)):rs.isInsideClipWindow(a,l,u)&&(o.push(rs.intersectionPoint(a,u,s,l)),o.push(new ea(l.x,l.y)))}if(!(1<o.length))return null;o[0].x==o[o.length-1].x&&o[0].y==o[o.length-1].y||o.push(o[0]),_=o}return _.length<4?null:(_.pop(),_)},rs.isInsideClipWindow=function(e,t,n){switch(n){case 0:return t.x<=e.rightEdge;case 1:return t.x>=e.leftEdge;case 2:return t.y<=e.bottomEdge;case 3:return t.y>=e.topEdge;default:return Nl.trace("warning: something went wrong with SutherlandHodgmanPolygonCutter",{fileName:"SutherlandHodgmanPolygonCutter.hx",lineNumber:107,className:"bikas.polygon.SutherlandHodgmanPolygonCutter",methodName:"isInsideClipWindow"}),!1}},rs.intersectionPoint=function(e,t,n,i){switch(t){case 0:return ea.create(e.rightEdge,n.y+(e.rightEdge-n.x)*(i.y-n.y)/(i.x-n.x));case 1:return ea.create(e.leftEdge,n.y+(e.leftEdge-n.x)*(i.y-n.y)/(i.x-n.x));case 2:return ea.create(n.x+(e.bottomEdge-n.y)*(i.x-n.x)/(i.y-n.y),e.bottomEdge);case 3:return ea.create(n.x+(e.topEdge-n.y)*(i.x-n.x)/(i.y-n.y),e.topEdge);default:return null}};var as=function(){this.local=null};(n["bikas.projection.Position3D"]=as).__name__=["bikas","projection","Position3D"],as.prototype={local:null,global:null,projection:null,__class__:as};var ss=function(){};(n["bikas.projection.Point3D"]=ss).__name__=["bikas","projection","Point3D"],ss.prototype={sprite:null,position:null,__class__:ss};var ls=function(){};(n["bikas.projection.Rectangle3D"]=ls).__name__=["bikas","projection","Rectangle3D"],ls.prototype={points:null,position:null,rectangle:null,__class__:ls};var os=function(){this.height_cache=0,this.width_cache=0};(n["bikas.projection.Sprite3D"]=os).__name__=["bikas","projection","Sprite3D"],os.prototype={sprite:null,init_position:null,position:null,anchor:null,points:null,width_cache:null,height_cache:null,__class__:os};var _s=function(){};(n["bikas.projection.ProjectionDo"]=_s).__name__=["bikas","projection","ProjectionDo"],_s.createPoint=function(e){null==e&&(e=6);var t=new hs($s.game);return Va.drawCircle(t,e),t},_s.createRectangle3DPoints=function(e){var t=e.x,n=e.x+e.width,i=e.y,r=e.y+e.height;return[new Gi(t,i,0),new Gi(n,i,0),new Gi(n,r,0),new Gi(t,r,0)]},_s.createRectangle3D=function(e,t,n){var i=new ls,r=_s.createRectangle3DPoints(t);i.points=[];for(var a=0;a<r.length;){var s=r[a];++a;var l=s,o=ya.add(e,s);i.points.push(_s.createPoint3D(_s.createPoint(n),o,l))}return i.position=e,i.rectangle=t,i},_s.setRectangle3DRotation=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0);for(var r=0,a=e.points;r<a.length;){var s=a[r];++r;var l=ya.rotateX(s.position.local,t);xa.rotateY(l,n),xa.rotateZ(l,i),s.position.global=l,xa.add(s.position.global,e.position)}},_s.setSprite3DRotation=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0);for(var r=0,a=e.points;r<a.length;){var s=a[r];++r;var l=ya.rotateX(s.local,t);xa.rotateY(l,n),xa.rotateZ(l,i),s.global=l,xa.add(s.global,e.position)}},_s.drawRectangle3DLines=function(e,t){var n=t.points[0].position.projection;e.clear(),e.lineStyle(1,0,1),e.moveTo(n.x,n.y);for(var i=1,r=t.points.length;i<r;){var a=i++;n=t.points[a].position.projection,e.lineTo(n.x,n.y)}n=t.points[0].position.projection,e.lineTo(n.x,n.y)},_s.drawSprite3D=function(e,t){var n=t.points[0].projection;e.lineStyle(1,0,1),e.moveTo(n.x,n.y);for(var i=1,r=t.points.length;i<r;){var a=i++;n=t.points[a].projection,e.lineTo(n.x,n.y)}n=t.points[0].projection,e.lineTo(n.x,n.y);for(var s=0,l=t.points;s<l.length;)l[s],++s},_s.createPoint3D=function(e,t,n){var i=new ss;return i.sprite=e,i.position=_s.createPosition3D(t,n),i},_s.createPosition3D=function(e,t){var n=new as;return n.global=e,n.local=t,n.projection=new ea,n},_s.createSprite3D=function(e,t,n,i){null==i&&(i=800),null==n&&(n=0);var r=e.getLocalBounds(),a=new os;return a.sprite=e,a.position=t,a.init_position=ya.copy(t),a.points=_s.get3DPointsFromSpriteBounds(e,r,n,i),_s.updateSpritePoints(a),a.anchor=new ea(-r.x/r.width,-r.y/r.height),a},_s.replaceSprite=function(e,t,n,i){null==i&&(i=800),null==n&&(n=0),e.sprite.setTexture(t);var r=e.sprite.getLocalBounds();e.points=_s.get3DPointsFromSpriteBounds(e.sprite,r,n,i),_s.updateSpritePoints(e),e.anchor=new ea(-r.x/r.width,-r.y/r.height)},_s.get3DPointsFromSpriteBounds=function(e,t,n,i){var r=t.x,a=t.y,s=t.width,l=t.height,o=new ea(r,a),_=new ea(r+s,a),p=new ea(r,a+l),u=function(e,t,n){var i=e.x*(n+t)/n,r=e.y*(n+t)/n,a=new as;return a.local=new Gi(i,r,0),a.global=ya.copy(a.local),a.projection=za.copy(e),a},h=n,c=i;return[u(o,h,c),u(_,h,c),u(p,h,c)]},_s.updateSpritePoints=function(e){for(var t=0,n=e.points;t<n.length;){var i=n[t];++t,i.global.x=i.local.x+e.position.x,i.global.y=i.local.y+e.position.y,i.global.z=i.local.z+e.position.z}},_s.applyProjectionAndUpdatePoint3DPosition=function(e,t,n){xa.applyProjectionWithCamera(e.position.projection,t,n,e.position.global),e.sprite.x=e.position.projection.x,e.sprite.y=e.position.projection.y},_s.applyProjectionAndUpdateSprite3DPosition=function(e,t,n){for(var i=0,r=e.points;i<r.length;){var a=r[i];++i,xa.applyProjectionWithCamera(a.projection,t,n,a.global)}var s=e.points[0].projection,l=e.sprite,o=e.points[1].projection.x-s.x,_=e.points[2].projection.y-s.y;l.width=o,l.height=_,l.x=s.x+o*e.anchor.x,l.y=s.y+_*e.anchor.y},_s.getSprite3DWidth=function(e){return Math.abs(e.points[1].global.x-e.points[0].global.x)},_s.sortSpritesByZ=function(e,t){return e.position.z<t.position.z?1:e.position.z>t.position.z?-1:0},_s.updatePositions=function(e,t,n){for(var i=0;i<n.length;){var r=n[i];++i,xa.applyProjectionWithCamera(r.projection,e,t,r.global)}},_s.updatePoints=function(e,t,n){for(var i=0;i<n.length;){var r=n[i];++i,_s.applyProjectionAndUpdatePoint3DPosition(r,e,t)}},_s.updateSprites=function(e,t,n){for(var i=0;i<n.length;){var r=n[i];++i,_s.applyProjectionAndUpdateSprite3DPosition(r,e,t)}};var ps=function(){};(n["bikas.projection.ProjectionExamples"]=ps).__name__=["bikas","projection","ProjectionExamples"],ps.createBasic=function(e,t,n){var i=new us;i.eye=_s.createPoint3D(_s.createPoint(6),new Gi(t/2,n/2,800)),i.camera=new Gi(0,0,0),i.single_point=_s.createPoint3D(_s.createPoint(10),new Gi(100,100,1e3)),i.rect3d=_s.createRectangle3D(new Gi(t/2,n/2,1e3),new na(-250,-250,500,500),6),i.all_points.push(i.single_point),i.all_points.push(i.eye),i.all_points=i.all_points.concat(i.rect3d.points),i.rect_line_graphics=qa.createGraphics(),i.sprite_line_graphics=qa.createGraphics();var r=Va.drawBounds(qa.createGraphics(),new ia(0,0,t,n),10,16711680,1,!0,16777215,1);e.add(r);for(var a=0,s=i.all_points;a<s.length;){var l=s[a];++a,e.add(l.sprite)}return e.add(i.rect_line_graphics),e.add(i.sprite_line_graphics),i},ps.updateBasic=function(e){if(e.rotation+=Math.PI/60,_s.setRectangle3DRotation(e.rect3d,e.rotation,0,0),_s.updatePoints(e.eye.position.global,e.camera,e.all_points),_s.updateSprites(e.eye.position.global,e.camera,e.all_sprites),_s.drawRectangle3DLines(e.rect_line_graphics,e.rect3d),0<e.all_sprites.length){e.sprite_line_graphics.clear();for(var t=0,n=e.all_sprites;t<n.length;){var i=n[t];++t,_s.drawSprite3D(e.sprite_line_graphics,i)}}};var us=function(){this.rotation=0,this.all_sprites=[],this.all_points=[]};(n["bikas.projection.BasicScene"]=us).__name__=["bikas","projection","BasicScene"],us.prototype={eye:null,camera:null,single_point:null,rect3d:null,all_points:null,all_sprites:null,rect_line_graphics:null,sprite_line_graphics:null,rotation:null,__class__:us};var hs=function(e,t,n){null==n&&(n=0),null==t&&(t=0),PIXI.Graphics.call(this),this.x=t,this.y=n};(n["bikas.render.Graphics"]=hs).__name__=["bikas","render","Graphics"],hs.__super__=PIXI.Graphics,hs.prototype=r(PIXI.Graphics.prototype,{__class__:hs});var cs=function(e,t,n,i,r,a,s){PIXI.extras.TilingSprite.call(this,a,i,r),this.x=t,this.y=n};(n["bikas.render.TileSprite"]=cs).__name__=["bikas","render","TileSprite"],cs.__super__=PIXI.extras.TilingSprite,cs.prototype=r(PIXI.extras.TilingSprite.prototype,{__class__:cs});var ds=function(e,t,n,i){PIXI.Rectangle.call(this,e,t,n,i)};(n["bikas.render.Rectangle"]=ds).__name__=["bikas","render","Rectangle"],ds.__super__=PIXI.Rectangle,ds.prototype=r(PIXI.Rectangle.prototype,{__class__:ds});var ms=function(e,t,n,i,r,a,s){null==s&&(s="left");var l=a+"px "+i;PIXI.extras.BitmapText.call(this,r,{font:l,align:s}),this.x=t,this.y=n};(n["bikas.render.BitmapText"]=ms).__name__=["bikas","render","BitmapText"],ms.__super__=PIXI.extras.BitmapText,ms.prototype=r(PIXI.extras.BitmapText.prototype,{destroy:function(e){null==e&&(e=!0),null!=this.parent&&this.parent.removeChild(this),PIXI.extras.BitmapText.prototype.destroy.call(this)},__class__:ms});var fs=function(e,t,n,i,r){null==r&&(r=0),PIXI.Sprite.call(this,i),this.x=t,this.y=n};(n["bikas.render.Sprite"]=fs).__name__=["bikas","render","Sprite"],fs.__super__=PIXI.Sprite,fs.prototype=r(PIXI.Sprite.prototype,{setTexture:function(e){var t=this.scale.x,n=this.scale.y;this.position.x,null!=this.texture&&null!=this.texture.orig&&(this.width=0,this.height=0),this.texture=e,this.scale.x=t,this.scale.y=n},destroy:function(e){if(null==e&&(e=!0),e)for(var t=this.children.slice(),n=0;n<t.length;){var i=t[n];++n,i.destroy(e)}null!=this.parent&&this.parent.removeChild(this),$r.validate_reusable_objects&&-1!=fs.destroyed_sprite_list.indexOf(this)?Nl.trace("warning: object is already added to destroyed list",{fileName:"RenderWrapper.hx",lineNumber:169,className:"bikas.render.Sprite",methodName:"destroy"}):fs.destroyed_sprite_list.push(this)},__class__:fs});var gs=function(e){PIXI.Container.call(this)};(n["bikas.render.Group"]=gs).__name__=["bikas","render","Group"],gs.__super__=PIXI.Container,gs.prototype=r(PIXI.Container.prototype,{add:function(e){this.addChild(e)},addAt:function(e,t){this.addChildAt(e,t)},getAt:function(e){return this.getChildAt(e)},remove:function(e){this.removeChild(e)},destroy:function(e){if(null==e&&(e=!0),e)for(var t=this.children.slice(),n=0;n<t.length;){var i=t[n];++n,i.destroy(e)}null!=this.parent&&this.parent.removeChild(this),$r.validate_reusable_objects&&-1!=gs.destroyed_group_list.indexOf(this)?Nl.trace("warning: object is already added to destroyed list",{fileName:"RenderWrapper.hx",lineNumber:228,className:"bikas.render.Group",methodName:"destroy"}):gs.destroyed_group_list.push(this)},__class__:gs});var vs=function(){};(n["bikas.serialization.Bef"]=vs).__name__=["bikas","serialization","Bef"];var bs=function(){};(n["bikas.serialization.ByteCursor"]=bs).__name__=["bikas","serialization","ByteCursor"],bs.prototype={alloc_size:null,bytes:null,pos:null,__class__:bs};var ys=function(){};(n["bikas.serialization.EnumValueCache"]=ys).__name__=["bikas","serialization","EnumValueCache"],ys.prototype={name:null,value:null,__class__:ys};var xs=function(){};(n["bikas.serialization.EnumTypeCache"]=xs).__name__=["bikas","serialization","EnumTypeCache"],xs.prototype={name:null,type:null,values:null,__class__:xs};var zs=function(){this.type_table=null};(n["bikas.serialization.SerialData"]=zs).__name__=["bikas","serialization","SerialData"],zs.prototype={classes:null,enum_cache:null,type_table:null,__class__:zs};var ws=function(){this.serial_field=null};(n["bikas.serialization.UnserialField"]=ws).__name__=["bikas","serialization","UnserialField"],ws.prototype={field_name:null,value_type_flags:null,serial_field:null,__class__:ws};var ks=function(){this.serial_class=null,this.fields=null};(n["bikas.serialization.UnserialClass"]=ks).__name__=["bikas","serialization","UnserialClass"],ks.prototype={full_class_name:null,fields:null,serial_class:null,__class__:ks};var Ss=function(){};(n["bikas.serialization.UnserialData"]=Ss).__name__=["bikas","serialization","UnserialData"],Ss.prototype={classes:null,enum_cache:null,__class__:Ss};var Cs=n["bikas.sound.MusicState"]={__ename__:["bikas","sound","MusicState"],__constructs__:["FadeIn","FadeOut","Playing","Paused"]};Cs.FadeIn=["FadeIn",0],Cs.FadeIn.toString=i,(Cs.FadeIn.__enum__=Cs).FadeOut=["FadeOut",1],Cs.FadeOut.toString=i,(Cs.FadeOut.__enum__=Cs).Playing=["Playing",2],Cs.Playing.toString=i,(Cs.Playing.__enum__=Cs).Paused=["Paused",3],Cs.Paused.toString=i,(Cs.Paused.__enum__=Cs).__empty_constructs__=[Cs.FadeIn,Cs.FadeOut,Cs.Playing,Cs.Paused];var Ns=function(e,t,n){this.marked_as_updated=!1,this.played_once=!1,this.have_id=!1,this.state=Cs.Paused,this.name=e,this.howl=t,this.max_volume=n,this.current_volume=n};(n["bikas.sound.Music"]=Ns).__name__=["bikas","sound","Music"],Ns.prototype={state:null,name:null,howl:null,current_volume:null,max_volume:null,fade_step:null,id:null,have_id:null,played_once:null,marked_as_updated:null,__class__:Ns};var Ps=function(e,t,n,i){this.cursor=0,this.max_simultaneous=3,this.current_ids=[],this.name=e,this.howl=t,this.max_simultaneous=n,this.max_volume=i};(n["bikas.sound.Sound"]=Ps).__name__=["bikas","sound","Sound"],Ps.prototype={name:null,howl:null,current_ids:null,max_simultaneous:null,max_volume:null,cursor:null,__class__:Ps};var Ms=function(){};(n["bikas.sound.SoundDo"]=Ms).__name__=["bikas","sound","SoundDo"],Ms.createSound=function(e,t,n,i){var r=new Ps(e,t,i,n);r.current_ids=[];for(var a=0,s=i;a<s;)a++,r.current_ids.push(-1);return r.howl.volume(n),r},Ms.createMusic=function(e,t,n){var i=new Ns(e,t,n);return i.howl.volume(n),i},Ms.isSoundPlaying=function(e){return null!=e&&!!e.howl.playing()},Ms.playSound=function(e,t,n,i){if(null==i&&(i=-2),null==n&&(n=-1),t&&null!=e){-1!=n?e.howl.volume(n):e.howl.volume(e.max_volume);for(var r=e.howl,a=-1,s=0,l=0,o=e.current_ids;l<o.length;){var _=o[l];if(++l,-1==_){a=s;break}if(!e.howl.playing(_)){a=s;break}++s}if(-1!=a)e.current_ids[a]=r.play(),e.cursor=0;else{var p=e.current_ids[e.cursor];r.stop(p),r.play(p),e.cursor++,e.cursor>=e.current_ids.length&&(e.cursor=0)}null!=Ct.capture_control_for_sounds&&Nt.captureSound(Ct.capture_control_for_sounds,e.name,-1!=n?n:e.howl.volume())}},Ms.stopSound=function(e){if(null!=e)for(var t=0,n=e.current_ids;t<n.length;){var i=n[t];++t,-1!=i&&e.howl.playing(i)&&e.howl.stop(i)}},Ms.playMusic=function(e){null!=e&&(e.state=Cs.Playing,e.played_once=!0)},Ms.isMusicPlaying=function(e){return null!=e&&(e.state==Cs.Playing||e.state==Cs.FadeIn)},Ms.replayMusic=function(e){null!=e&&(e.state=Cs.Playing)},Ms.stopMusic=function(e){null!=e&&(e.state=Cs.Paused,e.howl.playing()&&e.howl.stop())},Ms.pauseMusic=function(e){null!=e&&(e.state=Cs.Paused)},Ms.fadeInMusic=function(e,t){null==t&&(t=.016666666666666666),null!=e&&(e.state=Cs.FadeIn,e.fade_step=t)},Ms.fadeOutMusic=function(e,t){null==t&&(t=.016666666666666666),null!=e&&(e.state=Cs.FadeOut,e.fade_step=t)},Ms.setVolume=function(e,t){null==t&&(t=1),null!=e&&(e.current_volume=t,e.howl.volume(e.current_volume,e.id))},Ms.updateMusic=function(e,t){if(null!=e)if(e.marked_as_updated=!0,t){var n=e.state;switch(d.enumIndex(n)){case 0:e.have_id?e.howl.playing(e.id)||e.howl.play(e.id):(e.have_id=!0,e.id=e.howl.play()),e.current_volume<e.max_volume&&(e.current_volume+=e.fade_step),e.current_volume>=e.max_volume&&(e.current_volume=e.max_volume,e.state=Cs.Playing),e.howl.volume(e.current_volume,e.id);break;case 1:e.have_id&&e.howl.playing(e.id)?(0<e.current_volume&&(e.current_volume-=e.fade_step),e.current_volume<=0&&(e.current_volume=0,e.howl.pause(e.id),e.state=Cs.Paused),e.howl.volume(e.current_volume,e.id)):(e.state=Cs.Paused,e.current_volume=0);break;case 2:e.have_id?e.howl.playing(e.id)||e.howl.play(e.id):(e.have_id=!0,e.id=e.howl.play()),e.current_volume!=e.max_volume&&(e.current_volume=e.max_volume,e.howl.volume(e.current_volume,e.id));break;case 3:e.have_id&&e.howl.playing(e.id)&&e.howl.pause(e.id)}}else{e.have_id&&e.howl.playing(e.id)&&e.howl.pause(e.id);var i=e.state;switch(d.enumIndex(i)){case 0:e.state=Cs.Playing;break;case 1:e.state=Cs.Paused}}},Ms.updateMusicPause=function(e){null!=e&&(e.marked_as_updated||(null!=e.howl?e.howl.playing()&&e.howl.pause():Nl.trace("warning: music.howl == null",{fileName:"SoundDo.hx",lineNumber:304,className:"bikas.sound.SoundDo",methodName:"updateMusicPause"})),e.marked_as_updated=!1)};var Is=function(){this.finished=!1,this.current_drawn_rect_count=0,this.bitmap_offset_y=0,this.bitmap_offset_x=0,this.canvas_ctx=null,this.canvas_tile=null,this.ctx=null,this.canvas=null,this.pattern=null};(n["bikas.terrain.Terrain"]=Is).__name__=["bikas","terrain","Terrain"],Is.prototype={bounds:null,all_terrain_rects:null,tile_texture_width:null,tile_texture_height:null,terrain_bitmap_width:null,terrain_bitmap_height:null,sub_cuts_x:null,sub_cuts_y:null,spacing:null,last_width:null,last_height:null,pattern:null,canvas:null,ctx:null,canvas_tile:null,canvas_ctx:null,bitmap_offset_x:null,bitmap_offset_y:null,current_drawn_rect_count:null,finished:null,base_texture:null,__class__:Is};var Ts=function(){};(n["bikas.terrain.SpriteObject"]=Ts).__name__=["bikas","terrain","SpriteObject"],Ts.prototype={texture:null,x:null,y:null,global_x:null,global_y:null,width:null,height:null,global_bounds:null,__class__:Ts};var As=function(){this.texture=null,this.base_texture_rect=null,this.original_rect=null,this.cuts=null};(n["bikas.terrain.TerrainRect"]=As).__name__=["bikas","terrain","TerrainRect"],As.prototype={fully_in:null,rect:null,texture_rect:null,cuts:null,original_rect:null,base_texture_rect:null,texture:null,__class__:As};var Ds=function(){this.height=512,this.width=512,this.index_y=0,this.index_x=0,this.index_x_y=0};(n["bikas.terrain.TextureRect"]=Ds).__name__=["bikas","terrain","TextureRect"],Ds.prototype={index_x_y:null,index_x:null,index_y:null,width:null,height:null,__class__:Ds};var Es=function(){};(n["bikas.terrain.TerrainDo"]=Es).__name__=["bikas","terrain","TerrainDo"],Es.create=function(e,t,n){var i=new Is,r=0;Es.debug_print_time_and_texture_size&&(r=Ma.getTimer()),i.bounds=ns.getBoundsFromSeveralPolygons(e);var a=i.bounds.max_x-i.bounds.min_x,s=i.bounds.max_y-i.bounds.min_y;i.tile_texture_width=Math.round(n.width),i.tile_texture_height=Math.round(n.height);for(var l=Math.floor(i.bounds.min_x),o=Math.floor(i.bounds.min_y),_=Math.ceil(a/i.tile_texture_width),u=Math.ceil(s/i.tile_texture_height),h=Es.cutAreaIntoRectangles(e,l,o,i.tile_texture_width,i.tile_texture_height,_,u,t),c=0;c<h.length;){var d=h[c];++c,d.texture_rect.index_x_y=0,d.texture_rect.index_x=0,d.texture_rect.index_y=0,d.texture_rect.width=i.tile_texture_width,d.texture_rect.height=i.tile_texture_height,d.original_rect=d}Es.debug_print_stats&&(Nl.trace("----------------------",{fileName:"TerrainDo.hx",lineNumber:75,className:"bikas.terrain.TerrainDo",methodName:"create"}),Nl.trace("total bounds: "+p.string(ma.boundsToRectangle(i.bounds)),{fileName:"TerrainDo.hx",lineNumber:76,className:"bikas.terrain.TerrainDo",methodName:"create"}),Nl.trace("cut_bottom_y: "+t,{fileName:"TerrainDo.hx",lineNumber:77,className:"bikas.terrain.TerrainDo",methodName:"create"}),Nl.trace("",{fileName:"TerrainDo.hx",lineNumber:78,className:"bikas.terrain.TerrainDo",methodName:"create"}),Nl.trace("first cut",{fileName:"TerrainDo.hx",lineNumber:79,className:"bikas.terrain.TerrainDo",methodName:"create"}),Es.printStats(h));var m=i.sub_cuts_x=[256,128,64,32],f=i.sub_cuts_y=m.slice();i.all_terrain_rects=[],i.all_terrain_rects.push(h);for(var g=0,v=m.length;g<v;){var b=g++,y=m[b],x=f[b],z=512,w=512;0<b&&(z=m[b-1],w=f[b-1]);var k=Es.cutIntoSubAreas(i.all_terrain_rects[b],z,w,y,x,t);i.all_terrain_rects.push(k),Es.debug_print_stats&&(Nl.trace("",{fileName:"TerrainDo.hx",lineNumber:108,className:"bikas.terrain.TerrainDo",methodName:"create"}),Nl.trace("index: "+b,{fileName:"TerrainDo.hx",lineNumber:109,className:"bikas.terrain.TerrainDo",methodName:"create"}),Es.printStats(k))}var S=function(e,t){for(var n=0,i=0;i<e.length;){var r=e[i];++i,r.fully_in==t&&++n}return n};if(Es.debug_print_stats){for(var C=0,N=0,P=i.all_terrain_rects.length;N<P;){var M=N++;C+=S(i.all_terrain_rects[M],!0),M==i.all_terrain_rects.length-1&&(C+=S(i.all_terrain_rects[M],!1))}Nl.trace("",{fileName:"TerrainDo.hx",lineNumber:132,className:"bikas.terrain.TerrainDo",methodName:"create"}),Nl.trace("total_image_count: "+C,{fileName:"TerrainDo.hx",lineNumber:133,className:"bikas.terrain.TerrainDo",methodName:"create"}),Nl.trace("total_image_count for 5 minutes: "+60*C*5/15,{fileName:"TerrainDo.hx",lineNumber:134,className:"bikas.terrain.TerrainDo",methodName:"create"})}var I=0;if(Es.debug_print_time_and_texture_size&&(I=Ma.getTimer()-r),0<i.all_terrain_rects.length){var T=i.all_terrain_rects[i.all_terrain_rects.length-1];0<T.length?(i.last_width=T[0].texture_rect.width,i.last_height=T[0].texture_rect.height):(i.last_width=0,i.last_height=0);var A=i.last_width,D=i.last_height,E=i.spacing=4,O=S(T,!1)*(A+E)*(D+E)+(Math.ceil((i.tile_texture_width+E+Es.bleeding_fix)/(A+E+Es.bleeding_fix))*(A+E+Es.bleeding_fix)+E+Es.bleeding_fix)*(Math.ceil((i.tile_texture_height+E+Es.bleeding_fix)/(D+E+Es.bleeding_fix))*(D+E+Es.bleeding_fix)+E+Es.bleeding_fix),B=function(e,t){for(var n=0;n<t.length;){var i=t[n];if(++n,e<i.width*i.height)return i}return null}(O,[new aa(512,512),new aa(1024,512),new aa(1024,1024),new aa(2048,1024),new aa(2048,2048),new aa(4096,2048),new aa(4096,4096)]);if(null==B){var L=Math.round(Math.sqrt(O));return Nl.trace("warning: too many cuts, cut_area = "+O+" (~"+L+"x"+L+")",{fileName:"TerrainDo.hx",lineNumber:195,className:"bikas.terrain.TerrainDo",methodName:"create"}),null}i.terrain_bitmap_width=Math.round(B.width),i.terrain_bitmap_height=Math.round(B.height),Es.debug_print_stats&&Nl.trace("width and height: "+i.terrain_bitmap_width+"x"+i.terrain_bitmap_height,{fileName:"TerrainDo.hx",lineNumber:203,className:"bikas.terrain.TerrainDo",methodName:"create"}),i.canvas=lo.get_document().createElement("canvas"),i.canvas.width=i.terrain_bitmap_width,i.canvas.height=i.terrain_bitmap_height,i.ctx=i.canvas.getContext("2d");var j=Math.round(n.width),F=Math.round(n.height),R=Es.bleeding_fix,G=i.ctx,Z=lo.get_document().createElement("canvas");Z.width=Math.round(n.width+Es.bleeding_fix),Z.height=Math.round(n.height+Es.bleeding_fix);var U=Z.getContext("2d",null),V=n.width+Es.bleeding_fix,q=n.height+Es.bleeding_fix;U.drawImage(n.baseTexture.source,n.frame.x,n.frame.y,n.frame.width,n.frame.height,0,0,V,q),Nl.trace("temp_b_canvas.width: "+Z.width,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.terrain.TerrainDo",methodName:"create"}),Nl.trace("temp_b_canvas.height: "+Z.height,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.terrain.TerrainDo",methodName:"create"}),G.drawImage(Z,0,F-R,j,R,R,0,j,R),G.drawImage(Z,j-R,0,R,F,0,R,R,F),G.drawImage(Z,0,0,j,F,R,R,j,F),G.drawImage(Z,0,0,R,F,j+R,R,R,F),G.drawImage(Z,0,0,j,R,R,F+R,j,R),G.drawImage(Z,j-R,F-R,R,R,0,0,R,R),G.drawImage(Z,0,F-R,R,R,j+R,0,R,R),G.drawImage(Z,0,0,R,R,j+R,F+R,R,R),G.drawImage(Z,j-R,0,R,R,0,F+R,R,R);var W=j+2*R,X=F+2*R;return i.canvas_tile=lo.get_document().createElement("canvas"),i.canvas_tile.width=W,i.canvas_tile.height=X,i.canvas_ctx=i.canvas_tile.getContext("2d"),i.canvas_ctx.drawImage(i.canvas,0,0,W,X,0,0,W,X),i.pattern=G.createPattern(i.canvas_tile,"no-repeat"),i.ctx.fillStyle=i.pattern,i.current_drawn_rect_count=0,i.finished=!1,i.bitmap_offset_x=0,i.bitmap_offset_y=0,Es.debug_print_time_and_texture_size&&Nl.trace("calculation time:"+I+"ms, terrain size:"+i.terrain_bitmap_width+"x"+i.terrain_bitmap_height,{fileName:"TerrainDo.hx",lineNumber:311,className:"bikas.terrain.TerrainDo",methodName:"create"}),i}return null},Es.getCutCount=function(e){return e.all_terrain_rects[e.all_terrain_rects.length-1].length},Es.drawPortionOfTerrainRects=function(e,t){var n=e.all_terrain_rects[e.all_terrain_rects.length-1],i=(e.canvas,e.ctx),r=(e.pattern,e.spacing),a=e.last_width,s=e.last_height,l=e.current_drawn_rect_count,o=l+t;o>n.length&&(o=n.length);for(var _=e.bitmap_offset_x,p=e.bitmap_offset_y,u=l,h=o;u<h;){var c=n[u++];if(!c.fully_in){if(p<e.tile_texture_height&&_<e.tile_texture_width&&(_=e.tile_texture_width+r+Es.bleeding_fix),p+s>e.terrain_bitmap_height){Nl.trace("(bitmap_offset_y + height): "+(p+s),{fileName:"TerrainDo.hx",lineNumber:357,className:"bikas.terrain.TerrainDo",methodName:"drawPortionOfTerrainRects"}),Nl.trace("warning: something went wrong with terrain drawing",{fileName:"TerrainDo.hx",lineNumber:358,className:"bikas.terrain.TerrainDo",methodName:"drawPortionOfTerrainRects"});break}for(var d=c.texture_rect.index_x,m=c.texture_rect.index_y,f=Math.round(d*a)+Es.bleeding_fix,g=Math.round(m*s)+Es.bleeding_fix,v=0,b=c.cuts;v<b.length;){var y=b[v];++v;var x=y[0].x-c.rect.x,z=y[0].y-c.rect.y;if(x<-Es.bleeding_fix||x>a+Es.bleeding_fix||z<-Es.bleeding_fix||z>s+Es.bleeding_fix){Nl.trace("warning: first_point_x: "+x+", first_point_y: "+z+" is outside of rect",{fileName:"TerrainDo.hx",lineNumber:377,className:"bikas.terrain.TerrainDo",methodName:"drawPortionOfTerrainRects"});break}i.beginPath(),i.moveTo(x+_,z+p);for(var w=1,k=y.length;w<k;){var S=w++,C=y[S].x-c.rect.x,N=y[S].y-c.rect.y;(C<-Es.bleeding_fix||C>a+Es.bleeding_fix||N<-Es.bleeding_fix||N>s+Es.bleeding_fix)&&Nl.trace("warning: x: "+C+", y:"+N+" is outside of rect",{fileName:"TerrainDo.hx",lineNumber:389,className:"bikas.terrain.TerrainDo",methodName:"drawPortionOfTerrainRects"}),i.lineTo(C+_,N+p)}i.save(),i.translate(_-f,p-g),i.closePath(),i.fill(),i.restore()}c.base_texture_rect=new PIXI.Rectangle(_,p,a,s),(_+=a+r)+a>=e.terrain_bitmap_width&&(p+=s+(_=r))}}return e.bitmap_offset_x=_,e.bitmap_offset_y=p,e.current_drawn_rect_count=o,n.length==o?e.finished=!0:e.finished=!1},Es.finish=function(e,t){t>Es.bleeding_fix&&Nl.trace("warning: adding more texture_offset_add: "+t+" than bleeding_fix can support: "+Es.bleeding_fix,{fileName:"TerrainDo.hx",lineNumber:437,className:"bikas.terrain.TerrainDo",methodName:"finish"}),e.base_texture=PIXI.BaseTexture.fromCanvas(e.canvas),e.canvas=null,e.ctx=null,e.canvas_tile=null,e.canvas_ctx=null,e.pattern=null;for(var n=e.base_texture.width,i=e.base_texture.height,r=e.all_terrain_rects[e.all_terrain_rects.length-1],a=0;a<r.length;){var s=r[a];if(++a,!s.fully_in){var l=s.base_texture_rect.x-t,o=s.base_texture_rect.y-t,_=s.base_texture_rect.width+2*t,p=s.base_texture_rect.height+2*t;l<0&&(l=0,_-=t),o<0&&(o=0,p-=t),n<l+_&&(_=n-l),i<o+p&&(p=i-o),s.texture=new PIXI.Texture(e.base_texture,new PIXI.Rectangle(l,o,_,p))}}for(var u=e.sub_cuts_x,h=e.sub_cuts_y,c=[],d=0,m=u.length;d<m;){for(var f=d++,g=u[f],v=h[f],b=Math.round(e.tile_texture_width/v),y=Math.round(e.tile_texture_height/v),x=[],z=0,w=b;z<w;)for(var k=z++,S=0,C=y;S<C;){var N=S++,P=k*v+Es.bleeding_fix-t,M=N*v+Es.bleeding_fix-t,I=g+2*t,T=v+2*t;P<0&&(P=0,I-=t),M<0&&(M=0,T-=t),n<P+I&&(I=n-P),i<M+T&&(T=i-M);var A=new PIXI.Texture(e.base_texture,new PIXI.Rectangle(P,M,I,T));x.push(A)}c.push(x)}Es.bleeding_fix,Es.bleeding_fix;var D=e.tile_texture_width+2*t,E=e.tile_texture_height+2*t;Nl.trace("terrain.base_texture.width: "+e.base_texture.width,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.terrain.TerrainDo",methodName:"finish"}),Nl.trace("terrain.base_texture.height: "+e.base_texture.height,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.terrain.TerrainDo",methodName:"finish"}),Nl.trace("texture_width: "+D,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.terrain.TerrainDo",methodName:"finish"}),Nl.trace("texture_height: "+E,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.terrain.TerrainDo",methodName:"finish"}),Nl.trace("TODO: full original texture might be wrong!",{fileName:"TerrainDo.hx",lineNumber:542,className:"bikas.terrain.TerrainDo",methodName:"finish"});for(var O=new PIXI.Texture(e.base_texture,new PIXI.Rectangle(0,0,D,E)),B=0,L=e.all_terrain_rects[0];B<L.length;){var j=L[B];++B,j.texture=O}for(var F=0,R=u.length;F<R;)for(var G=F++,Z=c[G],U=0,V=e.all_terrain_rects[G+1];U<V.length;){var q=V[U];if(++U,q.fully_in)if(null==q.texture_rect)Nl.trace("warning: no texture_rect",{fileName:"TerrainDo.hx",lineNumber:555,className:"bikas.terrain.TerrainDo",methodName:"finish"});else if(Z.length<=q.texture_rect.index_x_y)Nl.trace("warning: not enough textures, index_x_y: "+q.texture_rect.index_x_y+", textures.length: "+Z.length,{fileName:"TerrainDo.hx",lineNumber:558,className:"bikas.terrain.TerrainDo",methodName:"finish"});else{var W=Z[q.texture_rect.index_x_y];q.texture=W}}if(Es.debug_print_stats,Es.debug_add_base_texture_to_stage){var X=new PIXI.Texture(e.base_texture),H=qa.createSprite(X);H.anchor.x=0,H.anchor.y=0,H.scale.x=.25,H.scale.y=.25,H.x=60,H.y=10,$s.game.addChild(H)}},Es.createTerrainRect=function(){if(0<Es.destroyed_terrain_rect_list.length)return Es.destroyed_terrain_rect_list.pop();var e=new As;return e.rect=new na,e.texture_rect=new Ds,e},Es.destroy=function(e){for(var t=0,n=e.all_terrain_rects;t<n.length;){var i=n[t];++t;for(var r=0;r<i.length;){var a=i[r];if(++r,(a.base_texture_rect=null)!=a.cuts)for(var s=0,l=a.cuts;s<l.length;){var o=l[s];++s;for(var _=0;_<o.length;){var p=o[_];++_,ea.destroy(p)}}a.cuts=null,(a.original_rect=null)!=a.texture&&(a.texture.destroy(!1),a.texture=null),$r.validate_reusable_objects&&-1!=Es.destroyed_terrain_rect_list.indexOf(a)?Nl.trace("warning: object is already added to destroyed list",{fileName:"TerrainDo.hx",lineNumber:636,className:"bikas.terrain.TerrainDo",methodName:"destroy"}):Es.destroyed_terrain_rect_list.push(a)}}(e.all_terrain_rects=null)!=e.base_texture&&(e.base_texture.destroy(),e.base_texture=null)},Es.createSpriteObject=function(){if(0<Es.destroyed_sprite_object_list.length)return Es.destroyed_sprite_object_list.pop();var e=new Ts;return e.global_bounds=new ia,e},Es.destroySpriteObject=function(e){e.texture=null,$r.validate_reusable_objects&&-1!=Es.destroyed_sprite_object_list.indexOf(e)?Nl.trace("warning: object is already added to destroyed list",{fileName:"TerrainDo.hx",lineNumber:675,className:"bikas.terrain.TerrainDo",methodName:"destroySpriteObject"}):Es.destroyed_sprite_object_list.push(e)},Es.createSpriteObjects=function(e,t,n,i){for(var r=[],a=0;a<e.length;){var s=e[a];++a;for(var l=0;l<s.length;){var o=s[l];if(++l,o.fully_in)if(null==o.texture)Nl.trace("warning: rect with no texture (width:"+o.texture_rect.width+", index_x_y:"+o.texture_rect.width+")",{fileName:"TerrainDo.hx",lineNumber:692,className:"bikas.terrain.TerrainDo",methodName:"createSpriteObjects"});else{var _=o.rect.x-i,p=o.rect.y-i,u=Es.createSpriteObject();u.x=_,u.y=p,u.texture=o.texture,u.global_x=_+t,u.global_y=p+n,u.width=u.texture.width,u.height=u.texture.height,u.global_bounds.min_x=u.global_x,u.global_bounds.min_y=u.global_y,u.global_bounds.max_x=u.global_x+u.width,u.global_bounds.max_y=u.global_y+u.height,r.push(u)}}}if(0<e.length)for(var h=e[e.length-1],c=0;c<h.length;){var d=h[c];if(++c,null==d.texture)Nl.trace("warning: rect with no texture (width:"+d.texture_rect.width+", index_x_y:"+d.texture_rect.width+")",{fileName:"TerrainDo.hx",lineNumber:731,className:"bikas.terrain.TerrainDo",methodName:"createSpriteObjects"});else if(!d.fully_in){var m=d.rect.x-i,f=d.rect.y-i,g=Es.createSpriteObject();g.x=m,g.y=f,g.texture=d.texture,g.global_x=m+t,g.global_y=f+n,g.width=g.texture.width,g.height=g.texture.height,g.global_bounds.min_x=g.global_x,g.global_bounds.min_y=g.global_y,g.global_bounds.max_x=g.global_x+g.width,g.global_bounds.max_y=g.global_y+g.height,r.push(g)}}return r},Es.createSprites=function(e){for(var t=[],n=0;n<e.length;){var i=e[n];++n;var r=qa.createSprite(i.texture,0,0,i.global_x,i.global_y);t.push(r)}return t},Es.printStats=function(e){for(var t=0,n=0,i=0,r=0,a=0;a<e.length;){var s=e[a];++a,++t,s.fully_in?++n:(++i,r+=s.rect.width*s.rect.height)}0<e.length&&Nl.trace("\ttexture: "+e[0].texture_rect.width+"x"+e[0].texture_rect.height,{fileName:"TerrainDo.hx",lineNumber:795,className:"bikas.terrain.TerrainDo",methodName:"printStats"}),Nl.trace("\ttotal count: "+t,{fileName:"TerrainDo.hx",lineNumber:797,className:"bikas.terrain.TerrainDo",methodName:"printStats"}),Nl.trace("\tfilled count: "+n,{fileName:"TerrainDo.hx",lineNumber:798,className:"bikas.terrain.TerrainDo",methodName:"printStats"}),Nl.trace("\tcut count: "+i,{fileName:"TerrainDo.hx",lineNumber:799,className:"bikas.terrain.TerrainDo",methodName:"printStats"});var l=Math.round(r/4194304*100*10)/10;Nl.trace("\ttotal area of cuts: "+l+"% of 2048x2048",{fileName:"TerrainDo.hx",lineNumber:801,className:"bikas.terrain.TerrainDo",methodName:"printStats"});var o=Math.round(r/16777216*100*10)/10;Nl.trace("\ttotal area of cuts: "+o+"% of 4096x4096",{fileName:"TerrainDo.hx",lineNumber:803,className:"bikas.terrain.TerrainDo",methodName:"printStats"}),Nl.trace("\tapprox for 5 minutes: "+Math.round(300*l/15)+"% of 2048x2048",{fileName:"TerrainDo.hx",lineNumber:804,className:"bikas.terrain.TerrainDo",methodName:"printStats"}),Nl.trace("\tapprox for 5 minutes: "+Math.round(300*o/15)+"% of 4096x4096",{fileName:"TerrainDo.hx",lineNumber:805,className:"bikas.terrain.TerrainDo",methodName:"printStats"})},Es.cutIntoSubAreas=function(e,t,n,i,r,a){for(var s=Math.round(t/i),l=Math.round(n/r),o=[],_=0;_<e.length;){var p=e[_];if(++_,!p.fully_in)for(var u=Es.cutAreaIntoRectangles(p.cuts,p.rect.x,p.rect.y,i,r,s,l,a),h=0;h<u.length;){var c=u[h];++h,c.original_rect=p.original_rect;var d=Math.round((c.rect.x-c.original_rect.rect.x)/i),m=Math.round((c.rect.y-c.original_rect.rect.y)/r),f=d*Math.round(c.original_rect.texture_rect.height/r)+m,g=i,v=r;c.texture_rect.index_x_y=f,c.texture_rect.index_x=d,c.texture_rect.index_y=m,c.texture_rect.width=g,c.texture_rect.height=v,o.push(c)}}return o},Es.cutAreaIntoRectangles=function(e,t,n,i,r,a,s,l){for(var o=[],_=0,p=a;_<p;)for(var u=_++,h=0,c=s;h<c;){for(var d=h++,m=u*i+Math.floor(t),f=m+i,g=d*r+Math.floor(n),v=g+r,b=new na(m-Es.bleeding_fix,g-Es.bleeding_fix,i+2*Es.bleeding_fix,r+2*Es.bleeding_fix),y=[],x=0;x<e.length;){var z=e[x];++x;var w=rs.clip(z,Math.round(g)-Es.bleeding_fix,Math.round(f)+Es.bleeding_fix,Math.round(v)+Es.bleeding_fix,Math.round(m)-Es.bleeding_fix);null!=w&&y.push(w)}if(0<y.length){var k=!1;if(1==y.length&&4==y[0].length){for(var S=y[0][0],C=y[0][0],N=0,P=y[0];N<P.length;){var M=P[N];++N,M.x<=S.x&&M.y<=S.y&&(S=M),M.x>=C.x&&M.y>=C.y&&(C=M)}var I=ma.createRectangleFrom2Points(S,C);ma.rectanglesEqual(b,I)&&(k=!0)}var T=Es.createTerrainRect();if(T.rect.x=m,T.rect.y=g,T.rect.width=i,T.rect.height=r,!(T.fully_in=k))if(ns.getBoundsFromSeveralPolygons(y).min_y>l){T.fully_in=!0;for(var A=0;A<y.length;){var D=y[A];++A;for(var E=0;E<D.length;){var O=D[E];++E,ea.destroy(O)}}}else T.cuts=y;o.push(T)}}return o};var Os=function(){};(n["bikas.top.SitelockType"]=Os).__name__=["bikas","top","SitelockType"];var Bs=function(){this.show_performance_information=!1,this.show_build_information=!1,this.add_complete_all_levels=!1,this.add_clear_rewarded_ads_in_pause_menu=!1,this.add_race_finish_button_in_pause_menu=!1,this.add_gameplay_bot_button_in_pause_menu=!1,this.is_demo=!1,this.google_analytics_enabled=0,this.music_enabled=!0,this.sounds_enabled=!0,this.famobi_disable_debug_output=!0,this.sitelock_poki_debug_enabled=!1,this.game_exit=!1,this.sitelock_type=4};(n["bikas.top.GameReleaseConfig"]=Bs).__name__=["bikas","top","GameReleaseConfig"],Bs.prototype={sitelock_type:null,game_exit:null,sitelock_poki_debug_enabled:null,famobi_disable_debug_output:null,sounds_enabled:null,music_enabled:null,google_analytics_enabled:null,is_demo:null,add_gameplay_bot_button_in_pause_menu:null,add_race_finish_button_in_pause_menu:null,add_clear_rewarded_ads_in_pause_menu:null,add_complete_all_levels:null,show_build_information:null,show_performance_information:null,__class__:Bs};var Ls=function(){this.force_fixed_timestep=!1,this.force_canvas=!1,this.force_size=new aa(720,405),this.force_running_game_while_unfocused=!0,this.reduce_visible_bounds_by_100_pixels=!1,this.render_markers=!1,this.fixed_camera_zoom=-1,this.manual_camera_control=!1,this.trace_explosive_barrel_event=!1,this.trace_obstacle_break_event=!1,this.filter_out_interactive_objects=!1,this.filter_out_bots=!1,this.bot_decisions_enabled=!0,this.bots_enabled=!0,this.use_editor_cars=!1,this.race_countdown_enabled=!1,this.transitions_enabled=!1,this.loader_enabled=!1,this.game_preloader_enabled=!1,this.show_editor_first=!0,this.editor_enabled=!0,this.show_same_debug_buttons_in_pause_menu_as_release=!0,this.show_performance_information=!0,this.show_build_information=!0,this.show_update_times=!0,this.test_famobi_mobile_controls=!1,this.capture_mode=!1,this.music_enabled=!1,this.sounds_enabled=!1};(n["bikas.top.GameDevelopmentConfig"]=Ls).__name__=["bikas","top","GameDevelopmentConfig"],Ls.prototype={sounds_enabled:null,music_enabled:null,capture_mode:null,test_famobi_mobile_controls:null,show_update_times:null,show_build_information:null,show_performance_information:null,show_same_debug_buttons_in_pause_menu_as_release:null,editor_enabled:null,show_editor_first:null,game_preloader_enabled:null,loader_enabled:null,transitions_enabled:null,race_countdown_enabled:null,use_editor_cars:null,bots_enabled:null,bot_decisions_enabled:null,filter_out_bots:null,filter_out_interactive_objects:null,trace_obstacle_break_event:null,trace_explosive_barrel_event:null,manual_camera_control:null,fixed_camera_zoom:null,render_markers:null,reduce_visible_bounds_by_100_pixels:null,force_running_game_while_unfocused:null,force_size:null,force_canvas:null,force_fixed_timestep:null,__class__:Ls};var js=function(){};(n["bikas.top.ConfigType"]=js).__name__=["bikas","top","ConfigType"];var Fs=n["bikas.top.ControlType"]={__ename__:["bikas","top","ControlType"],__constructs__:["ControlFastWheel","ControlSlowRotateButtons","ControlSlowRotateButtonsSide"]};Fs.ControlFastWheel=["ControlFastWheel",0],Fs.ControlFastWheel.toString=i,(Fs.ControlFastWheel.__enum__=Fs).ControlSlowRotateButtons=["ControlSlowRotateButtons",1],Fs.ControlSlowRotateButtons.toString=i,(Fs.ControlSlowRotateButtons.__enum__=Fs).ControlSlowRotateButtonsSide=["ControlSlowRotateButtonsSide",2],Fs.ControlSlowRotateButtonsSide.toString=i,(Fs.ControlSlowRotateButtonsSide.__enum__=Fs).__empty_constructs__=[Fs.ControlFastWheel,Fs.ControlSlowRotateButtons,Fs.ControlSlowRotateButtonsSide];var Rs=function(){this.development=new Ls,this.release=new Bs,this.control_type=Fs.ControlFastWheel,this.type=0};(n["bikas.top.GameConfig"]=Rs).__name__=["bikas","top","GameConfig"],Rs.prototype={type:null,control_type:null,release:null,development:null,__class__:Rs};var Gs=function(){};(n["bikas.top.GameAssets"]=Gs).__name__=["bikas","top","GameAssets"];var Zs=function(){};(n["bikas.top.LevelDataSave"]=Zs).__name__=["bikas","top","LevelDataSave"],Zs.prototype={name:null,data:null,__class__:Zs};var Us=function(){};(n["bikas.top.PreloaderGraphics"]=Us).__name__=["bikas","top","PreloaderGraphics"],Us.prototype={container:null,background:null,middle_container:null,title:null,loader_background:null,loader_foreground:null,play_button:null,play_button_click_callback:null,__class__:Us};var Vs=function(e,t,n,i,r){null==r&&(r=!0),this.included=!0,this.type=e,this.file_path=t,this.file_name=n,this.file_extension=i,this.included=r};(n["bikas.top.LoaderPackFile"]=Vs).__name__=["bikas","top","LoaderPackFile"],Vs.prototype={type:null,file_path:null,file_name:null,file_extension:null,included:null,__class__:Vs};var qs=n["bikas.top.LoaderPackType"]={__ename__:["bikas","top","LoaderPackType"],__constructs__:["Text","Image","Binary","BitmapFont","AtlasJSONArray","Sound","SoundLoop"]};qs.Text=["Text",0],qs.Text.toString=i,(qs.Text.__enum__=qs).Image=["Image",1],qs.Image.toString=i,(qs.Image.__enum__=qs).Binary=["Binary",2],qs.Binary.toString=i,(qs.Binary.__enum__=qs).BitmapFont=["BitmapFont",3],qs.BitmapFont.toString=i,(qs.BitmapFont.__enum__=qs).AtlasJSONArray=["AtlasJSONArray",4],qs.AtlasJSONArray.toString=i,(qs.AtlasJSONArray.__enum__=qs).Sound=["Sound",5],qs.Sound.toString=i,(qs.Sound.__enum__=qs).SoundLoop=["SoundLoop",6],qs.SoundLoop.toString=i,(qs.SoundLoop.__enum__=qs).__empty_constructs__=[qs.Text,qs.Image,qs.Binary,qs.BitmapFont,qs.AtlasJSONArray,qs.Sound,qs.SoundLoop];var Ws=function(){this.next_pack=null,this.name_to_howl_map=new Ll,this.loaded_howls=[],this.preload_howls=[],this.pixi_loader_finished=!1,this.finished=!1,this.on_finish=null,this.names=[]};(n["bikas.top.LoaderPack"]=Ws).__name__=["bikas","top","LoaderPack"],Ws.prototype={names:null,size_coeff:null,on_finish:null,finished:null,loader:null,pixi_loader_finished:null,preload_howls:null,loaded_howls:null,name_to_howl_map:null,next_pack:null,__class__:Ws};var Xs=function(){this.finished=!1,this.transition_current_time=0};(n["bikas.top.GameLoader"]=Xs).__name__=["bikas","top","GameLoader"],Xs.prototype={transition_current_time:null,on_transition_out_finished:null,finished:null,preloader_graphics:null,loader_pack_list:null,load_callback:null,play_callback:null,__class__:Xs};var Hs=function(){};(n["bikas.top.GameAssetsDo"]=Hs).__name__=["bikas","top","GameAssetsDo"],Hs.init=function(e,t,n,i,r,a,l){var o=Hs.createGameLoader(a,l);e.loader=o;var u=function(){o.preloader_graphics.container.position.x=0,o.preloader_graphics.container.position.y=0,o.preloader_graphics.background.position.x=-5,o.preloader_graphics.background.position.y=-5,o.preloader_graphics.background.width=e.current_game_width+10,o.preloader_graphics.background.height=e.current_game_height+10,o.preloader_graphics.middle_container.position.x=e.current_game_width/2,o.preloader_graphics.middle_container.position.y=e.current_game_height/2},h=function(e,t){if(!t.included)return"";var n=t.type,i=t.file_path,r=t.file_name,a=t.file_extension;e.names.push(r);var s=i+r+"."+a;if(n==qs.Text)e.loader.add(r,s);else if(n==qs.Image)e.loader.add(r,s);else if(n==qs.Binary)e.loader.add(r,s);else if(n==qs.BitmapFont){var l=i+r+".fnt";e.loader.add(r,l)}else if(n==qs.AtlasJSONArray){var o=i+r+".json";e.loader.add(r,o,null)}else if(n==qs.Sound||n==qs.SoundLoop){var _=[i+r+".ogg",i+r+".m4a"],u=!1;n==qs.SoundLoop&&(u=!0);var h=new Howl({preload:!1,loop:u,volume:1,src:_});e.name_to_howl_map.set(r,h),e.preload_howls.push(h)}else Nl.trace("warning: unhandled type "+p.string(n),{fileName:"GameAssetsDo.hx",lineNumber:149,className:"bikas.top.GameAssetsDo",methodName:"init"});return r},c=function(e,t,n,i){var r=new Ws;r.loader=new PIXI.loaders.Loader,r.size_coeff=t,r.on_finish=i,r.finished=!1,0<e.length&&(e[e.length-1].next_pack=r),e.push(r);for(var a=0;a<n.length;){var s=n[a];++a,h(r,s)}return r},d=[],m=c(d,.1,[new Vs(qs.Image,"assets/preloader/","preloader_game_loader_background","png"),new Vs(qs.Image,"assets/preloader/","preloader_game_loader_foreground","png"),new Vs(qs.Image,"assets/preloader/","preloader_logo_big","png"),new Vs(qs.Image,"assets/preloader/","preloader_play_button_normal","png"),new Vs(qs.Image,"assets/preloader/","preloader_play_button_pressed","png"),new Vs(qs.Image,"assets/preloader/","preloader_title_background","png"),new Vs(qs.Image,"assets/preloader/","tile_separate","png"),new Vs(qs.Image,"assets/preloader/","tile_dark_separate","png"),new Vs(qs.Image,"assets/preloader/","red_border_100x100_separate","png")]),f=!0;1==n.type&&(f=!n.release.is_demo);var g=c(d,.1,[new Vs(qs.Text,"assets/saves/","library","befgl"),new Vs(qs.Text,"assets/saves/","main_menu","befgs"),new Vs(qs.Text,"assets/saves/","inter_level_menu","befgs"),new Vs(qs.Text,"assets/saves/","challenge_escape_from_wolf","befgs"),new Vs(qs.Text,"assets/saves/","challenge_mountain_rush","befgs"),new Vs(qs.Text,"assets/saves/","challenge_balancing","befgs"),new Vs(qs.Text,"assets/saves/","challenge_survival","befgs"),new Vs(qs.Text,"assets/saves/","challenge_bullet_taxi","befgs"),new Vs(qs.Text,"assets/saves/","challenge_hunt_the_prey","befgs"),new Vs(qs.Text,"assets/saves/","challenge_achievement","befgs"),new Vs(qs.Text,"assets/saves/","challenge_credits","befgs"),new Vs(qs.Text,"assets/saves/","level_1","befgs"),new Vs(qs.Text,"assets/saves/","level_2","befgs"),new Vs(qs.Text,"assets/saves/","level_3","befgs"),new Vs(qs.Text,"assets/saves/","level_4","befgs"),new Vs(qs.Text,"assets/saves/","level_5","befgs"),new Vs(qs.Text,"assets/saves/","level_6_dip","befgs"),new Vs(qs.Text,"assets/saves/","level_7","befgs"),new Vs(qs.Text,"assets/saves/","level_8","befgs"),new Vs(qs.Text,"assets/saves/","level_9_peak","befgs"),new Vs(qs.Text,"assets/saves/","level_10","befgs",f),new Vs(qs.Text,"assets/saves/","level_11","befgs",f),new Vs(qs.Text,"assets/saves/","level_12","befgs",f),new Vs(qs.Text,"assets/saves/","level_13","befgs",f),new Vs(qs.Text,"assets/saves/","level_14","befgs",f),new Vs(qs.Text,"assets/saves/","level_15","befgs",f),new Vs(qs.Text,"assets/saves/","level_16","befgs",f),new Vs(qs.Text,"assets/saves/","level_17","befgs",f),new Vs(qs.Text,"assets/saves/","level_18","befgs",f),new Vs(qs.Text,"assets/saves/","level_19","befgs",f),new Vs(qs.Text,"assets/saves/","level_20","befgs",f),new Vs(qs.Text,"assets/saves/","level_21","befgs",f),new Vs(qs.Text,"assets/saves/","level_22","befgs",f),new Vs(qs.Text,"assets/saves/","level_23","befgs",f),new Vs(qs.Text,"assets/saves/","level_24","befgs",f),new Vs(qs.Text,"assets/saves/","level_25","befgs",f),new Vs(qs.Text,"assets/saves/","level_26","befgs",f),new Vs(qs.Text,"assets/saves/","level_27","befgs",f),new Vs(qs.Text,"assets/saves/","level_28","befgs",f),new Vs(qs.Text,"assets/saves/","level_29","befgs",f),new Vs(qs.Text,"assets/saves/","level_30","befgs",f)]),v=c(d,.01,[new Vs(qs.Text,"assets/saves/","current_working_files","txt")]),b=c(d,.1,[new Vs(qs.Text,"assets/saves/","background_objects","txt"),new Vs(qs.Text,"assets/animations/","bfanimations","xml")]),y=c(d,1,[new Vs(qs.AtlasJSONArray,"assets/spritesheets/","graphics","json"),new Vs(qs.AtlasJSONArray,"assets/spritesheets/","graphics2","json")]),x=c(d,.1,[new Vs(qs.BitmapFont,"assets/spritesheets/","toonish_36","fnt"),new Vs(qs.BitmapFont,"assets/spritesheets/","consolas_24","fnt"),new Vs(qs.BitmapFont,"assets/spritesheets/","avantgarde_lt_medium_dark_26","fnt"),new Vs(qs.BitmapFont,"assets/spritesheets/","avantgarde_lt_medium_light_26","fnt"),new Vs(qs.BitmapFont,"assets/spritesheets/","bell_gothic_std_black_dark_26","fnt"),new Vs(qs.BitmapFont,"assets/spritesheets/","bell_gothic_std_black_light_26","fnt"),new Vs(qs.BitmapFont,"assets/spritesheets/","bell_gothic_std_black_very_light_26","fnt"),new Vs(qs.BitmapFont,"assets/spritesheets/","bell_gothic_std_bold_dark_26","fnt"),new Vs(qs.BitmapFont,"assets/spritesheets/","bell_gothic_std_bold_light_26","fnt"),new Vs(qs.BitmapFont,"assets/spritesheets/","tw_cen_mt_condensed_extra_bold_dark_29","fnt")]);(0==n.type&&n.development.sounds_enabled||1==n.type&&n.release.sounds_enabled)&&(c(d,1,[new Vs(qs.SoundLoop,"assets/sounds/","car_bug_slow",""),new Vs(qs.SoundLoop,"assets/sounds/","car_bus_slow",""),new Vs(qs.SoundLoop,"assets/sounds/","car_coyote_slow",""),new Vs(qs.SoundLoop,"assets/sounds/","car_farm_truck_slow",""),new Vs(qs.SoundLoop,"assets/sounds/","car_ice_cream_truck_slow",""),new Vs(qs.SoundLoop,"assets/sounds/","car_rider_slow",""),new Vs(qs.SoundLoop,"assets/sounds/","car_rudolf_slow",""),new Vs(qs.SoundLoop,"assets/sounds/","car_semioval_slow",""),new Vs(qs.SoundLoop,"assets/sounds/","car_tourcycle_slow",""),new Vs(qs.Sound,"assets/sounds/","acceleration_boost",""),new Vs(qs.Sound,"assets/sounds/","anchor",""),new Vs(qs.Sound,"assets/sounds/","armor",""),new Vs(qs.Sound,"assets/sounds/","balloons",""),new Vs(qs.Sound,"assets/sounds/","barrel_break",""),new Vs(qs.Sound,"assets/sounds/","board_break",""),new Vs(qs.Sound,"assets/sounds/","box_break",""),new Vs(qs.Sound,"assets/sounds/","coin",""),new Vs(qs.Sound,"assets/sounds/","countdown_number",""),new Vs(qs.Sound,"assets/sounds/","countdown_go",""),new Vs(qs.Sound,"assets/sounds/","explosion",""),new Vs(qs.Sound,"assets/sounds/","jump",""),new Vs(qs.Sound,"assets/sounds/","nitro_pick",""),new Vs(qs.Sound,"assets/sounds/","nitro_use",""),new Vs(qs.Sound,"assets/sounds/","power_pick",""),new Vs(qs.Sound,"assets/sounds/","power_pick2",""),new Vs(qs.Sound,"assets/sounds/","power_roll",""),new Vs(qs.Sound,"assets/sounds/","power_roll_end",""),new Vs(qs.Sound,"assets/sounds/","power_use",""),new Vs(qs.Sound,"assets/sounds/","stunt",""),new Vs(qs.Sound,"assets/sounds/","stunt_point",""),new Vs(qs.Sound,"assets/sounds/","swoosh",""),new Vs(qs.Sound,"assets/sounds/","throw",""),new Vs(qs.Sound,"assets/sounds/","treasure",""),new Vs(qs.Sound,"assets/sounds/","achievement_claimed",""),new Vs(qs.Sound,"assets/sounds/","across_the_line",""),new Vs(qs.Sound,"assets/sounds/","bang",""),new Vs(qs.Sound,"assets/sounds/","buy_car",""),new Vs(qs.Sound,"assets/sounds/","button_click",""),new Vs(qs.Sound,"assets/sounds/","chest_open",""),new Vs(qs.Sound,"assets/sounds/","click",""),new Vs(qs.Sound,"assets/sounds/","level_select",""),new Vs(qs.Sound,"assets/sounds/","menu_phase_in",""),new Vs(qs.Sound,"assets/sounds/","menu_phase_out",""),new Vs(qs.Sound,"assets/sounds/","notification",""),new Vs(qs.Sound,"assets/sounds/","ongoing_power",""),new Vs(qs.Sound,"assets/sounds/","reward_phase_in",""),new Vs(qs.Sound,"assets/sounds/","reward_select",""),new Vs(qs.Sound,"assets/sounds/","score",""),new Vs(qs.Sound,"assets/sounds/","stat_threshold_pass",""),new Vs(qs.Sound,"assets/sounds/","upgrade","")]).on_finish=function(e){for(var t=0,n=e.names;t<n.length;){var i=n[t];++t;var r=1,a=e.name_to_howl_map.get(i);if(null!=a)if("car_"==s.substr(i,0,4)){r=.6;var l=Ms.createMusic(i,a,r);_.setField(Gs,"sound_loop_"+i,l),Gs.all_sound_loops.push(l)}else if("acceleration_boost"==i||"nitro_use"==i||"score"==i){"score"==i?r=.3:"beach_waves"==i&&(r=.2);var o=Ms.createMusic(i,a,r);_.setField(Gs,"sound_loop_"+i,o),Gs.all_sound_loops.push(o)}else{"swoosh"==i&&(r=.5);var p=Ms.createSound(i,a,r,3);_.setField(Gs,"sound_"+i,p),Gs.all_sounds.push(p)}else Nl.trace("warning: "+i+" sound does not have howl",{fileName:"GameAssetsDo.hx",lineNumber:396,className:"bikas.top.GameAssetsDo",methodName:"init"})}}),(0==n.type&&n.development.music_enabled||1==n.type&&n.release.music_enabled)&&(c(d,1,[new Vs(qs.SoundLoop,"assets/sounds/","music_beach_waves",""),new Vs(qs.SoundLoop,"assets/sounds/","music_stereospice_fun_surf_rock_142_sec",""),new Vs(qs.SoundLoop,"assets/sounds/","music_stereospice_fun_surf_rock_92_sec",""),new Vs(qs.SoundLoop,"assets/sounds/","music_avocado_easy_times_in_hawaii","")]).on_finish=function(e){for(var t=0,n=e.names;t<n.length;){var i=n[t];++t;var r=e.name_to_howl_map.get(i);if(null!=r){var a=1;"21831136_driving_indie_beach_rock_guitar_by_skinnyatlasmusic_preview"==i?a=.2:"music_stereospice_fun_surf_rock_142_sec"==i?a=.2:"music_stereospice_fun_surf_rock_92_sec"==i?a=.2:"music_avocado_easy_times_in_hawaii"==i?a=.2:"music_beach_waves"==i&&(a=.35);var s=Ms.createMusic(i,r,a);_.setField(Gs,i,s),Gs.all_music_loops.push(s)}else Nl.trace("warning: "+i+" sound does not have howl",{fileName:"GameAssetsDo.hx",lineNumber:470,className:"bikas.top.GameAssetsDo",methodName:"init"})}}),m.on_finish=function(e){Hs.assignTexturesToVars(e.loader.resources,e.names)},g.on_finish=function(e){for(var t=0,n=e.names;t<n.length;){var i=n[t];++t;var r=new Zs;r.name=i,r.data=e.loader.resources[i].data,Gs.level_data_saves.push(r)}};var z="",w="";v.on_finish=function(e){for(var t=e.loader.resources[e.names[0]].data.split(","),n=0;n<t.length;){var i=t[n];++n;var r=i.split("."),a=r[0],s=r[1];if("befgs"==s){for(var l=null,o=0,_=Gs.level_data_saves;o<_.length;){var p=_[o];if(++o,p.name==a){l=p;break}}null==l?z=h(b,new Vs(qs.Text,"assets/saves/",a,s)):(z="",Gs.working_stage=l.data)}else if("befgl"==s){for(var u=null,c=0,d=Gs.level_data_saves;c<d.length;){var m=d[c];if(++c,m.name==a){u=m;break}}null==u?w=h(b,new Vs(qs.Text,"assets/saves/",a,s)):(w="",Gs.working_library=u.data)}}},b.on_finish=function(e){""!=z?Gs.working_stage=e.loader.resources[z].data:""==Gs.working_stage&&Nl.trace("warning: working_stage is empty",{fileName:"GameAssetsDo.hx",lineNumber:569,className:"bikas.top.GameAssetsDo",methodName:"init"}),""!=w?Gs.working_library=e.loader.resources[w].data:""==Gs.working_library&&Nl.trace("warning: working_library is empty",{fileName:"GameAssetsDo.hx",lineNumber:576,className:"bikas.top.GameAssetsDo",methodName:"init"}),Gs.background_objects_source=e.loader.resources.background_objects.data,Gs.background_objects_obj=Xe.parseBackgroundObjects(Gs.background_objects_source)},y.on_finish=function(e){for(var t=0,n=e.names;t<n.length;){var i=n[t];++t;for(var a=y.loader.resources[i],s=(a.spritesheet.baseTexture,a.spritesheet.textures),l=0,p=_.fields(s);l<p.length;){var u=p[l];++l;var h=s[u],c=u,d=c.split("/");0<d.length&&(c=d[d.length-1]),null!=_.field(Gs,c)?Nl.trace("warning: asset "+c+" is already set",{fileName:"GameAssetsDo.hx",lineNumber:604,className:"bikas.top.GameAssetsDo",methodName:"init"}):_.setField(Gs,c,h);var m=P.createBitmapDataSource(h);r.set(c,m)}}var f=qa.createSprite(Gs.marker);f.alpha=.001,o.preloader_graphics.container.add(f),$s.renderer.type==Qs.CANVAS&&(Gs.tile_pattern=Hs.createPattern(Gs.tile),Gs.tile_dark_pattern=Hs.createPattern(Gs.tile_dark));var g=b.loader.resources.bfanimations.data,v=(new XMLSerializer).serializeToString(g.documentElement);if(null==v)Nl.trace("warning: couldn't load bfanimations",{fileName:"GameAssetsDo.hx",lineNumber:628,className:"bikas.top.GameAssetsDo",methodName:"init"});else for(var x=A.createAnimationDatasFromXml(so.__cast(v,String),Hs.retrieveAsset),z=0;z<x.length;){var w=x[z];++z;var k="animation_"+w.name;_.setField(Gs,k,w)}},x.on_finish=function(e){for(var t=e.loader.resources,n=0,i=e.names;n<i.length;){var r=i[n];++n;for(var a=t[r],s=_.fields(a.bitmapFont.chars),l=_.field(Gs,r),o=l.frame.x,p=l.frame.y,u=0;u<s.length;){var h=s[u];++u;var c=_.field(a.bitmapFont.chars,h),d=_.field(c,"texture");_.setField(c,"texture",new PIXI.Texture(l.baseTexture,new PIXI.Rectangle(d.frame.x+o,d.frame.y+p,d.frame.width,d.frame.height)))}}};for(var k={},S=function(e,t,n,i,r,a){for(var s=0,l=0,o=!0,_=0,p=e.loader_pack_list;_<p.length;){var h=p[_];if(++_,s+=h.size_coeff,h.finished)l+=h.size_coeff;else{var c=h.preload_howls.length+h.loaded_howls.length,d=1;0<c&&(d=h.loaded_howls.length/c),l+=d*h.loader.progress/100*h.size_coeff,o=!1}}var m=l/s;1==a.type&&3==a.release.sitelock_type&&(k.percentageDone=m,es.PokiSDK.gameLoadingProgress(k)),i.finished&&(null==e.preloader_graphics&&(e.preloader_graphics=Hs.createPreloaderGraphics(),n.add(e.preloader_graphics.container),u(),el.scaleAndCenter(n,t),t.scale_listeners.push(u)),u(),e.preloader_graphics.loader_foreground.scale.x=m),o&&(1==a.type&&3==a.release.sitelock_type&&es.PokiSDK.gameLoadingFinished(),e.finished=!0,e.preloader_graphics.play_button.visible=!0,e.preloader_graphics.loader_foreground.visible=!1,e.preloader_graphics.loader_background.visible=!1,0!=a.type||a.development.game_preloader_enabled?(e.load_callback(),e.preloader_graphics.play_button_click_callback=function(){t.scale_listeners.splice(t.scale_listeners.indexOf(u),1),e.play_callback(e)}):(t.scale_listeners.splice(t.scale_listeners.indexOf(u),1),e.load_callback(),e.play_callback(e)))},C=null,N=C=function(i){i.loader.load();for(var r=0,a=i.preload_howls;r<a.length;){var l=[a[r]];++r;var _=function(r){return function(){s.remove(i.preload_howls,r[0]),i.loaded_howls.push(r[0]),0==i.preload_howls.length&&i.pixi_loader_finished&&!i.finished&&(i.finished=!0,i.on_finish(i),null!=i.next_pack&&C(i.next_pack)),S(o,e,t,m,0,n)}}(l);l[0].once("load",_),l[0].load()}},M=0,I=(o.loader_pack_list=d).length;M<I;){var T=[d[M++]];T[0].loader.on("progress",function(i){S(o,e,t,m,0,n)}),T[0].loader.on("complete",function(i){return function(r){i[0].pixi_loader_finished=!0,0==i[0].preload_howls.length&&i[0].pixi_loader_finished&&!i[0].finished&&(i[0].finished=!0,i[0].on_finish(i[0]),null!=i[0].next_pack&&N(i[0].next_pack)),S(o,e,t,m,0,n)}}(T))}1==n.type&&3==n.release.sitelock_type&&es.PokiSDK.gameLoadingStart(),0<d.length&&N(d[0])},Hs.createGameLoader=function(e,t){var n=new Xs;return n.preloader_graphics=null,n.load_callback=e,n.play_callback=t,n},Hs.createPreloaderGraphics=function(){var e=new Us;return e.container=qa.createGroup(),e.background=qa.createSprite(Gs.preloader_title_background,0,0,0,0),e.container.add(e.background),e.middle_container=qa.createGroup(),e.container.add(e.middle_container),e.title=qa.createSprite(Gs.preloader_logo_big,.5,.5,0,-60),e.middle_container.add(e.title),e.loader_background=qa.createSprite(Gs.preloader_game_loader_background,0,.5,-Gs.preloader_game_loader_background.width/2,146),e.loader_foreground=qa.createSprite(Gs.preloader_game_loader_foreground,0,.5,-Gs.preloader_game_loader_foreground.width/2,146),e.middle_container.add(e.loader_background),e.middle_container.add(e.loader_foreground),e.play_button=qa.createAndAddButton(e.middle_container,Gs.preloader_play_button_normal,.5,.5,0,166,0,function(){$s.js_info.desktop||el.requestFullScreen(),e.play_button.texture=Gs.preloader_play_button_pressed,null!=e.play_button_click_callback&&(e.play_button_click_callback(),e.play_button_click_callback=null,e.play_button.buttonMode=!1,e.play_button.interactive=!1,e.play_button.pointerdown=null)}),e.play_button.visible=!1,e},Hs.updateTransitionOut=function(e){e.transition_current_time++;var t=va.linearClamped(1,0,e.transition_current_time/Xs.transition_out_time);e.preloader_graphics.middle_container.alpha=t,e.transition_current_time>Xs.transition_out_time&&(e.transition_current_time=Xs.transition_out_time,e.preloader_graphics.middle_container.alpha=0,null==e.on_transition_out_finished?Nl.trace("warning: on_transition_out_finished == null",{fileName:"GameAssetsDo.hx",lineNumber:895,className:"bikas.top.GameAssetsDo",methodName:"updateTransitionOut"}):e.on_transition_out_finished())},Hs.removeLoader=function(e){1==$s.config.type&&3==$s.config.release.sitelock_type&&null!=es.adblock_confirm_card&&(zi.destroyConfirmationCard(es.adblock_confirm_card),es.adblock_confirm_card=null),null!=e.preloader_graphics&&(e.preloader_graphics.play_button.destroy(!0),null!=e.preloader_graphics.container.parent&&e.preloader_graphics.container.parent.removeChild(e.preloader_graphics.container),e.preloader_graphics.container.destroy(!0),e.preloader_graphics=null,e.play_callback=null,e.preloader_graphics=null)},Hs.createPattern=function(e){var t=lo.get_document().createElement("canvas");t.width=Math.round(e.frame.width),t.height=Math.round(e.frame.height);var n=t.getContext("2d",null);n.drawImage(e.baseTexture.source,e.frame.x,e.frame.y,e.frame.width,e.frame.height,0,0,e.frame.width,e.frame.height);var i=n.createPattern(t,"repeat");return Nl.trace("ctx.canvas.width: "+n.canvas.width,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.top.GameAssetsDo",methodName:"createPattern"}),Nl.trace("ctx.canvas.height: "+n.canvas.height,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.top.GameAssetsDo",methodName:"createPattern"}),i},Hs.assignTexturesToVars=function(e,t){for(var n=0;n<t.length;){var i=t[n];++n;var r=e[i];_.setField(Gs,i,r.texture)}},Hs.getSourcesBySoundFormat=function(e,t,n){for(var i=[],r=0;r<n.length;){var a=n[r];++r;var s=e;i.push(s+t+"."+a)}return i},Hs.retrieveAsset=function(e){return _.field(Gs,e)},Hs.doesTextureExist=function(e){var t=_.field(Gs,e);return null!=t&&!!p.is(t,PIXI.Texture)},Hs.getTexture=function(e){var t=_.field(Gs,e);return null==t?(Nl.trace("warning: could not find "+e+" texture",{fileName:"GameAssetsDo.hx",lineNumber:1066,className:"bikas.top.GameAssetsDo",methodName:"getTexture"}),null):p.is(t,PIXI.Texture)?so.__cast(t,PIXI.Texture):(Nl.trace("warning: "+e+" is not a texture",{fileName:"GameAssetsDo.hx",lineNumber:1070,className:"bikas.top.GameAssetsDo",methodName:"getTexture"}),null)};var Ys=function(e,t,n){this.element=e,this.type=t,this.func=n};(n["bikas.top.ListenerSave"]=Ys).__name__=["bikas","top","ListenerSave"],Ys.prototype={element:null,type:null,func:null,__class__:Ys};var Js=function(){this.debug_dc_switch_time=0,this.force_delta=null};(n["bikas.top.Step"]=Js).__name__=["bikas","top","Step"],Js.prototype={min_fps:null,max_fps:null,min_delta:null,max_delta:null,time_now:null,time_last:null,delta:null,original_dc:null,dc:null,ui_dc:null,step_size:null,level_seconds:null,game_seconds:null,force_delta:null,debug_dc_switch_time:null,game_update_time:null,__class__:Js};var Ks=function(){this.top_scripts=null,this.game_loader=null,this.game=null,this.step=null,this.config=null};(n["bikas.top.GameUpdateData"]=Ks).__name__=["bikas","top","GameUpdateData"],Ks.prototype={config:null,step:null,game:null,game_loader:null,top_scripts:null,__class__:Ks};var Qs=function(){};(n["bikas.top.RendererType"]=Qs).__name__=["bikas","top","RendererType"];var $s=function(){};(n["bikas.top.TopObjects"]=$s).__name__=["bikas","top","TopObjects"];var el=function(){};(n["bikas.top.TopDo"]=el).__name__=["bikas","top","TopDo"],el.renderGraphicsHack=function(e){if(null!=e.pattern_hack){if(null!=e.pattern_hack.points){var t=$s.renderer,n=t.context,i=(e.worldAlpha,e.transform.worldTransform),r=t.resolution;n.setTransform(i.a*r,i.b*r,i.c*r,i.d*r,i.tx*r,i.ty*r),t.setBlendMode(e.blendMode);var a=n,s=e.worldAlpha,l=e.pattern_hack.points;if(null!=e.pattern_hack.pattern){a.save(),a.fillStyle=e.pattern_hack.pattern;for(var o=0;o<l.length;){var _=l[o];++o,a.beginPath(),a.moveTo(_[0].x,_[0].y);for(var p=1,u=_.length;p<u;){var h=p++;a.lineTo(_[h].x,_[h].y)}a.closePath(),a.globalAlpha=s,a.fill()}a.restore()}}}else el.PIXI_CanvasGraphics.original_non_hacked_renderGraphics(e)},el.emptyPostUpdate=function(){},el.initializeAndStart=function(e){el.PIXI_CanvasGraphics=PIXI.CanvasGraphicsRenderer.prototype,el.PIXI_CanvasGraphics.original_non_hacked_renderGraphics=el.PIXI_CanvasGraphics.render,el.PIXI_CanvasGraphics.render=el.renderGraphicsHack;var t=new Rs;(($s.config=t).type=1)==t.type&&t.release.famobi_disable_debug_output&&(Nl.trace=function(e,t){Vn.game_trace_log.push(p.string(e)+""),1e4<Vn.game_trace_log.length&&Vn.game_trace_log.shift()}),4==t.release.sitelock_type?(ve.setupFamobi(),t.control_type=Fs.ControlSlowRotateButtonsSide):1==t.release.sitelock_type&&(t.control_type=Fs.ControlSlowRotateButtonsSide),0==t.type&&t.development.test_famobi_mobile_controls&&(t.control_type=Fs.ControlSlowRotateButtons),t.type,0==t.type&&Nl.trace("NOTE: press (i) near address bar and set Flash to Allow if editor is not visible",{fileName:"TopDo.hx",lineNumber:191,className:"bikas.top.TopDo",methodName:"initializeAndStart"});var n=new Sa(960,720,2160,720);n.build_time=e,el.setOS(n),$s.js_info=n;var i=function(e){var t="";return t=(t=-1<e.indexOf("://")?e.split("/")[2]:e.split("/")[0]).split(":")[0],h.replace(t,"www.","")},r=function(e){try{if(null!=window.location.ancestorOrigins)for(var t=window.location.ancestorOrigins,n=0;n<t.length;){var r=t[n],a=i(r);if(-1==e.indexOf(a))return!1;++n}}catch(e){}if(lo.get_window().top!=lo.get_window().self){var s=i(lo.get_document().referrer);if(-1==e.indexOf(s))return!1}var l=i(lo.get_window().location.hostname);return-1!=e.indexOf(l)};if(1!=t.type||3!=t.release.sitelock_type){if(1==t.type&&1==t.release.sitelock_type&&!r(["bikas.net"])&&t.release.game_exit)return;if(1==t.type&&2==t.release.sitelock_type&&!r(["lagged.com"])&&t.release.game_exit)return;if(1==t.type&&4==t.release.sitelock_type&&!r(["famobi.com"])&&t.release.game_exit)return}if(1==t.type&&2==t.release.sitelock_type)Ta.init();else if(1==t.type&&3==t.release.sitelock_type&&!es.init(t))return;Nl.trace("config type: "+t.type,{fileName:"TopDo.hx",lineNumber:326,className:"bikas.top.TopDo",methodName:"initializeAndStart"}),Nl.trace("build date: "+p.string(new Date(e)),{fileName:"TopDo.hx",lineNumber:327,className:"bikas.top.TopDo",methodName:"initializeAndStart"}),Nl.trace("run date: "+p.string(new Date),{fileName:"TopDo.hx",lineNumber:328,className:"bikas.top.TopDo",methodName:"initializeAndStart"});var a=Ma.getTimer();Howler.init(),1==t.type&&t.release.google_analytics_enabled&&ka.init("UA-49556966-15","adventuredrivers.bikas.net");var s=Qs.WEBGL;0==t.type&&t.development.capture_mode?(s=Qs.CANVAS,t.development.force_fixed_timestep=!0,t.development.force_size=new aa(1280,720)):(n.android||n.desktop,s=Qs.WEBGL),0==t.type&&t.development.force_canvas&&(s=Qs.CANVAS),0==t.type&&(lo.get_document().oncontextmenu=function(){return!1});var l=new gs,o={autoResize:!(l.interactive=!0),antialias:!0,transparent:!1,backgroundColor:8572624,resolution:1},_=lo.get_document().getElementById("gamecanvas");_.draggable=!1,o.view=_,PIXI.glCore.VertexArrayObject.FORCE_NATIVE=!0,n.iOS&&(PIXI.settings.PRECISION_FRAGMENT="highp");var u=!1;s==Qs.CANVAS&&(u=!0);var c=PIXI.autoDetectRenderer(o,1024,768,u);$s.renderer=c,$s.canvas=_,$s.game=l,$s.container=l,n.desktop?Un.terrain_draw_count=512:n.iOS?Un.terrain_draw_count=20:Un.terrain_draw_count=128,c.type==PIXI.RENDERER_TYPE.CANVAS&&(Un.texture_offset_add=1),$s.game_update_data=el.createGameUpdateData(t,30,120),el.create(t,a,n,l),el.updateEverything(.016666666666666666),document.addEventListener("visibilitychange",function(){document.hidden?("function"==typeof famobi_onPauseRequested&&famobi_onPauseRequested("visibilitychange"),el.update($s.game_update_data,0,!0)):"function"==typeof famobi_onResumeRequested&&famobi_onResumeRequested("visibilitychange")},!1)},el.updateEverything=function(e){el.update($s.game_update_data,e),lo.get_window().requestAnimationFrame(el.updateEverything)},el.create=function(e,t,n,i){0==e.type&&(i.mousedown=function(e){3==e.data.originalEvent.which&&($s.right_mouse_button_down=!0,Nl.trace("TopObjects.right_mouse_button_down: "+p.string($s.right_mouse_button_down),{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.top.TopDo",methodName:"create"}))},i.mouseup=function(e){3==e.data.originalEvent.which&&($s.right_mouse_button_down=!1)}),n.gamecanvas=$s.canvas;var r=new Ka;if($s.pointer=r,qa.addPointerEvents(i,r,n),el.scaleAndCenter(i,n),0==e.type&&(n.force_size=e.development.force_size),el.addEvent(lo.get_window(),"load",function(){el.scaleAndCenter(i,n)}),el.addEvent(lo.get_window(),"resize",function(){el.scaleAndCenter(i,n)}),el.addEvent(lo.get_window(),"scroll",function(){el.scaleAndCenter(i,n)}),null!=lo.get_window()){var a=function(e){e.preventDefault()},s=function(e){e.preventDefault()};lo.get_window().addEventListener("gesturestart",a,!1),lo.get_window().addEventListener("gestureend",a,!1),lo.get_window().addEventListener("gesturechange",s,!1),$s.top_listeners.push(new Ys(lo.get_window(),"gesturestart",a)),$s.top_listeners.push(new Ys(lo.get_window(),"gestureend",a)),$s.top_listeners.push(new Ys(lo.get_window(),"gesturechange",s))}0==e.type&&new o;var l=new Ll;Hs.init(n,i,e,r,l,function(){Nl.trace("total load time: "+(Ma.getTimer()-t)+"ms",{fileName:"TopDo.hx",lineNumber:569,className:"bikas.top.TopDo",methodName:"create"})},function(t){P.init();var a=function(){Hs.removeLoader(t),function(){var t=ie.createEngine(),a=Ma.getTimer();if($s.game_update_data.game=Vn.createGame(e,n,$s.game_update_data.step,r,i,t,l),null!=$s.game_update_data.game){Nl.trace("game created in "+(Ma.getTimer()-a)+"ms",{fileName:"TopDo.hx",lineNumber:545,className:"bikas.top.TopDo",methodName:"create"}),0!=e.type||e.development.transitions_enabled?($s.game_update_data.game.previous_state=Gn.InGameLoad,$s.game_update_data.game.state=Gn.InTransitionToLevelLoad):$s.game_update_data.game.state=Gn.InLevel;var s=new Js;s.dc=1,s.level_seconds=0,s.step_size=.016666666666666666,s.delta=16.666666666666668,Vn.update($s.game_update_data.game,s)}}()};0!=e.type||e.development.transitions_enabled?($s.game_update_data.game_loader=t).on_transition_out_finished=a:a(),el.scaleAndCenter(i,n)}),Nl.trace("init time: "+(Ma.getTimer()-t)+"ms",{fileName:"TopDo.hx",lineNumber:599,className:"bikas.top.TopDo",methodName:"create"})},el.createGameUpdateData=function(e,t,n){null==n&&(n=120),null==t&&(t=30);var i=new Ks;i.top_scripts=[],i.config=e;var r=i.step=new Js;return r.min_fps=t,r.max_fps=n,r.min_delta=1e3/r.max_fps,r.max_delta=1e3/r.min_fps,null!=lo.get_window().performance?(Nl.trace("use performance",{fileName:"TopDo.hx",lineNumber:619,className:"bikas.top.TopDo",methodName:"createGameUpdateData"}),r.time_last=lo.get_window().performance.now()):r.time_last=(new Date).getTime(),0==e.type&&e.development.force_fixed_timestep&&(r.force_delta=16.666666666666668),r.delta=r.min_delta,r.step_size=1/r.max_fps,r.dc=1,r.level_seconds=0,r.game_update_time=0,i},el.addEvent=function(e,t,n){null!=e&&(null!=e.addEventListener?(e.addEventListener(t,n,!1),$s.top_listeners.push(new Ys(e,t,n))):null!=e.attachEvent?e.attachEvent("on"+t,n):_.setProperty(e,"on"+t,n))},el.setOS=function(e){var t=lo.get_navigator().userAgent,n=e;new a("Playstation Vita","").match(t)?n.vita=!0:new a("Kindle","").match(t)||new a("\\bKF[A-Z][A-Z]+","").match(t)||new a("Silk.*Mobile Safari","").match(t)?n.kindle=!0:new a("Android","").match(t)?n.android=!0:new a("CrOS","").match(t)?n.chromeOS=!0:new a("iP[ao]d|iPhone","i").match(t)?n.iOS=!0:new a("Linux","").match(t)?n.linux=!0:new a("Mac OS","").match(t)?n.macOS=!0:new a("Windows","").match(t)&&(n.windows=!0),(new a("Windows Phone","i").match(t)||new a("IEMobile","i").match(t))&&(n.android=!1,n.iOS=!1,n.macOS=!1,n.windows=!0,n.windowsPhone=!0);var i=new a("Silk","").match(t);(n.windows||n.macOS||n.linux&&!i||n.chromeOS)&&(n.desktop=!0),(n.windowsPhone||new a("Windows NT","i").match(t)&&new a("Touch","i").match(t))&&(n.desktop=!1)},el.scaleAndCenter=function(e,t){var n=lo.get_window().devicePixelRatio,i=lo.get_window().innerWidth,r=lo.get_window().innerHeight,a=t.max_game_width,s=t.max_game_height;null!=t.force_size&&(i=t.force_size.width,r=t.force_size.height,a=Math.round(i/r*s),n=1);var l=i*n,o=r*n,_=el.getGameWindowSize(l,o,t.min_game_width,t.min_game_height,a,s);t.current_game_width=Math.round(_.width),t.current_game_height=Math.round(_.height),t.canvas_game_width=Math.round(_.canvas_width),t.canvas_game_height=Math.round(_.canvas_height),t.device_scale=n,t.window_scale=_.scale,t.game_position=_.position,t.height_offset=t.game_position.y/t.window_scale,e.scale.x=t.window_scale,e.scale.y=t.window_scale,e.hitArea=new ds(-e.position.x/t.window_scale,-e.position.y/t.window_scale,t.current_game_width,t.current_game_height),$s.renderer.resize(t.canvas_game_width,t.canvas_game_height),$s.renderer.render($s.game);for(var p=0,u=t.scale_listeners;p<u.length;){var h=u[p];++p,h()}t.gamecanvas.style.width=Math.round(t.canvas_game_width/n)+"px",t.gamecanvas.style.height=Math.round(t.canvas_game_height/n)+"px",t.last_scale_date=new Date,t.scale_count++,Nl.trace("window_width:"+l+", window_height:"+o+", scale:"+t.window_scale+" (current_game_width:"+t.current_game_width+", current_game_height:"+t.current_game_height+")",{fileName:"TopDo.hx",lineNumber:766,className:"bikas.top.TopDo",methodName:"scaleAndCenter"})},el.getGameWindowSize=function(e,t,n,i,r,a){var s=e/t,l=n/a,o=r/a,_=ma.clamp(s,l,o),p=new Ca;p.width=t*_,p.height=p.width/_;var u=a/p.height;p.width*=u,p.height*=u;var h=e/p.width,c=t/p.height;return p.scale=ma.min(h,c),s<n/i&&(p.height=1.3333333333333333*p.height/s),p.canvas_width=p.width*p.scale,p.canvas_height=p.height*p.scale,p},el.isInFullScreen=function(){var e=lo.get_window().document;return null!=e&&!!(e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement)},el.requestFullScreen=function(){if(!el.isInFullScreen()&&null!=lo.get_window().document&&null!=lo.get_window().document.documentElement){var e=lo.get_window().document.documentElement,t=null;null!=e.requestFullscreen?t=e.requestFullscreen:null!=e.mozRequestFullScreen?t=e.mozRequestFullScreen:null!=e.webkitRequestFullScreen?t=e.webkitRequestFullScreen:null!=e.msRequestFullscreen&&(t=e.msRequestFullscreen),null!=t&&t.call(e)}},el.update=function(e,t,n){var i=e.config,r=e.step,a=e.game;if(null!=r&&null!=i){if(null!=lo.get_window().performance?r.time_now=lo.get_window().performance.now():r.time_now=(new Date).getTime(),r.delta=r.time_now-r.time_last,null!=r.force_delta&&(r.delta=r.force_delta),r.delta>r.max_delta&&(r.delta=r.max_delta),r.delta>r.min_delta||n){if((0!=i.type||i.development.transitions_enabled)&&(null!=e.game_loader&&null!=e.game_loader.preloader_graphics&&Hs.updateTransitionOut(e.game_loader),null!=$s.js_info&&null!=$s.js_info.loader&&null!=$s.js_info.loader.preloader_graphics&&$s.js_info.loader.finished&&null!=$s.pointer&&1==i.type&&3==i.release.sitelock_type&&es.updateAdblockWarning($s.js_info.loader.preloader_graphics,$s.pointer)),null!=a){Vn.update(a,r),qa.updatePointer(a.pointer),0<a.keyboard_keys_released.length&&a.keyboard_keys_released.splice(0,a.keyboard_keys_released.length);for(var s=0,l=Gs.all_sound_loops;s<l.length;){var o=l[s];++s,Ms.updateMusicPause(o)}for(var _=0,p=Gs.all_music_loops;_<p.length;){var u=p[_];++_,Ms.updateMusicPause(u)}}$s.renderer.render($s.container),r.time_last=r.time_now}if(null!=e.top_scripts)for(var h=0,c=e.top_scripts;h<c.length;){var d=c[h];++h,d()}null!=lo.get_window().performance?(r.game_update_time=lo.get_window().performance.now()-r.time_now,r.game_update_time=Math.round(10*r.game_update_time)/10):r.game_update_time=(new Date).getTime()-r.time_now}},el.detectSpriteWithNoTexture=function(e){for(var t=0,n=e.children;t<n.length;){var i=n[t];if(++t,p.is(i,fs)){var r=i;null==r.texture&&Nl.trace("sprite with no texture: "+p.string(mn.getNameOfDisplayObjectWithParentNames(r)),{fileName:"TopDo.hx",lineNumber:966,className:"bikas.top.TopDo",methodName:"detectSpriteWithNoTexture"})}else p.is(i,hs)||p.is(i,gs)&&el.detectSpriteWithNoTexture(i)}};var tl=function(e){switch(this.responseCount=0,"direct"!=e&&"organic"!=e&&"referral"!=e&&hl._raiseError("Campaign type has to be one of the Campaign::TYPE_* constant values.","Campaign.new"),this.type=e){case"direct":this.name="(direct)",this.source="(direct)",this.medium="(none)";break;case"organic":this.name="(organic)",this.medium="organic";break;case"referral":this.name="(referral)",this.medium="referral"}this.creationTime=new rl};(n["googleAnalytics.Campaign"]=tl).__name__=["googleAnalytics","Campaign"],tl.createFromReferrer=function(e){var t=new tl("referral"),n=new dl(e);return t.source=n.host,t.content=n.path,t},tl.prototype={type:null,creationTime:null,responseCount:null,id:null,source:null,gClickId:null,dClickId:null,name:null,medium:null,term:null,content:null,validate:function(){null==this.source&&hl._raiseError('Campaigns need to have at least the "source" attribute defined.',"Campaign.validate")},setType:function(e){this.type=e},getType:function(){return this.type},setCreationTime:function(e){this.creationTime=e},getCreationTime:function(){return this.creationTime},setResponseCount:function(e){this.responseCount=e},getResponseCount:function(){return this.responseCount},increaseResponseCount:function(e){null==e&&(e=1),this.responseCount+=e},setId:function(e){this.id=e},getId:function(){return this.id},setSource:function(e){this.source=e},getSource:function(){return this.source},setGClickId:function(e){this.gClickId=e},getGClickId:function(){return this.gClickId},setDClickId:function(e){this.dClickId=e},getDClickId:function(){return this.dClickId},setName:function(e){this.name=e},getName:function(){return this.name},setMedium:function(e){this.medium=e},getMedium:function(){return this.medium},setTerm:function(e){this.term=e},getTerm:function(){return this.term},setContent:function(e){this.content=e},getContent:function(){return this.content},__class__:tl};var nl=function(e){null==e&&(e=!1),this.sitespeedSampleRate=1,this.endPointPath="/__utm.gif",this.endPointHost="www.google-analytics.com",this.urlScheme="http",this.requestTimeout=1,this.fireAndForget=!1,this.sendOnShutdown=!1,this.errorSeverity=2,this.setUrlScheme("http"+(e?"s":""))};(n["googleAnalytics.Config"]=nl).__name__=["googleAnalytics","Config"],nl.prototype={errorSeverity:null,sendOnShutdown:null,fireAndForget:null,loggingCallback:null,requestTimeout:null,urlScheme:null,endPointHost:null,endPointPath:null,sitespeedSampleRate:null,getErrorSeverity:function(){return this.errorSeverity},setErrorSeverity:function(e){this.errorSeverity=e},getSendOnShutdown:function(){return this.sendOnShutdown},setSendOnShutdown:function(e){this.sendOnShutdown=e},getFireAndForget:function(){return this.fireAndForget},setFireAndForget:function(e){this.fireAndForget=e},getLoggingCallback:function(){return this.loggingCallback},setLoggingCallback:function(e){this.loggingCallback=e},getRequestTimeout:function(){return this.requestTimeout},setRequestTimeout:function(e){this.requestTimeout=e},getUrlScheme:function(){return this.urlScheme},setUrlScheme:function(e){return this.urlScheme=e},getEndPointHost:function(){return this.endPointHost},setEndPointHost:function(e){this.endPointHost=e},getEndPointPath:function(){return this.endPointPath},setEndPointPath:function(e){this.endPointPath=e},getSitespeedSampleRate:function(){return this.sitespeedSampleRate},setSitespeedSampleRate:function(e){e<0||100<e?hl._raiseError("For consistency with ga.js, sample rates must be specified as a number between 0 and 100.","config.setSitespeedSampleRate"):this.sitespeedSampleRate=e},__class__:nl};var il=function(e,t,n,i){null==i&&(i=0),null==e&&(e=0),this.scope=3,0!=e&&this.setIndex(e),null!=t&&this.setName(t),null!=n&&this.setValue(n),0!=i&&this.setScope(i)};(n["googleAnalytics.CustomVariable"]=il).__name__=["googleAnalytics","CustomVariable"],il.prototype={index:null,name:null,value:null,scope:null,validate:function(){128<(this.name+p.string(this.value)).length&&hl._raiseError("Custom Variable combined name and value length must not be larger than 128 bytes.","CustomVariable.validate")},getIndex:function(){return this.index},setIndex:function(e){(e<1||5<e)&&hl._raiseError("Custom Variable index has to be between 1 and 5.","CustomVariable.setIndex"),this.index=e},getName:function(){return this.name},setName:function(e){this.name=e},getValue:function(){return this.value},setValue:function(e){this.value=e},getScope:function(){return this.scope},setScope:function(e){3!=e&&2!=e&&1!=e&&hl._raiseError("Custom Variable scope has to be one of the CustomVariable::SCOPE_* constant values.","CustomVariable.setScope"),this.scope=e},__class__:il};var rl=function(e){this.date=null==e?Math.round((new Date).getTime())+"":e};(n["googleAnalytics.DateTime"]=rl).__name__=["googleAnalytics","DateTime"],rl.prototype={date:null,toString:function(){return this.date},__class__:rl};var al=function(e,t,n,i,r){null==r&&(r=!1),null==i&&(i=0),this.noninteraction=!1,null!=e&&this.setCategory(e),null!=t&&this.setAction(t),null!=n&&this.setLabel(n),this.setValue(i),this.setNoninteraction(r)};(n["googleAnalytics.Event"]=al).__name__=["googleAnalytics","Event"],al.prototype={category:null,action:null,label:null,value:null,noninteraction:null,validate:function(){null!=this.category&&null!=this.action||hl._raiseError("Events need at least to have a category and action defined.","Event.validate")},getCategory:function(){return this.category},setCategory:function(e){this.category=e},getAction:function(){return this.action},setAction:function(e){this.action=e},getLabel:function(){return this.label},setLabel:function(e){this.label=e},getValue:function(){return this.value},setValue:function(e){this.value=e},getNoninteraction:function(){return this.noninteraction},setNoninteraction:function(e){this.noninteraction=e},__class__:al};var sl=function(){this.quantity=1};(n["googleAnalytics.Item"]=sl).__name__=["googleAnalytics","Item"],sl.prototype={orderId:null,sku:null,name:null,variation:null,price:null,quantity:null,validate:function(){null==this.sku&&hl._raiseError("Items need to have a sku/product code defined.","Item.validate")},getOrderId:function(){return this.orderId},setOrderId:function(e){this.orderId=e},getSku:function(){return this.sku},setSku:function(e){this.sku=e},getName:function(){return this.name},setName:function(e){this.name=e},getVariation:function(){return this.variation},setVariation:function(e){this.variation=e},getPrice:function(){return this.price},setPrice:function(e){this.price=e},getQuantity:function(){return this.quantity},setQuantity:function(e){this.quantity=e},__class__:sl};var ll=function(e){this.setPath(e)};(n["googleAnalytics.Page"]=ll).__name__=["googleAnalytics","Page"],ll.prototype={path:null,title:null,charset:null,referrer:null,loadTime:null,setPath:function(e){null!=e&&"/"!=e.charAt(0)&&hl._raiseError('The page path should always start with a slash ("/").',"Page.setPath"),this.path=e},getPath:function(){return this.path},setTitle:function(e){this.title=e},getTitle:function(){return this.title},setCharset:function(e){this.charset=e},getCharset:function(){return this.charset},setReferrer:function(e){this.referrer=e},getReferrer:function(){return this.referrer},setLoadTime:function(e){this.loadTime=e},getLoadTime:function(){return this.loadTime},__class__:ll};var ol=function(){this.setSessionId(this.generateSessionId()),this.setTrackCount(0),this.setStartTime(new rl)};(n["googleAnalytics.Session"]=ol).__name__=["googleAnalytics","Session"],ol.prototype={sessionId:null,trackCount:null,startTime:null,fromUtmb:function(e){var t=e.split(".");return 4!=t.length?hl._raiseError('The given "__utmb" cookie value is invalid.',"Session.fromUtmb"):(this.setTrackCount(gl.parseInt(t[1],0)),this.setStartTime(new rl(t[3]))),this},generateSessionId:function(){return gl.generate32bitRandom()},getSessionId:function(){return this.sessionId},setSessionId:function(e){this.sessionId=e},getTrackCount:function(){return this.trackCount},setTrackCount:function(e){this.trackCount=e},increaseTrackCount:function(e){null==e&&(e=1),this.trackCount+=e},getStartTime:function(){return this.startTime},setStartTime:function(e){this.startTime=e},__class__:ol};var _l=function(e,t,n){null!=e&&this.setNetwork(e),null!=t&&this.setAction(t),null!=n&&this.setTarget(n)};(n["googleAnalytics.SocialInteraction"]=_l).__name__=["googleAnalytics","SocialInteraction"],_l.prototype={network:null,action:null,target:null,validate:function(){null!=this.network&&null!=this.action||hl._raiseError('Social interactions need to have at least the "network" and "action" attributes defined.',"SocialInteraction.validate")},setNetwork:function(e){this.network=e},getNetwork:function(){return this.network},setAction:function(e){this.action=e},getAction:function(){return this.action},setTarget:function(e){this.target=e},getTarget:function(){return this.target},__class__:_l};var pl=function(){};(n["googleAnalytics.Stats"]=pl).__name__=["googleAnalytics","Stats"],pl.init=function(e,t,n){null==n&&(n=!1),null==pl.accountId&&(pl.accountId=e,pl.domainName=t,pl.tracker=new hl(e,t,new nl(n)),pl.cache=new Ll,pl.session=new ol,pl.loadVisitor())},pl.trackPageview=function(e,t){var n="page:"+e;if(!pl.cache.exists(n)){var i=new ll(e);null!=t&&i.setTitle(t),pl.cache.set(n,new ul(i,null))}pl.track(n)},pl.trackEvent=function(e,t,n,i){null==i&&(i=0);var r="event:"+e+"/"+t+"/"+n+":"+i;pl.cache.exists(r)||pl.cache.set(r,new ul(null,new al(e,t,n,i))),pl.track(r)},pl.track=function(e){pl.paused||(pl.cache.get(e).track(pl.tracker,pl.visitor,pl.session),pl.persistVisitor())},pl.pause=function(){pl.paused=!0},pl.resume=function(){pl.paused=!1},pl.loadVisitor=function(){pl.visitor=new ml,pl.visitor.setUserAgent("-not-set- [haxe]"),pl.visitor.setScreenResolution("1024x768"),pl.visitor.setLocale("en_US"),pl.visitor.getUniqueId(),pl.visitor.addSession(pl.session),pl.persistVisitor()},pl.persistVisitor=function(){};var ul=function(e,t){this.page=e,this.event=t};(n["googleAnalytics._Stats.GATrackObject"]=ul).__name__=["googleAnalytics","_Stats","GATrackObject"],ul.prototype={event:null,page:null,track:function(e,t,n){null!=this.page&&e.trackPageview(this.page,n,t),null!=this.event&&e.trackEvent(this.event,n,t)},__class__:ul};var hl=function(e,t,n){this.allowHash=!0,this.customVariables=[],hl.setConfig(null!=n?n:new nl),this.setAccountId(e),this.setDomainName(t)};(n["googleAnalytics.Tracker"]=hl).__name__=["googleAnalytics","Tracker"],hl.getConfig=function(){return hl.config},hl.setConfig=function(e){hl.config=e},hl._raiseError=function(e,t){switch(e=t+"(): "+e,null!=hl.config?hl.config.getErrorSeverity():0){case 0:break;case 1:Nl.trace(e,{fileName:"Tracker.hx",lineNumber:253,className:"googleAnalytics.Tracker",methodName:"_raiseError"});break;case 2:throw new ao(e)}},hl.prototype={accountId:null,domainName:null,allowHash:null,customVariables:null,campaign:null,setAccountId:function(e){new a("^(UA|MO)-[0-9]*-[0-9]*$","").match(e)||hl._raiseError('"'+e+'" is not a valid Google Analytics account ID.',"Tracker.setAccountId"),this.accountId=e},getAccountId:function(){return this.accountId},setDomainName:function(e){this.domainName=e},getDomainName:function(){return this.domainName},setAllowHash:function(e){this.allowHash=e},getAllowHash:function(){return this.allowHash},addCustomVariable:function(e){e.validate(),this.customVariables[e.getIndex()]=e},getCustomVariables:function(){return this.customVariables},removeCustomVariable:function(e){s.remove(this.customVariables,this.customVariables[e])},setCampaign:function(e){null!=e&&e.validate(),this.campaign=e},getCampaign:function(){return this.campaign},trackPageview:function(e,t,n){var i=new zl(hl.config);i.setPage(e),i.setSession(t),i.setVisitor(n),i.setTracker(this),i.send()},trackEvent:function(e,t,n){e.validate();var i=new yl(hl.config);i.setEvent(e),i.setSession(t),i.setVisitor(n),i.setTracker(this),i.send()},trackTransaction:function(e,t,n){e.validate();var i=new kl(hl.config);i.setTransaction(e),i.setSession(t),i.setVisitor(n),i.setTracker(this),i.send();for(var r=e.getItems().iterator();r.hasNext();){var a=r.next();a.validate();var s=new xl(hl.config);s.setItem(a),s.setSession(t),s.setVisitor(n),s.setTracker(this),s.send()}},trackSocial:function(e,t,n,i){var r=new wl(hl.config);r.setSocialInteraction(e),r.setPage(t),r.setSession(n),r.setVisitor(i),r.setTracker(this),r.send()},__class__:hl};var cl=function(){this.items=new Ll};(n["googleAnalytics.Transaction"]=cl).__name__=["googleAnalytics","Transaction"],cl.prototype={orderId:null,affiliation:null,total:null,tax:null,shipping:null,city:null,region:null,country:null,items:null,validate:function(){null==this.items&&hl._raiseError("Transactions need to consist of at least one item.","Transaction.validate")},addItem:function(e){e.setOrderId(this.orderId),this.items.set(e.getSku(),e)},getItems:function(){return this.items},getOrderId:function(){return this.orderId},setOrderId:function(e){this.orderId=e;for(var t=this.items.iterator();t.hasNext();)t.next().setOrderId(e)},getAffiliation:function(){return this.affiliation},setAffiliation:function(e){this.affiliation=e},getTotal:function(){return this.total},setTotal:function(e){this.total=e},getTax:function(){return this.tax},setTax:function(e){this.tax=e},getShipping:function(){return this.shipping},setShipping:function(e){this.shipping=e},getCity:function(){return this.city},setCity:function(e){this.city=e},getRegion:function(){return this.region},setRegion:function(e){this.region=e},getCountry:function(){return this.country},setCountry:function(e){this.country=e},__class__:cl};var dl=function(e){this.url=e;var t=new a("^(?:(?![^:@]+:[^:@/]*@)([^:/?#.]+):)?(?://)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\\d*))?)(((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[?#]|$)))*/?)?([^?#/]*))(?:\\?([^#]*))?(?:#(.*))?)","");t.match(e);for(var n=0,i=dl.parts.length;n<i;){var r=n++;_.setField(this,dl.parts[r],t.matched(r))}};(n["googleAnalytics.URLParser"]=dl).__name__=["googleAnalytics","URLParser"],dl.parse=function(e){return new dl(e)},dl.prototype={url:null,source:null,protocol:null,authority:null,userInfo:null,user:null,password:null,host:null,port:null,relative:null,path:null,directory:null,file:null,query:null,anchor:null,toString:function(){for(var e="For Url -> "+this.url+"\n",t=0,n=dl.parts.length;t<n;){var i=t++;e+=dl.parts[i]+": "+p.string(_.field(this,dl.parts[i]))+(i==dl.parts.length-1?"":"\n")}return e},__class__:dl};var ml=function(){var e=new rl;this.uniqueId=0,this.setFirstVisitTime(e),this.setPreviousVisitTime(e),this.setCurrentVisitTime(e),this.setVisitCount(1)};(n["googleAnalytics.Visitor"]=ml).__name__=["googleAnalytics","Visitor"],ml.prototype={uniqueId:null,firstVisitTime:null,previousVisitTime:null,currentVisitTime:null,visitCount:null,ipAddress:null,userAgent:null,locale:null,flashVersion:null,javaEnabled:null,screenColorDepth:null,screenResolution:null,fromUtma:function(e){var t=e.split(".");return 6!=t.length?hl._raiseError('The given "__utma" cookie value is invalid.',"Visitor.fromUtma"):(this.setUniqueId(gl.parseInt(t[1],0)),this.setFirstVisitTime(new rl(t[2])),this.setPreviousVisitTime(new rl(t[3])),this.setCurrentVisitTime(new rl(t[4])),this.setVisitCount(gl.parseInt(t[5],0))),this},generateHash:function(){return gl.generateHash(this.userAgent+this.screenResolution+this.screenColorDepth)},generateUniqueId:function(){return 2147483647&(gl.generate32bitRandom()^this.generateHash())},setUniqueId:function(e){(e<0||2147483647<e)&&hl._raiseError("Visitor unique ID has to be a 32-bit integer between 0 and 2147483647.","Visitor.setUniqueId"),this.uniqueId=e},getUniqueId:function(){return 0==this.uniqueId&&(this.uniqueId=this.generateUniqueId()),this.uniqueId},addSession:function(e){var t=e.getStartTime();t!=this.currentVisitTime&&(this.previousVisitTime=this.currentVisitTime,this.currentVisitTime=t,++this.visitCount)},setFirstVisitTime:function(e){this.firstVisitTime=e},getFirstVisitTime:function(){return this.firstVisitTime},setPreviousVisitTime:function(e){this.previousVisitTime=e},getPreviousVisitTime:function(){return this.previousVisitTime},setCurrentVisitTime:function(e){this.currentVisitTime=e},getCurrentVisitTime:function(){return this.currentVisitTime},setVisitCount:function(e){this.visitCount=e},getVisitCount:function(){return this.visitCount},setIpAddress:function(e){this.ipAddress=e},getIpAddress:function(){return this.ipAddress},setUserAgent:function(e){this.userAgent=e},getUserAgent:function(){return this.userAgent},setLocale:function(e){this.locale=e},getLocale:function(){return this.locale},setFlashVersion:function(e){this.flashVersion=e},getFlashVersion:function(){return this.flashVersion},setJavaEnabled:function(e){this.javaEnabled=e},getJavaEnabled:function(){return this.javaEnabled},setScreenColorDepth:function(e){this.screenColorDepth=e},getScreenColorDepth:function(){return this.screenColorDepth},setScreenResolution:function(e){this.screenResolution=e},getScreenResolution:function(){return this.screenResolution},__class__:ml};var fl=function(){this.utmwv="5.2.5",this.utmr=this.utmcs=this.utmfl=this.utmje="0"};(n["googleAnalytics.internals.ParameterHolder"]=fl).__name__=["googleAnalytics","internals","ParameterHolder"],fl.prototype={utmwv:null,utmac:null,utmhn:null,utmvid:null,utmt:null,utms:null,utmn:null,utmcc:null,utme:null,utmni:null,utmu:null,utmp:null,utmdt:null,utmcs:null,utmr:null,utmip:null,utmul:null,utmfl:null,utmje:null,utmsc:null,utmsr:null,__utma:null,utmhid:null,__utmb:null,__utmc:null,utmipc:null,utmipn:null,utmipr:null,utmiqt:null,utmiva:null,utmtid:null,utmtst:null,utmtto:null,utmttx:null,utmtsp:null,utmtci:null,utmtrg:null,utmtco:null,utmcn:null,utmcr:null,utmcid:null,utmcsr:null,utmgclid:null,utmdclid:null,utmccn:null,utmcmd:null,utmctr:null,utmcct:null,utmcvr:null,__utmz:null,utmsn:null,utmsa:null,utmsid:null,__utmx:null,__utmv:null,toHashTable:function(){for(var e=new Ll,t=0,n=d.getInstanceFields(fl);t<n.length;){var i=n[t];++t,"_"==i.charAt(0)||_.isFunction(_.field(this,i))||e.set(i,_.field(this,i))}return e},toQueryString:function(){for(var e="",t=0,n=d.getInstanceFields(fl);t<n.length;){var i=n[t];++t,"_"==i.charAt(0)||_.isFunction(_.field(this,i))||null==_.field(this,i)||"null"==_.field(this,i)||(e+=i+"="+h.replace(p.string(_.field(this,i))+"","&","%26")+"&")}return e},__class__:fl};var gl=function(){};(n["googleAnalytics.internals.Util"]=gl).__name__=["googleAnalytics","internals","Util"],gl.encodeUriComponent=function(e){return gl.convertToUriComponentEncoding(h.urlEncode(e))},gl.stringReplaceArray=function(e,t,n){for(var i=0,r=t.length;i<r;){var a=i++;null!=t[a]&&(e=h.replace(e+" ",t[a],n[a]))}return h.trim(e)},gl.parseInt=function(e,t){return null==e?t:p.parseInt(e)},gl.convertToUriComponentEncoding=function(e){return gl.stringReplaceArray(e,["!","*","'","(",")"," ","+"],["%21","%2A","%27","%28","%29","%20","%20"])},gl.generate32bitRandom=function(){return Math.round(2147483647*Math.random())},gl.generateHash=function(e){var t,n,i=1;if(null!=e&&""!=e){i=0;for(var r=e.length-1;0<=r;)0!=(n=266338304&(i=(i<<6&268435455)+(t=s.cca(e,r))+(t<<14)))&&(i^=n>>21),--r}return i};var vl=function(){this.projectData=new Ll,this.KEY="k",this.VALUE="v",this.SET=["k","v"],this.DELIM_BEGIN="(",this.DELIM_END=")",this.DELIM_SET="*",this.DELIM_NUM_VALUE="!",this.MINIMUM=1,this.ESCAPE_CHAR_MAP=new Ll,this.ESCAPE_CHAR_MAP.set("'","'0"),this.ESCAPE_CHAR_MAP.set(")","'1"),this.ESCAPE_CHAR_MAP.set("*","'2"),this.ESCAPE_CHAR_MAP.set("!","'3")};(n["googleAnalytics.internals.X10"]=vl).__name__=["googleAnalytics","internals","X10"],vl.prototype={projectData:null,KEY:null,VALUE:null,SET:null,DELIM_BEGIN:null,DELIM_END:null,DELIM_SET:null,DELIM_NUM_VALUE:null,ESCAPE_CHAR_MAP:null,MINIMUM:null,hasProject:function(e){return this.projectData.exists(e)},setKey:function(e,t,n){this.setInternal(e,this.KEY,t,n)},getKey:function(e,t){return this.getInternal(e,this.KEY,t)},clearKey:function(e){this.clearInternal(e,this.KEY)},setValue:function(e,t,n){this.setInternal(e,this.VALUE,t,n)},getValue:function(e,t){return this.getInternal(e,this.VALUE,t)},clearValue:function(e){this.clearInternal(e,this.VALUE)},setInternal:function(e,t,n,i){this.projectData.exists(e)||this.projectData.set(e,new Ll);var r=this.projectData.get(e);r.exists(t)||r.set(t,[]),r.get(t)[n]=i},getInternal:function(e,t,n){if(!this.projectData.exists(e))return null;var i=this.projectData.get(e);if(!i.exists(t))return null;var r=i.get(t);return null==r[n]?null:r[n]},clearInternal:function(e,t){this.projectData.exists(e)&&this.projectData.get(e).exists(t)&&this.projectData.get(e).remove(t)},escapeExtensibleValue:function(e){for(var t="",n=0,i=e.length;n<i;){var r=n++,a=e.charAt(r);this.ESCAPE_CHAR_MAP.exists(a)?t+=this.ESCAPE_CHAR_MAP.get(a):t+=a}return t},SORT_NUMERIC:function(e,t){return e==t?0:t<e?1:-1},renderDataType:function(e){for(var t=[],n=0,i=0,r=e.length;i<r;){var a=i++,s=e[a];if(null!=s){var l="";a!=this.MINIMUM&&a-1!=n&&(l+=a,l+=this.DELIM_NUM_VALUE),l+=this.escapeExtensibleValue(s),t.push(l)}n=a}return this.DELIM_BEGIN+t.join(this.DELIM_SET)+this.DELIM_END},renderProject:function(e){for(var t="",n=!1,i=0,r=this.SET.length;i<r;){var a=i++;n=!e.exists(this.SET[a])||(n&&(t+=this.SET[a]),t+=this.renderDataType(e.get(this.SET[a])),!1)}return t},renderUrlString:function(){for(var e="",t=this.projectData.keys();t.hasNext();){var n=t.next();e+=n+this.renderProject(this.projectData.get(n))}return e},__class__:vl};var bl=function(e){this.setConfig(null!=e?e:new nl)};(n["googleAnalytics.internals.request.Request"]=bl).__name__=["googleAnalytics","internals","request","Request"],bl.onError=function(e){},bl.prototype={type:null,config:null,userAgent:null,tracker:null,visitor:null,session:null,getConfig:function(){return this.config},setConfig:function(e){this.config=e},setUserAgent:function(e){this.userAgent=e},getTracker:function(){return this.tracker},setTracker:function(e){this.tracker=e},getVisitor:function(){return this.visitor},setVisitor:function(e){this.visitor=e},getSession:function(){return this.session},setSession:function(e){this.session=e},increaseTrackCount:function(){this.session.increaseTrackCount(),500<this.session.getTrackCount()&&hl._raiseError("Google Analytics does not guarantee to process more than 500 requests per session.","Request.buildHttpRequest"),null!=this.tracker.getCampaign()&&this.tracker.getCampaign().increaseResponseCount()},send:function(){if(null!=this.config.getEndPointHost()){var e=this.buildParameters();null!=this.visitor&&(this.setUserAgent(this.visitor.getUserAgent()),e.utmvid=this.visitor.getUniqueId());var t=gl.convertToUriComponentEncoding(e.toQueryString()),n=this.config.getUrlScheme()+"://"+this.config.getEndPointHost()+this.config.getEndPointPath()+"?"+t;this.increaseTrackCount(),(new Image).src=n}},getType:function(){return null},buildParameters:function(){var e=new fl;return e.utmac=this.tracker.getAccountId(),e.utmhn=this.tracker.getDomainName(),e.utmt=""+this.getType(),e.utmn=gl.generate32bitRandom(),e.utmip=this.visitor.getIpAddress(),e.utmhid=this.session.getSessionId(),e.utms=this.session.getTrackCount(),e=this.buildVisitorParameters(e),e=this.buildCustomVariablesParameter(e),e=this.buildCampaignParameters(e),this.buildCookieParameters(e)},buildVisitorParameters:function(e){return null!=this.visitor.getLocale()&&(e.utmul=h.replace(this.visitor.getLocale(),"_","-").toLowerCase()),null!=this.visitor.getFlashVersion()&&(e.utmfl=this.visitor.getFlashVersion()),e.utmje=this.visitor.getJavaEnabled()?"1":"0",null!=this.visitor.getScreenColorDepth()&&(e.utmsc=this.visitor.getScreenColorDepth()+"-bit"),e.utmsr=this.visitor.getScreenResolution(),e},buildCustomVariablesParameter:function(e){var t=this.tracker.getCustomVariables();if(null==t)return e;5<t.length&&hl._raiseError("The sum of all custom variables cannot exceed 5 in any given request.","Request.buildCustomVariablesParameter");var n,i,r=new vl;r.clearKey("8"),r.clearKey("9"),r.clearKey("11");for(var a=0;a<t.length;){var s=t[a];++a,n=gl.encodeUriComponent(s.getName()),i=gl.encodeUriComponent(s.getValue()),r.setKey("8",s.getIndex(),n),r.setKey("9",s.getIndex(),i),3!=s.getScope()&&r.setKey("11",s.getIndex(),s.getScope())}var l=r.renderUrlString();return null!=l&&(null==e.utme?e.utme=l:e.utme+=l),e},buildCookieParameters:function(e){var t=this.generateDomainHash();e.__utma=t+".",e.__utma+=this.visitor.getUniqueId()+".",e.__utma+=this.visitor.getFirstVisitTime().toString()+".",e.__utma+=this.visitor.getPreviousVisitTime().toString()+".",e.__utma+=this.visitor.getCurrentVisitTime().toString()+".",e.__utma+=this.visitor.getVisitCount(),e.__utmb=t+".",e.__utmb+=this.session.getTrackCount()+".",e.__utmb+="10.",e.__utmb+=this.session.getStartTime().toString(),e.__utmc=t;var n="__utma="+e.__utma+";";return null!=e.__utmz&&(n+="+__utmz="+e.__utmz+";"),null!=e.__utmv&&(n+="+__utmv="+e.__utmv+";"),e.utmcc=n,e},buildCampaignParameters:function(e){var t=this.tracker.getCampaign();if(null==t)return e;e.__utmz=this.generateDomainHash()+".",e.__utmz+=t.getCreationTime().toString()+".",e.__utmz+=this.visitor.getVisitCount()+".",e.__utmz+=t.getResponseCount()+".";var n="utmcid="+t.getId()+"|utmcsr="+t.getSource()+"|utmgclid="+t.getGClickId()+"|utmdclid="+t.getDClickId()+"|utmccn="+t.getName()+"|utmcmd="+t.getMedium()+"|utmctr="+t.getTerm()+"|utmcct="+t.getContent();return e.__utmz+=h.replace(h.replace(n,"+","%20")," ","%20"),e},generateDomainHash:function(){var e=1;return this.tracker.getAllowHash()&&(e=gl.generateHash(this.tracker.getDomainName())),e},__class__:bl};var yl=function(e){bl.call(this,e)};(n["googleAnalytics.internals.request.EventRequest"]=yl).__name__=["googleAnalytics","internals","request","EventRequest"],yl.__super__=bl,yl.prototype=r(bl.prototype,{event:null,getType:function(){return"event"},buildParameters:function(){var e=bl.prototype.buildParameters.call(this),t=new vl;t.clearKey("5"),t.clearValue("5"),t.setKey("5",1,this.event.getCategory()),t.setKey("5",2,this.event.getAction()),null!=this.event.getLabel()&&t.setKey("5",3,this.event.getLabel()),0!=this.event.getValue()&&t.setValue("5",1,this.event.getValue());var n=t.renderUrlString();return null!=n&&(null==e.utme?e.utme=n:e.utme+=n),this.event.getNoninteraction()&&(e.utmni=1),e},getEvent:function(){return this.event},setEvent:function(e){this.event=e},__class__:yl});var xl=function(e){bl.call(this,e)};(n["googleAnalytics.internals.request.ItemRequest"]=xl).__name__=["googleAnalytics","internals","request","ItemRequest"],xl.__super__=bl,xl.prototype=r(bl.prototype,{item:null,getType:function(){return"item"},buildParameters:function(){var e=bl.prototype.buildParameters.call(this);return e.utmtid=this.item.getOrderId(),e.utmipc=this.item.getSku(),e.utmipn=this.item.getName(),e.utmiva=this.item.getVariation(),e.utmipr=this.item.getPrice(),e.utmiqt=this.item.getQuantity(),e},buildVisitorParameters:function(e){return e},buildCustomVariablesParameter:function(e){return e},getItem:function(){return this.item},setItem:function(e){this.item=e},__class__:xl});var zl=function(e){bl.call(this,e)};(n["googleAnalytics.internals.request.PageviewRequest"]=zl).__name__=["googleAnalytics","internals","request","PageviewRequest"],zl.__super__=bl,zl.prototype=r(bl.prototype,{page:null,getType:function(){return null},buildParameters:function(){var e=bl.prototype.buildParameters.call(this);return e.utmp=this.page.getPath(),e.utmdt=this.page.getTitle(),null!=this.page.getCharset()&&(e.utmcs=this.page.getCharset()),null!=this.page.getReferrer()&&(e.utmr=this.page.getReferrer()),0!=this.page.getLoadTime()&&e.utmn%100<this.config.getSitespeedSampleRate()&&(null==e.utme?e.utme="0":e.utme+=0),e},getPage:function(){return this.page},setPage:function(e){this.page=e},__class__:zl});var wl=function(e){zl.call(this,e)};(n["googleAnalytics.internals.request.SocialInteractionRequest"]=wl).__name__=["googleAnalytics","internals","request","SocialInteractionRequest"],wl.__super__=zl,wl.prototype=r(zl.prototype,{socialInteraction:null,getType:function(){return"social"},buildParameters:function(){var e=zl.prototype.buildParameters.call(this);return e.utmsn=this.socialInteraction.getNetwork(),e.utmsa=this.socialInteraction.getAction(),e.utmsid=this.socialInteraction.getTarget(),null==e.utmsid&&(e.utmsid=this.page.getPath()),e},getSocialInteraction:function(){return this.socialInteraction},setSocialInteraction:function(e){this.socialInteraction=e},__class__:wl});var kl=function(e){bl.call(this,e)};(n["googleAnalytics.internals.request.TransactionRequest"]=kl).__name__=["googleAnalytics","internals","request","TransactionRequest"],kl.__super__=bl,kl.prototype=r(bl.prototype,{transaction:null,getType:function(){return"tran"},buildParameters:function(){var e=bl.prototype.buildParameters.call(this);return e.utmtid=this.transaction.getOrderId(),e.utmtst=this.transaction.getAffiliation(),e.utmtto=this.transaction.getTotal(),e.utmttx=this.transaction.getTax(),e.utmtsp=this.transaction.getShipping(),e.utmtci=this.transaction.getCity(),e.utmtrg=this.transaction.getRegion(),e.utmtco=this.transaction.getCountry(),e},buildVisitorParameters:function(e){return e},buildCustomVariablesParameter:function(e){return e},getTransaction:function(){return this.transaction},setTransaction:function(e){this.transaction=e},__class__:kl});var Sl=function(){};(n["haxe.IMap"]=Sl).__name__=["haxe","IMap"];var Cl=function(e,t){this.high=e,this.low=t};(n["haxe._Int64.___Int64"]=Cl).__name__=["haxe","_Int64","___Int64"],Cl.prototype={high:null,low:null,__class__:Cl};var Nl=function(){};(n["haxe.Log"]=Nl).__name__=["haxe","Log"],Nl.trace=function(e,t){so.__trace(e,t)};var Pl=function(e){var t=this;this.id=setInterval(function(){t.run()},e)};(n["haxe.Timer"]=Pl).__name__=["haxe","Timer"],Pl.delay=function(e,t){var n=new Pl(t);return n.run=function(){n.stop(),e()},n},Pl.prototype={id:null,stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:Pl};var Ml=function(){this.a1=1,this.a2=0};(n["haxe.crypto.Adler32"]=Ml).__name__=["haxe","crypto","Adler32"],Ml.read=function(e){var t=new Ml,n=e.readByte(),i=e.readByte(),r=e.readByte(),a=e.readByte();return t.a1=r<<8|a,t.a2=n<<8|i,t},Ml.prototype={a1:null,a2:null,update:function(e,t,n){for(var i=this.a1,r=this.a2,a=t,s=t+n;a<s;){var l=a++;r=(r+(i=(i+e.get(l))%65521))%65521}this.a1=i,this.a2=r},equals:function(e){return e.a1==this.a1&&e.a2==this.a2},__class__:Ml};var Il=function(e){this.length=e.byteLength,this.b=new jc(e),(this.b.bufferValue=e).hxBytes=this,e.bytes=this.b};(n["haxe.io.Bytes"]=Il).__name__=["haxe","io","Bytes"],Il.alloc=function(e){return new Il(new Ec(e))},Il.ofString=function(e){for(var t=[],n=0;n<e.length;){var i=h.fastCodeAt(e,n++);55296<=i&&i<=56319&&(i=i-55232<<10|1023&h.fastCodeAt(e,n++)),i<=127?t.push(i):(i<=2047?t.push(192|i>>6):(i<=65535?t.push(224|i>>12):(t.push(240|i>>18),t.push(128|i>>12&63)),t.push(128|i>>6&63)),t.push(128|63&i))}return new Il(new jc(t).buffer)},Il.ofData=function(e){var t=e.hxBytes;return null!=t?t:new Il(e)},Il.fastGet=function(e,t){return e.bytes[t]},Il.prototype={length:null,b:null,data:null,get:function(e){return this.b[e]},set:function(e,t){this.b[e]=255&t},blit:function(e,t,n,i){if(e<0||n<0||i<0||e+i>this.length||n+i>t.length)throw new ao(Zl.OutsideBounds);0==n&&i==t.b.byteLength?this.b.set(t.b,e):this.b.set(t.b.subarray(n,n+i),e)},initData:function(){null==this.data&&(this.data=new Bc(this.b.buffer,this.b.byteOffset,this.b.byteLength))},getDouble:function(e){return this.initData(),this.data.getFloat64(e,!0)},setDouble:function(e,t){this.initData(),this.data.setFloat64(e,t,!0)},getUInt16:function(e){return this.initData(),this.data.getUint16(e,!0)},setUInt16:function(e,t){this.initData(),this.data.setUint16(e,t,!0)},getString:function(e,t){if(e<0||t<0||e+t>this.length)throw new ao(Zl.OutsideBounds);for(var n="",i=this.b,r=String.fromCharCode,a=e,s=e+t;a<s;){var l=i[a++];if(l<128){if(0==l)break;n+=r(l)}else if(l<224)n+=r((63&l)<<6|127&i[a++]);else if(l<240)n+=r((31&l)<<12|(127&i[a++])<<6|127&i[a++]);else{var o=(15&l)<<18|(127&i[a++])<<12|(127&i[a++])<<6|127&i[a++];n+=r(55232+(o>>10)),n+=r(1023&o|56320)}}return n},toString:function(){return this.getString(0,this.length)},__class__:Il};var Tl=function(){};(n["haxe.crypto.Base64"]=Tl).__name__=["haxe","crypto","Base64"],Tl.encode=function(e,t){null==t&&(t=!0);var n=new Al(Tl.BYTES).encodeBytes(e).toString();if(t)switch(e.length%3){case 1:n+="==";break;case 2:n+="="}return n},Tl.decode=function(e,t){if(null==t&&(t=!0),t)for(;61==s.cca(e,e.length-1);)e=s.substr(e,0,-1);return new Al(Tl.BYTES).decodeBytes(Il.ofString(e))};var Al=function(e){for(var t=e.length,n=1;1<<n<t;)++n;if(8<n||t!=1<<n)throw new ao("BaseCode : base length must be a power of two.");this.base=e,this.nbits=n};(n["haxe.crypto.BaseCode"]=Al).__name__=["haxe","crypto","BaseCode"],Al.prototype={base:null,nbits:null,tbl:null,encodeBytes:function(e){for(var t=this.nbits,n=this.base,i=p.int(8*e.length/t),r=Il.alloc(i+(8*e.length%t==0?0:1)),a=0,s=0,l=(1<<t)-1,o=0,_=0;_<i;){for(;s<t;)s+=8,a<<=8,a|=e.get(o++);s-=t,r.set(_++,n.get(a>>s&l))}return 0<s&&r.set(_++,n.get(a<<t-s&l)),r},initTable:function(){for(var e=[],t=0;t<256;)e[t++]=-1;for(var n=0,i=this.base.length;n<i;){var r=n++;e[this.base.get(r)]=r}this.tbl=e},decodeBytes:function(e){var t=this.nbits;this.base,null==this.tbl&&this.initTable();for(var n=this.tbl,i=e.length*t>>3,r=Il.alloc(i),a=0,s=0,l=0,o=0;o<i;){for(;s<8;){s+=t,a<<=t;var _=n[e.get(l++)];if(-1==_)throw new ao("BaseCode : invalid encoded char");a|=_}s-=8,r.set(o++,a>>s&255)}return r},__class__:Al};var Dl=function(){};(n["haxe.ds.ArraySort"]=Dl).__name__=["haxe","ds","ArraySort"],Dl.sort=function(e,t){Dl.rec(e,t,0,e.length)},Dl.rec=function(e,t,n,i){var r=n+i>>1;if(i-n<12){if(i<=n)return;for(var a=n+1,s=i;a<s;)for(var l=a++;n<l&&Dl.compare(e,t,l,l-1)<0;)Dl.swap(e,l-1,l),--l}else Dl.rec(e,t,n,r),Dl.rec(e,t,r,i),Dl.doMerge(e,t,n,r,i,r-n,i-r)},Dl.doMerge=function(e,t,n,i,r,a,s){var l,o,_,p,u;0!=a&&0!=s&&(a+s!=2?(s<a?p=(o=Dl.lower(e,t,i,r,l=n+(_=a>>1)))-i:_=(l=Dl.upper(e,t,n,i,o=i+(p=s>>1)))-n,Dl.rotate(e,t,l,i,o),Dl.doMerge(e,t,n,l,u=l+p,_,p),Dl.doMerge(e,t,u,o,r,a-_,s-p)):Dl.compare(e,t,i,n)<0&&Dl.swap(e,i,n))},Dl.rotate=function(e,t,n,i,r){var a;if(n!=i&&i!=r)for(a=Dl.gcd(r-n,i-n);0!=a--;){for(var s=e[n+a],l=i-n,o=n+a,_=n+a+l;_!=n+a;)e[o]=e[_],l<r-(o=_)?_+=l:_=n+(l-(r-_));e[o]=s}},Dl.gcd=function(e,t){for(;0!=t;){var n=e%t;e=t,t=n}return e},Dl.upper=function(e,t,n,i,r){for(var a,s,l=i-n;0<l;)l=Dl.compare(e,t,r,s=n+(a=l>>1))<0?a:(n=s+1,l-a-1);return n},Dl.lower=function(e,t,n,i,r){for(var a,s,l=i-n;0<l;)l=Dl.compare(e,t,s=n+(a=l>>1),r)<0?(n=s+1,l-a-1):a;return n},Dl.swap=function(e,t,n){var i=e[t];e[t]=e[n],e[n]=i},Dl.compare=function(e,t,n,i){return t(e[n],e[i])};var El=function(){this.h={}};(n["haxe.ds.IntMap"]=El).__name__=["haxe","ds","IntMap"],El.__interfaces__=[Sl],El.prototype={h:null,set:function(e,t){this.h[e]=t},get:function(e){return this.h[e]},exists:function(e){return this.h.hasOwnProperty(e)},__class__:El};var Ol=function(){this.h={__keys__:{}}};(n["haxe.ds.ObjectMap"]=Ol).__name__=["haxe","ds","ObjectMap"],Ol.__interfaces__=[Sl],Ol.assignId=function(e){return e.__id__=++Ol.count},Ol.getId=function(e){return e.__id__},Ol.prototype={h:null,set:function(e,t){var n=Ol.getId(e)||Ol.assignId(e);this.h[n]=t,this.h.__keys__[n]=e},get:function(e){return this.h[Ol.getId(e)]},remove:function(e){var t=Ol.getId(e);return null!=this.h.__keys__[t]&&(delete this.h[t],delete this.h.__keys__[t],!0)},keys:function(){var e=[];for(var t in this.h.__keys__)this.h.hasOwnProperty(t)&&e.push(this.h.__keys__[t]);return s.iter(e)},__class__:Ol};var Bl=function(e,t){this.map=e,this.keys=t,this.index=0,this.count=t.length};(n["haxe.ds._StringMap.StringMapIterator"]=Bl).__name__=["haxe","ds","_StringMap","StringMapIterator"],Bl.prototype={map:null,keys:null,index:null,count:null,hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:Bl};var Ll=function(){this.h={}};(n["haxe.ds.StringMap"]=Ll).__name__=["haxe","ds","StringMap"],Ll.__interfaces__=[Sl],Ll.prototype={h:null,rh:null,isReserved:function(e){return null!=Dc[e]},set:function(e,t){this.isReserved(e)?this.setReserved(e,t):this.h[e]=t},get:function(e){return this.isReserved(e)?this.getReserved(e):this.h[e]},exists:function(e){return this.isReserved(e)?this.existsReserved(e):this.h.hasOwnProperty(e)},setReserved:function(e,t){null==this.rh&&(this.rh={}),this.rh["$"+e]=t},getReserved:function(e){return null==this.rh?null:this.rh["$"+e]},existsReserved:function(e){return null!=this.rh&&this.rh.hasOwnProperty("$"+e)},remove:function(e){return this.isReserved(e)?(e="$"+e,!(null==this.rh||!this.rh.hasOwnProperty(e)||(delete this.rh[e],0))):!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){return s.iter(this.arrayKeys())},arrayKeys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(t);if(null!=this.rh)for(var t in this.rh)36==t.charCodeAt(0)&&e.push(t.substr(1));return e},iterator:function(){return new Bl(this,this.arrayKeys())},__class__:Ll};var jl=function(){this.b=[]};(n["haxe.io.BytesBuffer"]=jl).__name__=["haxe","io","BytesBuffer"],jl.prototype={b:null,addBytes:function(e,t,n){if(t<0||n<0||t+n>e.length)throw new ao(Zl.OutsideBounds);this.b;for(var i=e.b,r=t,a=t+n;r<a;){var s=r++;this.b.push(i[s])}},getBytes:function(){var e=new Il(new jc(this.b).buffer);return this.b=null,e},__class__:jl};var Fl=function(){};(n["haxe.io.Input"]=Fl).__name__=["haxe","io","Input"],Fl.prototype={bigEndian:null,readByte:function(){throw new ao("Not implemented")},readBytes:function(e,t,n){var i=n,r=e.b;if(t<0||n<0||t+n>e.length)throw new ao(Zl.OutsideBounds);try{for(;0<i;)r[t]=this.readByte(),++t,--i}catch(e){if(e instanceof ao&&(e=e.val),!so.__instanceof(e,Gl))throw e}return n-i},read:function(e){for(var t=Il.alloc(e),n=0;0<e;){var i=this.readBytes(t,n,e);if(0==i)throw new ao(Zl.Blocked);n+=i,e-=i}return t},readUInt16:function(){var e=this.readByte(),t=this.readByte();return this.bigEndian?t|e<<8:e|t<<8},__class__:Fl};var Rl=function(e,t,n){if(null==t&&(t=0),null==n&&(n=e.length-t),t<0||n<0||t+n>e.length)throw new ao(Zl.OutsideBounds);this.b=e.b,this.pos=t,this.len=n,this.totlen=n};(n["haxe.io.BytesInput"]=Rl).__name__=["haxe","io","BytesInput"],Rl.__super__=Fl,Rl.prototype=r(Fl.prototype,{b:null,pos:null,len:null,totlen:null,readByte:function(){if(0==this.len)throw new ao(new Gl);return this.len--,this.b[this.pos++]},readBytes:function(e,t,n){if(t<0||n<0||t+n>e.length)throw new ao(Zl.OutsideBounds);if(0==this.len&&0<n)throw new ao(new Gl);this.len<n&&(n=this.len);for(var i=this.b,r=e.b,a=0,s=n;a<s;){var l=a++;r[t+l]=i[this.pos+l]}return this.pos+=n,this.len-=n,n},__class__:Rl});var Gl=function(){};(n["haxe.io.Eof"]=Gl).__name__=["haxe","io","Eof"],Gl.prototype={toString:function(){return"Eof"},__class__:Gl};var Zl=n["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};Zl.Blocked=["Blocked",0],Zl.Blocked.toString=i,(Zl.Blocked.__enum__=Zl).Overflow=["Overflow",1],Zl.Overflow.toString=i,(Zl.Overflow.__enum__=Zl).OutsideBounds=["OutsideBounds",2],Zl.OutsideBounds.toString=i,(Zl.OutsideBounds.__enum__=Zl).Custom=function(e){var t=["Custom",3,e];return t.__enum__=Zl,t.toString=i,t},Zl.__empty_constructs__=[Zl.Blocked,Zl.Overflow,Zl.OutsideBounds];var Ul=function(){};(n["haxe.io.FPHelper"]=Ul).__name__=["haxe","io","FPHelper"],Ul.i32ToFloat=function(e){var t=e>>>23&255,n=8388607&e;return 0==n&&0==t?0:(1-(e>>>31<<1))*(1+Math.pow(2,-23)*n)*Math.pow(2,t-127)},Ul.floatToI32=function(e){if(0==e)return 0;var t=e<0?-e:e,n=Math.floor(Math.log(t)/.6931471805599453);n<-127?n=-127:128<n&&(n=128);var i=Math.round(8388608*(t/Math.pow(2,n)-1));return 8388608==i&&n<128&&(i=0,++n),(e<0?-2147483648:0)|n+127<<23|i},Ul.i64ToDouble=function(e,t){var n=(t>>20&2047)-1023,i=4294967296*(1048575&t)+2147483648*(e>>>31)+(2147483647&e);return 0==i&&-1023==n?0:(1-(t>>>31<<1))*(1+Math.pow(2,-52)*i)*Math.pow(2,n)},Ul.doubleToI64=function(e){var t=Ul.i64tmp;if(0==e)t.low=0,t.high=0;else if(isFinite(e)){var n=e<0?-e:e,i=Math.floor(Math.log(n)/.6931471805599453),r=Math.round(4503599627370496*(n/Math.pow(2,i)-1)),a=p.int(r),s=p.int(r/4294967296);t.low=a,t.high=(e<0?-2147483648:0)|i+1023<<20|s}else t.high=0<e?(t.low=0,2146435072):(t.low=0,-1048576);return t};var Vl=function(e,t,n){this.xml=t,this.message=e,this.position=n,this.lineNumber=1;for(var i=this.positionAtLine=0,r=n;i<r;){var a=i++,s=h.fastCodeAt(t,a);10==s?(this.lineNumber++,this.positionAtLine=0):13!=s&&this.positionAtLine++}};(n["haxe.xml.XmlParserException"]=Vl).__name__=["haxe","xml","XmlParserException"],Vl.prototype={message:null,lineNumber:null,positionAtLine:null,position:null,xml:null,toString:function(){return d.getClassName(d.getClass(this))+": "+this.message+" at line "+this.lineNumber+" char "+this.positionAtLine},__class__:Vl};var ql=function(){};(n["haxe.xml.Parser"]=ql).__name__=["haxe","xml","Parser"],ql.parse=function(e,t){null==t&&(t=!1);var n=m.createDocument();return ql.doParse(e,t,0,n),n},ql.doParse=function(e,t,n,i){null==n&&(n=0);for(var r=null,a=1,l=1,o=null,_=0,c=0,d=0,f=h.fastCodeAt(e,n),g=new u,v=1,b=-1;!h.isEof(f);){switch(a){case 0:switch(f){case 9:case 10:case 13:case 32:break;default:a=l;continue}break;case 1:if(60!=f){_=n,a=13;continue}a=0,l=2;break;case 2:switch(f){case 33:if(91==h.fastCodeAt(e,n+1)){if("CDATA["!=s.substr(e,n+=2,6).toUpperCase())throw new ao(new Vl("Expected <![CDATA[",e,n));a=17,_=(n+=5)+1}else if(68==h.fastCodeAt(e,n+1)||100==h.fastCodeAt(e,n+1)){if("OCTYPE"!=s.substr(e,n+2,6).toUpperCase())throw new ao(new Vl("Expected <!DOCTYPE",e,n));a=16,_=(n+=8)+1}else{if(45!=h.fastCodeAt(e,n+1)||45!=h.fastCodeAt(e,n+2))throw new ao(new Vl("Expected \x3c!--",e,n));a=15,_=(n+=2)+1}break;case 47:if(null==i)throw new ao(new Vl("Expected node name",e,n));_=n+1,a=0,l=10;break;case 63:a=14,_=n;break;default:a=3,_=n;continue}break;case 3:if(ql.isValidChar(f))break;if(n==_)throw new ao(new Vl("Expected node name",e,n));r=m.createElement(s.substr(e,_,n-_)),i.addChild(r),++c,a=0,l=4;continue;case 4:switch(f){case 47:a=11;break;case 62:a=9;break;default:a=5,_=n;continue}break;case 5:if(ql.isValidChar(f))break;if(_==n)throw new ao(new Vl("Expected attribute name",e,n));if(o=s.substr(e,_,n-_),r.exists(o))throw new ao(new Vl("Duplicate attribute ["+o+"]",e,n));a=0,l=6;continue;case 6:if(61!=f)throw new ao(new Vl("Expected =",e,n));a=0,l=7;break;case 7:switch(f){case 34:case 39:g=new u,a=8,_=n+1,b=f;break;default:throw new ao(new Vl('Expected "',e,n))}break;case 8:switch(f){case 38:g.addSub(e,_,n-_),a=18,v=8,_=n+1;break;case 60:case 62:if(t)throw new ao(new Vl("Invalid unescaped "+String.fromCharCode(f)+" in attribute value",e,n));if(f==b){g.addSub(e,_,n-_);var y=g.toString();g=new u,r.set(o,y),a=0,l=4}break;default:if(f==b){g.addSub(e,_,n-_);var x=g.toString();g=new u,r.set(o,x),a=0,l=4}}break;case 9:_=n=ql.doParse(e,t,n,r),a=1;break;case 10:if(ql.isValidChar(f))break;if(_==n)throw new ao(new Vl("Expected node name",e,n));if(s.substr(e,_,n-_)!=i.get_nodeName())throw new ao(new Vl("Expected </"+i.get_nodeName()+">",e,n));a=0,l=12;continue;case 11:if(62!=f)throw new ao(new Vl("Expected >",e,n));a=1;break;case 12:if(62==f)return 0==c&&i.addChild(m.createPCData("")),n;throw new ao(new Vl("Expected >",e,n));case 13:if(60==f){g.addSub(e,_,n-_);var z=m.createPCData(g.toString());g=new u,i.addChild(z),++c,a=0,l=2}else 38==f&&(g.addSub(e,_,n-_),a=18,v=13,_=n+1);break;case 14:if(63==f&&62==h.fastCodeAt(e,n+1)){var w=s.substr(e,_+1,++n-_-2);i.addChild(m.createProcessingInstruction(w)),++c,a=1}break;case 15:45==f&&45==h.fastCodeAt(e,n+1)&&62==h.fastCodeAt(e,n+2)&&(i.addChild(m.createComment(s.substr(e,_,n-_))),++c,n+=2,a=1);break;case 16:91==f?++d:93==f?--d:62==f&&0==d&&(i.addChild(m.createDocType(s.substr(e,_,n-_))),++c,a=1);break;case 17:if(93==f&&93==h.fastCodeAt(e,n+1)&&62==h.fastCodeAt(e,n+2)){var k=m.createCData(s.substr(e,_,n-_));i.addChild(k),++c,n+=2,a=1}break;case 18:if(59==f){var S=s.substr(e,_,n-_);if(35==h.fastCodeAt(S,0)){var C=120==h.fastCodeAt(S,1)?p.parseInt("0"+s.substr(S,1,S.length-1)):p.parseInt(s.substr(S,1,S.length-1));g.addChar(C)}else if(ql.escapes.exists(S))g.add(ql.escapes.get(S));else{if(t)throw new ao(new Vl("Undefined entity: "+S,e,n));g.add("&"+S+";")}_=n+1,a=v}else if(!ql.isValidChar(f)&&35!=f){if(t)throw new ao(new Vl("Invalid character in entity: "+String.fromCharCode(f),e,n));g.addChar(38),g.addSub(e,_,n-_),_=n--,a=v}}f=h.fastCodeAt(e,++n)}if(1==a&&(_=n,a=13),13==a)return n==_&&0!=c||(g.addSub(e,_,n-_),i.addChild(m.createPCData(g.toString())),++c),n;if(!t&&18==a&&13==v)return g.addChar(38),g.addSub(e,_,n-_),i.addChild(m.createPCData(g.toString())),++c,n;throw new ao(new Vl("Unexpected end",e,n))},ql.isValidChar=function(e){return 97<=e&&e<=122||65<=e&&e<=90||48<=e&&e<=57||58==e||46==e||95==e||45==e};var Wl=n["haxe.zip.Huffman"]={__ename__:["haxe","zip","Huffman"],__constructs__:["Found","NeedBit","NeedBits"]};Wl.Found=function(e){var t=["Found",0,e];return t.__enum__=Wl,t.toString=i,t},Wl.NeedBit=function(e,t){var n=["NeedBit",1,e,t];return n.__enum__=Wl,n.toString=i,n},Wl.NeedBits=function(e,t){var n=["NeedBits",2,e,t];return n.__enum__=Wl,n.toString=i,n},Wl.__empty_constructs__=[];var Xl=function(){};(n["haxe.zip.HuffTools"]=Xl).__name__=["haxe","zip","HuffTools"],Xl.prototype={treeDepth:function(e){switch(d.enumIndex(e)){case 0:return 0;case 1:var t=e[3],n=e[2],i=this.treeDepth(n),r=this.treeDepth(t);return 1+(i<r?i:r);case 2:throw new ao("assert")}},treeCompress:function(e){var t=this.treeDepth(e);if(0==t)return e;if(1==t){if(1!=d.enumIndex(e))throw new ao("assert");var n=e[3],i=e[2];return Wl.NeedBit(this.treeCompress(i),this.treeCompress(n))}for(var r=[],a=0,s=1<<t;a<s;)a++,r.push(Wl.Found(-1));return this.treeWalk(r,0,0,t,e),Wl.NeedBits(t,r)},treeWalk:function(e,t,n,i,r){if(1==d.enumIndex(r)){var a=r[3],s=r[2];0<i?(this.treeWalk(e,t,n+1,i-1,s),this.treeWalk(e,t|1<<n,n+1,i-1,a)):e[t]=this.treeCompress(r)}else e[t]=this.treeCompress(r)},treeMake:function(e,t,n,i){if(t<i)throw new ao("Invalid huffman");var r=n<<5|i;return e.exists(r)?Wl.Found(e.get(r)):(n<<=1,++i,Wl.NeedBit(this.treeMake(e,t,n,i),this.treeMake(e,t,1|n,i)))},make:function(e,t,n,i){var r=[],a=[];if(32<i)throw new ao("Invalid huffman");for(var s=0,l=i;s<l;)s++,r.push(0),a.push(0);for(var o=0,_=n;o<_;){var p=e[o+++t];if(i<=p)throw new ao("Invalid huffman");r[p]++}for(var u=0,h=1,c=i-1;h<c;){var d=h++;u=u+r[d]<<1,a[d]=u}for(var m=new El,f=0,g=n;f<g;){var v=f++,b=e[v+t];if(0!=b){var y=a[b-1];a[b-1]=y+1,m.set(y<<5|b,v)}}return this.treeCompress(Wl.NeedBit(this.treeMake(m,i,0,1),this.treeMake(m,i,1,1)))},__class__:Xl};var Hl=function(e){this.buffer=Il.alloc(65536),this.pos=0,e&&(this.crc=new Ml)};(n["haxe.zip._InflateImpl.Window"]=Hl).__name__=["haxe","zip","_InflateImpl","Window"],Hl.prototype={buffer:null,pos:null,crc:null,slide:function(){null!=this.crc&&this.crc.update(this.buffer,0,32768);var e=Il.alloc(65536);this.pos-=32768,e.blit(0,this.buffer,32768,this.pos),this.buffer=e},addBytes:function(e,t,n){65536<this.pos+n&&this.slide(),this.buffer.blit(this.pos,e,t,n),this.pos+=n},addByte:function(e){65536==this.pos&&this.slide(),this.buffer.set(this.pos,e),this.pos++},getLastChar:function(){return this.buffer.get(this.pos-1)},available:function(){return this.pos},checksum:function(){return null!=this.crc&&this.crc.update(this.buffer,0,this.pos),this.crc},__class__:Hl};var Yl=n["haxe.zip._InflateImpl.State"]={__ename__:["haxe","zip","_InflateImpl","State"],__constructs__:["Head","Block","CData","Flat","Crc","Dist","DistOne","Done"]};Yl.Head=["Head",0],Yl.Head.toString=i,(Yl.Head.__enum__=Yl).Block=["Block",1],Yl.Block.toString=i,(Yl.Block.__enum__=Yl).CData=["CData",2],Yl.CData.toString=i,(Yl.CData.__enum__=Yl).Flat=["Flat",3],Yl.Flat.toString=i,(Yl.Flat.__enum__=Yl).Crc=["Crc",4],Yl.Crc.toString=i,(Yl.Crc.__enum__=Yl).Dist=["Dist",5],Yl.Dist.toString=i,(Yl.Dist.__enum__=Yl).DistOne=["DistOne",6],Yl.DistOne.toString=i,(Yl.DistOne.__enum__=Yl).Done=["Done",7],Yl.Done.toString=i,(Yl.Done.__enum__=Yl).__empty_constructs__=[Yl.Head,Yl.Block,Yl.CData,Yl.Flat,Yl.Crc,Yl.Dist,Yl.DistOne,Yl.Done];var Jl=function(e,t,n){null==n&&(n=!0),null==t&&(t=!0),this.final=!1,this.htools=new Xl,this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.len=0,this.dist=0,this.state=t?Yl.Head:Yl.Block,this.input=e,this.bits=0,this.nbits=0,this.needed=0,this.output=null,this.outpos=0,this.lengths=[];for(var i=0;i<19;)i++,this.lengths.push(-1);this.window=new Hl(n)};(n["haxe.zip.InflateImpl"]=Jl).__name__=["haxe","zip","InflateImpl"],Jl.run=function(e,t){null==t&&(t=65536);for(var n=Il.alloc(t),i=new jl,r=new Jl(e);;){var a=r.readBytes(n,0,t);if(i.addBytes(n,0,a),a<t)break}return i.getBytes()},Jl.prototype={nbits:null,bits:null,state:null,final:null,huffman:null,huffdist:null,htools:null,len:null,dist:null,needed:null,output:null,outpos:null,input:null,lengths:null,window:null,buildFixedHuffman:function(){if(null!=Jl.FIXED_HUFFMAN)return Jl.FIXED_HUFFMAN;for(var e=[],t=0;t<288;){var n=t++;e.push(n<=143?8:n<=255?9:n<=279?7:8)}return Jl.FIXED_HUFFMAN=this.htools.make(e,0,288,10)},readBytes:function(e,t,n){if(this.needed=n,this.outpos=t,this.output=e,0<n)for(;this.inflateLoop(););return n-this.needed},getBits:function(e){for(;this.nbits<e;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var t=this.bits&(1<<e)-1;return this.nbits-=e,this.bits>>=e,t},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());var e=1==(1&this.bits);return this.nbits--,this.bits>>=1,e},getRevBits:function(e){return 0==e?0:this.getBit()?1<<e-1|this.getRevBits(e-1):this.getRevBits(e-1)},resetBits:function(){this.bits=0,this.nbits=0},addBytes:function(e,t,n){this.window.addBytes(e,t,n),this.output.blit(this.outpos,e,t,n),this.needed-=n,this.outpos+=n},addByte:function(e){this.window.addByte(e),this.output.set(this.outpos,e),this.needed--,this.outpos++},addDistOne:function(e){for(var t=this.window.getLastChar(),n=0,i=e;n<i;)n++,this.addByte(t)},addDist:function(e,t){this.addBytes(this.window.buffer,this.window.pos-e,t)},applyHuffman:function(e){switch(d.enumIndex(e)){case 0:return e[2];case 1:var t=e[3],n=e[2];return this.applyHuffman(this.getBit()?t:n);case 2:var i=e[3],r=e[2];return this.applyHuffman(i[this.getBits(r)])}},inflateLengths:function(e,t){for(var n=0,i=0;n<t;){var r=this.applyHuffman(this.huffman);switch(r){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:i=r,e[n]=r,++n;break;case 16:var a=n+3+this.getBits(2);if(t<a)throw new ao("Invalid data");for(;n<a;)e[n]=i,++n;break;case 17:if(t<(n+=3+this.getBits(3)))throw new ao("Invalid data");break;case 18:if(t<(n+=11+this.getBits(7)))throw new ao("Invalid data");break;default:throw new ao("Invalid data")}}},inflateLoop:function(){var e=this.state;switch(d.enumIndex(e)){case 0:var t=this.input.readByte();if(8!=(15&t))throw new ao("Invalid data");var n=this.input.readByte(),i=0!=(32&n);if(((t<<8)+n)%31!=0)throw new ao("Invalid data");if(i)throw new ao("Unsupported dictionary");return this.state=Yl.Block,!0;case 1:switch(this.final=this.getBit(),this.getBits(2)){case 0:if(this.len=this.input.readUInt16(),this.input.readUInt16()!=65535-this.len)throw new ao("Invalid data");this.state=Yl.Flat;var r=this.inflateLoop();return this.resetBits(),r;case 1:return this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.state=Yl.CData,!0;case 2:for(var a=this.getBits(5)+257,s=this.getBits(5)+1,l=this.getBits(4)+4,o=0,_=l;o<_;){var p=o++;this.lengths[Jl.CODE_LENGTHS_POS[p]]=this.getBits(3)}for(var u=l;u<19;){var h=u++;this.lengths[Jl.CODE_LENGTHS_POS[h]]=0}this.huffman=this.htools.make(this.lengths,0,19,8);for(var c=[],m=0,f=a+s;m<f;)m++,c.push(0);return this.inflateLengths(c,a+s),this.huffdist=this.htools.make(c,a,s,16),this.huffman=this.htools.make(c,0,a,16),this.state=Yl.CData,!0;default:throw new ao("Invalid data")}break;case 2:var g=this.applyHuffman(this.huffman);if(g<256)return this.addByte(g),0<this.needed;if(256==g)return this.state=this.final?Yl.Crc:Yl.Block,!0;var v=Jl.LEN_EXTRA_BITS_TBL[g-=257];if(-1==v)throw new ao("Invalid data");this.len=Jl.LEN_BASE_VAL_TBL[g]+this.getBits(v);var b=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist);if(-1==(v=Jl.DIST_EXTRA_BITS_TBL[b]))throw new ao("Invalid data");if(this.dist=Jl.DIST_BASE_VAL_TBL[b]+this.getBits(v),this.dist>this.window.available())throw new ao("Invalid data");return this.state=1==this.dist?Yl.DistOne:Yl.Dist,!0;case 3:var y=this.len<this.needed?this.len:this.needed,x=this.input.read(y);return this.len-=y,this.addBytes(x,0,y),0==this.len&&(this.state=this.final?Yl.Crc:Yl.Block),0<this.needed;case 4:var z=this.window.checksum();if(null==z)return this.state=Yl.Done,!0;var w=Ml.read(this.input);if(!z.equals(w))throw new ao("Invalid CRC");return this.state=Yl.Done,!0;case 5:for(;0<this.len&&0<this.needed;){var k=this.len<this.dist?this.len:this.dist,S=this.needed<k?this.needed:k;this.addDist(this.dist,S),this.len-=S}return 0==this.len&&(this.state=Yl.CData),0<this.needed;case 6:var C=this.len<this.needed?this.len:this.needed;return this.addDistOne(C),this.len-=C,0==this.len&&(this.state=Yl.CData),0<this.needed;case 7:return!1}},__class__:Jl};var Kl=function(){};(n["haxe.zip.Uncompress"]=Kl).__name__=["haxe","zip","Uncompress"],Kl.run=function(e,t){return Jl.run(new Rl(e),t)};var Ql=function(){};(n["hxGeomAlgo.Debug"]=Ql).__name__=["hxGeomAlgo","Debug"],Ql.assert=function(e,t,n){};var $l=e.hxGeomAlgo.EarCut=function(){};(n["hxGeomAlgo.EarCut"]=$l).__name__=["hxGeomAlgo","EarCut"],$l.triangulate=function(e,t){var n=ro.toFloatArray(e),i=null,r=e;if(null!=t&&0<t.length){r=e.concat([]),ro.flatten(t,r),i=[];for(var a=e.length,s=0;s<t.length;){var l=t[s];++s;for(var o=0,_=ro.toFloatArray(l);o<_.length;){var p=_[o];++o,n.push(p)}i.push(a),a+=l.length}}for(var u=$l.earcut(n,i),h=[],c=0;c<u.length;){var d=[r[u[c]],r[u[c+1]],r[u[c+2]]];h.push(d),c+=3}return h},$l.earcut=function(e,t,n){null==n&&(n=2);var i,r,a,s,l,o,_=null!=t&&0<t.length,p=_?t[0]*n:e.length,u=$l.linkedList(e,0,p,n,!0),h=[];if(null==u)return h;u=$l.filterPoints(u);var c=NaN;if(i=r=a=s=l=o=c,_&&(u=$l.eliminateHoles(e,t,u,n)),e.length>80*n){i=a=e[0],r=s=e[1];for(var d=n;d<p;)(l=e[d])<i&&(i=l),(o=e[d+1])<r&&(r=o),a<l&&(a=l),s<o&&(s=o),d+=n;c=Math.max(a-i,s-r)}return $l.earcutLinked(u,h,n,i,r,c),h},$l.linkedList=function(e,t,n,i,r){var a,s=null;if(r==0<$l.signedArea(e,t,n,i))for(a=t;a<n;)s=$l.insertNode(a,e[a],e[a+1],s),a+=i;else for(a=n-i;t<=a;)s=$l.insertNode(a,e[a],e[a+1],s),a-=i;return null!=s&&$l.equals(s,s.next)&&($l.removeNode(s),s=s.next),s},$l.filterPoints=function(e,t){if(null==e)return e;null==t&&(t=e);for(var n,i=e;;){if(n=!1,i.steiner||!$l.equals(i,i.next)&&0!=$l.area(i.prev,i,i.next))i=i.next;else{if($l.removeNode(i),(i=t=i.prev)==i.next)return null;n=!0}if(!n&&i==t)break}return t},$l.earcutLinked=function(e,t,n,i,r,a,s){if(null==s&&(s=0),null!=e){0!=s||isNaN(a)||$l.indexCurve(e,i,r,a);for(var l,o,_=e;e.prev!=e.next;)if(l=e.prev,o=e.next,isNaN(a)?$l.isEar(e):$l.isEarHashed(e,i,r,a))t.push(p.int(l.i/n)),t.push(p.int(e.i/n)),t.push(p.int(o.i/n)),$l.removeNode(e),e=o.next,_=o.next;else if((e=o)==_){0==s?$l.earcutLinked($l.filterPoints(e),t,n,i,r,a,1):1==s?(e=$l.cureLocalIntersections(e,t,n),$l.earcutLinked(e,t,n,i,r,a,2)):2==s&&$l.splitEarcut(e,t,n,i,r,a);break}}},$l.isEar=function(e){var t=e.prev,n=e,i=e.next;if(0<=$l.area(t,n,i))return!1;for(var r=e.next.next;r!=e.prev;){if($l.pointInTriangle(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&0<=$l.area(r.prev,r,r.next))return!1;r=r.next}return!0},$l.isEarHashed=function(e,t,n,i){var r=e.prev,a=e,s=e.next;if(0<=$l.area(r,a,s))return!1;for(var l=r.x<a.x?r.x<s.x?r.x:s.x:a.x<s.x?a.x:s.x,o=r.y<a.y?r.y<s.y?r.y:s.y:a.y<s.y?a.y:s.y,_=r.x>a.x?r.x>s.x?r.x:s.x:a.x>s.x?a.x:s.x,p=r.y>a.y?r.y>s.y?r.y:s.y:a.y>s.y?a.y:s.y,u=$l.zOrder(l,o,t,n,i),h=$l.zOrder(_,p,t,n,i),c=e.nextZ;null!=c&&c.z<=h;){if(c!=e.prev&&c!=e.next&&$l.pointInTriangle(r.x,r.y,a.x,a.y,s.x,s.y,c.x,c.y)&&0<=$l.area(c.prev,c,c.next))return!1;c=c.nextZ}for(c=e.prevZ;null!=c&&c.z>=u;){if(c!=e.prev&&c!=e.next&&$l.pointInTriangle(r.x,r.y,a.x,a.y,s.x,s.y,c.x,c.y)&&0<=$l.area(c.prev,c,c.next))return!1;c=c.prevZ}return!0},$l.cureLocalIntersections=function(e,t,n){for(var i=e;;){var r=i.prev,a=i.next.next;if(!$l.equals(r,a)&&$l.intersects(r,i,i.next,a)&&$l.locallyInside(r,a)&&$l.locallyInside(a,r)&&(t.push(p.int(r.i/n)),t.push(p.int(i.i/n)),t.push(p.int(a.i/n)),$l.removeNode(i),$l.removeNode(i.next),i=e=a),(i=i.next)==e)break}return i},$l.splitEarcut=function(e,t,n,i,r,a){for(var s=e;;){for(var l=s.next.next;l!=s.prev;){if(s.i!=l.i&&$l.isValidDiagonal(s,l)){var o=$l.splitPolygon(s,l);return s=$l.filterPoints(s,s.next),o=$l.filterPoints(o,o.next),$l.earcutLinked(s,t,n,i,r,a),void $l.earcutLinked(o,t,n,i,r,a)}l=l.next}if((s=s.next)==e)break}},$l.eliminateHoles=function(e,t,n,i){var r,a,s,l,o,_=[];for(r=0,a=t.length;r<a;)s=t[r]*i,l=r<a-1?t[r+1]*i:e.length,(o=$l.linkedList(e,s,l,i,!1))==o.next&&(o.steiner=!0),_.push($l.getLeftmost(o)),++r;Dl.sort(_,$l.compareX);for(var p=0,u=_.length;p<u;){var h=p++;$l.eliminateHole(_[h],n),n=$l.filterPoints(n,n.next)}return n},$l.compareX=function(e,t){return p.int(e.x-t.x)},$l.eliminateHole=function(e,t){if(null!=(t=$l.findHoleBridge(e,t))){var n=$l.splitPolygon(t,e);$l.filterPoints(n,n.next)}},$l.findHoleBridge=function(e,t){for(var n=t,i=e.x,r=e.y,a=-1/0,s=null;;){if(r<=n.y&&r>=n.next.y){var l=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(l<=i&&a<l){if((a=l)==i){if(r==n.y)return n;if(r==n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}if((n=n.next)==t)break}if(null==s)return null;if(i==a)return s.prev;var o,_=s,p=s.x,u=s.y,h=1/0;for(n=s.next;n!=_;)i>=n.x&&n.x>=p&&$l.pointInTriangle(r<u?i:a,r,p,u,r<u?a:i,r,n.x,n.y)&&((o=Math.abs(r-n.y)/(i-n.x))<h||o==h&&n.x>s.x)&&$l.locallyInside(n,e)&&(s=n,h=o),n=n.next;return s},$l.indexCurve=function(e,t,n,i){for(var r=e;null==r.z&&(r.z=$l.zOrder(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,(r=r.next)!=e;);r.prevZ.nextZ=null,r.prevZ=null,$l.sortLinked(r)},$l.sortLinked=function(e){for(var t,n,i,r=null,a=null,s=null,l=null,o=1;;){for(r=e,l=e=null,t=0;null!=r;){++t,a=r;for(var _=n=0,p=o;_<p&&(_++,++n,null!=(a=a.nextZ)););for(i=o;0<n||0<i&&null!=a;)0==n?(a=(s=a).nextZ,--i):0==i||null==a?(r=(s=r).nextZ,--n):r.z<=a.z?(r=(s=r).nextZ,--n):(a=(s=a).nextZ,--i),null!=l?l.nextZ=s:e=s,s.prevZ=l,l=s;r=a}if(l.nextZ=null,o*=2,!(1<t))break}return e},$l.zOrder=function(e,t,n,i,r){var a=p.int(32767*(e-n)/r),s=p.int(32767*(t-i)/r);return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&(a|a<<8))|a<<4))|a<<2))|a<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&(s|s<<8))|s<<4))|s<<2))|s<<1))<<1},$l.getLeftmost=function(e){for(var t=e,n=e;t.x<n.x&&(n=t),(t=t.next)!=e;);return n},$l.pointInTriangle=function(e,t,n,i,r,a,s,l){return 0<=(r-s)*(t-l)-(e-s)*(a-l)&&0<=(e-s)*(i-l)-(n-s)*(t-l)&&0<=(n-s)*(a-l)-(r-s)*(i-l)},$l.isValidDiagonal=function(e,t){return!(e.next.i==t.i||e.prev.i==t.i||$l.intersectsPolygon(e,t)||!$l.locallyInside(e,t)||!$l.locallyInside(t,e))&&$l.middleInside(e,t)},$l.area=function(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)},$l.equals=function(e,t){return e.x==t.x&&e.y==t.y},$l.intersects=function(e,t,n,i){return!!($l.equals(e,t)&&$l.equals(n,i)||$l.equals(e,i)&&$l.equals(n,t))||0<$l.area(e,t,n)!=0<$l.area(e,t,i)&&0<$l.area(n,i,e)!=0<$l.area(n,i,t)},$l.intersectsPolygon=function(e,t){for(var n=e;;){if(n.i!=e.i&&n.next.i!=e.i&&n.i!=t.i&&n.next.i!=t.i&&$l.intersects(n,n.next,e,t))return!0;if((n=n.next)==e)break}return!1},$l.locallyInside=function(e,t){return $l.area(e.prev,e,e.next)<0?0<=$l.area(e,t,e.next)&&0<=$l.area(e,e.prev,t):$l.area(e,t,e.prev)<0||$l.area(e,e.next,t)<0},$l.middleInside=function(e,t){for(var n=e,i=!1,r=(e.x+t.x)/2,a=(e.y+t.y)/2;n.y>a!=n.next.y>a&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),(n=n.next)!=e;);return i},$l.splitPolygon=function(e,t){var n=new eo(e.i,e.x,e.y),i=new eo(t.i,t.x,t.y),r=e.next,a=t.prev;return(e.next=t).prev=e,(n.next=r).prev=n,(i.next=n).prev=i,(a.next=i).prev=a,i},$l.insertNode=function(e,t,n,i){var r=new eo(e,t,n);return null==i?(r.prev=r).next=r:(r.next=i.next,(r.prev=i).next.prev=r,i.next=r),r},$l.removeNode=function(e){e.next.prev=e.prev,e.prev.next=e.next,null!=e.prevZ&&(e.prevZ.nextZ=e.nextZ),null!=e.nextZ&&(e.nextZ.prevZ=e.prevZ)},$l.deviation=function(e,t,n,i){var r=null!=t&&0<t.length,a=r?t[0]*n:e.length,s=Math.abs($l.signedArea(e,0,a,n));if(r)for(var l=0,o=t.length;l<o;){var _=t[l]*n,p=l<o-1?t[l+1]*n:e.length;s-=Math.abs($l.signedArea(e,_,p,n)),++l}for(var u=0,h=0;h<i.length;){var c=i[h]*n,d=i[h+1]*n,m=i[h+2]*n;u+=Math.abs((e[c]-e[m])*(e[d+1]-e[c+1])-(e[c]-e[d])*(e[m+1]-e[c+1])),h+=3}return 0==s&&0==u?0:Math.abs((u-s)/s)},$l.signedArea=function(e,t,n,i){for(var r=0,a=t,s=n-i;a<n;)r+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a,a+=i;return r},$l.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},i=0,r=0,a=e.length;r<a;){for(var s=r++,l=0,o=e[s].length;l<o;)for(var _=l++,p=0,u=t;p<u;){var h=p++;n.vertices.push(e[s][_][h])}0<s&&(i+=e[s-1].length,n.holes.push(i))}return n},$l.polygonize=function(e){var t=[];if(0==e.length)return[];for(var n=[],i=0,r=e.length;i<r;)n[i++]=!1;for(var a=!0;a;){for(var s=null,l=-1,o=0,_=e.length;o<_;){var p=o++;if(!n[p]){l=p;break}}if(-1==l)a=!1;else{s=e[l],n[l]=!0;for(var u=0,h=e.length;u<h;){var c=u++;if(!n[c]){var d=$l.addTriangle(s,e[c]);null!=d&&ro.isConvex(d)&&(s=d,n[c]=!0)}}t.push(s)}}return t},$l.addTriangle=function(e,t){for(var n=-1,i=-1,r=-1,a=-1,s=0,l=e.length;s<l;){var o=s++;t[0].x==e[o].x&&t[0].y==e[o].y?-1==n?(n=o,i=0):(r=o,a=0):t[1].x==e[o].x&&t[1].y==e[o].y?-1==n?(n=o,i=1):(r=o,a=1):t[2].x==e[o].x&&t[2].y==e[o].y&&(-1==n?(n=o,i=2):(r=o,a=2))}if(0==n&&r==e.length-1&&(n=e.length-1,r=0),-1==r)return null;var _=0;_!=i&&_!=a||(_=1),_!=i&&_!=a||(_=2);for(var p=[],u=0,h=e.length;u<h;){var c=u++;p.push(e[c]),c==n&&p.push(t[_])}return p};var eo=function(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1};(n["hxGeomAlgo.EarNode"]=eo).__name__=["hxGeomAlgo","EarNode"],eo.prototype={i:null,x:null,y:null,prev:null,next:null,z:null,prevZ:null,nextZ:null,steiner:null,__class__:eo};var to=function(e,t,n){null==n&&(n=1),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.w=n};(n["hxGeomAlgo.HomogCoord"]=to).__name__=["hxGeomAlgo","HomogCoord"],to.det=function(e,t,n){return e.w*t.perpdot(n)-t.w*e.perpdot(n)+n.w*e.perpdot(t)},to.ccw=function(e,t,n){return 0<to.det(e,t,n)},to.cw=function(e,t,n){return to.det(e,t,n)<0},to.prototype={x:null,y:null,w:null,add:function(e){return this.x+=e.x,this.y+=e.y,this},sub:function(e){return this.x-=e.x,this.y-=e.y,this},neg:function(){return this.w=-this.w,this.x=-this.x,this.y=-this.y,this},mul:function(e){return this.w*=e,this.x*=e,this.y*=e,this},div:function(e){return this.w/=e,this.x/=e,this.y/=e,this},normalize:function(){return this.div(this.length())},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},perp:function(){var e=-this.y;return this.y=this.x,this.x=e,this},dotPoint:function(e){return this.w+this.x*e.x+this.y*e.y},dot:function(e){return this.w*e.w+this.x*e.x+this.y*e.y},perpdot:function(e){return this.x*e.y-this.y*e.x},dotperp:function(e){return-this.x*e.y+this.y*e.x},equals:function(e){return e.w*this.x==this.w*e.x&&e.w*this.y==this.w*e.y},left:function(e){return 0<this.dotPoint(e)},right:function(e){return this.dotPoint(e)<0},toScreen:function(){return io._new(this.x/this.w,-this.y/this.w)},toPoint:function(){return io._new(this.x/this.w,this.y/this.w)},meet:function(e){return new to(e.w*this.y-this.w*e.y,this.w*e.x-e.w*this.x,this.x*e.y-this.y*e.x)},meetPoint:function(e){return new to(this.y-this.w*e.y,this.w*e.x-this.x,this.x*e.y-this.y*e.x)},toString:function(){return" (w:"+this.w+"; x:"+this.x+", y:"+this.y+")  "},__class__:to};var no=function(e,t){null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t};(n["hxGeomAlgo.HxPointData"]=no).__name__=["hxGeomAlgo","HxPointData"],no.prototype={x:null,y:null,toString:function(){return"("+this.x+", "+this.y+")"},__class__:no};var io=e.hxGeomAlgo._HxPoint.HxPoint_Impl_={};(n["hxGeomAlgo._HxPoint.HxPoint_Impl_"]=io).__name__=["hxGeomAlgo","_HxPoint","HxPoint_Impl_"],io.__properties__={set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"},io.get_x=function(e){return e.x},io.set_x=function(e,t){return e.x=t},io.get_y=function(e){return e.y},io.set_y=function(e,t){return e.y=t},io._new=function(e,t){return null==t&&(t=0),null==e&&(e=0),new no(e,t)},io.setTo=function(e,t,n){e.x=t,e.y=n},io.equals=function(e,t){return null!=t&&e.x==t.x&&e.y==t.y},io.clone=function(e){return io._new(e.x,e.y)},io.toString=function(e){return"("+e.x+", "+e.y+")"},io.fromPointStruct=function(e){return io._new(e.x,e.y)},io.toPointStruct=function(e){return{x:e.x,y:e.y}};var ro=e.hxGeomAlgo.PolyTools=function(){};(n["hxGeomAlgo.PolyTools"]=ro).__name__=["hxGeomAlgo","PolyTools"],ro.isCCW=function(e){if(e.length<=2)return!0;for(var t=0,n=0,i=e.length;n<i;){var r=n++;t+=ro.at(e,r-1).x*e[r].y-e[r].x*ro.at(e,r-1).y}return t<0},ro.isCW=function(e){if(e.length<=2)return!0;for(var t=0,n=0,i=e.length;n<i;){var r=n++;t+=ro.at(e,r-1).x*e[r].y-e[r].x*ro.at(e,r-1).y}return 0<t},ro.makeCCW=function(e){var t=!1;return ro.isCCW(e)||(e.reverse(),t=!0),t},ro.makeCW=function(e){var t=!1;return ro.isCCW(e)&&(e.reverse(),t=!0),t},ro.isConvex=function(e){for(var t=null,n=0,i=e.length;n<i;){var r=n++,a=0==r?e.length-1:r-1,s=r,l=r==e.length-1?0:r+1,o=e[s].x-e[a].x,_=e[s].y-e[a].y,p=e[l].x-e[s].x,u=o*(e[l].y-e[s].y)-p*_,h=0<u;if(0!=u)if(null==t)t=h;else if(t!=h)return!1}return!0},ro.isSimple=function(e){var t=e.length;if(t<=3)return!0;for(var n=0,i=t;n<i;)for(var r=n++,a=r,s=r==t-1?0:r+1,l=r+1,o=t;l<o;){var _=l++,p=_,u=_==t-1?0:_+1,h=ro.segmentIntersect(e[a],e[s],e[p],e[u]);if(null!=h&&!(ro.distance(h,e[a])<ro.EPSILON||ro.distance(h,e[s])<ro.EPSILON)&&!(ro.distance(h,e[p])<ro.EPSILON||ro.distance(h,e[u])<ro.EPSILON))return!1}return!0},ro.segmentIntersect=function(e,t,n,i){var r,a,s,l,o,_,p;a=t.y-e.y,l=e.x-t.x,_=t.x*e.y-e.x*t.y,s=i.y-n.y,o=n.x-i.x,p=i.x*n.y-n.x*i.y;var u=a*o-s*l;if(0==u)return null;(r=io._new()).x=(l*p-o*_)/u,r.y=(s*_-a*p)/u;var h=ro.distanceSquared(e,t),c=ro.distanceSquared(n,i);return ro.distanceSquared(r,t)>h?null:ro.distanceSquared(r,e)>h?null:ro.distanceSquared(r,i)>c?null:ro.distanceSquared(r,n)>c?null:r},ro.findDuplicatePoints=function(e,t,n){null==n&&(n=!0),null==t&&(t=!0);var i=e.length;if(i<=1)return[];for(var r,a=[],s=0,l=i-1;s<l;)for(var o=s++,_=o+1;_<i;){var p=e[o],u=e[_],h=null!=u&&p.x==u.x&&p.y==u.y;if(h&&a.push(o),t||h&&!t)break;++_}if(n&&t){var c=e[0],d=e[i-1];r=null!=d&&c.x==d.x&&c.y==d.y}else r=!1;return r&&a.push(i-1),a},ro.intersection=function(e,t,n,i){var r=null,a=t.y-e.y,s=e.x-t.x,l=a*e.x+s*e.y,o=i.y-n.y,_=n.x-i.x,p=o*n.x+_*n.y,u=a*_-o*s;return ro.eq(u,0)||((r=io._new()).x=(_*l-s*p)/u,r.y=(a*p-o*l)/u),r},ro.isReflex=function(e,t){return ro.isRight(ro.at(e,t-1),ro.at(e,t),ro.at(e,t+1))},ro.at=function(e,t){return e[t=ro.wrappedIdx(e,t)]},ro.wrappedIdx=function(e,t){var n=e.length;return t<0&&(t+=n),t%n},ro.side=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)},ro.isLeft=function(e,t,n){return 0<ro.side(e,t,n)},ro.isLeftOrOn=function(e,t,n){return 0<=ro.side(e,t,n)},ro.isRight=function(e,t,n){return ro.side(e,t,n)<0},ro.isRightOrOn=function(e,t,n){return ro.side(e,t,n)<=0},ro.isCollinear=function(e,t,n){return 0==ro.side(e,t,n)},ro.distance=function(e,t){return Math.sqrt(ro.distanceSquared(e,t))},ro.distanceToSegment=function(e,t,n){return Math.sqrt(ro.distanceToSegmentSquared(e,t,n))},ro.distanceSquared=function(e,t){return ro.sqr(e.x-t.x)+ro.sqr(e.y-t.y)},ro.distanceToSegmentSquared=function(e,t,n){var i=ro.distanceSquared(t,n);if(0==i)return ro.distanceSquared(e,t);var r=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/i;return r<0?ro.distanceSquared(e,t):1<r?ro.distanceSquared(e,n):(io.setTo(ro.point,t.x+r*(n.x-t.x),t.y+r*(n.y-t.y)),ro.distanceSquared(e,ro.point))},ro.getCentroid=function(e){var t=io._new(),n=ro.getArea(e);if(0!=n){for(var i=e.length,r=0,a=i;r<a;){var s=r++,l=e[s],o=e[(s+1)%i],_=l.x*o.y-o.x*l.y;t.x+=(l.x+o.x)*_,t.y+=(l.y+o.y)*_}t.x/=6*n,t.y/=6*n}else t=io.EMPTY;return t},ro.getArea=function(e){for(var t=0,n=e.length,i=0,r=n;i<r;){var a=i++,s=e[a],l=e[(a+1)%n];t+=s.x*l.y-l.x*s.y}return.5*t},ro.meet=function(e,t){return new to(e.y-t.y,t.x-e.x,e.x*t.y-e.y*t.x)},ro.dot=function(e,t){return e.x*t.x+e.y*t.y},ro.sqr=function(e){return e*e},ro.eq=function(e,t){return Math.abs(e-t)<=ro.EPSILON},ro.clear=function(e){e.length=0},ro.toFloatArray=function(e,t){t=null!=t?t:[];for(var n=0;n<e.length;){var i=e[n];++n,t.push(i.x),t.push(i.y)}return t},ro.reverseFloatArray=function(e,t){null==t&&(t=!1);for(var n=t?e:[],i=e.length>>1,r=0,a=i;r<a;){var s=r++,l=2*(i-s-1);n[2*s]=e[l],n[2*s+1]=e[l+1]}return n},ro.flatten=function(e,t){for(var n=null!=t?t:[],i=0;i<e.length;){var r=e[i];++i;for(var a=0;a<r.length;){var s=r[a];++a,n.push(s)}}return n},ro.toPointArray=function(e,t){t=null!=t?t:[];var n=e.length;e.length%2==1&&--n;for(var i=0,r=n>>1;i<r;){var a=i++;t.push(io._new(e[2*a],e[2*a+1]))}return t},ro.inflateLine=function(e,t,n){var i=n/2,r=t.x-e.x,a=t.y-e.y,s=Math.sqrt(ro.sqr(r)+ro.sqr(a)),l=r/s*i,o=a/s*i;return[io._new(e.x-o,e.y+l),io._new(t.x-o,t.y+l),io._new(t.x+o,t.y-l),io._new(e.x+o,e.y-l)]},ro.clip=function(e,t){Ql.assert(3<=t.length&&ro.isConvex(t),"`clipPoly` must be a valid convex poly",{fileName:"PolyTools.hx",lineNumber:458,className:"hxGeomAlgo.PolyTools",methodName:"clip"});for(var n,i,r,a,s=[],l=e,o=ro.isCCW(t)?ro.isRight:ro.isLeft,_=0,p=t.length;_<p;){var u=_++;n=t[u],i=t[ro.wrappedIdx(t,u+1)];var h=l;l=[],r=h[h.length-1];for(var c=0,d=h.length;c<d;){if(o(a=h[c++],n,i)){if(!o(r,n,i)){var m=ro.intersection(r,a,n,i);null!=m&&l.push(m)}l.push(a)}else if(o(r,n,i)){var f=ro.intersection(r,a,n,i);null!=f&&l.push(f)}r=a}s.push(l)}return s},ro.exposeEnum=function(t,n){for(var i=(null!=n?n:d.getEnumName(t)).split("."),r=e,a=0;a<i.length-1;){var s=i[a];r[s]=r[s]||{},r=r[s],++a}r[i[a]]=t};var ao=function(e){Error.call(this),this.val=e,this.message=String(e),Error.captureStackTrace&&Error.captureStackTrace(this,ao)};(n["js._Boot.HaxeError"]=ao).__name__=["js","_Boot","HaxeError"],ao.wrap=function(e){return e instanceof Error?e:new ao(e)},ao.__super__=Error,ao.prototype=r(Error.prototype,{val:null,__class__:ao});var so=function(){};(n["js.Boot"]=so).__name__=["js","Boot"],so.__unhtml=function(e){return e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")},so.__trace=function(e,t){var n,i=null!=t?t.fileName+":"+t.lineNumber+": ":"";if(i+=so.__string_rec(e,""),null!=t&&null!=t.customParams)for(var r=0,a=t.customParams;r<a.length;){var s=a[r];++r,i+=","+so.__string_rec(s,"")}"undefined"!=typeof document&&null!=(n=document.getElementById("haxe:trace"))?n.innerHTML+=so.__unhtml(i)+"<br/>":"undefined"!=typeof console&&null!=console.log&&console.log(i)},so.__clear_trace=function(){var e=document.getElementById("haxe:trace");null!=e&&(e.innerHTML="")},so.isClass=function(e){return e.__name__},so.isEnum=function(e){return e.__ename__},so.getClass=function(e){if(e instanceof Array&&null==e.__enum__)return Array;var t=e.__class__;if(null!=t)return t;var n=so.__nativeClassName(e);return null!=n?so.__resolveNativeClass(n):null},so.__string_rec=function(e,t){if(null==e)return"null";if(5<=t.length)return"<...>";var n=typeof e;switch("function"==n&&(so.isClass(e)||so.isEnum(e))&&(n="object"),n){case"function":return"<function>";case"object":if(e instanceof Array){if(e.__enum__){if(2==e.length)return e[0];var i=e[0]+"(";t+="\t";for(var r=2,a=e.length;r<a;){var s=r++;i+=2!=s?","+so.__string_rec(e[s],t):so.__string_rec(e[s],t)}return i+")"}var l="[";t+="\t";for(var o=0,_=e.length;o<_;){var p=o++;l+=(0<p?",":"")+so.__string_rec(e[p],t)}return l+"]"}var u;try{u=e.toString}catch(e){return"???"}if(null!=u&&u!=Object.toString&&"function"==typeof u){var h=e.toString();if("[object Object]"!=h)return h}var c=null,d="{\n";t+="\t";var m=null!=e.hasOwnProperty;for(var c in e)m&&!e.hasOwnProperty(c)||"prototype"!=c&&"__class__"!=c&&"__super__"!=c&&"__interfaces__"!=c&&"__properties__"!=c&&(2!=d.length&&(d+=", \n"),d+=t+c+" : "+so.__string_rec(e[c],t));return d+"\n"+(t=t.substring(1))+"}";case"string":return e;default:return String(e)}},so.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;var n=e.__interfaces__;if(null!=n)for(var i=0,r=n.length;i<r;){var a=n[i++];if(a==t||so.__interfLoop(a,t))return!0}return so.__interfLoop(e.__super__,t)},so.__instanceof=function(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array&&null==e.__enum__;case Ic:return"boolean"==typeof e;case Pc:return!0;case Mc:return"number"==typeof e;case Nc:return"number"==typeof e&&(0|e)===e;case String:return"string"==typeof e;default:if(null==e)return!1;if("function"==typeof t){if(e instanceof t)return!0;if(so.__interfLoop(so.getClass(e),t))return!0}else if("object"==typeof t&&so.__isNativeObj(t)&&e instanceof t)return!0;return t==Tc&&null!=e.__name__||t==Ac&&null!=e.__ename__||e.__enum__==t}},so.__cast=function(e,t){if(so.__instanceof(e,t))return e;throw new ao("Cannot cast "+p.string(e)+" to "+p.string(t))},so.__nativeClassName=function(e){var t=so.__toStr.call(e).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t},so.__isNativeObj=function(e){return null!=so.__nativeClassName(e)},so.__resolveNativeClass=function(e){return t[e]};var lo=function(){};(n["js.Browser"]=lo).__name__=["js","Browser"],lo.__properties__={get_navigator:"get_navigator",get_document:"get_document",get_window:"get_window"},lo.get_window=function(){return window},lo.get_document=function(){return window.document},lo.get_navigator=function(){return window.navigator};var oo=function(){};(n["js.Lib"]=oo).__name__=["js","Lib"],oo.__properties__={get_undefined:"get_undefined"},oo.get_undefined=function(){};var _o=function(e){if(e instanceof Array&&null==e.__enum__)this.a=e,this.byteLength=e.length;else{var t=e;this.a=[];for(var n=0,i=t;n<i;){var r=n++;this.a[r]=0}this.byteLength=t}};(n["js.html.compat.ArrayBuffer"]=_o).__name__=["js","html","compat","ArrayBuffer"],_o.sliceImpl=function(e,t){var n=new jc(this,e,null==t?null:t-e),i=new Ec(n.byteLength);return new jc(i).set(n),i},_o.prototype={byteLength:null,a:null,slice:function(e,t){return new _o(this.a.slice(e,t))},__class__:_o};var po=function(e,t,n){if(this.buf=e,this.offset=null==t?0:t,this.length=null==n?e.byteLength-this.offset:n,this.offset<0||this.length<0||this.offset+this.length>e.byteLength)throw new ao(Zl.OutsideBounds);this.byteLength=this.length,this.byteOffset=this.offset,this.buffer=this.buf};(n["js.html.compat.DataView"]=po).__name__=["js","html","compat","DataView"],po.prototype={buf:null,offset:null,length:null,byteLength:null,byteOffset:null,buffer:null,getInt8:function(e){var t=this.buf.a[this.offset+e];return 128<=t?t-256:t},getUint8:function(e){return this.buf.a[this.offset+e]},getInt16:function(e,t){var n=this.getUint16(e,t);return 32768<=n?n-65536:n},getUint16:function(e,t){return t?this.buf.a[this.offset+e]|this.buf.a[this.offset+e+1]<<8:this.buf.a[this.offset+e]<<8|this.buf.a[this.offset+e+1]},getInt32:function(e,t){var n=this.offset+e,i=this.buf.a[n++],r=this.buf.a[n++],a=this.buf.a[n++],s=this.buf.a[n++];return t?i|r<<8|a<<16|s<<24:s|a<<8|r<<16|i<<24},getUint32:function(e,t){var n=this.getInt32(e,t);return n<0?n+4294967296:n},getFloat32:function(e,t){return Ul.i32ToFloat(this.getInt32(e,t))},getFloat64:function(e,t){var n=this.getInt32(e,t),i=this.getInt32(e+4,t);return Ul.i64ToDouble(t?n:i,t?i:n)},setInt8:function(e,t){this.buf.a[e+this.offset]=t<0?t+128&255:255&t},setUint8:function(e,t){this.buf.a[e+this.offset]=255&t},setInt16:function(e,t,n){this.setUint16(e,t<0?t+65536:t,n)},setUint16:function(e,t,n){var i=e+this.offset;n?(this.buf.a[i]=255&t,this.buf.a[i++]=t>>8&255):(this.buf.a[i++]=t>>8&255,this.buf.a[i]=255&t)},setInt32:function(e,t,n){this.setUint32(e,t,n)},setUint32:function(e,t,n){var i=e+this.offset;this.buf.a[i++]=n?(this.buf.a[i++]=255&t,this.buf.a[i++]=t>>8&255,this.buf.a[i++]=t>>16&255,t>>>24):(this.buf.a[i++]=t>>>24,this.buf.a[i++]=t>>16&255,this.buf.a[i++]=t>>8&255,255&t)},setFloat32:function(e,t,n){this.setUint32(e,Ul.floatToI32(t),n)},setFloat64:function(e,t,n){var i=Ul.doubleToI64(t);n?(this.setUint32(e,i.low),this.setUint32(e,i.high)):(this.setUint32(e,i.high),this.setUint32(e,i.low))},__class__:po};var uo=function(){};(n["js.html.compat.Float32Array"]=uo).__name__=["js","html","compat","Float32Array"],uo._new=function(e,t,n){var i;if("number"==typeof e){i=[];for(var r=0,a=e;r<a;)i[r++]=0;i.byteLength=i.length<<2;for(var s=[],l=i.byteOffset=0,o=i.length<<2;l<o;)l++,s.push(0);i.buffer=new _o(s)}else if(p.is(e,_o)){var _=e;null==t&&(t=0),null==n&&(n=_.byteLength-t>>2),i=[];for(var u=0,h=n;u<h;){u++;var c=_.a[t++]|_.a[t++]<<8|_.a[t++]<<16|_.a[t++]<<24;i.push(Ul.i32ToFloat(c))}i.byteLength=i.length<<2,i.byteOffset=t,i.buffer=_}else{if(!(e instanceof Array&&null==e.__enum__))throw new ao("TODO "+p.string(e));i=e.slice();for(var d=[],m=0;m<i.length;){var f=i[m];++m;var g=Ul.floatToI32(f);d.push(255&g),d.push(g>>8&255),d.push(g>>16&255),d.push(g>>>24)}i.byteLength=i.length<<2,i.byteOffset=0,i.buffer=new _o(d)}return i.subarray=uo._subarray,i.set=uo._set,i},uo._set=function(e,t){if(p.is(e.buffer,_o)){var n=e;if(e.byteLength+t>this.byteLength)throw new ao("set() outside of range");for(var i=0,r=e.byteLength;i<r;){var a=i++;this[a+t]=n[a]}}else{if(!(e instanceof Array&&null==e.__enum__))throw new ao("TODO");var s=e;if(s.length+t>this.byteLength)throw new ao("set() outside of range");for(var l=0,o=s.length;l<o;){var _=l++;this[_+t]=s[_]}}},uo._subarray=function(e,t){var n=uo._new(this.slice(e,t));return n.byteOffset=4*e,n};var ho=function(){};(n["js.html.compat.Uint8Array"]=ho).__name__=["js","html","compat","Uint8Array"],ho._new=function(e,t,n){var i;if("number"==typeof e){i=[];for(var r=0,a=e;r<a;)i[r++]=0;i.byteLength=i.length,i.byteOffset=0,i.buffer=new _o(i)}else if(p.is(e,_o)){var s=e;null==t&&(t=0),null==n&&(n=s.byteLength-t),(i=0==t?s.a:s.a.slice(t,t+n)).byteLength=i.length,i.byteOffset=t,i.buffer=s}else{if(!(e instanceof Array&&null==e.__enum__))throw new ao("TODO "+p.string(e));(i=e.slice()).byteLength=i.length,i.byteOffset=0,i.buffer=new _o(i)}return i.subarray=ho._subarray,i.set=ho._set,i},ho._set=function(e,t){if(p.is(e.buffer,_o)){var n=e;if(e.byteLength+t>this.byteLength)throw new ao("set() outside of range");for(var i=0,r=e.byteLength;i<r;){var a=i++;this[a+t]=n[a]}}else{if(!(e instanceof Array&&null==e.__enum__))throw new ao("TODO");var s=e;if(s.length+t>this.byteLength)throw new ao("set() outside of range");for(var l=0,o=s.length;l<o;){var _=l++;this[_+t]=s[_]}}},ho._subarray=function(e,t){var n=ho._new(this.slice(e,t));return n.byteOffset=e,n};var co=function(){};(n["nape.Config"]=co).__name__=["nape","Config"],co.prototype={__class__:co};var mo=function(){this.zpp_inner=null};(n["nape.callbacks.Callback"]=mo).__name__=["nape","callbacks","Callback"],mo.prototype={zpp_inner:null,get_event:function(){return hp.events[this.zpp_inner.event]},get_listener:function(){return this.zpp_inner.listener.outer},toString:function(){return""},__class__:mo,__properties__:{get_listener:"get_listener",get_event:"get_event"}};var fo=function(){mo.call(this)};(n["nape.callbacks.BodyCallback"]=fo).__name__=["nape","callbacks","BodyCallback"],fo.__super__=mo,fo.prototype=r(mo.prototype,{get_body:function(){return this.zpp_inner.body.outer},toString:function(){var e="Cb:";return e+=["WAKE","SLEEP"][this.zpp_inner.event-2],(e+=":"+this.get_body().toString())+" : listener: "+p.string(this.get_listener())},__class__:fo,__properties__:r(mo.prototype.__properties__,{get_body:"get_body"})});var go=function(){this.zpp_inner=null};(n["nape.callbacks.Listener"]=go).__name__=["nape","callbacks","Listener"],go.prototype={zpp_inner:null,get_type:function(){return hp.types[this.zpp_inner.type]},get_event:function(){return hp.events[this.zpp_inner.event]},set_event:function(e){if(this.get_event()!=e){var t=e==bo.get_BEGIN()?0:e==bo.get_ONGOING()?6:e==bo.get_END()?1:e==bo.get_SLEEP()?3:e==bo.get_WAKE()?2:e==bo.get_PRE()?5:4;this.zpp_inner.swapEvent(t)}return this.get_event()},get_precedence:function(){return this.zpp_inner.precedence},set_precedence:function(e){return this.get_precedence()!=e&&(this.zpp_inner.precedence=e,this.zpp_inner.invalidate_precedence()),this.get_precedence()},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(e){return this.get_space()!=e&&(null!=this.zpp_inner.space&&this.zpp_inner.space.outer.get_listeners().remove(this),null!=e?e.get_listeners().add(this):this.zpp_inner.space=null),this.get_space()},toString:function(){var e=["BEGIN","END","WAKE","SLEEP","BREAK","PRE","ONGOING"][this.zpp_inner.event];if(0==this.zpp_inner.type){var t=this.zpp_inner.body;return"BodyListener{"+e+"::"+p.string(t.outer_zn.get_options())+"}"}if(1==this.zpp_inner.type){var n=this.zpp_inner.constraint;return"ConstraintListener{"+e+"::"+p.string(n.outer_zn.get_options())+"}"}var i,r=this.zpp_inner.interaction;switch(r.itype){case 1:i="COLLISION";break;case 2:i="SENSOR";break;case 4:i="FLUID";break;default:i="ALL"}return(2==this.zpp_inner.type?"InteractionListener{"+e+"#"+i+"::"+p.string(r.outer_zni.get_options1())+":"+p.string(r.outer_zni.get_options2())+"}":"PreListener{"+i+"::"+p.string(r.outer_znp.get_options1())+":"+p.string(r.outer_znp.get_options2())+"}")+" precedence="+this.zpp_inner.precedence},__class__:go,__properties__:{set_space:"set_space",get_space:"get_space",set_precedence:"set_precedence",get_precedence:"get_precedence",set_event:"set_event",get_event:"get_event",get_type:"get_type"}};var vo=function(e,t,n,i){null==i&&(i=0),this.zpp_inner_zn=null,go.call(this);var r=-1;e==bo.get_WAKE()?r=2:e==bo.get_SLEEP()&&(r=3),this.zpp_inner_zn=new cp(gp.argument(t),r,n),this.zpp_inner=this.zpp_inner_zn,((this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this).zpp_inner.precedence=i};(n["nape.callbacks.BodyListener"]=vo).__name__=["nape","callbacks","BodyListener"],vo.__super__=go,vo.prototype=r(go.prototype,{zpp_inner_zn:null,get_options:function(){return this.zpp_inner_zn.options.outer},set_options:function(e){return this.zpp_inner_zn.options.set(e.zpp_inner),this.get_options()},get_handler:function(){return this.zpp_inner_zn.handler},set_handler:function(e){return this.zpp_inner_zn.handler=e,this.get_handler()},__class__:vo,__properties__:r(go.prototype.__properties__,{set_handler:"set_handler",get_handler:"get_handler",set_options:"set_options",get_options:"get_options"})});var bo=function(){};(n["nape.callbacks.CbEvent"]=bo).__name__=["nape","callbacks","CbEvent"],bo.__properties__={get_PRE:"get_PRE",get_BREAK:"get_BREAK",get_SLEEP:"get_SLEEP",get_WAKE:"get_WAKE",get_END:"get_END",get_ONGOING:"get_ONGOING",get_BEGIN:"get_BEGIN"},bo.get_BEGIN=function(){return null==up.CbEvent_BEGIN&&(up.internal=!0,up.CbEvent_BEGIN=new bo,up.internal=!1),up.CbEvent_BEGIN},bo.get_ONGOING=function(){return null==up.CbEvent_ONGOING&&(up.internal=!0,up.CbEvent_ONGOING=new bo,up.internal=!1),up.CbEvent_ONGOING},bo.get_END=function(){return null==up.CbEvent_END&&(up.internal=!0,up.CbEvent_END=new bo,up.internal=!1),up.CbEvent_END},bo.get_WAKE=function(){return null==up.CbEvent_WAKE&&(up.internal=!0,up.CbEvent_WAKE=new bo,up.internal=!1),up.CbEvent_WAKE},bo.get_SLEEP=function(){return null==up.CbEvent_SLEEP&&(up.internal=!0,up.CbEvent_SLEEP=new bo,up.internal=!1),up.CbEvent_SLEEP},bo.get_BREAK=function(){return null==up.CbEvent_BREAK&&(up.internal=!0,up.CbEvent_BREAK=new bo,up.internal=!1),up.CbEvent_BREAK},bo.get_PRE=function(){return null==up.CbEvent_PRE&&(up.internal=!0,up.CbEvent_PRE=new bo,up.internal=!1),up.CbEvent_PRE},bo.prototype={toString:function(){return this==bo.get_PRE()?"PRE":this==bo.get_BEGIN()?"BEGIN":this==bo.get_ONGOING()?"ONGOING":this==bo.get_END()?"END":this==bo.get_WAKE()?"WAKE":this==bo.get_SLEEP()?"SLEEP":this==bo.get_BREAK()?"BREAK":""},__class__:bo};var yo=function(){this.zpp_inner=null,this.zpp_inner=new pp,this.zpp_inner.outer=this};(n["nape.callbacks.CbType"]=yo).__name__=["nape","callbacks","CbType"],yo.__properties__={get_ANY_COMPOUND:"get_ANY_COMPOUND",get_ANY_SHAPE:"get_ANY_SHAPE",get_ANY_CONSTRAINT:"get_ANY_CONSTRAINT",get_ANY_BODY:"get_ANY_BODY"},yo.get_ANY_BODY=function(){return pp.ANY_BODY},yo.get_ANY_CONSTRAINT=function(){return pp.ANY_CONSTRAINT},yo.get_ANY_SHAPE=function(){return pp.ANY_SHAPE},yo.get_ANY_COMPOUND=function(){return pp.ANY_COMPOUND},yo.prototype={zpp_inner:null,get_id:function(){return this.zpp_inner.id},including:function(e){return new To(this).including(e)},excluding:function(e){return new To(this).excluding(e)},get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_interactors:function(){return null==this.zpp_inner.wrap_interactors&&(this.zpp_inner.wrap_interactors=tc.get(this.zpp_inner.interactors,!0)),this.zpp_inner.wrap_interactors},get_constraints:function(){return null==this.zpp_inner.wrap_constraints&&(this.zpp_inner.wrap_constraints=$h.get(this.zpp_inner.constraints,!0)),this.zpp_inner.wrap_constraints},toString:function(){return this==yo.get_ANY_BODY()?"ANY_BODY":this==yo.get_ANY_SHAPE()?"ANY_SHAPE":this==yo.get_ANY_COMPOUND()?"ANY_COMPOUND":this==yo.get_ANY_CONSTRAINT()?"ANY_CONSTRAINT":"CbType#"+this.get_id()},__class__:yo,__properties__:{get_constraints:"get_constraints",get_interactors:"get_interactors",get_userData:"get_userData",get_id:"get_id"}};var xo=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.callbacks.CbTypeIterator"]=xo).__name__=["nape","callbacks","CbTypeIterator"],xo.get=function(e){var t;if(null==xo.zpp_pool){rc.internal=!0;var n=new xo;rc.internal=!1,t=n}else{var i=xo.zpp_pool;xo.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},xo.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=xo.zpp_pool,(xo.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:xo};var zo=function(){this.zpp_inner=null,this.zpp_inner=new rc,this.zpp_inner.outer=this};(n["nape.callbacks.CbTypeList"]=zo).__name__=["nape","callbacks","CbTypeList"],zo.fromArray=function(e){for(var t=new zo,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},zo.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),xo.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new zo,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=xo.zpp_pool,(xo.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:zo,__properties__:{get_length:"get_length"}};var wo=function(){mo.call(this)};(n["nape.callbacks.ConstraintCallback"]=wo).__name__=["nape","callbacks","ConstraintCallback"],wo.__super__=mo,wo.prototype=r(mo.prototype,{get_constraint:function(){return this.zpp_inner.constraint.outer},toString:function(){var e="Cb:";return e+=["WAKE","SLEEP","BREAK"][this.zpp_inner.event-2],(e+=":"+this.get_constraint().toString())+" : listener: "+p.string(this.get_listener())},__class__:wo,__properties__:r(mo.prototype.__properties__,{get_constraint:"get_constraint"})});var ko=function(e,t,n,i){null==i&&(i=0),this.zpp_inner_zn=null,go.call(this);var r=-1;e==bo.get_WAKE()?r=2:e==bo.get_SLEEP()?r=3:e==bo.get_BREAK()&&(r=4),this.zpp_inner_zn=new dp(gp.argument(t),r,n),this.zpp_inner=this.zpp_inner_zn,((this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this).zpp_inner.precedence=i};(n["nape.callbacks.ConstraintListener"]=ko).__name__=["nape","callbacks","ConstraintListener"],ko.__super__=go,ko.prototype=r(go.prototype,{zpp_inner_zn:null,get_options:function(){return this.zpp_inner_zn.options.outer},set_options:function(e){return this.zpp_inner_zn.options.set(e.zpp_inner),this.get_options()},get_handler:function(){return this.zpp_inner_zn.handler},set_handler:function(e){return this.zpp_inner_zn.handler=e,this.get_handler()},__class__:ko,__properties__:r(go.prototype.__properties__,{set_handler:"set_handler",get_handler:"get_handler",set_options:"set_options",get_options:"get_options"})});var So=function(){mo.call(this)};(n["nape.callbacks.InteractionCallback"]=So).__name__=["nape","callbacks","InteractionCallback"],So.__super__=mo,So.prototype=r(mo.prototype,{get_int1:function(){return this.zpp_inner.int1.outer_i},get_int2:function(){return this.zpp_inner.int2.outer_i},get_arbiters:function(){return this.zpp_inner.wrap_arbiters},toString:function(){var e="Cb:";return e+=["BEGIN","END","","","","","ONGOING"][this.zpp_inner.event],e+=":"+this.get_int1().toString()+"/"+this.get_int2().toString(),(e+=" : "+this.get_arbiters().toString())+" : listener: "+p.string(this.get_listener())},__class__:So,__properties__:r(mo.prototype.__properties__,{get_arbiters:"get_arbiters",get_int2:"get_int2",get_int1:"get_int1"})});var Co=function(e,t,n,i,r,a){null==a&&(a=0),this.zpp_inner_zn=null,go.call(this);var s=-1;e==bo.get_BEGIN()?s=0:e==bo.get_END()?s=1:e==bo.get_ONGOING()&&(s=6),this.zpp_inner_zn=new fp(gp.argument(n),gp.argument(i),s,2),this.zpp_inner=this.zpp_inner_zn,((this.zpp_inner.outer=this).zpp_inner_zn.outer_zni=this).zpp_inner.precedence=a,this.zpp_inner_zn.handleri=r,this.set_interactionType(t)};(n["nape.callbacks.InteractionListener"]=Co).__name__=["nape","callbacks","InteractionListener"],Co.__super__=go,Co.prototype=r(go.prototype,{zpp_inner_zn:null,get_options1:function(){return this.zpp_inner_zn.options1.outer},set_options1:function(e){return this.zpp_inner_zn.options1.set(e.zpp_inner),this.get_options1()},get_options2:function(){return this.zpp_inner_zn.options2.outer},set_options2:function(e){return this.zpp_inner_zn.options2.set(e.zpp_inner),this.get_options2()},get_interactionType:function(){var e=this.zpp_inner_zn.itype;return 1==e?No.get_COLLISION():2==e?No.get_SENSOR():4==e?No.get_FLUID():7==e?No.get_ANY():null},set_interactionType:function(e){if(this.get_interactionType()!=e){var t=e==No.get_COLLISION()?1:e==No.get_SENSOR()?2:e==No.get_FLUID()?4:7;this.zpp_inner_zn.setInteractionType(t)}return this.get_interactionType()},get_handler:function(){return this.zpp_inner_zn.handleri},set_handler:function(e){return this.zpp_inner_zn.handleri=e,this.get_handler()},get_allowSleepingCallbacks:function(){return this.zpp_inner_zn.allowSleepingCallbacks},set_allowSleepingCallbacks:function(e){return this.zpp_inner_zn.allowSleepingCallbacks=e,this.get_allowSleepingCallbacks()},__class__:Co,__properties__:r(go.prototype.__properties__,{set_allowSleepingCallbacks:"set_allowSleepingCallbacks",get_allowSleepingCallbacks:"get_allowSleepingCallbacks",set_handler:"set_handler",get_handler:"get_handler",set_interactionType:"set_interactionType",get_interactionType:"get_interactionType",set_options2:"set_options2",get_options2:"get_options2",set_options1:"set_options1",get_options1:"get_options1"})});var No=function(){};(n["nape.callbacks.InteractionType"]=No).__name__=["nape","callbacks","InteractionType"],No.__properties__={get_ANY:"get_ANY",get_FLUID:"get_FLUID",get_SENSOR:"get_SENSOR",get_COLLISION:"get_COLLISION"},No.get_COLLISION=function(){return null==up.InteractionType_COLLISION&&(up.internal=!0,up.InteractionType_COLLISION=new No,up.internal=!1),up.InteractionType_COLLISION},No.get_SENSOR=function(){return null==up.InteractionType_SENSOR&&(up.internal=!0,up.InteractionType_SENSOR=new No,up.internal=!1),up.InteractionType_SENSOR},No.get_FLUID=function(){return null==up.InteractionType_FLUID&&(up.internal=!0,up.InteractionType_FLUID=new No,up.internal=!1),up.InteractionType_FLUID},No.get_ANY=function(){return null==up.InteractionType_ANY&&(up.internal=!0,up.InteractionType_ANY=new No,up.internal=!1),up.InteractionType_ANY},No.prototype={toString:function(){return this==No.get_COLLISION()?"COLLISION":this==No.get_SENSOR()?"SENSOR":this==No.get_FLUID()?"FLUID":this==No.get_ANY()?"ANY":""},__class__:No};var Po=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.callbacks.ListenerIterator"]=Po).__name__=["nape","callbacks","ListenerIterator"],Po.get=function(e){var t;if(null==Po.zpp_pool){ic.internal=!0;var n=new Po;ic.internal=!1,t=n}else{var i=Po.zpp_pool;Po.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},Po.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=Po.zpp_pool,(Po.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:Po};var Mo=function(){this.zpp_inner=null,this.zpp_inner=new ic,this.zpp_inner.outer=this};(n["nape.callbacks.ListenerList"]=Mo).__name__=["nape","callbacks","ListenerList"],Mo.fromArray=function(e){for(var t=new Mo,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},Mo.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),Po.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new Mo,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=Po.zpp_pool,(Po.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:Mo,__properties__:{get_length:"get_length"}};var Io=function(){};(n["nape.callbacks.ListenerType"]=Io).__name__=["nape","callbacks","ListenerType"],Io.__properties__={get_PRE:"get_PRE",get_INTERACTION:"get_INTERACTION",get_CONSTRAINT:"get_CONSTRAINT",get_BODY:"get_BODY"},Io.get_BODY=function(){return null==up.ListenerType_BODY&&(up.internal=!0,up.ListenerType_BODY=new Io,up.internal=!1),up.ListenerType_BODY},Io.get_CONSTRAINT=function(){return null==up.ListenerType_CONSTRAINT&&(up.internal=!0,up.ListenerType_CONSTRAINT=new Io,up.internal=!1),up.ListenerType_CONSTRAINT},Io.get_INTERACTION=function(){return null==up.ListenerType_INTERACTION&&(up.internal=!0,up.ListenerType_INTERACTION=new Io,up.internal=!1),up.ListenerType_INTERACTION},Io.get_PRE=function(){return null==up.ListenerType_PRE&&(up.internal=!0,up.ListenerType_PRE=new Io,up.internal=!1),up.ListenerType_PRE},Io.prototype={toString:function(){return this==Io.get_BODY()?"BODY":this==Io.get_CONSTRAINT()?"CONSTRAINT":this==Io.get_INTERACTION()?"INTERACTION":this==Io.get_PRE()?"PRE":""},__class__:Io};var To=function(e,t){this.zpp_inner=null,this.zpp_inner=new gp,this.zpp_inner.outer=this,null!=e&&this.including(e),null!=t&&this.excluding(t)};(n["nape.callbacks.OptionType"]=To).__name__=["nape","callbacks","OptionType"],To.prototype={zpp_inner:null,get_includes:function(){return null==this.zpp_inner.wrap_includes&&this.zpp_inner.setup_includes(),this.zpp_inner.wrap_includes},get_excludes:function(){return null==this.zpp_inner.wrap_excludes&&this.zpp_inner.setup_excludes(),this.zpp_inner.wrap_excludes},including:function(e){return this.zpp_inner.append(this.zpp_inner.includes,e),this},excluding:function(e){return this.zpp_inner.append(this.zpp_inner.excludes,e),this},toString:function(){return"@{"+this.get_includes().toString()+" excluding "+this.get_excludes().toString()+"}"},__class__:To,__properties__:{get_excludes:"get_excludes",get_includes:"get_includes"}};var Ao=function(){mo.call(this)};(n["nape.callbacks.PreCallback"]=Ao).__name__=["nape","callbacks","PreCallback"],Ao.__super__=mo,Ao.prototype=r(mo.prototype,{get_arbiter:function(){return this.zpp_inner.pre_arbiter.wrapper()},get_int1:function(){return this.zpp_inner.int1.outer_i},get_int2:function(){return this.zpp_inner.int2.outer_i},get_swapped:function(){return this.zpp_inner.pre_swapped},toString:function(){var e="Cb:PRE:";return e+=":"+this.get_int1().toString()+"/"+this.get_int2().toString(),(e+=" : "+this.get_arbiter().toString())+" : listnener: "+p.string(this.get_listener())},__class__:Ao,__properties__:r(mo.prototype.__properties__,{get_swapped:"get_swapped",get_int2:"get_int2",get_int1:"get_int1",get_arbiter:"get_arbiter"})});var Do=function(){};(n["nape.callbacks.PreFlag"]=Do).__name__=["nape","callbacks","PreFlag"],Do.__properties__={get_IGNORE_ONCE:"get_IGNORE_ONCE",get_ACCEPT_ONCE:"get_ACCEPT_ONCE",get_IGNORE:"get_IGNORE",get_ACCEPT:"get_ACCEPT"},Do.get_ACCEPT=function(){return null==up.PreFlag_ACCEPT&&(up.internal=!0,up.PreFlag_ACCEPT=new Do,up.internal=!1),up.PreFlag_ACCEPT},Do.get_IGNORE=function(){return null==up.PreFlag_IGNORE&&(up.internal=!0,up.PreFlag_IGNORE=new Do,up.internal=!1),up.PreFlag_IGNORE},Do.get_ACCEPT_ONCE=function(){return null==up.PreFlag_ACCEPT_ONCE&&(up.internal=!0,up.PreFlag_ACCEPT_ONCE=new Do,up.internal=!1),up.PreFlag_ACCEPT_ONCE},Do.get_IGNORE_ONCE=function(){return null==up.PreFlag_IGNORE_ONCE&&(up.internal=!0,up.PreFlag_IGNORE_ONCE=new Do,up.internal=!1),up.PreFlag_IGNORE_ONCE},Do.prototype={toString:function(){return this==Do.get_ACCEPT()?"ACCEPT":this==Do.get_IGNORE()?"IGNORE":this==Do.get_ACCEPT_ONCE()?"ACCEPT_ONCE":this==Do.get_IGNORE_ONCE()?"IGNORE_ONCE":""},__class__:Do};var Eo=function(e,t,n,i,r,a){null==a&&(a=!1),null==r&&(r=0),this.zpp_inner_zn=null,go.call(this),this.zpp_inner_zn=new fp(gp.argument(t),gp.argument(n),5,3),this.zpp_inner=this.zpp_inner_zn,((this.zpp_inner.outer=this).zpp_inner_zn.outer_znp=this).zpp_inner.precedence=r,this.zpp_inner_zn.pure=a,this.zpp_inner_zn.handlerp=i,this.set_interactionType(e)};(n["nape.callbacks.PreListener"]=Eo).__name__=["nape","callbacks","PreListener"],Eo.__super__=go,Eo.prototype=r(go.prototype,{zpp_inner_zn:null,get_options1:function(){return this.zpp_inner_zn.options1.outer},set_options1:function(e){return this.zpp_inner_zn.options1.set(e.zpp_inner),this.get_options1()},get_options2:function(){return this.zpp_inner_zn.options2.outer},set_options2:function(e){return this.zpp_inner_zn.options2.set(e.zpp_inner),this.get_options2()},get_handler:function(){return this.zpp_inner_zn.handlerp},set_handler:function(e){return this.zpp_inner_zn.handlerp=e,this.zpp_inner_zn.wake(),this.get_handler()},get_pure:function(){return this.zpp_inner_zn.pure},set_pure:function(e){return e||this.zpp_inner_zn.wake(),this.zpp_inner_zn.pure=e,this.get_pure()},get_interactionType:function(){var e=this.zpp_inner_zn.itype;return 1==e?No.get_COLLISION():2==e?No.get_SENSOR():4==e?No.get_FLUID():7==e?No.get_ANY():null},set_interactionType:function(e){if(this.get_interactionType()!=e){var t=e==No.get_COLLISION()?1:e==No.get_SENSOR()?2:e==No.get_FLUID()?4:7;this.zpp_inner_zn.setInteractionType(t)}return this.get_interactionType()},__class__:Eo,__properties__:r(go.prototype.__properties__,{set_interactionType:"set_interactionType",get_interactionType:"get_interactionType",set_pure:"set_pure",get_pure:"get_pure",set_handler:"set_handler",get_handler:"get_handler",set_options2:"set_options2",get_options2:"get_options2",set_options1:"set_options1",get_options1:"get_options1"})});var Oo=function(){this.debugDraw=!0,this.zpp_inner.insert_cbtype(yo.get_ANY_CONSTRAINT().zpp_inner)};(n["nape.constraint.Constraint"]=Oo).__name__=["nape","constraint","Constraint"],Oo.prototype={zpp_inner:null,get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},debugDraw:null,get_compound:function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_compound:function(e){return this.get_compound()!=e&&(null!=this.get_compound()&&this.get_compound().get_constraints().remove(this),null!=e&&e.get_constraints().add(this)),this.get_compound()},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(e){return this.get_space()!=e&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),null!=this.zpp_inner.space&&this.zpp_inner.space.outer.get_constraints().remove(this),null!=e?e.get_constraints().add(this):this.zpp_inner.space=null),this.get_space()},get_isSleeping:function(){return this.zpp_inner.component.sleeping},get_active:function(){return this.zpp_inner.active},set_active:function(e){return this.get_active()!=e&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),e?(this.zpp_inner.active=e,this.zpp_inner.activate(),null!=this.zpp_inner.space&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.sleeping=!0),this.zpp_inner.space.wake_constraint(this.zpp_inner,!0))):(null!=this.zpp_inner.space&&(this.zpp_inner.wake(),this.zpp_inner.space.live_constraints.remove(this.zpp_inner)),this.zpp_inner.active=e,this.zpp_inner.deactivate())),this.get_active()},get_ignore:function(){return this.zpp_inner.ignore},set_ignore:function(e){return this.get_ignore()!=e&&(this.zpp_inner.ignore=e,this.zpp_inner.wake()),this.get_ignore()},get_stiff:function(){return this.zpp_inner.stiff},set_stiff:function(e){return this.get_stiff()!=e&&(this.zpp_inner.stiff=e,this.zpp_inner.wake()),this.get_stiff()},get_frequency:function(){return this.zpp_inner.frequency},set_frequency:function(e){return this.get_frequency()!=e&&(this.zpp_inner.frequency=e,this.zpp_inner.stiff||this.zpp_inner.wake()),this.get_frequency()},get_damping:function(){return this.zpp_inner.damping},set_damping:function(e){return this.get_damping()!=e&&(this.zpp_inner.damping=e,this.zpp_inner.stiff||this.zpp_inner.wake()),this.get_damping()},get_maxForce:function(){return this.zpp_inner.maxForce},set_maxForce:function(e){return this.get_maxForce()!=e&&(this.zpp_inner.maxForce=e,this.zpp_inner.wake()),this.get_maxForce()},get_maxError:function(){return this.zpp_inner.maxError},set_maxError:function(e){return this.get_maxError()!=e&&(this.zpp_inner.maxError=e,this.zpp_inner.wake()),this.get_maxError()},get_breakUnderForce:function(){return this.zpp_inner.breakUnderForce},set_breakUnderForce:function(e){return this.get_breakUnderForce()!=e&&(this.zpp_inner.breakUnderForce=e,this.zpp_inner.wake()),this.get_breakUnderForce()},get_breakUnderError:function(){return this.zpp_inner.breakUnderError},set_breakUnderError:function(e){return this.get_breakUnderError()!=e&&(this.zpp_inner.breakUnderError=e,this.zpp_inner.wake()),this.get_breakUnderError()},get_removeOnBreak:function(){return this.zpp_inner.removeOnBreak},set_removeOnBreak:function(e){return this.zpp_inner.removeOnBreak=e,this.get_removeOnBreak()},impulse:function(){return null},bodyImpulse:function(e){return null},visitBodies:function(e){},get_cbTypes:function(){return null==this.zpp_inner.wrap_cbTypes&&this.zpp_inner.setupcbTypes(),this.zpp_inner.wrap_cbTypes},toString:function(){return"{Constraint}"},copy:function(){return this.zpp_inner.copy()},__class__:Oo,__properties__:{get_cbTypes:"get_cbTypes",set_removeOnBreak:"set_removeOnBreak",get_removeOnBreak:"get_removeOnBreak",set_breakUnderError:"set_breakUnderError",get_breakUnderError:"get_breakUnderError",set_breakUnderForce:"set_breakUnderForce",get_breakUnderForce:"get_breakUnderForce",set_maxError:"set_maxError",get_maxError:"get_maxError",set_maxForce:"set_maxForce",get_maxForce:"get_maxForce",set_damping:"set_damping",get_damping:"get_damping",set_frequency:"set_frequency",get_frequency:"get_frequency",set_stiff:"set_stiff",get_stiff:"get_stiff",set_ignore:"set_ignore",get_ignore:"get_ignore",set_active:"set_active",get_active:"get_active",get_isSleeping:"get_isSleeping",set_space:"set_space",get_space:"get_space",set_compound:"set_compound",get_compound:"get_compound",get_userData:"get_userData"}};var Bo=function(e,t,n,i,r){null==r&&(r=1),this.zpp_inner_zn=null,this.zpp_inner_zn=new bp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Oo.call(this),this.set_body1(e),this.set_body2(t),this.set_jointMin(n),this.set_jointMax(i),this.set_ratio(r)};(n["nape.constraint.AngleJoint"]=Bo).__name__=["nape","constraint","AngleJoint"],Bo.__super__=Oo,Bo.prototype=r(Oo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(e){return this.zpp_inner.immutable_midstep("AngleJoint::jointMin"),this.get_jointMin()!=e&&(this.zpp_inner_zn.jointMin=e,this.zpp_inner.wake()),this.get_jointMin()},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(e){return this.zpp_inner.immutable_midstep("AngleJoint::jointMax"),this.get_jointMax()!=e&&(this.zpp_inner_zn.jointMax=e,this.zpp_inner.wake()),this.get_jointMax()},get_ratio:function(){return this.zpp_inner_zn.ratio},set_ratio:function(e){return this.zpp_inner.immutable_midstep("AngleJoint::ratio"),this.get_ratio()!=e&&(this.zpp_inner_zn.ratio=e,this.zpp_inner.wake()),this.get_ratio()},isSlack:function(){return this.zpp_inner_zn.is_slack()},impulse:function(){var e=new m_(1,1);return e.setx(0,0,this.zpp_inner_zn.jAcc),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):w_.get(0,0,0)},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2())},__class__:Bo,__properties__:r(Oo.prototype.__properties__,{set_ratio:"set_ratio",get_ratio:"get_ratio",set_jointMax:"set_jointMax",get_jointMax:"get_jointMax",set_jointMin:"set_jointMin",get_jointMin:"get_jointMin",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Lo=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.constraint.ConstraintIterator"]=Lo).__name__=["nape","constraint","ConstraintIterator"],Lo.get=function(e){var t;if(null==Lo.zpp_pool){$h.internal=!0;var n=new Lo;$h.internal=!1,t=n}else{var i=Lo.zpp_pool;Lo.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},Lo.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=Lo.zpp_pool,(Lo.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:Lo};var jo=function(){this.zpp_inner=null,this.zpp_inner=new $h,this.zpp_inner.outer=this};(n["nape.constraint.ConstraintList"]=jo).__name__=["nape","constraint","ConstraintList"],jo.fromArray=function(e){for(var t=new jo,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},jo.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),Lo.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new jo,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=Lo.zpp_pool,(Lo.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:jo,__properties__:{get_length:"get_length"}};var Fo=function(e,t,n,i,r,a){this.zpp_inner_zn=null,this.zpp_inner_zn=new xp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Oo.call(this),this.set_body1(e),this.set_body2(t),this.set_anchor1(n),this.set_anchor2(i),this.set_jointMin(r),this.set_jointMax(a)};(n["nape.constraint.DistanceJoint"]=Fo).__name__=["nape","constraint","DistanceJoint"],Fo.__super__=Oo,Fo.prototype=r(Oo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(e){return this.get_anchor1().set(e),this.get_anchor1()},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(e){return this.get_anchor2().set(e),this.get_anchor2()},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(e){return this.zpp_inner.immutable_midstep("DistanceJoint::jointMin"),this.get_jointMin()!=e&&(this.zpp_inner_zn.jointMin=e,this.zpp_inner.wake()),this.get_jointMin()},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(e){return this.zpp_inner.immutable_midstep("DistanceJoint::jointMax"),this.get_jointMax()!=e&&(this.zpp_inner_zn.jointMax=e,this.zpp_inner.wake()),this.get_jointMax()},isSlack:function(){return this.zpp_inner_zn.slack},impulse:function(){var e=new m_(1,1);return e.setx(0,0,this.zpp_inner_zn.jAcc),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):w_.get()},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2())},__class__:Fo,__properties__:r(Oo.prototype.__properties__,{set_jointMax:"set_jointMax",get_jointMax:"get_jointMax",set_jointMin:"set_jointMin",get_jointMin:"get_jointMin",set_anchor2:"set_anchor2",get_anchor2:"get_anchor2",set_anchor1:"set_anchor1",get_anchor1:"get_anchor1",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Ro=function(e,t,n,i,r,a,s){this.zpp_inner_zn=null,this.zpp_inner_zn=new zp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Oo.call(this),this.set_body1(e),this.set_body2(t),this.set_anchor1(n),this.set_anchor2(i),this.set_direction(r),this.set_jointMin(a),this.set_jointMax(s)};(n["nape.constraint.LineJoint"]=Ro).__name__=["nape","constraint","LineJoint"],Ro.__super__=Oo,Ro.prototype=r(Oo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(e){return this.get_anchor1().set(e),this.get_anchor1()},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(e){return this.get_anchor2().set(e),this.get_anchor2()},get_direction:function(){return null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n(),this.zpp_inner_zn.wrap_n},set_direction:function(e){return this.get_direction().set(e),this.get_direction()},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(e){return this.zpp_inner.immutable_midstep("LineJoint::jointMin"),this.get_jointMin()!=e&&(this.zpp_inner_zn.jointMin=e,this.zpp_inner.wake()),this.get_jointMin()},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(e){return this.zpp_inner.immutable_midstep("LineJoint::jointMax"),this.get_jointMax()!=e&&(this.zpp_inner_zn.jointMax=e,this.zpp_inner.wake()),this.get_jointMax()},impulse:function(){var e=new m_(2,1);return e.setx(0,0,this.zpp_inner_zn.jAccx),e.setx(1,0,this.zpp_inner_zn.jAccy),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):w_.get()},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2())},__class__:Ro,__properties__:r(Oo.prototype.__properties__,{set_jointMax:"set_jointMax",get_jointMax:"get_jointMax",set_jointMin:"set_jointMin",get_jointMin:"get_jointMin",set_direction:"set_direction",get_direction:"get_direction",set_anchor2:"set_anchor2",get_anchor2:"get_anchor2",set_anchor1:"set_anchor1",get_anchor1:"get_anchor1",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Go=function(e,t,n,i){null==i&&(i=1),null==n&&(n=0),this.zpp_inner_zn=null,this.zpp_inner_zn=new wp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Oo.call(this),this.set_body1(e),this.set_body2(t),this.set_rate(n),this.set_ratio(i)};(n["nape.constraint.MotorJoint"]=Go).__name__=["nape","constraint","MotorJoint"],Go.__super__=Oo,Go.prototype=r(Oo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_ratio:function(){return this.zpp_inner_zn.ratio},set_ratio:function(e){return this.zpp_inner.immutable_midstep("MotorJoint::ratio"),this.get_ratio()!=e&&(this.zpp_inner_zn.ratio=e,this.zpp_inner.wake()),this.get_ratio()},get_rate:function(){return this.zpp_inner_zn.rate},set_rate:function(e){return this.zpp_inner.immutable_midstep("MotorJoint::rate"),this.get_rate()!=e&&(this.zpp_inner_zn.rate=e,this.zpp_inner.wake()),this.get_rate()},impulse:function(){var e=new m_(1,1);return e.setx(0,0,this.zpp_inner_zn.jAcc),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):w_.get()},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2())},__class__:Go,__properties__:r(Oo.prototype.__properties__,{set_rate:"set_rate",get_rate:"get_rate",set_ratio:"set_ratio",get_ratio:"get_ratio",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Zo=function(e,t,n,i){this.zpp_inner_zn=null,this.zpp_inner_zn=new kp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Oo.call(this),this.set_body1(e),this.set_body2(t),this.set_anchor1(n),this.set_anchor2(i)};(n["nape.constraint.PivotJoint"]=Zo).__name__=["nape","constraint","PivotJoint"],Zo.__super__=Oo,Zo.prototype=r(Oo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(e){return this.get_anchor1().set(e),this.get_anchor1()},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(e){return this.get_anchor2().set(e),this.get_anchor2()},impulse:function(){var e=new m_(2,1);return e.setx(0,0,this.zpp_inner_zn.jAccx),e.setx(1,0,this.zpp_inner_zn.jAccy),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):w_.get()},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2())},__class__:Zo,__properties__:r(Oo.prototype.__properties__,{set_anchor2:"set_anchor2",get_anchor2:"get_anchor2",set_anchor1:"set_anchor1",get_anchor1:"get_anchor1",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Uo=function(e,t,n,i,r,a,s,l,o,_,p){null==p&&(p=1),this.zpp_inner_zn=null,this.zpp_inner_zn=new Sp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Oo.call(this),this.set_body1(e),this.set_body2(t),this.set_body3(n),this.set_body4(i),this.set_anchor1(r),this.set_anchor2(a),this.set_anchor3(s),this.set_anchor4(l),this.set_ratio(p),this.set_jointMin(o),this.set_jointMax(_)};(n["nape.constraint.PulleyJoint"]=Uo).__name__=["nape","constraint","PulleyJoint"],Uo.__super__=Oo,Uo.prototype=r(Oo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&this.zpp_inner_zn.b3!=t&&this.zpp_inner_zn.b4!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&this.zpp_inner_zn.b3!=t&&this.zpp_inner_zn.b4!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_body3:function(){return null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer},set_body3:function(e){this.zpp_inner.immutable_midstep("Constraint::body3");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b3&&(null!=this.zpp_inner_zn.b3&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b3&&null!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b3.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b3.wake()),this.zpp_inner_zn.b3=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&this.zpp_inner_zn.b2!=t&&this.zpp_inner_zn.b4!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body3()},get_body4:function(){return null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer},set_body4:function(e){this.zpp_inner.immutable_midstep("Constraint::body4");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b4&&(null!=this.zpp_inner_zn.b4&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b4&&null!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b4.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b4.wake()),this.zpp_inner_zn.b4=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&this.zpp_inner_zn.b2!=t&&this.zpp_inner_zn.b3!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body4()},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(e){return this.get_anchor1().set(e),this.get_anchor1()},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(e){return this.get_anchor2().set(e),this.get_anchor2()},get_anchor3:function(){return null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3(),this.zpp_inner_zn.wrap_a3},set_anchor3:function(e){return this.get_anchor3().set(e),this.get_anchor3()},get_anchor4:function(){return null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4(),this.zpp_inner_zn.wrap_a4},set_anchor4:function(e){return this.get_anchor4().set(e),this.get_anchor4()},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(e){return this.zpp_inner.immutable_midstep("PulleyJoint::jointMin"),this.get_jointMin()!=e&&(this.zpp_inner_zn.jointMin=e,this.zpp_inner.wake()),this.get_jointMin()},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(e){return this.zpp_inner.immutable_midstep("PulleyJoint::jointMax"),this.get_jointMax()!=e&&(this.zpp_inner_zn.jointMax=e,this.zpp_inner.wake()),this.get_jointMax()},get_ratio:function(){return this.zpp_inner_zn.ratio},set_ratio:function(e){return this.zpp_inner.immutable_midstep("PulleyJoint::ratio"),this.get_ratio()!=e&&(this.zpp_inner_zn.ratio=e,this.zpp_inner.wake()),this.get_ratio()},isSlack:function(){return this.zpp_inner_zn.slack},impulse:function(){var e=new m_(1,1);return e.setx(0,0,this.zpp_inner_zn.jAcc),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):w_.get()},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2()),null!=this.get_body3()&&this.get_body3()!=this.get_body1()&&this.get_body3()!=this.get_body2()&&e(this.get_body3()),null!=this.get_body4()&&this.get_body4()!=this.get_body1()&&this.get_body4()!=this.get_body2()&&this.get_body4()!=this.get_body3()&&e(this.get_body4())},__class__:Uo,__properties__:r(Oo.prototype.__properties__,{set_ratio:"set_ratio",get_ratio:"get_ratio",set_jointMax:"set_jointMax",get_jointMax:"get_jointMax",set_jointMin:"set_jointMin",get_jointMin:"get_jointMin",set_anchor4:"set_anchor4",get_anchor4:"get_anchor4",set_anchor3:"set_anchor3",get_anchor3:"get_anchor3",set_anchor2:"set_anchor2",get_anchor2:"get_anchor2",set_anchor1:"set_anchor1",get_anchor1:"get_anchor1",set_body4:"set_body4",get_body4:"get_body4",set_body3:"set_body3",get_body3:"get_body3",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Vo=function(e,t){null==t&&(t=!1),this.zpp_inner_zn=null,this.zpp_inner_zn=new Cp(e,t),this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Oo.call(this)};(n["nape.constraint.UserConstraint"]=Vo).__name__=["nape","constraint","UserConstraint"],Vo.__super__=Oo,Vo.prototype=r(Oo.prototype,{zpp_inner_zn:null,__bindVec2:function(){var e=new y_;return e.zpp_inner._inuse=!0,e.zpp_inner._invalidate=Cc(kc=this.zpp_inner_zn,kc.bindVec2_invalidate),e},__copy:function(){return null},__broken:function(){},__validate:function(){},__draw:function(e){},__prepare:function(){},__position:function(e){},__velocity:function(e){},__eff_mass:function(e){},__clamp:function(e){},__impulse:function(e,t,n){},impulse:function(){for(var e=new m_(this.zpp_inner_zn.dim,1),t=0,n=this.zpp_inner_zn.dim;t<n;){var i=t++;e.setx(i,0,this.zpp_inner_zn.jAcc[i])}return e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):w_.get()},visitBodies:function(e){for(var t=0,n=this.zpp_inner_zn.bodies.length;t<n;){var i=this.zpp_inner_zn.bodies[t];if(null!=i.body){for(var r=!1,a=t+1,s=n;a<s;){var l=a++;if(this.zpp_inner_zn.bodies[l].body==i.body){r=!0;break}}r||e(i.body.outer)}++t}},__invalidate:function(){this.zpp_inner.immutable_midstep("UserConstraint::invalidate()"),this.get_active()&&null!=this.get_space()&&this.zpp_inner.wake()},__registerBody:function(e,t){return this.zpp_inner.immutable_midstep("UserConstraint::registerBody(..)"),e!=t&&(null!=e&&(this.zpp_inner_zn.remBody(e.zpp_inner),this.get_active()&&null!=this.get_space()&&e.zpp_inner.wake()),null!=t&&this.zpp_inner_zn.addBody(t.zpp_inner),this.zpp_inner.wake(),null!=t&&t.zpp_inner.wake()),t},__class__:Vo});var qo=function(e,t,n,i,r){null==r&&(r=0),this.zpp_inner_zn=null,this.zpp_inner_zn=new Pp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Oo.call(this),this.set_body1(e),this.set_body2(t),this.set_anchor1(n),this.set_anchor2(i),this.set_phase(r)};(n["nape.constraint.WeldJoint"]=qo).__name__=["nape","constraint","WeldJoint"],qo.__super__=Oo,qo.prototype=r(Oo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(e){return this.get_anchor1().set(e),this.get_anchor1()},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(e){return this.get_anchor2().set(e),this.get_anchor2()},get_phase:function(){return this.zpp_inner_zn.phase},set_phase:function(e){return this.zpp_inner.immutable_midstep("WeldJoint::phase"),this.get_phase()!=e&&(this.zpp_inner_zn.phase=e,this.zpp_inner.wake()),this.get_phase()},impulse:function(){var e=new m_(3,1);return e.setx(0,0,this.zpp_inner_zn.jAccx),e.setx(1,0,this.zpp_inner_zn.jAccy),e.setx(1,0,this.zpp_inner_zn.jAccz),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):w_.get()},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2())},__class__:qo,__properties__:r(Oo.prototype.__properties__,{set_phase:"set_phase",get_phase:"get_phase",set_anchor2:"set_anchor2",get_anchor2:"get_anchor2",set_anchor1:"set_anchor1",get_anchor1:"get_anchor1",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Wo=function(){this.zpp_inner=null,Mp.internal};(n["nape.dynamics.Arbiter"]=Wo).__name__=["nape","dynamics","Arbiter"],Wo.prototype={zpp_inner:null,get_isSleeping:function(){return this.zpp_inner.sleeping},get_type:function(){return Mp.types[this.zpp_inner.type]},isCollisionArbiter:function(){return this.zpp_inner.type==Mp.COL},isFluidArbiter:function(){return this.zpp_inner.type==Mp.FLUID},isSensorArbiter:function(){return this.zpp_inner.type==Mp.SENSOR},get_collisionArbiter:function(){return this.isCollisionArbiter()?this.zpp_inner.colarb.outer_zn:null},get_fluidArbiter:function(){return this.isFluidArbiter()?this.zpp_inner.fluidarb.outer_zn:null},get_shape1:function(){return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer},get_shape2:function(){return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer},get_body1:function(){return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer},get_body2:function(){return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:this.zpp_inner.b2.outer},get_state:function(){var e=this.zpp_inner.immState;return 5==e?Do.get_ACCEPT():1==e?Do.get_ACCEPT_ONCE():6==e?Do.get_IGNORE():Do.get_IGNORE_ONCE()},totalImpulse:function(e,t){return null==t&&(t=!1),w_.get(0,0,0)},toString:function(){var e=this.isCollisionArbiter()?"CollisionArbiter":this.isFluidArbiter()?"FluidArbiter":"SensorArbiter";return this.zpp_inner.cleared?e+"(object-pooled)":e+"("+this.get_shape1().toString()+"|"+this.get_shape2().toString()+")"+(this.isCollisionArbiter()?"["+["SD","DD"][this.zpp_inner.colarb.stat?0:1]+"]":"")+"<-"+this.get_state().toString()},__class__:Wo,__properties__:{get_state:"get_state",get_body2:"get_body2",get_body1:"get_body1",get_shape2:"get_shape2",get_shape1:"get_shape1",get_fluidArbiter:"get_fluidArbiter",get_collisionArbiter:"get_collisionArbiter",get_type:"get_type",get_isSleeping:"get_isSleeping"}};var Xo=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.dynamics.ArbiterIterator"]=Xo).__name__=["nape","dynamics","ArbiterIterator"],Xo.get=function(e){var t;if(null==Xo.zpp_pool){hc.internal=!0;var n=new Xo;hc.internal=!1,t=n}else{var i=Xo.zpp_pool;Xo.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},Xo.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=Xo.zpp_pool,(Xo.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:Xo};var Ho=function(){this.zpp_inner=null,this.zpp_inner=new hc,this.zpp_inner.outer=this};(n["nape.dynamics.ArbiterList"]=Ho).__name__=["nape","dynamics","ArbiterList"],Ho.fromArray=function(e){for(var t=new Ho,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},Ho.prototype={zpp_inner:null,get_length:function(){return this.zpp_gl()},zpp_gl:function(){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var e=this.zpp_inner.inner.begin();null!=e;)e.elem().active&&this.zpp_inner.user_length++,e=e.next}return this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},has:function(e){return this.zpp_vm(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_vm(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)for(this.zpp_inner.at_index=0,this.zpp_inner.at_ite=this.zpp_inner.inner.begin();!this.zpp_inner.at_ite.elem().active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;for(;this.zpp_inner.at_index!=e;)for(this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;!this.zpp_inner.at_ite.elem().active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().wrapper()},push:function(e){this.zpp_inner.modify_test(),this.zpp_vm();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_vm();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_vm();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.wrapper()},shift:function(){this.zpp_inner.modify_test(),this.zpp_vm();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.wrapper()},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_vm(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return 0==this.get_length()},iterator:function(){return this.zpp_vm(),Xo.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new Ho,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=Xo.zpp_pool,(Xo.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:Ho,__properties__:{get_length:"get_length"}};var Yo=function(){};(n["nape.dynamics.ArbiterType"]=Yo).__name__=["nape","dynamics","ArbiterType"],Yo.__properties__={get_FLUID:"get_FLUID",get_SENSOR:"get_SENSOR",get_COLLISION:"get_COLLISION"},Yo.get_COLLISION=function(){return null==up.ArbiterType_COLLISION&&(up.internal=!0,up.ArbiterType_COLLISION=new Yo,up.internal=!1),up.ArbiterType_COLLISION},Yo.get_SENSOR=function(){return null==up.ArbiterType_SENSOR&&(up.internal=!0,up.ArbiterType_SENSOR=new Yo,up.internal=!1),up.ArbiterType_SENSOR},Yo.get_FLUID=function(){return null==up.ArbiterType_FLUID&&(up.internal=!0,up.ArbiterType_FLUID=new Yo,up.internal=!1),up.ArbiterType_FLUID},Yo.prototype={toString:function(){return this==Yo.get_COLLISION()?"COLLISION":this==Yo.get_SENSOR()?"SENSOR":this==Yo.get_FLUID()?"FLUID":""},__class__:Yo};var Jo=function(){Wo.call(this)};(n["nape.dynamics.CollisionArbiter"]=Jo).__name__=["nape","dynamics","CollisionArbiter"],Jo.__super__=Wo,Jo.prototype=r(Wo.prototype,{get_contacts:function(){return null==this.zpp_inner.colarb.wrap_contacts&&this.zpp_inner.colarb.setupcontacts(),this.zpp_inner.colarb.wrap_contacts},get_normal:function(){return null==this.zpp_inner.colarb.wrap_normal&&this.zpp_inner.colarb.getnormal(),this.zpp_inner.colarb.wrap_normal},get_radius:function(){return this.zpp_inner.colarb.radius},get_referenceEdge1:function(){var e=this.zpp_inner.colarb.__ref_edge1;return null==e||this.get_shape1().isPolygon()&&this.get_shape1().zpp_inner==e.polygon||(e=this.zpp_inner.colarb.__ref_edge2),null==e?null:e.wrapper()},get_referenceEdge2:function(){var e=this.zpp_inner.colarb.__ref_edge1;return null==e||this.get_shape2().isPolygon()&&this.get_shape2().zpp_inner==e.polygon||(e=this.zpp_inner.colarb.__ref_edge2),null==e?null:e.wrapper()},firstVertex:function(){return!(null!=this.zpp_inner.colarb.__ref_edge1==(null!=this.zpp_inner.colarb.__ref_edge2))&&-1==this.zpp_inner.colarb.__ref_vertex},secondVertex:function(){return!(null!=this.zpp_inner.colarb.__ref_edge1==(null!=this.zpp_inner.colarb.__ref_edge2))&&1==this.zpp_inner.colarb.__ref_vertex},normalImpulse:function(e,t){null==t&&(t=!1);var n=0,i=0,r=0,a=this.zpp_inner.colarb;if(!t||a.oc1.fresh){var s=a.oc1.wrapper().normalImpulse(e);n+=1*s.get_x(),i+=1*s.get_y(),r+=1*s.get_z(),s.dispose()}if(a.hc2&&(!t||a.oc2.fresh)){var l=a.oc2.wrapper().normalImpulse(e);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}return w_.get(n,i,r)},tangentImpulse:function(e,t){null==t&&(t=!1);var n=0,i=0,r=0,a=this.zpp_inner.colarb;if(!t||a.oc1.fresh){var s=a.oc1.wrapper().tangentImpulse(e);n+=1*s.get_x(),i+=1*s.get_y(),r+=1*s.get_z(),s.dispose()}if(a.hc2&&(!t||a.oc2.fresh)){var l=a.oc2.wrapper().tangentImpulse(e);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}return w_.get(n,i,r)},totalImpulse:function(e,t){null==t&&(t=!1);var n=0,i=0,r=0,a=this.zpp_inner.colarb;if(!t||a.oc1.fresh){var s=a.oc1.wrapper().totalImpulse(e);n+=1*s.get_x(),i+=1*s.get_y(),r+=1*s.get_z(),s.dispose()}if(a.hc2&&(!t||a.oc2.fresh)){var l=a.oc2.wrapper().totalImpulse(e);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}return w_.get(n,i,r)},rollingImpulse:function(e,t){null==t&&(t=!1);var n=this.zpp_inner.colarb;return!t||n.oc1.fresh?n.oc1.wrapper().rollingImpulse(e):0},get_elasticity:function(){var e=this.zpp_inner.colarb;return e.validate_props(),e.restitution},set_elasticity:function(e){var t=this.zpp_inner.colarb;return t.restitution=e,t.userdef_restitution=!0,this.get_elasticity()},get_dynamicFriction:function(){var e=this.zpp_inner.colarb;return e.validate_props(),e.dyn_fric},set_dynamicFriction:function(e){var t=this.zpp_inner.colarb;return t.dyn_fric=e,t.userdef_dyn_fric=!0,this.get_dynamicFriction()},get_staticFriction:function(){var e=this.zpp_inner.colarb;return e.validate_props(),e.stat_fric},set_staticFriction:function(e){var t=this.zpp_inner.colarb;return t.stat_fric=e,t.userdef_stat_fric=!0,this.get_staticFriction()},get_rollingFriction:function(){var e=this.zpp_inner.colarb;return e.validate_props(),e.rfric},set_rollingFriction:function(e){var t=this.zpp_inner.colarb;return t.rfric=e,t.userdef_rfric=!0,this.get_rollingFriction()},__class__:Jo,__properties__:r(Wo.prototype.__properties__,{set_rollingFriction:"set_rollingFriction",get_rollingFriction:"get_rollingFriction",set_staticFriction:"set_staticFriction",get_staticFriction:"get_staticFriction",set_dynamicFriction:"set_dynamicFriction",get_dynamicFriction:"get_dynamicFriction",set_elasticity:"set_elasticity",get_elasticity:"get_elasticity",get_referenceEdge2:"get_referenceEdge2",get_referenceEdge1:"get_referenceEdge1",get_radius:"get_radius",get_normal:"get_normal",get_contacts:"get_contacts"})});var Ko=function(){this.zpp_inner=null};(n["nape.dynamics.Contact"]=Ko).__name__=["nape","dynamics","Contact"],Ko.prototype={zpp_inner:null,get_arbiter:function(){return null==this.zpp_inner.arbiter?null:this.zpp_inner.arbiter.outer.get_collisionArbiter()},get_penetration:function(){return-this.zpp_inner.dist},get_position:function(){return null==this.zpp_inner.wrap_position&&this.zpp_inner.getposition(),this.zpp_inner.wrap_position},get_fresh:function(){return this.zpp_inner.fresh},normalImpulse:function(e){var t=this.zpp_inner.arbiter.colarb,n=this.zpp_inner.inner,i=n.jnAcc;return null==e?w_.get(t.nx*i,t.ny*i):e==t.b1.outer?w_.get(t.nx*-i,t.ny*-i,-(t.ny*n.r1x-t.nx*n.r1y)*i):w_.get(t.nx*i,t.ny*i,(t.ny*n.r2x-t.nx*n.r2y)*i)},tangentImpulse:function(e){var t=this.zpp_inner.arbiter.colarb,n=this.zpp_inner.inner,i=n.jtAcc;return null==e?w_.get(-t.ny*i,t.nx*i):e==t.b1.outer?w_.get(t.ny*i,-t.nx*i,-(n.r1x*t.nx+n.r1y*t.ny)*i):w_.get(-t.ny*i,t.nx*i,(n.r2x*t.nx+n.r2y*t.ny)*i)},rollingImpulse:function(e){var t=this.zpp_inner.arbiter.colarb,n=this.zpp_inner.arbiter.colarb.jrAcc;return null==e?n:e==t.b1.outer?-n:n},totalImpulse:function(e){var t=this.zpp_inner.arbiter.colarb,n=this.zpp_inner.inner,i=n.jnAcc,r=n.jtAcc,a=t.jrAcc;if(null==e)return w_.get(t.nx*i-t.ny*r,t.ny*i+t.nx*r,a);var s=t.nx*i-t.ny*r,l=t.ny*i+t.nx*r;return e==t.b1.outer?w_.get(-s,-l,-(l*n.r1x-s*n.r1y)-a):w_.get(s,l,l*n.r2x-s*n.r2y+a)},get_friction:function(){return this.zpp_inner.inner.friction},toString:function(){return null==this.zpp_inner.arbiter||this.zpp_inner.arbiter.cleared?"{object-pooled}":"{Contact}"},__class__:Ko,__properties__:{get_friction:"get_friction",get_fresh:"get_fresh",get_position:"get_position",get_penetration:"get_penetration",get_arbiter:"get_arbiter"}};var Qo=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.dynamics.ContactIterator"]=Qo).__name__=["nape","dynamics","ContactIterator"],Qo.get=function(e){var t;if(null==Qo.zpp_pool){cc.internal=!0;var n=new Qo;cc.internal=!1,t=n}else{var i=Qo.zpp_pool;Qo.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},Qo.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=Qo.zpp_pool,(Qo.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:Qo};var $o=function(){this.zpp_inner=null,this.zpp_inner=new cc,this.zpp_inner.outer=this};(n["nape.dynamics.ContactList"]=$o).__name__=["nape","dynamics","ContactList"],$o.fromArray=function(e){for(var t=new $o,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},$o.prototype={zpp_inner:null,get_length:function(){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var e=this.zpp_inner.inner.begin();null!=e;){var t=e.elem();t.active&&t.arbiter.active&&this.zpp_inner.user_length++,e=e.next}}return this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)for(this.zpp_inner.at_index=0,this.zpp_inner.at_ite=this.zpp_inner.inner.begin();;){var t=this.zpp_inner.at_ite.elem();if(t.active&&t.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}for(;this.zpp_inner.at_index!=e;)for(this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;;){var n=this.zpp_inner.at_ite.elem();if(n.active&&n.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}return this.zpp_inner.at_ite.elem().wrapper()},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.wrapper()},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.wrapper()},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return 0==this.get_length()},iterator:function(){return this.zpp_inner.valmod(),Qo.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new $o,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=Qo.zpp_pool,(Qo.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:$o,__properties__:{get_length:"get_length"}};var e_=function(){Wo.call(this)};(n["nape.dynamics.FluidArbiter"]=e_).__name__=["nape","dynamics","FluidArbiter"],e_.__super__=Wo,e_.prototype=r(Wo.prototype,{get_position:function(){return null==this.zpp_inner.fluidarb.wrap_position&&this.zpp_inner.fluidarb.getposition(),this.zpp_inner.fluidarb.wrap_position},set_position:function(e){return this.get_position().set(e),this.get_position()},get_overlap:function(){return this.zpp_inner.fluidarb.overlap},set_overlap:function(e){return this.zpp_inner.fluidarb.overlap=e,this.get_overlap()},buoyancyImpulse:function(e){var t=this.zpp_inner.fluidarb;return null==e?w_.get(t.buoyx,t.buoyy,0):e.zpp_inner==this.zpp_inner.b2?w_.get(t.buoyx,t.buoyy,t.buoyy*t.r2x-t.buoyx*t.r2y):w_.get(-t.buoyx,-t.buoyy,-(t.buoyy*t.r1x-t.buoyx*t.r1y))},dragImpulse:function(e){var t=this.zpp_inner.fluidarb,n=null==e||e.zpp_inner==this.zpp_inner.b2?1:-1;return w_.get(t.dampx*n,t.dampy*n,t.adamp*n)},totalImpulse:function(e,t){null==t&&(t=!1);var n=this.buoyancyImpulse(e),i=this.dragImpulse(e),r=i;r.set_x(r.get_x()+n.get_x());var a=i;a.set_y(a.get_y()+n.get_y());var s=i;return s.set_z(s.get_z()+n.get_z()),n.dispose(),i},__class__:e_,__properties__:r(Wo.prototype.__properties__,{set_overlap:"set_overlap",get_overlap:"get_overlap",set_position:"set_position",get_position:"get_position"})});var t_=function(e){null==e&&(e=!1),this.zpp_inner=null,this.zpp_inner=new Op,(this.zpp_inner.outer=this).set_ignore(e)};(n["nape.dynamics.InteractionGroup"]=t_).__name__=["nape","dynamics","InteractionGroup"],t_.prototype={zpp_inner:null,get_group:function(){return null==this.zpp_inner.group?null:this.zpp_inner.group.outer},set_group:function(e){return this.zpp_inner.setGroup(null==e?null:e.zpp_inner),this.get_group()},get_ignore:function(){return this.zpp_inner.ignore},set_ignore:function(e){return this.get_ignore()!=e&&(this.zpp_inner.invalidate(!0),this.zpp_inner.ignore=e),this.get_ignore()},get_interactors:function(){return null==this.zpp_inner.wrap_interactors&&(this.zpp_inner.wrap_interactors=tc.get(this.zpp_inner.interactors,!0)),this.zpp_inner.wrap_interactors},get_groups:function(){return null==this.zpp_inner.wrap_groups&&(this.zpp_inner.wrap_groups=uc.get(this.zpp_inner.groups,!0)),this.zpp_inner.wrap_groups},toString:function(){var e="InteractionGroup";return this.get_ignore()&&(e+=":ignore"),e},__class__:t_,__properties__:{get_groups:"get_groups",get_interactors:"get_interactors",set_ignore:"set_ignore",get_ignore:"get_ignore",set_group:"set_group",get_group:"get_group"}};var n_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.dynamics.InteractionGroupIterator"]=n_).__name__=["nape","dynamics","InteractionGroupIterator"],n_.get=function(e){var t;if(null==n_.zpp_pool){uc.internal=!0;var n=new n_;uc.internal=!1,t=n}else{var i=n_.zpp_pool;n_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},n_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=n_.zpp_pool,(n_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:n_};var i_=function(){this.zpp_inner=null,this.zpp_inner=new uc,this.zpp_inner.outer=this};(n["nape.dynamics.InteractionGroupList"]=i_).__name__=["nape","dynamics","InteractionGroupList"],i_.fromArray=function(e){for(var t=new i_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},i_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),n_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new i_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=n_.zpp_pool,(n_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:i_,__properties__:{get_length:"get_length"}};var r_=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.zpp_inner=null,this.zpp_inner=Lp.get(e,t,e+n,t+i),this.zpp_inner.outer=this};(n["nape.geom.AABB"]=r_).__name__=["nape","geom","AABB"],r_.prototype={zpp_inner:null,copy:function(){return this.zpp_inner.validate(),this.zpp_inner.copy().wrapper()},get_min:function(){return this.zpp_inner.getmin()},set_min:function(e){return this.get_min().set(e),this.get_min()},get_max:function(){return this.zpp_inner.getmax()},set_max:function(e){return this.get_max().set(e),this.get_max()},get_x:function(){return this.zpp_inner.validate(),this.zpp_inner.minx},set_x:function(e){return this.get_x()!=e&&(this.zpp_inner.maxx+=e-this.zpp_inner.minx,this.zpp_inner.minx=e,this.zpp_inner.invalidate()),this.get_x()},get_y:function(){return this.zpp_inner.validate(),this.zpp_inner.miny},set_y:function(e){return this.get_y()!=e&&(this.zpp_inner.maxy+=e-this.zpp_inner.miny,this.zpp_inner.miny=e,this.zpp_inner.invalidate()),this.get_y()},get_width:function(){return this.zpp_inner.validate(),this.zpp_inner.width()},set_width:function(e){if(this.get_width()!=e){var t=this.get_x();this.zpp_inner.maxx=t+e,this.zpp_inner.invalidate()}return this.get_width()},get_height:function(){return this.zpp_inner.validate(),this.zpp_inner.height()},set_height:function(e){if(this.get_height()!=e){var t=this.get_y();this.zpp_inner.maxy=t+e,this.zpp_inner.invalidate()}return this.get_height()},toString:function(){return this.zpp_inner.validate(),this.zpp_inner.toString()},__class__:r_,__properties__:{set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x",set_max:"set_max",get_max:"get_max",set_min:"set_min",get_min:"get_min"}};var a_=function(){this.zpp_inner=null};(n["nape.geom.ConvexResult"]=a_).__name__=["nape","geom","ConvexResult"],a_.prototype={zpp_inner:null,get_normal:function(){return this.zpp_inner.normal},get_position:function(){return this.zpp_inner.position},get_toi:function(){return this.zpp_inner.toiDistance},get_shape:function(){return this.zpp_inner.shape},dispose:function(){this.zpp_inner.free()},toString:function(){return"{ shape: "+p.string(this.get_shape())+" toi: "+this.get_toi()+" }"},__class__:a_,__properties__:{get_shape:"get_shape",get_toi:"get_toi",get_position:"get_position",get_normal:"get_normal"}};var s_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.geom.ConvexResultIterator"]=s_).__name__=["nape","geom","ConvexResultIterator"],s_.get=function(e){var t;if(null==s_.zpp_pool){oc.internal=!0;var n=new s_;oc.internal=!1,t=n}else{var i=s_.zpp_pool;s_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},s_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=s_.zpp_pool,(s_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:s_};var l_=function(){this.zpp_inner=null,this.zpp_inner=new oc,this.zpp_inner.outer=this};(n["nape.geom.ConvexResultList"]=l_).__name__=["nape","geom","ConvexResultList"],l_.fromArray=function(e){for(var t=new l_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},l_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem()},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e)}else this.zpp_inner.inner.add(e);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=e=this.zpp_inner.inner.front();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=e=null==n?this.zpp_inner.inner.front():n.next.elem();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=e=null==t?this.zpp_inner.inner.front():t.next.elem();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=e=this.zpp_inner.inner.front();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),s_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new l_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=s_.zpp_pool,(s_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:l_,__properties__:{get_length:"get_length"}};var o_=function(){};(n["nape.geom.Geom"]=o_).__name__=["nape","geom","Geom"],o_.distanceBody=function(e,t,n,i){n.zpp_inner.immutable(),i.zpp_inner.immutable();for(var r=e.zpp_inner.shapes.begin();null!=r;){var a=r.elem();qp.validateShape(a),r=r.next}for(var s=t.zpp_inner.shapes.begin();null!=s;){var l=s.elem();qp.validateShape(l),s=s.next}return cu.distanceBody(e.zpp_inner,t.zpp_inner,n.zpp_inner,i.zpp_inner)},o_.distance=function(e,t,n,i){var r;n.zpp_inner.immutable(),i.zpp_inner.immutable(),qp.validateShape(e.zpp_inner),qp.validateShape(t.zpp_inner),null==fu.zpp_pool?r=new fu:(r=fu.zpp_pool,fu.zpp_pool=r.next,r.next=null),r.alloc();var a=cu.distance(e.zpp_inner,t.zpp_inner,n.zpp_inner,i.zpp_inner,r,$_.FMAX),s=r;return s.free(),s.next=fu.zpp_pool,fu.zpp_pool=s,a},o_.intersectsBody=function(e,t){for(var n=e.zpp_inner.shapes.begin();null!=n;){var i=n.elem();qp.validateShape(i),n=n.next}for(var r=t.zpp_inner.shapes.begin();null!=r;){var a=r.elem();qp.validateShape(a),r=r.next}if(e.zpp_inner.aabb.intersect(t.zpp_inner.aabb)){for(var s=e.zpp_inner.shapes.begin();null!=s;){for(var l=s.elem(),o=t.zpp_inner.shapes.begin();null!=o;){var _=o.elem();if(Fp.testCollide_safe(l,_))return!0;o=o.next}s=s.next}return!1}return!1},o_.intersects=function(e,t){return qp.validateShape(e.zpp_inner),qp.validateShape(t.zpp_inner),!!e.zpp_inner.aabb.intersect(t.zpp_inner.aabb)&&Fp.testCollide_safe(e.zpp_inner,t.zpp_inner)},o_.contains=function(e,t){return qp.validateShape(e.zpp_inner),qp.validateShape(t.zpp_inner),Fp.containTest(e.zpp_inner,t.zpp_inner)};var __=function(e){if(this.zpp_inner=null,this.zpp_pool=null,this.zpp_inner=new Xp(this),null!=e){if(e instanceof Array&&null==e.__enum__)for(var t=e,n=0;n<t.length;){var i=t[n];++n;var r=i,a=Wp.get(r.get_x(),r.get_y());null==this.zpp_inner.vertices?this.zpp_inner.vertices=a.prev=a.next=a:(a.prev=this.zpp_inner.vertices,a.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=a,this.zpp_inner.vertices.next=a),this.zpp_inner.vertices=a}else if(p.is(e,z_))for(var s=e.iterator();s.hasNext();){var l=s.next(),o=Wp.get(l.get_x(),l.get_y());null==this.zpp_inner.vertices?this.zpp_inner.vertices=o.prev=o.next=o:(o.prev=this.zpp_inner.vertices,o.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=o,this.zpp_inner.vertices.next=o),this.zpp_inner.vertices=o}else if(p.is(e,__)){var _=e.zpp_inner.vertices;if(null!=_)for(var u=_;;){var h=y_.get(u.x,u.y);u=u.next;var c=Wp.get(h.get_x(),h.get_y());if(null==this.zpp_inner.vertices?this.zpp_inner.vertices=c.prev=c.next=c:(c.prev=this.zpp_inner.vertices,c.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=c,this.zpp_inner.vertices.next=c),this.zpp_inner.vertices=c,h.dispose(),u==_)break}}if(this.skipForward(1),e instanceof Array&&null==e.__enum__)for(var d=e,m=0;m<d.length;){var f=d[m];f.zpp_inner.weak&&(f.dispose(),1)?d.splice(m,1):++m}else if(p.is(e,z_)){var g=e;null!=g.zpp_inner._validate&&g.zpp_inner._validate();for(var v=g.zpp_inner.inner,b=null,y=v.begin();null!=y;){var x=y.elem();x.outer.zpp_inner.weak?(y=v.erase(b),x.outer.zpp_inner.weak&&x.outer.dispose()):y=(b=y).next}}}};(n["nape.geom.GeomPoly"]=__).__name__=["nape","geom","GeomPoly"],__.get=function(e){var t;if(null==mc.poolGeomPoly?t=new __:(t=mc.poolGeomPoly,mc.poolGeomPoly=t.zpp_pool,t.zpp_pool=null),null!=e){if(e instanceof Array&&null==e.__enum__)for(var n=e,i=0;i<n.length;){var r=n[i];++i;var a=r,s=Wp.get(a.get_x(),a.get_y());null==t.zpp_inner.vertices?t.zpp_inner.vertices=s.prev=s.next=s:(s.prev=t.zpp_inner.vertices,s.next=t.zpp_inner.vertices.next,t.zpp_inner.vertices.next.prev=s,t.zpp_inner.vertices.next=s),t.zpp_inner.vertices=s}else if(p.is(e,z_))for(var l=e.iterator();l.hasNext();){var o=l.next(),_=Wp.get(o.get_x(),o.get_y());null==t.zpp_inner.vertices?t.zpp_inner.vertices=_.prev=_.next=_:(_.prev=t.zpp_inner.vertices,_.next=t.zpp_inner.vertices.next,t.zpp_inner.vertices.next.prev=_,t.zpp_inner.vertices.next=_),t.zpp_inner.vertices=_}else if(p.is(e,__)){var u=e.zpp_inner.vertices;if(null!=u)for(var h=u;;){var c=y_.get(h.x,h.y);h=h.next;var d=Wp.get(c.get_x(),c.get_y());if(null==t.zpp_inner.vertices?t.zpp_inner.vertices=d.prev=d.next=d:(d.prev=t.zpp_inner.vertices,d.next=t.zpp_inner.vertices.next,t.zpp_inner.vertices.next.prev=d,t.zpp_inner.vertices.next=d),t.zpp_inner.vertices=d,c.dispose(),h==u)break}}if(t.skipForward(1),e instanceof Array&&null==e.__enum__)for(var m=e,f=0;f<m.length;){var g=m[f];g.zpp_inner.weak&&(g.dispose(),1)?m.splice(f,1):++f}else if(p.is(e,z_)){var v=e;null!=v.zpp_inner._validate&&v.zpp_inner._validate();for(var b=v.zpp_inner.inner,y=null,x=b.begin();null!=x;){var z=x.elem();z.outer.zpp_inner.weak?(x=b.erase(y),z.outer.zpp_inner.weak&&z.outer.dispose()):x=(y=x).next}}}return t},__.prototype={zpp_pool:null,zpp_inner:null,empty:function(){return null==this.zpp_inner.vertices},size:function(){var e=0,t=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;++e,(i=i.next)!=n;);return e},iterator:function(){return Hp.get(this.zpp_inner.vertices,!0)},forwardIterator:function(){return Hp.get(this.zpp_inner.vertices,!0)},backwardsIterator:function(){return Hp.get(this.zpp_inner.vertices,!1)},current:function(){return this.zpp_inner.vertices.wrapper()},push:function(e){var t=Wp.get(e.get_x(),e.get_y());return null==this.zpp_inner.vertices?this.zpp_inner.vertices=t.prev=t.next=t:(t.prev=this.zpp_inner.vertices,t.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=t,this.zpp_inner.vertices.next=t),this.zpp_inner.vertices=t,e.zpp_inner.weak&&e.dispose(),this},pop:function(){var e,t=this.zpp_inner.vertices;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,e=null;else{var n=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,e=n}this.zpp_inner.vertices=e;var i=t;return i.free(),i.next=Wp.zpp_pool,Wp.zpp_pool=i,this},unshift:function(e){var t=Wp.get(e.get_x(),e.get_y());return null==this.zpp_inner.vertices?this.zpp_inner.vertices=t.prev=t.next=t:(t.next=this.zpp_inner.vertices,t.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.prev.next=t,this.zpp_inner.vertices.prev=t),this.zpp_inner.vertices=t,e.zpp_inner.weak&&e.dispose(),this},shift:function(){var e,t=this.zpp_inner.vertices;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,e=this.zpp_inner.vertices=null;else{var n=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,e=n}this.zpp_inner.vertices=e;var i=t;return i.free(),i.next=Wp.zpp_pool,Wp.zpp_pool=i,this},skipForward:function(e){if(null!=this.zpp_inner.vertices)if(0<e)for(;0<e--;)this.zpp_inner.vertices=this.zpp_inner.vertices.next;else if(e<0)for(;e++<0;)this.zpp_inner.vertices=this.zpp_inner.vertices.prev;return this},skipBackwards:function(e){return this.skipForward(-e)},erase:function(e){for(;0!=e&&null!=this.zpp_inner.vertices;){var t=this.zpp_inner.vertices;if(0<e){var n;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,n=this.zpp_inner.vertices=null;else{var i=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,n=i}this.zpp_inner.vertices=n,--e}else if(e<0){var r;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,r=null;else{var a=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,r=a}this.zpp_inner.vertices=r,++e}var s=t;s.free(),s.next=Wp.zpp_pool,Wp.zpp_pool=s}return this},clear:function(){for(;null!=this.zpp_inner.vertices;){var e,t=this.zpp_inner.vertices;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,e=this.zpp_inner.vertices=null;else{var n=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,e=n}this.zpp_inner.vertices=e;var i=t;i.free(),i.next=Wp.zpp_pool,Wp.zpp_pool=i}return this},copy:function(){var e=__.get(),t=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i,a=Wp.get(r.x,r.y);if(null==e.zpp_inner.vertices?e.zpp_inner.vertices=a.prev=a.next=a:(a.prev=e.zpp_inner.vertices,a.next=e.zpp_inner.vertices.next,e.zpp_inner.vertices.next.prev=a,e.zpp_inner.vertices.next=a),e.zpp_inner.vertices=a,(i=i.next)==n)break}return e.skipForward(1)},dispose:function(){this.clear(),this.zpp_pool=mc.poolGeomPoly,mc.poolGeomPoly=this},toString:function(){var e="GeomPoly[",t=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(r!=this.zpp_inner.vertices&&(e+=","),e+="{"+r.x+","+r.y+"}",(i=i.next)==n)break}return e+"]"},area:function(){if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return 0;var e=0,t=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(e+=r.x*(r.next.y-r.prev.y),(i=i.next)==n)break}var a=.5*e;return a<0?-a:a},winding:function(){if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return k_.get_UNDEFINED();var e=0,t=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(e+=r.x*(r.next.y-r.prev.y),(i=i.next)==n)break}var a=.5*e;return 0<a?k_.get_CLOCKWISE():0==a?k_.get_UNDEFINED():k_.get_ANTICLOCKWISE()},contains:function(e){var t=e.get_x(),n=e.get_y(),i=!1,r=this.zpp_inner.vertices,a=this.zpp_inner.vertices;if(null!=r)for(var s=r;;){var l=s,o=l.prev;if((l.y<n&&o.y>=n||o.y<n&&l.y>=n)&&(l.x<=t||o.x<=t)&&l.x+(n-l.y)/(o.y-l.y)*(o.x-l.x)<t&&(i=!i),(s=s.next)==a)break}var _=i;return e.zpp_inner.weak&&e.dispose(),_},isClockwise:function(){return this.winding()==k_.get_CLOCKWISE()},isConvex:function(){if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return!0;var e=!1,t=!1,n=!0,i=this.zpp_inner.vertices,r=this.zpp_inner.vertices;if(null!=i)for(var a=i;;){var s,l,o,_=a,p=_.prev,u=_.next;s=u.x-_.x,l=u.y-_.y,o=_.x-p.x;var h=(_.y-p.y)*s-o*l;if(0<h?t=!0:h<0&&(e=!0),t&&e){n=!1;break}if((a=a.next)==r)break}return n},isSimple:function(){return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next||ou.isSimple(this.zpp_inner.vertices)},isMonotone:function(){return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next||eu.isMonotone(this.zpp_inner.vertices)},isDegenerate:function(){return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next||this.area()<co.epsilon},simplify:function(e){if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return this.copy();var t=uu.simplify(this.zpp_inner.vertices,e),n=__.get();return n.zpp_inner.vertices=t,n},simpleDecomposition:function(e){for(var t=ou.decompose(this.zpp_inner.vertices,nu.getShared()),n=null==e?new u_:e;!t.empty();){var i=t.pop_unsafe(),r=__.get();r.zpp_inner.vertices=i,n.add(r)}return n},monotoneDecomposition:function(e){for(var t=eu.decompose(this.zpp_inner.vertices,eu.getShared()).extract(nu.getShared()),n=null==e?new u_:e;!t.empty();){var i=t.pop_unsafe(),r=__.get();r.zpp_inner.vertices=i,n.add(r)}return n},convexDecomposition:function(e,t){null==e&&(e=!1);for(var n=eu.decompose(this.zpp_inner.vertices,eu.getShared()).extract_partitions(nu.getSharedPP()),i=null==t?new u_:t;!n.empty();){var r=n.pop_unsafe();mu.triangulate(r),e&&mu.optimise(r),Rp.optimise(r);var a=r.extract(nu.getShared()),s=r;for(s.free(),s.next=nu.zpp_pool,nu.zpp_pool=s;!a.empty();){var l=a.pop_unsafe(),o=__.get();o.zpp_inner.vertices=l,i.add(o)}}return i},triangularDecomposition:function(e,t){null==e&&(e=!1);for(var n=eu.decompose(this.zpp_inner.vertices,eu.getShared()).extract_partitions(nu.getSharedPP()),i=null==t?new u_:t;!n.empty();){var r=n.pop_unsafe();mu.triangulate(r),e&&mu.optimise(r);var a=r.extract(nu.getShared()),s=r;for(s.free(),s.next=nu.zpp_pool,nu.zpp_pool=s;!a.empty();){var l=a.pop_unsafe(),o=__.get();o.zpp_inner.vertices=l,i.add(o)}}return i},inflate:function(e){var t=__.get();this.isClockwise()&&(e=-e);var n=this.zpp_inner.vertices,i=this.zpp_inner.vertices;if(null!=n)for(var r=n;;){var a,s,l,o,_=r,p=_.prev,u=_.next;a=_.x-p.x,s=_.y-p.y,l=u.x-_.x,o=u.y-_.y;var h=0,c=0,d=0,m=0,f=(h=a)*h+(c=s)*c,g=dc.invsqrt(f),v=h*=g;h=-(c*=g),c=v,h*=e,c*=e;var b=(d=l)*d+(m=o)*m,y=dc.invsqrt(b),x=d*=y;d=-(m*=y),m=x;var z=o*((d*=e)-h)-l*((m*=e)-c),w=0==z?0:z/(o*a-l*s),k=0,S=0;if(k=_.x+h,S=_.y+c,k+=a*w,S+=s*w,t.push(y_.get(k,S)),(r=r.next)==i)break}return t.skipForward(1)},cut:function(e,t,n,i,r){null==i&&(i=!1),null==n&&(n=!1);var a=Vp.run(this.zpp_inner.vertices,e,t,n,i,r);return e.zpp_inner.weak&&e.dispose(),t.zpp_inner.weak&&t.dispose(),a},transform:function(e){var t=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i,a=e.get_a()*r.x+e.get_b()*r.y+e.get_tx();if(r.y=e.get_c()*r.x+e.get_d()*r.y+e.get_ty(),r.x=a,(i=i.next)==n)break}return this},bounds:function(){var e=$_.FMAX,t=$_.FMAX,n=-$_.FMAX,i=-$_.FMAX,r=this.zpp_inner.vertices,a=this.zpp_inner.vertices;if(null!=r)for(var s=r;;){var l=s;if(l.x<e&&(e=l.x),l.y<t&&(t=l.y),l.x>n&&(n=l.x),l.y>i&&(i=l.y),(s=s.next)==a)break}return new r_(e,t,n-e,i-t)},top:function(){var e=this.zpp_inner.vertices,t=this.zpp_inner.vertices.next,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(r.y<e.y&&(e=r),(i=i.next)==n)break}return e.wrapper()},bottom:function(){var e=this.zpp_inner.vertices,t=this.zpp_inner.vertices.next,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(r.y>e.y&&(e=r),(i=i.next)==n)break}return e.wrapper()},left:function(){var e=this.zpp_inner.vertices,t=this.zpp_inner.vertices.next,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(r.x<e.x&&(e=r),(i=i.next)==n)break}return e.wrapper()},right:function(){var e=this.zpp_inner.vertices,t=this.zpp_inner.vertices.next,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(r.x>e.x&&(e=r),(i=i.next)==n)break}return e.wrapper()},__class__:__};var p_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.geom.GeomPolyIterator"]=p_).__name__=["nape","geom","GeomPolyIterator"],p_.get=function(e){var t;if(null==p_.zpp_pool){sc.internal=!0;var n=new p_;sc.internal=!1,t=n}else{var i=p_.zpp_pool;p_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},p_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=p_.zpp_pool,(p_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p_};var u_=function(){this.zpp_inner=null,this.zpp_inner=new sc,this.zpp_inner.outer=this};(n["nape.geom.GeomPolyList"]=u_).__name__=["nape","geom","GeomPolyList"],u_.fromArray=function(e){for(var t=new u_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},u_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),p_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new u_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=p_.zpp_pool,(p_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:u_,__properties__:{get_length:"get_length"}};var h_=function(){};(n["nape.geom.GeomVertexIterator"]=h_).__name__=["nape","geom","GeomVertexIterator"],h_.prototype={zpp_inner:null,hasNext:function(){var e=this.zpp_inner.ptr!=this.zpp_inner.start||this.zpp_inner.first;if(this.zpp_inner.first=!1,!e){var t=this.zpp_inner;t.free(),t.next=Hp.zpp_pool,Hp.zpp_pool=t}return e},next:function(){var e=this.zpp_inner.ptr.wrapper();return this.zpp_inner.ptr=this.zpp_inner.forward?this.zpp_inner.ptr.next:this.zpp_inner.ptr.prev,e},__class__:h_};var c_=function(){};(n["nape.geom.MarchingSquares"]=c_).__name__=["nape","geom","MarchingSquares"],c_.run=function(e,t,n,i,r,a,s){null==a&&(a=!0),null==i&&(i=2);var l=null!=s?s:new u_;if(null==r)Kp.run(e,t.get_x(),t.get_y(),t.get_max().get_x(),t.get_max().get_y(),n,i,a,l);else{var o=t.get_width()/r.get_x(),_=t.get_height()/r.get_y(),u=p.int(o),h=p.int(_);u!=o&&++u,h!=_&&++h;for(var c=0,d=u;c<d;)for(var m=c++,f=t.get_x()+r.get_x()*m,g=m==u-1?t.get_max().get_x():f+r.get_x(),v=0,b=h;v<b;){var y=v++,x=t.get_y()+r.get_y()*y,z=y==h-1?t.get_max().get_y():x+r.get_y();Kp.run(e,f,x,g,z,n,i,a,l)}}return n.zpp_inner.weak&&n.dispose(),null!=r&&r.zpp_inner.weak&&r.dispose(),l};var d_=function(e,t,n,i,r,a){null==a&&(a=0),null==r&&(r=0),null==i&&(i=1),null==n&&(n=0),null==t&&(t=0),null==e&&(e=1),this.zpp_inner=null,this.zpp_inner=Qp.get(),(this.zpp_inner.outer=this).set_a(e),this.set_b(t),this.set_tx(r),this.set_c(n),this.set_d(i),this.set_ty(a)};(n["nape.geom.Mat23"]=d_).__name__=["nape","geom","Mat23"],d_.rotation=function(e){var t=Math.cos(e),n=Math.sin(e);return new d_(t,-n,n,t,0,0)},d_.translation=function(e,t){return new d_(1,0,0,1,e,t)},d_.scale=function(e,t){return new d_(e,0,0,t,0,0)},d_.prototype={zpp_inner:null,get_a:function(){return this.zpp_inner.a},set_a:function(e){return this.zpp_inner.a=e,this.zpp_inner.invalidate(),this.get_a()},get_b:function(){return this.zpp_inner.b},set_b:function(e){return this.zpp_inner.b=e,this.zpp_inner.invalidate(),this.get_b()},get_c:function(){return this.zpp_inner.c},set_c:function(e){return this.zpp_inner.c=e,this.zpp_inner.invalidate(),this.get_c()},get_d:function(){return this.zpp_inner.d},set_d:function(e){return this.zpp_inner.d=e,this.zpp_inner.invalidate(),this.get_d()},get_tx:function(){return this.zpp_inner.tx},set_tx:function(e){return this.zpp_inner.tx=e,this.zpp_inner.invalidate(),this.get_tx()},get_ty:function(){return this.zpp_inner.ty},set_ty:function(e){return this.zpp_inner.ty=e,this.zpp_inner.invalidate(),this.get_ty()},copy:function(){return new d_(this.get_a(),this.get_b(),this.get_c(),this.get_d(),this.get_tx(),this.get_ty())},set:function(e){return this.zpp_inner.set(e.zpp_inner),this.zpp_inner.invalidate(),this},setAs:function(e,t,n,i,r,a){return null==a&&(a=0),null==r&&(r=0),null==i&&(i=1),null==n&&(n=0),null==t&&(t=0),null==e&&(e=1),this.zpp_inner.setas(e,t,n,i,r,a),this.zpp_inner.invalidate(),this},reset:function(){return this.setAs()},get_determinant:function(){return this.get_a()*this.get_d()-this.get_b()*this.get_c()},singular:function(){var e=this.get_a()*this.get_a()+this.get_b()*this.get_b()+this.get_c()*this.get_c()+this.get_d()*this.get_d(),t=this.get_determinant();return t<0&&(t=-t),co.illConditionedThreshold*t<e},inverse:function(){var e=1/this.get_determinant();return new d_(this.get_d()*e,-this.get_b()*e,-this.get_c()*e,this.get_a()*e,(this.get_b()*this.get_ty()-this.get_d()*this.get_tx())*e,(this.get_c()*this.get_tx()-this.get_a()*this.get_ty())*e)},transpose:function(){return new d_(this.get_a(),this.get_c(),this.get_b(),this.get_d(),-this.get_a()*this.get_tx()-this.get_c()*this.get_ty(),-this.get_b()*this.get_tx()-this.get_d()*this.get_ty())},concat:function(e){var t=e;return new d_(t.get_a()*this.get_a()+t.get_b()*this.get_c(),t.get_a()*this.get_b()+t.get_b()*this.get_d(),t.get_c()*this.get_a()+t.get_d()*this.get_c(),t.get_c()*this.get_b()+t.get_d()*this.get_d(),t.get_a()*this.get_tx()+t.get_b()*this.get_ty()+t.get_tx(),t.get_c()*this.get_tx()+t.get_d()*this.get_ty()+t.get_ty())},transform:function(e,t,n){var i;return null==n&&(n=!1),null==t&&(t=!1),i=t?y_.get(e.get_x()*this.get_a()+e.get_y()*this.get_b(),e.get_x()*this.get_c()+e.get_y()*this.get_d(),n):y_.get(e.get_x()*this.get_a()+e.get_y()*this.get_b()+this.get_tx(),e.get_x()*this.get_c()+e.get_y()*this.get_d()+this.get_ty(),n),e.zpp_inner.weak&&e.dispose(),i},inverseTransform:function(e,t,n){null==n&&(n=!1),null==t&&(t=!1);var i,r=1/this.get_determinant();if(t)i=y_.get((e.get_x()*this.get_d()-e.get_y()*this.get_b())*r,(e.get_y()*this.get_a()-e.get_x()*this.get_c())*r,n);else{var a=e.get_x()-this.get_tx(),s=e.get_y()-this.get_ty();i=y_.get((a*this.get_d()-s*this.get_b())*r,(s*this.get_a()-a*this.get_c())*r,n)}return e.zpp_inner.weak&&e.dispose(),i},toString:function(){return"{ a: "+this.get_a()+" b: "+this.get_b()+" c: "+this.get_c()+" d: "+this.get_d()+" tx: "+this.get_tx()+" ty: "+this.get_ty()+" }"},equiorthogonal:function(){if(this.singular())return!1;var e=this.get_a()*this.get_b()+this.get_c()*this.get_d();if(e*e<co.epsilon){var t=this.get_a()*this.get_a()+this.get_b()*this.get_b()-this.get_c()*this.get_c()-this.get_d()*this.get_d();return t*t<co.epsilon}return!1},orthogonal:function(){var e=this.get_a()*this.get_b()+this.get_c()*this.get_d();if(e*e<co.epsilon){var t=this.get_a()*this.get_a()+this.get_b()*this.get_b()-1,n=this.get_c()*this.get_c()+this.get_d()*this.get_d()-1;return t*t<co.epsilon&&n*n<co.epsilon}return!1},equiorthogonalise:function(){if(!this.equiorthogonal()){var e=Math.sqrt(this.get_a()*this.get_a()+this.get_c()*this.get_c()),t=Math.sqrt(this.get_b()*this.get_b()+this.get_d()*this.get_d()),n=(e+t)/2;e=n/e,t=n/t,this.set_a(this.get_a()*e),this.set_c(this.get_c()*e),this.set_b(this.get_b()*t),this.set_d(this.get_d()*t);var i=this.get_a()*this.get_b()+this.get_c()*this.get_d(),r=.25*Math.PI-.5*Math.acos(i/(n*n));0<this.get_determinant()&&(r=-r);var a=Math.sin(r),s=Math.cos(r),l=this.get_a()*s-this.get_c()*a,o=this.get_b()*s+this.get_d()*a;this.set_c(this.get_c()*s+this.get_a()*a),this.set_a(l),this.set_d(this.get_d()*s-this.get_b()*a),this.set_b(o),this.zpp_inner.invalidate()}return this},orthogonalise:function(){if(!this.orthogonal()){var e=Math.sqrt(this.get_a()*this.get_a()+this.get_c()*this.get_c()),t=Math.sqrt(this.get_b()*this.get_b()+this.get_d()*this.get_d());e=1/e,t=1/t,this.set_a(this.get_a()*e),this.set_c(this.get_c()*e),this.set_b(this.get_b()*t),this.set_d(this.get_d()*t);var n=this.get_a()*this.get_b()+this.get_c()*this.get_d(),i=.25*Math.PI-.5*Math.acos(n/1);0<this.get_determinant()&&(i=-i);var r=Math.sin(i),a=Math.cos(i),s=this.get_a()*a-this.get_c()*r,l=this.get_b()*a+this.get_d()*r;this.set_c(this.get_c()*a+this.get_a()*r),this.set_a(s),this.set_d(this.get_d()*a-this.get_b()*r),this.set_b(l),this.zpp_inner.invalidate()}return this},__class__:d_,__properties__:{get_determinant:"get_determinant",set_ty:"set_ty",get_ty:"get_ty",set_tx:"set_tx",get_tx:"get_tx",set_d:"set_d",get_d:"get_d",set_c:"set_c",get_c:"get_c",set_b:"set_b",get_b:"get_b",set_a:"set_a",get_a:"get_a"}};var m_=function(e,t){this.zpp_inner=null,this.zpp_inner=new $p(e,t),this.zpp_inner.outer=this};(n["nape.geom.MatMN"]=m_).__name__=["nape","geom","MatMN"],m_.prototype={zpp_inner:null,get_rows:function(){return this.zpp_inner.m},get_cols:function(){return this.zpp_inner.n},x:function(e,t){return this.zpp_inner.x[e*this.get_cols()+t]},setx:function(e,t,n){return this.zpp_inner.x[e*this.get_cols()+t]=n},toString:function(){for(var e="{ ",t=!0,n=0,i=this.get_rows();n<i;){var r=n++;t||(e+="; "),t=!1;for(var a=0,s=this.get_cols();a<s;){var l=a++;e+=this.x(r,l)+" "}}return e+"}"},transpose:function(){for(var e=new m_(this.get_cols(),this.get_rows()),t=0,n=this.get_rows();t<n;)for(var i=t++,r=0,a=this.get_cols();r<a;){var s=r++;e.setx(s,i,this.x(i,s))}return e},mul:function(e){for(var t=e,n=new m_(this.get_rows(),t.get_cols()),i=0,r=this.get_rows();i<r;)for(var a=i++,s=0,l=t.get_cols();s<l;){for(var o=s++,_=0,p=0,u=this.get_cols();p<u;){var h=p++;_+=this.x(a,h)*t.x(h,o)}n.setx(a,o,_)}return n},__class__:m_,__properties__:{get_cols:"get_cols",get_rows:"get_rows"}};var f_=function(e,t){this.zpp_inner=null,this.zpp_inner=new iu,this.set_origin(e),this.set_direction(t),this.zpp_inner.maxdist=$_.POSINF()};(n["nape.geom.Ray"]=f_).__name__=["nape","geom","Ray"],f_.fromSegment=function(e,t){var n=t.sub(e,!0),i=new f_(e,n);return i.set_maxDistance(Math.sqrt(vu.vec_dsq(e.get_x(),e.get_y(),t.get_x(),t.get_y()))),e.zpp_inner.weak&&e.dispose(),t.zpp_inner.weak&&t.dispose(),i},f_.prototype={zpp_inner:null,get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_origin:function(){return this.zpp_inner.origin},set_origin:function(e){return this.zpp_inner.origin.set(e),this.get_origin()},get_direction:function(){return this.zpp_inner.direction},set_direction:function(e){return this.zpp_inner.direction.set(e),this.zpp_inner.invalidate_dir(),this.get_direction()},get_maxDistance:function(){return this.zpp_inner.maxdist},set_maxDistance:function(e){return this.zpp_inner.maxdist=e,this.get_maxDistance()},aabb:function(){return this.zpp_inner.rayAABB().wrapper()},at:function(e,t){return null==t&&(t=!1),this.zpp_inner.validate_dir(),y_.get(this.get_origin().get_x()+e*this.zpp_inner.dirx,this.get_origin().get_y()+e*this.zpp_inner.diry,t)},copy:function(){var e=new f_(this.get_origin(),this.get_direction());return e.set_maxDistance(this.get_maxDistance()),e},__class__:f_,__properties__:{set_maxDistance:"set_maxDistance",get_maxDistance:"get_maxDistance",set_direction:"set_direction",get_direction:"get_direction",set_origin:"set_origin",get_origin:"get_origin",get_userData:"get_userData"}};var g_=function(){this.zpp_inner=null};(n["nape.geom.RayResult"]=g_).__name__=["nape","geom","RayResult"],g_.prototype={zpp_inner:null,get_normal:function(){return this.zpp_inner.normal},get_distance:function(){return this.zpp_inner.toiDistance},get_inner:function(){return this.zpp_inner.inner},get_shape:function(){return this.zpp_inner.shape},dispose:function(){this.zpp_inner.free()},toString:function(){return"{ shape: "+p.string(this.get_shape())+" distance: "+this.get_distance()+" ?inner: "+p.string(this.get_inner())+" }"},__class__:g_,__properties__:{get_shape:"get_shape",get_inner:"get_inner",get_distance:"get_distance",get_normal:"get_normal"}};var v_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.geom.RayResultIterator"]=v_).__name__=["nape","geom","RayResultIterator"],v_.get=function(e){var t;if(null==v_.zpp_pool){lc.internal=!0;var n=new v_;lc.internal=!1,t=n}else{var i=v_.zpp_pool;v_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},v_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=v_.zpp_pool,(v_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:v_};var b_=function(){this.zpp_inner=null,this.zpp_inner=new lc,this.zpp_inner.outer=this};(n["nape.geom.RayResultList"]=b_).__name__=["nape","geom","RayResultList"],b_.fromArray=function(e){for(var t=new b_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},b_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem()},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e)}else this.zpp_inner.inner.add(e);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=e=this.zpp_inner.inner.front();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=e=null==n?this.zpp_inner.inner.front():n.next.elem();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=e=null==t?this.zpp_inner.inner.front():t.next.elem();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=e=this.zpp_inner.inner.front();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),v_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new b_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=v_.zpp_pool,(v_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:b_,__properties__:{get_length:"get_length"}};var y_=function(e,t){null==t&&(t=0),null==e&&(e=0),this.zpp_pool=null,this.zpp_inner=null,this.zpp_inner=fu.get(e,t),this.zpp_inner.outer=this};(n["nape.geom.Vec2"]=y_).__name__=["nape","geom","Vec2"],y_.weak=function(e,t){return null==t&&(t=0),null==e&&(e=0),y_.get(e,t,!0)},y_.get=function(e,t,n){var i;return null==n&&(n=!1),null==t&&(t=0),null==e&&(e=0),null==mc.poolVec2?i=new y_:(i=mc.poolVec2,mc.poolVec2=i.zpp_pool,i.zpp_pool=null),null==i.zpp_inner?(i.zpp_inner=fu.get(e,t),i.zpp_inner.outer=i):i.setxy(e,t),i.zpp_inner.weak=n,i},y_.fromPolar=function(e,t,n){return null==n&&(n=!1),y_.get(e*Math.cos(t),e*Math.sin(t),n)},y_.dsq=function(e,t){var n=vu.vec_dsq(e.get_x(),e.get_y(),t.get_x(),t.get_y());return e.zpp_inner.weak&&e.dispose(),t.zpp_inner.weak&&t.dispose(),n},y_.distance=function(e,t){var n=Math.sqrt(vu.vec_dsq(e.get_x(),e.get_y(),t.get_x(),t.get_y()));return e.zpp_inner.weak&&e.dispose(),t.zpp_inner.weak&&t.dispose(),n},y_.prototype={zpp_inner:null,zpp_pool:null,dispose:function(){this.zpp_inner.immutable();var e=this.zpp_inner;this.zpp_inner.outer=null,this.zpp_inner=null,this.zpp_pool=mc.poolVec2,mc.poolVec2=this;var t=e;t.free(),t.next=fu.zpp_pool,fu.zpp_pool=t},copy:function(e){return null==e&&(e=!1),y_.get(this.get_x(),this.get_y(),e)},get_x:function(){return this.zpp_inner.validate(),this.zpp_inner.x},set_x:function(e){return this.zpp_inner.immutable(),this.get_x()!=e&&(this.zpp_inner.x=e,this.zpp_inner.invalidate()),this.get_x()},get_y:function(){return this.zpp_inner.validate(),this.zpp_inner.y},set_y:function(e){return this.zpp_inner.immutable(),this.get_y()!=e&&(this.zpp_inner.y=e,this.zpp_inner.invalidate()),this.get_y()},get_length:function(){return Math.sqrt(this.get_x()*this.get_x()+this.get_y()*this.get_y())},set_length:function(e){this.zpp_inner.immutable();var t=e/Math.sqrt(this.get_x()*this.get_x()+this.get_y()*this.get_y());return this.set_x(this.get_x()*t),this.set_y(this.get_y()*t),this.zpp_inner.invalidate(),this.get_length()},lsq:function(){return this.get_x()*this.get_x()+this.get_y()*this.get_y()},set:function(e){this.zpp_inner.immutable();var t=this.setxy(e.get_x(),e.get_y());return e.zpp_inner.weak&&e.dispose(),t},setxy:function(e,t){return this.zpp_inner.immutable(),this.get_x()==e&&this.get_y()==t||(this.zpp_inner.x=e,this.zpp_inner.y=t,this.zpp_inner.invalidate()),this},get_angle:function(){return this.get_x()==this.get_y()&&0==this.get_x()?0:Math.atan2(this.get_y(),this.get_x())},set_angle:function(e){this.zpp_inner.immutable();var t=this.get_length();return this.setxy(t*Math.cos(e),t*Math.sin(e)),this.get_angle()},rotate:function(e){if(this.zpp_inner.immutable(),e%(2*Math.PI)!=0){var t=Math.sin(e),n=Math.cos(e),i=n*this.zpp_inner.x-t*this.zpp_inner.y;this.zpp_inner.y=this.zpp_inner.x*t+this.zpp_inner.y*n,this.zpp_inner.x=i,this.zpp_inner.invalidate()}return this},reflect:function(e,t){null==t&&(t=!1);var n=this.copy(!0).normalise(),i=e.sub(n.muleq(2*n.dot(e)),t);return e.zpp_inner.weak&&e.dispose(),i},normalise:function(){this.zpp_inner.immutable();var e=this.get_x()*this.get_x()+this.get_y()*this.get_y(),t=1/Math.sqrt(e);return this.set_x(this.get_x()*t),this.set_y(this.get_y()*t),this.zpp_inner.invalidate(),this},unit:function(e){null==e&&(e=!1);var t=1/dc.sqrt(this.get_x()*this.get_x()+this.get_y()*this.get_y());return y_.get(this.get_x()*t,this.get_y()*t,e)},add:function(e,t){null==t&&(t=!1);var n=y_.get(this.get_x()+e.get_x(),this.get_y()+e.get_y(),t);return e.zpp_inner.weak&&e.dispose(),n},addMul:function(e,t,n){null==n&&(n=!1);var i=y_.get(this.get_x()+e.get_x()*t,this.get_y()+e.get_y()*t,n);return e.zpp_inner.weak&&e.dispose(),i},sub:function(e,t){null==t&&(t=!1);var n=y_.get(this.get_x()-e.get_x(),this.get_y()-e.get_y(),t);return e.zpp_inner.weak&&e.dispose(),n},mul:function(e,t){return null==t&&(t=!1),y_.get(this.get_x()*e,this.get_y()*e,t)},addeq:function(e){return this.zpp_inner.immutable(),this.setxy(this.get_x()+e.get_x(),this.get_y()+e.get_y()),e.zpp_inner.weak&&e.dispose(),this},subeq:function(e){return this.zpp_inner.immutable(),this.setxy(this.get_x()-e.get_x(),this.get_y()-e.get_y()),e.zpp_inner.weak&&e.dispose(),this},muleq:function(e){return this.zpp_inner.immutable(),this.setxy(this.get_x()*e,this.get_y()*e)},dot:function(e){var t=this.get_x()*e.get_x()+this.get_y()*e.get_y();return e.zpp_inner.weak&&e.dispose(),t},cross:function(e){var t=e.get_y()*this.get_x()-e.get_x()*this.get_y();return e.zpp_inner.weak&&e.dispose(),t},perp:function(e){return null==e&&(e=!1),y_.get(-this.get_y(),this.get_x(),e)},toString:function(){return this.zpp_inner.validate(),this.zpp_inner.toString()},__class__:y_,__properties__:{set_angle:"set_angle",get_angle:"get_angle",set_length:"set_length",get_length:"get_length",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"}};var x_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.geom.Vec2Iterator"]=x_).__name__=["nape","geom","Vec2Iterator"],x_.get=function(e){var t;if(null==x_.zpp_pool){ac.internal=!0;var n=new x_;ac.internal=!1,t=n}else{var i=x_.zpp_pool;x_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},x_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=x_.zpp_pool,(x_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:x_};var z_=function(){this.zpp_inner=null,this.zpp_inner=new ac,this.zpp_inner.outer=this};(n["nape.geom.Vec2List"]=z_).__name__=["nape","geom","Vec2List"],z_.fromArray=function(e){for(var t=new z_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},z_.prototype={zpp_inner:null,get_length:function(){return this.zpp_gl()},zpp_gl:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},has:function(e){return this.zpp_vm(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_vm(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().wrapper()},push:function(e){this.zpp_inner.modify_test(),this.zpp_vm();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_vm();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_vm();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.wrapper()},shift:function(){this.zpp_inner.modify_test(),this.zpp_vm();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.wrapper()},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_vm(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return 0==this.get_length()},iterator:function(){return this.zpp_vm(),x_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new z_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?i.copy():i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=x_.zpp_pool,(x_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:z_,__properties__:{get_length:"get_length"}};var w_=function(e,t,n){null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.zpp_pool=null,this.zpp_inner=null,this.zpp_inner=new gu,(this.zpp_inner.outer=this).set_x(e),this.set_y(t),this.set_z(n)};(n["nape.geom.Vec3"]=w_).__name__=["nape","geom","Vec3"],w_.get=function(e,t,n){var i;return null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),null==mc.poolVec3?i=new w_:(i=mc.poolVec3,mc.poolVec3=i.zpp_pool,i.zpp_pool=null),i.setxyz(e,t,n),i.zpp_inner.immutable=!1,i.zpp_inner._validate=null,i},w_.prototype={zpp_inner:null,zpp_pool:null,get_x:function(){return this.zpp_inner.validate(),this.zpp_inner.x},set_x:function(e){return this.zpp_inner.x=e,this.get_x()},get_y:function(){return this.zpp_inner.validate(),this.zpp_inner.y},set_y:function(e){return this.zpp_inner.y=e,this.get_y()},get_z:function(){return this.zpp_inner.validate(),this.zpp_inner.z},set_z:function(e){return this.zpp_inner.z=e,this.get_z()},dispose:function(){this.zpp_pool=mc.poolVec3,mc.poolVec3=this},get_length:function(){return Math.sqrt(this.get_x()*this.get_x()+this.get_y()*this.get_y()+this.get_z()*this.get_z())},set_length:function(e){var t=e/this.get_length(),n=t;return this.set_x(this.get_x()*n),this.set_y(this.get_y()*n),this.set_z(this.get_z()*t),this.get_length()},lsq:function(){return this.get_x()*this.get_x()+this.get_y()*this.get_y()+this.get_z()*this.get_z()},set:function(e){return this.setxyz(e.get_x(),e.get_y(),e.get_z())},setxyz:function(e,t,n){return this.set_x(e),this.set_y(t),this.set_z(n),this},xy:function(e){return null==e&&(e=!1),y_.get(this.get_x(),this.get_y(),e)},toString:function(){return"{ x: "+this.get_x()+" y: "+this.get_y()+" z: "+this.get_z()+" }"},__class__:w_,__properties__:{set_length:"set_length",get_length:"get_length",set_z:"set_z",get_z:"get_z",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"}};var k_=function(){};(n["nape.geom.Winding"]=k_).__name__=["nape","geom","Winding"],k_.__properties__={get_ANTICLOCKWISE:"get_ANTICLOCKWISE",get_CLOCKWISE:"get_CLOCKWISE",get_UNDEFINED:"get_UNDEFINED"},k_.get_UNDEFINED=function(){return null==up.Winding_UNDEFINED&&(up.internal=!0,up.Winding_UNDEFINED=new k_,up.internal=!1),up.Winding_UNDEFINED},k_.get_CLOCKWISE=function(){return null==up.Winding_CLOCKWISE&&(up.internal=!0,up.Winding_CLOCKWISE=new k_,up.internal=!1),up.Winding_CLOCKWISE},k_.get_ANTICLOCKWISE=function(){return null==up.Winding_ANTICLOCKWISE&&(up.internal=!0,up.Winding_ANTICLOCKWISE=new k_,up.internal=!1),up.Winding_ANTICLOCKWISE},k_.prototype={toString:function(){return this==k_.get_UNDEFINED()?"UNDEFINED":this==k_.get_CLOCKWISE()?"CLOCKWISE":this==k_.get_ANTICLOCKWISE()?"ANTICLOCKWISE":""},__class__:k_};var S_=function(){this.zpp_inner_i=null};(n["nape.phys.Interactor"]=S_).__name__=["nape","phys","Interactor"],S_.prototype={zpp_inner_i:null,get_id:function(){return this.zpp_inner_i.id},get_userData:function(){return null==this.zpp_inner_i.userData&&(this.zpp_inner_i.userData={}),this.zpp_inner_i.userData},isShape:function(){return null!=this.zpp_inner_i.ishape},isBody:function(){return null!=this.zpp_inner_i.ibody},isCompound:function(){return null!=this.zpp_inner_i.icompound},get_castShape:function(){return this.isShape()?this.zpp_inner_i.ishape.outer:null},get_castBody:function(){return this.isBody()?this.zpp_inner_i.ibody.outer:null},get_castCompound:function(){return this.isCompound()?this.zpp_inner_i.icompound.outer:null},get_group:function(){return null==this.zpp_inner_i.group?null:this.zpp_inner_i.group.outer},set_group:function(e){return this.zpp_inner_i.immutable_midstep("Interactor::group"),this.zpp_inner_i.setGroup(null==e?null:e.zpp_inner),this.get_group()},get_cbTypes:function(){return null==this.zpp_inner_i.wrap_cbTypes&&this.zpp_inner_i.setupcbTypes(),this.zpp_inner_i.wrap_cbTypes},toString:function(){return""},__class__:S_,__properties__:{get_cbTypes:"get_cbTypes",set_group:"set_group",get_group:"get_group",get_castCompound:"get_castCompound",get_castBody:"get_castBody",get_castShape:"get_castShape",get_userData:"get_userData",get_id:"get_id"}};var C_=function(e,t){this.debugDraw=!0,this.zpp_inner=null,S_.call(this),this.zpp_inner=new yu,((this.zpp_inner.outer=this).zpp_inner.outer_i=this).zpp_inner_i=this.zpp_inner,this.zpp_inner.posy=null!=t?(this.zpp_inner.posx=t.get_x(),t.get_y()):this.zpp_inner.posx=0,this.set_type(null==e?M_.get_DYNAMIC():e),null!=t&&t.zpp_inner.weak&&t.dispose(),this.zpp_inner_i.insert_cbtype(yo.get_ANY_BODY().zpp_inner)};(n["nape.phys.Body"]=C_).__name__=["nape","phys","Body"],C_.__super__=S_,C_.prototype=r(S_.prototype,{zpp_inner:null,debugDraw:null,get_type:function(){return yu.types[this.zpp_inner.type]},set_type:function(e){if(this.zpp_inner.immutable_midstep("Body::type"),this.get_type()!=e){var t=e==M_.get_DYNAMIC()?2:e==M_.get_KINEMATIC()?3:1;1==t&&null!=this.zpp_inner.space&&(this.zpp_inner.velx=0,this.zpp_inner.vely=0,this.zpp_inner.angvel=0),this.zpp_inner.invalidate_type(),null!=this.zpp_inner.space?this.zpp_inner.space.transmitType(this.zpp_inner,t):this.zpp_inner.type=t}return this.get_type()},get_isBullet:function(){return this.zpp_inner.bulletEnabled},set_isBullet:function(e){return this.zpp_inner.bulletEnabled=e,this.get_isBullet()},get_disableCCD:function(){return this.zpp_inner.disableCCD},set_disableCCD:function(e){return this.zpp_inner.disableCCD=e,this.get_disableCCD()},integrate:function(e){if(this.zpp_inner.immutable_midstep("Body::space"),0==e)return this;var t=this.zpp_inner;return t.sweepTime=0,t.sweep_angvel=t.angvel,t.sweepIntegrate(e),t.invalidate_pos(),t.invalidate_rot(),t.sweepTime=0,this},isStatic:function(){return this.zpp_inner.isStatic()},isDynamic:function(){return this.zpp_inner.isDynamic()},isKinematic:function(){return this.zpp_inner.isKinematic()},get_shapes:function(){return this.zpp_inner.wrap_shapes},get_compound:function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_compound:function(e){return this.get_compound()!=e&&(null!=this.get_compound()&&this.get_compound().get_bodies().remove(this),null!=e&&e.get_bodies().add(this)),this.get_compound()},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(e){return this.zpp_inner.immutable_midstep("Body::space"),this.get_space()!=e&&(null!=this.get_space()&&(this.zpp_inner.component.woken=!1),null!=this.get_space()&&this.get_space().get_bodies().remove(this),null!=e&&e.get_bodies().add(this)),this.get_space()},get_arbiters:function(){return null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=hc.get(this.zpp_inner.arbiters,!0)),this.zpp_inner.wrap_arbiters},get_isSleeping:function(){return this.zpp_inner.component.sleeping},get_constraints:function(){return null==this.zpp_inner.wrap_constraints&&(this.zpp_inner.wrap_constraints=$h.get(this.zpp_inner.constraints,!0)),this.zpp_inner.wrap_constraints},copy:function(){return this.zpp_inner.copy()},get_position:function(){return null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition(),this.zpp_inner.wrap_pos},set_position:function(e){return this.get_position().set(e),this.get_position()},get_velocity:function(){return null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity(),this.zpp_inner.wrap_vel},set_velocity:function(e){return this.get_velocity().set(e),this.get_velocity()},setVelocityFromTarget:function(e,t,n){var i=1/n;return this.get_velocity().set(e.sub(this.get_position(),!0).muleq(i)),this.set_angularVel((t-this.get_rotation())*i),e.zpp_inner.weak&&e.dispose(),this},get_kinematicVel:function(){return null==this.zpp_inner.wrap_kinvel&&this.zpp_inner.setupkinvel(),this.zpp_inner.wrap_kinvel},set_kinematicVel:function(e){return this.get_kinematicVel().set(e),this.get_kinematicVel()},get_surfaceVel:function(){return null==this.zpp_inner.wrap_svel&&this.zpp_inner.setupsvel(),this.zpp_inner.wrap_svel},set_surfaceVel:function(e){return this.get_surfaceVel().set(e),this.get_surfaceVel()},get_force:function(){return null==this.zpp_inner.wrap_force&&this.zpp_inner.setupForce(),this.zpp_inner.wrap_force},set_force:function(e){return this.get_force().set(e),this.get_force()},get_constraintVelocity:function(){return null==this.zpp_inner.wrapcvel&&this.zpp_inner.setup_cvel(),this.zpp_inner.wrapcvel},get_rotation:function(){return this.zpp_inner.rot},set_rotation:function(e){return this.zpp_inner.immutable_midstep("Body::rotation"),this.get_rotation()!=e&&(this.zpp_inner.rot=e,this.zpp_inner.invalidate_rot(),this.zpp_inner.wake()),this.get_rotation()},get_angularVel:function(){return this.zpp_inner.angvel},set_angularVel:function(e){return this.get_angularVel()!=e&&(this.zpp_inner.angvel=e,this.zpp_inner.invalidate_wake()),this.get_angularVel()},get_kinAngVel:function(){return this.zpp_inner.kinangvel},set_kinAngVel:function(e){return this.get_kinAngVel()!=e&&(this.zpp_inner.kinangvel=e,this.zpp_inner.invalidate_wake()),this.get_kinAngVel()},get_torque:function(){return this.zpp_inner.torque},set_torque:function(e){return this.get_torque()!=e&&(this.zpp_inner.torque=e,this.zpp_inner.invalidate_wake()),this.get_torque()},get_bounds:function(){return this.zpp_inner.aabb.wrapper()},get_allowMovement:function(){return!this.zpp_inner.nomove},set_allowMovement:function(e){return this.zpp_inner.immutable_midstep("Body::"+(null==e?"null":""+e)),this.get_allowMovement()!=e&&(this.zpp_inner.nomove=!e,this.zpp_inner.invalidate_mass()),this.get_allowMovement()},get_allowRotation:function(){return!this.zpp_inner.norotate},set_allowRotation:function(e){return this.zpp_inner.immutable_midstep("Body::"+(null==e?"null":""+e)),this.get_allowRotation()!=e&&(this.zpp_inner.norotate=!e,this.zpp_inner.invalidate_inertia()),this.get_allowRotation()},get_massMode:function(){return[j_.get_DEFAULT(),j_.get_FIXED()][this.zpp_inner.massMode]},set_massMode:function(e){this.zpp_inner.immutable_midstep("Body::massMode");var t=e==j_.get_DEFAULT()?0:1;return this.zpp_inner.massMode=t,this.zpp_inner.invalidate_mass(),this.get_massMode()},get_constraintMass:function(){return this.zpp_inner.world||this.zpp_inner.validate_mass(),this.zpp_inner.smass},get_mass:function(){return this.zpp_inner.validate_mass(),this.zpp_inner.cmass},set_mass:function(e){return this.zpp_inner.immutable_midstep("Body::mass"),this.zpp_inner.massMode=1,this.zpp_inner.cmass=e,this.zpp_inner.invalidate_mass(),this.get_mass()},get_gravMassMode:function(){return[E_.get_DEFAULT(),E_.get_FIXED(),E_.get_SCALED()][this.zpp_inner.massMode]},set_gravMassMode:function(e){this.zpp_inner.immutable_midstep("Body::gravMassMode");var t=e==E_.get_SCALED()?2:e==E_.get_DEFAULT()?0:1;return this.zpp_inner.gravMassMode=t,this.zpp_inner.invalidate_gravMass(),this.get_gravMassMode()},get_gravMass:function(){return this.zpp_inner.validate_gravMass(),this.zpp_inner.gravMass},set_gravMass:function(e){return this.zpp_inner.immutable_midstep("Body::gravMass"),this.zpp_inner.gravMassMode=1,this.zpp_inner.gravMass=e,this.zpp_inner.invalidate_gravMass(),this.get_gravMass()},get_gravMassScale:function(){return this.zpp_inner.validate_gravMassScale(),this.zpp_inner.gravMassScale},set_gravMassScale:function(e){return this.zpp_inner.immutable_midstep("Body::gravMassScale"),this.zpp_inner.gravMassMode=2,this.zpp_inner.gravMassScale=e,this.zpp_inner.invalidate_gravMassScale(),this.get_gravMassScale()},get_inertiaMode:function(){return[O_.get_DEFAULT(),O_.get_FIXED()][this.zpp_inner.inertiaMode]},set_inertiaMode:function(e){this.zpp_inner.immutable_midstep("Body::inertiaMode");var t=e==O_.get_FIXED()?1:0;return this.zpp_inner.inertiaMode=t,this.zpp_inner.invalidate_inertia(),this.get_inertiaMode()},get_constraintInertia:function(){return this.zpp_inner.world||this.zpp_inner.validate_inertia(),this.zpp_inner.sinertia},get_inertia:function(){return this.zpp_inner.validate_inertia(),this.zpp_inner.cinertia},set_inertia:function(e){return this.zpp_inner.immutable_midstep("Body::inertia"),this.zpp_inner.inertiaMode=1,this.zpp_inner.cinertia=e,this.zpp_inner.invalidate_inertia(),this.get_inertia()},connectedBodies:function(e,t){return null==e&&(e=-1),this.zpp_inner.connectedBodies(e,t)},interactingBodies:function(e,t,n){null==t&&(t=-1);var i=null==e?Mp.COL|Mp.SENSOR|Mp.FLUID:e==No.get_COLLISION()?Mp.COL:e==No.get_SENSOR()?Mp.SENSOR:Mp.FLUID;return this.zpp_inner.interactingBodies(i,t,n)},crushFactor:function(){for(var e=0,t=y_.get(),n=this.get_arbiters().iterator();n.hasNext();){var i=n.next().totalImpulse(this),r=i.xy();t.addeq(r),e+=r.get_length(),r.dispose(),i.dispose()}for(var a=this.get_constraints().iterator();a.hasNext();){var s=a.next().bodyImpulse(this),l=s.xy();t.addeq(l),e+=l.get_length(),l.dispose(),s.dispose()}var o=(e-t.get_length())/(this.get_mass()*this.get_space().zpp_inner.pre_dt);return t.dispose(),o},localPointToWorld:function(e,t){var n,i;return null==t&&(t=!1),this.zpp_inner.validate_axis(),n=this.zpp_inner.axisy*e.get_x()-this.zpp_inner.axisx*e.get_y(),i=e.get_x()*this.zpp_inner.axisx+e.get_y()*this.zpp_inner.axisy,e.zpp_inner.weak&&e.dispose(),y_.get(n+this.zpp_inner.posx,i+this.zpp_inner.posy,t)},worldPointToLocal:function(e,t){var n,i,r,a;return null==t&&(t=!1),this.zpp_inner.validate_axis(),r=e.get_x()-this.zpp_inner.posx,a=e.get_y()-this.zpp_inner.posy,n=r*this.zpp_inner.axisy+a*this.zpp_inner.axisx,i=a*this.zpp_inner.axisy-r*this.zpp_inner.axisx,e.zpp_inner.weak&&e.dispose(),y_.get(n,i,t)},localVectorToWorld:function(e,t){var n,i;return null==t&&(t=!1),this.zpp_inner.validate_axis(),n=this.zpp_inner.axisy*e.get_x()-this.zpp_inner.axisx*e.get_y(),i=e.get_x()*this.zpp_inner.axisx+e.get_y()*this.zpp_inner.axisy,e.zpp_inner.weak&&e.dispose(),y_.get(n,i,t)},worldVectorToLocal:function(e,t){var n,i;return null==t&&(t=!1),this.zpp_inner.validate_axis(),n=e.get_x()*this.zpp_inner.axisy+e.get_y()*this.zpp_inner.axisx,i=e.get_y()*this.zpp_inner.axisy-e.get_x()*this.zpp_inner.axisx,e.zpp_inner.weak&&e.dispose(),y_.get(n,i,t)},applyImpulse:function(e,t,n){if(null==n&&(n=!1),n&&this.get_isSleeping())return e.zpp_inner.weak&&e.dispose(),null!=t&&t.zpp_inner.weak&&t.dispose(),this;this.zpp_inner.validate_mass();var i,r,a=this.zpp_inner.imass;(this.zpp_inner.velx+=e.get_x()*a,this.zpp_inner.vely+=e.get_y()*a,null!=t)&&(i=t.get_x()-this.zpp_inner.posx,r=t.get_y()-this.zpp_inner.posy,this.zpp_inner.validate_inertia(),this.zpp_inner.angvel+=(e.get_y()*i-e.get_x()*r)*this.zpp_inner.iinertia,t.zpp_inner.weak&&t.dispose());return n||this.isDynamic()&&this.zpp_inner.invalidate_wake(),e.zpp_inner.weak&&e.dispose(),this},applyAngularImpulse:function(e,t){return null==t&&(t=!1),t&&this.get_isSleeping()||(this.zpp_inner.validate_inertia(),this.zpp_inner.angvel+=e*this.zpp_inner.iinertia,t||this.isDynamic()&&this.zpp_inner.invalidate_wake()),this},translateShapes:function(e){this.zpp_inner.immutable_midstep("Body::translateShapes()");var t=e.zpp_inner.weak;e.zpp_inner.weak=!1;for(var n=this.zpp_inner.shapes.begin();null!=n;)n.elem().outer.translate(e),n=n.next;return e.zpp_inner.weak=t,e.zpp_inner.weak&&e.dispose(),this},rotateShapes:function(e){this.zpp_inner.immutable_midstep("Body::rotateShapes()");for(var t=this.zpp_inner.shapes.begin();null!=t;)t.elem().outer.rotate(e),t=t.next;return this},scaleShapes:function(e,t){this.zpp_inner.immutable_midstep("Body::scaleShapes()");for(var n=this.zpp_inner.shapes.begin();null!=n;)n.elem().outer.scale(e,t),n=n.next;return this},transformShapes:function(e){this.zpp_inner.immutable_midstep("Body::transformShapes()");for(var t=this.zpp_inner.shapes.begin();null!=t;)t.elem().outer.transform(e),t=t.next;return this},align:function(){this.zpp_inner.immutable_midstep("Body::align()"),this.zpp_inner.validate_localCOM();var e=y_.get(-this.zpp_inner.localCOMx,-this.zpp_inner.localCOMy);this.translateShapes(e);var t=this.localVectorToWorld(e);return this.get_position().subeq(t),this.zpp_inner.pre_posx<$_.POSINF()&&(this.zpp_inner.pre_posx-=1*t.get_x(),this.zpp_inner.pre_posy-=1*t.get_y()),e.dispose(),t.dispose(),this},rotate:function(e,t){var n=e.zpp_inner.weak;e.zpp_inner.weak=!1;var i=this.get_position().sub(e);return i.rotate(t),this.set_position(e.add(i,!0)),i.dispose(),this.set_rotation(this.get_rotation()+t),e.zpp_inner.weak=n,e.zpp_inner.weak&&e.dispose(),this},setShapeMaterials:function(e){this.zpp_inner.immutable_midstep("Body::setShapeMaterials()");for(var t=this.zpp_inner.shapes.begin();null!=t;)t.elem().outer.set_material(e),t=t.next;return this},setShapeFilters:function(e){this.zpp_inner.immutable_midstep("Body::setShapeFilters()");for(var t=this.zpp_inner.shapes.begin();null!=t;)t.elem().outer.set_filter(e),t=t.next;return this},setShapeFluidProperties:function(e){this.zpp_inner.immutable_midstep("Body::setShapeFluidProperties()");for(var t=this.zpp_inner.shapes.begin();null!=t;)t.elem().outer.set_fluidProperties(e),t=t.next;return this},get_localCOM:function(){return null==this.zpp_inner.wrap_localCOM&&(this.zpp_inner.wrap_localCOM=y_.get(this.zpp_inner.localCOMx,this.zpp_inner.localCOMy),this.zpp_inner.wrap_localCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_localCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_localCOM.zpp_inner._validate=Cc(kc=this.zpp_inner,kc.getlocalCOM)),this.zpp_inner.wrap_localCOM},get_worldCOM:function(){return null==this.zpp_inner.wrap_worldCOM&&(this.zpp_inner.wrap_worldCOM=y_.get(this.zpp_inner.worldCOMx,this.zpp_inner.worldCOMy),this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._validate=Cc(kc=this.zpp_inner,kc.getworldCOM)),this.zpp_inner.wrap_worldCOM},normalImpulse:function(e,t){null==t&&(t=!1);for(var n=0,i=0,r=0,a=(this.zpp_inner.arbiters,this.get_arbiters().iterator());a.hasNext();){var s=a.next().zpp_inner;if(s.type==Mp.COL&&(null==e||s.b2==e.zpp_inner||s.b1==e.zpp_inner)){var l=s.wrapper().get_collisionArbiter().normalImpulse(this,t);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}}return w_.get(n,i,r)},tangentImpulse:function(e,t){null==t&&(t=!1);for(var n=0,i=0,r=0,a=(this.zpp_inner.arbiters,this.get_arbiters().iterator());a.hasNext();){var s=a.next().zpp_inner;if(s.type==Mp.COL&&(null==e||s.b2==e.zpp_inner||s.b1==e.zpp_inner)){var l=s.wrapper().get_collisionArbiter().tangentImpulse(this,t);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}}return w_.get(n,i,r)},totalContactsImpulse:function(e,t){null==t&&(t=!1);for(var n=0,i=0,r=0,a=(this.zpp_inner.arbiters,this.get_arbiters().iterator());a.hasNext();){var s=a.next().zpp_inner;if(s.type==Mp.COL&&(null==e||s.b2==e.zpp_inner||s.b1==e.zpp_inner)){var l=s.wrapper().get_collisionArbiter().totalImpulse(this,t);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}}return w_.get(n,i,r)},rollingImpulse:function(e,t){null==t&&(t=!1);for(var n=0,i=(this.zpp_inner.arbiters,this.get_arbiters().iterator());i.hasNext();){var r=i.next().zpp_inner;r.type==Mp.COL&&(null!=e&&r.b2!=e.zpp_inner&&r.b1!=e.zpp_inner||(n+=r.wrapper().get_collisionArbiter().rollingImpulse(this,t)))}return n},buoyancyImpulse:function(e){for(var t=0,n=0,i=0,r=(this.zpp_inner.arbiters,this.get_arbiters().iterator());r.hasNext();){var a=r.next().zpp_inner;if(a.type==Mp.FLUID&&(null==e||a.b2==e.zpp_inner||a.b1==e.zpp_inner)){var s=a.wrapper().get_fluidArbiter().buoyancyImpulse(this);t+=1*s.get_x(),n+=1*s.get_y(),i+=1*s.get_z(),s.dispose()}}return w_.get(t,n,i)},dragImpulse:function(e){for(var t=0,n=0,i=0,r=(this.zpp_inner.arbiters,this.get_arbiters().iterator());r.hasNext();){var a=r.next().zpp_inner;if(a.type==Mp.FLUID&&(null==e||a.b2==e.zpp_inner||a.b1==e.zpp_inner)){var s=a.wrapper().get_fluidArbiter().dragImpulse(this);t+=1*s.get_x(),n+=1*s.get_y(),i+=1*s.get_z(),s.dispose()}}return w_.get(t,n,i)},totalFluidImpulse:function(e){for(var t=0,n=0,i=0,r=(this.zpp_inner.arbiters,this.get_arbiters().iterator());r.hasNext();){var a=r.next().zpp_inner;if(a.type==Mp.FLUID&&(null==e||a.b2==e.zpp_inner||a.b1==e.zpp_inner)){var s=a.wrapper().get_fluidArbiter().totalImpulse(this);t+=1*s.get_x(),n+=1*s.get_y(),i+=1*s.get_z(),s.dispose()}}return w_.get(t,n,i)},constraintsImpulse:function(){for(var e=0,t=0,n=0,i=this.zpp_inner.constraints.begin();null!=i;){var r=i.elem().outer.bodyImpulse(this);e+=1*r.get_x(),t+=1*r.get_y(),n+=1*r.get_z(),r.dispose(),i=i.next}return w_.get(e,t,n)},totalImpulse:function(e,t){null==t&&(t=!1);for(var n=0,i=0,r=0,a=(this.zpp_inner.arbiters,this.get_arbiters().iterator());a.hasNext();){var s=a.next().zpp_inner;if(s.type!=Mp.SENSOR&&(null==e||s.b2==e.zpp_inner||s.b1==e.zpp_inner)){var l=s.wrapper().totalImpulse(this,t);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}}for(var o=this.zpp_inner.constraints.begin();null!=o;){var _=o.elem();if(_.active){var p=_.outer.bodyImpulse(this);n+=1*p.get_x(),i+=1*p.get_y(),r+=1*p.get_z(),p.dispose()}o=o.next}return w_.get(n,i,r)},contains:function(e){var t,n=e.zpp_inner.weak;t=e.zpp_inner.weak=!1;for(var i=this.zpp_inner.shapes.begin();null!=i;){if(i.elem().outer.contains(e)){t=!0;break}i=i.next}return e.zpp_inner.weak=n,e.zpp_inner.weak&&e.dispose(),t},toString:function(){return(this.zpp_inner.world?"(space::world":"("+(this.isDynamic()?"dynamic":this.isStatic()?"static":"kinematic"))+")#"+this.get_id()},__class__:C_,__properties__:r(S_.prototype.__properties__,{get_worldCOM:"get_worldCOM",get_localCOM:"get_localCOM",set_inertia:"set_inertia",get_inertia:"get_inertia",get_constraintInertia:"get_constraintInertia",set_inertiaMode:"set_inertiaMode",get_inertiaMode:"get_inertiaMode",set_gravMassScale:"set_gravMassScale",get_gravMassScale:"get_gravMassScale",set_gravMass:"set_gravMass",get_gravMass:"get_gravMass",set_gravMassMode:"set_gravMassMode",get_gravMassMode:"get_gravMassMode",set_mass:"set_mass",get_mass:"get_mass",get_constraintMass:"get_constraintMass",set_massMode:"set_massMode",get_massMode:"get_massMode",set_allowRotation:"set_allowRotation",get_allowRotation:"get_allowRotation",set_allowMovement:"set_allowMovement",get_allowMovement:"get_allowMovement",get_bounds:"get_bounds",set_torque:"set_torque",get_torque:"get_torque",set_kinAngVel:"set_kinAngVel",get_kinAngVel:"get_kinAngVel",set_angularVel:"set_angularVel",get_angularVel:"get_angularVel",set_rotation:"set_rotation",get_rotation:"get_rotation",get_constraintVelocity:"get_constraintVelocity",set_force:"set_force",get_force:"get_force",set_surfaceVel:"set_surfaceVel",get_surfaceVel:"get_surfaceVel",set_kinematicVel:"set_kinematicVel",get_kinematicVel:"get_kinematicVel",set_velocity:"set_velocity",get_velocity:"get_velocity",set_position:"set_position",get_position:"get_position",get_constraints:"get_constraints",get_isSleeping:"get_isSleeping",get_arbiters:"get_arbiters",set_space:"set_space",get_space:"get_space",set_compound:"set_compound",get_compound:"get_compound",get_shapes:"get_shapes",set_disableCCD:"set_disableCCD",get_disableCCD:"get_disableCCD",set_isBullet:"set_isBullet",get_isBullet:"get_isBullet",set_type:"set_type",get_type:"get_type"})});var N_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.phys.BodyIterator"]=N_).__name__=["nape","phys","BodyIterator"],N_.get=function(e){var t;if(null==N_.zpp_pool){ec.internal=!0;var n=new N_;ec.internal=!1,t=n}else{var i=N_.zpp_pool;N_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},N_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=N_.zpp_pool,(N_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:N_};var P_=function(){this.zpp_inner=null,this.zpp_inner=new ec,this.zpp_inner.outer=this};(n["nape.phys.BodyList"]=P_).__name__=["nape","phys","BodyList"],P_.fromArray=function(e){for(var t=new P_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},P_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),N_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new P_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=N_.zpp_pool,(N_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:P_,__properties__:{get_length:"get_length"}};var M_=function(){};(n["nape.phys.BodyType"]=M_).__name__=["nape","phys","BodyType"],M_.__properties__={get_KINEMATIC:"get_KINEMATIC",get_DYNAMIC:"get_DYNAMIC",get_STATIC:"get_STATIC"},M_.get_STATIC=function(){return null==up.BodyType_STATIC&&(up.internal=!0,up.BodyType_STATIC=new M_,up.internal=!1),up.BodyType_STATIC},M_.get_DYNAMIC=function(){return null==up.BodyType_DYNAMIC&&(up.internal=!0,up.BodyType_DYNAMIC=new M_,up.internal=!1),up.BodyType_DYNAMIC},M_.get_KINEMATIC=function(){return null==up.BodyType_KINEMATIC&&(up.internal=!0,up.BodyType_KINEMATIC=new M_,up.internal=!1),up.BodyType_KINEMATIC},M_.prototype={toString:function(){return this==M_.get_STATIC()?"STATIC":this==M_.get_DYNAMIC()?"DYNAMIC":this==M_.get_KINEMATIC()?"KINEMATIC":""},__class__:M_};var I_=function(){this.zpp_inner=null,S_.call(this),this.zpp_inner=new xu,((this.zpp_inner.outer=this).zpp_inner.outer_i=this).zpp_inner_i=this.zpp_inner,this.zpp_inner.insert_cbtype(yo.get_ANY_COMPOUND().zpp_inner)};(n["nape.phys.Compound"]=I_).__name__=["nape","phys","Compound"],I_.__super__=S_,I_.prototype=r(S_.prototype,{zpp_inner:null,get_bodies:function(){return this.zpp_inner.wrap_bodies},get_constraints:function(){return this.zpp_inner.wrap_constraints},get_compounds:function(){return this.zpp_inner.wrap_compounds},get_compound:function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_compound:function(e){return this.zpp_inner.immutable_midstep("Compound::compound"),this.get_compound()!=e&&(null!=this.get_compound()&&this.get_compound().get_compounds().remove(this),null!=e&&e.get_compounds().add(this)),this.get_compound()},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(e){return this.zpp_inner.immutable_midstep("Compound::space"),this.get_space()!=e&&(null!=this.get_space()&&this.get_space().get_compounds().remove(this),null!=e&&e.get_compounds().add(this)),this.get_space()},toString:function(){return"Compound"+this.get_id()},copy:function(){return this.zpp_inner.copy()},breakApart:function(){this.zpp_inner.breakApart()},visitBodies:function(e){for(var t=this.get_bodies().iterator();t.hasNext();)e(t.next());for(var n=this.get_compounds().iterator();n.hasNext();)n.next().visitBodies(e)},visitConstraints:function(e){for(var t=this.get_constraints().iterator();t.hasNext();)e(t.next());for(var n=this.get_compounds().iterator();n.hasNext();)n.next().visitConstraints(e)},visitCompounds:function(e){for(var t=this.get_compounds().iterator();t.hasNext();){var n=t.next();e(n),n.visitCompounds(e)}},COM:function(e){null==e&&(e=!1);var t=y_.get(0,0,e),n=0;return this.visitBodies(function(e){if(!e.get_shapes().empty()){var i=e.get_worldCOM().mul(e.get_mass(),!0);t.addeq(i),n+=e.get_mass()}}),t.muleq(1/n),t},translate:function(e){var t=e.zpp_inner.weak;return e.zpp_inner.weak=!1,this.visitBodies(function(t){t.get_position().addeq(e)}),e.zpp_inner.weak=t,e.zpp_inner.weak&&e.dispose(),this},rotate:function(e,t){var n=e.zpp_inner.weak;return e.zpp_inner.weak=!1,this.visitBodies(function(n){n.rotate(e,t)}),e.zpp_inner.weak=n,e.zpp_inner.weak&&e.dispose(),this},__class__:I_,__properties__:r(S_.prototype.__properties__,{set_space:"set_space",get_space:"get_space",set_compound:"set_compound",get_compound:"get_compound",get_compounds:"get_compounds",get_constraints:"get_constraints",get_bodies:"get_bodies"})});var T_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.phys.CompoundIterator"]=T_).__name__=["nape","phys","CompoundIterator"],T_.get=function(e){var t;if(null==T_.zpp_pool){nc.internal=!0;var n=new T_;nc.internal=!1,t=n}else{var i=T_.zpp_pool;T_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},T_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=T_.zpp_pool,(T_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:T_};var A_=function(){this.zpp_inner=null,this.zpp_inner=new nc,this.zpp_inner.outer=this};(n["nape.phys.CompoundList"]=A_).__name__=["nape","phys","CompoundList"],A_.fromArray=function(e){for(var t=new A_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},A_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),T_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new A_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=T_.zpp_pool,(T_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:A_,__properties__:{get_length:"get_length"}};var D_=function(e,t){null==t&&(t=1),null==e&&(e=1),(this.zpp_inner=null)==zu.zpp_pool?this.zpp_inner=new zu:(this.zpp_inner=zu.zpp_pool,zu.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null),this.zpp_inner.alloc(),(this.zpp_inner.outer=this).set_density(e),this.set_viscosity(t)};(n["nape.phys.FluidProperties"]=D_).__name__=["nape","phys","FluidProperties"],D_.prototype={zpp_inner:null,get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_shapes:function(){return null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=pc.get(this.zpp_inner.shapes,!0)),this.zpp_inner.wrap_shapes},copy:function(){var e=new D_(this.get_density(),this.get_viscosity());return null!=this.zpp_inner.userData&&(e.zpp_inner.userData=_.copy(this.zpp_inner.userData)),e.set_gravity(this.get_gravity()),e},get_density:function(){return 1e3*this.zpp_inner.density},set_density:function(e){return e!=this.get_density()&&(this.zpp_inner.density=e/1e3,this.zpp_inner.invalidate()),this.get_density()},get_viscosity:function(){return this.zpp_inner.viscosity},set_viscosity:function(e){return e!=this.get_viscosity()&&(this.zpp_inner.viscosity=e/1,this.zpp_inner.invalidate()),this.get_viscosity()},get_gravity:function(){return this.zpp_inner.wrap_gravity},set_gravity:function(e){return null==e?null!=this.zpp_inner.wrap_gravity&&(this.zpp_inner.wrap_gravity.zpp_inner._inuse=!1,this.zpp_inner.wrap_gravity.dispose(),this.zpp_inner.wrap_gravity=null):(null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity(),this.get_gravity().set(e)),this.get_gravity()},toString:function(){return"{ density: "+this.get_density()+" viscosity: "+this.get_viscosity()+" gravity: "+p.string(this.get_gravity())+" }"},__class__:D_,__properties__:{set_gravity:"set_gravity",get_gravity:"get_gravity",set_viscosity:"set_viscosity",get_viscosity:"get_viscosity",set_density:"set_density",get_density:"get_density",get_shapes:"get_shapes",get_userData:"get_userData"}};var E_=function(){};(n["nape.phys.GravMassMode"]=E_).__name__=["nape","phys","GravMassMode"],E_.__properties__={get_SCALED:"get_SCALED",get_FIXED:"get_FIXED",get_DEFAULT:"get_DEFAULT"},E_.get_DEFAULT=function(){return null==up.GravMassMode_DEFAULT&&(up.internal=!0,up.GravMassMode_DEFAULT=new E_,up.internal=!1),up.GravMassMode_DEFAULT},E_.get_FIXED=function(){return null==up.GravMassMode_FIXED&&(up.internal=!0,up.GravMassMode_FIXED=new E_,up.internal=!1),up.GravMassMode_FIXED},E_.get_SCALED=function(){return null==up.GravMassMode_SCALED&&(up.internal=!0,up.GravMassMode_SCALED=new E_,up.internal=!1),up.GravMassMode_SCALED},E_.prototype={toString:function(){return this==E_.get_DEFAULT()?"DEFAULT":this==E_.get_FIXED()?"FIXED":this==E_.get_SCALED()?"SCALED":""},__class__:E_};var O_=function(){};(n["nape.phys.InertiaMode"]=O_).__name__=["nape","phys","InertiaMode"],O_.__properties__={get_FIXED:"get_FIXED",get_DEFAULT:"get_DEFAULT"},O_.get_DEFAULT=function(){return null==up.InertiaMode_DEFAULT&&(up.internal=!0,up.InertiaMode_DEFAULT=new O_,up.internal=!1),up.InertiaMode_DEFAULT},O_.get_FIXED=function(){return null==up.InertiaMode_FIXED&&(up.internal=!0,up.InertiaMode_FIXED=new O_,up.internal=!1),up.InertiaMode_FIXED},O_.prototype={toString:function(){return this==O_.get_DEFAULT()?"DEFAULT":this==O_.get_FIXED()?"FIXED":""},__class__:O_};var B_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.phys.InteractorIterator"]=B_).__name__=["nape","phys","InteractorIterator"],B_.get=function(e){var t;if(null==B_.zpp_pool){tc.internal=!0;var n=new B_;tc.internal=!1,t=n}else{var i=B_.zpp_pool;B_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},B_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=B_.zpp_pool,(B_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:B_};var L_=function(){this.zpp_inner=null,this.zpp_inner=new tc,this.zpp_inner.outer=this};(n["nape.phys.InteractorList"]=L_).__name__=["nape","phys","InteractorList"],L_.fromArray=function(e){for(var t=new L_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},L_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner_i)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer_i},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner_i);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner_i)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner_i)}else this.zpp_inner.inner.add(e.zpp_inner_i);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer_i},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer_i},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner_i){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner_i),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),B_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new L_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=B_.zpp_pool,(B_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:L_,__properties__:{get_length:"get_length"}};var j_=function(){};(n["nape.phys.MassMode"]=j_).__name__=["nape","phys","MassMode"],j_.__properties__={get_FIXED:"get_FIXED",get_DEFAULT:"get_DEFAULT"},j_.get_DEFAULT=function(){return null==up.MassMode_DEFAULT&&(up.internal=!0,up.MassMode_DEFAULT=new j_,up.internal=!1),up.MassMode_DEFAULT},j_.get_FIXED=function(){return null==up.MassMode_FIXED&&(up.internal=!0,up.MassMode_FIXED=new j_,up.internal=!1),up.MassMode_FIXED},j_.prototype={toString:function(){return this==j_.get_DEFAULT()?"DEFAULT":this==j_.get_FIXED()?"FIXED":""},__class__:j_};var F_=function(){this.zpp_inner=null,S_.call(this)};(n["nape.shape.Shape"]=F_).__name__=["nape","shape","Shape"],F_.__super__=S_,F_.prototype=r(S_.prototype,{zpp_inner:null,get_type:function(){return wu.types[this.zpp_inner.type]},isCircle:function(){return this.zpp_inner.isCircle()},isPolygon:function(){return this.zpp_inner.isPolygon()},get_body:function(){return null!=this.zpp_inner.body?this.zpp_inner.body.outer:null},set_body:function(e){return this.zpp_inner.immutable_midstep("Shape::body"),this.get_body()!=e&&(null!=this.zpp_inner.body&&this.get_body().get_shapes().remove(this),null!=e&&e.get_shapes().add(this)),this.get_body()},get_castCircle:function(){return this.isCircle()?this.zpp_inner.circle.outer_zn:null},get_castPolygon:function(){return this.isPolygon()?this.zpp_inner.polygon.outer_zn:null},get_worldCOM:function(){return null==this.zpp_inner.wrap_worldCOM&&(this.zpp_inner.wrap_worldCOM=y_.get(this.zpp_inner.worldCOMx,this.zpp_inner.worldCOMy),this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._validate=Cc(kc=this.zpp_inner,kc.getworldCOM)),this.zpp_inner.wrap_worldCOM},get_localCOM:function(){return null==this.zpp_inner.wrap_localCOM&&(this.isCircle()?this.zpp_inner.circle.setupLocalCOM():this.zpp_inner.polygon.setupLocalCOM()),this.zpp_inner.wrap_localCOM},set_localCOM:function(e){return this.zpp_inner.immutable_midstep("Body::localCOM"),this.get_localCOM().set(e),this.get_localCOM()},get_area:function(){return this.zpp_inner.validate_area_inertia(),this.zpp_inner.area},get_inertia:function(){return this.zpp_inner.validate_area_inertia(),this.zpp_inner.inertia},get_angDrag:function(){return this.zpp_inner.validate_angDrag(),this.zpp_inner.angDrag},get_material:function(){return this.zpp_inner.material.wrapper()},set_material:function(e){return this.zpp_inner.immutable_midstep("Shape::material"),this.zpp_inner.setMaterial(e.zpp_inner),this.get_material()},get_filter:function(){return this.zpp_inner.filter.wrapper()},set_filter:function(e){return this.zpp_inner.immutable_midstep("Shape::filter"),this.zpp_inner.setFilter(e.zpp_inner),this.get_filter()},get_fluidProperties:function(){return this.zpp_inner.immutable_midstep("Shape::fluidProperties"),null==this.zpp_inner.fluidProperties&&this.zpp_inner.setFluid((new D_).zpp_inner),this.zpp_inner.fluidProperties.wrapper()},set_fluidProperties:function(e){return this.zpp_inner.setFluid(e.zpp_inner),this.get_fluidProperties()},get_fluidEnabled:function(){return this.zpp_inner.fluidEnabled},set_fluidEnabled:function(e){return this.zpp_inner.immutable_midstep("Shape::fluidEnabled"),(this.zpp_inner.fluidEnabled=e)&&null==this.zpp_inner.fluidProperties&&this.set_fluidProperties(new D_),this.zpp_inner.wake(),this.get_fluidEnabled()},get_sensorEnabled:function(){return this.zpp_inner.sensorEnabled},set_sensorEnabled:function(e){return this.zpp_inner.immutable_midstep("Shape::sensorEnabled"),this.zpp_inner.sensorEnabled=e,this.zpp_inner.wake(),this.get_sensorEnabled()},get_bounds:function(){return this.zpp_inner.aabb.wrapper()},translate:function(e){return this.zpp_inner.immutable_midstep("Shape::translate()"),0<e.lsq()&&(this.isCircle()?this.zpp_inner.circle.__translate(e.get_x(),e.get_y()):this.zpp_inner.polygon.__translate(e.get_x(),e.get_y())),e.zpp_inner.weak&&e.dispose(),this},scale:function(e,t){if(this.zpp_inner.immutable_midstep("Shape::scale()"),this.isCircle()){var n=e*e-t*t;n*n<co.epsilon*co.epsilon&&this.zpp_inner.circle.__scale(e,t)}else this.zpp_inner.polygon.__scale(e,t);return this},rotate:function(e){if(this.zpp_inner.immutable_midstep("Shape::rotate()"),0!=e%(2*Math.PI)){var t=Math.cos(e),n=Math.sin(e);this.isCircle()?this.zpp_inner.circle.__rotate(n,t):this.zpp_inner.polygon.__rotate(n,t)}return this},transform:function(e){return this.zpp_inner.immutable_midstep("Shape::transform()"),this.isCircle()?e.equiorthogonal()&&this.zpp_inner.circle.__transform(e):this.zpp_inner.polygon.__transform(e),this},contains:function(e){qp.validateShape(this.zpp_inner),e.zpp_inner.validate();var t=Fp.shapeContains(this.zpp_inner,e.zpp_inner);return e.zpp_inner.weak&&e.dispose(),t},copy:function(){return this.zpp_inner.copy()},toString:function(){return(this.isCircle()?"Circle":"Polygon")+"#"+this.get_id()},__class__:F_,__properties__:r(S_.prototype.__properties__,{get_bounds:"get_bounds",set_sensorEnabled:"set_sensorEnabled",get_sensorEnabled:"get_sensorEnabled",set_fluidEnabled:"set_fluidEnabled",get_fluidEnabled:"get_fluidEnabled",set_fluidProperties:"set_fluidProperties",get_fluidProperties:"get_fluidProperties",set_filter:"set_filter",get_filter:"get_filter",set_material:"set_material",get_material:"get_material",get_angDrag:"get_angDrag",get_inertia:"get_inertia",get_area:"get_area",set_localCOM:"set_localCOM",get_localCOM:"get_localCOM",get_worldCOM:"get_worldCOM",get_castPolygon:"get_castPolygon",get_castCircle:"get_castCircle",set_body:"set_body",get_body:"get_body",get_type:"get_type"})});var R_=function(e,t,n,i){this.zpp_inner_zn=null,F_.call(this),this.zpp_inner_zn=new ku,((this.zpp_inner_zn.outer=this).zpp_inner_zn.outer_zn=this).zpp_inner=this.zpp_inner_zn,this.zpp_inner_i=this.zpp_inner,(this.zpp_inner_i.outer_i=this).set_radius(e),null==t?(this.zpp_inner.localCOMx=0,this.zpp_inner.localCOMy=0):(this.zpp_inner.localCOMx=t.get_x(),this.zpp_inner.localCOMy=t.get_y(),t.zpp_inner.weak&&t.dispose()),null==n?(null==tr.zpp_pool?this.zpp_inner.material=new tr:(this.zpp_inner.material=tr.zpp_pool,tr.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),this.zpp_inner.material.alloc()):this.set_material(n),null==i?(null==ki.zpp_pool?this.zpp_inner.filter=new ki:(this.zpp_inner.filter=ki.zpp_pool,ki.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null),this.zpp_inner.filter.alloc()):this.set_filter(i),this.zpp_inner_i.insert_cbtype(yo.get_ANY_SHAPE().zpp_inner)};(n["nape.shape.Circle"]=R_).__name__=["nape","shape","Circle"],R_.__super__=F_,R_.prototype=r(F_.prototype,{zpp_inner_zn:null,get_radius:function(){return this.zpp_inner_zn.radius},set_radius:function(e){return this.zpp_inner.immutable_midstep("Circle::radius"),e!=this.get_radius()&&(this.zpp_inner_zn.radius=e,this.zpp_inner_zn.invalidate_radius()),this.get_radius()},__class__:R_,__properties__:r(F_.prototype.__properties__,{set_radius:"set_radius",get_radius:"get_radius"})});var G_=function(){this.zpp_inner=null};(n["nape.shape.Edge"]=G_).__name__=["nape","shape","Edge"],G_.prototype={zpp_inner:null,get_polygon:function(){return this.zpp_inner.polygon.outer_zn},get_localNormal:function(){return null==this.zpp_inner.wrap_lnorm&&this.zpp_inner.getlnorm(),this.zpp_inner.wrap_lnorm},get_worldNormal:function(){return null==this.zpp_inner.wrap_gnorm&&this.zpp_inner.getgnorm(),this.zpp_inner.wrap_gnorm},get_length:function(){return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.length},get_localProjection:function(){return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.lprojection},get_worldProjection:function(){return this.zpp_inner.polygon.validate_gaxi(),this.zpp_inner.gprojection},get_localVertex1:function(){return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.lp0.wrapper()},get_localVertex2:function(){return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.lp1.wrapper()},get_worldVertex1:function(){return this.zpp_inner.polygon.validate_gaxi(),this.zpp_inner.gp0.wrapper()},get_worldVertex2:function(){return this.zpp_inner.polygon.validate_gaxi(),this.zpp_inner.gp1.wrapper()},toString:function(){return null==this.zpp_inner.polygon?"Edge(object-pooled)":null==this.zpp_inner.polygon.body?(this.zpp_inner.polygon.validate_laxi(),"{ localNormal : { x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" } }"):(this.zpp_inner.polygon.validate_gaxi(),"{ localNormal : { x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" } worldNormal : { x: "+this.zpp_inner.gnormx+" y: "+this.zpp_inner.gnormy+" } }")},__class__:G_,__properties__:{get_worldVertex2:"get_worldVertex2",get_worldVertex1:"get_worldVertex1",get_localVertex2:"get_localVertex2",get_localVertex1:"get_localVertex1",get_worldProjection:"get_worldProjection",get_localProjection:"get_localProjection",get_length:"get_length",get_worldNormal:"get_worldNormal",get_localNormal:"get_localNormal",get_polygon:"get_polygon"}};var Z_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.shape.EdgeIterator"]=Z_).__name__=["nape","shape","EdgeIterator"],Z_.get=function(e){var t;if(null==Z_.zpp_pool){_c.internal=!0;var n=new Z_;_c.internal=!1,t=n}else{var i=Z_.zpp_pool;Z_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},Z_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=Z_.zpp_pool,(Z_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:Z_};var U_=function(){this.zpp_inner=null,this.zpp_inner=new _c,this.zpp_inner.outer=this};(n["nape.shape.EdgeList"]=U_).__name__=["nape","shape","EdgeList"],U_.fromArray=function(e){for(var t=new U_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},U_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=e==this.get_length()-1?e:this.get_length()-2-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().wrapper()},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.wrapper()},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.wrapper()},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),Z_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new U_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=Z_.zpp_pool,(Z_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:U_,__properties__:{get_length:"get_length"}};var V_=function(e,t,n){if(this.zpp_inner_zn=null,F_.call(this),this.zpp_inner_zn=new Cu,((this.zpp_inner_zn.outer=this).zpp_inner_zn.outer_zn=this).zpp_inner=this.zpp_inner_zn,this.zpp_inner_i=this.zpp_inner,this.zpp_inner_i.outer_i=this,e instanceof Array&&null==e.__enum__)for(var i=e,r=0;r<i.length;){var a=i[r];++r;var s=a;this.get_localVerts().push(s.copy())}else if(p.is(e,z_))for(var l=e.iterator();l.hasNext();){var o=l.next();this.get_localVerts().push(o.copy())}else if(p.is(e,__)){var _=e.zpp_inner.vertices;if(null!=_)for(var u=_;;){var h=y_.get(u.x,u.y);if(u=u.next,this.get_localVerts().push(h.copy()),h.dispose(),u==_)break}}if(e instanceof Array&&null==e.__enum__)for(var c=e,d=0;d<c.length;){var m=c[d];m.zpp_inner.weak&&(m.dispose(),1)?c.splice(d,1):++d}else if(p.is(e,z_)){var f=e;null!=f.zpp_inner._validate&&f.zpp_inner._validate();for(var g=f.zpp_inner.inner,v=null,b=g.begin();null!=b;){var y=b.elem();y.outer.zpp_inner.weak?(b=g.erase(v),y.outer.zpp_inner.weak&&y.outer.dispose()):b=(v=b).next}}null==t?(null==tr.zpp_pool?this.zpp_inner.material=new tr:(this.zpp_inner.material=tr.zpp_pool,tr.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),this.zpp_inner.material.alloc()):this.set_material(t),null==n?(null==ki.zpp_pool?this.zpp_inner.filter=new ki:(this.zpp_inner.filter=ki.zpp_pool,ki.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null),this.zpp_inner.filter.alloc()):this.set_filter(n),this.zpp_inner_i.insert_cbtype(yo.get_ANY_SHAPE().zpp_inner)};(n["nape.shape.Polygon"]=V_).__name__=["nape","shape","Polygon"],V_.rect=function(e,t,n,i,r){return null==r&&(r=!1),[y_.get(e,t,r),y_.get(e+n,t,r),y_.get(e+n,t+i,r),y_.get(e,t+i,r)]},V_.box=function(e,t,n){return null==n&&(n=!1),V_.rect(-e/2,-t/2,e,t,n)},V_.regular=function(e,t,n,i,r){null==r&&(r=!1),null==i&&(i=0);for(var a=[],s=2*Math.PI/n,l=0,o=n;l<o;){var _=l++*s+i,p=y_.get(Math.cos(_)*e,Math.sin(_)*t,r);a.push(p)}return a},V_.__super__=F_,V_.prototype=r(F_.prototype,{zpp_inner_zn:null,get_localVerts:function(){return null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts(),this.zpp_inner_zn.wrap_lverts},get_worldVerts:function(){return null==this.zpp_inner_zn.wrap_gverts&&this.zpp_inner_zn.getgverts(),this.zpp_inner_zn.wrap_gverts},get_edges:function(){return null==this.zpp_inner_zn.wrap_edges&&this.zpp_inner_zn.getedges(),this.zpp_inner_zn.wrap_edges},validity:function(){return this.zpp_inner_zn.valid()},__class__:V_,__properties__:r(F_.prototype.__properties__,{get_edges:"get_edges",get_worldVerts:"get_worldVerts",get_localVerts:"get_localVerts"})});var q_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.shape.ShapeIterator"]=q_).__name__=["nape","shape","ShapeIterator"],q_.get=function(e){var t;if(null==q_.zpp_pool){pc.internal=!0;var n=new q_;pc.internal=!1,t=n}else{var i=q_.zpp_pool;q_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},q_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=q_.zpp_pool,(q_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:q_};var W_=function(){this.zpp_inner=null,this.zpp_inner=new pc,this.zpp_inner.outer=this};(n["nape.shape.ShapeList"]=W_).__name__=["nape","shape","ShapeList"],W_.fromArray=function(e){for(var t=new W_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},W_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),q_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new W_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=q_.zpp_pool,(q_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:W_,__properties__:{get_length:"get_length"}};var X_=function(){};(n["nape.shape.ShapeType"]=X_).__name__=["nape","shape","ShapeType"],X_.__properties__={get_POLYGON:"get_POLYGON",get_CIRCLE:"get_CIRCLE"},X_.get_CIRCLE=function(){return null==up.ShapeType_CIRCLE&&(up.internal=!0,up.ShapeType_CIRCLE=new X_,up.internal=!1),up.ShapeType_CIRCLE},X_.get_POLYGON=function(){return null==up.ShapeType_POLYGON&&(up.internal=!0,up.ShapeType_POLYGON=new X_,up.internal=!1),up.ShapeType_POLYGON},X_.prototype={toString:function(){return this==X_.get_CIRCLE()?"CIRCLE":this==X_.get_POLYGON()?"POLYGON":""},__class__:X_};var H_=function(){};(n["nape.shape.ValidationResult"]=H_).__name__=["nape","shape","ValidationResult"],H_.__properties__={get_SELF_INTERSECTING:"get_SELF_INTERSECTING",get_CONCAVE:"get_CONCAVE",get_DEGENERATE:"get_DEGENERATE",get_VALID:"get_VALID"},H_.get_VALID=function(){return null==up.ValidationResult_VALID&&(up.internal=!0,up.ValidationResult_VALID=new H_,up.internal=!1),up.ValidationResult_VALID},H_.get_DEGENERATE=function(){return null==up.ValidationResult_DEGENERATE&&(up.internal=!0,up.ValidationResult_DEGENERATE=new H_,up.internal=!1),up.ValidationResult_DEGENERATE},H_.get_CONCAVE=function(){return null==up.ValidationResult_CONCAVE&&(up.internal=!0,up.ValidationResult_CONCAVE=new H_,up.internal=!1),up.ValidationResult_CONCAVE},H_.get_SELF_INTERSECTING=function(){return null==up.ValidationResult_SELF_INTERSECTING&&(up.internal=!0,up.ValidationResult_SELF_INTERSECTING=new H_,up.internal=!1),up.ValidationResult_SELF_INTERSECTING},H_.prototype={toString:function(){return this==H_.get_VALID()?"VALID":this==H_.get_DEGENERATE()?"DEGENERATE":this==H_.get_CONCAVE()?"CONCAVE":this==H_.get_SELF_INTERSECTING()?"SELF_INTERSECTING":""},__class__:H_};var Y_=function(){};(n["nape.space.Broadphase"]=Y_).__name__=["nape","space","Broadphase"],Y_.__properties__={get_SWEEP_AND_PRUNE:"get_SWEEP_AND_PRUNE",get_DYNAMIC_AABB_TREE:"get_DYNAMIC_AABB_TREE"},Y_.get_DYNAMIC_AABB_TREE=function(){return null==up.Broadphase_DYNAMIC_AABB_TREE&&(up.internal=!0,up.Broadphase_DYNAMIC_AABB_TREE=new Y_,up.internal=!1),up.Broadphase_DYNAMIC_AABB_TREE},Y_.get_SWEEP_AND_PRUNE=function(){return null==up.Broadphase_SWEEP_AND_PRUNE&&(up.internal=!0,up.Broadphase_SWEEP_AND_PRUNE=new Y_,up.internal=!1),up.Broadphase_SWEEP_AND_PRUNE},Y_.prototype={toString:function(){return this==Y_.get_DYNAMIC_AABB_TREE()?"DYNAMIC_AABB_TREE":this==Y_.get_SWEEP_AND_PRUNE()?"SWEEP_AND_PRUNE":""},__class__:Y_};var J_=function(e,t){this.zpp_inner=null,this.zpp_inner=new Bu(null==e?null:e.zpp_inner,t),this.zpp_inner.outer=this,null!=e&&e.zpp_inner.weak&&e.dispose()};(n["nape.space.Space"]=J_).__name__=["nape","space","Space"],J_.prototype={zpp_inner:null,get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_gravity:function(){return null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity(),this.zpp_inner.wrap_gravity},set_gravity:function(e){return this.get_gravity().set(e),this.get_gravity()},get_broadphase:function(){return this.zpp_inner.bphase.is_sweep?Y_.get_SWEEP_AND_PRUNE():Y_.get_DYNAMIC_AABB_TREE()},get_sortContacts:function(){return this.zpp_inner.sortcontacts},set_sortContacts:function(e){return this.zpp_inner.sortcontacts=e,this.get_sortContacts()},get_worldAngularDrag:function(){return this.zpp_inner.global_ang_drag},set_worldAngularDrag:function(e){var t=e;return this.zpp_inner.global_ang_drag=t,this.get_worldAngularDrag()},get_worldLinearDrag:function(){return this.zpp_inner.global_lin_drag},set_worldLinearDrag:function(e){var t=e;return this.zpp_inner.global_lin_drag=t,this.get_worldLinearDrag()},get_compounds:function(){return this.zpp_inner.wrap_compounds},get_bodies:function(){return this.zpp_inner.wrap_bodies},get_liveBodies:function(){return this.zpp_inner.wrap_live},get_constraints:function(){return this.zpp_inner.wrap_constraints},get_liveConstraints:function(){return this.zpp_inner.wrap_livecon},visitBodies:function(e){for(var t=this.get_bodies().iterator();t.hasNext();)e(t.next());for(var n=this.get_compounds().iterator();n.hasNext();)n.next().visitBodies(e)},visitConstraints:function(e){for(var t=this.get_constraints().iterator();t.hasNext();)e(t.next());for(var n=this.get_compounds().iterator();n.hasNext();)n.next().visitConstraints(e)},visitCompounds:function(e){for(var t=this.get_compounds().iterator();t.hasNext();){var n=t.next();e(n),n.visitCompounds(e)}},get_world:function(){return this.zpp_inner.__static},get_arbiters:function(){if(null==this.zpp_inner.wrap_arbiters){var e=new Bp;e.space=this.zpp_inner,this.zpp_inner.wrap_arbiters=e}return this.zpp_inner.wrap_arbiters},get_listeners:function(){return this.zpp_inner.wrap_listeners},clear:function(){this.zpp_inner.clear()},step:function(e,t,n){null==n&&(n=10),null==t&&(t=10),this.zpp_inner.step(e,t,n)},get_timeStamp:function(){return this.zpp_inner.stamp},get_elapsedTime:function(){return this.zpp_inner.time},interactionType:function(e,t){if(e.get_body().isStatic()&&t.get_body().isStatic())return null;if(e.get_body()==t.get_body())return null;var n=e.zpp_inner,i=t.zpp_inner;switch(this.zpp_inner.interactionType(n,i,n.body,i.body)){case 0:return No.get_FLUID();case 1:return No.get_COLLISION();case 2:return No.get_SENSOR();default:return null}},shapesUnderPoint:function(e,t,n){var i=this.zpp_inner.shapesUnderPoint(e.get_x(),e.get_y(),null==t?null:t.zpp_inner,n);return e.zpp_inner.weak&&e.dispose(),i},bodiesUnderPoint:function(e,t,n){var i=this.zpp_inner.bodiesUnderPoint(e.get_x(),e.get_y(),null==t?null:t.zpp_inner,n);return e.zpp_inner.weak&&e.dispose(),i},shapesInAABB:function(e,t,n,i,r){return null==n&&(n=!0),null==t&&(t=!1),this.zpp_inner.shapesInAABB(e,n,t,null==i?null:i.zpp_inner,r)},bodiesInAABB:function(e,t,n,i,r){return null==n&&(n=!0),null==t&&(t=!1),this.zpp_inner.bodiesInAABB(e,n,t,null==i?null:i.zpp_inner,r)},shapesInCircle:function(e,t,n,i,r){null==n&&(n=!1);var a=this.zpp_inner.shapesInCircle(e,t,n,null==i?null:i.zpp_inner,r);return e.zpp_inner.weak&&e.dispose(),a},bodiesInCircle:function(e,t,n,i,r){null==n&&(n=!1);var a=this.zpp_inner.bodiesInCircle(e,t,n,null==i?null:i.zpp_inner,r);return e.zpp_inner.weak&&e.dispose(),a},shapesInShape:function(e,t,n,i){return null==t&&(t=!1),this.zpp_inner.shapesInShape(e.zpp_inner,t,null==n?null:n.zpp_inner,i)},bodiesInShape:function(e,t,n,i){return null==t&&(t=!1),this.zpp_inner.bodiesInShape(e.zpp_inner,t,null==n?null:n.zpp_inner,i)},shapesInBody:function(e,t,n){for(var i=null==n?new W_:n,r=e.get_shapes().iterator();r.hasNext();){var a=r.next();this.shapesInShape(a,!1,t,i)}return i},bodiesInBody:function(e,t,n){for(var i=null==n?new P_:n,r=e.get_shapes().iterator();r.hasNext();){var a=r.next();this.bodiesInShape(a,!1,t,i)}return i},convexCast:function(e,t,n,i){return null==n&&(n=!1),this.zpp_inner.convexCast(e.zpp_inner,t,i,n)},convexMultiCast:function(e,t,n,i,r){return null==n&&(n=!1),this.zpp_inner.convexMultiCast(e.zpp_inner,t,i,n,r)},rayCast:function(e,t,n){return null==t&&(t=!1),this.zpp_inner.rayCast(e,t,n)},rayMultiCast:function(e,t,n,i){return null==t&&(t=!1),this.zpp_inner.rayMultiCast(e,t,n,i)},__class__:J_,__properties__:{get_elapsedTime:"get_elapsedTime",get_timeStamp:"get_timeStamp",get_listeners:"get_listeners",get_arbiters:"get_arbiters",get_world:"get_world",get_liveConstraints:"get_liveConstraints",get_constraints:"get_constraints",get_liveBodies:"get_liveBodies",get_bodies:"get_bodies",get_compounds:"get_compounds",set_worldLinearDrag:"set_worldLinearDrag",get_worldLinearDrag:"get_worldLinearDrag",set_worldAngularDrag:"set_worldAngularDrag",get_worldAngularDrag:"get_worldAngularDrag",set_sortContacts:"set_sortContacts",get_sortContacts:"get_sortContacts",get_broadphase:"get_broadphase",set_gravity:"set_gravity",get_gravity:"get_gravity",get_userData:"get_userData"}};var K_=function(){};(n["nape.util.Debug"]=K_).__name__=["nape","util","Debug"],K_.version=function(){return"Nape 2.0.19"},K_.clearObjectPools=function(){for(;null!=Lo.zpp_pool;){var e=Lo.zpp_pool.zpp_next;Lo.zpp_pool.zpp_next=null,Lo.zpp_pool=e}for(;null!=B_.zpp_pool;){var t=B_.zpp_pool.zpp_next;B_.zpp_pool.zpp_next=null,B_.zpp_pool=t}for(;null!=N_.zpp_pool;){var n=N_.zpp_pool.zpp_next;N_.zpp_pool.zpp_next=null,N_.zpp_pool=n}for(;null!=T_.zpp_pool;){var i=T_.zpp_pool.zpp_next;T_.zpp_pool.zpp_next=null,T_.zpp_pool=i}for(;null!=Po.zpp_pool;){var r=Po.zpp_pool.zpp_next;Po.zpp_pool.zpp_next=null,Po.zpp_pool=r}for(;null!=xo.zpp_pool;){var a=xo.zpp_pool.zpp_next;xo.zpp_pool.zpp_next=null,xo.zpp_pool=a}for(;null!=s_.zpp_pool;){var s=s_.zpp_pool.zpp_next;s_.zpp_pool.zpp_next=null,s_.zpp_pool=s}for(;null!=p_.zpp_pool;){var l=p_.zpp_pool.zpp_next;p_.zpp_pool.zpp_next=null,p_.zpp_pool=l}for(;null!=x_.zpp_pool;){var o=x_.zpp_pool.zpp_next;x_.zpp_pool.zpp_next=null,x_.zpp_pool=o}for(;null!=v_.zpp_pool;){var _=v_.zpp_pool.zpp_next;v_.zpp_pool.zpp_next=null,v_.zpp_pool=_}for(;null!=q_.zpp_pool;){var p=q_.zpp_pool.zpp_next;q_.zpp_pool.zpp_next=null,q_.zpp_pool=p}for(;null!=Z_.zpp_pool;){var u=Z_.zpp_pool.zpp_next;Z_.zpp_pool.zpp_next=null,Z_.zpp_pool=u}for(;null!=Qo.zpp_pool;){var h=Qo.zpp_pool.zpp_next;Qo.zpp_pool.zpp_next=null,Qo.zpp_pool=h}for(;null!=Xo.zpp_pool;){var c=Xo.zpp_pool.zpp_next;Xo.zpp_pool.zpp_next=null,Xo.zpp_pool=c}for(;null!=n_.zpp_pool;){var d=n_.zpp_pool.zpp_next;n_.zpp_pool.zpp_next=null,n_.zpp_pool=d}for(;null!=gh.zpp_pool;){var m=gh.zpp_pool.next;gh.zpp_pool.next=null,gh.zpp_pool=m}for(;null!=vh.zpp_pool;){var f=vh.zpp_pool.next;vh.zpp_pool.next=null,vh.zpp_pool=f}for(;null!=tr.zpp_pool;){var g=tr.zpp_pool.next;tr.zpp_pool.next=null,tr.zpp_pool=g}for(;null!=bh.zpp_pool;){var v=bh.zpp_pool.next;bh.zpp_pool.next=null,bh.zpp_pool=v}for(;null!=zu.zpp_pool;){var b=zu.zpp_pool.next;zu.zpp_pool.next=null,zu.zpp_pool=b}for(;null!=yh.zpp_pool;){var y=yh.zpp_pool.next;yh.zpp_pool.next=null,yh.zpp_pool=y}for(;null!=xh.zpp_pool;){var x=xh.zpp_pool.next;xh.zpp_pool.next=null,xh.zpp_pool=x}for(;null!=zh.zpp_pool;){var z=zh.zpp_pool.next;zh.zpp_pool.next=null,zh.zpp_pool=z}for(;null!=ip.zpp_pool;){var w=ip.zpp_pool.next;ip.zpp_pool.next=null,ip.zpp_pool=w}for(;null!=wh.zpp_pool;){var k=wh.zpp_pool.next;wh.zpp_pool.next=null,wh.zpp_pool=k}for(;null!=kh.zpp_pool;){var S=kh.zpp_pool.next;kh.zpp_pool.next=null,kh.zpp_pool=S}for(;null!=Sh.zpp_pool;){var C=Sh.zpp_pool.next;Sh.zpp_pool.next=null,Sh.zpp_pool=C}for(;null!=Ch.zpp_pool;){var N=Ch.zpp_pool.next;Ch.zpp_pool.next=null,Ch.zpp_pool=N}for(;null!=Nh.zpp_pool;){var P=Nh.zpp_pool.next;Nh.zpp_pool.next=null,Nh.zpp_pool=P}for(;null!=Ph.zpp_pool;){var M=Ph.zpp_pool.next;Ph.zpp_pool.next=null,Ph.zpp_pool=M}for(;null!=fc.zpp_pool;){var I=fc.zpp_pool.next;fc.zpp_pool.next=null,fc.zpp_pool=I}for(;null!=np.zpp_pool;){var T=np.zpp_pool.next;np.zpp_pool.next=null,np.zpp_pool=T}for(;null!=Mh.zpp_pool;){var A=Mh.zpp_pool.next;Mh.zpp_pool.next=null,Mh.zpp_pool=A}for(;null!=tp.zpp_pool;){var D=tp.zpp_pool.next;tp.zpp_pool.next=null,tp.zpp_pool=D}for(;null!=Wp.zpp_pool;){var E=Wp.zpp_pool.next;Wp.zpp_pool.next=null,Wp.zpp_pool=E}for(;null!=Hp.zpp_pool;){var O=Hp.zpp_pool.next;Hp.zpp_pool.next=null,Hp.zpp_pool=O}for(;null!=gc.zpp_pool;){var B=gc.zpp_pool.next;gc.zpp_pool.next=null,gc.zpp_pool=B}for(;null!=Qp.zpp_pool;){var L=Qp.zpp_pool.next;Qp.zpp_pool.next=null,Qp.zpp_pool=L}for(;null!=Zp.zpp_pool;){var j=Zp.zpp_pool.next;Zp.zpp_pool.next=null,Zp.zpp_pool=j}for(;null!=Up.zpp_pool;){var F=Up.zpp_pool.next;Up.zpp_pool.next=null,Up.zpp_pool=F}for(;null!=Ih.zpp_pool;){var R=Ih.zpp_pool.next;Ih.zpp_pool.next=null,Ih.zpp_pool=R}for(;null!=Th.zpp_pool;){var G=Th.zpp_pool.next;Th.zpp_pool.next=null,Th.zpp_pool=G}for(;null!=fu.zpp_pool;){var Z=fu.zpp_pool.next;fu.zpp_pool.next=null,fu.zpp_pool=Z}for(;null!=Ah.zpp_pool;){var U=Ah.zpp_pool.next;Ah.zpp_pool.next=null,Ah.zpp_pool=U}for(;null!=tu.zpp_pool;){var V=tu.zpp_pool.next;tu.zpp_pool.next=null,tu.zpp_pool=V}for(;null!=vc.zpp_pool;){var q=vc.zpp_pool.next;vc.zpp_pool.next=null,vc.zpp_pool=q}for(;null!=nu.zpp_pool;){var W=nu.zpp_pool.next;nu.zpp_pool.next=null,nu.zpp_pool=W}for(;null!=Dh.zpp_pool;){var X=Dh.zpp_pool.next;Dh.zpp_pool.next=null,Dh.zpp_pool=X}for(;null!=du.zpp_pool;){var H=du.zpp_pool.next;du.zpp_pool.next=null,du.zpp_pool=H}for(;null!=bc.zpp_pool;){var Y=bc.zpp_pool.next;bc.zpp_pool.next=null,bc.zpp_pool=Y}for(;null!=Eh.zpp_pool;){var J=Eh.zpp_pool.next;Eh.zpp_pool.next=null,Eh.zpp_pool=J}for(;null!=_u.zpp_pool;){var K=_u.zpp_pool.next;_u.zpp_pool.next=null,_u.zpp_pool=K}for(;null!=pu.zpp_pool;){var Q=pu.zpp_pool.next;pu.zpp_pool.next=null,pu.zpp_pool=Q}for(;null!=Oh.zpp_pool;){var $=Oh.zpp_pool.next;Oh.zpp_pool.next=null,Oh.zpp_pool=$}for(;null!=Lp.zpp_pool;){var ee=Lp.zpp_pool.next;Lp.zpp_pool.next=null,Lp.zpp_pool=ee}for(;null!=hu.zpp_pool;){var te=hu.zpp_pool.next;hu.zpp_pool.next=null,hu.zpp_pool=te}for(;null!=yc.zpp_pool;){var ne=yc.zpp_pool.next;yc.zpp_pool.next=null,yc.zpp_pool=ne}for(;null!=ru.zpp_pool;){var ie=ru.zpp_pool.next;ru.zpp_pool.next=null,ru.zpp_pool=ie}for(;null!=au.zpp_pool;){var re=au.zpp_pool.next;au.zpp_pool.next=null,au.zpp_pool=re}for(;null!=xc.zpp_pool;){var ae=xc.zpp_pool.next;xc.zpp_pool.next=null,xc.zpp_pool=ae}for(;null!=Yp.zpp_pool;){var se=Yp.zpp_pool.next;Yp.zpp_pool.next=null,Yp.zpp_pool=se}for(;null!=Jp.zpp_pool;){var le=Jp.zpp_pool.next;Jp.zpp_pool.next=null,Jp.zpp_pool=le}for(;null!=zc.zpp_pool;){var oe=zc.zpp_pool.next;zc.zpp_pool.next=null,zc.zpp_pool=oe}for(;null!=su.zpp_pool;){var _e=su.zpp_pool.next;su.zpp_pool.next=null,su.zpp_pool=_e}for(;null!=Zu.zpp_pool;){var pe=Zu.zpp_pool.next;Zu.zpp_pool.next=null,Zu.zpp_pool=pe}for(;null!=Bh.zpp_pool;){var ue=Bh.zpp_pool.next;Bh.zpp_pool.next=null,Bh.zpp_pool=ue}for(;null!=Lh.zpp_pool;){var he=Lh.zpp_pool.next;Lh.zpp_pool.next=null,Lh.zpp_pool=he}for(;null!=jh.zpp_pool;){var ce=jh.zpp_pool.next;jh.zpp_pool.next=null,jh.zpp_pool=ce}for(;null!=Su.zpp_pool;){var de=Su.zpp_pool.next;Su.zpp_pool.next=null,Su.zpp_pool=de}for(;null!=Fh.zpp_pool;){var me=Fh.zpp_pool.next;Fh.zpp_pool.next=null,Fh.zpp_pool=me}for(;null!=Rh.zpp_pool;){var fe=Rh.zpp_pool.next;Rh.zpp_pool.next=null,Rh.zpp_pool=fe}for(;null!=Lu.zpp_pool;){var ge=Lu.zpp_pool.next;Lu.zpp_pool.next=null,Lu.zpp_pool=ge}for(;null!=Pu.zpp_pool;){var ve=Pu.zpp_pool.next;Pu.zpp_pool.next=null,Pu.zpp_pool=ve}for(;null!=Mu.zpp_pool;){var be=Mu.zpp_pool.next;Mu.zpp_pool.next=null,Mu.zpp_pool=be}for(;null!=Dp.zpp_pool;){var ye=Dp.zpp_pool.next;Dp.zpp_pool.next=null,Dp.zpp_pool=ye}for(;null!=Gh.zpp_pool;){var xe=Gh.zpp_pool.next;Gh.zpp_pool.next=null,Gh.zpp_pool=xe}for(;null!=Zh.zpp_pool;){var ze=Zh.zpp_pool.next;Zh.zpp_pool.next=null,Zh.zpp_pool=ze}for(;null!=Au.zpp_pool;){var we=Au.zpp_pool.next;Au.zpp_pool.next=null,Au.zpp_pool=we}for(;null!=Du.zpp_pool;){var ke=Du.zpp_pool.next;Du.zpp_pool.next=null,Du.zpp_pool=ke}for(;null!=Eu.zpp_pool;){var Se=Eu.zpp_pool.next;Eu.zpp_pool.next=null,Eu.zpp_pool=Se}for(;null!=wc.zpp_pool;){var Ce=wc.zpp_pool.next;wc.zpp_pool.next=null,wc.zpp_pool=Ce}for(;null!=Uh.zpp_pool;){var Ne=Uh.zpp_pool.next;Uh.zpp_pool.next=null,Uh.zpp_pool=Ne}for(;null!=Vh.zpp_pool;){var Pe=Vh.zpp_pool.next;Vh.zpp_pool.next=null,Vh.zpp_pool=Pe}for(;null!=ki.zpp_pool;){var Me=ki.zpp_pool.next;ki.zpp_pool.next=null,ki.zpp_pool=Me}for(;null!=qh.zpp_pool;){var Ie=qh.zpp_pool.next;qh.zpp_pool.next=null,qh.zpp_pool=Ie}for(;null!=Wh.zpp_pool;){var Te=Wh.zpp_pool.next;Wh.zpp_pool.next=null,Wh.zpp_pool=Te}for(;null!=Xh.zpp_pool;){var Ae=Xh.zpp_pool.next;Xh.zpp_pool.next=null,Xh.zpp_pool=Ae}for(;null!=Ip.zpp_pool;){var De=Ip.zpp_pool.next;Ip.zpp_pool.next=null,Ip.zpp_pool=De}for(;null!=Tp.zpp_pool;){var Ee=Tp.zpp_pool.next;Tp.zpp_pool.next=null,Tp.zpp_pool=Ee}for(;null!=Hh.zpp_pool;){var Oe=Hh.zpp_pool.next;Hh.zpp_pool.next=null,Hh.zpp_pool=Oe}for(;null!=Ap.zpp_pool;){var Be=Ap.zpp_pool.next;Ap.zpp_pool.next=null,Ap.zpp_pool=Be}for(;null!=Yh.zpp_pool;){var Le=Yh.zpp_pool.next;Yh.zpp_pool.next=null,Yh.zpp_pool=Le}for(;null!=Jh.zpp_pool;){var je=Jh.zpp_pool.next;Jh.zpp_pool.next=null,Jh.zpp_pool=je}for(;null!=Kh.zpp_pool;){var Fe=Kh.zpp_pool.next;Kh.zpp_pool.next=null,Kh.zpp_pool=Fe}for(;null!=mc.poolGeomPoly;){var Re=mc.poolGeomPoly.zpp_pool;mc.poolGeomPoly.zpp_pool=null,mc.poolGeomPoly=Re}for(;null!=mc.poolVec2;){var Ge=mc.poolVec2.zpp_pool;mc.poolVec2.zpp_pool=null,mc.poolVec2=Ge}for(;null!=mc.poolVec3;){var Ze=mc.poolVec3.zpp_pool;mc.poolVec3.zpp_pool=null,mc.poolVec3=Ze}};var Q_=function(){};(n["pixi.core.renderers.webgl.filters.CurrentState"]=Q_).__name__=["pixi","core","renderers","webgl","filters","CurrentState"],Q_.prototype={destinationFrame:null,filters:null,renderTarget:null,resolution:null,sourceFrame:null,target:null,__class__:Q_};var $_=function(){};(n["zpp_nape.ZPP_Const"]=$_).__name__=["zpp_nape","ZPP_Const"],$_.POSINF=function(){return 1/0},$_.NEGINF=function(){return-1/0};var ep=function(){};(n["zpp_nape.ZPP_ID"]=ep).__name__=["zpp_nape","ZPP_ID"],ep.Constraint=function(){return ep._Constraint++},ep.Interactor=function(){return ep._Interactor++},ep.CbType=function(){return ep._CbType++},ep.CbSet=function(){return ep._CbSet++},ep.Listener=function(){return ep._Listener++},ep.ZPP_SimpleVert=function(){return ep._ZPP_SimpleVert++},ep.ZPP_SimpleSeg=function(){return ep._ZPP_SimpleSeg++},ep.Space=function(){return ep._Space++},ep.InteractionGroup=function(){return ep._InteractionGroup++};var tp=function(){this.constraint=null,this.body=null,this.pre_swapped=!1,this.pre_arbiter=null,this.wrap_arbiters=null,this.set=null,this.int2=null,this.int1=null,this.length=0,this.prev=null,this.next=null,this.index=0,this.space=null,this.listener=null,this.event=0,this.outer_int=null,this.outer_con=null,this.outer_body=null,this.length=0};(n["zpp_nape.callbacks.ZPP_Callback"]=tp).__name__=["zpp_nape","callbacks","ZPP_Callback"],tp.prototype={outer_body:null,outer_con:null,outer_int:null,wrapper_body:function(){return null==this.outer_body&&(this.outer_body=new fo,this.outer_body.zpp_inner=this),this.outer_body},wrapper_con:function(){return null==this.outer_con&&(this.outer_con=new wo,this.outer_con.zpp_inner=this),this.outer_con},wrapper_int:function(){return null==this.outer_int&&(this.outer_int=new So,this.outer_int.zpp_inner=this),this.genarbs(),this.outer_int},event:null,listener:null,space:null,index:null,next:null,prev:null,length:null,push:function(e){null!=this.prev?this.prev.next=e:this.next=e,e.prev=this.prev,e.next=null,this.prev=e,this.length++},push_rev:function(e){null!=this.next?this.next.prev=e:this.prev=e,e.next=this.next,e.prev=null,this.next=e,this.length++},pop:function(){var e=this.next;return this.next=e.next,null==this.next?this.prev=null:this.next.prev=null,this.length--,e},pop_rev:function(){var e=this.prev;return this.prev=e.prev,null==this.prev?this.next=null:this.prev.next=null,this.length--,e},empty:function(){return null==this.next},clear:function(){for(;!this.empty();)this.pop()},splice:function(e){var t=e.next;return null==e.prev?(this.next=e.next,null!=this.next?this.next.prev=null:this.prev=null):(e.prev.next=e.next,null!=e.next?e.next.prev=e.prev:this.prev=e.prev),this.length--,t},rotateL:function(){this.push(this.pop())},rotateR:function(){this.push_rev(this.pop_rev())},cycleNext:function(e){return null==e.next?this.next:e.next},cyclePrev:function(e){return null==e.prev?this.prev:e.prev},at:function(e){for(var t=this.next;0!=e--;)t=t.next;return t},rev_at:function(e){for(var t=this.prev;0!=e--;)t=t.prev;return t},free:function(){this.int1=this.int2=null,this.body=null,this.constraint=null,(this.listener=null)!=this.wrap_arbiters&&(this.wrap_arbiters.zpp_inner.inner=null),this.set=null},alloc:function(){},int1:null,int2:null,set:null,wrap_arbiters:null,pre_arbiter:null,pre_swapped:null,genarbs:function(){null==this.wrap_arbiters?this.wrap_arbiters=hc.get(this.set.arbiters,!0):this.wrap_arbiters.zpp_inner.inner=this.set.arbiters,this.wrap_arbiters.zpp_inner.zip_length=!0,this.wrap_arbiters.zpp_inner.at_ite=null},body:null,constraint:null,__class__:tp};var np=function(){this.wrap_constraints=null,this.constraints=null,this.wrap_interactors=null,this.interactors=null,this.zip_conlisteners=!1,this.conlisteners=null,this.zip_bodylisteners=!1,this.bodylisteners=null,this.zip_listeners=!1,this.listeners=null,this.cbpairs=null,this.manager=null,this.id=0,this.next=null,this.count=0,this.cbTypes=null,this.cbTypes=new mp,this.listeners=new rp,this.zip_listeners=!0,this.bodylisteners=new ap,this.zip_bodylisteners=!0,this.conlisteners=new sp,this.zip_conlisteners=!0,this.constraints=new lp,this.interactors=new op,this.id=ep.CbSet(),this.cbpairs=new Yu};(n["zpp_nape.callbacks.ZPP_CbSet"]=np).__name__=["zpp_nape","callbacks","ZPP_CbSet"],np.setlt=function(e,t){for(var n=e.cbTypes.begin(),i=t.cbTypes.begin();null!=n&&null!=i;){var r=n.elem(),a=i.elem();if(pp.setlt(r,a))return!0;if(pp.setlt(a,r))return!1;n=n.next,i=i.next}return null!=i&&null==n},np.get=function(e){var t;null==np.zpp_pool?t=new np:(t=np.zpp_pool,np.zpp_pool=t.next,t.next=null),t.alloc();for(var n=null,i=e.begin();null!=i;){var r=i.elem();n=t.cbTypes.insert(n,r),r.cbsets.add(t),i=i.next}return t},np.compatible=function(e,t,n){return!(!e.options1.compatible(t.cbTypes)||!e.options2.compatible(n.cbTypes))||!!e.options2.compatible(t.cbTypes)&&e.options1.compatible(n.cbTypes)},np.empty_intersection=function(e,t){return e.manager.pair(e,t).empty_intersection()},np.single_intersection=function(e,t,n){return e.manager.pair(e,t).single_intersection(n)},np.find_all=function(e,t,n,i){e.manager.pair(e,t).forall(n,i)},np.prototype={cbTypes:null,count:null,next:null,id:null,manager:null,cbpairs:null,increment:function(){this.count++},decrement:function(){return 0==--this.count},invalidate_pairs:function(){for(var e=this.cbpairs.begin();null!=e;)e.elem().invalidate(),e=e.next},listeners:null,zip_listeners:null,invalidate_listeners:function(){this.zip_listeners=!0,this.invalidate_pairs()},validate_listeners:function(){this.zip_listeners&&(this.zip_listeners=!1,this.realvalidate_listeners())},realvalidate_listeners:function(){this.listeners.clear();for(var e=this.cbTypes.begin();null!=e;){for(var t=e.elem(),n=null,i=this.listeners.begin(),r=t.listeners.begin();null!=r;){var a=r.elem();null!=i&&i.elem()==a?(r=r.next,i=(n=i).next):null==i||hp.setlt(a,i.elem())?(this.manager.valid_listener(a)&&(n=this.listeners.inlined_insert(n,a)),r=r.next):i=(n=i).next}e=e.next}},bodylisteners:null,zip_bodylisteners:null,invalidate_bodylisteners:function(){this.zip_bodylisteners=!0},validate_bodylisteners:function(){this.zip_bodylisteners&&(this.zip_bodylisteners=!1,this.realvalidate_bodylisteners())},realvalidate_bodylisteners:function(){this.bodylisteners.clear();for(var e=this.cbTypes.begin();null!=e;){for(var t=e.elem(),n=null,i=this.bodylisteners.begin(),r=t.bodylisteners.begin();null!=r;){var a=r.elem();null!=i&&i.elem()==a?(r=r.next,i=(n=i).next):null==i||hp.setlt(a,i.elem())?(!a.options.excluded(this.cbTypes)&&this.manager.valid_listener(a)&&(n=this.bodylisteners.inlined_insert(n,a)),r=r.next):i=(n=i).next}e=e.next}},conlisteners:null,zip_conlisteners:null,invalidate_conlisteners:function(){this.zip_conlisteners=!0},validate_conlisteners:function(){this.zip_conlisteners&&(this.zip_conlisteners=!1,this.realvalidate_conlisteners())},realvalidate_conlisteners:function(){this.conlisteners.clear();for(var e=this.cbTypes.begin();null!=e;){for(var t=e.elem(),n=null,i=this.conlisteners.begin(),r=t.conlisteners.begin();null!=r;){var a=r.elem();null!=i&&i.elem()==a?(r=r.next,i=(n=i).next):null==i||hp.setlt(a,i.elem())?(!a.options.excluded(this.cbTypes)&&this.manager.valid_listener(a)&&(n=this.conlisteners.inlined_insert(n,a)),r=r.next):i=(n=i).next}e=e.next}},validate:function(){this.validate_listeners(),this.validate_bodylisteners(),this.validate_conlisteners()},interactors:null,wrap_interactors:null,constraints:null,wrap_constraints:null,addConstraint:function(e){this.constraints.add(e)},addInteractor:function(e){this.interactors.add(e)},remConstraint:function(e){this.constraints.remove(e)},remInteractor:function(e){this.interactors.remove(e)},free:function(){for(this.listeners.clear(),this.zip_listeners=!0,this.bodylisteners.clear(),this.zip_bodylisteners=!0,this.conlisteners.clear(),this.zip_conlisteners=!0;!this.cbTypes.empty();)this.cbTypes.pop_unsafe().cbsets.remove(this)},alloc:function(){},__class__:np};var ip=function(){this.listeners=null,this.zip_listeners=!1,this.next=null,this.b=null,this.a=null,this.listeners=new rp};(n["zpp_nape.callbacks.ZPP_CbSetPair"]=ip).__name__=["zpp_nape","callbacks","ZPP_CbSetPair"],ip.get=function(e,t){var n;return null==ip.zpp_pool?n=new ip:(n=ip.zpp_pool,ip.zpp_pool=n.next,n.next=null),n.alloc(),np.setlt(e,t)?(n.a=e,n.b=t):(n.a=t,n.b=e),n},ip.setlt=function(e,t){return!!np.setlt(e.a,t.a)||e.a==t.a&&np.setlt(e.b,t.b)},ip.prototype={a:null,b:null,next:null,free:function(){this.a=this.b=null,this.listeners.clear()},alloc:function(){this.zip_listeners=!0},compatible:function(e){return!(!e.options1.compatible(this.a.cbTypes)||!e.options2.compatible(this.b.cbTypes))||!!e.options2.compatible(this.a.cbTypes)&&e.options1.compatible(this.b.cbTypes)},zip_listeners:null,listeners:null,invalidate:function(){this.zip_listeners=!0},validate:function(){this.zip_listeners&&(this.zip_listeners=!1,this.__validate())},__validate:function(){this.listeners.clear();for(var e=this.a.listeners.begin(),t=this.b.listeners.begin();null!=e&&null!=t;){var n=e.elem(),i=t.elem();n==i?(this.compatible(n)&&this.listeners.add(n),e=e.next,t=t.next):hp.setlt(n,i)?e=e.next:t=t.next}},empty_intersection:function(){return this.listeners.empty()},single_intersection:function(e){var t=this.listeners.begin();return null!=t&&t.elem()==e&&null==t.next},forall:function(e,t){for(var n=this.listeners.begin();null!=n;){var i=n.elem();i.event==e&&t(i),n=n.next}},__class__:ip};var rp=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_InteractionListener"]=rp).__name__=["zpp_nape","util","ZNPList_ZPP_InteractionListener"],rp.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==wh.zpp_pool?t=new wh:(t=wh.zpp_pool,wh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==wh.zpp_pool?n=new wh:(n=wh.zpp_pool,wh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=wh.zpp_pool,wh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=wh.zpp_pool,wh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:rp};var ap=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_BodyListener"]=ap).__name__=["zpp_nape","util","ZNPList_ZPP_BodyListener"],ap.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Ch.zpp_pool?t=new Ch:(t=Ch.zpp_pool,Ch.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Ch.zpp_pool?n=new Ch:(n=Ch.zpp_pool,Ch.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Ch.zpp_pool,Ch.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Ch.zpp_pool,Ch.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:ap};var sp=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_ConstraintListener"]=sp).__name__=["zpp_nape","util","ZNPList_ZPP_ConstraintListener"],sp.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Ph.zpp_pool?t=new Ph:(t=Ph.zpp_pool,Ph.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Ph.zpp_pool?n=new Ph:(n=Ph.zpp_pool,Ph.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Ph.zpp_pool,Ph.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Ph.zpp_pool,Ph.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:sp};var lp=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Constraint"]=lp).__name__=["zpp_nape","util","ZNPList_ZPP_Constraint"],lp.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==xh.zpp_pool?t=new xh:(t=xh.zpp_pool,xh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==xh.zpp_pool?n=new xh:(n=xh.zpp_pool,xh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=xh.zpp_pool,xh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=xh.zpp_pool,xh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:lp};var op=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Interactor"]=op).__name__=["zpp_nape","util","ZNPList_ZPP_Interactor"],op.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Sh.zpp_pool?t=new Sh:(t=Sh.zpp_pool,Sh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Sh.zpp_pool?n=new Sh:(n=Sh.zpp_pool,Sh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Sh.zpp_pool,Sh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Sh.zpp_pool,Sh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:op};var _p=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_CbSet"]=_p).__name__=["zpp_nape","util","ZNPList_ZPP_CbSet"],_p.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==kh.zpp_pool?t=new kh:(t=kh.zpp_pool,kh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==kh.zpp_pool?n=new kh:(n=kh.zpp_pool,kh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=kh.zpp_pool,kh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=kh.zpp_pool,kh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:_p};var pp=function(){this.conlisteners=null,this.bodylisteners=null,this.listeners=null,this.cbsets=null,this.id=0,this.userData=null,this.outer=null,this.id=ep.CbType(),this.listeners=new rp,this.bodylisteners=new ap,this.conlisteners=new sp,this.constraints=new lp,this.interactors=new op,this.cbsets=new _p};(n["zpp_nape.callbacks.ZPP_CbType"]=pp).__name__=["zpp_nape","callbacks","ZPP_CbType"],pp.setlt=function(e,t){return e.id<t.id},pp.prototype={outer:null,userData:null,id:null,cbsets:null,interactors:null,wrap_interactors:null,constraints:null,wrap_constraints:null,addConstraint:function(e){this.constraints.add(e)},addInteractor:function(e){this.interactors.add(e)},remConstraint:function(e){this.constraints.remove(e)},remInteractor:function(e){this.interactors.remove(e)},listeners:null,addint:function(e){for(var t=null,n=this.listeners.begin();null!=n;){var i=n.elem();if(hp.setlt(e,i))break;n=(t=n).next}this.listeners.inlined_insert(t,e),this.invalidateint()},removeint:function(e){this.listeners.remove(e),this.invalidateint()},invalidateint:function(){for(var e=this.cbsets.begin();null!=e;)e.elem().invalidate_listeners(),e=e.next},bodylisteners:null,addbody:function(e){for(var t=null,n=this.bodylisteners.begin();null!=n;){var i=n.elem();if(hp.setlt(e,i))break;n=(t=n).next}this.bodylisteners.inlined_insert(t,e),this.invalidatebody()},removebody:function(e){this.bodylisteners.remove(e),this.invalidatebody()},invalidatebody:function(){for(var e=this.cbsets.begin();null!=e;)e.elem().invalidate_bodylisteners(),e=e.next},conlisteners:null,addconstraint:function(e){for(var t=null,n=this.conlisteners.begin();null!=n;){var i=n.elem();if(hp.setlt(e,i))break;n=(t=n).next}this.conlisteners.inlined_insert(t,e),this.invalidateconstraint()},removeconstraint:function(e){this.conlisteners.remove(e),this.invalidateconstraint()},invalidateconstraint:function(){for(var e=this.cbsets.begin();null!=e;)e.elem().invalidate_conlisteners(),e=e.next},__class__:pp};var up=function(){};(n["zpp_nape.util.ZPP_Flags"]=up).__name__=["zpp_nape","util","ZPP_Flags"];var hp=function(){this.space=null,this.interaction=null,this.constraint=null,this.body=null,this.precedence=0,this.event=0,this.type=0,this.id=0,this.outer=null,this.id=ep.Listener()};(n["zpp_nape.callbacks.ZPP_Listener"]=hp).__name__=["zpp_nape","callbacks","ZPP_Listener"],hp.setlt=function(e,t){return!(e.precedence<=t.precedence)||e.precedence==t.precedence&&e.id>t.id},hp.prototype={outer:null,id:null,type:null,event:null,precedence:null,body:null,constraint:null,interaction:null,space:null,swapEvent:function(e){},invalidate_precedence:function(){},addedToSpace:function(){},removedFromSpace:function(){},__class__:hp};var cp=function(e,t,n){this.handler=null,this.options=null,this.outer_zn=null,hp.call(this),this.event=t,this.handler=n,(this.body=this).type=0,this.options=e.zpp_inner};(n["zpp_nape.callbacks.ZPP_BodyListener"]=cp).__name__=["zpp_nape","callbacks","ZPP_BodyListener"],cp.__super__=hp,cp.prototype=r(hp.prototype,{outer_zn:null,options:null,handler:null,addedToSpace:function(){this.options.handler=Cc(this,this.cbtype_change);for(var e=this.options.includes.begin();null!=e;)e.elem().addbody(this),e=e.next},removedFromSpace:function(){for(var e=this.options.includes.begin();null!=e;)e.elem().removebody(this),e=e.next;this.options.handler=null},cbtype_change:function(e,t,n){this.removedFromSpace(),this.options.effect_change(e,t,n),this.addedToSpace()},invalidate_precedence:function(){null!=this.space&&(this.removedFromSpace(),this.addedToSpace())},swapEvent:function(e){this.removedFromSpace(),this.event=e,this.addedToSpace()},__class__:cp});var dp=function(e,t,n){this.handler=null,this.options=null,this.outer_zn=null,hp.call(this),this.event=t,this.handler=n,(this.constraint=this).type=1,this.options=e.zpp_inner};(n["zpp_nape.callbacks.ZPP_ConstraintListener"]=dp).__name__=["zpp_nape","callbacks","ZPP_ConstraintListener"],dp.__super__=hp,dp.prototype=r(hp.prototype,{outer_zn:null,options:null,handler:null,addedToSpace:function(){this.options.handler=Cc(this,this.cbtype_change);for(var e=this.options.includes.begin();null!=e;)e.elem().addconstraint(this),e=e.next},removedFromSpace:function(){for(var e=this.options.includes.begin();null!=e;)e.elem().removeconstraint(this),e=e.next;this.options.handler=null},cbtype_change:function(e,t,n){this.removedFromSpace(),this.options.effect_change(e,t,n),this.addedToSpace()},invalidate_precedence:function(){null!=this.space&&(this.removedFromSpace(),this.addedToSpace())},swapEvent:function(e){this.removedFromSpace(),this.event=e,this.addedToSpace()},__class__:dp});var mp=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_CbType"]=mp).__name__=["zpp_nape","util","ZNPList_ZPP_CbType"],mp.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==gh.zpp_pool?t=new gh:(t=gh.zpp_pool,gh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==gh.zpp_pool?n=new gh:(n=gh.zpp_pool,gh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=gh.zpp_pool,gh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=gh.zpp_pool,gh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:mp};var fp=function(e,t,n,i){this.handlerp=null,this.pure=!1,this.allowSleepingCallbacks=!1,this.handleri=null,this.options2=null,this.options1=null,this.itype=0,this.outer_znp=null,this.outer_zni=null,hp.call(this),this.type=i,(this.interaction=this).event=n,this.options1=e.zpp_inner,this.options2=t.zpp_inner,this.allowSleepingCallbacks=!1};(n["zpp_nape.callbacks.ZPP_InteractionListener"]=fp).__name__=["zpp_nape","callbacks","ZPP_InteractionListener"],fp.__super__=hp,fp.prototype=r(hp.prototype,{outer_zni:null,outer_znp:null,itype:null,options1:null,options2:null,handleri:null,allowSleepingCallbacks:null,pure:null,handlerp:null,setInteractionType:function(e){this.itype=e},wake:function(){this.with_union(function(e){for(var t=e.interactors.begin();null!=t;)t.elem().wake(),t=t.next})},CbSetset:function(e,t,n){for(var i=fp.UCbSet,r=fp.VCbSet,a=fp.WCbSet,s=e.begin(),l=t.begin();null!=s&&null!=l;){var o=s.elem(),_=l.elem();o==_?(a.inlined_add(o),s=s.next,l=l.next):np.setlt(o,_)?(i.inlined_add(o),s=s.next):(r.inlined_add(_),l=l.next)}for(;null!=s;)i.inlined_add(s.elem()),s=s.next;for(;null!=l;)r.inlined_add(l.elem()),l=l.next;for(;!i.empty();)for(var p=i.pop_unsafe(),u=t.begin();null!=u;)n(p,u.elem()),u=u.next;for(;!r.empty();)for(var h=r.pop_unsafe(),c=a.begin();null!=c;)n(h,c.elem()),c=c.next;for(;!a.empty();){var d=a.pop_unsafe();n(d,d);for(var m=a.begin();null!=m;)n(d,m.elem()),m=m.next}},CbTypeset:function(e,t,n){for(var i=fp.UCbType,r=fp.VCbType,a=fp.WCbType,s=e.begin(),l=t.begin();null!=s&&null!=l;){var o=s.elem(),_=l.elem();o==_?(a.inlined_add(o),s=s.next,l=l.next):pp.setlt(o,_)?(i.inlined_add(o),s=s.next):(r.inlined_add(_),l=l.next)}for(;null!=s;)i.inlined_add(s.elem()),s=s.next;for(;null!=l;)r.inlined_add(l.elem()),l=l.next;for(;!i.empty();)for(var p=i.pop_unsafe(),u=t.begin();null!=u;)n(p,u.elem()),u=u.next;for(;!r.empty();)for(var h=r.pop_unsafe(),c=a.begin();null!=c;)n(h,c.elem()),c=c.next;for(;!a.empty();){var d=a.pop_unsafe();n(d,d);for(var m=a.begin();null!=m;)n(d,m.elem()),m=m.next}},with_uniquesets:function(e){var t,n=this;null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.lt=ip.setlt,this.CbTypeset(this.options1.includes,this.options2.includes,function(e,i){n.CbSetset(e.cbsets,i.cbsets,function(e,i){if(e.validate(),i.validate(),np.single_intersection(e,i,n)){var r=ip.get(e,i);t.try_insert(r)}})}),t.clear_with(function(t){e?n.space.freshListenerType(t.a,t.b):n.space.nullListenerType(t.a,t.b);var i=t;i.free(),i.next=ip.zpp_pool,ip.zpp_pool=i});var i=t;i.free(),i.next=gc.zpp_pool,gc.zpp_pool=i},with_union:function(e){for(var t=this.options1.includes.begin(),n=this.options2.includes.begin();null!=t&&null!=n;){var i=t.elem(),r=n.elem();i==r?(e(i),t=t.next,n=n.next):pp.setlt(i,r)?(e(i),t=t.next):(e(r),n=n.next)}for(;null!=t;)e(t.elem()),t=t.next;for(;null!=n;)e(n.elem()),n=n.next},addedToSpace:function(){var e=this,t=3==this.type;this.with_union(function(n){if(n.addint(e),t)for(var i=n.interactors.begin();null!=i;)i.elem().wake(),i=i.next}),this.options1.handler=Cc(this,this.cbtype_change1),this.options2.handler=Cc(this,this.cbtype_change2),this.with_uniquesets(!0)},removedFromSpace:function(){var e=this;this.with_uniquesets(!1);var t=3==this.type;this.with_union(function(n){if(n.removeint(e),t)for(var i=n.interactors.begin();null!=i;)i.elem().wake(),i=i.next}),this.options1.handler=null,this.options2.handler=null},invalidate_precedence:function(){var e=this;if(null!=this.space){var t=3==this.type;this.with_union(function(n){if(n.removeint(e),n.addint(e),t)for(var i=n.interactors.begin();null!=i;)i.elem().wake(),i=i.next})}},cbtype_change1:function(e,t,n){this.cbtype_change(this.options1,e,t,n)},cbtype_change2:function(e,t,n){this.cbtype_change(this.options2,e,t,n)},cbtype_change:function(e,t,n,i){this.space.revoke_listener(this),this.removedFromSpace(),e.effect_change(t,n,i),this.addedToSpace(),this.space.unrevoke_listener(this)},swapEvent:function(e){this.removedFromSpace(),this.event=e,this.addedToSpace()},__class__:fp});var gp=function(){this.wrap_excludes=null,this.wrap_includes=null,this.excludes=null,this.includes=null,this.handler=null,this.outer=null,this.includes=new mp,this.excludes=new mp};(n["zpp_nape.callbacks.ZPP_OptionType"]=gp).__name__=["zpp_nape","callbacks","ZPP_OptionType"],gp.argument=function(e){return null==e?new To:p.is(e,To)?e:(new To).including(e)},gp.prototype={outer:null,handler:null,includes:null,excludes:null,wrap_includes:null,wrap_excludes:null,setup_includes:function(){this.wrap_includes=rc.get(this.includes,!0)},setup_excludes:function(){this.wrap_excludes=rc.get(this.excludes,!0)},excluded:function(e){return this.nonemptyintersection(e,this.excludes)},included:function(e){return this.nonemptyintersection(e,this.includes)},compatible:function(e){return!!this.included(e)&&!this.excluded(e)},nonemptyintersection:function(e,t){for(var n=!1,i=e.begin(),r=t.begin();null!=r&&null!=i;){var a=r.elem(),s=i.elem();if(a==s){n=!0;break}pp.setlt(a,s)?r=r.next:i=i.next}return n},effect_change:function(e,t,n){if(t)if(n){for(var i=null,r=this.includes.begin();null!=r;){var a=r.elem();if(pp.setlt(e,a))break;r=(i=r).next}this.includes.inlined_insert(i,e)}else this.includes.remove(e);else if(n){for(var s=null,l=this.excludes.begin();null!=l;){var o=l.elem();if(pp.setlt(e,o))break;l=(s=l).next}this.excludes.inlined_insert(s,e)}else this.excludes.remove(e)},append_type:function(e,t){e==this.includes?this.includes.has(t)||(this.excludes.has(t)?null!=this.handler?this.handler(t,!1,!1):this.effect_change(t,!1,!1):null!=this.handler?this.handler(t,!0,!0):this.effect_change(t,!0,!0)):this.excludes.has(t)||(this.includes.has(t)?null!=this.handler?this.handler(t,!0,!1):this.effect_change(t,!0,!1):null!=this.handler?this.handler(t,!1,!0):this.effect_change(t,!1,!0))},set:function(e){if(e!=this){for(;!this.includes.empty();)this.append_type(this.excludes,this.includes.front());for(;!this.excludes.empty();)this.append_type(this.includes,this.excludes.front());for(var t=e.excludes.begin();null!=t;){var n=t.elem();this.append_type(this.excludes,n),t=t.next}for(var i=e.includes.begin();null!=i;){var r=i.elem();this.append_type(this.includes,r),i=i.next}}return this},append:function(e,t){if(p.is(t,yo)){var n=t;this.append_type(e,n.zpp_inner)}else if(p.is(t,zo))for(var i=t.iterator();i.hasNext();){var r=i.next();this.append_type(e,r.zpp_inner)}else if(t instanceof Array&&null==t.__enum__)for(var a=t,s=0;s<a.length;){var l=a[s];++s;var o=l;this.append_type(e,o.zpp_inner)}},__class__:gp};var vp=function(){this.pre_dt=0,this.wrap_cbTypes=null,this.cbSet=null,this.cbTypes=null,this.__velocity=!1,this.ignore=!1,this.component=null,this.removeOnBreak=!1,this.breakUnderError=!1,this.breakUnderForce=!1,this.maxError=0,this.maxForce=0,this.damping=0,this.frequency=0,this.stiff=!1,this.active=!1,this.space=null,this.compound=null,this.userData=null,this.id=0,this.outer=null,this.__velocity=!1,this.id=ep.Constraint(),this.stiff=!0,this.active=!0,this.ignore=!1,this.frequency=10,this.damping=1,this.maxForce=$_.POSINF(),this.maxError=$_.POSINF(),this.breakUnderForce=!1,this.removeOnBreak=!0,this.pre_dt=-1,this.cbTypes=new mp};(n["zpp_nape.constraint.ZPP_Constraint"]=vp).__name__=["zpp_nape","constraint","ZPP_Constraint"],vp.prototype={outer:null,clear:function(){},id:null,userData:null,compound:null,space:null,active:null,stiff:null,frequency:null,damping:null,maxForce:null,maxError:null,breakUnderForce:null,breakUnderError:null,removeOnBreak:null,component:null,ignore:null,__velocity:null,immutable_midstep:function(e){},cbTypes:null,cbSet:null,wrap_cbTypes:null,setupcbTypes:function(){this.wrap_cbTypes=rc.get(this.cbTypes),this.wrap_cbTypes.zpp_inner.adder=Cc(this,this.wrap_cbTypes_adder),this.wrap_cbTypes.zpp_inner.subber=Cc(this,this.wrap_cbTypes_subber),this.wrap_cbTypes.zpp_inner.dontremove=!0},wrap_cbTypes_subber:function(e){var t=e.zpp_inner;this.cbTypes.has(t)&&(null!=this.space&&(this.dealloc_cbSet(),t.remConstraint(this)),this.cbTypes.remove(t),null!=this.space&&(this.alloc_cbSet(),this.wake()))},wrap_cbTypes_adder:function(e){return this.insert_cbtype(e.zpp_inner),!1},insert_cbtype:function(e){if(!this.cbTypes.has(e)){null!=this.space&&(this.dealloc_cbSet(),e.addConstraint(this));for(var t=null,n=this.cbTypes.begin();null!=n;){var i=n.elem();if(pp.setlt(e,i))break;n=(t=n).next}this.cbTypes.inlined_insert(t,e),null!=this.space&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){null!=(this.cbSet=this.space.cbsets.get(this.cbTypes))&&(this.cbSet.increment(),this.cbSet.addConstraint(this))},dealloc_cbSet:function(){if(null!=this.cbSet){if(this.cbSet.remConstraint(this),this.cbSet.decrement()){this.space.cbsets.remove(this.cbSet);var e=this.cbSet;e.free(),e.next=np.zpp_pool,np.zpp_pool=e}this.cbSet=null}},activate:function(){null!=this.space&&this.activeInSpace()},deactivate:function(){null!=this.space&&this.inactiveOrOutSpace()},addedToSpace:function(){this.active&&this.activeInSpace(),this.activeBodies();for(var e=this.cbTypes.begin();null!=e;)e.elem().addConstraint(this),e=e.next},removedFromSpace:function(){this.active&&this.inactiveOrOutSpace(),this.inactiveBodies();for(var e=this.cbTypes.begin();null!=e;)e.elem().remConstraint(this),e=e.next},activeInSpace:function(){this.alloc_cbSet(),null==Du.zpp_pool?this.component=new Du:(this.component=Du.zpp_pool,Du.zpp_pool=this.component.next,this.component.next=null),this.component.alloc(),this.component.isBody=!1,this.component.constraint=this},inactiveOrOutSpace:function(){this.dealloc_cbSet();var e=this.component;e.free(),e.next=Du.zpp_pool,Du.zpp_pool=e,this.component=null},activeBodies:function(){},inactiveBodies:function(){},clearcache:function(){},validate:function(){},wake_connected:function(){},forest:function(){},pair_exists:function(e,t){return!1},broken:function(){},warmStart:function(){},pre_dt:null,preStep:function(e){return!1},applyImpulseVel:function(){return!1},applyImpulsePos:function(){return!1},wake:function(){null!=this.space&&this.space.wake_constraint(this)},draw:function(e){},copy:function(e,t){return null},copyto:function(e){for(var t=this.outer,n=t.get_cbTypes().iterator();n.hasNext();){var i=n.next();e.get_cbTypes().add(i)}e.set_removeOnBreak(t.get_removeOnBreak()),e.set_breakUnderError(t.get_breakUnderError()),e.set_breakUnderForce(t.get_breakUnderForce()),e.set_maxError(t.get_maxError()),e.set_maxForce(t.get_maxForce()),e.set_damping(t.get_damping()),e.set_frequency(t.get_frequency()),e.set_stiff(t.get_stiff()),e.set_ignore(t.get_ignore()),e.set_active(t.get_active())},__class__:vp};var bp=function(){this.stepped=!1,this.bias=0,this.gamma=0,this.jMax=0,this.jAcc=0,this.kMass=0,this.b2=null,this.b1=null,this.scale=0,this.equal=!1,this.slack=!1,this.jointMax=0,this.jointMin=0,this.ratio=0,this.outer_zn=null,vp.call(this),this.ratio=1,this.jAcc=0,this.slack=!1,this.jMax=$_.POSINF(),this.stepped=!1};(n["zpp_nape.constraint.ZPP_AngleJoint"]=bp).__name__=["zpp_nape","constraint","ZPP_AngleJoint"],bp.__super__=vp,bp.prototype=r(vp.prototype,{outer_zn:null,ratio:null,jointMin:null,jointMax:null,slack:null,equal:null,scale:null,is_slack:function(){var e,t=this.ratio*this.b2.rot-this.b1.rot;return this.equal?(t-=this.jointMax,e=!1,this.scale=1):e=t<this.jointMin?(t=this.jointMin-t,!(this.scale=-1)):t>this.jointMax?(t-=this.jointMax,!(this.scale=1)):!(t=this.scale=0),e},bodyImpulse:function(e){return this.stepped?e==this.b1?w_.get(0,0,-this.scale*this.jAcc):w_.get(0,0,this.ratio*this.scale*this.jAcc):w_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},b1:null,b2:null,kMass:null,jAcc:null,jMax:null,gamma:null,bias:null,stepped:null,copy:function(e,t){var n=new Bo(null,null,this.jointMin,this.jointMax,this.ratio);if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(yp.todo(this.b1.id,function(e){n.zpp_inner_zn.b1=e.zpp_inner}))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(yp.todo(this.b2.id,function(e){n.zpp_inner_zn.b2=e.zpp_inner}))}return n},validate:function(){if(null==this.b1||null==this.b2)throw new ao("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new ao("Error: AngleJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new ao("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new ao("Error: AngleJoint must have jointMin <= jointMax");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new ao("Error: Constraints cannot have both bodies non-dynamic")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&this.b2.id==t||this.b1.id==t&&this.b2.id==e},clearcache:function(){this.jAcc=0,this.pre_dt=-1,this.slack=!1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;this.pre_dt=e,this.stepped=!0,this.equal=this.jointMin==this.jointMax;var n=this.ratio*this.b2.rot-this.b1.rot;this.equal?(n-=this.jointMax,this.slack=!1,this.scale=1):n<this.jointMin?(n=this.jointMin-n,this.scale=-1,this.slack=!1):n>this.jointMax?(n-=this.jointMax,this.scale=1,this.slack=!1):(n=this.scale=0,this.slack=!0);var i=n;if(!this.slack){if(this.kMass=this.b1.sinertia+this.ratio*this.ratio*this.b2.sinertia,0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0,this.stiff)this.bias=0,this.gamma=0;else{if(this.breakUnderError&&i*i>this.maxError*this.maxError)return!0;var r,a=2*Math.PI*this.frequency;this.gamma=1/(e*a*(2*this.damping+a*e));var s=1/(1+this.gamma);r=e*a*a*this.gamma,this.gamma*=s,this.kMass*=s,this.bias=-i*r,this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=t,this.jMax=this.maxForce*e}return!1},warmStart:function(){this.slack||(this.b1.angvel-=this.scale*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.ratio*this.scale*this.b2.iinertia*this.jAcc)},applyImpulseVel:function(){if(this.slack)return!1;var e=this.scale*(this.ratio*(this.b2.angvel+this.b2.kinangvel)-this.b1.angvel-this.b1.kinangvel),t=this.kMass*(this.bias-e)-this.jAcc*this.gamma,n=this.jAcc;return this.jAcc+=t,!this.equal&&0<this.jAcc&&(this.jAcc=0),!(!this.breakUnderForce||!(this.jAcc>this.jMax||this.jAcc<-this.jMax))||(this.stiff||(this.jAcc>this.jMax?this.jAcc=this.jMax:this.jAcc<-this.jMax&&(this.jAcc=-this.jMax)),t=this.jAcc-n,this.b1.angvel-=this.scale*this.b1.iinertia*t,this.b2.angvel+=this.ratio*this.scale*this.b2.iinertia*t,!1)},applyImpulsePos:function(){var e,t,n,i=this.ratio*this.b2.rot-this.b1.rot;if(this.equal?(i-=this.jointMax,n=!1,this.scale=1):n=i<this.jointMin?(i=this.jointMin-i,!(this.scale=-1)):i>this.jointMax?(i-=this.jointMax,!(this.scale=1)):!(i=this.scale=0),e=i,!n){if(this.breakUnderError&&e*e>this.maxError*this.maxError)return!0;t=-(e*=.5)*this.kMass,(this.equal||t<0)&&(this.b1.delta_rot(-this.scale*t*this.b1.iinertia),this.b2.delta_rot(this.ratio*this.scale*t*this.b2.iinertia))}return!1},draw:function(e){},__class__:bp});var yp=function(){this.cb=null,this.bc=null,this.id=0};(n["zpp_nape.constraint.ZPP_CopyHelper"]=yp).__name__=["zpp_nape","constraint","ZPP_CopyHelper"],yp.dict=function(e,t){var n=new yp;return n.id=e,n.bc=t,n},yp.todo=function(e,t){var n=new yp;return n.id=e,n.cb=t,n},yp.prototype={id:null,bc:null,cb:null,__class__:yp};var xp=function(){this.stepped=!1,this.bias=0,this.gamma=0,this.jMax=0,this.jAcc=0,this.kMass=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.cx2=0,this.cx1=0,this.ny=0,this.nx=0,this.equal=!1,this.slack=!1,this.jointMax=0,this.jointMin=0,this.outer_zn=null,vp.call(this),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0,this.jAcc=0,this.jMax=$_.POSINF(),this.stepped=!1,this.cx1=this.cx2=0};(n["zpp_nape.constraint.ZPP_DistanceJoint"]=xp).__name__=["zpp_nape","constraint","ZPP_DistanceJoint"],xp.__super__=vp,xp.prototype=r(vp.prototype,{outer_zn:null,jointMin:null,jointMax:null,slack:null,equal:null,is_slack:function(){var e;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var t=0,n=0,i=(t=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx))*t+(n=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely))*n;if(i<co.epsilon)e=!(i=n=t=0);else{var r=1/(i=dc.sqrt(i));t*=r,n*=r,e=this.equal?(i-=this.jointMax,!1):i<this.jointMin?(i=this.jointMin-i,t=-t,n=-n,!1):i>this.jointMax?(i-=this.jointMax,!1):!(i=n=t=0)}return e},nx:null,ny:null,cx1:null,cx2:null,bodyImpulse:function(e){return this.stepped?e==this.b1?w_.get(-this.jAcc*this.nx,-this.jAcc*this.ny,-this.cx1*this.jAcc):w_.get(this.jAcc*this.nx,this.jAcc*this.ny,this.cx2*this.jAcc):w_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},b1:null,a1localx:null,a1localy:null,a1relx:null,a1rely:null,validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(e){this.immutable_midstep("Constraint::a1"),this.a1localx=e.x,this.a1localy=e.y,this.wake()},setup_a1:function(){this.wrap_a1=y_.get(this.a1localx,this.a1localy),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=Cc(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=Cc(this,this.invalidate_a1)},wrap_a1:null,b2:null,a2localx:null,a2localy:null,a2relx:null,a2rely:null,validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(e){this.immutable_midstep("Constraint::a2"),this.a2localx=e.x,this.a2localy=e.y,this.wake()},setup_a2:function(){this.wrap_a2=y_.get(this.a2localx,this.a2localy),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=Cc(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=Cc(this,this.invalidate_a2)},wrap_a2:null,kMass:null,jAcc:null,jMax:null,gamma:null,bias:null,stepped:null,copy:function(e,t){var n=new Fo(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.jointMin,this.jointMax);if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(yp.todo(this.b1.id,function(e){n.zpp_inner_zn.b1=e.zpp_inner}))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(yp.todo(this.b2.id,function(e){n.zpp_inner_zn.b2=e.zpp_inner}))}return n},validate:function(){if(null==this.b1||null==this.b2)throw new ao("Error: DistanceJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new ao("Error: DistanceJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new ao("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new ao("Error: DistanceJoint must have jointMin <= jointMax");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new ao("Error: Constraints cannot have both bodies non-dynamic")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&this.b2.id==t||this.b1.id==t&&this.b2.id==e},clearcache:function(){this.jAcc=0,this.pre_dt=-1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;this.pre_dt=e,this.stepped=!0,this.equal=this.jointMin==this.jointMax,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,this.nx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),this.ny=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);var n=this.nx*this.nx+this.ny*this.ny;if(n<co.epsilon)this.nx=0,n=this.ny=0,this.slack=!0;else{var i=1/(n=dc.sqrt(n));this.nx*=i,this.ny*=i,this.equal?(n-=this.jointMax,this.slack=!1):n<this.jointMin?(n=this.jointMin-n,this.nx=-this.nx,this.ny=-this.ny,this.slack=!1):n>this.jointMax?(n-=this.jointMax,this.slack=!1):(this.nx=0,n=this.ny=0,this.slack=!0)}var r=n;if(!this.slack){if(this.cx1=this.ny*this.a1relx-this.nx*this.a1rely,this.cx2=this.ny*this.a2relx-this.nx*this.a2rely,this.kMass=this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*this.b2.sinertia,0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0,this.stiff)this.bias=0,this.gamma=0;else{if(this.breakUnderError&&r*r>this.maxError*this.maxError)return!0;var a,s=2*Math.PI*this.frequency;this.gamma=1/(e*s*(2*this.damping+s*e));var l=1/(1+this.gamma);a=e*s*s*this.gamma,this.gamma*=l,this.kMass*=l,this.bias=-r*a,this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=t,this.jMax=this.maxForce*e}return!1},warmStart:function(){if(!this.slack){var e=this.b1.imass*this.jAcc;this.b1.velx-=this.nx*e,this.b1.vely-=this.ny*e;var t=this.b2.imass*this.jAcc;this.b2.velx+=this.nx*t,this.b2.vely+=this.ny*t,this.b1.angvel-=this.cx1*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc}},applyImpulseVel:function(){if(this.slack)return!1;var e=this.nx*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.ny*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+(this.b2.angvel+this.b2.kinangvel)*this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1,t=this.kMass*(this.bias-e)-this.jAcc*this.gamma,n=this.jAcc;if(this.jAcc+=t,!this.equal&&0<this.jAcc&&(this.jAcc=0),this.breakUnderForce&&this.jAcc<-this.jMax)return!0;this.stiff||this.jAcc<-this.jMax&&(this.jAcc=-this.jMax),t=this.jAcc-n;var i=this.b1.imass*t;this.b1.velx-=this.nx*i,this.b1.vely-=this.ny*i;var r=this.b2.imass*t;return this.b2.velx+=this.nx*r,this.b2.vely+=this.ny*r,this.b1.angvel-=this.cx1*this.b1.iinertia*t,this.b2.angvel+=this.cx2*this.b2.iinertia*t,!1},applyImpulsePos:function(){var e,t,n,i,r,a,s;n=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,i=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,r=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,a=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var l=0,o=0,_=(l=this.b2.posx+r-(this.b1.posx+n))*l+(o=this.b2.posy+a-(this.b1.posy+i))*o;if(_<co.epsilon)s=!(_=o=l=0);else{var p=1/(_=dc.sqrt(_));l*=p,o*=p,s=this.equal?(_-=this.jointMax,!1):_<this.jointMin?(_=this.jointMin-_,l=-l,o=-o,!1):_>this.jointMax?(_-=this.jointMax,!1):!(_=o=l=0)}if(e=_,!s){if(this.breakUnderError&&e*e>this.maxError*this.maxError)return!0;if(e*e<co.constraintLinearSlop*co.constraintLinearSlop)return!1;if(6<(e*=.5)*e){var u=this.b1.smass+this.b2.smass;if(co.epsilon<u&&(t=-e*(u=.75/u),this.equal||t<0)){var h=t*this.b1.imass;this.b1.posx-=l*h,this.b1.posy-=o*h;var c=t*this.b2.imass;this.b2.posx+=l*c,this.b2.posy+=o*c;var d=(l=this.b2.posx+r-(this.b1.posx+n))*l+(o=this.b2.posy+a-(this.b1.posy+i))*o;if(d<co.epsilon)s=!(d=o=l=0);else{var m=1/(d=dc.sqrt(d));l*=m,o*=m,s=this.equal?(d-=this.jointMax,!1):d<this.jointMin?(d=this.jointMin-d,l=-l,o=-o,!1):d>this.jointMax?(d-=this.jointMax,!1):!(d=o=l=0)}e=d,e*=.5}}var f,g;f=o*n-l*i,g=o*r-l*a;var v=this.b1.smass+this.b2.smass+f*f*this.b1.sinertia+g*g*this.b2.sinertia;if(0!=v&&(v=1/v),t=-e*v,this.equal||t<0){var b=this.b1.imass*t;this.b1.posx-=l*b,this.b1.posy-=o*b;var y=this.b2.imass*t;this.b2.posx+=l*y,this.b2.posy+=o*y,this.b1.delta_rot(-f*this.b1.iinertia*t),this.b2.delta_rot(g*this.b2.iinertia*t)}}return!1},draw:function(e){},__class__:xp});var zp=function(){this.biasy=0,this.biasx=0,this.jAccy=0,this.jAccx=0,this.kMassc=0,this.kMassb=0,this.kMassa=0,this.wrap_n=null,this.nrely=0,this.nrelx=0,this.nlocaly=0,this.nlocalx=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.cx2=0,this.cx1=0,this.dot2=0,this.dot1=0,this.equal=!1,this.jointMax=0,this.jointMin=0,this.scale=0,this.outer_zn=null,vp.call(this),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0,this.nlocalx=0,this.nlocaly=0,this.nrelx=0,this.nrely=0,this.jAccx=0,this.jAccy=0,this.jMax=$_.POSINF(),this.jointMin=$_.NEGINF(),this.jointMax=$_.POSINF(),this.stepped=!1};(n["zpp_nape.constraint.ZPP_LineJoint"]=zp).__name__=["zpp_nape","constraint","ZPP_LineJoint"],zp.__super__=vp,zp.prototype=r(vp.prototype,{outer_zn:null,scale:null,jointMin:null,jointMax:null,equal:null,dot1:null,dot2:null,cx1:null,cx2:null,bodyImpulse:function(e){if(this.stepped){var t=this.scale*this.nrelx*this.jAccy-this.nrely*this.jAccx,n=this.nrelx*this.jAccx+this.scale*this.nrely*this.jAccy;return e==this.b1?w_.get(-t,-n,this.scale*this.cx1*n-this.dot1*t):w_.get(t,n,this.scale*this.cx1*n-this.dot1*t)}return w_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},b1:null,a1localx:null,a1localy:null,a1relx:null,a1rely:null,validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(e){this.immutable_midstep("Constraint::a1"),this.a1localx=e.x,this.a1localy=e.y,this.wake()},setup_a1:function(){this.wrap_a1=y_.get(this.a1localx,this.a1localy),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=Cc(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=Cc(this,this.invalidate_a1)},wrap_a1:null,b2:null,a2localx:null,a2localy:null,a2relx:null,a2rely:null,validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(e){this.immutable_midstep("Constraint::a2"),this.a2localx=e.x,this.a2localy=e.y,this.wake()},setup_a2:function(){this.wrap_a2=y_.get(this.a2localx,this.a2localy),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=Cc(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=Cc(this,this.invalidate_a2)},wrap_a2:null,zip_n:null,nlocalx:null,nlocaly:null,nrelx:null,nrely:null,validate_n:function(){this.wrap_n.zpp_inner.x=this.nlocalx,this.wrap_n.zpp_inner.y=this.nlocaly},invalidate_n:function(e){this.immutable_midstep("Constraint::n"),this.nlocalx=e.x,this.nlocaly=e.y,this.zip_n=!0,this.wake()},setup_n:function(){this.wrap_n=y_.get(this.nlocalx,this.nlocaly),this.wrap_n.zpp_inner._inuse=!0,this.wrap_n.zpp_inner._validate=Cc(this,this.validate_n),this.wrap_n.zpp_inner._invalidate=Cc(this,this.invalidate_n)},wrap_n:null,validate_norm:function(){if(this.zip_n){this.zip_n=!1;var e=this.nlocalx*this.nlocalx+this.nlocaly*this.nlocaly,t=1/Math.sqrt(e);this.nlocalx*=t,this.nlocaly*=t}},kMassa:null,kMassb:null,kMassc:null,jAccx:null,jAccy:null,jMax:null,gamma:null,biasx:null,biasy:null,stepped:null,copy:function(e,t){var n=new Ro(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.outer_zn.get_direction(),this.jointMin,this.jointMax);if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(yp.todo(this.b1.id,function(e){n.zpp_inner_zn.b1=e.zpp_inner}))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(yp.todo(this.b2.id,function(e){n.zpp_inner_zn.b2=e.zpp_inner}))}return n},validate:function(){if(null==this.b1||null==this.b2)throw new ao("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new ao("Error: DistanceJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new ao("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new ao("Error: DistanceJoint must have jointMin <= jointMax");if(this.nlocalx*this.nlocalx+this.nlocaly*this.nlocaly<co.epsilon)throw new ao("Error: DistanceJoint direction must be non-degenerate");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new ao("Error: Constraints cannot have both bodies non-dynamic")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&this.b2.id==t||this.b1.id==t&&this.b2.id==e},clearcache:function(){this.jAccx=0,this.jAccy=0,this.pre_dt=-1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;this.pre_dt=e,this.equal=this.jointMin==this.jointMax,this.stepped=!0,this.validate_norm(),this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.nrelx=this.b1.axisy*this.nlocalx-this.b1.axisx*this.nlocaly,this.nrely=this.nlocalx*this.b1.axisx+this.nlocaly*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var n,i,r,a,s,l=0;n=this.b2.posx+this.a2relx-this.b1.posx-this.a1relx,r=(i=this.b2.posy+this.a2rely-this.b1.posy-this.a1rely)*this.nrelx-n*this.nrely,l=this.nrelx*n+this.nrely*i,this.equal?(l-=this.jointMin,this.scale=1):l>this.jointMax?(l-=this.jointMax,this.scale=1):l<this.jointMin?(l=this.jointMin-l,this.scale=-1):(l=0,this.scale=0),a=n+this.a1relx,s=i+this.a1rely,this.dot1=this.nrelx*a+this.nrely*s,this.cx1=s*this.nrelx-a*this.nrely,this.dot2=this.nrelx*this.a2relx+this.nrely*this.a2rely,this.cx2=this.a2rely*this.nrelx-this.a2relx*this.nrely,this.kMassa=this.b1.smass+this.b2.smass+this.dot1*this.dot1*this.b1.sinertia+this.dot2*this.dot2*this.b2.sinertia,this.kMassb=-this.scale*(this.dot1*this.cx1*this.b1.sinertia+this.dot2*this.cx2*this.b2.sinertia),this.kMassc=this.scale*this.scale*(this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*this.b2.sinertia);var o,_=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(_!=_)this.kMassa=this.kMassb=this.kMassc=0,o=3;else if(0==_){var p=0;0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,p|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,p|=2),this.kMassb=0,o=p}else{_=1/_;var u=this.kMassc*_;this.kMassc=this.kMassa*_,this.kMassa=u,this.kMassb*=-_,o=0}if(0!=(1&o)&&(this.jAccx=0),0!=(2&o)&&(this.jAccy=0),this.stiff)this.gamma=0,this.biasx=0,this.biasy=0;else{if(this.breakUnderError&&r*r+l*l>this.maxError*this.maxError)return!0;var h,c=2*Math.PI*this.frequency;this.gamma=1/(e*c*(2*this.damping+c*e));var d=1/(1+this.gamma);h=e*c*c*this.gamma,this.gamma*=d;var m=d;this.kMassa*=m,this.kMassb*=m,this.kMassc*=m,this.biasx=r,this.biasy=l;var f=-h;this.biasx*=f,this.biasy*=f;var g=this.maxError,v=this.biasx*this.biasx+this.biasy*this.biasy;if(g*g<v){var b=g*dc.invsqrt(v);this.biasx*=b,this.biasy*=b}}var y=t;return this.jAccx*=y,this.jAccy*=y,this.jMax=this.maxForce*e,!1},warmStart:function(){var e=this.scale*this.nrelx*this.jAccy-this.nrely*this.jAccx,t=this.nrelx*this.jAccx+this.scale*this.nrely*this.jAccy,n=this.b1.imass;this.b1.velx-=e*n,this.b1.vely-=t*n;var i=this.b2.imass;this.b2.velx+=e*i,this.b2.vely+=t*i,this.b1.angvel+=(this.scale*this.cx1*this.jAccy-this.dot1*this.jAccx)*this.b1.iinertia,this.b2.angvel+=(this.dot2*this.jAccx-this.scale*this.cx2*this.jAccy)*this.b2.iinertia},applyImpulseVel:function(){var e,t,n=0,i=0;n=this.b2.velx-this.b1.velx,i=this.b2.vely-this.b1.vely,n+=this.b2.kinvelx-this.b1.kinvelx,e=(i+=this.b2.kinvely-this.b1.kinvely)*this.nrelx-n*this.nrely+(this.b2.angvel+this.b2.kinangvel)*this.dot2-(this.b1.angvel+this.b1.kinangvel)*this.dot1,t=this.scale*(this.nrelx*n+this.nrely*i-(this.b2.angvel+this.b2.kinangvel)*this.cx2+(this.b1.angvel+this.b1.kinangvel)*this.cx1);var r=0,a=0;r=this.biasx-e,a=this.biasy-t;var s=this.kMassa*r+this.kMassb*a;a=this.kMassb*r+this.kMassc*a,r=s;var l,o,_=this.gamma;if(r-=this.jAccx*_,a-=this.jAccy*_,l=this.jAccx,o=this.jAccy,this.jAccx+=1*r,this.jAccy+=1*a,0<this.jAccy&&(this.jAccy=0),this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax)return!0}else if(!this.stiff){var p=this.jMax,u=this.jAccx*this.jAccx+this.jAccy*this.jAccy;if(p*p<u){var h=p*dc.invsqrt(u);this.jAccx*=h,this.jAccy*=h}}r=this.jAccx-l,a=this.jAccy-o;var c=this.scale*this.nrelx*a-this.nrely*r,d=this.nrelx*r+this.scale*this.nrely*a,m=this.b1.imass;this.b1.velx-=c*m,this.b1.vely-=d*m;var f=this.b2.imass;return this.b2.velx+=c*f,this.b2.vely+=d*f,this.b1.angvel+=(this.scale*this.cx1*a-this.dot1*r)*this.b1.iinertia,this.b2.angvel+=(this.dot2*r-this.scale*this.cx2*a)*this.b2.iinertia,!1},applyImpulsePos:function(){var e,t,n,i,r,a;e=this.b1.axisy*this.nlocalx-this.b1.axisx*this.nlocaly,t=this.nlocalx*this.b1.axisx+this.nlocaly*this.b1.axisy,n=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,i=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,r=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,a=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var s,l=0,o=0,_=0,p=0;if(l=this.b2.posx+r-this.b1.posx-n,_=(o=this.b2.posy+a-this.b1.posy-i)*e-l*t,p=e*l+t*o,s=this.equal?(p-=this.jointMin,1):p>this.jointMax?(p-=this.jointMax,1):p<this.jointMin?(p=this.jointMin-p,-1):p=0,this.breakUnderError&&_*_+p*p>this.maxError*this.maxError)return!0;if(_*_+p*p<co.constraintLinearSlop*co.constraintLinearSlop)return!1;var u,h,c,d,m,f,g,v,b,y=0,x=0;if(6<(_*=.5)*_+(p*=.5)*p){var z=this.b1.smass+this.b2.smass;if(co.epsilon<z){var w=(z=.8/z)*(t*_-s*e*p),k=z*(e*_*s-t*_),S=this.b1.imass;this.b1.posx-=w*S,this.b1.posy-=k*S;var C=this.b2.imass;this.b2.posx+=w*C,this.b2.posy+=k*C,l=this.b2.posx+r-this.b1.posx-n,_=(o=this.b2.posy+a-this.b1.posy-i)*e-l*t,p=e*l+t*o,s=this.equal?(p-=this.jointMin,1):p>this.jointMax?(p-=this.jointMax,1):p<this.jointMin?(p=this.jointMin-p,-1):p=0,_*=.5,p*=.5}}u=e*(v=l+n)+t*(b=o+i),c=b*e-v*t,h=e*r+t*a,d=a*e-r*t,m=this.b1.smass+this.b2.smass+u*u*this.b1.sinertia+h*h*this.b2.sinertia,f=-s*(u*c*this.b1.sinertia+h*d*this.b2.sinertia),y=-_,x=-p;var N=m*(g=s*s*(this.b1.smass+this.b2.smass+c*c*this.b1.sinertia+d*d*this.b2.sinertia))-f*f;if(N!=N)y=x=0;else if(0==N)0!=m?y/=m:y=0,0!=g?x/=g:x=0;else{var P=(N=1/N)*(g*y-f*x);x=N*(m*x-f*y),y=P}0<x&&(x=0);var M=s*e*x-t*y,I=e*y+s*t*x,T=this.b1.imass;this.b1.posx-=M*T,this.b1.posy-=I*T;var A=this.b2.imass;return this.b2.posx+=M*A,this.b2.posy+=I*A,this.b1.delta_rot((s*c*x-u*y)*this.b1.iinertia),this.b2.delta_rot((h*y-s*d*x)*this.b2.iinertia),!1},draw:function(e){},__class__:zp});var wp=function(){this.stepped=!1,this.jMax=0,this.jAcc=0,this.kMass=0,this.b2=null,this.b1=null,this.rate=0,this.ratio=0,this.outer_zn=null,vp.call(this),this.jAcc=0,this.stepped=!1,this.__velocity=!0};(n["zpp_nape.constraint.ZPP_MotorJoint"]=wp).__name__=["zpp_nape","constraint","ZPP_MotorJoint"],wp.__super__=vp,wp.prototype=r(vp.prototype,{outer_zn:null,ratio:null,rate:null,bodyImpulse:function(e){return this.stepped?e==this.b1?w_.get(0,0,-this.jAcc):w_.get(0,0,this.ratio*this.jAcc):w_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},b1:null,b2:null,kMass:null,jAcc:null,jMax:null,stepped:null,copy:function(e,t){var n=new Go(null,null,this.rate,this.ratio);if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(yp.todo(this.b1.id,function(e){n.zpp_inner_zn.b1=e.zpp_inner}))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(yp.todo(this.b2.id,function(e){n.zpp_inner_zn.b2=e.zpp_inner}))}return n},validate:function(){if(null==this.b1||null==this.b2)throw new ao("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new ao("Error: MotorJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new ao("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new ao("Error: Constraints cannot have both bodies non-dynamic")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&this.b2.id==t||this.b1.id==t&&this.b2.id==e},clearcache:function(){this.jAcc=0,this.pre_dt=-1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;return this.pre_dt=e,this.stepped=!0,this.kMass=this.b1.sinertia+this.ratio*this.ratio*this.b2.sinertia,this.kMass=1/this.kMass,this.jAcc*=t,this.jMax=this.maxForce*e,!1},warmStart:function(){this.b1.angvel-=this.b1.iinertia*this.jAcc,this.b2.angvel+=this.ratio*this.b2.iinertia*this.jAcc},applyImpulseVel:function(){var e=this.ratio*(this.b2.angvel+this.b2.kinangvel)-this.b1.angvel-this.b1.kinangvel-this.rate,t=-this.kMass*e,n=this.jAcc;if(this.jAcc+=t,this.breakUnderForce){if(this.jAcc>this.jMax||this.jAcc<-this.jMax)return!0}else this.jAcc<-this.jMax?this.jAcc=-this.jMax:this.jAcc>this.jMax&&(this.jAcc=this.jMax);return t=this.jAcc-n,this.b1.angvel-=this.b1.iinertia*t,this.b2.angvel+=this.ratio*this.b2.iinertia*t,!1},applyImpulsePos:function(){return!1},__class__:wp});var kp=function(){this.stepped=!1,this.biasy=0,this.biasx=0,this.gamma=0,this.jMax=0,this.jAccy=0,this.jAccx=0,this.kMassc=0,this.kMassb=0,this.kMassa=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.outer_zn=null,vp.call(this),this.stepped=!1,this.jAccx=0,this.jAccy=0,this.jMax=$_.POSINF(),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0};(n["zpp_nape.constraint.ZPP_PivotJoint"]=kp).__name__=["zpp_nape","constraint","ZPP_PivotJoint"],kp.__super__=vp,kp.prototype=r(vp.prototype,{outer_zn:null,bodyImpulse:function(e){return this.stepped?e==this.b1?w_.get(-this.jAccx,-this.jAccy,-(this.jAccy*this.a1relx-this.jAccx*this.a1rely)):w_.get(this.jAccx,this.jAccy,this.jAccy*this.a2relx-this.jAccx*this.a2rely):w_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},b1:null,a1localx:null,a1localy:null,a1relx:null,a1rely:null,validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(e){this.immutable_midstep("Constraint::a1"),this.a1localx=e.x,this.a1localy=e.y,this.wake()},setup_a1:function(){this.wrap_a1=y_.get(this.a1localx,this.a1localy),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=Cc(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=Cc(this,this.invalidate_a1)},wrap_a1:null,b2:null,a2localx:null,a2localy:null,a2relx:null,a2rely:null,validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(e){this.immutable_midstep("Constraint::a2"),this.a2localx=e.x,this.a2localy=e.y,this.wake()},setup_a2:function(){this.wrap_a2=y_.get(this.a2localx,this.a2localy),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=Cc(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=Cc(this,this.invalidate_a2)},wrap_a2:null,kMassa:null,kMassb:null,kMassc:null,jAccx:null,jAccy:null,jMax:null,gamma:null,biasx:null,biasy:null,stepped:null,copy:function(e,t){var n=new Zo(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2());if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(yp.todo(this.b1.id,function(e){n.zpp_inner_zn.b1=e.zpp_inner}))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(yp.todo(this.b2.id,function(e){n.zpp_inner_zn.b2=e.zpp_inner}))}return n},validate:function(){if(null==this.b1||null==this.b2)throw new ao("Error: PivotJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new ao("Error: PivotJoint cannot be simulated with body1 == body2 (body1=body2="+this.b1.outer.toString()+")");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new ao("Error: Constraints must have each body within the same space to which the constraint has been assigned (body1="+this.b1.outer.toString()+", body2="+this.b2.outer.toString()+")");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new ao("Error: Constraints cannot have both bodies non-dynamic (body1="+this.b1.outer.toString()+", body2="+this.b2.outer.toString()+")")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&this.b2.id==t||this.b1.id==t&&this.b2.id==e},clearcache:function(){this.jAccx=0,this.jAccy=0,this.pre_dt=-1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;this.pre_dt=e,this.stepped=!0,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var n=this.b1.smass+this.b2.smass;if(this.kMassa=n,this.kMassb=0,this.kMassc=n,0!=this.b1.sinertia){var i=this.a1relx*this.b1.sinertia,r=this.a1rely*this.b1.sinertia;this.kMassa+=r*this.a1rely,this.kMassb+=-r*this.a1relx,this.kMassc+=i*this.a1relx}if(0!=this.b2.sinertia){var a=this.a2relx*this.b2.sinertia,s=this.a2rely*this.b2.sinertia;this.kMassa+=s*this.a2rely,this.kMassb+=-s*this.a2relx,this.kMassc+=a*this.a2relx}var l,o=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(o!=o)this.kMassa=this.kMassb=this.kMassc=0,l=3;else if(0==o){var _=0;0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,_|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,_|=2),this.kMassb=0,l=_}else{o=1/o;var p=this.kMassc*o;this.kMassc=this.kMassa*o,this.kMassa=p,this.kMassb*=-o,l=0}if(0!=(1&l)&&(this.jAccx=0),0!=(2&l)&&(this.jAccy=0),this.stiff)this.biasx=0,this.biasy=0,this.gamma=0;else{var u,h=2*Math.PI*this.frequency;this.gamma=1/(e*h*(2*this.damping+h*e));var c=1/(1+this.gamma);u=e*h*h*this.gamma,this.gamma*=c;var d=c;if(this.kMassa*=d,this.kMassb*=d,this.kMassc*=d,this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy>this.maxError*this.maxError)return!0;var m=-u;this.biasx*=m,this.biasy*=m;var f=this.maxError,g=this.biasx*this.biasx+this.biasy*this.biasy;if(f*f<g){var v=f*dc.invsqrt(g);this.biasx*=v,this.biasy*=v}}var b=t;return this.jAccx*=b,this.jAccy*=b,this.jMax=this.maxForce*e,!1},warmStart:function(){var e=this.b1.imass;this.b1.velx-=this.jAccx*e,this.b1.vely-=this.jAccy*e;var t=this.b2.imass;this.b2.velx+=this.jAccx*t,this.b2.vely+=this.jAccy*t,this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely)*this.b1.iinertia,this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely)*this.b2.iinertia},applyImpulseVel:function(){var e,t;e=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel)),t=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel));var n=0,i=0;n=this.biasx-e,i=this.biasy-t;var r=this.kMassa*n+this.kMassb*i;i=this.kMassb*n+this.kMassc*i,n=r;var a,s,l=this.gamma;if(n-=this.jAccx*l,i-=this.jAccy*l,a=this.jAccx,s=this.jAccy,this.jAccx+=1*n,this.jAccy+=1*i,this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax)return!0}else if(!this.stiff){var o=this.jMax,_=this.jAccx*this.jAccx+this.jAccy*this.jAccy;if(o*o<_){var p=o*dc.invsqrt(_);this.jAccx*=p,this.jAccy*=p}}n=this.jAccx-a,i=this.jAccy-s;var u=this.b1.imass;this.b1.velx-=n*u,this.b1.vely-=i*u;var h=this.b2.imass;return this.b2.velx+=n*h,this.b2.vely+=i*h,this.b1.angvel-=(i*this.a1relx-n*this.a1rely)*this.b1.iinertia,this.b2.angvel+=(i*this.a2relx-n*this.a2rely)*this.b2.iinertia,!1},applyImpulsePos:function(){var e,t,n,i;e=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,t=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,n=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,i=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var r=0,a=0;if(r=this.b2.posx+n-(this.b1.posx+e),a=this.b2.posy+i-(this.b1.posy+t),this.breakUnderError&&r*r+a*a>this.maxError*this.maxError)return!0;if(r*r+a*a<co.constraintLinearSlop*co.constraintLinearSlop)return!1;var s=0,l=0;if(6<(r*=.5)*r+(a*=.5)*a){var o=this.b1.smass+this.b2.smass;if(co.epsilon<o){var _=(s=-r*(o=.75/o))*s+(l=-a*o)*l;if(400<_){var p=20*dc.invsqrt(_);s*=p,l*=p}var u=this.b1.imass;this.b1.posx-=s*u,this.b1.posy-=l*u;var h=this.b2.imass;this.b2.posx+=s*h,this.b2.posy+=l*h,r=this.b2.posx+n-(this.b1.posx+e),a=this.b2.posy+i-(this.b1.posy+t),r*=.5,a*=.5}}var c=0,d=0,m=0;if(m=c=this.b1.smass+this.b2.smass,(d=0)!=this.b1.sinertia){var f=e*this.b1.sinertia,g=t*this.b1.sinertia;c+=g*t,d+=-g*e,m+=f*e}if(0!=this.b2.sinertia){var v=n*this.b2.sinertia,b=i*this.b2.sinertia;c+=b*i,d+=-b*n,m+=v*n}var y=(s=-r)*s+(l=-a)*l;if(36<y){var x=6*dc.invsqrt(y);s*=x,l*=x}var z=c*m-d*d;if(z!=z)s=l=0;else if(0==z)0!=c?s/=c:s=0,0!=m?l/=m:l=0;else{var w=(z=1/z)*(m*s-d*l);l=z*(c*l-d*s),s=w}var k=this.b1.imass;this.b1.posx-=s*k,this.b1.posy-=l*k;var S=this.b2.imass;return this.b2.posx+=s*S,this.b2.posy+=l*S,this.b1.delta_rot(-(l*e-s*t)*this.b1.iinertia),this.b2.delta_rot((l*n-s*i)*this.b2.iinertia),!1},draw:function(e){},__class__:kp});var Sp=function(){this.stepped=!1,this.bias=0,this.gamma=0,this.jMax=0,this.jAcc=0,this.kMass=0,this.wrap_a4=null,this.a4rely=0,this.a4relx=0,this.a4localy=0,this.a4localx=0,this.b4=null,this.wrap_a3=null,this.a3rely=0,this.a3relx=0,this.a3localy=0,this.a3localx=0,this.b3=null,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.cx4=0,this.cx3=0,this.cx2=0,this.cx1=0,this.n34y=0,this.n34x=0,this.n12y=0,this.n12x=0,this.equal=!1,this.slack=!1,this.jointMax=0,this.jointMin=0,this.ratio=1,this.outer_zn=null,vp.call(this),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0,this.a3localx=0,this.a3localy=0,this.a3relx=0,this.a3rely=0,this.a4localx=0,this.a4localy=0,this.a4relx=0,this.a4rely=0,this.n12x=1,this.n12y=0,this.n34x=1,this.n34y=0,this.jAcc=0,this.jMax=$_.POSINF(),this.stepped=!1,this.cx1=this.cx2=this.cx3=this.cx4=0};(n["zpp_nape.constraint.ZPP_PulleyJoint"]=Sp).__name__=["zpp_nape","constraint","ZPP_PulleyJoint"],Sp.__super__=vp,Sp.prototype=r(vp.prototype,{outer_zn:null,ratio:null,jointMin:null,jointMax:null,slack:null,equal:null,is_slack:function(){this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,this.a3relx=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,this.a3rely=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy,this.a4relx=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,this.a4rely=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var e,t,n,i,r=0,a=0,s=0,l=0;e=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),t=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),n=this.b4.posx+this.a4relx-(this.b3.posx+this.a3relx),i=this.b4.posy+this.a4rely-(this.b3.posy+this.a3rely);var o=dc.sqrt(e*e+t*t),_=dc.sqrt(n*n+i*i);if(0!=o){var p=1/o;r=e*p,a=t*p}if(0!=_){var u=1/_;s=n*u,l=i*u;var h=this.ratio;s*=h,l*=h}else{var c=this.ratio/dc.sqrt(s*s+l*l);s*=c,l*=c}var d=o+this.ratio*_;return this.equal?(d-=this.jointMax,!1):d<this.jointMin?(d=this.jointMin-d,r=-r,a=-a,s=-s,l=-l,!1):d>this.jointMax?(d-=this.jointMax,!1):!(d=l=s=a=r=0)},n12x:null,n12y:null,n34x:null,n34y:null,cx1:null,cx2:null,cx3:null,cx4:null,bodyImpulse:function(e){if(this.stepped){var t=w_.get();if(e==this.b1){var n=t;n.set_x(n.get_x()-this.jAcc*this.n12x);var i=t;i.set_y(i.get_y()-this.jAcc*this.n12y);var r=t;r.set_z(r.get_z()-this.cx1*this.jAcc)}if(e==this.b2){var a=t;a.set_x(a.get_x()+this.jAcc*this.n12x);var s=t;s.set_y(s.get_y()+this.jAcc*this.n12y);var l=t;l.set_z(l.get_z()+this.cx2*this.jAcc)}if(e==this.b3){var o=t;o.set_x(o.get_x()-this.jAcc*this.n34x);var _=t;_.set_y(_.get_y()-this.jAcc*this.n34y);var p=t;p.set_z(p.get_z()-this.cx3*this.jAcc)}if(e==this.b4){var u=t;u.set_x(u.get_x()+this.jAcc*this.n34x);var h=t;h.set_y(h.get_y()+this.jAcc*this.n34y);var c=t;c.set_z(c.get_z()+this.cx4*this.jAcc)}return t}return w_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this),this.b3!=this.b1&&this.b3!=this.b2&&null!=this.b3&&this.b3.constraints.add(this),this.b4!=this.b1&&this.b4!=this.b2&&this.b4!=this.b3&&null!=this.b4&&this.b4.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this),this.b3!=this.b1&&this.b3!=this.b2&&null!=this.b3&&this.b3.constraints.remove(this),this.b4!=this.b1&&this.b4!=this.b2&&this.b4!=this.b3&&null!=this.b4&&this.b4.constraints.remove(this)},b1:null,a1localx:null,a1localy:null,a1relx:null,a1rely:null,validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(e){this.immutable_midstep("Constraint::a1"),this.a1localx=e.x,this.a1localy=e.y,this.wake()},setup_a1:function(){this.wrap_a1=y_.get(this.a1localx,this.a1localy),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=Cc(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=Cc(this,this.invalidate_a1)},wrap_a1:null,b2:null,a2localx:null,a2localy:null,a2relx:null,a2rely:null,validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(e){this.immutable_midstep("Constraint::a2"),this.a2localx=e.x,this.a2localy=e.y,this.wake()},setup_a2:function(){this.wrap_a2=y_.get(this.a2localx,this.a2localy),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=Cc(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=Cc(this,this.invalidate_a2)},wrap_a2:null,b3:null,a3localx:null,a3localy:null,a3relx:null,a3rely:null,validate_a3:function(){this.wrap_a3.zpp_inner.x=this.a3localx,this.wrap_a3.zpp_inner.y=this.a3localy},invalidate_a3:function(e){this.immutable_midstep("Constraint::a3"),this.a3localx=e.x,this.a3localy=e.y,this.wake()},setup_a3:function(){this.wrap_a3=y_.get(this.a3localx,this.a3localy),this.wrap_a3.zpp_inner._inuse=!0,this.wrap_a3.zpp_inner._validate=Cc(this,this.validate_a3),this.wrap_a3.zpp_inner._invalidate=Cc(this,this.invalidate_a3)},wrap_a3:null,b4:null,a4localx:null,a4localy:null,a4relx:null,a4rely:null,validate_a4:function(){this.wrap_a4.zpp_inner.x=this.a4localx,this.wrap_a4.zpp_inner.y=this.a4localy},invalidate_a4:function(e){this.immutable_midstep("Constraint::a4"),this.a4localx=e.x,this.a4localy=e.y,this.wake()},setup_a4:function(){this.wrap_a4=y_.get(this.a4localx,this.a4localy),this.wrap_a4.zpp_inner._inuse=!0,this.wrap_a4.zpp_inner._validate=Cc(this,this.validate_a4),this.wrap_a4.zpp_inner._invalidate=Cc(this,this.invalidate_a4)},wrap_a4:null,kMass:null,jAcc:null,jMax:null,gamma:null,bias:null,stepped:null,copy:function(e,t){var n=new Uo(null,null,null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.outer_zn.get_anchor3(),this.outer_zn.get_anchor4(),this.jointMin,this.jointMax,this.ratio);if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(yp.todo(this.b1.id,function(e){n.zpp_inner_zn.b1=e.zpp_inner}))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(yp.todo(this.b2.id,function(e){n.zpp_inner_zn.b2=e.zpp_inner}))}if(null!=e&&null!=this.b3){for(var _=null,p=0;p<e.length;){var u=e[p];if(++p,u.id==this.b3.id){_=u.bc;break}}null!=_?n.zpp_inner_zn.b3=_.zpp_inner:t.push(yp.todo(this.b3.id,function(e){n.zpp_inner_zn.b3=e.zpp_inner}))}if(null!=e&&null!=this.b4){for(var h=null,c=0;c<e.length;){var d=e[c];if(++c,d.id==this.b4.id){h=d.bc;break}}null!=h?n.zpp_inner_zn.b4=h.zpp_inner:t.push(yp.todo(this.b4.id,function(e){n.zpp_inner_zn.b4=e.zpp_inner}))}return n},validate:function(){if(null==this.b1||null==this.b2||null==this.b3||null==this.b4)throw new ao("Error: PulleyJoint cannot be simulated with null bodies");if(this.b1==this.b2||this.b3==this.b4)throw new ao("Error: PulleyJoint cannot have body1==body2 or body3==body4");if(this.b1.space!=this.space||this.b2.space!=this.space||this.b3.space!=this.space||this.b4.space!=this.space)throw new ao("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new ao("Error: PulleyJoint must have jointMin <= jointMax");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new ao("Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic");if(!this.b3.isDynamic()&&!this.b4.isDynamic())throw new ao("Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake(),null!=this.b3&&this.b3.isDynamic()&&this.b3.wake(),null!=this.b4&&this.b4.isDynamic()&&this.b4.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}if(this.b3.isDynamic()){var y,x;if(this.b3.component==this.b3.component.parent)y=this.b3.component;else{for(var z=this.b3.component,w=null;z!=z.parent;){var k=z.parent;z.parent=w,w=z,z=k}for(;null!=w;){var S=w.parent;w.parent=z,w=S}y=z}if(this.component==this.component.parent)x=this.component;else{for(var C=this.component,N=null;C!=C.parent;){var P=C.parent;C.parent=N,N=C,C=P}for(;null!=N;){var M=N.parent;N.parent=C,N=M}x=C}y!=x&&(y.rank<x.rank?y.parent=x:y.rank>x.rank?x.parent=y:(x.parent=y).rank++)}if(this.b4.isDynamic()){var I,T;if(this.b4.component==this.b4.component.parent)I=this.b4.component;else{for(var A=this.b4.component,D=null;A!=A.parent;){var E=A.parent;A.parent=D,D=A,A=E}for(;null!=D;){var O=D.parent;D.parent=A,D=O}I=A}if(this.component==this.component.parent)T=this.component;else{for(var B=this.component,L=null;B!=B.parent;){var j=B.parent;B.parent=L,L=B,B=j}for(;null!=L;){var F=L.parent;L.parent=B,L=F}T=B}I!=T&&(I.rank<T.rank?I.parent=T:I.rank>T.rank?T.parent=I:(T.parent=I).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&(this.b2.id==t||this.b3.id==t||this.b4.id==t)||this.b2.id==e&&(this.b3.id==t||this.b4.id==t||this.b1.id==t)||this.b3.id==e&&(this.b4.id==t||this.b1.id==t||this.b2.id==t)||this.b4.id==e&&(this.b1.id==t||this.b2.id==t||this.b3.id==t)},clearcache:function(){this.jAcc=0,this.pre_dt=-1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t,n,i,r,a=e/this.pre_dt;this.pre_dt=e,this.stepped=!0,this.equal=this.jointMin==this.jointMax,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,this.a3relx=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,this.a3rely=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy,this.a4relx=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,this.a4rely=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy,t=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),n=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),i=this.b4.posx+this.a4relx-(this.b3.posx+this.a3relx),r=this.b4.posy+this.a4rely-(this.b3.posy+this.a3rely);var s=dc.sqrt(t*t+n*n),l=dc.sqrt(i*i+r*r);if(0!=s){var o=1/s;this.n12x=t*o,this.n12y=n*o}if(0!=l){var _=1/l;this.n34x=i*_,this.n34y=r*_;var p=this.ratio;this.n34x*=p,this.n34y*=p}else{var u=this.ratio/dc.sqrt(this.n34x*this.n34x+this.n34y*this.n34y);this.n34x*=u,this.n34y*=u}var h=s+this.ratio*l;this.equal?(h-=this.jointMax,this.slack=!1):h<this.jointMin?(h=this.jointMin-h,this.n12x=-this.n12x,this.n12y=-this.n12y,this.n34x=-this.n34x,this.n34y=-this.n34y,this.slack=!1):h>this.jointMax?(h-=this.jointMax,this.slack=!1):(this.n12x=0,this.n12y=0,this.n34x=0,h=this.n34y=0,this.slack=!0);var c=h;if(!this.slack){this.cx1=this.n12y*this.a1relx-this.n12x*this.a1rely,this.cx2=this.n12y*this.a2relx-this.n12x*this.a2rely,this.cx3=this.n34y*this.a3relx-this.n34x*this.a3rely,this.cx4=this.n34y*this.a4relx-this.n34x*this.a4rely;var d=this.ratio*this.ratio,m=this.b1.smass+this.b2.smass+d*(this.b3.smass+this.b4.smass)+this.b1.sinertia*this.cx1*this.cx1+this.b2.sinertia*this.cx2*this.cx2+this.b3.sinertia*this.cx3*this.cx3+this.b4.sinertia*this.cx4*this.cx4;if(this.b1==this.b4&&(m-=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b1.smass+this.cx1*this.cx4*this.b1.sinertia)),this.b1==this.b3&&(m+=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b1.smass+this.cx1*this.cx3*this.b1.sinertia)),this.b2==this.b3&&(m-=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b2.smass+this.cx2*this.cx3*this.b2.sinertia)),this.b2==this.b4&&(m+=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b2.smass+this.cx2*this.cx4*this.b2.sinertia)),this.kMass=m,0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0,this.stiff)this.bias=0,this.gamma=0;else{if(this.breakUnderError&&c*c>this.maxError*this.maxError)return!0;var f,g=2*Math.PI*this.frequency;this.gamma=1/(e*g*(2*this.damping+g*e));var v=1/(1+this.gamma);f=e*g*g*this.gamma,this.gamma*=v,this.kMass*=v,this.bias=-c*f,this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=a,this.jMax=this.maxForce*e}return!1},warmStart:function(){if(!this.slack){var e=this.b1.imass*this.jAcc;this.b1.velx-=this.n12x*e,this.b1.vely-=this.n12y*e;var t=this.b2.imass*this.jAcc;this.b2.velx+=this.n12x*t,this.b2.vely+=this.n12y*t;var n=this.b3.imass*this.jAcc;this.b3.velx-=this.n34x*n,this.b3.vely-=this.n34y*n;var i=this.b4.imass*this.jAcc;this.b4.velx+=this.n34x*i,this.b4.vely+=this.n34y*i,this.b1.angvel-=this.cx1*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc,this.b3.angvel-=this.cx3*this.b3.iinertia*this.jAcc,this.b4.angvel+=this.cx4*this.b4.iinertia*this.jAcc}},applyImpulseVel:function(){if(this.slack)return!1;var e=this.n12x*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.n12y*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+this.n34x*(this.b4.velx+this.b4.kinvelx-this.b3.velx-this.b3.kinvelx)+this.n34y*(this.b4.vely+this.b4.kinvely-this.b3.vely-this.b3.kinvely)+(this.b2.angvel+this.b2.kinangvel)*this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1+(this.b4.angvel+this.b4.kinangvel)*this.cx4-(this.b3.angvel+this.b3.kinangvel)*this.cx3,t=this.kMass*(this.bias-e)-this.jAcc*this.gamma,n=this.jAcc;if(this.jAcc+=t,!this.equal&&0<this.jAcc&&(this.jAcc=0),this.breakUnderForce&&this.jAcc<-this.jMax)return!0;this.stiff||this.jAcc<-this.jMax&&(this.jAcc=-this.jMax),t=this.jAcc-n;var i=this.b1.imass*t;this.b1.velx-=this.n12x*i,this.b1.vely-=this.n12y*i;var r=this.b2.imass*t;this.b2.velx+=this.n12x*r,this.b2.vely+=this.n12y*r;var a=this.b3.imass*t;this.b3.velx-=this.n34x*a,this.b3.vely-=this.n34y*a;var s=this.b4.imass*t;return this.b4.velx+=this.n34x*s,this.b4.vely+=this.n34y*s,this.b1.angvel-=this.cx1*this.b1.iinertia*t,this.b2.angvel+=this.cx2*this.b2.iinertia*t,this.b3.angvel-=this.cx3*this.b3.iinertia*t,this.b4.angvel+=this.cx4*this.b4.iinertia*t,!1},applyImpulsePos:function(){var e,t,n,i,r,a,s,l,o,_,p;n=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,i=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,r=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,a=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,s=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,l=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy,o=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,_=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var u,h,c,d,m=0,f=0,g=0,v=0;m=this.n12x,f=this.n12y,g=this.n34x,v=this.n34y,u=this.b2.posx+r-(this.b1.posx+n),h=this.b2.posy+a-(this.b1.posy+i),c=this.b4.posx+o-(this.b3.posx+s),d=this.b4.posy+_-(this.b3.posy+l);var b=dc.sqrt(u*u+h*h),y=dc.sqrt(c*c+d*d);if(0!=b){var x=1/b;m=u*x,f=h*x}if(0!=y){var z=1/y;g=c*z,v=d*z;var w=this.ratio;g*=w,v*=w}else{var k=this.ratio/dc.sqrt(g*g+v*v);g*=k,v*=k}var S=b+this.ratio*y;if(p=this.equal?(S-=this.jointMax,!1):S<this.jointMin?(S=this.jointMin-S,m=-m,f=-f,g=-g,v=-v,!1):S>this.jointMax?(S-=this.jointMax,!1):!(S=v=g=f=m=0),e=S,!p){if(this.breakUnderError&&e*e>this.maxError*this.maxError)return!0;if(e*e<co.constraintLinearSlop*co.constraintLinearSlop)return!1;if(6<(e*=.5)*e){var C=this.b1.smass+this.b2.smass;if(co.epsilon<C&&(t=-e*(C=.75/C),this.equal||t<0)){var N=t*this.b1.imass;this.b1.posx-=m*N,this.b1.posy-=f*N;var P=t*this.b2.imass;this.b2.posx+=m*P,this.b2.posy+=f*P;var M=t*this.b3.imass;this.b3.posx-=g*M,this.b3.posy-=v*M;var I,T,A,D,E=t*this.b4.imass;this.b4.posx+=g*E,this.b4.posy+=v*E,I=this.b2.posx+r-(this.b1.posx+n),T=this.b2.posy+a-(this.b1.posy+i),A=this.b4.posx+o-(this.b3.posx+s),D=this.b4.posy+_-(this.b3.posy+l);var O=dc.sqrt(I*I+T*T),B=dc.sqrt(A*A+D*D);if(0!=O){var L=1/O;m=I*L,f=T*L}if(0!=B){var j=1/B;g=A*j,v=D*j;var F=this.ratio;g*=F,v*=F}else{var R=this.ratio/dc.sqrt(g*g+v*v);g*=R,v*=R}var G=O+this.ratio*B;p=this.equal?(G-=this.jointMax,!1):G<this.jointMin?(G=this.jointMin-G,m=-m,f=-f,g=-g,v=-v,!1):G>this.jointMax?(G-=this.jointMax,!1):!(G=v=g=f=m=0),e=G,e*=.5}}var Z,U,V,q;Z=f*n-m*i,U=f*r-m*a,V=v*s-g*l,q=v*o-g*_;var W=this.ratio*this.ratio,X=this.b1.smass+this.b2.smass+W*(this.b3.smass+this.b4.smass)+this.b1.sinertia*Z*Z+this.b2.sinertia*U*U+this.b3.sinertia*V*V+this.b4.sinertia*q*q;this.b1==this.b4&&(X-=2*((m*g+f*v)*this.b1.smass+Z*q*this.b1.sinertia)),this.b1==this.b3&&(X+=2*((m*g+f*v)*this.b1.smass+Z*V*this.b1.sinertia)),this.b2==this.b3&&(X-=2*((m*g+f*v)*this.b2.smass+U*V*this.b2.sinertia)),this.b2==this.b4&&(X+=2*((m*g+f*v)*this.b2.smass+U*q*this.b2.sinertia));var H=X;if(0!=H&&(H=1/H),t=-e*H,this.equal||t<0){var Y=this.b1.imass*t;this.b1.posx-=m*Y,this.b1.posy-=f*Y;var J=this.b2.imass*t;this.b2.posx+=m*J,this.b2.posy+=f*J;var K=this.b3.imass*t;this.b3.posx-=g*K,this.b3.posy-=v*K;var Q=this.b4.imass*t;this.b4.posx+=g*Q,this.b4.posy+=v*Q,this.b1.delta_rot(-Z*this.b1.iinertia*t),this.b2.delta_rot(U*this.b2.iinertia*t),this.b3.delta_rot(-V*this.b3.iinertia*t),this.b4.delta_rot(q*this.b4.iinertia*t)}}return!1},draw:function(e){},__class__:Sp});var Cp=function(e,t){this.jOld=null,this.J=null,this.vec3=null,this.Keff=null,this.jMax=0,this.velonly=!1,this.gamma=0,this.soft=0,this.y=null,this.L=null,this.stepped=!1,this.bias=null,this.jAcc=null,this.dim=0,this.bodies=null,this.outer_zn=null,vp.call(this),this.bodies=[],this.dim=e,this.velonly=t,this.jAcc=[],this.bias=[],this.L=[],this.J=[],this.jOld=[],this.y=[],this.Keff=[],this.vec3=w_.get(0,0,0);for(var n=0,i=e;n<i;){var r=n++,a=this.bias[r]=this.J[r]=this.jOld[r]=this.y[r]=0;this.jAcc[r]=a;for(var s=0,l=e;s<l;){var o=s++;this.L[r*e+o]=0}}this.stepped=!1};(n["zpp_nape.constraint.ZPP_UserConstraint"]=Cp).__name__=["zpp_nape","constraint","ZPP_UserConstraint"],Cp.__super__=vp,Cp.prototype=r(vp.prototype,{outer_zn:null,bindVec2_invalidate:function(e){this.outer_zn.__invalidate()},bodies:null,dim:null,jAcc:null,bias:null,addBody:function(e){for(var t=null,n=0,i=this.bodies;n<i.length;){var r=i[n];if(++n,r.body==e){t=r;break}}null==t?(this.bodies.push(new Np(1,e)),this.active&&null!=this.space&&null!=e&&e.constraints.add(this)):t.cnt++},remBody:function(e){for(var t=null,n=p.int(this.bodies.length),i=0;i<n;){var r=this.bodies[i];if(r.body==e){r.cnt--,0==r.cnt&&(0<n&&(this.bodies[i]=this.bodies[n-1]),this.bodies.pop(),this.active&&null!=this.space&&null!=e&&e.constraints.remove(this)),t=r;break}++i}return null!=t},bodyImpulse:function(e){for(var t=0,n=this.dim;t<n;){var i=t++;this.J[i]=this.jAcc[i]}var r=w_.get(0,0,0);return this.stepped&&this.outer_zn.__impulse(this.J,e.outer,r),r},activeBodies:function(){for(var e=0,t=this.bodies;e<t.length;){var n=t[e];++e,null!=n.body&&n.body.constraints.add(this)}},inactiveBodies:function(){for(var e=0,t=this.bodies;e<t.length;){var n=t[e];++e,null!=n.body&&n.body.constraints.remove(this)}},stepped:null,copy:function(e,t){var n=this.outer_zn.__copy();throw this.copyto(n),new ao("not done yet")},validate:function(){for(var e=0,t=this.bodies;e<t.length;){var n=t[e];if(++e,n.body.space!=this.space)throw new ao("Error: Constraints must have each body within the same sapce to which the constraint has been assigned")}this.outer_zn.__validate()},wake_connected:function(){for(var e=0,t=this.bodies;e<t.length;){var n=t[e];++e,n.body.isDynamic()&&n.body.wake()}},forest:function(){for(var e=0,t=this.bodies;e<t.length;){var n=t[e];if(++e,n.body.isDynamic()){var i,r;if(n.body.component==n.body.component.parent)i=n.body.component;else{for(var a=n.body.component,s=null;a!=a.parent;){var l=a.parent;a.parent=s,s=a,a=l}for(;null!=s;){var o=s.parent;s.parent=a,s=o}i=a}if(this.component==this.component.parent)r=this.component;else{for(var _=this.component,p=null;_!=_.parent;){var u=_.parent;_.parent=p,p=_,_=u}for(;null!=p;){var h=p.parent;p.parent=_,p=h}r=_}i!=r&&(i.rank<r.rank?i.parent=r:i.rank>r.rank?r.parent=i:(r.parent=i).rank++)}}},pair_exists:function(e,t){for(var n=!1,i=p.int(this.bodies.length),r=0,a=i;r<a;){for(var s=r++,l=this.bodies[s].body,o=s+1,_=i;o<_;){var u=o++,h=this.bodies[u].body;if(l.id==e&&h.id==t||l.id==t&&h.id==e){n=!0;break}}if(n)break}return n},broken:function(){this.outer_zn.__broken()},clearcache:function(){for(var e=0,t=this.dim;e<t;){var n=e++;this.jAcc[n]=0}this.pre_dt=-1},lsq:function(e){for(var t=0,n=0,i=this.dim;n<i;){var r=n++;t+=e[r]*e[r]}return t},_clamp:function(e,t){var n=this.lsq(e);if(t*t<n)for(var i=t/Math.sqrt(n),r=0,a=this.dim;r<a;)e[r++]*=i},L:null,solve:function(e){for(var t=0,n=0,i=this.dim;n<i;){for(var r=n++,a=0,s=0,l=r-1;s<l;){var o=s++;a+=this.L[r*this.dim+o]*this.L[r*this.dim+o]}var _=Math.sqrt(e[t++]-a);if(0!=(this.L[r*this.dim+r]=_)){_=1/_;for(var p=r+1,u=this.dim;p<u;){for(var h=p++,c=0,d=0,m=r-1;d<m;){var f=d++;c+=this.L[h*this.dim+f]*this.L[r*this.dim+f]}this.L[h*this.dim+r]=_*(e[t++]-c)}}else{for(var g=r+1,v=this.dim;g<v;){var b=g++;this.L[b*this.dim+r]=0}t+=this.dim-r-1}}return this.L},y:null,transform:function(e,t){for(var n=0,i=this.dim;n<i;){var r=n++,a=t[r],s=e[r*this.dim+r];if(0!=s){for(var l=0,o=r;l<o;){var _=l++;a-=e[r*this.dim+_]*this.y[_]}this.y[r]=a/s}else this.y[r]=0}for(var p=0,u=this.dim;p<u;){var h=p++,c=this.dim-1-h,d=e[c*this.dim+c];if(0!=d){for(var m=this.y[c],f=c+1,g=this.dim;f<g;){var v=f++;m-=e[v*this.dim+c]*t[v]}t[c]=m/d}else t[c]=0}},soft:null,gamma:null,velonly:null,jMax:null,Keff:null,preStep:function(e){this.outer_zn.__validate(),-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;if(this.pre_dt=e,this.stepped=!0,this.outer_zn.__prepare(),this.outer_zn.__eff_mass(this.Keff),this.L=this.solve(this.Keff),this.stiff||this.velonly){for(var n=0,i=this.dim;n<i;){var r=n++;this.bias[r]=0}this.gamma=0,this.soft=1}else{var a,s=2*Math.PI*this.frequency;this.gamma=1/(e*s*(2*this.damping+s*e));var l=1/(1+this.gamma);if(a=e*s*s*this.gamma,this.gamma*=l,this.soft=l,this.outer_zn.__position(this.bias),this.breakUnderError&&this.lsq(this.bias)>this.maxError*this.maxError)return!0;for(var o=0,_=this.dim;o<_;){var p=o++;this.bias[p]*=-a}this._clamp(this.bias,this.maxError)}for(var u=0,h=this.dim;u<h;){var c=u++;this.jAcc[c]*=t}return this.jMax=this.maxForce*e,!1},vec3:null,warmStart:function(){for(var e=0,t=this.bodies;e<t.length;){var n=t[e];++e;var i=n.body;this.outer_zn.__impulse(this.jAcc,i.outer,this.vec3);var r=i.imass;i.velx+=this.vec3.get_x()*r,i.vely+=this.vec3.get_y()*r,i.angvel+=this.vec3.get_z()*i.iinertia}},J:null,jOld:null,applyImpulseVel:function(){this.outer_zn.__velocity(this.J);for(var e=0,t=this.dim;e<t;){var n=e++;this.J[n]=this.bias[n]-this.J[n]}this.transform(this.L,this.J);for(var i=0,r=this.dim;i<r;){var a=i++;this.jOld[a]=this.jAcc[a],this.jAcc[a]+=this.J[a]=this.J[a]*this.soft-this.jAcc[a]*this.gamma}if(this.outer_zn.__clamp(this.jAcc),(this.breakUnderForce||!this.stiff)&&this.lsq(this.jAcc)>this.jMax*this.jMax){if(this.breakUnderForce)return!0;this.stiff||this._clamp(this.jAcc,this.jMax)}for(var s=0,l=this.dim;s<l;){var o=s++;this.J[o]=this.jAcc[o]-this.jOld[o]}for(var _=0,p=this.bodies;_<p.length;){var u=p[_];++_;var h=u.body;this.outer_zn.__impulse(this.J,h.outer,this.vec3);var c=h.imass;h.velx+=this.vec3.get_x()*c,h.vely+=this.vec3.get_y()*c,h.angvel+=this.vec3.get_z()*h.iinertia}return!1},applyImpulsePos:function(){if(this.velonly)return!1;this.outer_zn.__prepare(),this.outer_zn.__position(this.J);var e=this.lsq(this.J);if(this.breakUnderError&&e>this.maxError*this.maxError)return!0;if(e<co.constraintLinearSlop*co.constraintLinearSlop)return!1;for(var t=0,n=this.dim;t<n;){var i=t++;this.J[i]*=-1}this.outer_zn.__eff_mass(this.Keff),this.transform(this.solve(this.Keff),this.J),this.outer_zn.__clamp(this.J);for(var r=0,a=this.bodies;r<a.length;){var s=a[r];++r;var l=s.body;this.outer_zn.__impulse(this.J,l.outer,this.vec3);var o=l.imass;l.posx+=this.vec3.get_x()*o,l.posy+=this.vec3.get_y()*o,l.delta_rot(this.vec3.get_z()*l.iinertia)}return!1},draw:function(e){this.outer_zn.__draw(e)},__class__:Cp});var Np=function(e,t){this.body=null,this.cnt=0,this.cnt=e,this.body=t};(n["zpp_nape.constraint.ZPP_UserBody"]=Np).__name__=["zpp_nape","constraint","ZPP_UserBody"],Np.prototype={cnt:null,body:null,__class__:Np};var Pp=function(){this.stepped=!1,this.biasz=0,this.biasy=0,this.biasx=0,this.gamma=0,this.jMax=0,this.jAccz=0,this.jAccy=0,this.jAccx=0,this.kMassf=0,this.kMasse=0,this.kMassc=0,this.kMassd=0,this.kMassb=0,this.kMassa=0,this.phase=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.outer_zn=null,vp.call(this),this.phase=0,this.jAccx=0,this.jAccy=0,this.jAccz=0,this.jMax=$_.POSINF(),this.stepped=!1,this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0};(n["zpp_nape.constraint.ZPP_WeldJoint"]=Pp).__name__=["zpp_nape","constraint","ZPP_WeldJoint"],Pp.__super__=vp,Pp.prototype=r(vp.prototype,{outer_zn:null,bodyImpulse:function(e){return this.stepped?e==this.b1?w_.get(-this.jAccx,-this.jAccy,-(this.jAccy*this.a1relx-this.jAccx*this.a1rely+this.jAccz)):w_.get(this.jAccx,this.jAccy,this.jAccy*this.a2relx-this.jAccx*this.a2rely+this.jAccz):w_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},b1:null,a1localx:null,a1localy:null,a1relx:null,a1rely:null,validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(e){this.immutable_midstep("Constraint::a1"),this.a1localx=e.x,this.a1localy=e.y,this.wake()},setup_a1:function(){this.wrap_a1=y_.get(this.a1localx,this.a1localy),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=Cc(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=Cc(this,this.invalidate_a1)},wrap_a1:null,b2:null,a2localx:null,a2localy:null,a2relx:null,a2rely:null,validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(e){this.immutable_midstep("Constraint::a2"),this.a2localx=e.x,this.a2localy=e.y,this.wake()},setup_a2:function(){this.wrap_a2=y_.get(this.a2localx,this.a2localy),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=Cc(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=Cc(this,this.invalidate_a2)},wrap_a2:null,phase:null,kMassa:null,kMassb:null,kMassd:null,kMassc:null,kMasse:null,kMassf:null,jAccx:null,jAccy:null,jAccz:null,jMax:null,gamma:null,biasx:null,biasy:null,biasz:null,stepped:null,copy:function(e,t){var n=new Zo(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2());if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(yp.todo(this.b1.id,function(e){n.zpp_inner_zn.b1=e.zpp_inner}))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(yp.todo(this.b2.id,function(e){n.zpp_inner_zn.b2=e.zpp_inner}))}return n},validate:function(){if(null==this.b1||null==this.b2)throw new ao("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new ao("Error: WeldJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new ao("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new ao("Error: Constraints cannot have both bodies non-dynamic")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&this.b2.id==t||this.b1.id==t&&this.b2.id==e},clearcache:function(){this.jAccx=0,this.jAccy=0,this.jAccz=0,this.pre_dt=-1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;this.pre_dt=e,this.stepped=!0,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var n=this.b1.smass+this.b2.smass;if(this.kMassa=n,this.kMassb=0,this.kMassd=n,this.kMassc=0,this.kMasse=0,(this.kMassf=0)!=this.b1.sinertia){var i=this.a1relx*this.b1.sinertia,r=this.a1rely*this.b1.sinertia;this.kMassa+=r*this.a1rely,this.kMassb+=-r*this.a1relx,this.kMassd+=i*this.a1relx,this.kMassc+=-r,this.kMasse+=i,this.kMassf+=this.b1.sinertia}if(0!=this.b2.sinertia){var a=this.a2relx*this.b2.sinertia,s=this.a2rely*this.b2.sinertia;this.kMassa+=s*this.a2rely,this.kMassb+=-s*this.a2relx,this.kMassd+=a*this.a2relx,this.kMassc+=-s,this.kMasse+=a,this.kMassf+=this.b2.sinertia}var l,o=this.kMassa*(this.kMassd*this.kMassf-this.kMasse*this.kMasse)+this.kMassb*(this.kMassc*this.kMasse-this.kMassb*this.kMassf)+this.kMassc*(this.kMassb*this.kMasse-this.kMassc*this.kMassd);if(o!=o)this.kMassa=0,this.kMassb=0,this.kMassd=0,this.kMassc=0,this.kMasse=0,this.kMassf=0,l=7;else if(0==o){var _=0;0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,_|=1),0!=this.kMassd?this.kMassd=1/this.kMassd:(this.kMassd=0,_|=2),0!=this.kMassf?this.kMassf=1/this.kMassf:(this.kMassf=0,_|=4),this.kMassb=this.kMassc=this.kMasse=0,l=_}else{var p=(o=1/o)*(this.kMassd*this.kMassf-this.kMasse*this.kMasse),u=o*(this.kMasse*this.kMassc-this.kMassb*this.kMassf),h=o*(this.kMassa*this.kMassf-this.kMassc*this.kMassc),c=o*(this.kMassb*this.kMasse-this.kMassc*this.kMassd),d=o*(this.kMassb*this.kMassc-this.kMassa*this.kMasse),m=o*(this.kMassa*this.kMassd-this.kMassb*this.kMassb);this.kMassa=p,this.kMassb=u,this.kMassd=h,this.kMassc=c,this.kMasse=d,this.kMassf=m,l=0}if(0!=(1&l)&&(this.jAccx=0),0!=(2&l)&&(this.jAccy=0),0!=(4&l)&&(this.jAccz=0),this.stiff)this.biasx=0,this.biasy=0,this.biasz=0,this.gamma=0;else{var f,g=2*Math.PI*this.frequency;this.gamma=1/(e*g*(2*this.damping+g*e));var v=1/(1+this.gamma);f=e*g*g*this.gamma,this.gamma*=v;var b=v;if(this.kMassa*=b,this.kMassb*=b,this.kMassd*=b,this.kMassc*=b,this.kMasse*=b,this.kMassf*=b,this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),this.biasz=this.b2.rot-this.b1.rot-this.phase,this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy+this.biasz*this.biasz>this.maxError*this.maxError)return!0;var y=-f,x=y;this.biasx*=x,this.biasy*=x,this.biasz*=y;var z=this.maxError,w=this.biasx*this.biasx+this.biasy*this.biasy+this.biasz*this.biasz;if(z*z<w){var k=z*dc.invsqrt(w),S=k;this.biasx*=S,this.biasy*=S,this.biasz*=k}}var C=t,N=C;return this.jAccx*=N,this.jAccy*=N,this.jAccz*=C,this.jMax=this.maxForce*e,!1},warmStart:function(){var e=this.b1.imass;this.b1.velx-=this.jAccx*e,this.b1.vely-=this.jAccy*e;var t=this.b2.imass;this.b2.velx+=this.jAccx*t,this.b2.vely+=this.jAccy*t,this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely+this.jAccz)*this.b1.iinertia,this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely+this.jAccz)*this.b2.iinertia},applyImpulseVel:function(){var e,t,n;e=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel)),t=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel)),n=this.b2.angvel+this.b2.kinangvel-this.b1.angvel-this.b1.kinangvel;var i=0,r=0,a=0;i=this.biasx-e,r=this.biasy-t,a=this.biasz-n;var s=this.kMassa*i+this.kMassb*r+this.kMassc*a,l=this.kMassb*i+this.kMassd*r+this.kMasse*a;a=this.kMassc*i+this.kMasse*r+this.kMassf*a,i=s,r=l;var o,_,p,u=this.gamma,h=u;if(i-=this.jAccx*h,r-=this.jAccy*h,a-=this.jAccz*u,o=this.jAccx,_=this.jAccy,p=this.jAccz,this.jAccx+=1*i,this.jAccy+=1*r,this.jAccz+=1*a,this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy+this.jAccz*this.jAccz>this.jMax*this.jMax)return!0}else if(!this.stiff){var c=this.jMax,d=this.jAccx*this.jAccx+this.jAccy*this.jAccy+this.jAccz*this.jAccz;if(c*c<d){var m=c*dc.invsqrt(d),f=m;this.jAccx*=f,this.jAccy*=f,this.jAccz*=m}}i=this.jAccx-o,r=this.jAccy-_,a=this.jAccz-p;var g=this.b1.imass;this.b1.velx-=i*g,this.b1.vely-=r*g;var v=this.b2.imass;return this.b2.velx+=i*v,this.b2.vely+=r*v,this.b1.angvel-=(r*this.a1relx-i*this.a1rely+a)*this.b1.iinertia,this.b2.angvel+=(r*this.a2relx-i*this.a2rely+a)*this.b2.iinertia,!1},applyImpulsePos:function(){var e,t,n,i;e=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,t=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,n=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,i=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var r=0,a=0,s=0;r=this.b2.posx+n-(this.b1.posx+e),a=this.b2.posy+i-(this.b1.posy+t),s=this.b2.rot-this.b1.rot-this.phase;var l=0,o=0,_=0;if(this.breakUnderError&&r*r+a*a+s*s>this.maxError*this.maxError)return!0;var p=!0;if(r*r+a*a<co.constraintLinearSlop*co.constraintLinearSlop&&(p=!1,a=r=0),dc.sqr(s)<dc.sqr(co.constraintAngularSlop)){if(!p)return!1;s=0}if(s*=.5,6<(r*=.5)*r+(a*=.5)*a){var u=this.b1.smass+this.b2.smass;if(co.epsilon<u){var h=(l=-r*(u=.75/u))*l+(o=-a*u)*o;if(400<h){var c=20*dc.invsqrt(h);l*=c,o*=c}var d=this.b1.imass;this.b1.posx-=l*d,this.b1.posy-=o*d;var m=this.b2.imass;this.b2.posx+=l*m,this.b2.posy+=o*m,r=this.b2.posx+n-(this.b1.posx+e),a=this.b2.posy+i-(this.b1.posy+t),s=this.b2.rot-this.b1.rot-this.phase,r*=.5,a*=.5,s*=.5}}var f=0,g=0,v=0,b=0,y=0,x=0;if(v=f=this.b1.smass+this.b2.smass,(x=y=b=g=0)!=this.b1.sinertia){var z=e*this.b1.sinertia,w=t*this.b1.sinertia;f+=w*t,g+=-w*e,v+=z*e,b+=-w,y+=z,x+=this.b1.sinertia}if(0!=this.b2.sinertia){var k=n*this.b2.sinertia,S=i*this.b2.sinertia;f+=S*i,g+=-S*n,v+=k*n,b+=-S,y+=k,x+=this.b2.sinertia}_=-s;var C=(l=-r)*l+(o=-a)*o;if(36<C){var N=6*dc.invsqrt(C);l*=N,o*=N}dc.clamp2(_,.25);var P=f*(v*x-y*y)+g*(b*y-g*x)+b*(g*y-b*v);if(P!=P)l=o=_=0;else if(0==P)0!=f?l/=f:l=0,0!=v?o/=v:o=0,0!=x?_/=x:_=0;else{var M=y*b-g*x,I=g*y-b*v,T=g*b-f*y,A=(P=1/P)*(l*(v*x-y*y)+o*M+_*I),D=P*(l*M+o*(f*x-b*b)+_*T);_=P*(l*I+o*T+_*(f*v-g*g)),l=A,o=D}var E=this.b1.imass;this.b1.posx-=l*E,this.b1.posy-=o*E;var O=this.b2.imass;return this.b2.posx+=l*O,this.b2.posy+=o*O,this.b1.delta_rot(-(o*e-l*t+_)*this.b1.iinertia),this.b2.delta_rot((o*n-l*i+_)*this.b2.iinertia),!1},draw:function(e){},__class__:Pp});var Mp=function(){this.sensorarb=null,this.fluidarb=null,this.colarb=null,this.type=0,this.pair=null,this.ws2=null,this.ws1=null,this.b2=null,this.b1=null,this.invalidated=!1,this.immState=0,this.fresh=!1,this.continuous=!1,this.presentable=!1,this.intchange=!1,this.present=0,this.sleeping=!1,this.cleared=!1,this.active=!1,this.endGenerated=0,this.sleep_stamp=0,this.up_stamp=0,this.stamp=0,this.di=0,this.id=0,this.hnext=null,this.outer=null};(n["zpp_nape.dynamics.ZPP_Arbiter"]=Mp).__name__=["zpp_nape","dynamics","ZPP_Arbiter"],Mp.prototype={outer:null,wrapper:function(){return null==this.outer&&(Mp.internal=!0,this.type==Mp.COL?(this.colarb.outer_zn=new Jo,this.outer=this.colarb.outer_zn):this.type==Mp.FLUID?(this.fluidarb.outer_zn=new e_,this.outer=this.fluidarb.outer_zn):this.outer=new Wo,this.outer.zpp_inner=this,Mp.internal=!1),this.outer},inactiveme:function(){return!this.active},hnext:null,id:null,di:null,stamp:null,up_stamp:null,sleep_stamp:null,endGenerated:null,active:null,cleared:null,sleeping:null,present:null,intchange:null,presentable:null,continuous:null,fresh:null,immState:null,acting:function(){return!!this.active&&0!=(1&this.immState)},invalidated:null,b1:null,b2:null,ws1:null,ws2:null,pair:null,swap_features:function(){var e=this.b1;this.b1=this.b2,this.b2=e;var t=this.ws1;this.ws1=this.ws2,this.ws2=t;var n=this.colarb.s1;this.colarb.s1=this.colarb.s2,this.colarb.s2=n},type:null,colarb:null,fluidarb:null,sensorarb:null,lazyRetire:function(e,t){this.cleared=!0,null!=t&&this.b2!=t||this.b1.arbiters.inlined_remove(this),null!=t&&this.b1!=t||this.b2.arbiters.inlined_remove(this),null!=this.pair&&(this.pair.arb=null,this.pair=null),this.active=!1,e.f_arbiters.modified=!0},sup_assign:function(e,t,n,i){this.b1=e.body,this.ws1=e,this.b2=t.body,this.ws2=t,this.id=n,this.di=i,this.b1.arbiters.inlined_add(this),this.b2.arbiters.inlined_add(this),this.active=!0,this.present=0,this.cleared=!1,this.sleeping=!1,this.fresh=!1,this.presentable=!1},sup_retire:function(){this.cleared||(this.b1.arbiters.inlined_remove(this),this.b2.arbiters.inlined_remove(this),null!=this.pair&&(this.pair.arb=null,this.pair=null)),this.b1=this.b2=null,this.active=!1,this.intchange=!1},__class__:Mp};var Ip=function(){this.next=null,Mp.call(this),this.type=Mp.SENSOR,this.sensorarb=this};(n["zpp_nape.dynamics.ZPP_SensorArbiter"]=Ip).__name__=["zpp_nape","dynamics","ZPP_SensorArbiter"],Ip.__super__=Mp,Ip.prototype=r(Mp.prototype,{next:null,alloc:function(){},free:function(){},assign:function(e,t,n,i){this.sup_assign(e,t,n,i)},retire:function(){this.sup_retire(),this.free(),this.next=Ip.zpp_pool,Ip.zpp_pool=this},makemutable:function(){},makeimmutable:function(){},__class__:Ip});var Tp=function(){this.pre_dt=0,this.mutable=!1,this.wrap_position=null,this.buoyy=0,this.buoyx=0,this.ny=0,this.nx=0,this.lgamma=0,this.dampy=0,this.dampx=0,this.vMassc=0,this.vMassb=0,this.vMassa=0,this.agamma=0,this.adamp=0,this.wMass=0,this.nodrag=!1,this.r2y=0,this.r2x=0,this.r1y=0,this.r1x=0,this.overlap=0,this.centroidy=0,this.centroidx=0,this.next=null,this.outer_zn=null,Mp.call(this),this.type=Mp.FLUID,(this.fluidarb=this).buoyx=0,this.buoyy=0,this.pre_dt=-1};(n["zpp_nape.dynamics.ZPP_FluidArbiter"]=Tp).__name__=["zpp_nape","dynamics","ZPP_FluidArbiter"],Tp.__super__=Mp,Tp.prototype=r(Mp.prototype,{outer_zn:null,next:null,alloc:function(){},free:function(){},centroidx:null,centroidy:null,overlap:null,r1x:null,r1y:null,r2x:null,r2y:null,nodrag:null,wMass:null,adamp:null,agamma:null,vMassa:null,vMassb:null,vMassc:null,dampx:null,dampy:null,lgamma:null,nx:null,ny:null,buoyx:null,buoyy:null,position_validate:function(){this.wrap_position.zpp_inner.x=this.centroidx,this.wrap_position.zpp_inner.y=this.centroidy},position_invalidate:function(e){this.centroidx=e.x,this.centroidy=e.y},wrap_position:null,getposition:function(){this.wrap_position=y_.get(),this.wrap_position.zpp_inner._inuse=!0,this.wrap_position.zpp_inner._immutable=!this.mutable,this.wrap_position.zpp_inner._validate=Cc(this,this.position_validate),this.wrap_position.zpp_inner._invalidate=Cc(this,this.position_invalidate)},assign:function(e,t,n,i){this.sup_assign(e,t,n,i),this.nx=0,this.ny=1,this.dampx=0,this.dampy=0,this.adamp=0},retire:function(){this.sup_retire(),this.free(),this.next=Tp.zpp_pool,(Tp.zpp_pool=this).pre_dt=-1},mutable:null,makemutable:function(){this.mutable=!0,null!=this.wrap_position&&(this.wrap_position.zpp_inner._immutable=!1)},makeimmutable:function(){this.mutable=!1,null!=this.wrap_position&&(this.wrap_position.zpp_inner._immutable=!0)},inject:function(e,t,n){this.overlap=e,this.centroidx=t,this.centroidy=n},pre_dt:null,preStep:function(e,t){-1==this.pre_dt&&(this.pre_dt=t);var n=t/this.pre_dt;this.pre_dt=t,this.r1x=this.centroidx-this.b1.posx,this.r1y=this.centroidy-this.b1.posy,this.r2x=this.centroidx-this.b2.posx,this.r2y=this.centroidy-this.b2.posy;var i,r=0;i=this.ws1.fluidEnabled&&null!=this.ws1.fluidProperties.wrap_gravity?(r=this.ws1.fluidProperties.gravityx,this.ws1.fluidProperties.gravityy):(r=e.gravityx,e.gravityy);var a,s=0;a=this.ws2.fluidEnabled&&null!=this.ws2.fluidProperties.wrap_gravity?(s=this.ws2.fluidProperties.gravityx,this.ws2.fluidProperties.gravityy):(s=e.gravityx,e.gravityy);var l=0,o=0;if(this.ws1.fluidEnabled&&this.ws2.fluidEnabled){var _=this.overlap*this.ws1.fluidProperties.density,p=this.overlap*this.ws2.fluidProperties.density;if(p<_){var u=_+p;l-=r*u,o-=i*u}else if(_<p){var h=_+p;l+=s*h,o+=a*h}else{var c=0,d=0;if(c=r+s,d=i+a,c*=.5,d*=.5,this.ws1.worldCOMx*c+this.ws1.worldCOMy*d>this.ws2.worldCOMx*c+this.ws2.worldCOMy*d){var m=_+p;l-=c*m,o-=d*m}else{var f=_+p;l+=c*f,o+=d*f}}}else if(this.ws1.fluidEnabled){var g=this.overlap*this.ws1.fluidProperties.density;l-=r*g,o-=i*g}else if(this.ws2.fluidEnabled){var v=this.overlap*this.ws2.fluidProperties.density;l+=s*v,o+=a*v}if(l*=t,o*=t,this.buoyx=l,this.buoyy=o,this.b1.isDynamic()){var b=this.b1.imass;this.b1.velx-=l*b,this.b1.vely-=o*b,this.b1.angvel-=(o*this.r1x-l*this.r1y)*this.b1.iinertia}if(this.b2.isDynamic()){var y=this.b2.imass;this.b2.velx+=l*y,this.b2.vely+=o*y,this.b2.angvel+=(o*this.r2x-l*this.r2y)*this.b2.iinertia}if(this.ws1.fluidEnabled&&0!=this.ws1.fluidProperties.viscosity||this.ws2.fluidEnabled&&0!=this.ws2.fluidProperties.viscosity){this.nodrag=!1;var x=0;if(this.ws1.fluidEnabled&&(this.ws2.validate_angDrag(),x+=this.ws1.fluidProperties.viscosity*this.ws2.angDrag*this.overlap/this.ws2.area),this.ws2.fluidEnabled&&(this.ws1.validate_angDrag(),x+=this.ws2.fluidProperties.viscosity*this.ws1.angDrag*this.overlap/this.ws1.area),0!=x){var z=this.b1.sinertia+this.b2.sinertia;this.wMass=0!=z?1/z:0,x*=4e-4;var w=2*Math.PI*x;this.agamma=1/(t*w*(2+w*t));var k=1/(1+this.agamma);this.agamma,this.agamma*=k,this.wMass*=k}else this.wMass=0,this.agamma=0;var S=this.b2.velx+this.b2.kinvelx-this.r2y*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.r1y*(this.b2.angvel+this.b2.kinangvel)),C=this.b2.vely+this.b2.kinvely+this.r2x*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.r1x*(this.b1.angvel+this.b1.kinangvel));if(!(S*S+C*C<co.epsilon*co.epsilon)){var N=S*S+C*C,P=dc.invsqrt(N);S*=P,C*=P,this.nx=S,this.ny=C}var M=0;if(this.ws1.fluidEnabled){var I=-this.ws1.fluidProperties.viscosity*this.overlap/this.ws2.area;if(0==this.ws2.type)M-=I*this.ws2.circle.radius*co.fluidLinearDrag/(2*this.ws2.circle.radius*Math.PI);else{for(var T=0,A=0,D=this.ws2.polygon.edges.begin();null!=D;){var E=D.elem();T+=E.length;var O=I*E.length*(E.gnormx*this.nx+E.gnormy*this.ny);0<O&&(O=O*=-co.fluidVacuumDrag),A-=.5*O*co.fluidLinearDrag,D=D.next}M+=A/T}}if(this.ws2.fluidEnabled){var B=-this.ws2.fluidProperties.viscosity*this.overlap/this.ws1.area;if(0==this.ws1.type)M-=B*this.ws1.circle.radius*co.fluidLinearDrag/(2*this.ws1.circle.radius*Math.PI);else{for(var L=0,j=0,F=this.ws1.polygon.edges.begin();null!=F;){var R=F.elem();L+=R.length;var G=B*R.length*(R.gnormx*this.nx+R.gnormy*this.ny);0<G&&(G=G*=-co.fluidVacuumDrag),j-=.5*G*co.fluidLinearDrag,F=F.next}M+=j/L}}if(0!=M){var Z=0,U=0,V=0;if(V=Z=this.b1.smass+this.b2.smass,(U=0)!=this.b1.sinertia){var q=this.r1x*this.b1.sinertia,W=this.r1y*this.b1.sinertia;Z+=W*this.r1y,U+=-W*this.r1x,V+=q*this.r1x}if(0!=this.b2.sinertia){var X=this.r2x*this.b2.sinertia,H=this.r2y*this.b2.sinertia;Z+=H*this.r2y,U+=-H*this.r2x,V+=X*this.r2x}var Y=Z*V-U*U;if(Y!=Y)Z=U=V=0;else if(0==Y)0!=Z?Z=1/Z:Z=0,0!=V?V=1/V:V=0,U=0;else{var J=V*(Y=1/Y);V=Z*Y,Z=J,U*=-Y}this.vMassa=Z,this.vMassb=U,this.vMassc=V;var K=2*Math.PI*M;this.lgamma=1/(t*K*(2+K*t));var Q=1/(1+this.lgamma);this.lgamma,this.lgamma*=Q;var $=Q;this.vMassa*=$,this.vMassb*=$,this.vMassc*=$}else this.vMassa=0,this.vMassb=0,this.vMassc=0,this.lgamma=0}else this.nodrag=!0,this.dampx=0,this.dampy=0,this.adamp=0;var ee=n;this.dampx*=ee,this.dampy*=ee,this.adamp*=n},warmStart:function(){var e=this.b1.imass;this.b1.velx-=this.dampx*e,this.b1.vely-=this.dampy*e;var t=this.b2.imass;this.b2.velx+=this.dampx*t,this.b2.vely+=this.dampy*t,this.b1.angvel-=this.b1.iinertia*(this.dampy*this.r1x-this.dampx*this.r1y),this.b2.angvel+=this.b2.iinertia*(this.dampy*this.r2x-this.dampx*this.r2y),this.b1.angvel-=this.adamp*this.b1.iinertia,this.b2.angvel+=this.adamp*this.b2.iinertia},applyImpulseVel:function(){if(!this.nodrag){var e=this.b1.angvel+this.b1.kinangvel,t=this.b2.angvel+this.b2.kinangvel,n=this.b1.velx+this.b1.kinvelx-this.r1y*e-(this.b2.velx+this.b2.kinvelx-this.r2y*t),i=this.b1.vely+this.b1.kinvely+this.r1x*e-(this.b2.vely+this.b2.kinvely+this.r2x*t),r=this.vMassa*n+this.vMassb*i;i=this.vMassb*n+this.vMassc*i,n=r;var a=this.lgamma;n-=this.dampx*a,i-=this.dampy*a,this.dampx+=1*n,this.dampy+=1*i;var s=this.b1.imass;this.b1.velx-=n*s,this.b1.vely-=i*s;var l=this.b2.imass;this.b2.velx+=n*l,this.b2.vely+=i*l,this.b1.angvel-=this.b1.iinertia*(i*this.r1x-n*this.r1y),this.b2.angvel+=this.b2.iinertia*(i*this.r2x-n*this.r2y);var o=(e-t)*this.wMass-this.adamp*this.agamma;this.adamp+=o,this.b1.angvel-=o*this.b1.iinertia,this.b2.angvel+=o*this.b2.iinertia}},__class__:Tp});var Ap=function(){this.pre_dt=0,this.mutable=!1,this.stat=!1,this.next=null,this.hpc2=!1,this.hc2=!1,this.oc2=null,this.c2=null,this.oc1=null,this.c1=null,this.__ref_vertex=0,this.__ref_edge2=null,this.__ref_edge1=null,this.biasCoef=0,this.rev=!1,this.radius=0,this.lproj=0,this.lnormy=0,this.lnormx=0,this.surfacey=0,this.surfacex=0,this.k2y=0,this.k2x=0,this.k1y=0,this.k1x=0,this.rt2b=0,this.rn2b=0,this.rt2a=0,this.rn2a=0,this.rt1b=0,this.rn1b=0,this.rt1a=0,this.rn1a=0,this.jrAcc=0,this.rMass=0,this.Kc=0,this.Kb=0,this.Ka=0,this.kMassc=0,this.kMassb=0,this.kMassa=0,this.wrap_normal=null,this.ny=0,this.nx=0,this.innards=null,this.wrap_contacts=null,this.contacts=null,this.s2=null,this.s1=null,this.userdef_rfric=!1,this.userdef_restitution=!1,this.userdef_stat_fric=!1,this.userdef_dyn_fric=!1,this.rfric=0,this.restitution=0,this.stat_fric=0,this.dyn_fric=0,this.outer_zn=null,Mp.call(this),this.pre_dt=-1,this.contacts=new Dp,this.innards=new Ep,this.type=Mp.COL,this.colarb=this};(n["zpp_nape.dynamics.ZPP_ColArbiter"]=Ap).__name__=["zpp_nape","dynamics","ZPP_ColArbiter"],Ap.__super__=Mp,Ap.prototype=r(Mp.prototype,{outer_zn:null,dyn_fric:null,stat_fric:null,restitution:null,rfric:null,userdef_dyn_fric:null,userdef_stat_fric:null,userdef_restitution:null,userdef_rfric:null,s1:null,s2:null,contacts:null,wrap_contacts:null,innards:null,nx:null,ny:null,normal_validate:function(){if(this.cleared)throw new ao("Error: Arbiter not currently in use");this.wrap_normal.zpp_inner.x=this.nx,this.wrap_normal.zpp_inner.y=this.ny,this.ws1.id>this.ws2.id&&(this.wrap_normal.zpp_inner.x=-this.wrap_normal.zpp_inner.x,this.wrap_normal.zpp_inner.y=-this.wrap_normal.zpp_inner.y)},wrap_normal:null,getnormal:function(){this.wrap_normal=y_.get(0,0),this.wrap_normal.zpp_inner._immutable=!0,this.wrap_normal.zpp_inner._inuse=!0,this.wrap_normal.zpp_inner._validate=Cc(this,this.normal_validate)},kMassa:null,kMassb:null,kMassc:null,Ka:null,Kb:null,Kc:null,rMass:null,jrAcc:null,rn1a:null,rt1a:null,rn1b:null,rt1b:null,rn2a:null,rt2a:null,rn2b:null,rt2b:null,k1x:null,k1y:null,k2x:null,k2y:null,surfacex:null,surfacey:null,ptype:null,lnormx:null,lnormy:null,lproj:null,radius:null,rev:null,biasCoef:null,__ref_edge1:null,__ref_edge2:null,__ref_vertex:null,c1:null,oc1:null,c2:null,oc2:null,hc2:null,hpc2:null,next:null,alloc:function(){},free:function(){this.userdef_dyn_fric=!1,this.userdef_stat_fric=!1,this.userdef_restitution=!1,this.userdef_rfric=!1,this.__ref_edge1=this.__ref_edge2=null},stat:null,injectContact:function(e,t,n,i,r,a,s){null==s&&(s=!1);for(var l=null,o=this.contacts.begin();null!=o;){var _=o.elem();if(a==_.hash){l=_;break}o=o.next}if(null==l){null==Dp.zpp_pool?l=new Dp:(l=Dp.zpp_pool,Dp.zpp_pool=l.next,l.next=null),l.alloc();var p=l.inner;p.jnAcc=p.jtAcc=0,l.hash=a,l.fresh=!0,(l.arbiter=this).jrAcc=0,this.contacts.inlined_add(l),this.innards.add(p)}else l.fresh=!1;return l.px=e,l.py=t,this.nx=n,this.ny=i,l.dist=r,l.stamp=this.stamp,l.posOnly=s,l},assign:function(e,t,n,i){this.sup_assign(e,t,n,i),this.s1=e,this.s2=t,this.calcProperties()},calcProperties:function(){this.userdef_restitution||(this.s1.material.elasticity<=$_.NEGINF()||this.s2.material.elasticity<=$_.NEGINF()?this.restitution=0:this.s1.material.elasticity>=$_.POSINF()||this.s2.material.elasticity>=$_.POSINF()?this.restitution=1:this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2,this.restitution<0&&(this.restitution=0),1<this.restitution&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=dc.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=dc.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=dc.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction))},validate_props:function(){this.invalidated&&(this.invalidated=!1,this.calcProperties())},retire:function(){for(this.sup_retire();!this.contacts.empty();){var e=this.contacts.inlined_pop_unsafe();e.free(),e.next=Dp.zpp_pool,Dp.zpp_pool=e,this.innards.inlined_pop()}this.free(),this.next=Ap.zpp_pool,(Ap.zpp_pool=this).pre_dt=-1},mutable:null,makemutable:function(){this.mutable=!0,null!=this.wrap_normal&&(this.wrap_normal.zpp_inner._immutable=!1),null!=this.wrap_contacts&&(this.wrap_contacts.zpp_inner.immutable=!1)},makeimmutable:function(){this.mutable=!1,null!=this.wrap_normal&&(this.wrap_normal.zpp_inner._immutable=!0),null!=this.wrap_contacts&&(this.wrap_contacts.zpp_inner.immutable=!0)},contacts_adder:function(e){return!1},contacts_subber:function(e){for(var t=null,n=null,i=this.innards.begin(),r=this.contacts.begin();null!=r;){var a=r.elem();if(a==e.zpp_inner){this.contacts.erase(t),this.innards.erase(n);var s=a;s.free(),s.next=Dp.zpp_pool,Dp.zpp_pool=s;break}t=r,i=(n=i).next,r=r.next}},setupcontacts:function(){this.wrap_contacts=cc.get(this.contacts,!0),this.wrap_contacts.zpp_inner.immutable=!this.mutable,this.wrap_contacts.zpp_inner.adder=Cc(this,this.contacts_adder),this.wrap_contacts.zpp_inner.dontremove=!0,this.wrap_contacts.zpp_inner.subber=Cc(this,this.contacts_subber)},cleanupContacts:function(){var e=!0,t=null,n=null,i=this.innards.begin();this.hc2=!1;for(var r=this.contacts.begin();null!=r;){var a=r.elem();if(a.stamp+co.arbiterExpirationDelay<this.stamp){r=this.contacts.inlined_erase(t),i=this.innards.inlined_erase(n);var s=a;s.free(),s.next=Dp.zpp_pool,Dp.zpp_pool=s}else{var l=a.inner,o=a.active;a.active=a.stamp==this.stamp,a.active&&(e?(e=!1,this.c1=l,this.oc1=a):(this.hc2=!0,this.c2=l,this.oc2=a)),o!=a.active&&(this.contacts.modified=!0),t=r,i=(n=i).next,r=r.next}}if(this.hc2){if(this.hpc2=!0,this.oc1.posOnly){var _=this.c1;this.c1=this.c2,this.c2=_;var p=this.oc1;this.oc1=this.oc2,this.oc2=p,this.hc2=!1}else this.oc2.posOnly&&(this.hc2=!1);this.oc1.posOnly&&(e=!0)}else this.hpc2=!1;return e},pre_dt:null,preStep:function(e){this.validate_props(),-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;this.pre_dt=e;var n=this.b1.smass+this.b2.smass,i=!(this.hc2=!1),r=this.b1.isDynamic()&&this.b2.isDynamic()?this.continuous?co.contactContinuousBiasCoef:co.contactBiasCoef:this.continuous?co.contactContinuousStaticBiasCoef:co.contactStaticBiasCoef;this.biasCoef=r,this.continuous=!1;for(var a=null,s=null,l=this.innards.begin(),o=this.contacts.begin();null!=o;){var _=o.elem();if(_.stamp+co.arbiterExpirationDelay<this.stamp){o=this.contacts.inlined_erase(a),l=this.innards.inlined_erase(s);var p=_;p.free(),p.next=Dp.zpp_pool,Dp.zpp_pool=p}else{var u=_.inner,h=_.active;if(_.active=_.stamp==this.stamp,_.active){i?(i=!1,this.c1=u,this.oc1=_):(this.hc2=!0,this.c2=u,this.oc2=_),u.r2x=_.px-this.b2.posx,u.r2y=_.py-this.b2.posy,u.r1x=_.px-this.b1.posx,u.r1y=_.py-this.b1.posy;var c=n+this.b2.sinertia*dc.sqr(u.r2x*this.nx+u.r2y*this.ny);c+=this.b1.sinertia*dc.sqr(u.r1x*this.nx+u.r1y*this.ny),u.tMass=c<co.epsilon*co.epsilon?0:1/c;var d=n+this.b2.sinertia*dc.sqr(this.ny*u.r2x-this.nx*u.r2y);d+=this.b1.sinertia*dc.sqr(this.ny*u.r1x-this.nx*u.r1y),u.nMass=d<co.epsilon*co.epsilon?0:1/d;var m=0,f=0,g=this.b2.angvel+this.b2.kinangvel;m=this.b2.velx+this.b2.kinvelx-u.r2y*g,f=this.b2.vely+this.b2.kinvely+u.r2x*g,g=this.b1.angvel+this.b1.kinangvel,m-=this.b1.velx+this.b1.kinvelx-u.r1y*g,f-=this.b1.vely+this.b1.kinvely+u.r1x*g;var v=this.nx*m+this.ny*f;_.elasticity=this.restitution,u.bounce=v*_.elasticity,u.bounce>-co.elasticThreshold&&(u.bounce=0),v=f*this.nx-m*this.ny;var b=co.staticFrictionThreshold;u.friction=b*b<v*v?this.dyn_fric:this.stat_fric,u.jnAcc*=t,u.jtAcc*=t}h!=_.active&&(this.contacts.modified=!0),a=o,l=(s=l).next,o=o.next}}if(this.hc2){if(this.hpc2=!0,this.oc1.posOnly){var y=this.c1;this.c1=this.c2,this.c2=y;var x=this.oc1;this.oc1=this.oc2,this.oc2=x,this.hc2=!1}else this.oc2.posOnly&&(this.hc2=!1);this.oc1.posOnly&&(i=!0)}else this.hpc2=!1;if(this.jrAcc*=t,i||(this.rn1a=this.ny*this.c1.r1x-this.nx*this.c1.r1y,this.rt1a=this.c1.r1x*this.nx+this.c1.r1y*this.ny,this.rn1b=this.ny*this.c1.r2x-this.nx*this.c1.r2y,this.rt1b=this.c1.r2x*this.nx+this.c1.r2y*this.ny,this.k1x=this.b2.kinvelx-this.c1.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c1.r1y*this.b1.kinangvel),this.k1y=this.b2.kinvely+this.c1.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c1.r1x*this.b1.kinangvel)),this.hc2)if(this.rn2a=this.ny*this.c2.r1x-this.nx*this.c2.r1y,this.rt2a=this.c2.r1x*this.nx+this.c2.r1y*this.ny,this.rn2b=this.ny*this.c2.r2x-this.nx*this.c2.r2y,this.rt2b=this.c2.r2x*this.nx+this.c2.r2y*this.ny,this.k2x=this.b2.kinvelx-this.c2.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c2.r1y*this.b1.kinangvel),this.k2y=this.b2.kinvely+this.c2.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c2.r1x*this.b1.kinangvel),this.kMassa=n+this.b1.sinertia*this.rn1a*this.rn1a+this.b2.sinertia*this.rn1b*this.rn1b,this.kMassb=n+this.b1.sinertia*this.rn1a*this.rn2a+this.b2.sinertia*this.rn1b*this.rn2b,this.kMassc=n+this.b1.sinertia*this.rn2a*this.rn2a+this.b2.sinertia*this.rn2b*this.rn2b,this.kMassa*this.kMassa+2*this.kMassb*this.kMassb+this.kMassc*this.kMassc<co.illConditionedThreshold*(this.kMassa*this.kMassc-this.kMassb*this.kMassb)){this.Ka=this.kMassa,this.Kb=this.kMassb,this.Kc=this.kMassc;var z=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(z!=z)this.kMassa=this.kMassb=this.kMassc=0;else if(0==z)0!=this.kMassa?this.kMassa=1/this.kMassa:this.kMassa=0,0!=this.kMassc?this.kMassc=1/this.kMassc:this.kMassc=0,this.kMassb=0;else{z=1/z;var w=this.kMassc*z;this.kMassc=this.kMassa*z,this.kMassa=w,this.kMassb*=-z}}else{if(this.hc2=!1,this.oc2.dist<this.oc1.dist){var k=this.c1;this.c1=this.c2,this.c2=k}this.oc2.active=!1,this.contacts.modified=!0}return this.surfacex=this.b2.svelx,this.surfacey=this.b2.svely,this.surfacex+=1*this.b1.svelx,this.surfacey+=1*this.b1.svely,this.surfacex=-this.surfacex,this.surfacey=-this.surfacey,this.rMass=this.b1.sinertia+this.b2.sinertia,0!=this.rMass&&(this.rMass=1/this.rMass),i},warmStart:function(){var e=this.nx*this.c1.jnAcc-this.ny*this.c1.jtAcc,t=this.ny*this.c1.jnAcc+this.nx*this.c1.jtAcc,n=this.b1.imass;this.b1.velx-=e*n,this.b1.vely-=t*n,this.b1.angvel-=this.b1.iinertia*(t*this.c1.r1x-e*this.c1.r1y);var i=this.b2.imass;if(this.b2.velx+=e*i,this.b2.vely+=t*i,this.b2.angvel+=this.b2.iinertia*(t*this.c1.r2x-e*this.c1.r2y),this.hc2){var r=this.nx*this.c2.jnAcc-this.ny*this.c2.jtAcc,a=this.ny*this.c2.jnAcc+this.nx*this.c2.jtAcc,s=this.b1.imass;this.b1.velx-=r*s,this.b1.vely-=a*s,this.b1.angvel-=this.b1.iinertia*(a*this.c2.r1x-r*this.c2.r1y);var l=this.b2.imass;this.b2.velx+=r*l,this.b2.vely+=a*l,this.b2.angvel+=this.b2.iinertia*(a*this.c2.r2x-r*this.c2.r2y)}this.b2.angvel+=this.jrAcc*this.b2.iinertia,this.b1.angvel-=this.jrAcc*this.b1.iinertia},applyImpulseVel:function(){var e,t,n,i,r,a,s=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),l=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel);if(n=(l*this.nx-s*this.ny+this.surfacex)*this.c1.tMass,(i=this.c1.friction*this.c1.jnAcc)<(a=(r=this.c1.jtAcc)-n)?a=i:a<-i&&(a=-i),n=a-r,this.c1.jtAcc=a,e=-this.ny*n,t=this.nx*n,this.b2.velx+=e*this.b2.imass,this.b2.vely+=t*this.b2.imass,this.b1.velx-=e*this.b1.imass,this.b1.vely-=t*this.b1.imass,this.b2.angvel+=this.rt1b*n*this.b2.iinertia,this.b1.angvel-=this.rt1a*n*this.b1.iinertia,this.hc2){var o=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),_=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel);n=(_*this.nx-o*this.ny+this.surfacex)*this.c2.tMass,(i=this.c2.friction*this.c2.jnAcc)<(a=(r=this.c2.jtAcc)-n)?a=i:a<-i&&(a=-i),n=a-r,this.c2.jtAcc=a,e=-this.ny*n,t=this.nx*n,this.b2.velx+=e*this.b2.imass,this.b2.vely+=t*this.b2.imass,this.b1.velx-=e*this.b1.imass,this.b1.vely-=t*this.b1.imass,this.b2.angvel+=this.rt2b*n*this.b2.iinertia,this.b1.angvel-=this.rt2a*n*this.b1.iinertia,s=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),l=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),o=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),_=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel);var p=this.c1.jnAcc,u=this.c2.jnAcc,h=s*this.nx+l*this.ny+this.surfacey+this.c1.bounce-(this.Ka*p+this.Kb*u),c=o*this.nx+_*this.ny+this.surfacey+this.c2.bounce-(this.Kb*p+this.Kc*u),d=-(this.kMassa*h+this.kMassb*c),m=-(this.kMassb*h+this.kMassc*c);0<=d&&0<=m?(h=d-p,c=m-u,this.c1.jnAcc=d,this.c2.jnAcc=m):0<=(d=-this.c1.nMass*h)&&0<=this.Kb*d+c?(h=d-p,c=-u,this.c1.jnAcc=d,this.c2.jnAcc=0):0<=(m=-this.c2.nMass*c)&&0<=this.Kb*m+h?(h=-p,c=m-u,this.c1.jnAcc=0,this.c2.jnAcc=m):0<=h&&0<=c?(h=-p,c=-u,this.c1.jnAcc=this.c2.jnAcc=0):c=h=0,n=h+c,e=this.nx*n,t=this.ny*n,this.b2.velx+=e*this.b2.imass,this.b2.vely+=t*this.b2.imass,this.b1.velx-=e*this.b1.imass,this.b1.vely-=t*this.b1.imass,this.b2.angvel+=(this.rn1b*h+this.rn2b*c)*this.b2.iinertia,this.b1.angvel-=(this.rn1a*h+this.rn2a*c)*this.b1.iinertia}else 0!=this.radius&&(n=(this.b2.angvel-this.b1.angvel)*this.rMass,i=this.rfric*this.c1.jnAcc,r=this.jrAcc,this.jrAcc-=n,this.jrAcc>i?this.jrAcc=i:this.jrAcc<-i&&(this.jrAcc=-i),n=this.jrAcc-r,this.b2.angvel+=n*this.b2.iinertia,this.b1.angvel-=n*this.b1.iinertia),s=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),l=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),n=(this.c1.bounce+(this.nx*s+this.ny*l)+this.surfacey)*this.c1.nMass,(a=(r=this.c1.jnAcc)-n)<0&&(a=0),n=a-r,this.c1.jnAcc=a,e=this.nx*n,t=this.ny*n,this.b2.velx+=e*this.b2.imass,this.b2.vely+=t*this.b2.imass,this.b1.velx-=e*this.b1.imass,this.b1.vely-=t*this.b1.imass,this.b2.angvel+=this.rn1b*n*this.b2.iinertia,this.b1.angvel-=this.rn1a*n*this.b1.iinertia},applyImpulsePos:function(){if(2==this.ptype){var e=this.c1,t=0,n=0;t=this.b2.axisy*e.lr2x-this.b2.axisx*e.lr2y,n=e.lr2x*this.b2.axisx+e.lr2y*this.b2.axisy,t+=1*this.b2.posx,n+=1*this.b2.posy;var i=0,r=0;i=this.b1.axisy*e.lr1x-this.b1.axisx*e.lr1y,r=e.lr1x*this.b1.axisx+e.lr1y*this.b1.axisy;var a=0,s=0;a=t-(i+=1*this.b1.posx),s=n-(r+=1*this.b1.posy);var l=dc.sqrt(a*a+s*s),o=this.radius-co.collisionSlop,_=l-o;if(a*this.nx+s*this.ny<0&&(a=-a,s=-s,_-=this.radius),_<0)if(l<co.epsilon)0!=this.b1.smass?this.b1.posx+=10*co.epsilon:this.b2.posx+=10*co.epsilon;else{var p=1/l;a*=p;var u=.5*(i+t),h=.5*(r+n),c=l-o,d=(s*=p)*(i=u-this.b1.posx)-a*(r=h-this.b1.posy),m=s*(t=u-this.b2.posx)-a*(n=h-this.b2.posy),f=this.b2.smass+m*m*this.b2.sinertia+this.b1.smass+d*d*this.b1.sinertia;if(0!=f){var g,v,b=-this.biasCoef*c/f;g=a*b,v=s*b;var y=this.b1.imass;this.b1.posx-=g*y,this.b1.posy-=v*y,this.b1.delta_rot(-d*this.b1.iinertia*b);var x=this.b2.imass;this.b2.posx+=g*x,this.b2.posy+=v*x,this.b2.delta_rot(m*this.b2.iinertia*b)}}}else{var z,w=0,k=0,S=0,C=0,N=0,P=0;0==this.ptype?(w=this.b1.axisy*this.lnormx-this.b1.axisx*this.lnormy,k=this.lnormx*this.b1.axisx+this.lnormy*this.b1.axisy,z=this.lproj+(w*this.b1.posx+k*this.b1.posy),S=this.b2.axisy*this.c1.lr1x-this.b2.axisx*this.c1.lr1y,C=this.c1.lr1x*this.b2.axisx+this.c1.lr1y*this.b2.axisy,S+=1*this.b2.posx,C+=1*this.b2.posy,this.hpc2&&(N=this.b2.axisy*this.c2.lr1x-this.b2.axisx*this.c2.lr1y,P=this.c2.lr1x*this.b2.axisx+this.c2.lr1y*this.b2.axisy,N+=1*this.b2.posx,P+=1*this.b2.posy)):(w=this.b2.axisy*this.lnormx-this.b2.axisx*this.lnormy,k=this.lnormx*this.b2.axisx+this.lnormy*this.b2.axisy,z=this.lproj+(w*this.b2.posx+k*this.b2.posy),S=this.b1.axisy*this.c1.lr1x-this.b1.axisx*this.c1.lr1y,C=this.c1.lr1x*this.b1.axisx+this.c1.lr1y*this.b1.axisy,S+=1*this.b1.posx,C+=1*this.b1.posy,this.hpc2&&(N=this.b1.axisy*this.c2.lr1x-this.b1.axisx*this.c2.lr1y,P=this.c2.lr1x*this.b1.axisx+this.c2.lr1y*this.b1.axisy,N+=1*this.b1.posx,P+=1*this.b1.posy));var M=S*w+C*k-z-this.radius;M+=co.collisionSlop;var I,T,A,D,E=0;if(this.hpc2&&(E=N*w+P*k-z-this.radius,E+=co.collisionSlop),M<0||E<0)if(this.rev&&(w=-w,k=-k),I=S-this.b1.posx,T=C-this.b1.posy,A=S-this.b2.posx,D=C-this.b2.posy,this.hpc2){var O,B,L,j=k*I-w*T,F=k*A-w*D,R=k*(N-this.b1.posx)-w*(P-this.b1.posy),G=k*(N-this.b2.posx)-w*(P-this.b2.posy),Z=this.b1.smass+this.b2.smass;this.kMassa=Z+this.b1.sinertia*j*j+this.b2.sinertia*F*F,this.kMassb=Z+this.b1.sinertia*j*R+this.b2.sinertia*F*G,this.kMassc=Z+this.b1.sinertia*R*R+this.b2.sinertia*G*G,O=this.kMassa,B=this.kMassb,L=this.kMassc;for(var U=M*this.biasCoef,V=E*this.biasCoef;;){var q=0,W=0;q=-(q=U),W=-(W=V);var X=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(X!=X)q=W=0;else if(0==X)0!=this.kMassa?q/=this.kMassa:q=0,0!=this.kMassc?W/=this.kMassc:W=0;else{var H=(X=1/X)*(this.kMassc*q-this.kMassb*W);W=X*(this.kMassa*W-this.kMassb*q),q=H}if(0<=q&&0<=W){var Y=(q+W)*this.b1.imass;this.b1.posx-=w*Y,this.b1.posy-=k*Y,this.b1.delta_rot(-this.b1.iinertia*(j*q+R*W));var J=(q+W)*this.b2.imass;this.b2.posx+=w*J,this.b2.posy+=k*J,this.b2.delta_rot(this.b2.iinertia*(F*q+G*W));break}if((W=0)<=(q=-U/O)&&0<=B*q+V){var K=(q+W)*this.b1.imass;this.b1.posx-=w*K,this.b1.posy-=k*K,this.b1.delta_rot(-this.b1.iinertia*(j*q+R*W));var Q=(q+W)*this.b2.imass;this.b2.posx+=w*Q,this.b2.posy+=k*Q,this.b2.delta_rot(this.b2.iinertia*(F*q+G*W));break}if((q=0)<=(W=-V/L)&&0<=B*W+U){var $=(q+W)*this.b1.imass;this.b1.posx-=w*$,this.b1.posy-=k*$,this.b1.delta_rot(-this.b1.iinertia*(j*q+R*W));var ee=(q+W)*this.b2.imass;this.b2.posx+=w*ee,this.b2.posy+=k*ee,this.b2.delta_rot(this.b2.iinertia*(F*q+G*W));break}break}}else{var te=k*I-w*T,ne=k*A-w*D,ie=this.b2.smass+ne*ne*this.b2.sinertia+this.b1.smass+te*te*this.b1.sinertia;if(0!=ie){var re,ae,se=-this.biasCoef*M/ie;re=w*se,ae=k*se;var le=this.b1.imass;this.b1.posx-=re*le,this.b1.posy-=ae*le,this.b1.delta_rot(-te*this.b1.iinertia*se);var oe=this.b2.imass;this.b2.posx+=re*oe,this.b2.posy+=ae*oe,this.b2.delta_rot(ne*this.b2.iinertia*se)}}}},__class__:Ap});var Dp=function(){this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.elasticity=0,this.dist=0,this.fresh=!1,this.hash=0,this.stamp=0,this.posOnly=!1,this.active=!1,this.inner=null,this.arbiter=null,this.wrap_position=null,this.py=0,this.px=0,this.outer=null,this.inner=new Ep};(n["zpp_nape.dynamics.ZPP_Contact"]=Dp).__name__=["zpp_nape","dynamics","ZPP_Contact"],Dp.prototype={outer:null,wrapper:function(){return null==this.outer&&(Dp.internal=!0,this.outer=new Ko,Dp.internal=!1,this.outer.zpp_inner=this),this.outer},px:null,py:null,position_validate:function(){this.wrap_position.zpp_inner.x=this.px,this.wrap_position.zpp_inner.y=this.py},wrap_position:null,getposition:function(){this.wrap_position=y_.get(),this.wrap_position.zpp_inner._inuse=!0,this.wrap_position.zpp_inner._immutable=!0,this.wrap_position.zpp_inner._validate=Cc(this,this.position_validate)},inactiveme:function(){return!(this.active&&null!=this.arbiter&&!this.arbiter.inactiveme())},arbiter:null,inner:null,active:null,posOnly:null,stamp:null,hash:null,fresh:null,dist:null,elasticity:null,free:function(){this.arbiter=null},alloc:function(){},next:null,elem:function(){return this},begin:function(){return this.next},_inuse:null,modified:null,pushmod:null,length:null,setbegin:function(e){this.next=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){e._inuse=!0;var t=e;return t.next=this.begin(),this.next=t,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){t._inuse=!0;var n=t;return null==e?(n.next=this.begin(),this.next=n):(n.next=e.next,e.next=n),this.pushmod=this.modified=!0,this.length++,n},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.next=e.next,e.elem()._inuse=!1,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;return null==e?(n=(t=this.begin()).next,this.next=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0)),t.elem()._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.next=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Dp};var Ep=function(){this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.lr2y=0,this.lr2x=0,this.lr1y=0,this.lr1x=0,this.jtAcc=0,this.jnAcc=0,this.friction=0,this.bounce=0,this.tMass=0,this.nMass=0,this.r2y=0,this.r2x=0,this.r1y=0,this.r1x=0};(n["zpp_nape.dynamics.ZPP_IContact"]=Ep).__name__=["zpp_nape","dynamics","ZPP_IContact"],Ep.prototype={r1x:null,r1y:null,r2x:null,r2y:null,nMass:null,tMass:null,bounce:null,friction:null,jnAcc:null,jtAcc:null,lr1x:null,lr1y:null,lr2x:null,lr2y:null,next:null,elem:function(){return this},begin:function(){return this.next},_inuse:null,modified:null,pushmod:null,length:null,setbegin:function(e){this.next=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){e._inuse=!0;var t=e;return t.next=this.begin(),this.next=t,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){t._inuse=!0;var n=t;return null==e?(n.next=this.begin(),this.next=n):(n.next=e.next,e.next=n),this.pushmod=this.modified=!0,this.length++,n},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.next=e.next,e.elem()._inuse=!1,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;return null==e?(n=(t=this.begin()).next,this.next=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0)),t.elem()._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.next=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Ep};var Op=function(){this.depth=0,this.wrap_interactors=null,this.interactors=null,this.wrap_groups=null,this.groups=null,this.group=null,this.ignore=!1,this.outer=null,this.depth=0,this.groups=new oh,this.interactors=new op};(n["zpp_nape.dynamics.ZPP_InteractionGroup"]=Op).__name__=["zpp_nape","dynamics","ZPP_InteractionGroup"],Op.prototype={outer:null,ignore:null,group:null,setGroup:function(e){this.group!=e&&(null!=this.group&&(this.group.remGroup(this),this.group.invalidate(!0)),null!=(this.group=e)?(e.addGroup(this),e.invalidate(!0)):this.invalidate(!0))},groups:null,wrap_groups:null,interactors:null,wrap_interactors:null,depth:null,invalidate:function(e){if(null==e&&(e=!1),e||this.ignore){for(var t=this.interactors.begin();null!=t;){var n=t.elem();n.isBody()?n.ibody.wake():n.isShape()?n.ishape.body.wake():n.icompound.wake(),t=t.next}for(var i=this.groups.begin();null!=i;)i.elem().invalidate(e),i=i.next}},addGroup:function(e){this.groups.add(e),e.depth=this.depth+1},remGroup:function(e){this.groups.remove(e),e.depth=0},addInteractor:function(e){this.interactors.add(e)},remInteractor:function(e,t){null==t&&(t=-1),this.interactors.remove(e)},__class__:Op};var Bp=function(){this.at_index_3=0,this.at_index_2=0,this.at_index_1=0,this.at_index_0=0,this.ite_3=null,this.ite_2=null,this.ite_1=null,this.ite_0=null,this.lengths=null,this.zip_length=!1,this._length=0,this.space=null,Ho.call(this),this.at_index_0=0,this.at_index_1=0,this.at_index_2=0,this.at_index_3=0,this.zip_length=!0,this._length=0,this.lengths=[];for(var e=0;e<4;)e++,this.lengths.push(0)};(n["zpp_nape.dynamics.ZPP_SpaceArbiterList"]=Bp).__name__=["zpp_nape","dynamics","ZPP_SpaceArbiterList"],Bp.__super__=Ho,Bp.prototype=r(Ho.prototype,{space:null,_length:null,zip_length:null,zpp_gl:function(){if(this.zpp_vm(),this.zip_length){for(var e=this._length=0,t=0,n=this.space.c_arbiters_true.begin();null!=n;)n.elem().active&&++t,n=n.next;this.lengths[e++]=t,this._length+=t;for(var i=0,r=this.space.c_arbiters_false.begin();null!=r;)r.elem().active&&++i,r=r.next;this.lengths[e++]=i,this._length+=i;for(var a=0,s=this.space.f_arbiters.begin();null!=s;)s.elem().active&&++a,s=s.next;this.lengths[e++]=a,this._length+=a;for(var l=0,o=this.space.s_arbiters.begin();null!=o;)o.elem().active&&++l,o=o.next;this.lengths[e++]=l,this._length+=l,this.zip_length=!1}return this._length},lengths:null,ite_0:null,ite_1:null,ite_2:null,ite_3:null,at_index_0:null,at_index_1:null,at_index_2:null,at_index_3:null,zpp_vm:function(){var e=!1;this.space.c_arbiters_true.modified&&(e=!0,this.space.c_arbiters_true.modified=!1),this.space.c_arbiters_false.modified&&(e=!0,this.space.c_arbiters_false.modified=!1),this.space.f_arbiters.modified&&(e=!0,this.space.f_arbiters.modified=!1),this.space.s_arbiters.modified&&(e=!0,this.space.s_arbiters.modified=!1),e&&(this.zip_length=!0,this._length=0,this.ite_0=null,this.ite_1=null,this.ite_2=null,this.ite_3=null)},push:function(e){return!1},pop:function(){return null},unshift:function(e){return!1},shift:function(){return null},remove:function(e){return!1},clear:function(){},at:function(e){this.zpp_vm();var t=null,n=0;if(null==t)if(e<n+this.lengths[0]){var i=e-n;if(i<this.at_index_0||null==this.ite_0)for(this.at_index_0=0,this.ite_0=this.space.c_arbiters_true.begin();!this.ite_0.elem().active;)this.ite_0=this.ite_0.next;for(;this.at_index_0!=i;)for(this.at_index_0++,this.ite_0=this.ite_0.next;!this.ite_0.elem().active;)this.ite_0=this.ite_0.next;t=this.ite_0.elem().wrapper()}else n+=this.lengths[0];if(null==t)if(e<n+this.lengths[1]){var r=e-n;if(r<this.at_index_1||null==this.ite_1)for(this.at_index_1=0,this.ite_1=this.space.c_arbiters_false.begin();!this.ite_1.elem().active;)this.ite_1=this.ite_1.next;for(;this.at_index_1!=r;)for(this.at_index_1++,this.ite_1=this.ite_1.next;!this.ite_1.elem().active;)this.ite_1=this.ite_1.next;t=this.ite_1.elem().wrapper()}else n+=this.lengths[1];if(null==t)if(e<n+this.lengths[2]){var a=e-n;if(a<this.at_index_2||null==this.ite_2)for(this.at_index_2=0,this.ite_2=this.space.f_arbiters.begin();!this.ite_2.elem().active;)this.ite_2=this.ite_2.next;for(;this.at_index_2!=a;)for(this.at_index_2++,this.ite_2=this.ite_2.next;!this.ite_2.elem().active;)this.ite_2=this.ite_2.next;t=this.ite_2.elem().wrapper()}else n+=this.lengths[2];if(null==t)if(e<n+this.lengths[3]){var s=e-n;if(s<this.at_index_3||null==this.ite_3)for(this.at_index_3=0,this.ite_3=this.space.s_arbiters.begin();!this.ite_3.elem().active;)this.ite_3=this.ite_3.next;for(;this.at_index_3!=s;)for(this.at_index_3++,this.ite_3=this.ite_3.next;!this.ite_3.elem().active;)this.ite_3=this.ite_3.next;t=this.ite_3.elem().wrapper()}else n+=this.lengths[3];return t},__class__:Bp});var Lp=function(){this.wrap_max=null,this.maxy=0,this.maxx=0,this.wrap_min=null,this.miny=0,this.minx=0,this.next=null,this.outer=null,this._immutable=!1,this._validate=null,this._invalidate=null};(n["zpp_nape.geom.ZPP_AABB"]=Lp).__name__=["zpp_nape","geom","ZPP_AABB"],Lp.get=function(e,t,n,i){var r;return null==Lp.zpp_pool?r=new Lp:(r=Lp.zpp_pool,Lp.zpp_pool=r.next,r.next=null),r.alloc(),r.minx=e,r.miny=t,r.maxx=n,r.maxy=i,r},Lp.prototype={_invalidate:null,_validate:null,_immutable:null,validate:function(){null!=this._validate&&this._validate()},invalidate:function(){null!=this._invalidate&&this._invalidate(this)},outer:null,wrapper:function(){if(null==this.outer){this.outer=new r_;var e=this.outer.zpp_inner;e.free(),e.next=Lp.zpp_pool,Lp.zpp_pool=e,this.outer.zpp_inner=this}return this.outer},next:null,alloc:function(){},free:function(){null!=this.outer&&(this.outer.zpp_inner=null,this.outer=null),this.wrap_min=this.wrap_max=null,this._invalidate=null,this._validate=null},copy:function(){return Lp.get(this.minx,this.miny,this.maxx,this.maxy)},width:function(){return this.maxx-this.minx},height:function(){return this.maxy-this.miny},perimeter:function(){return 2*(this.width()+this.height())},minx:null,miny:null,wrap_min:null,getmin:function(){return null==this.wrap_min&&(this.wrap_min=y_.get(this.minx,this.miny),this.wrap_min.zpp_inner._inuse=!0,this._immutable?this.wrap_min.zpp_inner._immutable=!0:this.wrap_min.zpp_inner._invalidate=Cc(this,this.mod_min),this.wrap_min.zpp_inner._validate=Cc(this,this.dom_min)),this.wrap_min},dom_min:function(){this.validate(),this.wrap_min.zpp_inner.x=this.minx,this.wrap_min.zpp_inner.y=this.miny},mod_min:function(e){e.x==this.minx&&e.y==this.miny||(this.minx=e.x,this.miny=e.y,this.invalidate())},maxx:null,maxy:null,wrap_max:null,getmax:function(){return null==this.wrap_max&&(this.wrap_max=y_.get(this.maxx,this.maxy),this.wrap_max.zpp_inner._inuse=!0,this._immutable?this.wrap_max.zpp_inner._immutable=!0:this.wrap_max.zpp_inner._invalidate=Cc(this,this.mod_max),this.wrap_max.zpp_inner._validate=Cc(this,this.dom_max)),this.wrap_max},dom_max:function(){this.validate(),this.wrap_max.zpp_inner.x=this.maxx,this.wrap_max.zpp_inner.y=this.maxy},mod_max:function(e){e.x==this.maxx&&e.y==this.maxy||(this.maxx=e.x,this.maxy=e.y,this.invalidate())},intersectX:function(e){return!(e.minx>this.maxx||this.minx>e.maxx)},intersectY:function(e){return!(e.miny>this.maxy||this.miny>e.maxy)},intersect:function(e){return e.miny<=this.maxy&&this.miny<=e.maxy&&e.minx<=this.maxx&&this.minx<=e.maxx},combine:function(e){e.minx<this.minx&&(this.minx=e.minx),e.maxx>this.maxx&&(this.maxx=e.maxx),e.miny<this.miny&&(this.miny=e.miny),e.maxy>this.maxy&&(this.maxy=e.maxy)},contains:function(e){return e.minx>=this.minx&&e.miny>=this.miny&&e.maxx<=this.maxx&&e.maxy<=this.maxy},containsPoint:function(e){return e.x>=this.minx&&e.x<=this.maxx&&e.y>=this.miny&&e.y<=this.maxy},setCombine:function(e,t){this.minx=e.minx<t.minx?e.minx:t.minx,this.miny=e.miny<t.miny?e.miny:t.miny,this.maxx=e.maxx>t.maxx?e.maxx:t.maxx,this.maxy=e.maxy>t.maxy?e.maxy:t.maxy},setExpand:function(e,t){this.minx=e.minx-t,this.miny=e.miny-t,this.maxx=e.maxx+t,this.maxy=e.maxy+t},setExpandPoint:function(e,t){e<this.minx&&(this.minx=e),e>this.maxx&&(this.maxx=e),t<this.miny&&(this.miny=t),t>this.maxy&&(this.maxy=t)},toString:function(){return"{ x: "+this.minx+" y: "+this.miny+" w: "+this.width()+" h: "+this.height()+" }"},__class__:Lp};var jp=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Vec2"]=jp).__name__=["zpp_nape","util","ZNPList_ZPP_Vec2"],jp.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Rh.zpp_pool?t=new Rh:(t=Rh.zpp_pool,Rh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Rh.zpp_pool?n=new Rh:(n=Rh.zpp_pool,Rh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Rh.zpp_pool,Rh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Rh.zpp_pool,Rh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:jp};var Fp=function(){};(n["zpp_nape.geom.ZPP_Collide"]=Fp).__name__=["zpp_nape","geom","ZPP_Collide"],Fp.circleContains=function(e,t){var n,i;return(n=t.x-e.worldCOMx)*n+(i=t.y-e.worldCOMy)*i<e.radius*e.radius},Fp.polyContains=function(e,t){var n;n=!0;for(var i=e.edges.begin();null!=i;){var r=i.elem();if(!(r.gnormx*t.x+r.gnormy*t.y<=r.gprojection)){n=!1;break}i=i.next}return n},Fp.shapeContains=function(e,t){return e.isCircle()?Fp.circleContains(e.circle,t):Fp.polyContains(e.polygon,t)},Fp.bodyContains=function(e,t){var n;n=!1;for(var i=e.shapes.begin();null!=i;){var r=i.elem();if(Fp.shapeContains(r,t)){n=!0;break}i=i.next}return n},Fp.containTest=function(e,t){if(e.aabb.contains(t.aabb)){if(e.isCircle()){if(t.isCircle()){var n,i,r=e.circle.radius+-t.circle.radius;return(n=t.circle.worldCOMx-e.circle.worldCOMx)*n+(i=t.circle.worldCOMy-e.circle.worldCOMy)*i<=r*r}var a;a=!0;for(var s=t.polygon.gverts.begin();null!=s;){var l,o,_=s.elem(),p=e.circle.radius;if(!((l=_.x-e.circle.worldCOMx)*l+(o=_.y-e.circle.worldCOMy)*o<=p*p)){a=!1;break}s=s.next}return a}if(t.isCircle()){var u;u=!0;for(var h=e.polygon.edges.begin();null!=h;){var c=h.elem();if(!(c.gnormx*t.circle.worldCOMx+c.gnormy*t.circle.worldCOMy+t.circle.radius<=c.gprojection)){u=!1;break}h=h.next}return u}var d;d=!0;for(var m=e.polygon.edges.begin();null!=m;){for(var f=m.elem(),g=-$_.FMAX,v=t.polygon.gverts.begin();null!=v;){var b=v.elem(),y=f.gnormx*b.x+f.gnormy*b.y;g<y&&(g=y),v=v.next}if(!(g<=f.gprojection)){d=!1;break}m=m.next}return d}return!1},Fp.contactCollide=function(e,t,n,i){if(t.isPolygon()){if(e.isPolygon()){for(var r=!0,a=-$_.FMAX,s=($_.FMAX,-1),l=null,o=null,_=e.polygon.edges.begin();null!=_;){for(var p=_.elem(),u=$_.FMAX,h=t.polygon.gverts.begin();null!=h;){var c=h.elem(),d=p.gnormx*c.x+p.gnormy*c.y;if(d<u&&(u=d),u-p.gprojection<=a)break;h=h.next}if(0<=(u-=p.gprojection)){r=!1;break}a<u&&(a=u,l=p,s=1),_=_.next}if(r){for(var m=t.polygon.edges.begin();null!=m;){for(var f=m.elem(),g=$_.FMAX,v=e.polygon.gverts.begin();null!=v;){var b=v.elem(),y=f.gnormx*b.x+f.gnormy*b.y;if(y<g&&(g=y),g-f.gprojection<=a)break;v=v.next}if(0<=(g-=f.gprojection)){r=!1;break}a<g&&(a=g,o=f,s=2),m=m.next}if(r){var x,z,w;w=1==s?(e.polygon,x=t.polygon,z=l,1):(t.polygon,x=e.polygon,z=o,-1);for(var k=null,S=$_.FMAX,C=x.edges.begin();null!=C;){var N=C.elem(),P=z.gnormx*N.gnormx+z.gnormy*N.gnormy;P<S&&(S=P,k=N),C=C.next}var M=0,I=0;M=k.gp0.x,I=k.gp0.y;var T,A,D=0,E=0;T=(D=k.gp1.x)-M,A=(E=k.gp1.y)-I;var O=z.gnormy*M-z.gnormx*I,B=z.gnormy*D-z.gnormx*E,L=1/(B-O),j=(-z.tp1-O)*L;co.epsilon<j&&(M+=T*j,I+=A*j);var F=(-z.tp0-B)*L;F<-co.epsilon&&(D+=T*F,E+=A*F);var R=0,G=0,Z=w;R=z.gnormx*Z,G=z.gnormy*Z,n.lnormx=z.lnormx,n.lnormy=z.lnormy,n.lproj=z.lprojection,n.radius=0,n.rev=i!=(-1==w),n.ptype=n.rev?1:0;var U=M*z.gnormx+I*z.gnormy-z.gprojection,V=D*z.gnormx+E*z.gnormy-z.gprojection;if(0<U&&0<V)return!1;i&&(R=-R,G=-G);var q=n.injectContact(M-z.gnormx*U*.5,I-z.gnormy*U*.5,R,G,U,n.rev?1:0,0<U);return M-=1*x.body.posx,I-=1*x.body.posy,q.inner.lr1x=M*x.body.axisy+I*x.body.axisx,q.inner.lr1y=I*x.body.axisy-M*x.body.axisx,q=n.injectContact(D-z.gnormx*V*.5,E-z.gnormy*V*.5,R,G,V,n.rev?0:1,0<V),D-=1*x.body.posx,E-=1*x.body.posy,q.inner.lr1x=D*x.body.axisy+E*x.body.axisx,q.inner.lr1y=E*x.body.axisy-D*x.body.axisx,1==s?(n.__ref_edge1=z,n.__ref_edge2=k):(n.__ref_edge2=z,n.__ref_edge1=k),!0}return!1}return!1}for(var W=-$_.FMAX,X=($_.FMAX,!0),H=null,Y=null,J=t.polygon.gverts.begin(),K=t.polygon.edges.begin();null!=K;){var Q=K.elem(),$=Q.gnormx*e.circle.worldCOMx+Q.gnormy*e.circle.worldCOMy-Q.gprojection-e.circle.radius;if(0<$){X=!1;break}W<$&&(W=$,H=Q,Y=J),J=J.next,K=K.next}if(X){var ee=Y.elem(),te=null==Y.next?t.polygon.gverts.front():Y.next.elem(),ne=e.circle.worldCOMy*H.gnormx-e.circle.worldCOMx*H.gnormy;if(ne<=ee.y*H.gnormx-ee.x*H.gnormy){var ie,re,ae,se=e.circle.radius,le=(ie=ee.x-e.circle.worldCOMx)*ie+(re=ee.y-e.circle.worldCOMy)*re;if(se*se<le)ae=null;else if(le<co.epsilon*co.epsilon)ae=n.injectContact(e.circle.worldCOMx,e.circle.worldCOMy,1,0,-se,0);else{var oe=dc.invsqrt(le),_e=oe<co.epsilon?$_.FMAX:1/oe,pe=.5+(e.circle.radius-.5*se)*oe;ae=i?n.injectContact(e.circle.worldCOMx+ie*pe,e.circle.worldCOMy+re*pe,-ie*oe,-re*oe,_e-se,0):n.injectContact(e.circle.worldCOMx+ie*pe,e.circle.worldCOMy+re*pe,ie*oe,re*oe,_e-se,0)}if(null!=ae){var ue,he,ce=ae.inner;n.ptype=2,ue=ee.x-t.polygon.body.posx,he=ee.y-t.polygon.body.posy,n.__ref_edge1=H,n.__ref_vertex=-1,i?(ce.lr1x=ue*t.polygon.body.axisy+he*t.polygon.body.axisx,ce.lr1y=he*t.polygon.body.axisy-ue*t.polygon.body.axisx,ce.lr2x=e.circle.localCOMx,ce.lr2y=e.circle.localCOMy):(ce.lr2x=ue*t.polygon.body.axisy+he*t.polygon.body.axisx,ce.lr2y=he*t.polygon.body.axisy-ue*t.polygon.body.axisx,ce.lr1x=e.circle.localCOMx,ce.lr1y=e.circle.localCOMy),n.radius=e.circle.radius}return null!=ae}if(ne>=te.y*H.gnormx-te.x*H.gnormy){var de,me,fe,ge=e.circle.radius,ve=(de=te.x-e.circle.worldCOMx)*de+(me=te.y-e.circle.worldCOMy)*me;if(ge*ge<ve)fe=null;else if(ve<co.epsilon*co.epsilon)fe=n.injectContact(e.circle.worldCOMx,e.circle.worldCOMy,1,0,-ge,0);else{var be=dc.invsqrt(ve),ye=be<co.epsilon?$_.FMAX:1/be,xe=.5+(e.circle.radius-.5*ge)*be;fe=i?n.injectContact(e.circle.worldCOMx+de*xe,e.circle.worldCOMy+me*xe,-de*be,-me*be,ye-ge,0):n.injectContact(e.circle.worldCOMx+de*xe,e.circle.worldCOMy+me*xe,de*be,me*be,ye-ge,0)}if(null!=fe){var ze,we,ke=fe.inner;n.ptype=2,ze=te.x-t.polygon.body.posx,we=te.y-t.polygon.body.posy,n.__ref_edge1=H,n.__ref_vertex=1,i?(ke.lr1x=ze*t.polygon.body.axisy+we*t.polygon.body.axisx,ke.lr1y=we*t.polygon.body.axisy-ze*t.polygon.body.axisx,ke.lr2x=e.circle.localCOMx,ke.lr2y=e.circle.localCOMy):(ke.lr2x=ze*t.polygon.body.axisy+we*t.polygon.body.axisx,ke.lr2y=we*t.polygon.body.axisy-ze*t.polygon.body.axisx,ke.lr1x=e.circle.localCOMx,ke.lr1y=e.circle.localCOMy),n.radius=e.circle.radius}return null!=fe}var Se,Ce,Ne,Pe,Me=e.circle.radius+.5*W;Se=H.gnormx*Me,Ce=H.gnormy*Me,Ne=e.circle.worldCOMx-Se,Pe=e.circle.worldCOMy-Ce;var Ie=i?n.injectContact(Ne,Pe,H.gnormx,H.gnormy,W,0):n.injectContact(Ne,Pe,-H.gnormx,-H.gnormy,W,0);return n.ptype=i?0:1,n.lnormx=H.lnormx,n.lnormy=H.lnormy,n.rev=!i,n.lproj=H.lprojection,n.radius=e.circle.radius,Ie.inner.lr1x=e.circle.localCOMx,Ie.inner.lr1y=e.circle.localCOMy,n.__ref_edge1=H,!(n.__ref_vertex=0)}return!1}var Te,Ae,De,Ee=e.circle.radius+t.circle.radius,Oe=(Te=t.circle.worldCOMx-e.circle.worldCOMx)*Te+(Ae=t.circle.worldCOMy-e.circle.worldCOMy)*Ae;if(Ee*Ee<Oe)De=null;else if(Oe<co.epsilon*co.epsilon)De=n.injectContact(e.circle.worldCOMx,e.circle.worldCOMy,1,0,-Ee,0);else{var Be=dc.invsqrt(Oe),Le=Be<co.epsilon?$_.FMAX:1/Be,je=.5+(e.circle.radius-.5*Ee)*Be;De=i?n.injectContact(e.circle.worldCOMx+Te*je,e.circle.worldCOMy+Ae*je,-Te*Be,-Ae*Be,Le-Ee,0):n.injectContact(e.circle.worldCOMx+Te*je,e.circle.worldCOMy+Ae*je,Te*Be,Ae*Be,Le-Ee,0)}if(null==De)return!1;var Fe=De.inner;return Fe.lr2y=i?(Fe.lr1x=t.circle.localCOMx,Fe.lr1y=t.circle.localCOMy,Fe.lr2x=e.circle.localCOMx,e.circle.localCOMy):(Fe.lr1x=e.circle.localCOMx,Fe.lr1y=e.circle.localCOMy,Fe.lr2x=t.circle.localCOMx,t.circle.localCOMy),n.radius=e.circle.radius+t.circle.radius,n.ptype=2,!0},Fp.testCollide_safe=function(e,t){if(t.isCircle()){var n=e;e=t,t=n}return Fp.testCollide(e,t)},Fp.testCollide=function(e,t){if(t.isPolygon()){if(e.isPolygon()){for(var n=!0,i=e.polygon.edges.begin();null!=i;){for(var r=i.elem(),a=$_.FMAX,s=t.polygon.gverts.begin();null!=s;){var l=s.elem(),o=r.gnormx*l.x+r.gnormy*l.y;o<a&&(a=o),s=s.next}if(0<(a-=r.gprojection)){n=!1;break}i=i.next}if(n){for(var _=t.polygon.edges.begin();null!=_;){for(var p=_.elem(),u=$_.FMAX,h=e.polygon.gverts.begin();null!=h;){var c=h.elem(),d=p.gnormx*c.x+p.gnormy*c.y;d<u&&(u=d),h=h.next}if(0<(u-=p.gprojection)){n=!1;break}_=_.next}return n}return!1}for(var m=null,f=null,g=!0,v=-$_.FMAX,b=t.polygon.gverts.begin(),y=t.polygon.edges.begin();null!=y;){var x=y.elem(),z=x.gnormx*e.circle.worldCOMx+x.gnormy*e.circle.worldCOMy-x.gprojection-e.circle.radius;if(0<z){g=!1;break}v<z&&(v=z,m=x,f=b),b=b.next,y=y.next}if(g){var w=f.elem(),k=null==f.next?t.polygon.gverts.front():f.next.elem(),S=e.circle.worldCOMy*m.gnormx-e.circle.worldCOMx*m.gnormy;if(S<=w.y*m.gnormx-w.x*m.gnormy){var C,N,P=e.circle.radius;return(C=w.x-e.circle.worldCOMx)*C+(N=w.y-e.circle.worldCOMy)*N<=P*P}if(S>=k.y*m.gnormx-k.x*m.gnormy){var M,I,T=e.circle.radius;return(M=k.x-e.circle.worldCOMx)*M+(I=k.y-e.circle.worldCOMy)*I<=T*T}return!0}return!1}var A,D,E=e.circle.radius+t.circle.radius;return(A=t.circle.worldCOMx-e.circle.worldCOMx)*A+(D=t.circle.worldCOMy-e.circle.worldCOMy)*D<=E*E},Fp.flowCollide=function(e,t,n){if(t.isPolygon()){if(e.isPolygon()){for(var i=[],r=[],a=!0,s=!0,l=e.polygon.edges.begin();null!=l;){for(var o=l.elem(),_=$_.FMAX,p=0,u=t.polygon.gverts.begin();null!=u;){var h=u.elem(),c=o.gnormx*h.x+o.gnormy*h.y;c<_&&(_=c),c>=o.gprojection+co.epsilon&&(s=!(r[p]=!0)),++p,u=u.next}if(0<(_-=o.gprojection)){a=!1;break}l=l.next}if(s)return t.polygon.validate_worldCOM(),n.inject(t.polygon.area,t.polygon.worldCOMx,t.polygon.worldCOMy),!0;if(a){s=!0;for(var d=t.polygon.edges.begin();null!=d;){for(var m=d.elem(),f=$_.FMAX,g=0,v=e.polygon.gverts.begin();null!=v;){var b=v.elem(),y=m.gnormx*b.x+m.gnormy*b.y;y<f&&(f=y),y>=m.gprojection+co.epsilon&&(s=!(i[g]=!0)),++g,v=v.next}if(0<(f-=m.gprojection)){a=!1;break}d=d.next}if(s)return e.polygon.validate_worldCOM(),n.inject(e.polygon.area,e.polygon.worldCOMx,e.polygon.worldCOMy),!0;if(a){for(;!Fp.flowpoly.empty();){var x=Fp.flowpoly.pop_unsafe();if(!x._inuse){var z=x;z.free(),z.next=fu.zpp_pool,fu.zpp_pool=z}}for(var w=null,k=!1,S=e.polygon.gverts.begin(),C=0,N=t.polygon.gverts.begin(),P=0,M=0,I=t.polygon.edgeCnt;M<I;){var T=M++;if(!r[T]){P=T;break}N=N.next}if(null==N){N=t.polygon.gverts.begin(),k=!0;for(var A=0,D=e.polygon.edgeCnt;A<D;){var E=A++;if(!i[E]){C=E;break}S=S.next}null==S?S=e.polygon.gverts.begin():(Fp.flowpoly.add(S.elem()),w=Fp.flowpoly.front())}else Fp.flowpoly.add(N.elem()),w=Fp.flowpoly.front();var O=1;if(Fp.flowpoly.empty()){for(var B=!0,L=e.polygon.gverts.begin(),j=L.elem(),F=L.next;null!=F;){for(var R=F.elem(),G=2,Z=t.polygon.gverts.begin(),U=Z.elem(),V=Z.next;null!=V;){var q,W,X,H,Y=V.elem(),J=0;q=j.x-U.x,W=j.y-U.y,X=R.x-j.x;var K,Q,$,ee=(H=R.y-j.y)*(K=Y.x-U.x)-X*(Q=Y.y-U.y);if(co.epsilon*co.epsilon<ee*ee){var te=(Q*q-K*W)*(ee=1/ee);if(co.epsilon<te&&te<1-co.epsilon){var ne=(H*q-X*W)*ee;$=co.epsilon<ne&&ne<1-co.epsilon&&(J=te,!0)}else $=!1}else $=!1;$&&J<G&&(G=J,N=Z),U=Y,V=(Z=V).next}for(;;){var ie,re,ae,se,le=(V=t.polygon.gverts.begin()).elem(),oe=0;ie=j.x-U.x,re=j.y-U.y,ae=R.x-j.x;var _e,pe,ue,he=(se=R.y-j.y)*(_e=le.x-U.x)-ae*(pe=le.y-U.y);if(co.epsilon*co.epsilon<he*he){var ce=(pe*ie-_e*re)*(he=1/he);if(co.epsilon<ce&&ce<1-co.epsilon){var de=(se*ie-ae*re)*he;ue=co.epsilon<de&&de<1-co.epsilon&&(oe=ce,!0)}else ue=!1}else ue=!1;ue&&oe<G&&(G=oe,N=Z);break}if(2!=G){var me,fe,ge=G;me=j.x+(R.x-j.x)*ge,fe=j.y+(R.y-j.y)*ge,w=fu.get(me,fe),Fp.flowpoly.add(w),S=L,B=!(k=!0);break}j=R,F=(L=F).next}if(B)for(;;){for(var ve=(F=e.polygon.gverts.begin()).elem(),be=2,ye=t.polygon.gverts.begin(),xe=ye.elem(),ze=ye.next;null!=ze;){var we,ke,Se,Ce,Ne=ze.elem(),Pe=0;we=j.x-xe.x,ke=j.y-xe.y,Se=ve.x-j.x;var Me,Ie,Te,Ae=(Ce=ve.y-j.y)*(Me=Ne.x-xe.x)-Se*(Ie=Ne.y-xe.y);if(co.epsilon*co.epsilon<Ae*Ae){var De=(Ie*we-Me*ke)*(Ae=1/Ae);if(co.epsilon<De&&De<1-co.epsilon){var Ee=(Ce*we-Se*ke)*Ae;Te=co.epsilon<Ee&&Ee<1-co.epsilon&&(Pe=De,!0)}else Te=!1}else Te=!1;Te&&Pe<be&&(be=Pe,N=ye),xe=Ne,ze=(ye=ze).next}for(;;){var Oe,Be,Le,je,Fe=(ze=t.polygon.gverts.begin()).elem(),Re=0;Oe=j.x-xe.x,Be=j.y-xe.y,Le=ve.x-j.x;var Ge,Ze,Ue,Ve=(je=ve.y-j.y)*(Ge=Fe.x-xe.x)-Le*(Ze=Fe.y-xe.y);if(co.epsilon*co.epsilon<Ve*Ve){var qe=(Ze*Oe-Ge*Be)*(Ve=1/Ve);if(co.epsilon<qe&&qe<1-co.epsilon){var We=(je*Oe-Le*Be)*Ve;Ue=co.epsilon<We&&We<1-co.epsilon&&(Re=qe,!0)}else Ue=!1}else Ue=!1;Ue&&Re<be&&(be=Re,N=ye);break}if(2==be)break;var Xe,He,Ye=be;Xe=j.x+(ve.x-j.x)*Ye,He=j.y+(ve.y-j.y)*Ye,w=fu.get(Xe,He),Fp.flowpoly.add(w),k=!0,S=L;break}O=2}for(;;)if(k)if(++C,null==(S=S.next)&&(S=e.polygon.gverts.begin(),C=0),i[C]){var Je=Fp.flowpoly.front(),Ke=S.elem(),Qe=N.elem(),$e=N.next;null==$e&&($e=t.polygon.gverts.begin());for(var et=-1,tt=null,nt=0,it=0,rt=$e,at=$e;;){var st,lt,ot,_t,pt=at.elem(),ut=0;st=Qe.x-Je.x,lt=Qe.y-Je.y,ot=pt.x-Qe.x;var ht,ct,dt,mt=(_t=pt.y-Qe.y)*(ht=Ke.x-Je.x)-ot*(ct=Ke.y-Je.y);if(co.epsilon*co.epsilon<mt*mt){var ft=(ct*st-ht*lt)*(mt=1/mt);if(co.epsilon<ft&&ft<1-co.epsilon){var gt=(_t*st-ot*lt)*mt;dt=co.epsilon<gt&&gt<1-co.epsilon&&(ut=ft,!0)}else dt=!1}else dt=!1;if(dt&&et<=ut){if(tt=N,nt=P,++it==O){et=ut,at=rt;break}et=ut}Qe=pt,N=at,++P>=t.polygon.edgeCnt&&(P=0),null==(at=at.next)&&(at=t.polygon.gverts.begin());break}for(;at!=rt;){var vt,bt,yt,xt,zt=at.elem(),wt=0;vt=Qe.x-Je.x,bt=Qe.y-Je.y,yt=zt.x-Qe.x;var kt,St,Ct,Nt=(xt=zt.y-Qe.y)*(kt=Ke.x-Je.x)-yt*(St=Ke.y-Je.y);if(co.epsilon*co.epsilon<Nt*Nt){var Pt=(St*vt-kt*bt)*(Nt=1/Nt);if(co.epsilon<Pt&&Pt<1-co.epsilon){var Mt=(xt*vt-yt*bt)*Nt;Ct=co.epsilon<Mt&&Mt<1-co.epsilon&&(wt=Pt,!0)}else Ct=!1}else Ct=!1;if(Ct&&et<=wt){if(tt=N,nt=P,++it==O){et=wt,at=rt;break}et=wt}Qe=zt,N=at,++P>=t.polygon.edgeCnt&&(P=0),null==(at=at.next)&&(at=t.polygon.gverts.begin())}if(null==tt)break;var It=tt.elem(),Tt=tt.next;null==Tt&&(Tt=t.polygon.gverts.begin());var At,Dt,Et=Tt.elem(),Ot=et;if(At=It.x+(Et.x-It.x)*Ot,Dt=It.y+(Et.y-It.y)*Ot,null!=w&&vu.vec_dsq(At,Dt,w.x,w.y)<co.epsilon)break;Fp.flowpoly.add(fu.get(At,Dt)),null==w&&(w=Fp.flowpoly.front()),N=tt,P=nt,k=!k,O=2}else{var Bt=S.elem();if(null!=w&&vu.vec_dsq(Bt.x,Bt.y,w.x,w.y)<co.epsilon)break;Fp.flowpoly.add(Bt),null==w&&(w=Fp.flowpoly.front()),O=1}else if(++P,null==(N=N.next)&&(N=t.polygon.gverts.begin(),P=0),r[P]){var Lt=Fp.flowpoly.front(),jt=N.elem(),Ft=S.elem(),Rt=S.next;null==Rt&&(Rt=e.polygon.gverts.begin());for(var Gt=-1,Zt=null,Ut=0,Vt=0,qt=Rt,Wt=Rt;;){var Xt,Ht,Yt,Jt,Kt=Wt.elem(),Qt=0;Xt=Ft.x-Lt.x,Ht=Ft.y-Lt.y,Yt=Kt.x-Ft.x;var $t,en,tn,nn=(Jt=Kt.y-Ft.y)*($t=jt.x-Lt.x)-Yt*(en=jt.y-Lt.y);if(co.epsilon*co.epsilon<nn*nn){var rn=(en*Xt-$t*Ht)*(nn=1/nn);if(co.epsilon<rn&&rn<1-co.epsilon){var an=(Jt*Xt-Yt*Ht)*nn;tn=co.epsilon<an&&an<1-co.epsilon&&(Qt=rn,!0)}else tn=!1}else tn=!1;if(tn&&Gt<=Qt){if(Zt=S,Ut=C,++Vt==O){Gt=Qt,Wt=qt;break}Gt=Qt}Ft=Kt,S=Wt,++C>=e.polygon.edgeCnt&&(C=0),null==(Wt=Wt.next)&&(Wt=e.polygon.gverts.begin());break}for(;Wt!=qt;){var sn,ln,on,_n,pn=Wt.elem(),un=0;sn=Ft.x-Lt.x,ln=Ft.y-Lt.y,on=pn.x-Ft.x;var hn,cn,dn,mn=(_n=pn.y-Ft.y)*(hn=jt.x-Lt.x)-on*(cn=jt.y-Lt.y);if(co.epsilon*co.epsilon<mn*mn){var fn=(cn*sn-hn*ln)*(mn=1/mn);if(co.epsilon<fn&&fn<1-co.epsilon){var gn=(_n*sn-on*ln)*mn;dn=co.epsilon<gn&&gn<1-co.epsilon&&(un=fn,!0)}else dn=!1}else dn=!1;if(dn&&Gt<=un){if(Zt=S,Ut=C,++Vt==O){Gt=un,Wt=qt;break}Gt=un}Ft=pn,S=Wt,++C>=e.polygon.edgeCnt&&(C=0),null==(Wt=Wt.next)&&(Wt=e.polygon.gverts.begin())}if(null==Zt)break;var vn=Zt.elem(),bn=Zt.next;null==bn&&(bn=e.polygon.gverts.begin());var yn,xn,zn=bn.elem(),wn=Gt;if(yn=vn.x+(zn.x-vn.x)*wn,xn=vn.y+(zn.y-vn.y)*wn,null!=w&&vu.vec_dsq(yn,xn,w.x,w.y)<co.epsilon)break;Fp.flowpoly.add(fu.get(yn,xn)),null==w&&(w=Fp.flowpoly.front()),S=Zt,C=Ut,k=!k,O=2}else{var kn=N.elem();if(null!=w&&vu.vec_dsq(kn.x,kn.y,w.x,w.y)<co.epsilon)break;Fp.flowpoly.add(kn),null==w&&(w=Fp.flowpoly.front()),O=1}if(null==Fp.flowpoly.begin()||null==Fp.flowpoly.begin().next||null==Fp.flowpoly.begin().next.next)return!1;var Sn=0,Cn=0,Nn=0;Sn=Nn=Cn=0;var Pn=Fp.flowpoly.begin(),Mn=Pn.elem(),In=(Pn=Pn.next).elem();for(Pn=Pn.next;null!=Pn;){var Tn=Pn.elem();Sn+=In.x*(Tn.y-Mn.y);var An=Tn.y*In.x-Tn.x*In.y;Cn+=(In.x+Tn.x)*An,Nn+=(In.y+Tn.y)*An,Mn=In,In=Tn,Pn=Pn.next}var Dn=(Pn=Fp.flowpoly.begin()).elem();Sn+=In.x*(Dn.y-Mn.y);var En=Dn.y*In.x-Dn.x*In.y;Cn+=(In.x+Dn.x)*En,Nn+=(In.y+Dn.y)*En,Mn=In,In=Dn;var On=(Pn=Pn.next).elem();Sn+=In.x*(On.y-Mn.y);var Bn=On.y*In.x-On.x*In.y;Cn+=(In.x+On.x)*Bn,Nn+=(In.y+On.y)*Bn;var Ln=1/(6*(Sn*=.5));return Cn*=Ln,Nn*=Ln,n.inject(-Sn,Cn,Nn),!0}return!1}return!1}for(var jn=[],Fn=!0,Rn=null,Gn=null,Zn=-$_.FMAX,Un=!0,Vn=t.polygon.gverts.begin(),qn=0,Wn=t.polygon.edges.begin();null!=Wn;){var Xn=Wn.elem(),Hn=Xn.gnormx*e.circle.worldCOMx+Xn.gnormy*e.circle.worldCOMy;if(Hn>Xn.gprojection+e.circle.radius){Un=!1;break}Hn+e.circle.radius>Xn.gprojection+co.epsilon&&(Fn=!1,jn[qn]=!0),Zn<(Hn-=Xn.gprojection+e.circle.radius)&&(Zn=Hn,Rn=Xn,Gn=Vn),Vn=Vn.next,++qn,Wn=Wn.next}if(Un){if(Fn)return n.inject(e.circle.area,e.circle.worldCOMx,e.circle.worldCOMy),!0;var Yn,Jn=Gn.elem(),Kn=null==Gn.next?t.polygon.gverts.front():Gn.next.elem(),Qn=e.circle.worldCOMy*Rn.gnormx-e.circle.worldCOMx*Rn.gnormy;if(Qn<=Jn.y*Rn.gnormx-Jn.x*Rn.gnormy){var $n,ei,ti=e.circle.radius;Yn=($n=Jn.x-e.circle.worldCOMx)*$n+(ei=Jn.y-e.circle.worldCOMy)*ei<=ti*ti}else if(Qn>=Kn.y*Rn.gnormx-Kn.x*Rn.gnormy){var ni,ii,ri=e.circle.radius;Yn=(ni=Kn.x-e.circle.worldCOMx)*ni+(ii=Kn.y-e.circle.worldCOMy)*ii<=ri*ri}else Yn=!0;if(Yn){for(var ai=[],si=0,li=!0,oi=null,_i=0,pi=t.polygon.gverts.begin();null!=pi;){var ui=pi.elem(),hi=vu.vec_dsq(ui.x,ui.y,e.circle.worldCOMx,e.circle.worldCOMy);(ai[si]=hi<=e.circle.radius*e.circle.radius)?(_i=si,oi=pi):li=!1,++si,pi=pi.next}if(li)return t.polygon.validate_worldCOM(),n.inject(t.polygon.area,t.polygon.worldCOMx,t.polygon.worldCOMy),!0;for(;!Fp.flowpoly.empty();){var ci=Fp.flowpoly.pop_unsafe();if(!ci._inuse){var di=ci;di.free(),di.next=fu.zpp_pool,fu.zpp_pool=di}}Fp.flowsegs.clear();var mi=null,fi=1;if(null==oi)oi=t.polygon.gverts.begin(),fi=2;else{var gi=Fp.flowpoly;mi=oi.elem(),gi.add(mi)}for(;0!=fi;)if(1==fi)if(null==(oi=oi.next)&&(oi=t.polygon.gverts.begin()),++_i>=t.polygon.edgeCnt&&(_i=0),ai[_i]){if(vu.vec_dsq(mi.x,mi.y,oi.elem().x,oi.elem().y)<co.epsilon)break;Fp.flowpoly.add(oi.elem())}else{var vi,bi,yi,xi,zi,wi,ki=Fp.flowpoly.front(),Si=oi.elem(),Ci=(vi=Si.x-ki.x)*vi+(bi=Si.y-ki.y)*bi,Ni=2*((yi=ki.x-e.circle.worldCOMx)*vi+(xi=ki.y-e.circle.worldCOMy)*bi),Pi=yi*yi+xi*xi-e.circle.radius*e.circle.radius,Mi=Math.sqrt(Ni*Ni-4*Ci*Pi),Ii=(-Ni-Mi)*(Ci=1/(2*Ci)),Ti=Ii<co.epsilon?(-Ni+Mi)*Ci:Ii;if(zi=ki.x+(Si.x-ki.x)*Ti,wi=ki.y+(Si.y-ki.y)*Ti,vu.vec_dsq(mi.x,mi.y,zi,wi)<co.epsilon)break;Fp.flowpoly.add(fu.get(zi,wi)),fi=2}else if(2==fi){var Ai=oi.next;null==Ai&&(Ai=t.polygon.gverts.begin());var Di=oi.elem();fi=0;for(var Ei=Ai,Oi=Ai;;){var Bi=Oi.elem(),Li=_i+1;if(Li==t.polygon.edgeCnt&&(Li=0),jn[_i]){if(ai[Li]){var ji,Fi,Ri,Gi,Zi,Ui,Vi=(ji=Bi.x-Di.x)*ji+(Fi=Bi.y-Di.y)*Fi,qi=2*((Ri=Di.x-e.circle.worldCOMx)*ji+(Gi=Di.y-e.circle.worldCOMy)*Fi),Wi=Ri*Ri+Gi*Gi-e.circle.radius*e.circle.radius,Xi=Math.sqrt(qi*qi-4*Vi*Wi),Hi=(-qi-Xi)*(Vi=1/(2*Vi)),Yi=Hi<co.epsilon?(-qi+Xi)*Vi:Hi;if(Zi=Di.x+(Bi.x-Di.x)*Yi,Ui=Di.y+(Bi.y-Di.y)*Yi,vu.vec_dsq(mi.x,mi.y,Zi,Ui)<co.epsilon){fi=0,Oi=Ei;break}var Ji=fu.get(Zi,Ui);Fp.flowsegs.add(Fp.flowpoly.front()),Fp.flowsegs.add(Ji),Fp.flowpoly.add(Ji),fi=1,Oi=Ei;break}var Ki,Qi,$i,er,tr,nr=0,ir=0,rr=(Ki=Bi.x-Di.x)*Ki+(Qi=Bi.y-Di.y)*Qi,ar=2*(($i=Di.x-e.circle.worldCOMx)*Ki+(er=Di.y-e.circle.worldCOMy)*Qi),sr=ar*ar-4*rr*($i*$i+er*er-e.circle.radius*e.circle.radius);if(tr=sr*sr<co.epsilon?(nr=sr<0?10:ir=-ar/(2*rr),!1):(nr=(-ar-(sr=Math.sqrt(sr)))*(rr=1/(2*rr)),ir=(-ar+sr)*rr,!0),nr<1-co.epsilon&&co.epsilon<ir){var lr,or,_r=nr;if(lr=Di.x+(Bi.x-Di.x)*_r,or=Di.y+(Bi.y-Di.y)*_r,null!=mi&&vu.vec_dsq(mi.x,mi.y,lr,or)<co.epsilon){fi=0,Oi=Ei;break}var pr=fu.get(lr,or);if(Fp.flowpoly.empty()||(Fp.flowsegs.add(Fp.flowpoly.front()),Fp.flowsegs.add(pr)),Fp.flowpoly.add(pr),null==mi&&(mi=Fp.flowpoly.front()),tr){var ur,hr,cr=ir;ur=Di.x+(Bi.x-Di.x)*cr,hr=Di.y+(Bi.y-Di.y)*cr,Fp.flowpoly.add(fu.get(ur,hr))}}}Di=Bi,_i=Li,null==(Oi=(oi=Oi).next)&&(Oi=t.polygon.gverts.begin());break}for(;Oi!=Ei;){var dr=Oi.elem(),mr=_i+1;if(mr==t.polygon.edgeCnt&&(mr=0),jn[_i]){if(ai[mr]){var fr,gr,vr,br,yr,xr,zr=(fr=dr.x-Di.x)*fr+(gr=dr.y-Di.y)*gr,wr=2*((vr=Di.x-e.circle.worldCOMx)*fr+(br=Di.y-e.circle.worldCOMy)*gr),kr=vr*vr+br*br-e.circle.radius*e.circle.radius,Sr=Math.sqrt(wr*wr-4*zr*kr),Cr=(-wr-Sr)*(zr=1/(2*zr)),Nr=Cr<co.epsilon?(-wr+Sr)*zr:Cr;if(yr=Di.x+(dr.x-Di.x)*Nr,xr=Di.y+(dr.y-Di.y)*Nr,vu.vec_dsq(mi.x,mi.y,yr,xr)<co.epsilon){fi=0,Oi=Ei;break}var Pr=fu.get(yr,xr);Fp.flowsegs.add(Fp.flowpoly.front()),Fp.flowsegs.add(Pr),Fp.flowpoly.add(Pr),fi=1,Oi=Ei;break}var Mr,Ir,Tr,Ar,Dr,Er=0,Or=0,Br=(Mr=dr.x-Di.x)*Mr+(Ir=dr.y-Di.y)*Ir,Lr=2*((Tr=Di.x-e.circle.worldCOMx)*Mr+(Ar=Di.y-e.circle.worldCOMy)*Ir),jr=Lr*Lr-4*Br*(Tr*Tr+Ar*Ar-e.circle.radius*e.circle.radius);if(Dr=jr*jr<co.epsilon?(Er=jr<0?10:Or=-Lr/(2*Br),!1):(Er=(-Lr-(jr=Math.sqrt(jr)))*(Br=1/(2*Br)),Or=(-Lr+jr)*Br,!0),Er<1-co.epsilon&&co.epsilon<Or){var Fr,Rr,Gr=Er;if(Fr=Di.x+(dr.x-Di.x)*Gr,Rr=Di.y+(dr.y-Di.y)*Gr,null!=mi&&vu.vec_dsq(mi.x,mi.y,Fr,Rr)<co.epsilon){fi=0,Oi=Ei;break}var Zr=fu.get(Fr,Rr);if(Fp.flowpoly.empty()||(Fp.flowsegs.add(Fp.flowpoly.front()),Fp.flowsegs.add(Zr)),Fp.flowpoly.add(Zr),null==mi&&(mi=Fp.flowpoly.front()),Dr){var Ur,Vr,qr=Or;Ur=Di.x+(dr.x-Di.x)*qr,Vr=Di.y+(dr.y-Di.y)*qr,Fp.flowpoly.add(fu.get(Ur,Vr))}}}Di=dr,_i=mr,null==(Oi=(oi=Oi).next)&&(Oi=t.polygon.gverts.begin())}}if(null==Fp.flowpoly.begin())return!1;if(null==Fp.flowpoly.begin().next){for(var Wr=!0,Xr=t.polygon.edges.begin();null!=Xr;){var Hr=Xr.elem();if(Hr.gnormx*e.circle.worldCOMx+Hr.gnormy*e.circle.worldCOMy>Hr.gprojection){Wr=!1;break}Xr=Xr.next}return!!Wr&&(n.inject(e.circle.area,e.circle.worldCOMx,e.circle.worldCOMy),!0)}var Yr=0,Jr=0,Kr=0;if(null!=Fp.flowpoly.begin().next.next){var Qr=0,$r=0,ea=0;Qr=ea=$r=0;var ta=Fp.flowpoly.begin(),na=ta.elem(),ia=(ta=ta.next).elem();for(ta=ta.next;null!=ta;){var ra=ta.elem();Qr+=ia.x*(ra.y-na.y);var aa=ra.y*ia.x-ra.x*ia.y;$r+=(ia.x+ra.x)*aa,ea+=(ia.y+ra.y)*aa,na=ia,ia=ra,ta=ta.next}var sa=(ta=Fp.flowpoly.begin()).elem();Qr+=ia.x*(sa.y-na.y);var la=sa.y*ia.x-sa.x*ia.y;$r+=(ia.x+sa.x)*la,ea+=(ia.y+sa.y)*la,na=ia,ia=sa;var oa=(ta=ta.next).elem();Qr+=ia.x*(oa.y-na.y);var _a=oa.y*ia.x-oa.x*ia.y;$r+=(ia.x+oa.x)*_a,ea+=(ia.y+oa.y)*_a;var pa=1/(6*(Qr*=.5)),ua=-Qr;Yr+=($r*=pa)*ua,Jr+=(ea*=pa)*ua,Kr-=Qr}else Fp.flowsegs.add(Fp.flowpoly.front()),Fp.flowsegs.add(Fp.flowpoly.begin().next.elem());for(;!Fp.flowsegs.empty();){var ha=Fp.flowsegs.pop_unsafe(),ca=Fp.flowsegs.pop_unsafe(),da=0,ma=0,fa=(da=ca.x-ha.x)*da+(ma=ca.y-ha.y)*ma,ga=dc.invsqrt(fa),va=da*=ga;da=-(ma*=ga),ma=va;var ba=0,ya=0;ba=ha.x+ca.x,ya=ha.y+ca.y,ba*=.5,ya*=.5;var xa,za,wa=da*(ba-=1*e.circle.worldCOMx)+ma*(ya-=1*e.circle.worldCOMy),ka=wa/e.circle.radius,Sa=Math.sqrt(1-ka*ka),Ca=Math.acos(ka);xa=e.circle.radius*(e.circle.radius*Ca-wa*Sa),za=.6666666666666666*e.circle.radius*Sa*Sa*Sa/(Ca-ka*Sa),ba=e.circle.worldCOMx,ya=e.circle.worldCOMy,Yr+=(ba+=da*za)*xa,Jr+=(ya+=ma*za)*xa,Kr+=xa}var Na=1/Kr;return Yr*=Na,Jr*=Na,n.inject(Kr,Yr,Jr),!0}return!1}return!1}var Pa,Ma,Ia=e.circle,Ta=t.circle;Pa=Ta.worldCOMx-Ia.worldCOMx,Ma=Ta.worldCOMy-Ia.worldCOMy;var Aa=Ia.radius+Ta.radius,Da=Pa*Pa+Ma*Ma;if(Aa*Aa<Da)return!1;if(Da<co.epsilon*co.epsilon)return Ia.radius<Ta.radius?n.inject(Ia.area,Ia.worldCOMx,Ia.worldCOMy):n.inject(Ta.area,Ta.worldCOMx,Ta.worldCOMy),!0;var Ea=Math.sqrt(Da),Oa=1/Ea,Ba=.5*(Ea-(Ta.radius*Ta.radius-Ia.radius*Ia.radius)*Oa);if(Ba<=-Ia.radius)n.inject(Ia.area,Ia.worldCOMx,Ia.worldCOMy);else{var La=Ea-Ba;if(La<=-Ta.radius)n.inject(Ta.area,Ta.worldCOMx,Ta.worldCOMy);else{var ja,Fa,Ra,Ga=Ba,Za=Ga/Ia.radius,Ua=Math.sqrt(1-Za*Za),Va=Math.acos(Za);ja=Ia.radius*(Ia.radius*Va-Ga*Ua),Fa=.6666666666666666*Ia.radius*Ua*Ua*Ua/(Va-Za*Ua);var qa=La,Wa=qa/Ta.radius,Xa=Math.sqrt(1-Wa*Wa),Ha=Math.acos(Wa),Ya=ja+(Ra=Ta.radius*(Ta.radius*Ha-qa*Xa)),Ja=(Fa*ja+(Ea-.6666666666666666*Ta.radius*Xa*Xa*Xa/(Ha-Wa*Xa))*Ra)/Ya*Oa;n.inject(Ya,Ia.worldCOMx+Pa*Ja,Ia.worldCOMy+Ma*Ja)}}return!0};var Rp=function(){};(n["zpp_nape.geom.ZPP_Convex"]=Rp).__name__=["zpp_nape","geom","ZPP_Convex"],Rp.isinner=function(e,t,n){var i,r,a;return i=e.x-t.x,r=e.y-t.y,a=n.x-t.x,0<=(n.y-t.y)*i-a*r},Rp.optimise=function(e){var t=e.vertices,n=e.vertices;if(null!=t)for(var i=t;i.sort(),(i=i.next)!=n;);var r=e.vertices,a=e.vertices;if(null!=r)for(var s=r;;){for(var l=s,o=l.prev,_=null,p=l.diagonals.begin();null!=p;){var u=p.elem(),h=null==p.next?l.next:p.next.elem();if(Rp.isinner(h,l,o)){for(var c=!0,d=u,m=d.prev,f=null,g=d.diagonals.begin();null!=g;){var v=g.elem();if(v==l){var b=null==g.next?d.next:g.next.elem();c=Rp.isinner(b,d,m);break}m=v,g=(f=g).next}c?(p=l.diagonals.erase(_),d.diagonals.erase(f)):(o=u,p=(_=p).next)}else o=u,p=(_=p).next}if((s=s.next)==a)break}};var Gp=function(){this.toiDistance=0,this.next=null,this.inner=!1,this.ray=null,this.position=null,this.convex=null,this.shape=null,this.normal=null};(n["zpp_nape.geom.ZPP_ConvexRayResult"]=Gp).__name__=["zpp_nape","geom","ZPP_ConvexRayResult"],Gp.getRay=function(e,t,n,i){var r;null==Gp.rayPool?(Gp.internal=!0,(r=new g_).zpp_inner=new Gp,r.zpp_inner.ray=r,Gp.internal=!1):(r=Gp.rayPool.ray,Gp.rayPool=Gp.rayPool.next,r.zpp_inner.next=null);var a=r.zpp_inner;return(a.normal=e).zpp_inner._immutable=!0,a.toiDistance=t,a.inner=n,a.shape=i,r},Gp.getConvex=function(e,t,n,i){var r;null==Gp.convexPool?(Gp.internal=!0,(r=new a_).zpp_inner=new Gp,r.zpp_inner.convex=r,Gp.internal=!1):(r=Gp.convexPool.convex,Gp.convexPool=Gp.convexPool.next,r.zpp_inner.next=null);var a=r.zpp_inner;return a.normal=e,a.position=t,e.zpp_inner._immutable=!0,t.zpp_inner._immutable=!0,a.toiDistance=n,a.shape=i,r},Gp.prototype={normal:null,shape:null,convex:null,position:null,ray:null,inner:null,next:null,toiDistance:null,disposed:function(){},free:function(){this.normal.zpp_inner._immutable=!1,this.normal.dispose(),null!=this.position&&(this.position.zpp_inner._immutable=!1,this.position.dispose()),this.shape=null,this.toiDistance=0,null!=this.convex?(this.next=Gp.convexPool,Gp.convexPool=this):(this.next=Gp.rayPool,Gp.rayPool=this)},__class__:Gp};var Zp=function(){this.used=!1,this.rank=0,this.parent=null,this.positive=!1,this.value=0,this.vert=null,this.posy=0,this.posx=0,this.next=null,this.prev=null};(n["zpp_nape.geom.ZPP_CutVert"]=Zp).__name__=["zpp_nape","geom","ZPP_CutVert"],Zp.path=function(e){var t;return null==Zp.zpp_pool?t=new Zp:(t=Zp.zpp_pool,Zp.zpp_pool=t.next,t.next=null),t.alloc(),t.vert=e,(t.parent=t).rank=0,t.used=!1,t},Zp.prototype={prev:null,next:null,posx:null,posy:null,vert:null,value:null,positive:null,parent:null,rank:null,used:null,alloc:function(){},free:function(){this.vert=null,this.parent=null},__class__:Zp};var Up=function(){this.path1=null,this.start=null,this.end=null,this.path0=null,this.vertex=!1,this.virtualint=!1,this.time=0,this.next=null};(n["zpp_nape.geom.ZPP_CutInt"]=Up).__name__=["zpp_nape","geom","ZPP_CutInt"],Up.get=function(e,t,n,i,r,a,s){var l;return null==s&&(s=!1),null==a&&(a=!1),null==Up.zpp_pool?l=new Up:(l=Up.zpp_pool,Up.zpp_pool=l.next,l.next=null),l.alloc(),l.virtualint=a,l.end=t,l.start=n,l.path0=i,l.path1=r,l.time=e,l.vertex=s,l},Up.prototype={next:null,time:null,virtualint:null,vertex:null,path0:null,end:null,start:null,path1:null,alloc:function(){},free:function(){this.end=this.start=null,this.path0=this.path1=null},__class__:Up};var Vp=function(){};(n["zpp_nape.geom.ZPP_Cutter"]=Vp).__name__=["zpp_nape","geom","ZPP_Cutter"],Vp.run=function(e,t,n,i,r,a){var s,l,o,_;s=t.get_x(),l=t.get_y(),o=n.get_x()-s,_=n.get_y()-l;for(var p=i?0:$_.NEGINF(),u=r?1:$_.POSINF(),h=-(l*o-s*_),c=null,d=!1,m=e;;){var f;null==Zp.zpp_pool?f=new Zp:(f=Zp.zpp_pool,Zp.zpp_pool=f.next,f.next=null),f.alloc(),f.vert=m,f.posx=f.vert.x,f.posy=f.vert.y,f.value=f.posy*o-f.posx*_+h,f.positive=0<f.value,0==f.value&&(d=!0);var g=f;if(null==c?c=g.prev=g.next=g:(g.prev=c,g.next=c.next,c.next.prev=g,c.next=g),c=g,(m=m.next)==e)break}if(d){var v=null,b=c;if(null!=c)for(var y=c;;){var x=y;if(0!=x.value){v=x;break}if((y=y.next)==b)break}var z=0,w=0,k=(z=o)*z+(w=_)*w,S=dc.invsqrt(k),C=z*=S;z=-(w*=S),w=C;for(var N=null,P=v;;)if(0==P.value||null!=N&&P!=N.next){var M=N.value*P.value;if(0!=M){var I,T=N.next;if(0<M)I=N.positive;else{var A=T.next,D=0,E=0;D=T.posx+A.posx,E=T.posy+A.posy;var O=(D*=.5)+1e-8*z,B=(E*=.5)+1e-8*w,L=!1,j=e;if(null!=e)for(var F=e;;){var R=F,G=R.prev;if((R.y<B&&G.y>=B||G.y<B&&R.y>=B)&&(R.x<=O||G.x<=O)&&R.x+(B-R.y)/(G.y-R.y)*(G.x-R.x)<O&&(L=!L),(F=F.next)==j)break}I=L}var Z=P;if(null!=T)for(var U=T;U.positive=I,(U=U.next)!=Z;);if((P=(N=P).next)==v)break}else if((P=P.next)==v)break}else if((P=(N=P).next)==v)break;for(;;){if(0!=P.value&&(null==N||P==N.next)){P=(N=P).next;break}var V=N.value*P.value;if(0==V){P=P.next;break}var q,W=N.next;if(0<V)q=N.positive;else{var X=W.next,H=0,Y=0;H=W.posx+X.posx,Y=W.posy+X.posy;var J=(H*=.5)+1e-8*z,K=(Y*=.5)+1e-8*w,Q=!1,$=e;if(null!=e)for(var ee=e;;){var te=ee,ne=te.prev;if((te.y<K&&ne.y>=K||ne.y<K&&te.y>=K)&&(te.x<=J||ne.x<=J)&&te.x+(K-te.y)/(ne.y-te.y)*(ne.x-te.x)<J&&(Q=!Q),(ee=ee.next)==$)break}q=Q}var ie=P;if(null!=W)for(var re=W;re.positive=q,(re=re.next)!=ie;);P=(N=P).next;break}}null==Vp.ints&&(Vp.ints=new Ju),null==Vp.paths&&(Vp.paths=new Ku);var ae=null,se=Wp.get(c.posx,c.posy);null==ae?ae=se.prev=se.next=se:(se.next=ae,se.prev=ae.prev,ae.prev.next=se,ae.prev=se);var le=ae,oe=Zp.path(ae);Vp.paths.add(oe);for(var _e=c;;){var pe=_e.next,ue=Wp.get(pe.posx,pe.posy);if(_e.positive==pe.positive){var he=ue;null==ae?ae=he.prev=he.next=he:(he.next=ae,he.prev=ae.prev,ae.prev.next=he,ae.prev=he)}else{var ce,de,me=_*(ce=pe.posx-_e.posx)-o*(de=pe.posy-_e.posy);me=1/me;var fe,ge,ve=(de*(fe=s-_e.posx)-ce*(ge=l-_e.posy))*me;if(ve<p||u<ve){Vp.ints.add(Up.get(ve,null,null,null,null,!0));var be=ue;null==ae?ae=be.prev=be.next=be:(be.next=ae,be.prev=ae.prev,ae.prev.next=be,ae.prev=be)}else if(0==_e.value){var ye=ae.prev;ae=null;var xe=Wp.get(ye.x,ye.y);null==ae?ae=xe.prev=xe.next=xe:(xe.next=ae,xe.prev=ae.prev,ae.prev.next=xe,ae.prev=xe);var ze=ue;null==ae?ae=ze.prev=ze.next=ze:(ze.next=ae,ze.prev=ae.prev,ae.prev.next=ze,ae.prev=ze);var we=Vp.paths.begin().elem();Vp.paths.add(Zp.path(ae));var ke=Vp.paths.begin().elem();Vp.ints.add(Up.get(ve,ye,ae,we,ke,!0))}else if(0==pe.value){var Se=ue;null==ae?ae=Se.prev=Se.next=Se:(Se.next=ae,Se.prev=ae.prev,ae.prev.next=Se,ae.prev=Se);var Ce=ae.prev;ae=null;var Ne=Wp.get(pe.posx,pe.posy);null==ae?ae=Ne.prev=Ne.next=Ne:(Ne.next=ae,Ne.prev=ae.prev,ae.prev.next=Ne,ae.prev=Ne);var Pe=Vp.paths.begin().elem();Vp.paths.add(Zp.path(ae));var Me=Vp.paths.begin().elem();Vp.ints.add(Up.get(ve,Ce,ae,Pe,Me,!0))}else{var Ie=(_*fe-o*ge)*me,Te=0,Ae=0;Te=_e.posx,Ae=_e.posy,Te+=ce*Ie,Ae+=de*Ie;var De=Wp.get(Te,Ae);null==ae?ae=De.prev=De.next=De:(De.next=ae,De.prev=ae.prev,ae.prev.next=De,ae.prev=De);var Ee=ae.prev;ae=null;var Oe=Wp.get(Te,Ae);null==ae?ae=Oe.prev=Oe.next=Oe:(Oe.next=ae,Oe.prev=ae.prev,ae.prev.next=Oe,ae.prev=Oe);var Be=ue;null==ae?ae=Be.prev=Be.next=Be:(Be.next=ae,Be.prev=ae.prev,ae.prev.next=Be,ae.prev=Be);var Le=Vp.paths.begin().elem();Vp.paths.add(Zp.path(ae));var je=Vp.paths.begin().elem();Vp.ints.add(Up.get(ve,Ee,ae,Le,je,!1))}}if((_e=_e.next)==c)break}var Fe=ae.prev;Fe.next.prev=le.prev,le.prev.next=Fe.next,(Fe.next=le).prev=Fe;var Re,Ge,Ze=Vp.paths.begin().elem();if(oe==oe.parent)Re=oe;else{for(var Ue=oe,Ve=null;Ue!=Ue.parent;){var qe=Ue.parent;Ue.parent=Ve,Ve=Ue,Ue=qe}for(;null!=Ve;){var We=Ve.parent;Ve.parent=Ue,Ve=We}Re=Ue}if(Ze==Ze.parent)Ge=Ze;else{for(var Xe=Ze,He=null;Xe!=Xe.parent;){var Ye=Xe.parent;Xe.parent=He,He=Xe,Xe=Ye}for(;null!=He;){var Je=He.parent;He.parent=Xe,He=Je}Ge=Xe}Re!=Ge&&(Re.rank<Ge.rank?Re.parent=Ge:Re.rank>Ge.rank?Ge.parent=Re:(Ge.parent=Re).rank++);var Ke=Vp.ints;if(!Ke.empty()&&null!=Ke.begin().next){for(var Qe,$e,et,tt=Ke.begin(),nt=null,it=null,rt=null,at=null,st=1;;){for(Qe=0,it=tt,nt=tt=null;null!=it;){for(++Qe,rt=it,$e=0,et=st;null!=rt&&$e<st;)++$e,rt=rt.next;for(;0<$e||0<et&&null!=rt;)0==$e?(rt=(at=rt).next,--et):0==et||null==rt?(it=(at=it).next,--$e):it.elem().time<rt.elem().time?(it=(at=it).next,--$e):(rt=(at=rt).next,--et),null!=nt?nt.next=at:tt=at,nt=at;it=rt}if(nt.next=null,st<<=1,!(1<Qe))break}Ke.setbegin(tt)}for(;!Vp.ints.empty();){var lt=Vp.ints.pop_unsafe(),ot=Vp.ints.pop_unsafe();if(lt.virtualint||ot.virtualint){if(lt.virtualint&&!ot.virtualint){var _t,pt,ut;if(null!=ot.end&&ot.end.prev==ot.end){ot.end.next=ot.end.prev=null;var ht=ot.end;ht.free(),ht.next=Wp.zpp_pool,Wp.zpp_pool=ht,_t=null}else{var ct=ot.end.prev;ot.end.prev.next=ot.end.next,ot.end.next.prev=ot.end.prev,ot.end.next=ot.end.prev=null;var dt=ot.end;dt.free(),dt.next=Wp.zpp_pool,Wp.zpp_pool=dt,ot.end=null,_t=ct}if(ot.end=_t,!ot.vertex)if(ot.end!=ot.path0.vert){var mt;if(ot.start.x=ot.end.x,ot.start.y=ot.end.y,null!=ot.end&&ot.end.prev==ot.end){ot.end.next=ot.end.prev=null;var ft=ot.end;ft.free(),ft.next=Wp.zpp_pool,Wp.zpp_pool=ft,mt=null}else{var gt=ot.end.prev;ot.end.prev.next=ot.end.next,ot.end.next.prev=ot.end.prev,ot.end.next=ot.end.prev=null;var vt=ot.end;vt.free(),vt.next=Wp.zpp_pool,Wp.zpp_pool=vt,ot.end=null,mt=gt}ot.end=mt}else{var bt=ot.start.next;if(ot.start.x=bt.x,ot.start.y=bt.y,null!=bt&&bt.prev==bt){bt.next=bt.prev=null;var yt=bt;yt.free(),yt.next=Wp.zpp_pool,Wp.zpp_pool=yt,bt=null}else{bt.prev.next=bt.next,bt.next.prev=bt.prev,bt.next=bt.prev=null;var xt=bt;xt.free(),xt.next=Wp.zpp_pool,Wp.zpp_pool=xt}}if(ot.end.next.prev=ot.start.prev,ot.start.prev.next=ot.end.next,ot.end.next=ot.start,ot.start.prev=ot.end,ot.path0==ot.path0.parent)pt=ot.path0;else{for(var zt=ot.path0,wt=null;zt!=zt.parent;){var kt=zt.parent;zt.parent=wt,wt=zt,zt=kt}for(;null!=wt;){var St=wt.parent;wt.parent=zt,wt=St}pt=zt}if(ot.path1==ot.path1.parent)ut=ot.path1;else{for(var Ct=ot.path1,Nt=null;Ct!=Ct.parent;){var Pt=Ct.parent;Ct.parent=Nt,Nt=Ct,Ct=Pt}for(;null!=Nt;){var Mt=Nt.parent;Nt.parent=Ct,Nt=Mt}ut=Ct}pt!=ut&&(pt.rank<ut.rank?pt.parent=ut:pt.rank>ut.rank?ut.parent=pt:(ut.parent=pt).rank++)}else if(ot.virtualint&&!lt.virtualint){var It,Tt,At;if(null!=lt.end&&lt.end.prev==lt.end){lt.end.next=lt.end.prev=null;var Dt=lt.end;Dt.free(),Dt.next=Wp.zpp_pool,Wp.zpp_pool=Dt,It=null}else{var Et=lt.end.prev;lt.end.prev.next=lt.end.next,lt.end.next.prev=lt.end.prev,lt.end.next=lt.end.prev=null;var Ot=lt.end;Ot.free(),Ot.next=Wp.zpp_pool,Wp.zpp_pool=Ot,lt.end=null,It=Et}if(lt.end=It,!lt.vertex)if(lt.end!=lt.path0.vert){var Bt;if(lt.start.x=lt.end.x,lt.start.y=lt.end.y,null!=lt.end&&lt.end.prev==lt.end){lt.end.next=lt.end.prev=null;var Lt=lt.end;Lt.free(),Lt.next=Wp.zpp_pool,Wp.zpp_pool=Lt,Bt=null}else{var jt=lt.end.prev;lt.end.prev.next=lt.end.next,lt.end.next.prev=lt.end.prev,lt.end.next=lt.end.prev=null;var Ft=lt.end;Ft.free(),Ft.next=Wp.zpp_pool,Wp.zpp_pool=Ft,lt.end=null,Bt=jt}lt.end=Bt}else{var Rt=lt.start.next;if(lt.start.x=Rt.x,lt.start.y=Rt.y,null!=Rt&&Rt.prev==Rt){Rt.next=Rt.prev=null;var Gt=Rt;Gt.free(),Gt.next=Wp.zpp_pool,Wp.zpp_pool=Gt,Rt=null}else{Rt.prev.next=Rt.next,Rt.next.prev=Rt.prev,Rt.next=Rt.prev=null;var Zt=Rt;Zt.free(),Zt.next=Wp.zpp_pool,Wp.zpp_pool=Zt}}if(lt.end.next.prev=lt.start.prev,lt.start.prev.next=lt.end.next,lt.end.next=lt.start,lt.start.prev=lt.end,lt.path0==lt.path0.parent)Tt=lt.path0;else{for(var Ut=lt.path0,Vt=null;Ut!=Ut.parent;){var qt=Ut.parent;Ut.parent=Vt,Vt=Ut,Ut=qt}for(;null!=Vt;){var Wt=Vt.parent;Vt.parent=Ut,Vt=Wt}Tt=Ut}if(lt.path1==lt.path1.parent)At=lt.path1;else{for(var Xt=lt.path1,Ht=null;Xt!=Xt.parent;){var Yt=Xt.parent;Xt.parent=Ht,Ht=Xt,Xt=Yt}for(;null!=Ht;){var Jt=Ht.parent;Ht.parent=Xt,Ht=Jt}At=Xt}Tt!=At&&(Tt.rank<At.rank?Tt.parent=At:Tt.rank>At.rank?At.parent=Tt:(At.parent=Tt).rank++)}}else{var Kt,Qt,$t,en;if(lt.end.next.prev=ot.start.prev,ot.start.prev.next=lt.end.next,lt.end.next=ot.start,ot.start.prev=lt.end,ot.end.next.prev=lt.start.prev,lt.start.prev.next=ot.end.next,ot.end.next=lt.start,lt.start.prev=ot.end,lt.path0==lt.path0.parent)Kt=lt.path0;else{for(var tn=lt.path0,nn=null;tn!=tn.parent;){var rn=tn.parent;tn.parent=nn,nn=tn,tn=rn}for(;null!=nn;){var an=nn.parent;nn.parent=tn,nn=an}Kt=tn}if(ot.path1==ot.path1.parent)Qt=ot.path1;else{for(var sn=ot.path1,ln=null;sn!=sn.parent;){var on=sn.parent;sn.parent=ln,ln=sn,sn=on}for(;null!=ln;){var _n=ln.parent;ln.parent=sn,ln=_n}Qt=sn}if(Kt!=Qt&&(Kt.rank<Qt.rank?Kt.parent=Qt:Kt.rank>Qt.rank?Qt.parent=Kt:(Qt.parent=Kt).rank++),lt.path1==lt.path1.parent)$t=lt.path1;else{for(var pn=lt.path1,un=null;pn!=pn.parent;){var hn=pn.parent;pn.parent=un,un=pn,pn=hn}for(;null!=un;){var cn=un.parent;un.parent=pn,un=cn}$t=pn}if(ot.path0==ot.path0.parent)en=ot.path0;else{for(var dn=ot.path0,mn=null;dn!=dn.parent;){var fn=dn.parent;dn.parent=mn,mn=dn,dn=fn}for(;null!=mn;){var gn=mn.parent;mn.parent=dn,mn=gn}en=dn}$t!=en&&($t.rank<en.rank?$t.parent=en:$t.rank>en.rank?en.parent=$t:(en.parent=$t).rank++)}var vn=lt;vn.free(),vn.next=Up.zpp_pool,Up.zpp_pool=vn;var bn=ot;bn.free(),bn.next=Up.zpp_pool,Up.zpp_pool=bn}for(var yn=null==a?new u_:a,xn=Vp.paths.begin();null!=xn;){var zn,wn=xn.elem();if(wn==wn.parent)zn=wn;else{for(var kn=wn,Sn=null;kn!=kn.parent;){var Cn=kn.parent;kn.parent=Sn,Sn=kn,kn=Cn}for(;null!=Sn;){var Nn=Sn.parent;Sn.parent=kn,Sn=Nn}zn=kn}if(zn.used)xn=xn.next;else{zn.used=!0;for(var Pn=zn.vert,Mn=!0;null!=zn.vert&&(Mn||Pn!=zn.vert);)if(Mn=!1,Pn.x==Pn.next.x&&Pn.y==Pn.next.y)if(Pn==zn.vert&&(zn.vert=Pn.next==Pn?null:Pn.next,Mn=!0),null!=Pn&&Pn.prev==Pn)Pn.next=Pn.prev=null,Pn=Pn=null;else{var In=Pn.next;Pn.prev.next=Pn.next,Pn.next.prev=Pn.prev,Pn.next=Pn.prev=null,Pn=null,Pn=In}else Pn=Pn.next;if(null!=zn.vert){var Tn=__.get();Tn.zpp_inner.vertices=zn.vert,yn.add(Tn)}xn=xn.next}}for(;!Vp.paths.empty();){var An=Vp.paths.pop_unsafe();An.free(),An.next=Zp.zpp_pool,Zp.zpp_pool=An}for(;null!=c;)if(null!=c&&c.prev==c){c.next=c.prev=null;var Dn=c;Dn.free(),Dn.next=Zp.zpp_pool,Zp.zpp_pool=Dn,c=c=null}else{var En=c.next;c.prev.next=c.next,c.next.prev=c.prev,c.next=c.prev=null;var On=c;On.free(),On.next=Zp.zpp_pool,Zp.zpp_pool=On,c=null,c=En}return yn};var qp=function(){};(n["zpp_nape.geom.ZPP_Geom"]=qp).__name__=["zpp_nape","geom","ZPP_Geom"],qp.validateShape=function(e){e.isPolygon()&&e.polygon.validate_gaxi(),e.validate_aabb(),e.validate_worldCOM()};var Wp=function(){this.forced=!1,this.wrap=null,this.next=null,this.prev=null,this.y=0,this.x=0};(n["zpp_nape.geom.ZPP_GeomVert"]=Wp).__name__=["zpp_nape","geom","ZPP_GeomVert"],Wp.get=function(e,t){var n;return null==Wp.zpp_pool?n=new Wp:(n=Wp.zpp_pool,Wp.zpp_pool=n.next,n.next=null),n.alloc(),n.x=e,n.y=t,n},Wp.prototype={x:null,y:null,prev:null,next:null,wrap:null,forced:null,free:function(){null!=this.wrap&&(this.wrap.zpp_inner._inuse=!1,this.wrap.dispose(),this.wrap=null),this.prev=this.next=null},alloc:function(){this.forced=!1},wrapper:function(){return null==this.wrap&&(this.wrap=y_.get(this.x,this.y),this.wrap.zpp_inner._inuse=!0,this.wrap.zpp_inner._invalidate=Cc(this,this.modwrap),this.wrap.zpp_inner._validate=Cc(this,this.getwrap)),this.wrap},modwrap:function(e){this.x=e.x,this.y=e.y},getwrap:function(){this.wrap.zpp_inner.x=this.x,this.wrap.zpp_inner.y=this.y},__class__:Wp};var Xp=function(e){this.vertices=null,this.outer=null,this.outer=e};(n["zpp_nape.geom.ZPP_GeomPoly"]=Xp).__name__=["zpp_nape","geom","ZPP_GeomPoly"],Xp.prototype={outer:null,vertices:null,__class__:Xp};var Hp=function(){this.next=null,this.outer=null,this.forward=!1,this.first=!1,this.start=null,this.ptr=null,this.outer=new h_};(n["zpp_nape.geom.ZPP_GeomVertexIterator"]=Hp).__name__=["zpp_nape","geom","ZPP_GeomVertexIterator"],Hp.get=function(e,t){var n;return null==Hp.zpp_pool?n=new Hp:(n=Hp.zpp_pool,Hp.zpp_pool=n.next,n.next=null),n.alloc(),(n.outer.zpp_inner=n).ptr=e,n.forward=t,n.start=e,n.first=null!=e,n.outer},Hp.prototype={ptr:null,start:null,first:null,forward:null,outer:null,next:null,free:function(){this.outer.zpp_inner=null,this.ptr=this.start=null},alloc:function(){},__class__:Hp};var Yp=function(){this.next=null,this.out=!1,this.rank=0,this.parent=null,this.parent=this};(n["zpp_nape.geom.ZPP_MarchSpan"]=Yp).__name__=["zpp_nape","geom","ZPP_MarchSpan"],Yp.prototype={parent:null,rank:null,out:null,next:null,free:function(){this.parent=this},alloc:function(){this.out=!1,this.rank=0},__class__:Yp};var Jp=function(){this.next=null,this.spanr=null,this.span2=null,this.span1=null,this.pd=null,this.okeyr=0,this.keyr=0,this.pr=null,this.okey2=0,this.key2=0,this.p2=null,this.okey1=0,this.key1=0,this.p1=null};(n["zpp_nape.geom.ZPP_MarchPair"]=Jp).__name__=["zpp_nape","geom","ZPP_MarchPair"],Jp.prototype={p1:null,key1:null,okey1:null,p2:null,key2:null,okey2:null,pr:null,keyr:null,okeyr:null,pd:null,span1:null,span2:null,spanr:null,next:null,free:function(){this.p1=this.p2=this.pr=this.pd=null,this.span1=this.span2=this.spanr=null},alloc:function(){},__class__:Jp};var Kp=function(){};(n["zpp_nape.geom.ZPP_MarchingSquares"]=Kp).__name__=["zpp_nape","geom","ZPP_MarchingSquares"],Kp.run=function(e,t,n,i,r,a,s,l,o){var _=(i-t)/a.get_x(),u=p.int(_),h=(r-n)/a.get_y(),c=p.int(h);_!=u&&++u,h!=c&&++c,l&&(null==Kp.map?Kp.map=new Gu(u,c):Kp.map.resize(u,c,null)),null==Kp.isos?Kp.isos=new Fu(u+1,c+1):Kp.isos.resize(u+1,c+1,0);for(var d=0,m=c+1;d<m;)for(var f=d++,g=0==f?n:f<=c?n+a.get_y()*f:r,v=0,b=u+1;v<b;){var y=v++,x=0==y?t:y<=u?t+a.get_x()*y:i;Kp.isos.set(y,f,Kp.ISO(e,x,g))}null==Kp.ints?Kp.ints=new Ru(u+1,1+(c<<1)):Kp.ints.resize(u+1,1+(c<<1),null);var z=null;l&&(null==Yp.zpp_pool?z=new Yp:(z=Yp.zpp_pool,Yp.zpp_pool=z.next,z.next=null),z.alloc());for(var w=n,k=0,S=c;k<S;){var C=k++,N=w,P=C==c-1?r:n+a.get_y()*(C+1);w=P;for(var M=t,I=null,T=0,A=u;T<A;){var D=T++,E=M,O=D==u-1?i:t+a.get_x()*(D+1);M=O;var B=0==D||!l,L=0==C||!l,j=D==u-1||!l,F=C==c-1||!l,R=Kp.me.marchSquare(e,Kp.isos,Kp.ints,E,N,O,P,D,C,B,L,j,F,s);if(null!=R)if(l){var G=null!=R.p2&&14!=R.okey2?R.p2:R.p1;R.pd=Kp.me.linkdown(G,G==R.p2?R.okey2:R.okey1),Kp.map.set(D,C,R),null!=I&&Kp.me.combLeft(R.key1)?(Kp.me.combLR(I,R),R.span1=I.spanr):(null==Yp.zpp_pool?R.span1=new Yp:(R.span1=Yp.zpp_pool,Yp.zpp_pool=R.span1.next,R.span1.next=null),R.span1.alloc(),R.span1.next=z,z=R.span1),null!=R.p2?(null==Yp.zpp_pool?R.span2=new Yp:(R.span2=Yp.zpp_pool,Yp.zpp_pool=R.span2.next,R.span2.next=null),R.span2.alloc(),R.span2.next=z,z=R.span2,R.spanr=R.span2):R.spanr=R.span1,I=Kp.me.combRight(R.keyr)?R:null}else{Kp.me.output(o,R.p1),null!=R.p2&&Kp.me.output(o,R.p2);var Z=R;Z.free(),Z.next=Jp.zpp_pool,Jp.zpp_pool=Z}else I=null}}if(l){for(var U=1,V=c;U<V;)for(var q=U++,W=null,X=0,H=u;X<H;){var Y=X++,J=Kp.map.get(Y,q);if(null!=J){var K=null!=J.p2&&14==J.okey2?J.okey2:J.okey1;if(Kp.me.combUp(K)){var Q=Kp.map.get(Y,q-1);if(null!=Q){var $=null!=Q.p2&&56==Q.okey2?Q.okey2:Q.okey1;if(Kp.me.combDown($)){var ee,te,ne=null!=Q.p2&&56==Q.okey2?Q.span2:Q.span1,ie=null!=J.p2&&14==J.okey2?J.span2:J.span1;if(ne==ne.parent)ee=ne;else{for(var re=ne,ae=null;re!=re.parent;){var se=re.parent;re.parent=ae,ae=re,re=se}for(;null!=ae;){var le=ae.parent;ae.parent=re,ae=le}ee=re}if(ie==ie.parent)te=ie;else{for(var oe=ie,_e=null;oe!=oe.parent;){var pe=oe.parent;oe.parent=_e,_e=oe,oe=pe}for(;null!=_e;){var ue=_e.parent;_e.parent=oe,_e=ue}te=oe}if(ee==te)W!=ie&&Kp.me.combUD_virtual(Q,J);else{var he,ce;if(ne==ne.parent)he=ne;else{for(var de=ne,me=null;de!=de.parent;){var fe=de.parent;de.parent=me,me=de,de=fe}for(;null!=me;){var ge=me.parent;me.parent=de,me=ge}he=de}if(ie==ie.parent)ce=ie;else{for(var ve=ie,be=null;ve!=ve.parent;){var ye=ve.parent;ve.parent=be,be=ve,ve=ye}for(;null!=be;){var xe=be.parent;be.parent=ve,be=xe}ce=ve}he!=ce&&(he.rank<ce.rank?he.parent=ce:he.rank>ce.rank?ce.parent=he:(ce.parent=he).rank++),Kp.me.combUD(Q,J)}W=0!=(4&(ie==J.span2?J.okey2:J.okey1))?ie:null}else W=null}else W=null}else W=null}else W=null}for(var ze=0,we=c;ze<we;)for(var ke=ze++,Se=0,Ce=u;Se<Ce;){var Ne=Se++,Pe=Kp.map.get(Ne,ke);if(null!=Pe){var Me;if(Pe.span1==Pe.span1.parent)Me=Pe.span1;else{for(var Ie=Pe.span1,Te=null;Ie!=Ie.parent;){var Ae=Ie.parent;Ie.parent=Te,Te=Ie,Ie=Ae}for(;null!=Te;){var De=Te.parent;Te.parent=Ie,Te=De}Me=Ie}if(Me.out||(Me.out=!0,Kp.me.output(o,Pe.p1)),null!=Pe.p2){if(Pe.span2==Pe.span2.parent)Me=Pe.span2;else{for(var Ee=Pe.span2,Oe=null;Ee!=Ee.parent;){var Be=Ee.parent;Ee.parent=Oe,Oe=Ee,Ee=Be}for(;null!=Oe;){var Le=Oe.parent;Oe.parent=Ee,Oe=Le}Me=Ee}Me.out||(Me.out=!0,Kp.me.output(o,Pe.p2))}var je=Pe;je.free(),je.next=Jp.zpp_pool,Jp.zpp_pool=je,Kp.map.set(Ne,ke,null)}}for(;null!=z;){var Fe=z;z=Fe.next;var Re=Fe;Re.free(),Re.next=Yp.zpp_pool,Yp.zpp_pool=Re}}},Kp.ISO=function(e,t,n){return e(t,n)},Kp.prototype={output:function(e,t){var n;if(null==t||t.next==t||t.next==t.prev)n=!0;else{var i=0,r=t;if(null!=t)for(var a=t;;){var s=a;if(i+=s.x*(s.next.y-s.prev.y),(a=a.next)==r)break}var l=.5*i;n=l*l<co.epsilon*co.epsilon}if(n)for(;null!=t;)if(null!=t&&t.prev==t)t.next=t.prev=null,t=t=null;else{var o=t.next;t.prev.next=t.next,t.next.prev=t.prev,t.next=t.prev=null,t=null,t=o}else{var _=__.get();_.zpp_inner.vertices=t,e.add(_)}},linkright:function(e,t){var n=7&t;return 0==n?e:3==n?e.next.next:e.next},linkleft:function(e,t){return 0==(1&t)?e.prev:e},linkdown:function(e,t){return 0==(128&t)?e.prev:e.prev.prev},linkup:function(e,t){return e},combLR:function(e,t){var n=this.linkright(e.pr,e.okeyr),i=this.linkleft(t.p1,t.okey1),r=n.next,a=i.prev;if(0!=(4&e.keyr)){t.pr==t.p1&&(t.pr=n.prev),t.p1=n.prev,n.prev.next=i.next,i.next.prev=n.prev;var s=n;s.free(),s.next=Wp.zpp_pool,Wp.zpp_pool=s}else n.next=i.next,i.next.prev=n;var l=i;if(l.free(),l.next=Wp.zpp_pool,Wp.zpp_pool=l,0!=(16&e.keyr)){t.pd=r.next,r.next.prev=a.prev,a.prev.next=r.next;var o=r;o.free(),o.next=Wp.zpp_pool,Wp.zpp_pool=o}else r.prev=a.prev,a.prev.next=r;var _=a;_.free(),_.next=Wp.zpp_pool,Wp.zpp_pool=_},combUD:function(e,t){null!=e.p2&&56==e.key2?e.p2:e.p1;var n=null!=t.p2&&14==t.key2?t.p2:t.p1,i=e.pd,r=this.linkup(n,n==t.p2?t.okey2:t.okey1),a=i.prev,s=r.next;r.next=i.next,i.next.prev=r;var l=i;l.free(),l.next=Wp.zpp_pool,Wp.zpp_pool=l,s.prev=a.prev,a.prev.next=s,a==e.p1&&(e.p1=s);var o=a;o.free(),o.next=Wp.zpp_pool,Wp.zpp_pool=o},combUD_virtual:function(e,t){null!=e.p2&&56==e.key2?e.p2:e.p1;var n=null!=t.p2&&14==t.key2?t.p2:t.p1,i=e.pd,r=this.linkup(n,n==t.p2?t.key2:t.key1),a=i.prev,s=r.next;i.forced=r.forced=a.forced=s.forced=!0},combLeft:function(e){var t=1&e|(192&e)>>5;return this.comb(t)},combRight:function(e){var t=(28&e)>>2;return this.comb(t)},combUp:function(e){var t=7&e;return this.comb(t)},combDown:function(e){var t=(112&e)>>4;return this.comb(t)},comb:function(e){var t=0;return 0!=(1&e)&&++t,0!=(2&e)&&++t,0!=(4&e)&&++t,2<=t},marchSquare:function(e,t,n,i,r,a,s,l,o,_,p,u,h,c){var d=0,m=t.get(l,o);m<0&&(d|=8);var f=t.get(l+1,o);f<0&&(d|=4);var g=t.get(l+1,o+1);g<0&&(d|=2);var v,b=t.get(l,o+1);if(b<0&&(d|=1),0==d)return null;if(null==Jp.zpp_pool?v=new Jp:(v=Jp.zpp_pool,Jp.zpp_pool=v.next,v.next=null),v.alloc(),10!=d&&5!=d){var y=Kp.look_march[d];v.okey1=y;for(var x=0;x<8;){var z=x++;if(0!=(y&1<<z)){var w=null;0==z?(w=Wp.get(i,r),(_||p)&&(w.forced=!0)):2==z?(w=Wp.get(a,r),(u||p)&&(w.forced=!0)):4==z?(w=Wp.get(a,s),(u||h)&&(w.forced=!0)):6==z?(w=Wp.get(i,s),(_||h)&&(w.forced=!0)):1==z?(null==(w=n.get(l,o<<1))?(w=Wp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,w)):w=Wp.get(w.x,w.y),p&&(w.forced=!0),w.x!=i&&w.x!=a||(w.x==i&&0!=(1&y)||w.x==a&&0!=(4&y))&&(y^=2)):5==z?(null==(w=n.get(l,2+(o<<1)))?(w=Wp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),w)):w=Wp.get(w.x,w.y),h&&(w.forced=!0),w.x!=i&&w.x!=a||(w.x==i&&0!=(64&y)||w.x==a&&0!=(16&y))&&(y^=32)):3==z?(null==(w=n.get(l+1,1+(o<<1)))?(w=Wp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),w)):w=Wp.get(w.x,w.y),u&&(w.forced=!0),w.y!=r&&w.y!=s||(w.y==r&&0!=(4&y)||w.y==s&&0!=(16&y))&&(y^=8)):(null==(w=n.get(l,1+(o<<1)))?(w=Wp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),w)):w=Wp.get(w.x,w.y),_&&(w.forced=!0),w.y!=r&&w.y!=s||(w.y==r&&0!=(1&y)||w.y==s&&0!=(64&y))&&(y^=128));var k=w;null==v.p1?v.p1=k.prev=k.next=k:(k.prev=v.p1,k.next=v.p1.next,v.p1.next.prev=k,v.p1.next=k),v.p1=k}}v.p1=v.p1.next,1!=(v.key1=y)&&4!=y&&16!=y&&64!=y&&3!=y&&12!=y&&48!=y&&192!=y&&129!=y&&6!=y&&24!=y&&96!=y&&5!=y&&20!=y&&80!=y&&65!=y&&17!=y&&68!=y||(y=0,v.key1=0,v.p1=null),0==y?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}else{var S=Kp.ISO(e,.5*(i+a),.5*(r+s))<0;if(10==d)if(S){var C=187;v.okey1=C;for(var N=0;N<8;){var P=N++;if(0!=(C&1<<P)){var M=null;0==P?(M=Wp.get(i,r),(_||p)&&(M.forced=!0)):2==P?(M=Wp.get(a,r),(u||p)&&(M.forced=!0)):4==P?(M=Wp.get(a,s),(u||h)&&(M.forced=!0)):6==P?(M=Wp.get(i,s),(_||h)&&(M.forced=!0)):1==P?(null==(M=n.get(l,o<<1))?(M=Wp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,M)):M=Wp.get(M.x,M.y),p&&(M.forced=!0),M.x!=i&&M.x!=a||(M.x==i&&0!=(1&C)||M.x==a&&0!=(4&C))&&(C^=2)):5==P?(null==(M=n.get(l,2+(o<<1)))?(M=Wp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),M)):M=Wp.get(M.x,M.y),h&&(M.forced=!0),M.x!=i&&M.x!=a||(M.x==i&&0!=(64&C)||M.x==a&&0!=(16&C))&&(C^=32)):3==P?(null==(M=n.get(l+1,1+(o<<1)))?(M=Wp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),M)):M=Wp.get(M.x,M.y),u&&(M.forced=!0),M.y!=r&&M.y!=s||(M.y==r&&0!=(4&C)||M.y==s&&0!=(16&C))&&(C^=8)):(null==(M=n.get(l,1+(o<<1)))?(M=Wp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),M)):M=Wp.get(M.x,M.y),_&&(M.forced=!0),M.y!=r&&M.y!=s||(M.y==r&&0!=(1&C)||M.y==s&&0!=(64&C))&&(C^=128));var I=M;null==v.p1?v.p1=I.prev=I.next=I:(I.prev=v.p1,I.next=v.p1.next,v.p1.next.prev=I,v.p1.next=I),v.p1=I}}v.p1=v.p1.next,1!=(v.key1=C)&&4!=C&&16!=C&&64!=C&&3!=C&&12!=C&&48!=C&&192!=C&&129!=C&&6!=C&&24!=C&&96!=C&&5!=C&&20!=C&&80!=C&&65!=C&&17!=C&&68!=C||(C=0,v.key1=0,v.p1=null),0==C?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}else{var T=131;v.okey1=T;for(var A=0;A<8;){var D=A++;if(0!=(T&1<<D)){var E=null;0==D?(E=Wp.get(i,r),(_||p)&&(E.forced=!0)):2==D?(E=Wp.get(a,r),(u||p)&&(E.forced=!0)):4==D?(E=Wp.get(a,s),(u||h)&&(E.forced=!0)):6==D?(E=Wp.get(i,s),(_||h)&&(E.forced=!0)):1==D?(null==(E=n.get(l,o<<1))?(E=Wp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,E)):E=Wp.get(E.x,E.y),p&&(E.forced=!0),E.x!=i&&E.x!=a||(E.x==i&&0!=(1&T)||E.x==a&&0!=(4&T))&&(T^=2)):5==D?(null==(E=n.get(l,2+(o<<1)))?(E=Wp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),E)):E=Wp.get(E.x,E.y),h&&(E.forced=!0),E.x!=i&&E.x!=a||(E.x==i&&0!=(64&T)||E.x==a&&0!=(16&T))&&(T^=32)):3==D?(null==(E=n.get(l+1,1+(o<<1)))?(E=Wp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),E)):E=Wp.get(E.x,E.y),u&&(E.forced=!0),E.y!=r&&E.y!=s||(E.y==r&&0!=(4&T)||E.y==s&&0!=(16&T))&&(T^=8)):(null==(E=n.get(l,1+(o<<1)))?(E=Wp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),E)):E=Wp.get(E.x,E.y),_&&(E.forced=!0),E.y!=r&&E.y!=s||(E.y==r&&0!=(1&T)||E.y==s&&0!=(64&T))&&(T^=128));var O=E;null==v.p1?v.p1=O.prev=O.next=O:(O.prev=v.p1,O.next=v.p1.next,v.p1.next.prev=O,v.p1.next=O),v.p1=O}}if(v.p1=v.p1.next,1!=(v.key1=T)&&4!=T&&16!=T&&64!=T&&3!=T&&12!=T&&48!=T&&192!=T&&129!=T&&6!=T&&24!=T&&96!=T&&5!=T&&20!=T&&80!=T&&65!=T&&17!=T&&68!=T||(T=0,v.key1=0,v.p1=null),0!=T){var B=56;v.okey2=B;for(var L=0;L<8;){var j=L++;if(0!=(B&1<<j)){var F=null;0==j?(F=Wp.get(i,r),(_||p)&&(F.forced=!0)):2==j?(F=Wp.get(a,r),(u||p)&&(F.forced=!0)):4==j?(F=Wp.get(a,s),(u||h)&&(F.forced=!0)):6==j?(F=Wp.get(i,s),(_||h)&&(F.forced=!0)):1==j?(null==(F=n.get(l,o<<1))?(F=Wp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,F)):F=Wp.get(F.x,F.y),p&&(F.forced=!0),F.x!=i&&F.x!=a||(F.x==i&&0!=(1&B)||F.x==a&&0!=(4&B))&&(B^=2)):5==j?(null==(F=n.get(l,2+(o<<1)))?(F=Wp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),F)):F=Wp.get(F.x,F.y),h&&(F.forced=!0),F.x!=i&&F.x!=a||(F.x==i&&0!=(64&B)||F.x==a&&0!=(16&B))&&(B^=32)):3==j?(null==(F=n.get(l+1,1+(o<<1)))?(F=Wp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),F)):F=Wp.get(F.x,F.y),u&&(F.forced=!0),F.y!=r&&F.y!=s||(F.y==r&&0!=(4&B)||F.y==s&&0!=(16&B))&&(B^=8)):(null==(F=n.get(l,1+(o<<1)))?(F=Wp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),F)):F=Wp.get(F.x,F.y),_&&(F.forced=!0),F.y!=r&&F.y!=s||(F.y==r&&0!=(1&B)||F.y==s&&0!=(64&B))&&(B^=128));var R=F;null==v.p2?v.p2=R.prev=R.next=R:(R.prev=v.p2,R.next=v.p2.next,v.p2.next.prev=R,v.p2.next=R),v.p2=R}}v.p2=v.p2.next,1!=(v.key2=B)&&4!=B&&16!=B&&64!=B&&3!=B&&12!=B&&48!=B&&192!=B&&129!=B&&6!=B&&24!=B&&96!=B&&5!=B&&20!=B&&80!=B&&65!=B&&17!=B&&68!=B||(B=0,v.key2=0,v.p2=null),v.keyr=0==B?(v.pr=v.p1,v.okeyr=v.okey1,v.key1):(v.pr=v.p2,v.okeyr=v.okey2,v.key2)}else{var G=56;v.okey1=G;for(var Z=0;Z<8;){var U=Z++;if(0!=(G&1<<U)){var V=null;0==U?(V=Wp.get(i,r),(_||p)&&(V.forced=!0)):2==U?(V=Wp.get(a,r),(u||p)&&(V.forced=!0)):4==U?(V=Wp.get(a,s),(u||h)&&(V.forced=!0)):6==U?(V=Wp.get(i,s),(_||h)&&(V.forced=!0)):1==U?(null==(V=n.get(l,o<<1))?(V=Wp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,V)):V=Wp.get(V.x,V.y),p&&(V.forced=!0),V.x!=i&&V.x!=a||(V.x==i&&0!=(1&G)||V.x==a&&0!=(4&G))&&(G^=2)):5==U?(null==(V=n.get(l,2+(o<<1)))?(V=Wp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),V)):V=Wp.get(V.x,V.y),h&&(V.forced=!0),V.x!=i&&V.x!=a||(V.x==i&&0!=(64&G)||V.x==a&&0!=(16&G))&&(G^=32)):3==U?(null==(V=n.get(l+1,1+(o<<1)))?(V=Wp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),V)):V=Wp.get(V.x,V.y),u&&(V.forced=!0),V.y!=r&&V.y!=s||(V.y==r&&0!=(4&G)||V.y==s&&0!=(16&G))&&(G^=8)):(null==(V=n.get(l,1+(o<<1)))?(V=Wp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),V)):V=Wp.get(V.x,V.y),_&&(V.forced=!0),V.y!=r&&V.y!=s||(V.y==r&&0!=(1&G)||V.y==s&&0!=(64&G))&&(G^=128));var q=V;null==v.p1?v.p1=q.prev=q.next=q:(q.prev=v.p1,q.next=v.p1.next,v.p1.next.prev=q,v.p1.next=q),v.p1=q}}v.p1=v.p1.next,1!=(v.key1=G)&&4!=G&&16!=G&&64!=G&&3!=G&&12!=G&&48!=G&&192!=G&&129!=G&&6!=G&&24!=G&&96!=G&&5!=G&&20!=G&&80!=G&&65!=G&&17!=G&&68!=G||(G=0,v.key1=0,v.p1=null),0==G?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}}else if(S){var W=238;v.okey1=W;for(var X=0;X<8;){var H=X++;if(0!=(W&1<<H)){var Y=null;0==H?(Y=Wp.get(i,r),(_||p)&&(Y.forced=!0)):2==H?(Y=Wp.get(a,r),(u||p)&&(Y.forced=!0)):4==H?(Y=Wp.get(a,s),(u||h)&&(Y.forced=!0)):6==H?(Y=Wp.get(i,s),(_||h)&&(Y.forced=!0)):1==H?(null==(Y=n.get(l,o<<1))?(Y=Wp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,Y)):Y=Wp.get(Y.x,Y.y),p&&(Y.forced=!0),Y.x!=i&&Y.x!=a||(Y.x==i&&0!=(1&W)||Y.x==a&&0!=(4&W))&&(W^=2)):5==H?(null==(Y=n.get(l,2+(o<<1)))?(Y=Wp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),Y)):Y=Wp.get(Y.x,Y.y),h&&(Y.forced=!0),Y.x!=i&&Y.x!=a||(Y.x==i&&0!=(64&W)||Y.x==a&&0!=(16&W))&&(W^=32)):3==H?(null==(Y=n.get(l+1,1+(o<<1)))?(Y=Wp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),Y)):Y=Wp.get(Y.x,Y.y),u&&(Y.forced=!0),Y.y!=r&&Y.y!=s||(Y.y==r&&0!=(4&W)||Y.y==s&&0!=(16&W))&&(W^=8)):(null==(Y=n.get(l,1+(o<<1)))?(Y=Wp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),Y)):Y=Wp.get(Y.x,Y.y),_&&(Y.forced=!0),Y.y!=r&&Y.y!=s||(Y.y==r&&0!=(1&W)||Y.y==s&&0!=(64&W))&&(W^=128));var J=Y;null==v.p1?v.p1=J.prev=J.next=J:(J.prev=v.p1,J.next=v.p1.next,v.p1.next.prev=J,v.p1.next=J),v.p1=J}}v.p1=v.p1.next,1!=(v.key1=W)&&4!=W&&16!=W&&64!=W&&3!=W&&12!=W&&48!=W&&192!=W&&129!=W&&6!=W&&24!=W&&96!=W&&5!=W&&20!=W&&80!=W&&65!=W&&17!=W&&68!=W||(W=0,v.key1=0,v.p1=null),0==W?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}else{var K=224;v.okey1=K;for(var Q=0;Q<8;){var $=Q++;if(0!=(K&1<<$)){var ee=null;0==$?(ee=Wp.get(i,r),(_||p)&&(ee.forced=!0)):2==$?(ee=Wp.get(a,r),(u||p)&&(ee.forced=!0)):4==$?(ee=Wp.get(a,s),(u||h)&&(ee.forced=!0)):6==$?(ee=Wp.get(i,s),(_||h)&&(ee.forced=!0)):1==$?(null==(ee=n.get(l,o<<1))?(ee=Wp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,ee)):ee=Wp.get(ee.x,ee.y),p&&(ee.forced=!0),ee.x!=i&&ee.x!=a||(ee.x==i&&0!=(1&K)||ee.x==a&&0!=(4&K))&&(K^=2)):5==$?(null==(ee=n.get(l,2+(o<<1)))?(ee=Wp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),ee)):ee=Wp.get(ee.x,ee.y),h&&(ee.forced=!0),ee.x!=i&&ee.x!=a||(ee.x==i&&0!=(64&K)||ee.x==a&&0!=(16&K))&&(K^=32)):3==$?(null==(ee=n.get(l+1,1+(o<<1)))?(ee=Wp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),ee)):ee=Wp.get(ee.x,ee.y),u&&(ee.forced=!0),ee.y!=r&&ee.y!=s||(ee.y==r&&0!=(4&K)||ee.y==s&&0!=(16&K))&&(K^=8)):(null==(ee=n.get(l,1+(o<<1)))?(ee=Wp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),ee)):ee=Wp.get(ee.x,ee.y),_&&(ee.forced=!0),ee.y!=r&&ee.y!=s||(ee.y==r&&0!=(1&K)||ee.y==s&&0!=(64&K))&&(K^=128));var te=ee;null==v.p1?v.p1=te.prev=te.next=te:(te.prev=v.p1,te.next=v.p1.next,v.p1.next.prev=te,v.p1.next=te),v.p1=te}}if(v.p1=v.p1.next,1!=(v.key1=K)&&4!=K&&16!=K&&64!=K&&3!=K&&12!=K&&48!=K&&192!=K&&129!=K&&6!=K&&24!=K&&96!=K&&5!=K&&20!=K&&80!=K&&65!=K&&17!=K&&68!=K||(K=0,v.key1=0,v.p1=null),0!=K){var ne=14;v.okey2=ne;for(var ie=0;ie<8;){var re=ie++;if(0!=(ne&1<<re)){var ae=null;0==re?(ae=Wp.get(i,r),(_||p)&&(ae.forced=!0)):2==re?(ae=Wp.get(a,r),(u||p)&&(ae.forced=!0)):4==re?(ae=Wp.get(a,s),(u||h)&&(ae.forced=!0)):6==re?(ae=Wp.get(i,s),(_||h)&&(ae.forced=!0)):1==re?(null==(ae=n.get(l,o<<1))?(ae=Wp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,ae)):ae=Wp.get(ae.x,ae.y),p&&(ae.forced=!0),ae.x!=i&&ae.x!=a||(ae.x==i&&0!=(1&ne)||ae.x==a&&0!=(4&ne))&&(ne^=2)):5==re?(null==(ae=n.get(l,2+(o<<1)))?(ae=Wp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),ae)):ae=Wp.get(ae.x,ae.y),h&&(ae.forced=!0),ae.x!=i&&ae.x!=a||(ae.x==i&&0!=(64&ne)||ae.x==a&&0!=(16&ne))&&(ne^=32)):3==re?(null==(ae=n.get(l+1,1+(o<<1)))?(ae=Wp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),ae)):ae=Wp.get(ae.x,ae.y),u&&(ae.forced=!0),ae.y!=r&&ae.y!=s||(ae.y==r&&0!=(4&ne)||ae.y==s&&0!=(16&ne))&&(ne^=8)):(null==(ae=n.get(l,1+(o<<1)))?(ae=Wp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),ae)):ae=Wp.get(ae.x,ae.y),_&&(ae.forced=!0),ae.y!=r&&ae.y!=s||(ae.y==r&&0!=(1&ne)||ae.y==s&&0!=(64&ne))&&(ne^=128));var se=ae;null==v.p2?v.p2=se.prev=se.next=se:(se.prev=v.p2,se.next=v.p2.next,v.p2.next.prev=se,v.p2.next=se),v.p2=se}}v.p2=v.p2.next,1!=(v.key2=ne)&&4!=ne&&16!=ne&&64!=ne&&3!=ne&&12!=ne&&48!=ne&&192!=ne&&129!=ne&&6!=ne&&24!=ne&&96!=ne&&5!=ne&&20!=ne&&80!=ne&&65!=ne&&17!=ne&&68!=ne||(ne=0,v.key2=0,v.p2=null),v.keyr=0==ne?(v.pr=v.p1,v.okeyr=v.okey1,v.key1):(v.pr=v.p2,v.okeyr=v.okey2,v.key2)}else{var le=14;v.okey1=le;for(var oe=0;oe<8;){var _e=oe++;if(0!=(le&1<<_e)){var pe=null;0==_e?(pe=Wp.get(i,r),(_||p)&&(pe.forced=!0)):2==_e?(pe=Wp.get(a,r),(u||p)&&(pe.forced=!0)):4==_e?(pe=Wp.get(a,s),(u||h)&&(pe.forced=!0)):6==_e?(pe=Wp.get(i,s),(_||h)&&(pe.forced=!0)):1==_e?(null==(pe=n.get(l,o<<1))?(pe=Wp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,pe)):pe=Wp.get(pe.x,pe.y),p&&(pe.forced=!0),pe.x!=i&&pe.x!=a||(pe.x==i&&0!=(1&le)||pe.x==a&&0!=(4&le))&&(le^=2)):5==_e?(null==(pe=n.get(l,2+(o<<1)))?(pe=Wp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),pe)):pe=Wp.get(pe.x,pe.y),h&&(pe.forced=!0),pe.x!=i&&pe.x!=a||(pe.x==i&&0!=(64&le)||pe.x==a&&0!=(16&le))&&(le^=32)):3==_e?(null==(pe=n.get(l+1,1+(o<<1)))?(pe=Wp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),pe)):pe=Wp.get(pe.x,pe.y),u&&(pe.forced=!0),pe.y!=r&&pe.y!=s||(pe.y==r&&0!=(4&le)||pe.y==s&&0!=(16&le))&&(le^=8)):(null==(pe=n.get(l,1+(o<<1)))?(pe=Wp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),pe)):pe=Wp.get(pe.x,pe.y),_&&(pe.forced=!0),pe.y!=r&&pe.y!=s||(pe.y==r&&0!=(1&le)||pe.y==s&&0!=(64&le))&&(le^=128));var ue=pe;null==v.p1?v.p1=ue.prev=ue.next=ue:(ue.prev=v.p1,ue.next=v.p1.next,v.p1.next.prev=ue,v.p1.next=ue),v.p1=ue}}v.p1=v.p1.next,1!=(v.key1=le)&&4!=le&&16!=le&&64!=le&&3!=le&&12!=le&&48!=le&&192!=le&&129!=le&&6!=le&&24!=le&&96!=le&&5!=le&&20!=le&&80!=le&&65!=le&&17!=le&&68!=le||(le=0,v.key1=0,v.p1=null),0==le?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}}}return v},lerp:function(e,t,n,i){if(0==n)return e;if(0==i)return t;var r=n-i,a=r*r<co.epsilon*co.epsilon?.5:n/r;return a<0?a=0:1<a&&(a=1),e+a*(t-e)},xlerp:function(e,t,n,i,r,a,s){for(var l=this.lerp(e,t,i,r);0!=s--&&e<l&&l<t;){var o=Kp.ISO(a,l,n);if(0==o)break;i*o<0?(t=l,r=o):(e=l,i=o),l=this.lerp(e,t,i,r)}return l},ylerp:function(e,t,n,i,r,a,s){for(var l=this.lerp(e,t,i,r);0!=s--&&e<l&&l<t;){var o=Kp.ISO(a,n,l);if(0==o)break;i*o<0?(t=l,r=o):(e=l,i=o),l=this.lerp(e,t,i,r)}return l},__class__:Kp};var Qp=function(){this.next=null,this._invalidate=null,this.ty=0,this.tx=0,this.d=0,this.c=0,this.b=0,this.a=0,this.outer=null};(n["zpp_nape.geom.ZPP_Mat23"]=Qp).__name__=["zpp_nape","geom","ZPP_Mat23"],Qp.get=function(){var e;return null==Qp.zpp_pool?e=new Qp:(e=Qp.zpp_pool,Qp.zpp_pool=e.next,e.next=null),e.alloc(),e},Qp.identity=function(){var e=Qp.get();return e.setas(1,0,0,1,0,0),e},Qp.prototype={outer:null,wrapper:function(){if(null==this.outer){this.outer=new d_;var e=this.outer.zpp_inner;e.free(),e.next=Qp.zpp_pool,Qp.zpp_pool=e,this.outer.zpp_inner=this}return this.outer},a:null,b:null,c:null,d:null,tx:null,ty:null,_invalidate:null,invalidate:function(){null!=this._invalidate&&this._invalidate()},set:function(e){this.setas(e.a,e.b,e.c,e.d,e.tx,e.ty)},setas:function(e,t,n,i,r,a){this.tx=r,this.ty=a,this.a=e,this.b=t,this.c=n,this.d=i},next:null,free:function(){},alloc:function(){},__class__:Qp};var $p=function(e,t){this.x=null,this.n=0,this.m=0,this.outer=null,this.m=e,this.n=t,this.x=[];for(var n=0,i=e*t;n<i;)n++,this.x.push(0)};(n["zpp_nape.geom.ZPP_MatMN"]=$p).__name__=["zpp_nape","geom","ZPP_MatMN"],$p.prototype={outer:null,m:null,n:null,x:null,__class__:$p};var eu=function(){};(n["zpp_nape.geom.ZPP_Monotone"]=eu).__name__=["zpp_nape","geom","ZPP_Monotone"],eu.bisector=function(e){var t,n,i,r,a=e.prev,s=e.next;t=e.x-a.x,n=e.y-a.y,i=s.x-e.x,r=s.y-e.y;var l=fu.get(-n-r,t+i),o=l.x*l.x+l.y*l.y,_=dc.invsqrt(o);return l.x*=_,l.y*=_,r*t-i*n<0&&(l.x=-l.x,l.y=-l.y),l},eu.below=function(e,t){if(e.y<t.y)return!0;if(e.y>t.y)return!1;if(e.x<t.x)return!0;if(e.x>t.x)return!1;var n=eu.bisector(e),i=eu.bisector(t);n.x+=1*e.x,n.y+=1*e.y,i.x+=1*t.x,i.y+=1*t.y;var r=n.x<i.x||n.x==i.x&&n.y<i.y,a=n;a.free(),a.next=fu.zpp_pool,fu.zpp_pool=a;var s=i;return s.free(),s.next=fu.zpp_pool,fu.zpp_pool=s,r},eu.above=function(e,t){return eu.below(t,e)},eu.left_vertex=function(e){var t=e.prev;return t.y>e.y||t.y==e.y&&e.next.y<e.y},eu.isMonotone=function(e){var t=e,n=e,i=e.next,r=e;if(null!=i)for(var a=i;;){var s=a;if(s.y<t.y&&(t=s),s.y>n.y&&(n=s),(a=a.next)==r)break}var l=!0,o=t;if(n!=t.next){var _=t.next,p=n;if(null!=_)for(var u=_;;){var h=u;if(h.y<o.y){l=!1;break}if(o=h,(u=u.next)==p)break}}if(!l)return!1;if(n!=(o=t).prev){var c=t.prev,d=n;if(null!=c)for(var m=c;;){var f=m;if(f.y<o.y){l=!1;break}if(o=f,(m=m.prev)==d)break}}return l},eu.getShared=function(){return null==eu.sharedPPoly&&(eu.sharedPPoly=new nu),eu.sharedPPoly},eu.decompose=function(e,t){if(null==t?t=new nu(e):t.init(e),null==t.vertices)return t;null==eu.queue&&(eu.queue=new Qu);var n=t.vertices,i=t.vertices;if(null!=n)for(var r=n;;){var a,s,l,o=r;eu.queue.add(o),a=o.next.x-o.x,s=o.next.y-o.y,l=o.prev.x-o.x;var _=0<(o.prev.y-o.y)*a-l*s;if(o.type=eu.below(o.prev,o)?eu.below(o.next,o)?_?0:3:4:eu.below(o,o.next)?_?1:2:4,(r=r.next)==i)break}var p=eu.queue;if(!p.empty()&&null!=p.begin().next){for(var u,h,c,d=p.begin(),m=null,f=null,g=null,v=null,b=1;;){for(u=0,f=d,m=d=null;null!=f;){for(++u,g=f,h=0,c=b;null!=g&&h<b;)++h,g=g.next;for(;0<h||0<c&&null!=g;)0==h?(g=(v=g).next,--c):0==c||null==g?(f=(v=f).next,--h):eu.above(f.elem(),g.elem())?(f=(v=f).next,--h):(g=(v=g).next,--c),null!=m?m.next=v:d=v,m=v;f=g}if(m.next=null,b<<=1,!(1<u))break}p.setbegin(d)}for(null==eu.edges&&(null==vc.zpp_pool?eu.edges=new vc:(eu.edges=vc.zpp_pool,vc.zpp_pool=eu.edges.next,eu.edges.next=null),eu.edges.alloc(),eu.edges.lt=tu.edge_lt,eu.edges.swapped=tu.edge_swap);!eu.queue.empty();){var y=eu.queue.pop_unsafe();switch(y.type){case 0:(y.helper=y).node=eu.edges.insert(y);break;case 1:var x=y.prev;2==x.helper.type&&t.add_diagonal(y,x.helper),eu.edges.remove_node(x.node);break;case 2:var z=y.prev;2==z.helper.type&&t.add_diagonal(y,z.helper),eu.edges.remove_node(z.node);var w=null;if(!eu.edges.empty()){for(var k=eu.edges.parent;null!=k.prev;)k=k.prev;for(;null!=k;){var S=k.data;if(!tu.vert_lt(S,y)){w=S;break}if(null!=k.next)for(k=k.next;null!=k.prev;)k=k.prev;else{for(;null!=k.parent&&k==k.parent.next;)k=k.parent;k=k.parent}}}var C=w;null!=C&&(2==C.helper.type&&t.add_diagonal(y,C.helper),C.helper=y);break;case 3:var N=null;if(!eu.edges.empty()){for(var P=eu.edges.parent;null!=P.prev;)P=P.prev;for(;null!=P;){var M=P.data;if(!tu.vert_lt(M,y)){N=M;break}if(null!=P.next)for(P=P.next;null!=P.prev;)P=P.prev;else{for(;null!=P.parent&&P==P.parent.next;)P=P.parent;P=P.parent}}}var I=N;null!=I&&(t.add_diagonal(y,I.helper),I.helper=y),y.node=eu.edges.insert(y),y.helper=y;break;case 4:var T=y.prev;if(eu.left_vertex(y))2==T.helper.type&&t.add_diagonal(y,T.helper),eu.edges.remove_node(T.node),y.node=eu.edges.insert(y),y.helper=y;else{var A=null;if(!eu.edges.empty()){for(var D=eu.edges.parent;null!=D.prev;)D=D.prev;for(;null!=D;){var E=D.data;if(!tu.vert_lt(E,y)){A=E;break}if(null!=D.next)for(D=D.next;null!=D.prev;)D=D.prev;else{for(;null!=D.parent&&D==D.parent.next;)D=D.parent;D=D.parent}}}var O=A;2==O.helper.type&&t.add_diagonal(y,O.helper),O.helper=y}}}return t};var tu=function(){this.node=null,this.prev=null,this.next=null,this.rightchain=!1,this.helper=null,this.type=0,this.diagonals=null,this.forced=!1,this.y=0,this.x=0,this.mag=0,this.id=0,this.id=tu.nextId++,this.diagonals=new Qu};(n["zpp_nape.geom.ZPP_PartitionVertex"]=tu).__name__=["zpp_nape","geom","ZPP_PartitionVertex"],tu.get=function(e){var t;return null==tu.zpp_pool?t=new tu:(t=tu.zpp_pool,tu.zpp_pool=t.next,t.next=null),t.alloc(),t.x=e.x,t.y=e.y,t},tu.rightdistance=function(e,t){var n,i,r,a=e.next.y>e.y;return n=e.next.x-e.x,i=e.next.y-e.y,r=t.x-e.x,(a?-1:1)*((t.y-e.y)*n-r*i)},tu.vert_lt=function(e,t){if(t==e||t==e.next)return!0;if(e.y!=e.next.y)return tu.rightdistance(e,t)<=0;var n=e.x,i=e.next.x;return(n<i?n:i)<=t.x},tu.edge_swap=function(e,t){var n=e.node;e.node=t.node,t.node=n},tu.edge_lt=function(e,t){if(e==t&&e.next==t.next)return!1;if(e==t.next)return!tu.vert_lt(e,t);if(t==e.next)return tu.vert_lt(t,e);if(e.y==e.next.y){if(t.y!=t.next.y)return 0<tu.rightdistance(t,e)||0<tu.rightdistance(t,e.next);var n=e.x,i=e.next.x,r=t.x,a=t.next.x;return(a<r?r:a)<(i<n?n:i)}var s=tu.rightdistance(e,t),l=tu.rightdistance(e,t.next);if(0==s&&0==l){var o=e.x,_=e.next.x,p=t.x,u=t.next.x;return(u<p?p:u)<(_<o?o:_)}if(0<=s*l)return s<0||l<0;var h=tu.rightdistance(t,e),c=tu.rightdistance(t,e.next);return 0<=h*c&&(0<h||0<c)},tu.prototype={id:null,mag:null,x:null,y:null,forced:null,diagonals:null,type:null,helper:null,rightchain:null,next:null,prev:null,alloc:function(){},free:function(){this.helper=null},copy:function(){var e;return null==tu.zpp_pool?e=new tu:(e=tu.zpp_pool,tu.zpp_pool=e.next,e.next=null),e.alloc(),e.x=this.x,e.y=this.y,e.forced=this.forced,e},sort:function(){var e=0,t=0,n=0;e=this.prev.x-this.x,t=this.prev.y-this.y,n=this.next.x-this.x;var i=(this.next.y-this.y)*e-n*t,r=0<i?-1:0==i?0:1,a=this.diagonals;if(!a.empty()&&null!=a.begin().next){for(var s,l,o,_=a.begin(),p=null,u=null,h=null,c=null,d=1;;){for(s=0,u=_,p=_=null;null!=u;){for(++s,h=u,l=0,o=d;null!=h&&l<d;)++l,h=h.next;for(;0<l||0<o&&null!=h;){if(0==l)h=(c=h).next,--o;else if(0==o||null==h)u=(c=u).next,--l;else{var m;if(1==r){e=u.elem().x-this.x,t=u.elem().y-this.y,n=h.elem().x-this.x;var f=(h.elem().y-this.y)*e-n*t;m=1==(0<f?-1:0==f?0:1)}else{e=this.prev.x-this.x,t=this.prev.y-this.y,n=u.elem().x-this.x;var g=(u.elem().y-this.y)*e-n*t,v=0<g?-1:0==g?0:1;e=this.prev.x-this.x,t=this.prev.y-this.y,n=h.elem().x-this.x;var b=(h.elem().y-this.y)*e-n*t,y=0<b?-1:0==b?0:1;if(v*y==1||v*y==0&&(1==v||1==y)){e=u.elem().x-this.x,t=u.elem().y-this.y,n=h.elem().x-this.x;var x=(h.elem().y-this.y)*e-n*t;m=1==(0<x?-1:0==x?0:1)}else if(-1==v||-1==y)m=-1==y;else if(0==v&&0==y){e=this.x-this.prev.x,t=this.y-this.prev.y;var z=e*(n=u.elem().x-this.x)+t*(u.elem().y-this.y),w=e*(n=h.elem().x-this.x)+t*(h.elem().y-this.y);m=z<0&&0<w||!(w<0&&0<z)}else m=!0}m?(u=(c=u).next,--l):(h=(c=h).next,--o)}null!=p?p.next=c:_=c,p=c}u=h}if(p.next=null,d<<=1,!(1<s))break}a.setbegin(_)}},node:null,__class__:tu};var nu=function(e){this.next=null,this.vertices=null,this.init(e)};(n["zpp_nape.geom.ZPP_PartitionedPoly"]=nu).__name__=["zpp_nape","geom","ZPP_PartitionedPoly"],nu.getSharedPP=function(){return null==nu.sharedPPList&&(nu.sharedPPList=new $u),nu.sharedPPList},nu.getShared=function(){return null==nu.sharedGVList&&(nu.sharedGVList=new eh),nu.sharedGVList},nu.prototype={vertices:null,eq:function(e,t){return vu.vec_dsq(e.x,e.y,t.x,t.y)<co.epsilon*co.epsilon},next:null,alloc:function(){},free:function(){},init:function(e){if(null!=e){var t=0,n=e;if(null!=e)for(var i=e;;){var r=i;if(t+=r.x*(r.next.y-r.prev.y),(i=i.next)==n)break}for(var a=0<.5*t,s=e;;){var l;if(a){var o=tu.get(s);null==this.vertices?this.vertices=o.prev=o.next=o:(o.prev=this.vertices,o.next=this.vertices.next,this.vertices.next.prev=o,this.vertices.next=o),l=o}else{var _=tu.get(s);null==this.vertices?this.vertices=_.prev=_.next=_:(_.next=this.vertices,_.prev=this.vertices.prev,this.vertices.prev.next=_,this.vertices.prev=_),l=_}if(this.vertices=l,this.vertices.forced=s.forced,(s=s.next)==e)break}this.remove_collinear_vertices()}},remove_collinear_vertices:function(){for(var e,t=this.vertices,n=!0;n||t!=this.vertices;)if(n=!1,this.eq(t,t.next)){if(t==this.vertices&&(this.vertices=t.next,n=!0),t.forced&&(t.next.forced=!0),null!=t&&t.prev==t){t.next=t.prev=null;var i=t;i.free(),i.next=tu.zpp_pool,tu.zpp_pool=i,t=t=null}else{var r=t.next;t.prev.next=t.next,t.next.prev=t.prev,t.next=t.prev=null;var a=t;a.free(),a.next=tu.zpp_pool,tu.zpp_pool=a,t=null,t=r}if(null==t){this.vertices=null;break}}else t=t.next;if(null==this.vertices)return!0;for(;;){for(e=!1,t=this.vertices,n=!0;n||t!=this.vertices;){n=!1;var s,l,o,_=t.prev;s=t.x-_.x,l=t.y-_.y,o=t.next.x-t.x;var p=(t.next.y-t.y)*s-o*l;if(co.epsilon*co.epsilon<=p*p)t=t.next;else{if(t==this.vertices&&(this.vertices=t.next,n=!0),null!=t&&t.prev==t){t.next=t.prev=null;var u=t;u.free(),u.next=tu.zpp_pool,tu.zpp_pool=u,t=t=null}else{var h=t.next;t.prev.next=t.next,t.next.prev=t.prev,t.next=t.prev=null;var c=t;c.free(),c.next=tu.zpp_pool,tu.zpp_pool=c,t=null,t=h}if(e=!0,null==t){e=!1,this.vertices=null;break}}}if(!e)break}return null==this.vertices},add_diagonal:function(e,t){e.diagonals.add(t),t.diagonals.add(e),e.forced=t.forced=!0},extract_partitions:function(e){if(null==e&&(e=new $u),null!=this.vertices){var t=this.vertices,n=this.vertices;if(null!=t)for(var i=t;i.sort(),(i=i.next)!=n;);for(this.pull_partitions(this.vertices,e);null!=this.vertices;){var r;if(null!=this.vertices&&this.vertices.prev==this.vertices){this.vertices.next=this.vertices.prev=null;var a=this.vertices;a.free(),a.next=tu.zpp_pool,tu.zpp_pool=a,r=this.vertices=null}else{var s=this.vertices.next;this.vertices.prev.next=this.vertices.next,this.vertices.next.prev=this.vertices.prev,this.vertices.next=this.vertices.prev=null;var l=this.vertices;l.free(),l.next=tu.zpp_pool,tu.zpp_pool=l,this.vertices=null,r=s}this.vertices=r}for(var o=null,_=e.begin();null!=_;)_.elem().remove_collinear_vertices()?e.erase(o):_=(o=_).next}return e},pull_partitions:function(e,t){var n;null==nu.zpp_pool?n=new nu:(n=nu.zpp_pool,nu.zpp_pool=n.next,n.next=null),n.alloc();for(var i=e;;){var r=i.copy();if(null==n.vertices?n.vertices=r.prev=r.next=r:(r.prev=n.vertices,r.next=n.vertices.next,n.vertices.next.prev=r,n.vertices.next=r),n.vertices=r,n.vertices.forced=i.forced,i.diagonals.empty())i=i.next;else{if(i.diagonals.inlined_pop_unsafe()==e)break;i=this.pull_partitions(i,t)}if(i==e)break}var a=0,s=n.vertices,l=n.vertices;if(null!=s)for(var o=s;;){var _=o;if(a+=_.x*(_.next.y-_.prev.y),(o=o.next)==l)break}return.5*a!=0&&t.add(n),i},extract:function(e){if(null==e&&(e=new eh),null!=this.vertices){var t=this.vertices,n=this.vertices;if(null!=t)for(var i=t;i.sort(),(i=i.next)!=n;);for(this.pull(this.vertices,e);null!=this.vertices;){var r;if(null!=this.vertices&&this.vertices.prev==this.vertices){this.vertices.next=this.vertices.prev=null;var a=this.vertices;a.free(),a.next=tu.zpp_pool,tu.zpp_pool=a,r=this.vertices=null}else{var s=this.vertices.next;this.vertices.prev.next=this.vertices.next,this.vertices.next.prev=this.vertices.prev,this.vertices.next=this.vertices.prev=null;var l=this.vertices;l.free(),l.next=tu.zpp_pool,tu.zpp_pool=l,this.vertices=null,r=s}this.vertices=r}}return e},pull:function(e,t){for(var n=null,i=e;;){var r=Wp.get(i.x,i.y);if(null==n?n=r.prev=r.next=r:(r.prev=n,r.next=n.next,n.next.prev=r,n.next=r),(n=r).forced=i.forced,i.diagonals.empty())i=i.next;else{if(i.diagonals.inlined_pop_unsafe()==e)break;i=this.pull(i,t)}if(i==e)break}var a=0,s=n;if(null!=n)for(var l=n;;){var o=l;if(a+=o.x*(o.next.y-o.prev.y),(l=l.next)==s)break}var _=.5*a;if(co.epsilon*co.epsilon<=_*_){for(var p=n,u=!0;u||p!=n;)if(u=!1,vu.vec_dsq(p.x,p.y,p.next.x,p.next.y)<co.epsilon*co.epsilon){if(p==n&&(n=p.next,u=!0),p.forced&&(p.next.forced=!0),null!=p&&p.prev==p)p.next=p.prev=null,p=p=null;else{var h=p.next;p.prev.next=p.next,p.next.prev=p.prev,p.next=p.prev=null,p=null,p=h}if(null==p){n=null;break}}else p=p.next;if(null!=n)for(var c;;){for(p=n,u=!(c=!1);u||p!=n;){u=!1;var d,m,f,g=p.prev;d=p.x-g.x,m=p.y-g.y,f=p.next.x-p.x;var v=(p.next.y-p.y)*d-f*m;if(co.epsilon*co.epsilon<=v*v)p=p.next;else{if(p==n&&(n=p.next,u=!0),null!=p&&p.prev==p)p.next=p.prev=null,p=p=null;else{var b=p.next;p.prev.next=p.next,p.next.prev=p.prev,p.next=p.prev=null,p=null,p=b}if(c=!0,null==p){c=!1,n=null;break}}}if(!c)break}null!=n&&t.add(n)}return i},__class__:nu};var iu=function(){this.zip_dir=!1,this.absnormaly=0,this.absnormalx=0,this.normaly=0,this.normalx=0,this.idiry=0,this.idirx=0,this.diry=0,this.dirx=0,this.originy=0,this.originx=0,this.userData=null,this.maxdist=0,this.direction=null,this.origin=null,this.origin=y_.get(),this.origin.zpp_inner._invalidate=Cc(this,this.origin_invalidate),this.direction=y_.get(),this.direction.zpp_inner._invalidate=Cc(this,this.direction_invalidate),this.originx=0,this.originy=0,this.dirx=0,this.diry=0,this.zip_dir=!1};(n["zpp_nape.geom.ZPP_Ray"]=iu).__name__=["zpp_nape","geom","ZPP_Ray"],iu.prototype={origin:null,direction:null,maxdist:null,userData:null,originx:null,originy:null,dirx:null,diry:null,idirx:null,idiry:null,normalx:null,normaly:null,absnormalx:null,absnormaly:null,origin_invalidate:function(e){this.originx=e.x,this.originy=e.y},direction_invalidate:function(e){this.dirx=e.x,this.diry=e.y,this.invalidate_dir()},zip_dir:null,invalidate_dir:function(){this.zip_dir=!0},validate_dir:function(){if(this.zip_dir){this.zip_dir=!1;var e=this.dirx*this.dirx+this.diry*this.diry,t=1/Math.sqrt(e);this.dirx*=t,this.diry*=t,this.idirx=1/this.dirx,this.idiry=1/this.diry,this.normalx=-this.diry,this.normaly=this.dirx;var n=this.normalx;this.absnormalx=n<0?-n:n;var i=this.normaly;this.absnormaly=i<0?-i:i}},rayAABB:function(){var e=this.originx,t=e,n=this.originy,i=n;if(this.maxdist>=$_.POSINF()?(0<this.dirx?t=$_.POSINF():this.dirx<0&&(t=$_.NEGINF()),0<this.diry?i=$_.POSINF():this.diry<0&&(i=$_.NEGINF())):(t+=this.maxdist*this.dirx,i+=this.maxdist*this.diry),t<e){var r=e;e=t,t=r}if(i<n){var a=n;n=i,i=a}return Lp.get(e,n,t,i)},aabbtest:function(e){var t=this.normalx*(this.originx-.5*(e.minx+e.maxx))+this.normaly*(this.originy-.5*(e.miny+e.maxy));return(t<0?-t:t)<.5*this.absnormalx*(e.maxx-e.minx)+.5*this.absnormaly*(e.maxy-e.miny)},aabbsect:function(e){var t=this.originx>=e.minx&&this.originx<=e.maxx,n=this.originy>=e.miny&&this.originy<=e.maxy;if(t&&n)return 0;for(var i=-1;!(0<=this.dirx&&this.originx>=e.maxx||this.dirx<=0&&this.originx<=e.minx||0<=this.diry&&this.originy>=e.maxy||this.diry<=0&&this.originy<=e.miny);){if(0<this.dirx){var r=(e.minx-this.originx)*this.idirx;if(0<=r&&r<=this.maxdist){var a=this.originy+r*this.diry;if(a>=e.miny&&a<=e.maxy){i=r;break}}}else if(this.dirx<0){var s=(e.maxx-this.originx)*this.idirx;if(0<=s&&s<=this.maxdist){var l=this.originy+s*this.diry;if(l>=e.miny&&l<=e.maxy){i=s;break}}}if(0<this.diry){var o=(e.miny-this.originy)*this.idiry;if(0<=o&&o<=this.maxdist){var _=this.originx+o*this.dirx;if(_>=e.minx&&_<=e.maxx){i=o;break}}}else if(this.diry<0){var p=(e.maxy-this.originy)*this.idiry;if(0<=p&&p<=this.maxdist){var u=this.originx+p*this.dirx;if(u>=e.minx&&u<=e.maxx){i=p;break}}}break}return i},circlesect:function(e,t,n){var i,r;e.validate_worldCOM(),i=this.originx-e.worldCOMx,r=this.originy-e.worldCOMy;var a=this.dirx*this.dirx+this.diry*this.diry,s=2*(i*this.dirx+r*this.diry),l=i*i+r*r-e.radius*e.radius,o=s*s-4*a*l;if(0==o){var _=-s/2*a;if((!t||0<l)&&0<_&&_<n&&_<=this.maxdist){var p=0,u=0;p=this.originx,u=this.originy;var h=_;p+=this.dirx*h,u+=this.diry*h;var c=(p-=1*e.worldCOMx)*p+(u-=1*e.worldCOMy)*u,d=1/Math.sqrt(c);return p*=d,u*=d,l<=0&&(p=-p,u=-u),Gp.getRay(y_.get(p,u),_,l<=0,e.outer)}return null}var m=(-s-(o=Math.sqrt(o)))*(a=1/(2*a)),f=(-s+o)*a;if(0<m){if(m<n&&m<=this.maxdist){var g=0,v=0;g=this.originx,v=this.originy;var b=m;g+=this.dirx*b,v+=this.diry*b;var y=(g-=1*e.worldCOMx)*g+(v-=1*e.worldCOMy)*v,x=1/Math.sqrt(y);return g*=x,v*=x,Gp.getRay(y_.get(g,v),m,!1,e.outer)}return null}if(0<f&&t){if(f<n&&f<=this.maxdist){var z=0,w=0;z=this.originx,w=this.originy;var k=f;z+=this.dirx*k,w+=this.diry*k;var S=(z-=1*e.worldCOMx)*z+(w-=1*e.worldCOMy)*w,C=1/Math.sqrt(S);return z=-(z*=C),w=-(w*=C),Gp.getRay(y_.get(z,w),f,!0,e.outer)}return null}return null},circlesect2:function(e,t,n){var i,r;e.validate_worldCOM(),i=this.originx-e.worldCOMx,r=this.originy-e.worldCOMy;var a=this.dirx*this.dirx+this.diry*this.diry,s=2*(i*this.dirx+r*this.diry),l=i*i+r*r-e.radius*e.radius,o=s*s-4*a*l;if(0==o){var _=-s/2*a;if((!t||0<l)&&0<_&&_<=this.maxdist){var p=0,u=0;p=this.originx,u=this.originy;var h=_;p+=this.dirx*h,u+=this.diry*h;var c=(p-=1*e.worldCOMx)*p+(u-=1*e.worldCOMy)*u,d=1/Math.sqrt(c);p*=d,u*=d,l<=0&&(p=-p,u=-u);for(var m=Gp.getRay(y_.get(p,u),_,l<=0,e.outer),f=null,g=n.zpp_inner.inner.begin();null!=g;){var v=g.elem();if(m.get_distance()<v.get_distance())break;g=(f=g).next}n.zpp_inner.inner.inlined_insert(f,m)}}else{var b=(-s-(o=Math.sqrt(o)))*(a=1/(2*a)),y=(-s+o)*a;if(0<b&&b<=this.maxdist){var x=0,z=0;x=this.originx,z=this.originy;var w=b;x+=this.dirx*w,z+=this.diry*w;var k=(x-=1*e.worldCOMx)*x+(z-=1*e.worldCOMy)*z,S=1/Math.sqrt(k);x*=S,z*=S;for(var C=Gp.getRay(y_.get(x,z),b,!1,e.outer),N=null,P=n.zpp_inner.inner.begin();null!=P;){var M=P.elem();if(C.get_distance()<M.get_distance())break;P=(N=P).next}n.zpp_inner.inner.inlined_insert(N,C)}if(0<y&&y<=this.maxdist&&t){var I=0,T=0;I=this.originx,T=this.originy;var A=y;I+=this.dirx*A,T+=this.diry*A;var D=(I-=1*e.worldCOMx)*I+(T-=1*e.worldCOMy)*T,E=1/Math.sqrt(D);I=-(I*=E),T=-(T*=E);for(var O=Gp.getRay(y_.get(I,T),y,!0,e.outer),B=null,L=n.zpp_inner.inner.begin();null!=L;){var j=L.elem();if(O.get_distance()<j.get_distance())break;L=(B=L).next}n.zpp_inner.inner.inlined_insert(B,O)}}},polysect:function(e,t,n){for(var i=n,r=null,a=e.edges.begin(),s=e.gverts.begin(),l=s.elem(),o=s.next;null!=o;){var _=o.elem(),p=a.elem();if(t||p.gnormx*this.dirx+p.gnormy*this.diry<0){var u,h,c,d;u=_.x-l.x,h=_.y-l.y,c=l.x-this.originx,d=l.y-this.originy;var m=h*this.dirx-u*this.diry;if(co.epsilon<m*m){var f=(h*c-u*d)*(m=1/m);if(0<f&&f<i&&f<=this.maxdist){var g=(this.diry*c-this.dirx*d)*m;-co.epsilon<g&&g<1+co.epsilon&&(i=f,r=a.elem())}}}a=a.next,l=_,o=(s=o).next}for(;;){var v=(o=e.gverts.begin()).elem(),b=a.elem();if(t||b.gnormx*this.dirx+b.gnormy*this.diry<0){var y,x,z,w;y=v.x-l.x,x=v.y-l.y,z=l.x-this.originx,w=l.y-this.originy;var k=x*this.dirx-y*this.diry;if(co.epsilon<k*k){var S=(x*z-y*w)*(k=1/k);if(0<S&&S<i&&S<=this.maxdist){var C=(this.diry*z-this.dirx*w)*k;-co.epsilon<C&&C<1+co.epsilon&&(i=S,r=a.elem())}}}a=a.next;break}if(null==r)return null;var N=0,P=0;N=r.gnormx,P=r.gnormy;var M=0<N*this.dirx+P*this.diry;return M&&(N=-N,P=-P),Gp.getRay(y_.get(N,P),i,M,e.outer)},polysect2:function(e,t,n){for(var i=$_.POSINF(),r=-1,a=null,s=null,l=e.edges.begin(),o=e.gverts.begin(),_=o.elem(),p=o.next;null!=p;){var u=p.elem(),h=l.elem();if(t||h.gnormx*this.dirx+h.gnormy*this.diry<0){var c,d,m,f;c=u.x-_.x,d=u.y-_.y,m=_.x-this.originx,f=_.y-this.originy;var g=d*this.dirx-c*this.diry;if(co.epsilon<g*g){var v=(d*m-c*f)*(g=1/g);if(0<v&&v<=this.maxdist&&(v<i||r<v)){var b=(this.diry*m-this.dirx*f)*g;-co.epsilon<b&&b<1+co.epsilon&&(v<i&&(i=v,a=l.elem()),r<v&&(r=v,s=l.elem()))}}}l=l.next,_=u,p=(o=p).next}for(;;){var y=(p=e.gverts.begin()).elem(),x=l.elem();if(t||x.gnormx*this.dirx+x.gnormy*this.diry<0){var z,w,k,S;z=y.x-_.x,w=y.y-_.y,k=_.x-this.originx,S=_.y-this.originy;var C=w*this.dirx-z*this.diry;if(co.epsilon<C*C){var N=(w*k-z*S)*(C=1/C);if(0<N&&N<=this.maxdist&&(N<i||r<N)){var P=(this.diry*k-this.dirx*S)*C;-co.epsilon<P&&P<1+co.epsilon&&(N<i&&(i=N,a=l.elem()),r<N&&(r=N,s=l.elem()))}}}l=l.next;break}if(null!=a){var M=0,I=0;M=a.gnormx,I=a.gnormy;var T=0<M*this.dirx+I*this.diry;T&&(M=-M,I=-I);for(var A=Gp.getRay(y_.get(M,I),i,T,e.outer),D=null,E=n.zpp_inner.inner.begin();null!=E;){var O=E.elem();if(A.get_distance()<O.get_distance())break;E=(D=E).next}n.zpp_inner.inner.inlined_insert(D,A)}if(null!=s&&a!=s){var B=0,L=0;B=s.gnormx,L=s.gnormy;var j=0<B*this.dirx+L*this.diry;j&&(B=-B,L=-L);for(var F=Gp.getRay(y_.get(B,L),r,j,e.outer),R=null,G=n.zpp_inner.inner.begin();null!=G;){var Z=G.elem();if(F.get_distance()<Z.get_distance())break;G=(R=G).next}n.zpp_inner.inner.inlined_insert(R,F)}},__class__:iu};var ru=function(){this.node=null,this.next=null,this.id=0,this.links=null,this.y=0,this.x=0,this.forced=!1,this.id=ep.ZPP_SimpleVert(),null==yc.zpp_pool?this.links=new yc:(this.links=yc.zpp_pool,yc.zpp_pool=this.links.next,this.links.next=null),this.links.alloc(),this.links.lt=ru.less_xy};(n["zpp_nape.geom.ZPP_SimpleVert"]=ru).__name__=["zpp_nape","geom","ZPP_SimpleVert"],ru.less_xy=function(e,t){return e.y<t.y||e.y==t.y&&e.x<t.x},ru.swap_nodes=function(e,t){var n=e.node;e.node=t.node,t.node=n},ru.get=function(e,t){var n;return null==ru.zpp_pool?n=new ru:(n=ru.zpp_pool,ru.zpp_pool=n.next,n.next=null),n.alloc(),n.x=e,n.y=t,n},ru.prototype={forced:null,x:null,y:null,links:null,id:null,next:null,node:null,free:function(){this.links.clear(),this.node=null,this.forced=!1},alloc:function(){},__class__:ru};var au=function(){this.node=null,this.prev=null,this.next=null,this.id=0,this.vertices=null,this.right=null,this.left=null,this.id=ep.ZPP_SimpleSeg(),null==yc.zpp_pool?this.vertices=new yc:(this.vertices=yc.zpp_pool,yc.zpp_pool=this.vertices.next,this.vertices.next=null),this.vertices.alloc(),this.vertices.lt=Cc(this,this.less_xy)};(n["zpp_nape.geom.ZPP_SimpleSeg"]=au).__name__=["zpp_nape","geom","ZPP_SimpleSeg"],au.get=function(e,t){var n;return null==au.zpp_pool?n=new au:(n=au.zpp_pool,au.zpp_pool=n.next,n.next=null),n.alloc(),n.left=e,n.right=t,n.vertices.insert(e),n.vertices.insert(t),n},au.prototype={left:null,right:null,vertices:null,id:null,next:null,free:function(){this.left=this.right=null,this.prev=null,this.node=null,this.vertices.clear()},alloc:function(){},prev:null,node:null,less_xy:function(e,t){return e.x<t.x||e.x==t.x&&e.y<t.y},__class__:au};var su=function(){this.next=null,this.node=null,this.segment2=null,this.segment=null,this.vertex=null,this.type=0};(n["zpp_nape.geom.ZPP_SimpleEvent"]=su).__name__=["zpp_nape","geom","ZPP_SimpleEvent"],su.swap_nodes=function(e,t){var n=e.node;e.node=t.node,t.node=n},su.less_xy=function(e,t){return e.vertex.x<t.vertex.x||!(e.vertex.x>t.vertex.x)&&(e.vertex.y<t.vertex.y||!(e.vertex.y>t.vertex.y)&&e.type<t.type)},su.get=function(e){var t;return null==su.zpp_pool?t=new su:(t=su.zpp_pool,su.zpp_pool=t.next,t.next=null),t.alloc(),t.vertex=e,t},su.prototype={type:null,vertex:null,segment:null,segment2:null,node:null,next:null,free:function(){this.vertex=null,this.segment=this.segment2=null,this.node=null},alloc:function(){},__class__:su};var lu=function(){this.tree=null,this.sweepx=0,null==xc.zpp_pool?this.tree=new xc:(this.tree=xc.zpp_pool,xc.zpp_pool=this.tree.next,this.tree.next=null),this.tree.alloc(),this.tree.lt=Cc(this,this.edge_lt),this.tree.swapped=Cc(this,this.swap_nodes)};(n["zpp_nape.geom.ZPP_SimpleSweep"]=lu).__name__=["zpp_nape","geom","ZPP_SimpleSweep"],lu.prototype={sweepx:null,tree:null,swap_nodes:function(e,t){var n=e.node;e.node=t.node,t.node=n},edge_lt:function(e,t){var n,i=0,r=0,a=0,s=0;if(e.left==t.left&&e.right==t.right)return!1;if(e.left==t.right)return e.left.x==e.right.x?e.left.y<e.right.y?e.left.y>t.left.y:e.right.y>t.left.y:(n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.left.x-e.left.x,s=t.left.y-e.left.y,(n?r*a-i*s:s*i-a*r)<0);if(e.right==t.left)return!(t.left.x==t.right.x?t.left.y<t.right.y?t.left.y>e.left.y:t.right.y>e.left.y:(n=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,a=e.left.x-t.left.x,s=e.left.y-t.left.y,(n?r*a-i*s:s*i-a*r)<0));if(e.left==t.left)return e.left.x==e.right.x?e.left.y<e.right.y?e.left.y>t.right.y:e.right.y>t.right.y:(n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.right.x-e.left.x,s=t.right.y-e.left.y,(n?r*a-i*s:s*i-a*r)<0);if(e.right==t.right)return e.left.x==e.right.x?e.left.y<e.right.y?e.left.y>t.left.y:e.right.y>t.left.y:(n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.left.x-e.left.x,s=t.left.y-e.left.y,(n?r*a-i*s:s*i-a*r)<0);if(e.left.x==e.right.x){if(t.left.x==t.right.x){var l=e.left.y<e.right.y?e.right:e.left,o=t.left.y<t.right.y?t.right:t.left;return l.y>o.y}n=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,a=e.left.x-t.left.x,s=e.left.y-t.left.y;var _=n?r*a-i*s:s*i-a*r;return n=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,a=e.right.x-t.left.x,s=e.right.y-t.left.y,0<=_*(n?r*a-i*s:s*i-a*r)?0<=_:this.sweepx>=e.left.x}if(t.left.x==t.right.x){n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.left.x-e.left.x,s=t.left.y-e.left.y;var p=n?r*a-i*s:s*i-a*r;return n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.right.x-e.left.x,s=t.right.y-e.left.y,0<=p*(n?r*a-i*s:s*i-a*r)?p<0:this.sweepx<t.left.x}n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.left.x-e.left.x,s=t.left.y-e.left.y;var u=(n?r*a-i*s:s*i-a*r)<0;if(n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.right.x-e.left.x,s=t.right.y-e.left.y,u==(n?r*a-i*s:s*i-a*r)<0)return u;n=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,a=e.left.x-t.left.x,s=e.left.y-t.left.y;var h=0<=(n?r*a-i*s:s*i-a*r);if(n=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,a=e.right.x-t.left.x,s=e.right.y-t.left.y,h==0<=(n?r*a-i*s:s*i-a*r))return h;var c=(this.sweepx-e.left.x)/(e.right.x-e.left.x)*(e.right.y-e.left.y)+e.left.y;return(this.sweepx-t.left.x)/(t.right.x-t.left.x)*(t.right.y-t.left.y)+t.left.y<c},clear:function(){this.tree.clear()},add:function(e){e.node=this.tree.insert(e);var t=this.tree.successor_node(e.node),n=this.tree.predecessor_node(e.node);return null!=t&&(e.next=t.data,t.data.prev=e),null!=n&&(e.prev=n.data,n.data.next=e),e},remove:function(e){var t=this.tree.successor_node(e.node),n=this.tree.predecessor_node(e.node);null!=t&&(t.data.prev=e.prev),null!=n&&(n.data.next=e.next),this.tree.remove_node(e.node),e.node=null},intersect:function(e,t){return null!=e&&null!=t&&(e.left!=t.left&&e.left!=t.right&&e.right!=t.left&&e.right!=t.right&&(!(0<((t.left.x-e.left.x)*(e.right.y-e.left.y)-(e.right.x-e.left.x)*(t.left.y-e.left.y))*((t.right.x-e.left.x)*(e.right.y-e.left.y)-(e.right.x-e.left.x)*(t.right.y-e.left.y)))&&!(0<((e.left.x-t.left.x)*(t.right.y-t.left.y)-(t.right.x-t.left.x)*(e.left.y-t.left.y))*((e.right.x-t.left.x)*(t.right.y-t.left.y)-(t.right.x-t.left.x)*(e.right.y-t.left.y)))))},intersection:function(e,t){if(null==e||null==t)return null;if(e.left==t.left||e.left==t.right||e.right==t.left||e.right==t.right)return null;var n,i,r,a;n=e.right.x-e.left.x,i=e.right.y-e.left.y,r=t.right.x-t.left.x;var s=(a=t.right.y-t.left.y)*n-r*i;if(0==s)return null;s=1/s;var l,o,_=(a*(l=t.left.x-e.left.x)-r*(o=t.left.y-e.left.y))*s;if(_<0||1<_)return null;var p,u=(i*l-n*o)*s;if(u<0||1<u)return null;p=0==u||1==u||0==_||1==_?0==u?t.left:1==u?t.right:0==_?e.left:e.right:ru.get(.5*(e.left.x+n*_+t.left.x+r*u),.5*(e.left.y+i*_+t.left.y+a*u));var h=su.get(p);return h.type=0,h.segment=e,h.segment2=t,h},__class__:lu};var ou=function(){};(n["zpp_nape.geom.ZPP_Simple"]=ou).__name__=["zpp_nape","geom","ZPP_Simple"],ou.decompose=function(e,t){null==ou.sweep&&(ou.sweep=new lu,ou.inthash=new Uu),null==ou.vertices&&(null==yc.zpp_pool?ou.vertices=new yc:(ou.vertices=yc.zpp_pool,yc.zpp_pool=ou.vertices.next,ou.vertices.next=null),ou.vertices.alloc(),ou.vertices.lt=ru.less_xy,ou.vertices.swapped=ru.swap_nodes),null==ou.queue&&(null==zc.zpp_pool?ou.queue=new zc:(ou.queue=zc.zpp_pool,zc.zpp_pool=ou.queue.next,ou.queue.next=null),ou.queue.alloc(),ou.queue.lt=su.less_xy,ou.queue.swapped=su.swap_nodes);var n=null,i=null,r=e;if(null!=e)for(var a=e;;){for(var s=a,l=ru.get(s.x,s.y),o=ou.vertices.parent;null!=o;)if(ou.vertices.lt(l,o.data))o=o.prev;else{if(!ou.vertices.lt(o.data,l))break;o=o.next}var _=o;if(null!=_){var p=l;p.free(),p.next=ru.zpp_pool,ru.zpp_pool=p,l=_.data}else l.node=ou.vertices.insert(l);if(null!=i){var u,h=su.get(i),c=su.get(l);u=su.less_xy(h,c)?(h.type=1,c.type=2,au.get(i,l)):(h.type=2,c.type=1,au.get(l,i)),h.segment=c.segment=u,ou.queue.insert(h),ou.queue.insert(c),i.links.insert(l),l.links.insert(i)}if(i=l,null==n&&(n=l),(a=a.next)==r)break}var d,m=su.get(i),f=su.get(n);for(d=su.less_xy(m,f)?(m.type=1,f.type=2,au.get(i,n)):(m.type=2,f.type=1,au.get(n,i)),m.segment=f.segment=d,ou.queue.insert(m),ou.queue.insert(f),i.links.insert(n),n.links.insert(i),null==ou.ints&&(null==zc.zpp_pool?ou.ints=new zc:(ou.ints=zc.zpp_pool,zc.zpp_pool=ou.ints.next,ou.ints.next=null),ou.ints.alloc(),ou.ints.lt=su.less_xy);!ou.queue.empty();){var g=ou.queue.pop_front();if(ou.sweep.sweepx=g.vertex.x,1==g.type){var v=g.segment;if(ou.sweep.add(v),null!=v.next&&null!=v&&!(v.next.id<v.id?ou.inthash.has(v.next.id,v.id):ou.inthash.has(v.id,v.next.id))){var b=ou.sweep.intersection(v.next,v);if(null!=b)if(b.vertex.x>=ou.sweep.sweepx){for(var y=ou.queue.parent;null!=y;)if(ou.queue.lt(b,y.data))y=y.prev;else{if(!ou.queue.lt(y.data,b))break;y=y.next}var x=y;if(null==x){for(var z=ou.ints.parent;null!=z;)if(ou.ints.lt(b,z.data))z=z.prev;else{if(!ou.ints.lt(z.data,b))break;z=z.next}var w=z;if(null!=w){var k=b.vertex;k.free(),k.next=ru.zpp_pool,ru.zpp_pool=k,b.vertex=w.data.vertex,w.data=b,ou.queue.insert(b)}else ou.queue.insert(b),ou.ints.insert(b);v.next.id<v.id?ou.inthash.add(Zu.get(v.next.id,v.id,!0)):ou.inthash.add(Zu.get(v.id,v.next.id,!0))}else{x.data;var S=b.vertex;S.free(),S.next=ru.zpp_pool,ru.zpp_pool=S;var C=b;C.free(),C.next=su.zpp_pool,su.zpp_pool=C}}else{var N=b.vertex;N.free(),N.next=ru.zpp_pool,ru.zpp_pool=N;var P=b;P.free(),P.next=su.zpp_pool,su.zpp_pool=P}}if(null!=v&&null!=v.prev&&!(v.id<v.prev.id?ou.inthash.has(v.id,v.prev.id):ou.inthash.has(v.prev.id,v.id))){var M=ou.sweep.intersection(v,v.prev);if(null!=M)if(M.vertex.x>=ou.sweep.sweepx){for(var I=ou.queue.parent;null!=I;)if(ou.queue.lt(M,I.data))I=I.prev;else{if(!ou.queue.lt(I.data,M))break;I=I.next}var T=I;if(null==T){for(var A=ou.ints.parent;null!=A;)if(ou.ints.lt(M,A.data))A=A.prev;else{if(!ou.ints.lt(A.data,M))break;A=A.next}var D=A;if(null!=D){var E=M.vertex;E.free(),E.next=ru.zpp_pool,ru.zpp_pool=E,M.vertex=D.data.vertex,D.data=M,ou.queue.insert(M)}else ou.queue.insert(M),ou.ints.insert(M);v.id<v.prev.id?ou.inthash.add(Zu.get(v.id,v.prev.id,!0)):ou.inthash.add(Zu.get(v.prev.id,v.id,!0))}else{T.data;var O=M.vertex;O.free(),O.next=ru.zpp_pool,ru.zpp_pool=O;var B=M;B.free(),B.next=su.zpp_pool,su.zpp_pool=B}}else{var L=M.vertex;L.free(),L.next=ru.zpp_pool,ru.zpp_pool=L;var j=M;j.free(),j.next=su.zpp_pool,su.zpp_pool=j}}}else if(2==g.type){var F=g.segment;if(null!=F.node){var R=F.next,G=F.prev;ou.sweep.remove(F);var Z=F;if(Z.free(),Z.next=au.zpp_pool,au.zpp_pool=Z,null!=R&&null!=G&&!(R.id<G.id?ou.inthash.has(R.id,G.id):ou.inthash.has(G.id,R.id))){var U=ou.sweep.intersection(R,G);if(null!=U)if(U.vertex.x>=ou.sweep.sweepx){for(var V=ou.queue.parent;null!=V;)if(ou.queue.lt(U,V.data))V=V.prev;else{if(!ou.queue.lt(V.data,U))break;V=V.next}var q=V;if(null==q){for(var W=ou.ints.parent;null!=W;)if(ou.ints.lt(U,W.data))W=W.prev;else{if(!ou.ints.lt(W.data,U))break;W=W.next}var X=W;if(null!=X){var H=U.vertex;H.free(),H.next=ru.zpp_pool,ru.zpp_pool=H,U.vertex=X.data.vertex,X.data=U,ou.queue.insert(U)}else ou.queue.insert(U),ou.ints.insert(U);R.id<G.id?ou.inthash.add(Zu.get(R.id,G.id,!0)):ou.inthash.add(Zu.get(G.id,R.id,!0))}else{q.data;var Y=U.vertex;Y.free(),Y.next=ru.zpp_pool,ru.zpp_pool=Y;var J=U;J.free(),J.next=su.zpp_pool,su.zpp_pool=J}}else{var K=U.vertex;K.free(),K.next=ru.zpp_pool,ru.zpp_pool=K;var Q=U;Q.free(),Q.next=su.zpp_pool,su.zpp_pool=Q}}}}else{var $=g.vertex,ee=null==$.node,te=g.segment,ne=g.segment2;if(ne.next!=te){var ie=te;te=ne,ne=ie}for(var re=te.vertices.parent;null!=re;)if(te.vertices.lt($,re.data))re=re.prev;else{if(!te.vertices.lt(re.data,$))break;re=re.next}for(var ae=null==re,se=ne.vertices.parent;null!=se;)if(ne.vertices.lt($,se.data))se=se.prev;else{if(!ne.vertices.lt(se.data,$))break;se=se.next}var le=null==se;if(ae){var oe=te.vertices.insert($),_e=$==te.left?$:te.vertices.predecessor_node(oe).data,pe=$==te.right?$:te.vertices.successor_node(oe).data;_e.links.remove(pe),$!=_e&&_e.links.insert($),pe.links.remove(_e),$!=pe&&pe.links.insert($),$!=_e&&$.links.insert(_e),$!=pe&&$.links.insert(pe)}if(le){var ue=ne.vertices.insert($),he=$==ne.left?$:ne.vertices.predecessor_node(ue).data,ce=$==ne.right?$:ne.vertices.successor_node(ue).data;he.links.remove(ce),$!=he&&he.links.insert($),ce.links.remove(he),$!=ce&&ce.links.insert($),$!=he&&$.links.insert(he),$!=ce&&$.links.insert(ce)}if(ee&&($.node=ou.vertices.insert($)),$.forced=!0,ee){var de=te.node,me=ne.node;de.data=ne,(me.data=te).node=me,ne.node=de,ne.next=te.next,te.next=ne,te.prev=ne.prev,null!=(ne.prev=te).prev&&(te.prev.next=te),null!=ne.next&&(ne.next.prev=ne)}if(null!=ne.next&&null!=ne&&!(ne.next.id<ne.id?ou.inthash.has(ne.next.id,ne.id):ou.inthash.has(ne.id,ne.next.id))){var fe=ou.sweep.intersection(ne.next,ne);if(null!=fe)if(fe.vertex.x>=ou.sweep.sweepx){for(var ge=ou.queue.parent;null!=ge;)if(ou.queue.lt(fe,ge.data))ge=ge.prev;else{if(!ou.queue.lt(ge.data,fe))break;ge=ge.next}var ve=ge;if(null==ve){for(var be=ou.ints.parent;null!=be;)if(ou.ints.lt(fe,be.data))be=be.prev;else{if(!ou.ints.lt(be.data,fe))break;be=be.next}var ye=be;if(null!=ye){var xe=fe.vertex;xe.free(),xe.next=ru.zpp_pool,ru.zpp_pool=xe,fe.vertex=ye.data.vertex,ye.data=fe,ou.queue.insert(fe)}else ou.queue.insert(fe),ou.ints.insert(fe);ne.next.id<ne.id?ou.inthash.add(Zu.get(ne.next.id,ne.id,!0)):ou.inthash.add(Zu.get(ne.id,ne.next.id,!0))}else{ve.data;var ze=fe.vertex;ze.free(),ze.next=ru.zpp_pool,ru.zpp_pool=ze;var we=fe;we.free(),we.next=su.zpp_pool,su.zpp_pool=we}}else{var ke=fe.vertex;ke.free(),ke.next=ru.zpp_pool,ru.zpp_pool=ke;var Se=fe;Se.free(),Se.next=su.zpp_pool,su.zpp_pool=Se}}if(null!=te&&null!=te.prev&&!(te.id<te.prev.id?ou.inthash.has(te.id,te.prev.id):ou.inthash.has(te.prev.id,te.id))){var Ce=ou.sweep.intersection(te,te.prev);if(null!=Ce)if(Ce.vertex.x>=ou.sweep.sweepx){for(var Ne=ou.queue.parent;null!=Ne;)if(ou.queue.lt(Ce,Ne.data))Ne=Ne.prev;else{if(!ou.queue.lt(Ne.data,Ce))break;Ne=Ne.next}var Pe=Ne;if(null==Pe){for(var Me=ou.ints.parent;null!=Me;)if(ou.ints.lt(Ce,Me.data))Me=Me.prev;else{if(!ou.ints.lt(Me.data,Ce))break;Me=Me.next}var Ie=Me;if(null!=Ie){var Te=Ce.vertex;Te.free(),Te.next=ru.zpp_pool,ru.zpp_pool=Te,Ce.vertex=Ie.data.vertex,Ie.data=Ce,ou.queue.insert(Ce)}else ou.queue.insert(Ce),ou.ints.insert(Ce);te.id<te.prev.id?ou.inthash.add(Zu.get(te.id,te.prev.id,!0)):ou.inthash.add(Zu.get(te.prev.id,te.id,!0))}else{Pe.data;var Ae=Ce.vertex;Ae.free(),Ae.next=ru.zpp_pool,ru.zpp_pool=Ae;var De=Ce;De.free(),De.next=su.zpp_pool,su.zpp_pool=De}}else{var Ee=Ce.vertex;Ee.free(),Ee.next=ru.zpp_pool,ru.zpp_pool=Ee;var Oe=Ce;Oe.free(),Oe.next=su.zpp_pool,su.zpp_pool=Oe}}ou.ints.remove(g)}var Be=g;Be.free(),Be.next=su.zpp_pool,su.zpp_pool=Be}for(var Le=0,je=ou.inthash.table.length;Le<je;){var Fe=Le++,Re=ou.inthash.table[Fe];if(null!=Re){for(;null!=Re;){var Ge=Re.hnext;Re.hnext=null;var Ze=Re;Ze.free(),Ze.next=Zu.zpp_pool,Zu.zpp_pool=Ze,Re=Ge}ou.inthash.table[Fe]=null}}for(null==t&&(t=new eh);!ou.vertices.empty();)ou.clip_polygon(ou.vertices,t);return t},ou.clip_polygon=function(e,t){var n,i,r,a=null,s=e.first(),l=s,o=s.links.parent,_=null==o.prev?o.next:o.prev,p=o.data,u=_.data;n=s.x-p.x,i=s.y-p.y,r=u.x-s.x,(u.y-s.y)*n-r*i<0&&(u=p);var h=Wp.get(s.x,s.y);for(null==a?a=h.prev=h.next=h:(h.prev=a,h.next=a.next,a.next.prev=h,a.next=h),(a=h).forced=s.forced;;){if(s.links.remove(u),u.links.remove(s),u==l){if(s.links.empty()){e.remove(s);var c=s;c.free(),c.next=ru.zpp_pool,ru.zpp_pool=c}break}var d=Wp.get(u.x,u.y);if(null==a?a=d.prev=d.next=d:(d.prev=a,d.next=a.next,a.next.prev=d,a.next=d),(a=d).forced=u.forced,u.links.singular()){if(s.links.empty()){e.remove(s);var m=s;m.free(),m.next=ru.zpp_pool,ru.zpp_pool=m}u=(s=u).links.parent.data}else{var f=null,g=0;if(!u.links.empty()){for(var v=u.links.parent;null!=v.prev;)v=v.prev;for(;null!=v;){var b=v.data;if(null==f){var y,x,z;f=b,y=u.x-s.x,x=u.y-s.y,z=b.x-u.x,g=(b.y-u.y)*y-z*x}else{var w,k,S;w=u.x-s.x,k=u.y-s.y,S=b.x-u.x;var C=(b.y-u.y)*w-S*k;if(0<C&&g<=0)f=b,g=C;else if(0<=g*C){var N,P,M;N=u.x-b.x,P=u.y-b.y,M=f.x-u.x,0<(f.y-u.y)*N-M*P&&(f=b,g=C)}}if(null!=v.next)for(v=v.next;null!=v.prev;)v=v.prev;else{for(;null!=v.parent&&v==v.parent.next;)v=v.parent;v=v.parent}}}if(s.links.empty()){e.remove(s);var I=s;I.free(),I.next=ru.zpp_pool,ru.zpp_pool=I}s=u,u=f}}e.remove(l);var T=l;T.free(),T.next=ru.zpp_pool,ru.zpp_pool=T,t.add(a)},ou.isSimple=function(e){null==ou.sweep&&(ou.sweep=new lu,ou.inthash=new Uu);var t=ou.list_vertices;null==t&&(t=ou.list_vertices=new nh);var n=e;if(null!=e)for(var i=e;;){var r=i;if(t.add(ru.get(r.x,r.y)),(i=i.next)==n)break}var a=ou.list_queue;null==a&&(a=ou.list_queue=new ih);var s=t.begin(),l=s.elem();for(s=s.next;null!=s;){var o,_=s.elem(),p=a.add(su.get(l)),u=a.add(su.get(_));o=su.less_xy(p,u)?(p.type=1,u.type=2,au.get(l,_)):(p.type=2,u.type=1,au.get(_,l)),p.segment=u.segment=o,l=_,s=s.next}var h,c=t.front(),d=a.add(su.get(l)),m=a.add(su.get(c));h=su.less_xy(d,m)?(d.type=1,m.type=2,au.get(l,c)):(d.type=2,m.type=1,au.get(c,l)),d.segment=m.segment=h;var f=a;if(!f.empty()&&null!=f.begin().next){for(var g,v,b,y=f.begin(),x=null,z=null,w=null,k=null,S=1;;){for(g=0,z=y,x=y=null;null!=z;){for(++g,w=z,v=0,b=S;null!=w&&v<S;)++v,w=w.next;for(;0<v||0<b&&null!=w;)0==v?(w=(k=w).next,--b):0==b||null==w?(z=(k=z).next,--v):su.less_xy(z.elem(),w.elem())?(z=(k=z).next,--v):(w=(k=w).next,--b),null!=x?x.next=k:y=k,x=k;z=w}if(x.next=null,S<<=1,!(1<g))break}f.setbegin(y)}for(var C=!0;!a.empty();){var N=a.pop_unsafe(),P=N.segment;if(1==N.type){if(ou.sweep.add(P),ou.sweep.intersect(P,P.next)||ou.sweep.intersect(P,P.prev)){C=!1;break}}else if(2==N.type){if(ou.sweep.intersect(P.prev,P.next)){C=!1;break}ou.sweep.remove(P);var M=P;M.free(),M.next=au.zpp_pool,au.zpp_pool=M}var I=N;I.free(),I.next=su.zpp_pool,su.zpp_pool=I}for(;!a.empty();){var T=a.pop_unsafe();if(2==T.type){var A=T.segment;A.free(),A.next=au.zpp_pool,au.zpp_pool=A}var D=T;D.free(),D.next=su.zpp_pool,su.zpp_pool=D}for(ou.sweep.clear();!t.empty();){var E=t.pop_unsafe();E.free(),E.next=ru.zpp_pool,ru.zpp_pool=E}return C};var _u=function(){this.forced=!1,this.flag=!1,this.prev=null,this.next=null,this.y=0,this.x=0};(n["zpp_nape.geom.ZPP_SimplifyV"]=_u).__name__=["zpp_nape","geom","ZPP_SimplifyV"],_u.get=function(e){var t;return null==_u.zpp_pool?t=new _u:(t=_u.zpp_pool,_u.zpp_pool=t.next,t.next=null),t.alloc(),t.x=e.x,t.y=e.y,t.flag=!1,t},_u.prototype={x:null,y:null,next:null,prev:null,flag:null,forced:null,free:function(){},alloc:function(){},__class__:_u};var pu=function(){this.max=null,this.min=null,this.next=null};(n["zpp_nape.geom.ZPP_SimplifyP"]=pu).__name__=["zpp_nape","geom","ZPP_SimplifyP"],pu.get=function(e,t){var n;return null==pu.zpp_pool?n=new pu:(n=pu.zpp_pool,pu.zpp_pool=n.next,n.next=null),n.alloc(),n.min=e,n.max=t,n},pu.prototype={next:null,min:null,max:null,free:function(){this.min=this.max=null},alloc:function(){},__class__:pu};var uu=function(){};(n["zpp_nape.geom.ZPP_Simplify"]=uu).__name__=["zpp_nape","geom","ZPP_Simplify"],uu.lessval=function(e,t){return e.x-t.x+(e.y-t.y)},uu.less=function(e,t){return uu.lessval(e,t)<0},uu.distance=function(e,t,n){var i,r;i=n.x-t.x,r=n.y-t.y;var a=0,s=0;if(a=e.x-t.x,s=e.y-t.y,0==i*i+r*r)return a*a+s*s;var l=(a*i+s*r)/(i*i+r*r);return l<=0?a*a+s*s:1<=l?vu.vec_dsq(e.x,e.y,n.x,n.y):(a-=i*l)*a+(s-=r*l)*s},uu.simplify=function(e,t){var n=null,i=null,r=null;t*=t,null==uu.stack&&(uu.stack=new th);for(var a=null,s=null,l=e;;){var o=_u.get(l);o.forced=l.forced,o.forced&&(o.flag=!0,null!=a?uu.stack.add(pu.get(a,o)):s=o,a=o);var _=o;if(null==n?n=_.prev=_.next=_:(_.prev=n,_.next=n.next,n.next.prev=_,n.next=_),n=_,null==i?r=i=n:(uu.less(n,i)&&(i=n),uu.less(r,n)&&(r=n)),(l=l.next)==e)break}if(uu.stack.empty())if(null==s)i.flag=r.flag=!0,uu.stack.add(pu.get(i,r)),uu.stack.add(pu.get(r,i));else{var p=uu.lessval(i,s);p<0&&(p=-p);var u=uu.lessval(r,s);u<0&&(u=-u),u<p?(i.flag=s.flag=!0,uu.stack.add(pu.get(i,s)),uu.stack.add(pu.get(s,i))):(r.flag=s.flag=!0,uu.stack.add(pu.get(r,s)),uu.stack.add(pu.get(s,r)))}else uu.stack.add(pu.get(a,s));for(;!uu.stack.empty();){var h=uu.stack.pop_unsafe(),c=h.min,d=h.max,m=h;m.free(),m.next=pu.zpp_pool,pu.zpp_pool=m;for(var f=t,g=null,v=c.next;v!=d;){var b=uu.distance(v,c,d);f<b&&(f=b,g=v),v=v.next}null!=g&&(g.flag=!0,uu.stack.add(pu.get(c,g)),uu.stack.add(pu.get(g,d)))}for(var y=null;null!=n;){if(n.flag){var x=Wp.get(n.x,n.y);null==y?y=x.prev=x.next=x:(x.prev=y,x.next=y.next,y.next.prev=x,y.next=x),(y=x).forced=n.forced}if(null!=n&&n.prev==n){n.next=n.prev=null;var z=n;z.free(),z.next=_u.zpp_pool,_u.zpp_pool=z,n=n=null}else{var w=n.next;n.prev.next=n.next,n.next.prev=n.prev,n.next=n.prev=null;var k=n;k.free(),k.next=_u.zpp_pool,_u.zpp_pool=k,n=null,n=w}}return y};var hu=function(){this.kinematic=!1,this.failed=!1,this.slipped=!1,this.axis=null,this.c2=null,this.c1=null,this.frozen2=!1,this.frozen1=!1,this.arbiter=null,this.s2=null,this.s1=null,this.toi=0,this.next=null,this.c1=new fu,this.c2=new fu,this.axis=new fu};(n["zpp_nape.geom.ZPP_ToiEvent"]=hu).__name__=["zpp_nape","geom","ZPP_ToiEvent"],hu.prototype={next:null,alloc:function(){this.failed=!1,this.s1=this.s2=null,this.arbiter=null},free:function(){},toi:null,s1:null,s2:null,arbiter:null,frozen1:null,frozen2:null,c1:null,c2:null,axis:null,slipped:null,failed:null,kinematic:null,__class__:hu};var cu=function(){};(n["zpp_nape.geom.ZPP_SweepDistance"]=cu).__name__=["zpp_nape","geom","ZPP_SweepDistance"],cu.dynamicSweep=function(e,t,n,i,r){null==r&&(r=!1);var a,s,l=e.s1,o=e.s2,_=l.body,p=o.body;a=p.velx-_.velx,s=p.vely-_.vely;var u=_.angvel;u<0&&(u=-u);var h=p.angvel;h<0&&(h=-h);var c=l.sweepCoef*u+o.sweepCoef*h;if(!r&&!e.kinematic&&a*a+s*s<co.dynamicSweepLinearThreshold*co.dynamicSweepLinearThreshold&&c<co.dynamicSweepAngularThreshold)return e.toi=-1,void(e.failed=!0);for(var d=e.c1,m=e.c2,f=e.axis,g=n,v=0;;){_.sweepIntegrate(g*t),_.sweepValidate(l),p.sweepIntegrate(g*t),p.sweepValidate(o);var b=cu.distance(l,o,d,m,f)+i,y=a*f.x+s*f.y;if(b<co.distanceThresholdCCD){if(r)break;var x,z,w,k;x=d.x-_.posx,z=d.y-_.posy,w=m.x-p.posx,k=m.y-p.posy;var S=y-_.sweep_angvel*(f.y*x-f.x*z)+p.sweep_angvel*(f.y*w-f.x*k);if(0<S&&(e.slipped=!0),S<=0||b<.5*co.distanceThresholdCCD)break}var C=(c-y)*t;if(C<=0){g=-1;break}var N=b/C;if(N<1e-6&&(N=1e-6),1<=(g+=N)){g=1,_.sweepIntegrate(g*t),_.sweepValidate(l),p.sweepIntegrate(g*t),p.sweepValidate(o);var P=cu.distance(l,o,d,m,f)+i,M=a*f.x+s*f.y;if(P<co.distanceThresholdCCD){if(r)break;var I,T,A,D;I=d.x-_.posx,T=d.y-_.posy,A=m.x-p.posx,D=m.y-p.posy;var E=M-_.sweep_angvel*(f.y*I-f.x*T)+p.sweep_angvel*(f.y*A-f.x*D);if(0<E&&(e.slipped=!0),E<=0||P<.5*co.distanceThresholdCCD)break}g=-1;break}if(40<=++v){i<b&&(e.failed=!0);break}}e.toi=g},cu.staticSweep=function(e,t,n,i){var r,a,s=e.s1,l=e.s2,o=s.body;l.body,r=-o.velx,a=-o.vely;var _=o.sweep_angvel;_<0&&(_=-_);for(var p=s.sweepCoef*_,u=e.c1,h=e.c2,c=e.axis,d=n,m=0;;){o.sweepIntegrate(d*t),o.sweepValidate(s);var f=cu.distance(s,l,u,h,c)+i,g=r*c.x+a*c.y;if(f<co.distanceThresholdCCD){var v,b;v=u.x-o.posx,b=u.y-o.posy;var y=g-o.sweep_angvel*(c.y*v-c.x*b);if(0<y&&(e.slipped=!0),y<=0||f<.5*co.distanceThresholdCCD)break}var x=(p-g)*t;if(x<=0){d=-1;break}var z=f/x;if(z<1e-6&&(z=1e-6),1<=(d+=z)){d=1,o.sweepIntegrate(d*t),o.sweepValidate(s);var w=cu.distance(s,l,u,h,c)+i,k=r*c.x+a*c.y;if(w<co.distanceThresholdCCD){var S,C;S=u.x-o.posx,C=u.y-o.posy;var N=k-o.sweep_angvel*(c.y*S-c.x*C);if(0<N&&(e.slipped=!0),N<=0||w<.5*co.distanceThresholdCCD)break}d=-1;break}if(40<=++m){i<f&&(e.failed=!0);break}}e.toi=d},cu.distanceBody=function(e,t,n,i){var r,a,s;null==fu.zpp_pool?r=new fu:(r=fu.zpp_pool,fu.zpp_pool=r.next,r.next=null),r.alloc(),null==fu.zpp_pool?a=new fu:(a=fu.zpp_pool,fu.zpp_pool=a.next,a.next=null),a.alloc(),null==fu.zpp_pool?s=new fu:(s=fu.zpp_pool,fu.zpp_pool=s.next,s.next=null),s.alloc();for(var l=$_.FMAX,o=e.shapes.begin();null!=o;){for(var _=o.elem(),p=t.shapes.begin();null!=p;){var u=p.elem(),h=cu.distance(_,u,r,a,s,l);h<l&&(l=h,n.x=r.x,n.y=r.y,i.x=a.x,i.y=a.y),p=p.next}o=o.next}var c=r;c.free(),c.next=fu.zpp_pool,fu.zpp_pool=c;var d=a;d.free(),d.next=fu.zpp_pool,fu.zpp_pool=d;var m=s;return m.free(),m.next=fu.zpp_pool,fu.zpp_pool=m,l},cu.distance=function(e,t,n,i,r,a){if(null==a&&(a=1e100),e.isCircle()&&t.isCircle()){var s,l=e.circle,o=t.circle,_=0,p=0;_=o.worldCOMx-l.worldCOMx,p=o.worldCOMy-l.worldCOMy;var u=dc.sqrt(_*_+p*p);if((s=u-(l.radius+o.radius))<a){if(0==u)_=1,p=0;else{var h=1/u;_*=h,p*=h}var c=l.radius;n.x=l.worldCOMx+_*c,n.y=l.worldCOMy+p*c;var d=-o.radius;i.x=o.worldCOMx+_*d,i.y=o.worldCOMy+p*d,r.x=_,r.y=p}return s}var m=!1;if(e.isCircle()&&t.isPolygon()){var f=e;e=t,t=f;var g=n;n=i,i=g,m=!0}if(e.isPolygon()&&t.isCircle()){for(var v=e.polygon,b=t.circle,y=-$_.FMAX,x=null,z=v.edges.begin();null!=z;){var w=z.elem(),k=w.gnormx*b.worldCOMx+w.gnormy*b.worldCOMy-w.gprojection-b.radius;if(a<k){y=k;break}0<k?y<k&&(y=k,x=w):y<0&&y<k&&(y=k,x=w),z=z.next}if(y<a){var S=x.gp0,C=x.gp1,N=b.worldCOMy*x.gnormx-b.worldCOMx*x.gnormy;if(N<=S.y*x.gnormx-S.x*x.gnormy){var P=0,M=0;P=b.worldCOMx-S.x,M=b.worldCOMy-S.y;var I=dc.sqrt(P*P+M*M);if((y=I-b.radius)<a){if(0==I)P=1,M=0;else{var T=1/I;P*=T,M*=T}n.x=S.x+0*P,n.y=S.y+0*M;var A=-b.radius;i.x=b.worldCOMx+P*A,i.y=b.worldCOMy+M*A,r.x=P,r.y=M}}else if(N>=C.y*x.gnormx-C.x*x.gnormy){var D=0,E=0;D=b.worldCOMx-C.x,E=b.worldCOMy-C.y;var O=dc.sqrt(D*D+E*E);if((y=O-b.radius)<a){if(0==O)D=1,E=0;else{var B=1/O;D*=B,E*=B}n.x=C.x+0*D,n.y=C.y+0*E;var L=-b.radius;i.x=b.worldCOMx+D*L,i.y=b.worldCOMy+E*L,r.x=D,r.y=E}}else{var j=-b.radius;i.x=b.worldCOMx+x.gnormx*j,i.y=b.worldCOMy+x.gnormy*j;var F=-y;n.x=i.x+x.gnormx*F,n.y=i.y+x.gnormy*F,r.x=x.gnormx,r.y=x.gnormy}}return m&&(r.x=-r.x,r.y=-r.y),y}for(var R=e.polygon,G=t.polygon,Z=-$_.FMAX,U=null,V=null,q=0,W=R.edges.begin();null!=W;){for(var X=W.elem(),H=$_.FMAX,Y=G.gverts.begin();null!=Y;){var J=Y.elem(),K=X.gnormx*J.x+X.gnormy*J.y;K<H&&(H=K),Y=Y.next}if(a<(H-=X.gprojection)){Z=H;break}0<H?Z<H&&(Z=H,U=X,q=1):Z<0&&Z<H&&(Z=H,U=X,q=1),W=W.next}if(Z<a){for(var Q=G.edges.begin();null!=Q;){for(var $=Q.elem(),ee=$_.FMAX,te=R.gverts.begin();null!=te;){var ne=te.elem(),ie=$.gnormx*ne.x+$.gnormy*ne.y;ie<ee&&(ee=ie),te=te.next}if(a<(ee-=$.gprojection)){Z=ee;break}0<ee?Z<ee&&(Z=ee,V=$,q=2):Z<0&&Z<ee&&(Z=ee,V=$,q=2),Q=Q.next}if(Z<a){var re,ae;if(1==q)re=G,ae=U;else{re=R,ae=V;var se=n;n=i,i=se,m=!m}for(var le=null,oe=$_.FMAX,_e=re.edges.begin();null!=_e;){var pe=_e.elem(),ue=ae.gnormx*pe.gnormx+ae.gnormy*pe.gnormy;ue<oe&&(oe=ue,le=pe),_e=_e.next}if(r.y=m?(r.x=-ae.gnormx,-ae.gnormy):(r.x=ae.gnormx,ae.gnormy),0<=Z){var he,ce,de,me,fe=ae.gp0,ge=ae.gp1,ve=le.gp0,be=le.gp1,ye=1/((he=ge.x-fe.x)*he+(ce=ge.y-fe.y)*ce),xe=1/((de=be.x-ve.x)*de+(me=be.y-ve.y)*me),ze=-(he*(fe.x-ve.x)+ce*(fe.y-ve.y))*ye,we=-(he*(fe.x-be.x)+ce*(fe.y-be.y))*ye,ke=-(de*(ve.x-fe.x)+me*(ve.y-fe.y))*xe,Se=-(de*(ve.x-ge.x)+me*(ve.y-ge.y))*xe;ze<0?ze=0:1<ze&&(ze=1),we<0?we=0:1<we&&(we=1),ke<0?ke=0:1<ke&&(ke=1),Se<0?Se=0:1<Se&&(Se=1);var Ce,Ne,Pe=ze;Ce=fe.x+he*Pe,Ne=fe.y+ce*Pe;var Me,Ie,Te=we;Me=fe.x+he*Te,Ie=fe.y+ce*Te;var Ae,De,Ee=ke;Ae=ve.x+de*Ee,De=ve.y+me*Ee;var Oe,Be,Le=Se;Oe=ve.x+de*Le,Be=ve.y+me*Le;var je=vu.vec_dsq(Ce,Ne,ve.x,ve.y),Fe=vu.vec_dsq(Me,Ie,be.x,be.y),Re=vu.vec_dsq(Ae,De,fe.x,fe.y),Ge=vu.vec_dsq(Oe,Be,ge.x,ge.y),Ze=0,Ue=0,Ve=null;je<Fe?(Ze=Ce,Ue=Ne,Ve=ve):(Ze=Me,Ue=Ie,Ve=be,je=Fe);var qe=0,We=0,Xe=null;if(Re<Ge?(qe=Ae,We=De,Xe=fe):(qe=Oe,We=Be,Xe=ge,Re=Ge),0!=(Z=je<Re?(n.x=Ze,n.y=Ue,i.x=Ve.x,i.y=Ve.y,Math.sqrt(je)):(i.x=qe,i.y=We,n.x=Xe.x,n.y=Xe.y,Math.sqrt(Re)))){r.x=i.x-n.x,r.y=i.y-n.y;var He=1/Z;r.x*=He,r.y*=He,m&&(r.x=-r.x,r.y=-r.y)}return Z}var Ye=0,Je=0;Ye=le.gp0.x,Je=le.gp0.y;var Ke,Qe,$e=0,et=0;Ke=($e=le.gp1.x)-Ye,Qe=(et=le.gp1.y)-Je;var tt=ae.gnormy*Ye-ae.gnormx*Je,nt=ae.gnormy*$e-ae.gnormx*et,it=1/(nt-tt),rt=(-ae.tp1-tt)*it;co.epsilon<rt&&(Ye+=Ke*rt,Je+=Qe*rt);var at=(-ae.tp0-nt)*it;at<-co.epsilon&&($e+=Ke*at,et+=Qe*at);var st=Ye*ae.gnormx+Je*ae.gnormy-ae.gprojection,lt=$e*ae.gnormx+et*ae.gnormy-ae.gprojection;if(st<lt){i.x=Ye,i.y=Je;var ot=-st;return n.x=i.x+ae.gnormx*ot,n.y=i.y+ae.gnormy*ot,st}i.x=$e,i.y=et;var _t=-lt;return n.x=i.x+ae.gnormx*_t,n.y=i.y+ae.gnormy*_t,lt}return a}return a};var du=function(){this.node=null,this.di=0,this.id=0,this.b=null,this.a=null,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null};(n["zpp_nape.geom.ZPP_PartitionPair"]=du).__name__=["zpp_nape","geom","ZPP_PartitionPair"],du.get=function(e,t){var n;return null==du.zpp_pool?n=new du:(n=du.zpp_pool,du.zpp_pool=n.next,n.next=null),n.alloc(),n.a=e,n.b=t,e.id<t.id?(n.id=e.id,n.di=t.id):(n.id=t.id,n.di=e.id),n},du.edge_swap=function(e,t){var n=e.node;e.node=t.node,t.node=n},du.edge_lt=function(e,t){return!(e.id>=t.id)||e.id==t.id&&e.di<t.di},du.prototype={next:null,elem:function(){return this},begin:function(){return this.next},_inuse:null,modified:null,pushmod:null,length:null,setbegin:function(e){this.next=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){e._inuse=!0;var t=e;return t.next=this.begin(),this.next=t,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){t._inuse=!0;var n=t;return null==e?(n.next=this.begin(),this.next=n):(n.next=e.next,e.next=n),this.pushmod=this.modified=!0,this.length++,n},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.next=e.next,e.elem()._inuse=!1,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;return null==e?(n=(t=this.begin()).next,this.next=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0)),t.elem()._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.next=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},free:function(){this.a=this.b=null,this.node=null},alloc:function(){},a:null,b:null,id:null,di:null,node:null,__class__:du};var mu=function(){};(n["zpp_nape.geom.ZPP_Triangular"]=mu).__name__=["zpp_nape","geom","ZPP_Triangular"],mu.lt=function(e,t){return e.y<t.y||e.y==t.y&&e.x<t.x},mu.right_turn=function(e,t,n){var i,r,a;return i=n.x-t.x,r=n.y-t.y,a=t.x-e.x,(t.y-e.y)*i-a*r},mu.delaunay=function(e,t,n,i){var r=0,a=0,s=0;return r=n.x-t.x,a=n.y-t.y,s=t.x-e.x,!!(0<=(t.y-e.y)*r-s*a||(r=i.x-n.x,a=i.y-n.y,s=n.x-t.x,0<=(n.y-t.y)*r-s*a)||(r=e.x-i.x,a=e.y-i.y,s=i.x-n.x,0<=(i.y-n.y)*r-s*a)||(r=t.x-e.x,a=t.y-e.y,s=e.x-i.x,0<=(e.y-i.y)*r-s*a))||0<t.x*(n.y*i.mag-n.mag*i.y)-n.x*(t.y*i.mag-t.mag*i.y)+i.x*(t.y*n.mag-t.mag*n.y)-(e.x*(n.y*i.mag-n.mag*i.y)-n.x*(e.y*i.mag-e.mag*i.y)+i.x*(e.y*n.mag-e.mag*n.y))+(e.x*(t.y*i.mag-t.mag*i.y)-t.x*(e.y*i.mag-e.mag*i.y)+i.x*(e.y*t.mag-e.mag*t.y))-(e.x*(t.y*n.mag-t.mag*n.y)-t.x*(e.y*n.mag-e.mag*n.y)+n.x*(e.y*t.mag-e.mag*t.y))},mu.optimise=function(e){var t,n=e.vertices,i=e.vertices;if(null!=n)for(var r=n;;){var a=r;if(a.sort(),a.mag=a.x*a.x+a.y*a.y,(r=r.next)==i)break}null==mu.edgeSet&&(null==bc.zpp_pool?mu.edgeSet=new bc:(mu.edgeSet=bc.zpp_pool,bc.zpp_pool=mu.edgeSet.next,mu.edgeSet.next=null),mu.edgeSet.alloc(),mu.edgeSet.lt=du.edge_lt,mu.edgeSet.swapped=du.edge_swap),null==du.zpp_pool?t=new du:(t=du.zpp_pool,du.zpp_pool=t.next,t.next=null),t.alloc();var s=e.vertices,l=e.vertices;if(null!=s)for(var o=s;;){var _=o,p=_.next;_.diagonals.reverse();for(var u=_.diagonals.begin();null!=u;){var h=u.elem();if(h.id<_.id)p=h,u=u.next;else{var c=null==u.next?_.prev:u.next.elem();if(!mu.delaunay(_,p,h,c)){var d=du.get(_,h);t.add(d),d.node=mu.edgeSet.insert(d)}p=h,u=u.next}}if((o=o.next)==l)break}for(;!t.empty();){for(var m=t.pop_unsafe(),f=m.a,g=m.b,v=f.next,b=null,y=f.diagonals.begin();null!=y;){var x=y.elem();if(x==g){b=null==(y=y.next)?f.prev:y.elem();break}v=x,y=y.next}if(f.diagonals.remove(g),g.diagonals.remove(f),g==v.next)v.diagonals.add(b);else for(var z=v.diagonals.begin();null!=z;){if(z.elem()==g){v.diagonals.insert(z,b);break}z=z.next}if(f==b.next)b.diagonals.add(v);else for(var w=b.diagonals.begin();null!=w;){if(w.elem()==f){b.diagonals.insert(w,v);break}w=w.next}mu.edgeSet.remove_node(m.node);var k=m;k.free(),k.next=du.zpp_pool,du.zpp_pool=k}var S=t;S.free(),S.next=du.zpp_pool,du.zpp_pool=S},mu.triangulate=function(e){var t=e.vertices,n=e.vertices,i=e.vertices.next,r=e.vertices;if(null!=i)for(var a=i;;){var s=a;if(mu.lt(s,t)&&(t=s),mu.lt(n,s)&&(n=s),(a=a.next)==r)break}null==mu.queue&&(mu.queue=new Qu);var l=n.prev,o=n.next;for(mu.queue.add(n);l!=t||o!=t;)l==t||o!=t&&mu.lt(l,o)?(mu.queue.add(o),o.rightchain=!1,o=o.next):(mu.queue.add(l),l.rightchain=!0,l=l.prev);mu.queue.add(t),null==mu.stack&&(mu.stack=new Qu),mu.stack.add(mu.queue.pop_unsafe());var _=mu.queue.pop_unsafe();for(mu.stack.add(_);;){var p=mu.queue.pop_unsafe();if(mu.queue.empty())break;if(p.rightchain!=mu.stack.front().rightchain){for(;;){var u=mu.stack.pop_unsafe();if(mu.stack.empty())break;e.add_diagonal(u,p)}mu.stack.add(_)}else{for(var h=mu.stack.pop_unsafe();!mu.stack.empty();){var c=mu.stack.front(),d=mu.right_turn(c,h,p);if(p.rightchain&&0<=d||!p.rightchain&&d<=0)break;e.add_diagonal(c,p),h=c,mu.stack.pop()}mu.stack.add(h)}mu.stack.add(p),_=p}if(!mu.stack.empty())for(mu.stack.pop();!mu.stack.empty();){var m=mu.stack.pop_unsafe();if(mu.stack.empty())break;e.add_diagonal(n,m)}return e};var fu=function(){this.y=0,this.x=0,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.weak=!1,this.outer=null,this._isimmutable=null,this._immutable=!1,this._validate=null,this._invalidate=null};(n["zpp_nape.geom.ZPP_Vec2"]=fu).__name__=["zpp_nape","geom","ZPP_Vec2"],fu.get=function(e,t,n){var i;return null==n&&(n=!1),null==fu.zpp_pool?i=new fu:(i=fu.zpp_pool,fu.zpp_pool=i.next,i.next=null),i.alloc(),i._immutable=n,i.x=e,i.y=t,i},fu.prototype={_invalidate:null,_validate:null,validate:function(){null!=this._validate&&this._validate()},invalidate:function(){null!=this._invalidate&&this._invalidate(this)},_immutable:null,_isimmutable:null,immutable:function(){},outer:null,wrapper:function(){if(null==this.outer){this.outer=new y_;var e=this.outer.zpp_inner;e.free(),e.next=fu.zpp_pool,fu.zpp_pool=e,this.outer.zpp_inner=this}return this.outer},weak:null,free:function(){null!=this.outer&&(this.outer.zpp_inner=null,this.outer=null),this._isimmutable=null,this._validate=null,this._invalidate=null},alloc:function(){this.weak=!1},next:null,elem:function(){return this},begin:function(){return this.next},_inuse:null,modified:null,pushmod:null,length:null,setbegin:function(e){this.next=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){e._inuse=!0;var t=e;return t.next=this.begin(),this.next=t,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){t._inuse=!0;var n=t;return null==e?(n.next=this.begin(),this.next=n):(n.next=e.next,e.next=n),this.pushmod=this.modified=!0,this.length++,n},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.next=e.next,e.elem()._inuse=!1,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;return null==e?(n=(t=this.begin()).next,this.next=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0)),t.elem()._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.next=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},x:null,y:null,copy:function(){return fu.get(this.x,this.y)},toString:function(){return"{ x: "+this.x+" y: "+this.y+" }"},__class__:fu};var gu=function(){this._validate=null,this.immutable=!1,this.z=0,this.y=0,this.x=0,this.outer=null,this.immutable=!1,this._validate=null};(n["zpp_nape.geom.ZPP_Vec3"]=gu).__name__=["zpp_nape","geom","ZPP_Vec3"],gu.prototype={outer:null,x:null,y:null,z:null,immutable:null,_validate:null,validate:function(){null!=this._validate&&this._validate()},__class__:gu};var vu=function(){};(n["zpp_nape.geom.ZPP_VecMath"]=vu).__name__=["zpp_nape","geom","ZPP_VecMath"],vu.vec_dsq=function(e,t,n,i){var r,a;return(r=e-n)*r+(a=t-i)*a},vu.vec_distance=function(e,t,n,i){var r,a;return r=e-n,a=t-i,dc.sqrt(r*r+a*a)};var bu=function(){this.wrap_cbTypes=null,this.cbSet=null,this.cbTypes=null,this.group=null,this.cbsets=null,this.icompound=null,this.ibody=null,this.ishape=null,this.userData=null,this.id=0,this.outer_i=null,this.id=ep.Interactor(),this.cbsets=new Vu,this.cbTypes=new mp};(n["zpp_nape.phys.ZPP_Interactor"]=bu).__name__=["zpp_nape","phys","ZPP_Interactor"],bu.get=function(e,t){for(var n=e.id<t.id?e.id:t.id,i=e.id<t.id?t.id:e.id,r=null,a=(e.cbsets.length<t.cbsets.length?e.cbsets:t.cbsets).begin();null!=a;){var s=a.elem();if(s.id==n&&s.di==i){r=s;break}a=a.next}return r},bu.int_callback=function(e,t,n){var i=e.int1,r=e.int2;t.options1.compatible(i.cbTypes)&&t.options2.compatible(r.cbTypes)?(n.int1=i,n.int2=r):(n.int1=r,n.int2=i)},bu.prototype={outer_i:null,id:null,userData:null,ishape:null,ibody:null,icompound:null,isShape:function(){return null!=this.ishape},isBody:function(){return null!=this.ibody},isCompound:function(){return null!=this.icompound},__iaddedToSpace:function(){null!=this.group&&this.group.addInteractor(this);for(var e=this.cbTypes.begin();null!=e;)e.elem().addInteractor(this),e=e.next;this.alloc_cbSet()},__iremovedFromSpace:function(){null!=this.group&&this.group.remInteractor(this);for(var e=this.cbTypes.begin();null!=e;)e.elem().remInteractor(this),e=e.next;this.dealloc_cbSet()},wake:function(){if(this.isShape()){var e=this.ishape.body;null!=e&&null!=e.space&&e.space.non_inlined_wake(e)}else this.isBody()?null!=this.ibody.space&&this.ibody.space.non_inlined_wake(this.ibody):null!=this.icompound.space&&this.icompound.space.wakeCompound(this.icompound)},cbsets:null,getSpace:function(){return this.isShape()?null==this.ishape.body?null:this.ishape.body.space:this.isBody()?this.ibody.space:this.icompound.space},group:null,cbTypes:null,cbSet:null,wrap_cbTypes:null,setupcbTypes:function(){this.wrap_cbTypes=rc.get(this.cbTypes),this.wrap_cbTypes.zpp_inner.adder=Cc(this,this.wrap_cbTypes_adder),this.wrap_cbTypes.zpp_inner.subber=Cc(this,this.wrap_cbTypes_subber),this.wrap_cbTypes.zpp_inner.dontremove=!0},wrap_cbTypes_subber:function(e){var t=e.zpp_inner;if(this.cbTypes.has(t)){var n=this.getSpace();null!=n&&(this.dealloc_cbSet(),t.remInteractor(this)),this.cbTypes.remove(t),null!=n&&(this.alloc_cbSet(),this.wake())}},wrap_cbTypes_adder:function(e){return this.insert_cbtype(e.zpp_inner),!1},insert_cbtype:function(e){if(!this.cbTypes.has(e)){var t=this.getSpace();null!=t&&(this.dealloc_cbSet(),e.addInteractor(this));for(var n=null,i=this.cbTypes.begin();null!=i;){var r=i.elem();if(pp.setlt(e,r))break;i=(n=i).next}this.cbTypes.inlined_insert(n,e),null!=t&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){var e=this.getSpace();null!=(this.cbSet=e.cbsets.get(this.cbTypes))&&(this.cbSet.increment(),this.cbSet.addInteractor(this),this.cbSet.validate(),e.freshInteractorType(this))},dealloc_cbSet:function(){var e=this.getSpace();if(null!=this.cbSet){if(this.cbSet.remInteractor(this),e.nullInteractorType(this),this.cbSet.decrement()){e.cbsets.remove(this.cbSet);var t=this.cbSet;t.free(),t.next=np.zpp_pool,np.zpp_pool=t}this.cbSet=null}},setGroup:function(e){if(this.group!=e){var t=null!=this.getSpace();t&&null!=this.group&&this.group.remInteractor(this),this.group=e,t&&null!=e&&e.addInteractor(this),t&&(this.isShape()?this.ishape.body.wake():this.isBody()?this.ibody.wake():this.icompound.wake())}},immutable_midstep:function(e){this.isBody()?this.ibody.__immutable_midstep(e):this.isShape()?this.ishape.__immutable_midstep(e):this.icompound.__imutable_midstep(e)},lookup_group:function(){for(var e=this;null!=e&&null==e.group;)e=e.isShape()?e.ishape.body:e.isCompound()?e.icompound.compound:e.ibody.compound;return null==e?null:e.group},copyto:function(e){e.zpp_inner_i.group=this.group;for(var t=this.outer_i.get_cbTypes().iterator();t.hasNext();){var n=t.next();e.get_cbTypes().add(n)}null!=this.userData&&(e.zpp_inner_i.userData=_.copy(this.userData))},__class__:bu};var yu=function(){this.wrap_worldCOM=null,this.wrap_localCOM=null,this.zip_worldCOM=!1,this.worldCOMy=0,this.worldCOMx=0,this.zip_localCOM=!1,this.localCOMy=0,this.localCOMx=0,this.zip_aabb=!1,this.aabb=null,this.norotate=!1,this.sinertia=0,this.iinertia=0,this.cinertia=0,this.zip_inertia=!1,this.inertia=0,this.inertiaMode=0,this.zip_gravMassScale=!1,this.gravMassScale=0,this.gravMassMode=0,this.zip_gravMass=!1,this.gravMass=0,this.nomove=!1,this.cmass=0,this.smass=0,this.imass=0,this.massMode=0,this.zip_mass=!1,this.mass=0,this.zip_axis=!1,this.axisy=0,this.axisx=0,this.rot=0,this.pre_rot=0,this.kinangvel=0,this.torque=0,this.angvel=0,this.wrapcvel=null,this.wrap_svel=null,this.svely=0,this.svelx=0,this.wrap_kinvel=null,this.kinvely=0,this.kinvelx=0,this.wrap_force=null,this.forcey=0,this.forcex=0,this.wrap_vel=null,this.vely=0,this.velx=0,this.wrap_pos=null,this.posy=0,this.posx=0,this.pre_posy=0,this.pre_posx=0,this.disableCCD=!1,this.bulletEnabled=!1,this.bullet=!1,this.sweepRadius=0,this.sweepFrozen=!1,this.sweep_angvel=0,this.sweepTime=0,this.graph_depth=0,this.component=null,this.wrap_constraints=null,this.constraints=null,this.wrap_arbiters=null,this.arbiters=null,this.space=null,this.wrap_shapes=null,this.shapes=null,this.compound=null,this.type=0,this.world=!1,this.outer=null,bu.call(this),(this.ibody=this).world=!1,this.bulletEnabled=!1,this.sweepTime=0,this.sweep_angvel=0,this.norotate=this.nomove=!1,this.disableCCD=!1,this.posx=0,this.posy=0,this.rot=0,this.axisx=0,this.axisy=1,this.svelx=0,this.svely=0,this.velx=0,this.vely=0,this.kinvelx=0,this.kinvely=0,this.forcex=0,this.forcey=0,this.torque=this.angvel=this.kinangvel=0,this.pre_posx=$_.POSINF(),this.pre_posy=$_.POSINF(),this.pre_rot=$_.POSINF(),this.localCOMx=0,this.localCOMy=0,this.worldCOMx=0,this.worldCOMy=0,this.zip_aabb=!0,this.aabb=Lp.get(0,0,0,0),this.aabb._immutable=!0,this.aabb._validate=Cc(this,this.aabb_validate),this.massMode=0,this.gravMassMode=0,this.gravMassScale=1,this.inertiaMode=0,this.arbiters=new Hu,this.constraints=new lp,this.shapes=new qu,this.wrap_shapes=pc.get(this.shapes),this.wrap_shapes.zpp_inner.adder=Cc(this,this.shapes_adder),this.wrap_shapes.zpp_inner.subber=Cc(this,this.shapes_subber),this.wrap_shapes.zpp_inner._invalidate=Cc(this,this.shapes_invalidate),this.kinematicDelaySleep=!1};(n["zpp_nape.phys.ZPP_Body"]=yu).__name__=["zpp_nape","phys","ZPP_Body"],yu.bodysetlt=function(e,t){return e.id<t.id},yu.__static=function(){var e=new C_(M_.get_STATIC()),t=e.zpp_inner;return t.world=!0,t.wrap_shapes.zpp_inner.immutable=!0,t.smass=t.imass=t.cmass=t.mass=t.gravMass=0,t.sinertia=t.iinertia=t.cinertia=t.inertia=0,t.cbTypes.clear(),e},yu.__super__=bu,yu.prototype=r(bu.prototype,{outer:null,world:null,type:null,isStatic:function(){return 1==this.type},isDynamic:function(){return 2==this.type},isKinematic:function(){return 3==this.type},invalidate_type:function(){this.invalidate_mass(),this.invalidate_inertia()},compound:null,shapes:null,wrap_shapes:null,invalidate_shapes:function(){this.invalidate_aabb(),this.invalidate_localCOM(),this.invalidate_mass(),this.invalidate_inertia()},space:null,arbiters:null,wrap_arbiters:null,constraints:null,wrap_constraints:null,component:null,graph_depth:null,init_bodysetlist:function(){null==yu.bodyset&&(yu.bodyset=new fc,yu.bodyset.lt=yu.bodysetlt,yu.bodystack=new Wu)},connectedBodies_cont:function(e){yu.bodyset.try_insert_bool(e.zpp_inner)&&(yu.bodystack.add(e.zpp_inner),e.zpp_inner.graph_depth=yu.cur_graph_depth+1)},connectedBodies:function(e,t){var n=this;this.init_bodysetlist();var i=null==t?new P_:t;for(yu.bodystack.add(this),yu.bodyset.insert(this),this.graph_depth=0;!yu.bodystack.empty();){var r=yu.bodystack.pop_unsafe();if(r.graph_depth!=e){yu.cur_graph_depth=r.graph_depth;for(var a=r.constraints.begin();null!=a;)a.elem().outer.visitBodies(Cc(this,this.connectedBodies_cont)),a=a.next}}return yu.bodyset.clear_with(function(e){e!=n&&i.add(e.outer)}),i},interactingBodies:function(e,t,n){var i=this;this.init_bodysetlist();var r=null==n?new P_:n;for(yu.bodyset.insert(this),yu.bodystack.add(this),this.graph_depth=0;!yu.bodystack.empty();){var a=yu.bodystack.pop_unsafe();if(a.graph_depth!=t)for(var s=a.arbiters.begin();null!=s;){var l=s.elem();if(0!=(l.type&e)){var o=l.b1==a?l.b2:l.b1;yu.bodyset.try_insert_bool(o)&&(yu.bodystack.add(o),o.graph_depth=a.graph_depth+1)}s=s.next}}return yu.bodyset.clear_with(function(e){e!=i&&r.add(e.outer)}),r},atRest:function(e){if(this.isDynamic()){var t,n=co.linearSleepThreshold;if(n*=n,this.velx*this.velx+this.vely*this.vely>n)t=!1;else if(vu.vec_dsq(this.posx,this.posy,this.pre_posx,this.pre_posy)>.25*n*e*e)t=!1;else{var i,r,a=(i=this.aabb.maxx-this.aabb.minx)*i+(r=this.aabb.maxy-this.aabb.miny)*r,s=co.angularSleepThreshold;if(s*=s,4*this.angvel*this.angvel*a>s)t=!1;else{var l=this.rot-this.pre_rot;t=!(s*e*e<l*l*a)}}return t||(this.component.waket=this.space.stamp),this.component.waket+co.sleepDelay<this.space.stamp}return this.component.sleeping},refreshArbiters:function(){for(var e=this.arbiters.begin();null!=e;)e.elem().invalidated=!0,e=e.next},sweepTime:null,sweep_angvel:null,sweepFrozen:null,sweepRadius:null,bullet:null,bulletEnabled:null,disableCCD:null,sweepIntegrate:function(e){var t=e-this.sweepTime;if(0!=t){this.sweepTime=e;var n=t;this.posx+=this.velx*n,this.posy+=this.vely*n,0!=this.angvel&&this.delta_rot(this.sweep_angvel*t)}},sweepValidate:function(e){if(e.isCircle())e.worldCOMx=this.posx+(this.axisy*e.localCOMx-this.axisx*e.localCOMy),e.worldCOMy=this.posy+(e.localCOMx*this.axisx+e.localCOMy*this.axisy);else{for(var t=e.polygon,n=t.lverts.begin(),i=t.gverts.begin();null!=i;){var r=i.elem(),a=n.elem();n=n.next,r.x=this.posx+(this.axisy*a.x-this.axisx*a.y),r.y=this.posy+(a.x*this.axisx+a.y*this.axisy),i=i.next}var s=t.edges.begin(),l=t.gverts.begin(),o=l.elem();for(l=l.next;null!=l;){var _=l.elem(),p=s.elem();s=s.next,p.gnormx=this.axisy*p.lnormx-this.axisx*p.lnormy,p.gnormy=p.lnormx*this.axisx+p.lnormy*this.axisy,p.gprojection=this.posx*p.gnormx+this.posy*p.gnormy+p.lprojection,p.tp0=o.y*p.gnormx-o.x*p.gnormy,p.tp1=_.y*p.gnormx-_.x*p.gnormy,o=_,l=l.next}var u=t.gverts.front(),h=s.elem();s=s.next,h.gnormx=this.axisy*h.lnormx-this.axisx*h.lnormy,h.gnormy=h.lnormx*this.axisx+h.lnormy*this.axisy,h.gprojection=this.posx*h.gnormx+this.posy*h.gnormy+h.lprojection,h.tp0=o.y*h.gnormx-o.x*h.gnormy,h.tp1=u.y*h.gnormx-u.x*h.gnormy}},pre_posx:null,pre_posy:null,posx:null,posy:null,wrap_pos:null,velx:null,vely:null,wrap_vel:null,forcex:null,forcey:null,wrap_force:null,kinvelx:null,kinvely:null,wrap_kinvel:null,svelx:null,svely:null,wrap_svel:null,invalidate_pos:function(){for(var e=this.shapes.begin();null!=e;){var t=e.elem();1==t.type&&(t.polygon.invalidate_gverts(),t.polygon.invalidate_gaxi()),t.invalidate_worldCOM(),e=e.next}this.invalidate_worldCOM()},pos_invalidate:function(e){this.immutable_midstep("Body::position"),this.posx==e.x&&this.posy==e.y||(this.posx=e.x,this.posy=e.y,this.invalidate_pos(),this.wake())},pos_validate:function(){this.wrap_pos.zpp_inner.x=this.posx,this.wrap_pos.zpp_inner.y=this.posy},vel_invalidate:function(e){this.velx=e.x,this.vely=e.y,this.invalidate_wake()},vel_validate:function(){this.wrap_vel.zpp_inner.x=this.velx,this.wrap_vel.zpp_inner.y=this.vely},kinvel_invalidate:function(e){this.kinvelx=e.x,this.kinvely=e.y,this.invalidate_wake()},kinvel_validate:function(){this.wrap_kinvel.zpp_inner.x=this.kinvelx,this.wrap_kinvel.zpp_inner.y=this.kinvely},svel_invalidate:function(e){this.svelx=e.x,this.svely=e.y,this.invalidate_wake()},svel_validate:function(){this.wrap_svel.zpp_inner.x=this.svelx,this.wrap_svel.zpp_inner.y=this.svely},force_invalidate:function(e){this.forcex=e.x,this.forcey=e.y,this.invalidate_wake()},force_validate:function(){this.wrap_force.zpp_inner.x=this.forcex,this.wrap_force.zpp_inner.y=this.forcey},setupPosition:function(){this.wrap_pos=y_.get(this.posx,this.posy),this.wrap_pos.zpp_inner._inuse=!0,this.world?this.wrap_pos.zpp_inner._immutable=!0:(this.wrap_pos.zpp_inner._invalidate=Cc(this,this.pos_invalidate),this.wrap_pos.zpp_inner._validate=Cc(this,this.pos_validate))},setupVelocity:function(){this.wrap_vel=y_.get(this.velx,this.vely),this.wrap_vel.zpp_inner._inuse=!0,this.world?this.wrap_vel.zpp_inner._immutable=!0:(this.wrap_vel.zpp_inner._invalidate=Cc(this,this.vel_invalidate),this.wrap_vel.zpp_inner._validate=Cc(this,this.vel_validate))},setupkinvel:function(){this.wrap_kinvel=y_.get(this.kinvelx,this.kinvely),this.wrap_kinvel.zpp_inner._inuse=!0,this.world?this.wrap_kinvel.zpp_inner._immutable=!0:(this.wrap_kinvel.zpp_inner._invalidate=Cc(this,this.kinvel_invalidate),this.wrap_kinvel.zpp_inner._validate=Cc(this,this.kinvel_validate))},setupsvel:function(){this.wrap_svel=y_.get(this.svelx,this.svely),this.wrap_svel.zpp_inner._inuse=!0,this.world?this.wrap_svel.zpp_inner._immutable=!0:(this.wrap_svel.zpp_inner._invalidate=Cc(this,this.svel_invalidate),this.wrap_svel.zpp_inner._validate=Cc(this,this.svel_validate))},setupForce:function(){this.wrap_force=y_.get(this.forcex,this.forcey),this.wrap_force.zpp_inner._inuse=!0,this.world?this.wrap_force.zpp_inner._immutable=!0:(this.wrap_force.zpp_inner._invalidate=Cc(this,this.force_invalidate),this.wrap_force.zpp_inner._validate=Cc(this,this.force_validate))},cvel_validate:function(){this.wrapcvel.zpp_inner.x=this.velx+this.kinvelx,this.wrapcvel.zpp_inner.y=this.vely+this.kinvely,this.wrapcvel.zpp_inner.z=this.angvel+this.kinangvel},wrapcvel:null,setup_cvel:function(){this.wrapcvel=w_.get(),this.wrapcvel.zpp_inner.immutable=!0,this.wrapcvel.zpp_inner._validate=Cc(this,this.cvel_validate)},angvel:null,torque:null,kinangvel:null,pre_rot:null,rot:null,invalidate_rot:function(){this.zip_axis=!0;for(var e=this.shapes.begin();null!=e;){var t=e.elem();1==t.type&&(t.polygon.invalidate_gverts(),t.polygon.invalidate_gaxi()),t.invalidate_worldCOM(),e=e.next}this.invalidate_worldCOM()},axisx:null,axisy:null,zip_axis:null,validate_axis:function(){this.zip_axis&&(this.zip_axis=!1,this.quick_validate_axis())},quick_validate_axis:function(){this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot)},delta_rot:function(e){if(this.rot+=e,1e-4<e*e)this.quick_validate_axis();else{var t=e*e,n=1-.5*t,i=1-t*t/8,r=(n*this.axisx+e*this.axisy)*i;this.axisy=(n*this.axisy-e*this.axisx)*i,this.axisx=r}},kinematicDelaySleep:null,mass:null,zip_mass:null,massMode:null,imass:null,smass:null,cmass:null,nomove:null,invalidate_mass:function(){this.zip_mass=!0,this.invalidate_gravMass()},validate_mass:function(){if(this.zip_mass||(this.massMode,0)){if(this.zip_mass=!1,0==this.massMode){this.cmass=0;for(var e=this.shapes.begin();null!=e;){var t=e.elem();t.refmaterial.density=t.material.density,t.validate_area_inertia(),this.cmass+=t.area*t.material.density,e=e.next}}this.isDynamic()&&!this.nomove?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=$_.POSINF(),this.imass=this.smass=0)}},gravMass:null,zip_gravMass:null,gravMassMode:null,gravMassScale:null,zip_gravMassScale:null,invalidate_gravMass:function(){1!=this.gravMassMode&&(this.zip_gravMass=!0),2!=this.gravMassMode&&(this.zip_gravMassScale=!0),this.wake()},validate_gravMass:function(){this.zip_gravMass&&(this.zip_gravMass=!1,this.validate_mass(),0==this.gravMassMode?(this.validate_mass(),this.gravMass=this.cmass):2==this.gravMassMode&&(this.validate_mass(),this.gravMass=this.cmass*this.gravMassScale))},invalidate_gravMassScale:function(){2!=this.gravMassMode?this.zip_gravMassScale=!0:this.invalidate_gravMass()},validate_gravMassScale:function(){this.zip_gravMassScale&&(this.zip_gravMassScale=!1,0==this.gravMassMode?this.gravMassScale=1:1==this.gravMassMode&&(this.validate_mass(),this.gravMassScale=this.gravMass/this.cmass))},inertiaMode:null,inertia:null,zip_inertia:null,cinertia:null,iinertia:null,sinertia:null,norotate:null,invalidate_inertia:function(){this.zip_inertia=!0,this.wake()},validate_inertia:function(){if(this.zip_inertia||(this.inertiaMode,0)){if(this.zip_inertia=!1,0==this.inertiaMode){this.cinertia=0;for(var e=this.shapes.begin();null!=e;){var t=e.elem();t.refmaterial.density=t.material.density,t.validate_area_inertia(),this.cinertia+=t.inertia*t.area*t.material.density,e=e.next}}this.isDynamic()&&!this.norotate?(this.inertia=this.cinertia,this.sinertia=this.iinertia=1/this.inertia):(this.inertia=$_.POSINF(),this.sinertia=this.iinertia=0)}},invalidate_wake:function(){this.wake()},aabb:null,zip_aabb:null,validate_aabb:function(){if(this.zip_aabb){this.zip_aabb=!1,this.aabb.minx=$_.POSINF(),this.aabb.miny=$_.POSINF(),this.aabb.maxx=$_.NEGINF(),this.aabb.maxy=$_.NEGINF();for(var e=this.shapes.begin();null!=e;){var t=e.elem();t.validate_aabb(),this.aabb.combine(t.aabb),e=e.next}}},invalidate_aabb:function(){this.zip_aabb=!0},localCOMx:null,localCOMy:null,zip_localCOM:null,worldCOMx:null,worldCOMy:null,zip_worldCOM:null,wrap_localCOM:null,wrap_worldCOM:null,invalidate_localCOM:function(){this.zip_localCOM=!0,this.invalidate_worldCOM()},invalidate_worldCOM:function(){this.zip_worldCOM=!0},validate_localCOM:function(){if(this.zip_localCOM){this.zip_localCOM=!1;for(var e=0,t=0,n=0,i=this.shapes.begin();null!=i;){var r=i.elem();r.validate_localCOM(),r.validate_area_inertia();var a=r.area*r.material.density;e+=r.localCOMx*a,t+=r.localCOMy*a,n+=r.area*r.material.density,i=i.next}if(0!=n){var s=1/n;this.localCOMx=e*s,this.localCOMy=t*s}null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy),this.zip_mass&&0==this.massMode&&(this.zip_mass=!1,this.cmass=n,this.isDynamic()?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=$_.POSINF(),this.imass=this.smass=0))}},validate_worldCOM:function(){this.zip_worldCOM&&(this.zip_worldCOM=!1,this.validate_localCOM(),this.validate_axis(),this.worldCOMx=this.posx+(this.axisy*this.localCOMx-this.axisx*this.localCOMy),this.worldCOMy=this.posy+(this.localCOMx*this.axisx+this.localCOMy*this.axisy),null!=this.wrap_worldCOM&&(this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy))},getlocalCOM:function(){this.validate_localCOM()},getworldCOM:function(){this.validate_worldCOM()},__immutable_midstep:function(e){},clear:function(){for(;!this.shapes.empty();){var e=this.shapes.pop_unsafe();e.removedFromBody(),e.body=null}this.invalidate_shapes(),this.pre_posx=0,this.pre_posy=0,this.posx=0,this.posy=0,this.velx=0,this.vely=0,this.forcex=0,this.forcey=0,this.kinvelx=0,this.kinvely=0,this.svelx=0,this.svely=0,this.angvel=this.torque=this.kinangvel=this.pre_rot=this.rot=0,this.invalidate_pos(),this.invalidate_rot(),this.axisx=0,this.axisy=1,this.zip_axis=!1,this.massMode=0,this.gravMassMode=0,this.gravMassScale=1,this.inertiaMode=0,this.norotate=!1,this.nomove=!1},aabb_validate:function(){this.validate_aabb()},shapes_adder:function(e){return e.zpp_inner.body!=this&&(null!=e.zpp_inner.body&&e.zpp_inner.body.wrap_shapes.remove(e),e.zpp_inner.body=this,e.zpp_inner.addedToBody(),null!=this.space&&this.space.added_shape(e.zpp_inner),e.zpp_inner.isPolygon()&&(e.zpp_inner.polygon.invalidate_gaxi(),e.zpp_inner.polygon.invalidate_gverts()),!0)},shapes_subber:function(e){null!=this.space&&this.space.removed_shape(e.zpp_inner),e.zpp_inner.body=null,e.zpp_inner.removedFromBody()},shapes_invalidate:function(e){this.invalidate_shapes()},addedToSpace:function(){null==Du.zpp_pool?this.component=new Du:(this.component=Du.zpp_pool,Du.zpp_pool=this.component.next,this.component.next=null),this.component.alloc(),this.component.isBody=!0,(this.component.body=this).__iaddedToSpace()},removedFromSpace:function(){for(;!this.arbiters.empty();)this.arbiters.pop_unsafe().lazyRetire(this.space,this);var e=this.component;e.free(),e.next=Du.zpp_pool,Du.zpp_pool=e,this.component=null,this.__iremovedFromSpace()},copy:function(){var e=(new C_).zpp_inner;e.type=this.type,e.bulletEnabled=this.bulletEnabled,e.disableCCD=this.disableCCD;for(var t=this.shapes.begin();null!=t;){var n=t.elem();e.outer.get_shapes().add(n.outer.copy()),t=t.next}return e.posx=this.posx,e.posy=this.posy,e.velx=this.velx,e.vely=this.vely,e.forcex=this.forcex,e.forcey=this.forcey,e.rot=this.rot,e.angvel=this.angvel,e.torque=this.torque,e.kinvelx=this.kinvelx,e.kinvely=this.kinvely,e.kinangvel=this.kinangvel,e.svelx=this.svelx,e.svely=this.svely,this.zip_axis?e.invalidate_rot():(e.axisx=this.axisx,e.axisy=this.axisy),e.rot=this.rot,e.massMode=this.massMode,e.gravMassMode=this.gravMassMode,e.inertiaMode=this.inertiaMode,e.norotate=this.norotate,e.nomove=this.nomove,e.cmass=this.cmass,e.cinertia=this.cinertia,this.zip_mass?e.invalidate_mass():e.mass=this.mass,this.zip_gravMass?e.invalidate_gravMass():e.gravMass=this.gravMass,this.zip_gravMassScale?e.invalidate_gravMassScale():e.gravMassScale=this.gravMassScale,this.zip_inertia?e.invalidate_inertia():e.inertia=this.inertia,this.zip_aabb?e.invalidate_aabb():(e.aabb.minx=this.aabb.minx,e.aabb.miny=this.aabb.miny,e.aabb.maxx=this.aabb.maxx,e.aabb.maxy=this.aabb.maxy),this.zip_localCOM?e.invalidate_localCOM():(e.localCOMx=this.localCOMx,e.localCOMy=this.localCOMy),this.zip_worldCOM?e.invalidate_worldCOM():(e.worldCOMx=this.worldCOMx,e.worldCOMy=this.worldCOMy),this.copyto(e.outer),e.outer},__class__:yu});var xu=function(){this.space=null,this.compound=null,this.depth=0,this.wrap_compounds=null,this.wrap_constraints=null,this.wrap_bodies=null,this.compounds=null,this.constraints=null,this.bodies=null,this.outer=null,bu.call(this),(this.icompound=this).depth=1,this.bodies=new Wu,this.wrap_bodies=ec.get(this.bodies),this.wrap_bodies.zpp_inner.adder=Cc(this,this.bodies_adder),this.wrap_bodies.zpp_inner.subber=Cc(this,this.bodies_subber),this.constraints=new lp,this.wrap_constraints=$h.get(this.constraints),this.wrap_constraints.zpp_inner.adder=Cc(this,this.constraints_adder),this.wrap_constraints.zpp_inner.subber=Cc(this,this.constraints_subber),this.compounds=new Xu,this.wrap_compounds=nc.get(this.compounds),this.wrap_compounds.zpp_inner.adder=Cc(this,this.compounds_adder),this.wrap_compounds.zpp_inner.subber=Cc(this,this.compounds_subber)};(n["zpp_nape.phys.ZPP_Compound"]=xu).__name__=["zpp_nape","phys","ZPP_Compound"],xu.__super__=bu,xu.prototype=r(bu.prototype,{outer:null,bodies:null,constraints:null,compounds:null,wrap_bodies:null,wrap_constraints:null,wrap_compounds:null,depth:null,compound:null,space:null,__imutable_midstep:function(e){},addedToSpace:function(){this.__iaddedToSpace()},removedFromSpace:function(){this.__iremovedFromSpace()},breakApart:function(){for(null!=this.space&&(this.__iremovedFromSpace(),this.space.nullInteractorType(this)),null!=this.compound?this.compound.compounds.remove(this):null!=this.space&&this.space.compounds.remove(this);!this.bodies.empty();){var e=this.bodies.pop_unsafe();null!=(e.compound=this.compound)?this.compound.bodies.add(e):null!=this.space&&this.space.bodies.add(e),null!=this.space&&this.space.freshInteractorType(e)}for(;!this.constraints.empty();){var t=this.constraints.pop_unsafe();null!=(t.compound=this.compound)?this.compound.constraints.add(t):null!=this.space&&this.space.constraints.add(t)}for(;!this.compounds.empty();){var n=this.compounds.pop_unsafe();null!=(n.compound=this.compound)?this.compound.compounds.add(n):null!=this.space&&this.space.compounds.add(n),null!=this.space&&this.space.freshInteractorType(n)}this.compound=null,this.space=null},bodies_adder:function(e){return e.zpp_inner.compound!=this&&(null!=e.zpp_inner.compound?e.zpp_inner.compound.wrap_bodies.remove(e):null!=e.zpp_inner.space&&e.zpp_inner.space.wrap_bodies.remove(e),null!=(e.zpp_inner.compound=this).space&&this.space.addBody(e.zpp_inner),!0)},bodies_subber:function(e){(e.zpp_inner.compound=null)!=this.space&&this.space.remBody(e.zpp_inner)},constraints_adder:function(e){return e.zpp_inner.compound!=this&&(null!=e.zpp_inner.compound?e.zpp_inner.compound.wrap_constraints.remove(e):null!=e.zpp_inner.space&&e.zpp_inner.space.wrap_constraints.remove(e),null!=(e.zpp_inner.compound=this).space&&this.space.addConstraint(e.zpp_inner),!0)},constraints_subber:function(e){(e.zpp_inner.compound=null)!=this.space&&this.space.remConstraint(e.zpp_inner)},compounds_adder:function(e){return e.zpp_inner.compound!=this&&(null!=e.zpp_inner.compound?e.zpp_inner.compound.wrap_compounds.remove(e):null!=e.zpp_inner.space&&e.zpp_inner.space.wrap_compounds.remove(e),e.zpp_inner.compound=this,e.zpp_inner.depth=this.depth+1,null!=this.space&&this.space.addCompound(e.zpp_inner),!0)},compounds_subber:function(e){e.zpp_inner.compound=null,e.zpp_inner.depth=1,null!=this.space&&this.space.remCompound(e.zpp_inner)},copy:function(e,t){var n=null==e;null==e&&(e=[]),null==t&&(t=[]);for(var i=new I_,r=this.compounds.begin();null!=r;)r.elem().copy(e,t).set_compound(i),r=r.next;for(var a=this.bodies.begin();null!=a;){var s=a.elem(),l=s.outer.copy();e.push(yp.dict(s.id,l)),l.set_compound(i),a=a.next}for(var o=this.constraints.begin();null!=o;)o.elem().copy(e,t).set_compound(i),o=o.next;if(n)for(;0<t.length;)for(var _=t.pop(),p=0;p<e.length;){var u=e[p];if(++p,u.id==_.id){_.cb(u.bc);break}}return this.copyto(i),i},__class__:xu});var zu=function(){this.wrap_gravity=null,this.gravityy=0,this.gravityx=0,this.density=0,this.viscosity=0,this.wrap_shapes=null,this.shapes=null,this.outer=null,this.userData=null,this.next=null,this.feature_cons(),this.density=this.viscosity=1,this.wrap_gravity=null,this.gravityx=0,this.gravityy=0};(n["zpp_nape.phys.ZPP_FluidProperties"]=zu).__name__=["zpp_nape","phys","ZPP_FluidProperties"],zu.prototype={next:null,userData:null,outer:null,wrapper:function(){if(null==this.outer){this.outer=new D_;var e=this.outer.zpp_inner;e.free(),e.next=zu.zpp_pool,zu.zpp_pool=e,this.outer.zpp_inner=this}return this.outer},free:function(){this.outer=null},alloc:function(){},shapes:null,wrap_shapes:null,feature_cons:function(){this.shapes=new qu},addShape:function(e){this.shapes.add(e)},remShape:function(e){this.shapes.remove(e)},copy:function(){var e;return null==zu.zpp_pool?e=new zu:(e=zu.zpp_pool,zu.zpp_pool=e.next,e.next=null),e.alloc(),e.viscosity=this.viscosity,e.density=this.density,e},viscosity:null,density:null,gravityx:null,gravityy:null,wrap_gravity:null,gravity_invalidate:function(e){this.gravityx=e.x,this.gravityy=e.y,this.invalidate()},gravity_validate:function(){this.wrap_gravity.zpp_inner.x=this.gravityx,this.wrap_gravity.zpp_inner.y=this.gravityy},getgravity:function(){this.wrap_gravity=y_.get(this.gravityx,this.gravityy),this.wrap_gravity.zpp_inner._inuse=!0,this.wrap_gravity.zpp_inner._invalidate=Cc(this,this.gravity_invalidate),this.wrap_gravity.zpp_inner._validate=Cc(this,this.gravity_validate)},invalidate:function(){for(var e=this.shapes.begin();null!=e;)e.elem().invalidate_fluidprops(),e=e.next},__class__:zu};var wu=function(e){this.zip_aabb=!1,this.aabb=null,this.pairs=null,this.node=null,this.sweep=null,this.sensorEnabled=!1,this.fluidEnabled=!1,this.fluidProperties=null,this.filter=null,this.material=null,this.refmaterial=null,this.polygon=null,this.circle=null,this.sweepCoef=0,this.zip_sweepRadius=!1,this.sweepRadius=0,this.wrap_worldCOM=null,this.wrap_localCOM=null,this.zip_worldCOM=!1,this.worldCOMy=0,this.worldCOMx=0,this.zip_localCOM=!1,this.localCOMy=0,this.localCOMx=0,this.zip_angDrag=!1,this.angDrag=0,this.inertia=0,this.zip_area_inertia=!1,this.area=0,this.type=0,this.body=null,this.outer=null,bu.call(this),this.pairs=new rh,(this.ishape=this).type=e,this.aabb=Lp.get(0,0,0,0),this.aabb._immutable=!0,this.aabb._validate=Cc(this,this.aabb_validate),this.zip_area_inertia=this.zip_angDrag=this.zip_localCOM=this.zip_sweepRadius=!0,this.localCOMx=0,this.localCOMy=0,this.worldCOMx=0,this.worldCOMy=0,this.fluidEnabled=!1,this.sensorEnabled=!1,this.fluidProperties=null,this.body=null,this.refmaterial=new tr,this.sweepRadius=this.sweepCoef=0};(n["zpp_nape.shape.ZPP_Shape"]=wu).__name__=["zpp_nape","shape","ZPP_Shape"],wu.__super__=bu,wu.prototype=r(bu.prototype,{outer:null,body:null,type:null,isCircle:function(){return 0==this.type},isPolygon:function(){return 1==this.type},area:null,zip_area_inertia:null,inertia:null,angDrag:null,zip_angDrag:null,localCOMx:null,localCOMy:null,zip_localCOM:null,worldCOMx:null,worldCOMy:null,zip_worldCOM:null,wrap_localCOM:null,wrap_worldCOM:null,sweepRadius:null,zip_sweepRadius:null,sweepCoef:null,invalidate_sweepRadius:function(){this.zip_sweepRadius=!0},validate_sweepRadius:function(){this.zip_sweepRadius&&(this.zip_sweepRadius=!1,this.isCircle()?this.circle.__validate_sweepRadius():this.polygon.__validate_sweepRadius())},circle:null,polygon:null,refmaterial:null,material:null,filter:null,fluidProperties:null,fluidEnabled:null,sensorEnabled:null,sweep:null,node:null,pairs:null,clear:function(){this.isCircle()?this.circle.__clear():this.polygon.__clear()},aabb:null,zip_aabb:null,validate_aabb:function(){this.zip_aabb&&null!=this.body&&(this.zip_aabb=!1,this.isCircle()?this.circle.__validate_aabb():this.polygon.__validate_aabb())},force_validate_aabb:function(){this.isCircle()?this.circle._force_validate_aabb():this.polygon._force_validate_aabb()},invalidate_aabb:function(){this.zip_aabb=!0,null!=this.body&&this.body.invalidate_aabb()},validate_area_inertia:function(){this.zip_area_inertia&&(this.zip_area_inertia=!1,this.isCircle()?this.circle.__validate_area_inertia():this.polygon.__validate_area_inertia())},validate_angDrag:function(){(this.zip_angDrag||this.refmaterial.dynamicFriction!=this.material.dynamicFriction)&&(this.zip_angDrag=!1,this.refmaterial.dynamicFriction=this.material.dynamicFriction,this.isCircle()?this.circle.__validate_angDrag():this.polygon.__validate_angDrag())},validate_localCOM:function(){this.zip_localCOM&&(this.zip_localCOM=!1,this.isPolygon()&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy))},validate_worldCOM:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.validate_localCOM(),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy))},getworldCOM:function(){this.validate_worldCOM(),this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy},invalidate_area_inertia:function(){this.zip_area_inertia=!0,null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia())},invalidate_angDrag:function(){this.zip_angDrag=!0},invalidate_localCOM:function(){this.zip_localCOM=!0,this.invalidate_area_inertia(),this.isCircle()&&this.invalidate_sweepRadius(),this.invalidate_angDrag(),this.invalidate_worldCOM(),null!=this.body&&this.body.invalidate_localCOM()},invalidate_worldCOM:function(){this.zip_worldCOM=!0,this.invalidate_aabb()},invalidate_material:function(e){0!=(e&tr.WAKE)&&this.wake(),0!=(e&tr.ARBITERS)&&null!=this.body&&this.body.refreshArbiters(),0!=(e&tr.PROPS)&&null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia()),0!=(e&tr.ANGDRAG)&&this.invalidate_angDrag(),this.refmaterial.set(this.material)},invalidate_filter:function(){this.wake()},invalidate_fluidprops:function(){this.fluidEnabled&&this.wake()},aabb_validate:function(){this.validate_aabb()},setMaterial:function(e){this.material!=e&&(null!=this.body&&null!=this.body.space&&null!=this.material&&this.material.remShape(this),this.material=e,null!=this.body&&null!=this.body.space&&e.addShape(this),this.wake(),null!=this.body&&this.body.refreshArbiters())},setFilter:function(e){this.filter!=e&&(null!=this.body&&null!=this.body.space&&null!=this.filter&&this.filter.remShape(this),this.filter=e,null!=this.body&&null!=this.body.space&&e.addShape(this),this.wake())},setFluid:function(e){this.fluidProperties!=e&&(null!=this.body&&null!=this.body.space&&null!=this.fluidProperties&&this.fluidProperties.remShape(this),this.fluidProperties=e,null!=this.body&&null!=this.body.space&&e.addShape(this),this.fluidEnabled&&this.wake())},__immutable_midstep:function(e){},addedToBody:function(){this.invalidate_worldCOM(),this.invalidate_aabb()},removedFromBody:function(){},addedToSpace:function(){this.__iaddedToSpace(),this.material.addShape(this),this.filter.addShape(this),null!=this.fluidProperties&&this.fluidProperties.addShape(this)},removedFromSpace:function(){this.__iremovedFromSpace(),this.material.remShape(this),this.filter.remShape(this),null!=this.fluidProperties&&this.fluidProperties.remShape(this)},copy:function(){var e=null;e=this.isCircle()?this.circle.__copy():this.polygon.__copy(),this.zip_area_inertia?e.invalidate_area_inertia():(e.area=this.area,e.inertia=this.inertia),this.zip_sweepRadius?e.invalidate_sweepRadius():(e.sweepRadius=this.sweepRadius,e.sweepCoef=this.sweepCoef),this.zip_angDrag?e.invalidate_angDrag():e.angDrag=this.angDrag,this.zip_aabb?e.invalidate_aabb():(e.aabb.minx=this.aabb.minx,e.aabb.miny=this.aabb.miny,e.aabb.maxx=this.aabb.maxx,e.aabb.maxy=this.aabb.maxy);var t=e.material;t.free(),t.next=tr.zpp_pool,tr.zpp_pool=t;var n=e.filter;return n.free(),n.next=ki.zpp_pool,ki.zpp_pool=n,e.material=this.material,e.filter=this.filter,null!=this.fluidProperties&&(e.fluidProperties=this.fluidProperties),e.fluidEnabled=this.fluidEnabled,e.sensorEnabled=this.sensorEnabled,null!=this.userData&&(e.userData=_.copy(this.userData)),this.copyto(e.outer),e.outer},__class__:wu});var ku=function(){this.radius=0,this.outer_zn=null,wu.call(this,0),(this.circle=this).zip_localCOM=!1};(n["zpp_nape.shape.ZPP_Circle"]=ku).__name__=["zpp_nape","shape","ZPP_Circle"],ku.__super__=wu,ku.prototype=r(wu.prototype,{outer_zn:null,radius:null,__clear:function(){},invalidate_radius:function(){this.invalidate_area_inertia(),this.invalidate_angDrag(),this.invalidate_aabb(),null!=this.body&&this.body.wake()},localCOM_validate:function(){this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy},localCOM_invalidate:function(e){this.localCOMx=e.x,this.localCOMy=e.y,this.invalidate_localCOM(),null!=this.body&&this.body.wake()},setupLocalCOM:function(){this.wrap_localCOM=y_.get(this.localCOMx,this.localCOMy),this.wrap_localCOM.zpp_inner._inuse=!0,this.wrap_localCOM.zpp_inner._validate=Cc(this,this.localCOM_validate),this.wrap_localCOM.zpp_inner._invalidate=Cc(this,this.localCOM_invalidate)},__validate_aabb:function(){this.validate_worldCOM();var e=this.radius,t=this.radius;this.aabb.minx=this.worldCOMx-e,this.aabb.miny=this.worldCOMy-t,this.aabb.maxx=this.worldCOMx+e,this.aabb.maxy=this.worldCOMy+t},_force_validate_aabb:function(){this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy),this.aabb.minx=this.worldCOMx-this.radius,this.aabb.miny=this.worldCOMy-this.radius,this.aabb.maxx=this.worldCOMx+this.radius,this.aabb.maxy=this.worldCOMy+this.radius},__validate_sweepRadius:function(){this.sweepCoef=Math.sqrt(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy),this.sweepRadius=this.sweepCoef+this.radius},__validate_area_inertia:function(){var e=this.radius*this.radius;this.area=e*Math.PI,this.inertia=.5*e+(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy)},__validate_angDrag:function(){var e=this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy,t=this.radius*this.radius,n=this.material.dynamicFriction*co.fluidAngularDragFriction;this.angDrag=(e+2*t)*n+.5*co.fluidAngularDrag*(1+co.fluidVacuumDrag)*e,this.angDrag/=2*(e+.5*t)},__scale:function(e,t){var n=((e<0?-e:e)+(t<0?-t:t))/2;this.radius*=n<0?-n:n,this.invalidate_radius(),0<this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy&&(this.localCOMx*=e,this.localCOMy*=t,this.invalidate_localCOM())},__translate:function(e,t){this.localCOMx+=1*e,this.localCOMy+=1*t,this.invalidate_localCOM()},__rotate:function(e,t){var n,i;0<this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy&&(n=t*this.localCOMx-e*this.localCOMy,i=this.localCOMx*e+this.localCOMy*t,this.localCOMx=n,this.localCOMy=i,this.invalidate_localCOM())},__transform:function(e){var t=e.get_a()*e.get_d()-e.get_b()*e.get_c();t<0&&(t=-t),this.radius*=Math.sqrt(t);var n=e.get_a()*this.localCOMx+e.get_b()*this.localCOMy+e.get_tx();this.localCOMy=e.get_c()*this.localCOMx+e.get_d()*this.localCOMy+e.get_ty(),this.localCOMx=n,this.invalidate_radius(),this.invalidate_localCOM()},__copy:function(){var e=new R_(this.radius).zpp_inner_zn;return e.localCOMx=this.localCOMx,e.localCOMy=this.localCOMy,e.zip_localCOM=!1,e},__class__:ku});var Su=function(){this.tp1=0,this.tp0=0,this.gp1=null,this.lp1=null,this.gp0=null,this.lp0=null,this.gprojection=0,this.lprojection=0,this.length=0,this.wrap_gnorm=null,this.gnormy=0,this.gnormx=0,this.wrap_lnorm=null,this.lnormy=0,this.lnormx=0,this.outer=null,this.polygon=null,this.next=null,this.lnormx=0,this.lnormy=0,this.gnormx=0,this.gnormy=0,this.length=0,this.lprojection=0,this.gprojection=0};(n["zpp_nape.shape.ZPP_Edge"]=Su).__name__=["zpp_nape","shape","ZPP_Edge"],Su.prototype={next:null,free:function(){this.polygon=null},alloc:function(){},polygon:null,outer:null,wrapper:function(){return null==this.outer&&(Su.internal=!0,this.outer=new G_,Su.internal=!1,this.outer.zpp_inner=this),this.outer},lnormx:null,lnormy:null,wrap_lnorm:null,gnormx:null,gnormy:null,wrap_gnorm:null,length:null,lprojection:null,gprojection:null,lp0:null,gp0:null,lp1:null,gp1:null,tp0:null,tp1:null,lnorm_validate:function(){this.polygon.validate_laxi(),this.wrap_lnorm.zpp_inner.x=this.lnormx,this.wrap_lnorm.zpp_inner.y=this.lnormy},gnorm_validate:function(){this.polygon.validate_gaxi(),this.wrap_gnorm.zpp_inner.x=this.gnormx,this.wrap_gnorm.zpp_inner.y=this.gnormy},getlnorm:function(){this.wrap_lnorm=y_.get(this.lnormx,this.lnormy),this.wrap_lnorm.zpp_inner._immutable=!0,this.wrap_lnorm.zpp_inner._validate=Cc(this,this.lnorm_validate)},getgnorm:function(){this.wrap_gnorm=y_.get(this.gnormx,this.gnormy),this.wrap_gnorm.zpp_inner._immutable=!0,this.wrap_gnorm.zpp_inner._validate=Cc(this,this.gnorm_validate)},__class__:Su};var Cu=function(){this.zip_sanitation=!1,this.zip_valid=!1,this.zip_gaxi=!1,this.zip_gverts=!1,this.zip_laxi=!1,this.zip_lverts=!1,this.reverse_flag=!1,this.edgeCnt=0,this.wrap_edges=null,this.edges=null,this.wrap_gverts=null,this.gverts=null,this.wrap_lverts=null,this.lverts=null,this.outer_zn=null,wu.call(this,1),(this.polygon=this).lverts=new fu,this.gverts=new fu,this.edges=new ah,this.edgeCnt=0};(n["zpp_nape.shape.ZPP_Polygon"]=Cu).__name__=["zpp_nape","shape","ZPP_Polygon"],Cu.__super__=wu,Cu.prototype=r(wu.prototype,{outer_zn:null,lverts:null,wrap_lverts:null,gverts:null,wrap_gverts:null,edges:null,wrap_edges:null,edgeCnt:null,reverse_flag:null,__clear:function(){},lverts_pa_invalidate:function(e){this.invalidate_lverts()},gverts_pa_validate:function(){this.validate_gverts()},lverts_post_adder:function(e){e.zpp_inner._invalidate=Cc(this,this.lverts_pa_invalidate);for(var t=null,n=null,i=this.lverts.begin();null!=i&&i.elem()!=e.zpp_inner;)t=null==t?this.gverts.begin():t.next,n=null==n?this.edges.begin():n.next,i=i.next;var r,a,s,l=fu.get(0,0,!0);this.gverts.insert(t,l),null!=this.lverts.begin().next&&(null==this.lverts.begin().next.next?(null==Su.zpp_pool?r=new Su:(r=Su.zpp_pool,Su.zpp_pool=r.next,r.next=null),r.alloc(),(r.polygon=this).edges.add(r),null==Su.zpp_pool?a=new Su:(a=Su.zpp_pool,Su.zpp_pool=a.next,a.next=null),a.alloc(),(a.polygon=this).edges.add(a),this.edgeCnt+=2):(null==Su.zpp_pool?s=new Su:(s=Su.zpp_pool,Su.zpp_pool=s.next,s.next=null),s.alloc(),(s.polygon=this).edges.insert(n,s),this.edgeCnt++)),l._validate=Cc(this,this.gverts_pa_validate)},lverts_subber:function(e){this.cleanup_lvert(e.zpp_inner)},lverts_invalidate:function(e){this.invalidate_lverts()},lverts_validate:function(){this.validate_lverts()},gverts_validate:function(){this.validate_gverts()},edges_validate:function(){this.validate_lverts()},getlverts:function(){this.wrap_lverts=Qh.get(this.lverts),this.wrap_lverts.zpp_inner.post_adder=Cc(this,this.lverts_post_adder),this.wrap_lverts.zpp_inner.subber=Cc(this,this.lverts_subber),this.wrap_lverts.zpp_inner._invalidate=Cc(this,this.lverts_invalidate),this.wrap_lverts.zpp_inner._validate=Cc(this,this.lverts_validate),this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag},getgverts:function(){this.wrap_gverts=Qh.get(this.gverts,!0),this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag,this.wrap_gverts.zpp_inner._validate=Cc(this,this.gverts_validate)},getedges:function(){this.wrap_edges=_c.get(this.edges,!0),this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag,this.wrap_edges.zpp_inner._validate=Cc(this,this.edges_validate)},zip_lverts:null,invalidate_lverts:function(){this.invalidate_laxi(),this.invalidate_area_inertia(),this.invalidate_angDrag(),this.invalidate_localCOM(),this.invalidate_gverts(),this.zip_lverts=!0,this.zip_valid=!0,this.zip_sanitation=!0,null!=this.body&&this.body.wake()},zip_laxi:null,invalidate_laxi:function(){this.invalidate_gaxi(),this.invalidate_sweepRadius(),this.zip_laxi=!0},zip_gverts:null,invalidate_gverts:function(){this.invalidate_aabb(),this.zip_gverts=!0},zip_gaxi:null,invalidate_gaxi:function(){this.zip_gaxi=!0},zip_valid:null,validation:null,valid:function(){if(this.zip_valid){if(this.zip_valid=!1,this.splice_collinear(),this.lverts.size()<3)return this.validation=H_.get_DEGENERATE();if(this.validate_lverts(),this.validate_area_inertia(),this.area<co.epsilon)return this.validation=H_.get_DEGENERATE();var e=!1,t=!1,n=!0,i=this.lverts.begin(),r=i.elem(),a=(i=i.next).elem();for(i=i.next;null!=i;){var s,l,o,_=i.elem();s=_.x-a.x,l=_.y-a.y,o=a.x-r.x;var p=(a.y-r.y)*s-o*l;if(co.epsilon<p?t=!0:p<-co.epsilon&&(e=!0),t&&e){n=!1;break}r=a,a=_,i=i.next}if(n){for(var u=(i=this.lverts.begin()).elem();;){var h,c,d;h=u.x-a.x,c=u.y-a.y,d=a.x-r.x;var m=(a.y-r.y)*h-d*c;if(co.epsilon<m?t=!0:m<-co.epsilon&&(e=!0),t&&e){n=!1;break}break}if(n){r=a,a=u;for(var f=(i=i.next).elem();;){var g,v,b;g=f.x-a.x,v=f.y-a.y,b=a.x-r.x;var y=(a.y-r.y)*g-b*v;if(co.epsilon<y?t=!0:y<-co.epsilon&&(e=!0),t&&e)break;break}}}if(t&&e)return this.validation=H_.get_CONCAVE();var x=!0,z=!0,w=this.lverts.begin(),k=w.elem();for(w=w.next;null!=w;){var S=w.elem();if(!x){z=!1;break}var C=!0,N=this.lverts.begin(),P=N.elem();for(N=N.next;null!=N;){var M=N.elem();if(k!=P&&k!=M&&S!=P&&S!=M){var I,T,A,D;I=k.x-P.x,T=k.y-P.y,A=S.x-k.x;var E,O,B=(D=S.y-k.y)*(E=M.x-P.x)-A*(O=M.y-P.y);if(co.epsilon<B*B){var L=(O*I-E*T)*(B=1/B);if(co.epsilon<L&&L<1-co.epsilon){var j=(D*I-A*T)*B;if(co.epsilon<j&&j<1-co.epsilon){C=x=!1;break}}}P=M,N=N.next}else P=M,N=N.next}if(C)for(;;){var F,R,G,Z,U=this.lverts.front();if(k==P||k==U||S==P||S==U)break;F=k.x-P.x,R=k.y-P.y,G=S.x-k.x;var V,q,W=(Z=S.y-k.y)*(V=U.x-P.x)-G*(q=U.y-P.y);if(co.epsilon<W*W){var X=(q*F-V*R)*(W=1/W);if(co.epsilon<X&&X<1-co.epsilon){var H=(Z*F-G*R)*W;if(co.epsilon<H&&H<1-co.epsilon){x=!1;break}}}break}k=S,w=w.next}if(z)for(;;){var Y=this.lverts.front();if(!x)break;var J=!0,K=this.lverts.begin(),Q=K.elem();for(K=K.next;null!=K;){var $=K.elem();if(k!=Q&&k!=$&&Y!=Q&&Y!=$){var ee,te,ne,ie;ee=k.x-Q.x,te=k.y-Q.y,ne=Y.x-k.x;var re,ae,se=(ie=Y.y-k.y)*(re=$.x-Q.x)-ne*(ae=$.y-Q.y);if(co.epsilon<se*se){var le=(ae*ee-re*te)*(se=1/se);if(co.epsilon<le&&le<1-co.epsilon){var oe=(ie*ee-ne*te)*se;if(co.epsilon<oe&&oe<1-co.epsilon){J=x=!1;break}}}Q=$,K=K.next}else Q=$,K=K.next}if(J)for(;;){var _e,pe,ue,he,ce=this.lverts.front();if(k==Q||k==ce||Y==Q||Y==ce)break;_e=k.x-Q.x,pe=k.y-Q.y,ue=Y.x-k.x;var de,me,fe=(he=Y.y-k.y)*(de=ce.x-Q.x)-ue*(me=ce.y-Q.y);if(co.epsilon<fe*fe){var ge=(me*_e-de*pe)*(fe=1/fe);if(co.epsilon<ge&&ge<1-co.epsilon){var ve=(he*_e-ue*pe)*fe;if(co.epsilon<ve&&ve<1-co.epsilon){x=!1;break}}}break}break}return this.validation=x?H_.get_VALID():H_.get_SELF_INTERSECTING()}return this.validation},validate_lverts:function(){this.zip_lverts&&(this.zip_lverts=!1,2<this.lverts.size()&&(this.validate_area_inertia(),this.area<0&&(this.reverse_vertices(),this.area=-this.area)))},cleanup_lvert:function(e){for(var t=null,n=null,i=this.lverts.begin();null!=i&&i.elem()!=e;)t=null==t?this.gverts.begin():t.next,n=null==n?this.edges.begin():n.next,i=i.next;var r=null==t?this.gverts.front():t.next.elem();this.gverts.erase(t);var a=r;if(a.free(),a.next=fu.zpp_pool,fu.zpp_pool=a,2==this.edgeCnt){var s=this.edges.pop_unsafe(),l=s;l.free(),l.next=Su.zpp_pool,Su.zpp_pool=l;var o=s=this.edges.pop_unsafe();o.free(),o.next=Su.zpp_pool,Su.zpp_pool=o,this.edgeCnt=0}else if(0!=this.edgeCnt){var _=null==n?this.edges.front():n.next.elem();this.edges.erase(n);var p=_;p.free(),p.next=Su.zpp_pool,Su.zpp_pool=p,this.edgeCnt--}},zip_sanitation:null,splice_collinear:function(){this.zip_sanitation&&(this.zip_sanitation=!1,this.splice_collinear_real())},splice_collinear_real:function(){if(null!=this.lverts.begin()&&null!=this.lverts.begin().next&&null!=this.lverts.begin().next.next){for(var e=null,t=this.lverts.begin();null!=t;){var n=null==t.next?this.lverts.begin():t.next,i=t.elem(),r=n.elem();t=vu.vec_dsq(i.x,i.y,r.x,r.y)<co.epsilon*co.epsilon?(this.cleanup_lvert(t.elem()),this.lverts.erase(e)):(e=t).next}if(!this.lverts.empty())for(var a;;){a=!1;for(var s=this.lverts.begin();null!=s;){var l,o,_,p=null==s.next?this.lverts.begin():s.next,u=null==p.next?this.lverts.begin():p.next,h=s.elem(),c=p.elem(),d=u.elem();l=c.x-h.x,o=c.y-h.y,_=d.x-c.x;var m=(d.y-c.y)*l-_*o;co.epsilon*co.epsilon<=m*m||(this.cleanup_lvert(p.elem()),this.lverts.erase(null==s.next?null:s),a=!0),s=s.next}if(!a)break}}},reverse_vertices:function(){this.lverts.reverse(),this.gverts.reverse(),this.edges.reverse();var e=this.edges.iterator_at(this.edgeCnt-1),t=this.edges.pop_unsafe();this.edges.insert(e,t),this.reverse_flag=!this.reverse_flag,null!=this.wrap_lverts&&(this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag),null!=this.wrap_gverts&&(this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag),null!=this.wrap_edges&&(this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag)},validate_laxi:function(){if(this.zip_laxi){this.zip_laxi=!1,this.validate_lverts();var e=this.edges.begin(),t=this.lverts.begin(),n=t.elem();for(t=t.next;null!=t;){var i=t.elem(),r=e.elem();e=e.next,r.lp0=n,r.lp1=i;var a=0,s=0;a=n.x-i.x,s=n.y-i.y;var l=Math.sqrt(a*a+s*s),o=1/(r.length=l),_=a*=o;a=-(s*=o),s=_,r.lprojection=a*n.x+s*n.y,r.lnormx=a,r.lnormy=s,null!=r.wrap_lnorm&&(r.wrap_lnorm.zpp_inner.x=a,r.wrap_lnorm.zpp_inner.y=s),n=i,t=t.next}var p=this.lverts.front(),u=e.elem();e=e.next,u.lp0=n,u.lp1=p;var h=0,c=0;h=n.x-p.x,c=n.y-p.y;var d=Math.sqrt(h*h+c*c),m=1/(u.length=d),f=h*=m;h=-(c*=m),c=f,u.lprojection=h*n.x+c*n.y,u.lnormx=h,u.lnormy=c,null!=u.wrap_lnorm&&(u.wrap_lnorm.zpp_inner.x=h,u.wrap_lnorm.zpp_inner.y=c)}},validate_gverts:function(){if(this.zip_gverts&&null!=this.body){this.zip_gverts=!1,this.validate_lverts(),this.body.validate_axis();for(var e=this.lverts.begin(),t=this.gverts.begin();null!=t;){var n=t.elem(),i=e.elem();e=e.next,n.x=this.body.posx+(this.body.axisy*i.x-this.body.axisx*i.y),n.y=this.body.posy+(i.x*this.body.axisx+i.y*this.body.axisy),t=t.next}}},validate_gaxi:function(){if(this.zip_gaxi&&null!=this.body){this.zip_gaxi=!1,this.validate_laxi(),this.body.validate_axis(),this.validate_gverts();var e=this.edges.begin(),t=this.gverts.begin(),n=t.elem();for(t=t.next;null!=t;){var i=t.elem(),r=e.elem();e=e.next,r.gp0=n,r.gp1=i,r.gnormx=this.body.axisy*r.lnormx-this.body.axisx*r.lnormy,r.gnormy=r.lnormx*this.body.axisx+r.lnormy*this.body.axisy,r.gprojection=this.body.posx*r.gnormx+this.body.posy*r.gnormy+r.lprojection,null!=r.wrap_gnorm&&(r.wrap_gnorm.zpp_inner.x=r.gnormx,r.wrap_gnorm.zpp_inner.y=r.gnormy),r.tp0=r.gp0.y*r.gnormx-r.gp0.x*r.gnormy,r.tp1=r.gp1.y*r.gnormx-r.gp1.x*r.gnormy,n=i,t=t.next}var a=this.gverts.front(),s=e.elem();e=e.next,s.gp0=n,s.gp1=a,s.gnormx=this.body.axisy*s.lnormx-this.body.axisx*s.lnormy,s.gnormy=s.lnormx*this.body.axisx+s.lnormy*this.body.axisy,s.gprojection=this.body.posx*s.gnormx+this.body.posy*s.gnormy+s.lprojection,null!=s.wrap_gnorm&&(s.wrap_gnorm.zpp_inner.x=s.gnormx,s.wrap_gnorm.zpp_inner.y=s.gnormy),s.tp0=s.gp0.y*s.gnormx-s.gp0.x*s.gnormy,s.tp1=s.gp1.y*s.gnormx-s.gp1.x*s.gnormy}},__validate_aabb:function(){this.validate_gverts();var e=this.gverts.front();this.aabb.minx=e.x,this.aabb.miny=e.y,this.aabb.maxx=e.x,this.aabb.maxy=e.y;for(var t=this.gverts.begin().next;null!=t;){var n=t.elem();n.x<this.aabb.minx&&(this.aabb.minx=n.x),n.x>this.aabb.maxx&&(this.aabb.maxx=n.x),n.y<this.aabb.miny&&(this.aabb.miny=n.y),n.y>this.aabb.maxy&&(this.aabb.maxy=n.y),t=t.next}},_force_validate_aabb:function(){var e=this.lverts.begin(),t=this.gverts.front(),n=e.elem();e=e.next,t.x=this.body.posx+(this.body.axisy*n.x-this.body.axisx*n.y),t.y=this.body.posy+(n.x*this.body.axisx+n.y*this.body.axisy),this.aabb.minx=t.x,this.aabb.miny=t.y,this.aabb.maxx=t.x,this.aabb.maxy=t.y;for(var i=this.gverts.begin().next;null!=i;){var r=i.elem(),a=e.elem();e=e.next,r.x=this.body.posx+(this.body.axisy*a.x-this.body.axisx*a.y),r.y=this.body.posy+(a.x*this.body.axisx+a.y*this.body.axisy),r.x<this.aabb.minx&&(this.aabb.minx=r.x),r.x>this.aabb.maxx&&(this.aabb.maxx=r.x),r.y<this.aabb.miny&&(this.aabb.miny=r.y),r.y>this.aabb.maxy&&(this.aabb.maxy=r.y),i=i.next}},__validate_sweepRadius:function(){var e=0,t=0;this.validate_laxi();for(var n=this.lverts.begin();null!=n;){var i=n.elem(),r=i.x*i.x+i.y*i.y;e<r&&(e=r),n=n.next}for(var a=this.edges.begin();null!=a;){var s=a.elem();if(s.lprojection<t&&(t=s.lprojection)<0)break;a=a.next}t<0&&(t=0),this.sweepRadius=Math.sqrt(e),this.sweepCoef=this.sweepRadius-t},__validate_area_inertia:function(){if(null==this.lverts.begin()||null==this.lverts.begin().next||null==this.lverts.begin().next.next)this.area=0,this.inertia=0;else{var e=this.area=0,t=0,n=this.lverts.begin(),i=n.elem(),r=(n=n.next).elem();for(n=n.next;null!=n;){var a=n.elem(),s=r.y*i.x-r.x*i.y;e+=s*(r.x*r.x+r.y*r.y+(r.x*i.x+r.y*i.y)+(i.x*i.x+i.y*i.y)),t+=s,this.area+=r.x*(a.y-i.y),i=r,r=a,n=n.next}var l=(n=this.lverts.begin()).elem(),o=r.y*i.x-r.x*i.y;e+=o*(r.x*r.x+r.y*r.y+(r.x*i.x+r.y*i.y)+(i.x*i.x+i.y*i.y)),t+=o,this.area+=r.x*(l.y-i.y),i=r,r=l;var _=(n=n.next).elem(),p=r.y*i.x-r.x*i.y;e+=p*(r.x*r.x+r.y*r.y+(r.x*i.x+r.y*i.y)+(i.x*i.x+i.y*i.y)),t+=p,this.area+=r.x*(_.y-i.y),this.inertia=e/(6*t),this.area*=.5,this.area<0&&(this.area=-this.area,this.reverse_vertices())}},__validate_angDrag:function(){this.validate_area_inertia(),this.validate_laxi();for(var e=0,t=this.edges.begin(),n=0,i=this.lverts.begin(),r=i.elem(),a=i.next;null!=a;){var s,l,o=a.elem(),_=t.elem();t=t.next,n+=_.length,s=o.x-r.x,l=o.y-r.y,e+=_.length*co.fluidAngularDragFriction*this.material.dynamicFriction*_.lprojection*_.lprojection;var p=-(r.y*_.lnormx-r.x*_.lnormy)/(l*_.lnormx-s*_.lnormy);if(0<p){var u=1<p?1:p,h=0,c=0;h=r.x,c=r.y,h+=s*u,c+=l*u;var d=_.lnormy*r.x-_.lnormx*r.y,m=_.lnormy*h-_.lnormx*c;e+=(m*m*m-d*d*d)/(3*(m-d))*u*_.length*co.fluidAngularDrag}if(p<1){var f=p<0?0:p,g=0,v=0;g=r.x,v=r.y,g+=s*f,v+=l*f;var b=_.lnormy*g-_.lnormx*v,y=_.lnormy*o.x-_.lnormx*o.y;e+=(y*y*y-b*b*b)/(3*(y-b))*co.fluidVacuumDrag*(1-f)*_.length*co.fluidAngularDrag}r=o,a=(i=a).next}for(;;){var x,z,w=(a=this.lverts.begin()).elem(),k=t.elem();t=t.next,n+=k.length,x=w.x-r.x,z=w.y-r.y,e+=k.length*co.fluidAngularDragFriction*this.material.dynamicFriction*k.lprojection*k.lprojection;var S=-(r.y*k.lnormx-r.x*k.lnormy)/(z*k.lnormx-x*k.lnormy);if(0<S){var C=1<S?1:S,N=0,P=0;N=r.x,P=r.y,N+=x*C,P+=z*C;var M=k.lnormy*r.x-k.lnormx*r.y,I=k.lnormy*N-k.lnormx*P;e+=(I*I*I-M*M*M)/(3*(I-M))*C*k.length*co.fluidAngularDrag}if(S<1){var T=S<0?0:S,A=0,D=0;A=r.x,D=r.y,A+=x*T,D+=z*T;var E=k.lnormy*A-k.lnormx*D,O=k.lnormy*w.x-k.lnormx*w.y;e+=(O*O*O-E*E*E)/(3*(O-E))*co.fluidVacuumDrag*(1-T)*k.length*co.fluidAngularDrag}break}this.angDrag=e/(this.inertia*n)},__validate_localCOM:function(){if(null==this.lverts.begin().next)this.localCOMx=this.lverts.front().x,this.localCOMy=this.lverts.front().y;else if(null==this.lverts.begin().next.next)this.localCOMx=this.lverts.front().x,this.localCOMy=this.lverts.front().y,this.localCOMx+=1*this.lverts.begin().next.elem().x,this.localCOMy+=1*this.lverts.begin().next.elem().y,this.localCOMx*=.5,this.localCOMy*=.5;else{this.localCOMx=0;var e=this.localCOMy=0,t=this.lverts.begin(),n=t.elem(),i=(t=t.next).elem();for(t=t.next;null!=t;){var r=t.elem();e+=i.x*(r.y-n.y);var a=r.y*i.x-r.x*i.y;this.localCOMx+=(i.x+r.x)*a,this.localCOMy+=(i.y+r.y)*a,n=i,i=r,t=t.next}var s=(t=this.lverts.begin()).elem();e+=i.x*(s.y-n.y);var l=s.y*i.x-s.x*i.y;this.localCOMx+=(i.x+s.x)*l,this.localCOMy+=(i.y+s.y)*l,n=i,i=s;var o=(t=t.next).elem();e+=i.x*(o.y-n.y);var _=o.y*i.x-o.x*i.y;this.localCOMx+=(i.x+o.x)*_,this.localCOMy+=(i.y+o.y)*_;var p=e=1/(3*e);this.localCOMx*=p,this.localCOMy*=p}},localCOM_validate:function(){this.validate_localCOM()},localCOM_invalidate:function(e){var t,n;this.validate_localCOM(),t=e.x-this.localCOMx,n=e.y-this.localCOMy;for(var i=this.lverts.begin();null!=i;){var r=i.elem();r.x+=1*t,r.y+=1*n,i=i.next}this.invalidate_lverts()},setupLocalCOM:function(){this.wrap_localCOM=y_.get(this.localCOMx,this.localCOMy),this.wrap_localCOM.zpp_inner._inuse=!0,this.wrap_localCOM.zpp_inner._validate=Cc(this,this.localCOM_validate),this.wrap_localCOM.zpp_inner._invalidate=Cc(this,this.localCOM_invalidate)},__translate:function(e,t){for(var n=this.lverts.begin();null!=n;){var i=n.elem();i.x+=1*e,i.y+=1*t,n=n.next}this.invalidate_lverts()},__scale:function(e,t){for(var n=this.lverts.begin();null!=n;){var i=n.elem();i.x*=e,i.y*=t,n=n.next}this.invalidate_lverts()},__rotate:function(e,t){for(var n=this.lverts.begin();null!=n;){var i,r,a=n.elem();i=t*a.x-e*a.y,r=a.x*e+a.y*t,a.x=i,a.y=r,n=n.next}this.invalidate_lverts()},__transform:function(e){for(var t=this.lverts.begin();null!=t;){var n=t.elem(),i=e.get_a()*n.x+e.get_b()*n.y+e.get_tx();n.y=e.get_c()*n.x+e.get_d()*n.y+e.get_ty(),n.x=i,t=t.next}this.invalidate_lverts()},__copy:function(){return new V_(this.outer_zn.get_localVerts()).zpp_inner_zn},__class__:Cu});var Nu=function(){this.circShape=null,this.matrix=null,this.aabbShape=null,this.dynab=null,this.sweep=null,this.is_sweep=!1,this.space=null};(n["zpp_nape.space.ZPP_Broadphase"]=Nu).__name__=["zpp_nape","space","ZPP_Broadphase"],Nu.prototype={space:null,is_sweep:null,sweep:null,dynab:null,insert:function(e){this.is_sweep?this.sweep.__insert(e):this.dynab.__insert(e)},remove:function(e){this.is_sweep?this.sweep.__remove(e):this.dynab.__remove(e)},sync:function(e){this.is_sweep?this.sweep.__sync(e):this.dynab.__sync(e)},broadphase:function(e,t){},clear:function(){},shapesUnderPoint:function(e,t,n,i){return null},bodiesUnderPoint:function(e,t,n,i){return null},aabbShape:null,matrix:null,updateAABBShape:function(e){if(null==this.aabbShape)new C_(M_.get_STATIC()).get_shapes().add(this.aabbShape=new V_(V_.rect(e.minx,e.miny,e.width(),e.height())));else{var t=this.aabbShape.zpp_inner.aabb,n=e.width()/t.width(),i=e.height()/t.height();null==this.matrix&&(this.matrix=new d_),this.matrix.set_a(n),this.matrix.set_b(this.matrix.set_c(0)),this.matrix.set_d(i),this.matrix.set_tx(e.minx-n*t.minx),this.matrix.set_ty(e.miny-i*t.miny),this.aabbShape.transform(this.matrix)}this.aabbShape.zpp_inner.validate_aabb(),this.aabbShape.zpp_inner.polygon.validate_gaxi()},shapesInAABB:function(e,t,n,i,r){return null},bodiesInAABB:function(e,t,n,i,r){return null},circShape:null,updateCircShape:function(e,t,n){if(null==this.circShape)new C_(M_.get_STATIC()).get_shapes().add(this.circShape=new R_(n,y_.get(e,t)));else{var i=this.circShape.zpp_inner.circle,r=n/i.radius;null==this.matrix&&(this.matrix=new d_),this.matrix.set_a(this.matrix.set_d(r)),this.matrix.set_b(this.matrix.set_c(0)),this.matrix.set_tx(e-r*i.localCOMx),this.matrix.set_ty(t-r*i.localCOMy),this.circShape.transform(this.matrix)}this.circShape.zpp_inner.validate_aabb()},shapesInCircle:function(e,t,n,i,r,a){return null},bodiesInCircle:function(e,t,n,i,r,a){return null},validateShape:function(e){e.isPolygon()&&e.polygon.validate_gaxi(),e.validate_aabb(),e.validate_worldCOM()},shapesInShape:function(e,t,n,i){return null},bodiesInShape:function(e,t,n,i){return null},rayCast:function(e,t,n){return null},rayMultiCast:function(e,t,n,i){return null},__class__:Nu};var Pu=function(){this.first_sync=!1,this.synced=!1,this.snext=null,this.moved=!1,this.mnext=null,this.next=null,this.rayt=0,this.height=0,this.child2=null,this.child1=null,this.parent=null,this.dyn=!1,this.shape=null,this.aabb=null,this.height=-1};(n["zpp_nape.space.ZPP_AABBNode"]=Pu).__name__=["zpp_nape","space","ZPP_AABBNode"],Pu.prototype={aabb:null,shape:null,dyn:null,parent:null,child1:null,child2:null,height:null,rayt:null,next:null,alloc:function(){null==Lp.zpp_pool?this.aabb=new Lp:(this.aabb=Lp.zpp_pool,Lp.zpp_pool=this.aabb.next,this.aabb.next=null),this.aabb.alloc(),this.moved=!1,this.synced=!1,this.first_sync=!1},free:function(){this.height=-1;var e=this.aabb;e.free(),e.next=Lp.zpp_pool,Lp.zpp_pool=e,this.child1=this.child2=this.parent=null,this.next=null,this.snext=null,this.mnext=null},mnext:null,moved:null,snext:null,synced:null,first_sync:null,isLeaf:function(){return null==this.child1},__class__:Pu};var Mu=function(){this.next=null,this.arb=null,this.di=0,this.id=0,this.sleeping=!1,this.first=!1,this.n2=null,this.n1=null};(n["zpp_nape.space.ZPP_AABBPair"]=Mu).__name__=["zpp_nape","space","ZPP_AABBPair"],Mu.prototype={n1:null,n2:null,first:null,sleeping:null,id:null,di:null,arb:null,next:null,alloc:function(){},free:function(){this.n1=this.n2=null,this.sleeping=!1},__class__:Mu};var Iu=function(){this.root=null};(n["zpp_nape.space.ZPP_AABBTree"]=Iu).__name__=["zpp_nape","space","ZPP_AABBTree"],Iu.prototype={root:null,clear:function(){if(null!=this.root){var e=null;for(this.root.next=e,e=this.root;null!=e;){var t=e;e=t.next,t.next=null;var n=t;n.isLeaf()?(n.shape.node=null,n.shape.removedFromSpace(),n.shape=null):(null!=n.child1&&(n.child1.next=e,e=n.child1),null!=n.child2&&(n.child2.next=e,e=n.child2));var i=n;i.free(),i.next=Pu.zpp_pool,Pu.zpp_pool=i}this.root=null}},insertLeaf:function(e){this.inlined_insertLeaf(e)},inlined_insertLeaf:function(e){if(null==this.root)this.root=e,this.root.parent=null;else{for(var t=e.aabb,n=this.root;!n.isLeaf();){var i=n.child1,r=n.child2,a=n.aabb.perimeter();Iu.tmpaabb.setCombine(n.aabb,t);var s,l,o=Iu.tmpaabb.perimeter(),_=2*o,p=2*(o-a);if(Iu.tmpaabb.setCombine(t,i.aabb),i.isLeaf())s=Iu.tmpaabb.perimeter()+p;else{var u=i.aabb.perimeter();s=Iu.tmpaabb.perimeter()-u+p}if(Iu.tmpaabb.setCombine(t,r.aabb),r.isLeaf())l=Iu.tmpaabb.perimeter()+p;else{var h=r.aabb.perimeter();l=Iu.tmpaabb.perimeter()-h+p}if(_<s&&_<l)break;n=s<l?i:r}var c,d=n,m=d.parent;for(null==Pu.zpp_pool?c=new Pu:(c=Pu.zpp_pool,Pu.zpp_pool=c.next,c.next=null),c.alloc(),c.parent=m,c.aabb.setCombine(t,d.aabb),c.height=d.height+1,null!=m?(m.child1==d?m.child1=c:m.child2=c,c.child1=d,c.child2=e,d.parent=c,e.parent=c):(c.child1=d,c.child2=e,d.parent=c,e.parent=c,this.root=c),n=e.parent;null!=n;){var f=(n=this.balance(n)).child1,g=n.child2,v=f.height,b=g.height;n.height=1+(b<v?v:b),n.aabb.setCombine(f.aabb,g.aabb),n=n.parent}}},removeLeaf:function(e){this.inlined_removeLeaf(e)},inlined_removeLeaf:function(e){if(e!=this.root){var t=e.parent,n=t.parent,i=t.child1==e?t.child2:t.child1;if(null!=n){n.child1==t?n.child1=i:n.child2=i,i.parent=n;var r=t;r.free(),r.next=Pu.zpp_pool,Pu.zpp_pool=r;for(var a=n;null!=a;){var s=(a=this.balance(a)).child1,l=a.child2;a.aabb.setCombine(s.aabb,l.aabb);var o=s.height,_=l.height;a.height=1+(_<o?o:_),a=a.parent}}else{(this.root=i).parent=null;var p=t;p.free(),p.next=Pu.zpp_pool,Pu.zpp_pool=p}}else this.root=null},balance:function(e){if(e.isLeaf()||e.height<2)return e;var t=e.child1,n=e.child2,i=n.height-t.height;if(1<i){var r=n.child1,a=n.child2;if(n.child1=e,n.parent=e.parent,null!=(e.parent=n).parent?n.parent.child1==e?n.parent.child1=n:n.parent.child2=n:this.root=n,r.height>a.height){n.child2=r,((e.child2=a).parent=e).aabb.setCombine(t.aabb,a.aabb),n.aabb.setCombine(e.aabb,r.aabb);var s=t.height,l=a.height;e.height=1+(l<s?s:l);var o=e.height,_=r.height;n.height=1+(_<o?o:_)}else{n.child2=a,((e.child2=r).parent=e).aabb.setCombine(t.aabb,r.aabb),n.aabb.setCombine(e.aabb,a.aabb);var p=t.height,u=r.height;e.height=1+(u<p?p:u);var h=e.height,c=a.height;n.height=1+(c<h?h:c)}return n}if(i<-1){var d=t.child1,m=t.child2;if(t.child1=e,t.parent=e.parent,null!=(e.parent=t).parent?t.parent.child1==e?t.parent.child1=t:t.parent.child2=t:this.root=t,d.height>m.height){t.child2=d,((e.child1=m).parent=e).aabb.setCombine(n.aabb,m.aabb),t.aabb.setCombine(e.aabb,d.aabb);var f=n.height,g=m.height;e.height=1+(g<f?f:g);var v=e.height,b=d.height;t.height=1+(b<v?v:b)}else{t.child2=m,((e.child1=d).parent=e).aabb.setCombine(n.aabb,d.aabb),t.aabb.setCombine(e.aabb,m.aabb);var y=n.height,x=d.height;e.height=1+(x<y?y:x);var z=e.height,w=m.height;t.height=1+(w<z?z:w)}return t}return e},__class__:Iu};var Tu=function(e){this.openlist=null,this.failed=null,this.treeStack2=null,this.treeStack=null,this.moves=null,this.syncs=null,this.pairs=null,this.dtree=null,this.stree=null,Nu.call(this),this.space=e,this.is_sweep=!1,(this.dynab=this).stree=new Iu,this.dtree=new Iu};(n["zpp_nape.space.ZPP_DynAABBPhase"]=Tu).__name__=["zpp_nape","space","ZPP_DynAABBPhase"],Tu.__super__=Nu,Tu.prototype=r(Nu.prototype,{stree:null,dtree:null,pairs:null,syncs:null,moves:null,dyn:function(e){return!e.body.isStatic()&&!e.body.component.sleeping},__insert:function(e){var t;null==Pu.zpp_pool?t=new Pu:(t=Pu.zpp_pool,Pu.zpp_pool=t.next,t.next=null),t.alloc(),((t.shape=e).node=t).synced=!0,t.first_sync=!0,t.snext=this.syncs,this.syncs=t},__remove:function(e){var t=e.node;if(t.first_sync||(t.dyn?this.dtree.removeLeaf(t):this.stree.removeLeaf(t)),e.node=null,t.synced){for(var n=null,i=this.syncs;null!=i&&i!=t;)i=(n=i).snext;null==n?this.syncs=i.snext:n.snext=i.snext,i.snext=null,t.synced=!1}if(t.moved){for(var r=null,a=this.moves;null!=a&&a!=t;)a=(r=a).mnext;null==r?this.moves=a.mnext:r.mnext=a.mnext,a.mnext=null,t.moved=!1}for(var s=null,l=this.pairs;null!=l;){var o=l.next;if(l.n1!=t&&l.n2!=t)s=l,l=o;else{null==s?this.pairs=o:s.next=o,null!=l.arb&&(l.arb.pair=null),l.arb=null,l.n1.shape.pairs.remove(l),l.n2.shape.pairs.remove(l);var _=l;_.free(),_.next=Mu.zpp_pool,Mu.zpp_pool=_,l=o}}for(;!e.pairs.empty();){var p=e.pairs.pop_unsafe();p.n1==t?p.n2.shape.pairs.remove(p):p.n1.shape.pairs.remove(p),null!=p.arb&&(p.arb.pair=null),p.arb=null;var u=p;u.free(),u.next=Mu.zpp_pool,Mu.zpp_pool=u}var h=t;h.free(),h.next=Pu.zpp_pool,Pu.zpp_pool=h},__sync:function(e){var t=e.node;t.synced||(this.space.continuous||e.validate_aabb(),(t.dyn!=this.dyn(e)||!t.aabb.contains(e.aabb))&&(t.synced=!0,t.snext=this.syncs,this.syncs=t))},sync_broadphase:function(){if(this.space.validation(),null!=this.syncs)if(null==this.moves){for(var e=this.syncs;null!=e;){var t=e.shape;e.first_sync?e.first_sync=!1:(e.dyn?this.dtree:this.stree).inlined_removeLeaf(e);var n=e.aabb;this.space.continuous||t.validate_aabb(),n.setExpand(t.aabb,Tu.FATTEN),((e.dyn=this.dyn(t))?this.dtree:this.stree).inlined_insertLeaf(e),e.synced=!1,e.moved=!0,e.mnext=e.snext,e.snext=null,e=e.mnext}var i=this.syncs;this.syncs=this.moves,this.moves=i}else for(;null!=this.syncs;){var r=this.syncs;this.syncs=r.snext,r.snext=null;var a=r,s=a.shape;a.first_sync?a.first_sync=!1:(a.dyn?this.dtree:this.stree).inlined_removeLeaf(a);var l=a.aabb;this.space.continuous||s.validate_aabb(),l.setExpand(s.aabb,Tu.FATTEN),((a.dyn=this.dyn(s))?this.dtree:this.stree).inlined_insertLeaf(a),a.synced=!1,a.moved||(a.moved=!0,a.mnext=this.moves,this.moves=a)}},broadphase:function(e,t){for(var n=this.syncs;null!=n;){var i=n.shape;n.first_sync?n.first_sync=!1:(n.dyn?this.dtree:this.stree).inlined_removeLeaf(n);var r=n.aabb;e.continuous||i.validate_aabb(),r.setExpand(i.aabb,Tu.FATTEN),((n.dyn=this.dyn(i))?this.dtree:this.stree).inlined_insertLeaf(n),n.synced=!1,n=n.snext}for(;null!=this.syncs;){var a=this.syncs;this.syncs=a.snext,a.snext=null;var s=a;if(!s.moved){s.moved=!1;var l=s.shape;if(!l.body.component.sleeping){var o=s.aabb,_=null;for(null!=this.dtree.root&&(this.dtree.root.next=_,_=this.dtree.root);null!=_;){var p=_;_=p.next,p.next=null;var u=p;if(u!=s)if(u.isLeaf()){var h=u.shape;if(!(h.body==l.body||h.body.isStatic()&&l.body.isStatic())&&o.intersect(u.aabb)){var c,d;d=l.id<h.id?(c=l.id,h.id):(c=h.id,l.id);for(var m=null,f=(l.pairs.length<h.pairs.length?l:h).pairs.begin();null!=f;){var g=f.elem();if(g.id==c&&g.di==d){m=g;break}f=f.next}if(null!=m){m.sleeping&&(m.sleeping=!1,m.next=this.pairs,(this.pairs=m).first=!0);continue}null==Mu.zpp_pool?m=new Mu:(m=Mu.zpp_pool,Mu.zpp_pool=m.next,m.next=null),m.alloc(),m.n1=s,m.n2=u,m.id=c,m.di=d,m.next=this.pairs,(this.pairs=m).first=!0,l.pairs.inlined_add(m),h.pairs.inlined_add(m)}}else o.intersect(u.aabb)&&(null!=u.child1&&(u.child1.next=_,_=u.child1),null!=u.child2&&(u.child2.next=_,_=u.child2))}for(null!=this.stree.root&&(this.stree.root.next=_,_=this.stree.root);null!=_;){var v=_;_=v.next,v.next=null;var b=v;if(b!=s)if(b.isLeaf()){var y=b.shape;if(!(y.body==l.body||y.body.isStatic()&&l.body.isStatic())&&o.intersect(b.aabb)){var x,z;z=l.id<y.id?(x=l.id,y.id):(x=y.id,l.id);for(var w=null,k=(l.pairs.length<y.pairs.length?l:y).pairs.begin();null!=k;){var S=k.elem();if(S.id==x&&S.di==z){w=S;break}k=k.next}if(null!=w){w.sleeping&&(w.sleeping=!1,w.next=this.pairs,(this.pairs=w).first=!0);continue}null==Mu.zpp_pool?w=new Mu:(w=Mu.zpp_pool,Mu.zpp_pool=w.next,w.next=null),w.alloc(),w.n1=s,w.n2=b,w.id=x,w.di=z,w.next=this.pairs,(this.pairs=w).first=!0,l.pairs.inlined_add(w),y.pairs.inlined_add(w)}}else o.intersect(b.aabb)&&(null!=b.child1&&(b.child1.next=_,_=b.child1),null!=b.child2&&(b.child2.next=_,_=b.child2))}}}}for(;null!=this.moves;){var C=this.moves;this.moves=C.mnext,C.mnext=null;var N=C;N.moved=!1;var P=N.shape;if(!P.body.component.sleeping){var M=N.aabb,I=null;for(null!=this.dtree.root&&(this.dtree.root.next=I,I=this.dtree.root);null!=I;){var T=I;I=T.next,T.next=null;var A=T;if(A!=N)if(A.isLeaf()){var D=A.shape;if(!(D.body==P.body||D.body.isStatic()&&P.body.isStatic())&&M.intersect(A.aabb)){var E,O;O=P.id<D.id?(E=P.id,D.id):(E=D.id,P.id);for(var B=null,L=(P.pairs.length<D.pairs.length?P:D).pairs.begin();null!=L;){var j=L.elem();if(j.id==E&&j.di==O){B=j;break}L=L.next}if(null!=B){B.sleeping&&(B.sleeping=!1,B.next=this.pairs,(this.pairs=B).first=!0);continue}null==Mu.zpp_pool?B=new Mu:(B=Mu.zpp_pool,Mu.zpp_pool=B.next,B.next=null),B.alloc(),B.n1=N,B.n2=A,B.id=E,B.di=O,B.next=this.pairs,(this.pairs=B).first=!0,P.pairs.inlined_add(B),D.pairs.inlined_add(B)}}else M.intersect(A.aabb)&&(null!=A.child1&&(A.child1.next=I,I=A.child1),null!=A.child2&&(A.child2.next=I,I=A.child2))}for(null!=this.stree.root&&(this.stree.root.next=I,I=this.stree.root);null!=I;){var F=I;I=F.next,F.next=null;var R=F;if(R!=N)if(R.isLeaf()){var G=R.shape;if(!(G.body==P.body||G.body.isStatic()&&P.body.isStatic())&&M.intersect(R.aabb)){var Z,U;U=P.id<G.id?(Z=P.id,G.id):(Z=G.id,P.id);for(var V=null,q=(P.pairs.length<G.pairs.length?P:G).pairs.begin();null!=q;){var W=q.elem();if(W.id==Z&&W.di==U){V=W;break}q=q.next}if(null!=V){V.sleeping&&(V.sleeping=!1,V.next=this.pairs,(this.pairs=V).first=!0);continue}null==Mu.zpp_pool?V=new Mu:(V=Mu.zpp_pool,Mu.zpp_pool=V.next,V.next=null),V.alloc(),V.n1=N,V.n2=R,V.id=Z,V.di=U,V.next=this.pairs,(this.pairs=V).first=!0,P.pairs.inlined_add(V),G.pairs.inlined_add(V)}}else M.intersect(R.aabb)&&(null!=R.child1&&(R.child1.next=I,I=R.child1),null!=R.child2&&(R.child2.next=I,I=R.child2))}}}for(var X=null,H=this.pairs;null!=H;)if(H.first||H.n1.aabb.intersect(H.n2.aabb)){var Y=H.n1.shape,J=Y.body,K=H.n2.shape,Q=K.body;if(H.first||!J.component.sleeping&&!J.isStatic()||!Q.component.sleeping&&!Q.isStatic()){if(H.first=!1,Y.aabb.intersect(K.aabb)){var $=H.arb;H.arb=t?e.narrowPhase(Y,K,!J.isDynamic()||!Q.isDynamic(),H.arb,!1):e.continuousEvent(Y,K,!J.isDynamic()||!Q.isDynamic(),H.arb,!1),null==H.arb?null!=$&&($.pair=null):H.arb.pair=H}H=(X=H).next}else H.sleeping=!0,null==X?this.pairs=H.next:X.next=H.next,H=H.next}else{null==X?this.pairs=H.next:X.next=H.next,H.n1.shape.pairs.inlined_remove(H),H.n2.shape.pairs.inlined_remove(H);var ee=H.next;null!=H.arb&&(H.arb.pair=null),H.arb=null;var te=H;te.free(),te.next=Mu.zpp_pool,Mu.zpp_pool=te,H=ee}},clear:function(){for(;null!=this.syncs;){var e=this.syncs.snext;this.syncs.snext=null,this.syncs.first_sync&&(this.syncs.shape.node=null,this.syncs.shape.removedFromSpace(),this.syncs.shape=null),this.syncs=e}for(;null!=this.moves;){var t=this.moves.mnext;this.moves.mnext=null,this.moves.first_sync&&(this.moves.shape.node=null,this.moves.shape.removedFromSpace(),this.moves.shape=null),this.moves=t}for(;null!=this.pairs;){var n=this.pairs.next;null!=this.pairs.arb&&(this.pairs.arb.pair=null),this.pairs.arb=null,this.pairs.n1.shape.pairs.inlined_remove(this.pairs),this.pairs.n2.shape.pairs.inlined_remove(this.pairs);var i=this.pairs;i.free(),i.next=Mu.zpp_pool,Mu.zpp_pool=i,this.pairs=n}this.dtree.clear(),this.stree.clear()},treeStack:null,shapesUnderPoint:function(e,t,n,i){this.sync_broadphase();var r=fu.get(e,t),a=null==i?new W_:i;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var s=this.treeStack.pop_unsafe();s.aabb.containsPoint(r)&&(s.isLeaf()?(null==n||s.shape.filter.shouldCollide(n))&&(s.shape.isCircle()?Fp.circleContains(s.shape.circle,r)&&a.push(s.shape.outer):Fp.polyContains(s.shape.polygon,r)&&a.push(s.shape.outer)):(null!=s.child1&&this.treeStack.add(s.child1),null!=s.child2&&this.treeStack.add(s.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var l=this.treeStack.pop_unsafe();l.aabb.containsPoint(r)&&(l.isLeaf()?(null==n||l.shape.filter.shouldCollide(n))&&(l.shape.isCircle()?Fp.circleContains(l.shape.circle,r)&&a.push(l.shape.outer):Fp.polyContains(l.shape.polygon,r)&&a.push(l.shape.outer)):(null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)))}var o=r;return o.free(),o.next=fu.zpp_pool,fu.zpp_pool=o,a},bodiesUnderPoint:function(e,t,n,i){this.sync_broadphase();var r=fu.get(e,t),a=null==i?new P_:i;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var s=this.treeStack.pop_unsafe();if(s.aabb.containsPoint(r))if(s.isLeaf()){var l=s.shape.body.outer;a.has(l)||(null==n||s.shape.filter.shouldCollide(n))&&(s.shape.isCircle()?Fp.circleContains(s.shape.circle,r)&&a.push(l):Fp.polyContains(s.shape.polygon,r)&&a.push(l))}else null!=s.child1&&this.treeStack.add(s.child1),null!=s.child2&&this.treeStack.add(s.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var o=this.treeStack.pop_unsafe();if(o.aabb.containsPoint(r))if(o.isLeaf()){var _=o.shape.body.outer;a.has(_)||(null==n||o.shape.filter.shouldCollide(n))&&(o.shape.isCircle()?Fp.circleContains(o.shape.circle,r)&&a.push(_):Fp.polyContains(o.shape.polygon,r)&&a.push(_))}else null!=o.child1&&this.treeStack.add(o.child1),null!=o.child2&&this.treeStack.add(o.child2)}var p=r;return p.free(),p.next=fu.zpp_pool,fu.zpp_pool=p,a},treeStack2:null,shapesInAABB:function(e,t,n,i,r){this.sync_broadphase(),this.updateAABBShape(e);var a=this.aabbShape.zpp_inner.aabb,s=null==r?new W_:r;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var l=this.treeStack.pop_unsafe();if(a.contains(l.aabb))if(l.isLeaf())(null==i||l.shape.filter.shouldCollide(i))&&s.push(l.shape.outer);else for(null==this.treeStack2&&(this.treeStack2=new lh),this.treeStack2.add(l);!this.treeStack2.empty();){var o=this.treeStack2.pop_unsafe();o.isLeaf()?(null==i||o.shape.filter.shouldCollide(i))&&s.push(o.shape.outer):(null!=o.child1&&this.treeStack2.add(o.child1),null!=o.child2&&this.treeStack2.add(o.child2))}else l.aabb.intersect(a)&&(l.isLeaf()?(null==i||l.shape.filter.shouldCollide(i))&&(t?n?Fp.containTest(this.aabbShape.zpp_inner,l.shape)&&s.push(l.shape.outer):a.contains(l.shape.aabb)?s.push(l.shape.outer):Fp.testCollide_safe(l.shape,this.aabbShape.zpp_inner)&&s.push(l.shape.outer):n&&!a.contains(l.shape.aabb)||s.push(l.shape.outer)):(null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var _=this.treeStack.pop_unsafe();if(a.contains(_.aabb))if(_.isLeaf())(null==i||_.shape.filter.shouldCollide(i))&&s.push(_.shape.outer);else for(null==this.treeStack2&&(this.treeStack2=new lh),this.treeStack2.add(_);!this.treeStack2.empty();){var p=this.treeStack2.pop_unsafe();p.isLeaf()?(null==i||p.shape.filter.shouldCollide(i))&&s.push(p.shape.outer):(null!=p.child1&&this.treeStack2.add(p.child1),null!=p.child2&&this.treeStack2.add(p.child2))}else _.aabb.intersect(a)&&(_.isLeaf()?(null==i||_.shape.filter.shouldCollide(i))&&(t?n?Fp.containTest(this.aabbShape.zpp_inner,_.shape)&&s.push(_.shape.outer):a.contains(_.shape.aabb)?s.push(_.shape.outer):Fp.testCollide_safe(_.shape,this.aabbShape.zpp_inner)&&s.push(_.shape.outer):n&&!a.contains(_.shape.aabb)||s.push(_.shape.outer)):(null!=_.child1&&this.treeStack.add(_.child1),null!=_.child2&&this.treeStack.add(_.child2)))}return s},failed:null,bodiesInAABB:function(e,t,n,i,r){this.sync_broadphase(),this.updateAABBShape(e);var a=this.aabbShape.zpp_inner.aabb,s=null==r?new P_:r;if(null==this.failed&&(this.failed=new P_),null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var l=this.treeStack.pop_unsafe();if(a.contains(l.aabb))if(l.isLeaf()){if(null==i||l.shape.filter.shouldCollide(i)){var o=l.shape.body.outer;s.has(o)||s.push(o)}}else for(null==this.treeStack2&&(this.treeStack2=new lh),this.treeStack2.add(l);!this.treeStack2.empty();){var _=this.treeStack2.pop_unsafe();if(_.isLeaf()){if(null==i||_.shape.filter.shouldCollide(i)){var p=_.shape.body.outer;s.has(p)||s.push(p)}}else null!=_.child1&&this.treeStack2.add(_.child1),null!=_.child2&&this.treeStack2.add(_.child2)}else if(l.aabb.intersect(a))if(l.isLeaf()){var u=l.shape.body.outer;if(null==i||l.shape.filter.shouldCollide(i))if(t)if(n){if(!this.failed.has(u)){var h=Fp.containTest(this.aabbShape.zpp_inner,l.shape);!s.has(u)&&h?s.push(u):h||(s.remove(u),this.failed.push(u))}}else!s.has(u)&&Fp.testCollide_safe(l.shape,this.aabbShape.zpp_inner)&&s.push(u);else if(n){if(!this.failed.has(u)){var c=a.contains(l.shape.aabb);!s.has(u)&&c?s.push(u):c||(s.remove(u),this.failed.push(u))}}else!s.has(u)&&a.contains(l.shape.aabb)&&s.push(u)}else null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var d=this.treeStack.pop_unsafe();if(a.contains(d.aabb))if(d.isLeaf()){if(null==i||d.shape.filter.shouldCollide(i)){var m=d.shape.body.outer;s.has(m)||s.push(m)}}else for(null==this.treeStack2&&(this.treeStack2=new lh),this.treeStack2.add(d);!this.treeStack2.empty();){var f=this.treeStack2.pop_unsafe();if(f.isLeaf()){if(null==i||f.shape.filter.shouldCollide(i)){var g=f.shape.body.outer;s.has(g)||s.push(g)}}else null!=f.child1&&this.treeStack2.add(f.child1),null!=f.child2&&this.treeStack2.add(f.child2)}else if(d.aabb.intersect(a))if(d.isLeaf()){var v=d.shape.body.outer;if(null==i||d.shape.filter.shouldCollide(i))if(t)if(n){if(!this.failed.has(v)){var b=Fp.containTest(this.aabbShape.zpp_inner,d.shape);!s.has(v)&&b?s.push(v):b||(s.remove(v),this.failed.push(v))}}else!s.has(v)&&Fp.testCollide_safe(d.shape,this.aabbShape.zpp_inner)&&s.push(v);else if(n){if(!this.failed.has(v)){var y=a.contains(d.shape.aabb);!s.has(v)&&y?s.push(v):y||(s.remove(v),this.failed.push(v))}}else!s.has(v)&&a.contains(d.shape.aabb)&&s.push(v)}else null!=d.child1&&this.treeStack.add(d.child1),null!=d.child2&&this.treeStack.add(d.child2)}return this.failed.clear(),s},shapesInCircle:function(e,t,n,i,r,a){this.sync_broadphase(),this.updateCircShape(e,t,n);var s=this.circShape.zpp_inner.aabb,l=null==a?new W_:a;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var o=this.treeStack.pop_unsafe();o.aabb.intersect(s)&&(o.isLeaf()?(null==r||o.shape.filter.shouldCollide(r))&&(i?Fp.containTest(this.circShape.zpp_inner,o.shape)&&l.push(o.shape.outer):Fp.testCollide_safe(o.shape,this.circShape.zpp_inner)&&l.push(o.shape.outer)):(null!=o.child1&&this.treeStack.add(o.child1),null!=o.child2&&this.treeStack.add(o.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var _=this.treeStack.pop_unsafe();_.aabb.intersect(s)&&(_.isLeaf()?(null==r||_.shape.filter.shouldCollide(r))&&(i?Fp.containTest(this.circShape.zpp_inner,_.shape)&&l.push(_.shape.outer):Fp.testCollide_safe(_.shape,this.circShape.zpp_inner)&&l.push(_.shape.outer)):(null!=_.child1&&this.treeStack.add(_.child1),null!=_.child2&&this.treeStack.add(_.child2)))}return l},bodiesInCircle:function(e,t,n,i,r,a){this.sync_broadphase(),this.updateCircShape(e,t,n);var s=this.circShape.zpp_inner.aabb,l=null==a?new P_:a;if(null==this.failed&&(this.failed=new P_),null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var o=this.treeStack.pop_unsafe();if(o.aabb.intersect(s))if(o.isLeaf()){var _=o.shape.body.outer;if(null==r||o.shape.filter.shouldCollide(r))if(i){if(!this.failed.has(_)){var p=Fp.containTest(this.circShape.zpp_inner,o.shape);!l.has(_)&&p?l.push(_):p||(l.remove(_),this.failed.push(_))}}else!l.has(_)&&Fp.testCollide_safe(o.shape,this.circShape.zpp_inner)&&l.push(_)}else null!=o.child1&&this.treeStack.add(o.child1),null!=o.child2&&this.treeStack.add(o.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var u=this.treeStack.pop_unsafe();if(u.aabb.intersect(s))if(u.isLeaf()){var h=u.shape.body.outer;if(null==r||u.shape.filter.shouldCollide(r))if(i){if(!this.failed.has(h)){var c=Fp.containTest(this.circShape.zpp_inner,u.shape);!l.has(h)&&c?l.push(h):c||(l.remove(h),this.failed.push(h))}}else!l.has(h)&&Fp.testCollide_safe(u.shape,this.circShape.zpp_inner)&&l.push(h)}else null!=u.child1&&this.treeStack.add(u.child1),null!=u.child2&&this.treeStack.add(u.child2)}return this.failed.clear(),l},shapesInShape:function(e,t,n,i){this.sync_broadphase(),this.validateShape(e);var r=e.aabb,a=null==i?new W_:i;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var s=this.treeStack.pop_unsafe();s.aabb.intersect(r)&&(s.isLeaf()?(null==n||s.shape.filter.shouldCollide(n))&&(t?Fp.containTest(e,s.shape)&&a.push(s.shape.outer):Fp.testCollide_safe(s.shape,e)&&a.push(s.shape.outer)):(null!=s.child1&&this.treeStack.add(s.child1),null!=s.child2&&this.treeStack.add(s.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var l=this.treeStack.pop_unsafe();l.aabb.intersect(r)&&(l.isLeaf()?(null==n||l.shape.filter.shouldCollide(n))&&(t?Fp.containTest(e,l.shape)&&a.push(l.shape.outer):Fp.testCollide_safe(l.shape,e)&&a.push(l.shape.outer)):(null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)))}return a},bodiesInShape:function(e,t,n,i){this.sync_broadphase(),this.validateShape(e);var r=e.aabb,a=null==i?new P_:i;if(null==this.failed&&(this.failed=new P_),null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var s=this.treeStack.pop_unsafe();if(s.aabb.intersect(r))if(s.isLeaf()){var l=s.shape.body.outer;if(null==n||s.shape.filter.shouldCollide(n))if(t){if(!this.failed.has(l)){var o=Fp.containTest(e,s.shape);!a.has(l)&&o?a.push(l):o||(a.remove(l),this.failed.push(l))}}else!a.has(l)&&Fp.testCollide_safe(s.shape,e)&&a.push(l)}else null!=s.child1&&this.treeStack.add(s.child1),null!=s.child2&&this.treeStack.add(s.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new lh),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var _=this.treeStack.pop_unsafe();if(_.aabb.intersect(r))if(_.isLeaf()){var p=_.shape.body.outer;if(null==n||_.shape.filter.shouldCollide(n))if(t){if(!this.failed.has(p)){var u=Fp.containTest(e,_.shape);!a.has(p)&&u?a.push(p):u||(a.remove(p),this.failed.push(p))}}else!a.has(p)&&Fp.testCollide_safe(_.shape,e)&&a.push(p)}else null!=_.child1&&this.treeStack.add(_.child1),null!=_.child2&&this.treeStack.add(_.child2)}return this.failed.clear(),a},openlist:null,rayCast:function(e,t,n){null==this.openlist&&(this.openlist=new lh),this.sync_broadphase(),e.validate_dir();var i=e.maxdist;if(null!=this.dtree.root&&e.aabbtest(this.dtree.root.aabb)){var r=e.aabbsect(this.dtree.root.aabb);if(0<=r&&r<i){this.dtree.root.rayt=r;for(var a=null,s=this.openlist.begin();null!=s;){var l=s.elem();if(this.dtree.root.rayt<l.rayt)break;s=(a=s).next}this.openlist.inlined_insert(a,this.dtree.root)}}if(null!=this.stree.root&&e.aabbtest(this.stree.root.aabb)){var o=e.aabbsect(this.stree.root.aabb);if(0<=o&&o<i){this.stree.root.rayt=o;for(var _=null,p=this.openlist.begin();null!=p;){var u=p.elem();if(this.stree.root.rayt<u.rayt)break;p=(_=p).next}this.openlist.inlined_insert(_,this.stree.root)}}for(var h=null;!this.openlist.empty();){var c=this.openlist.pop_unsafe();if(c.rayt>=i)break;if(c.isLeaf()){var d=c.shape;if(null==n||d.filter.shouldCollide(n)){var m=d.isCircle()?e.circlesect(d.circle,t,i):e.aabbtest(d.aabb)?e.polysect(d.polygon,t,i):null;null!=m&&(i=m.get_distance(),null!=h&&h.dispose(),h=m)}}else{if(null!=c.child1&&e.aabbtest(c.child1.aabb)){var f=e.aabbsect(c.child1.aabb);if(0<=f&&f<i){c.child1.rayt=f;for(var g=null,v=this.openlist.begin();null!=v;){var b=v.elem();if(c.child1.rayt<b.rayt)break;v=(g=v).next}this.openlist.inlined_insert(g,c.child1)}}if(null!=c.child2&&e.aabbtest(c.child2.aabb)){var y=e.aabbsect(c.child2.aabb);if(0<=y&&y<i){c.child2.rayt=y;for(var x=null,z=this.openlist.begin();null!=z;){var w=z.elem();if(c.child2.rayt<w.rayt)break;z=(x=z).next}this.openlist.inlined_insert(x,c.child2)}}}}return this.openlist.clear(),h},rayMultiCast:function(e,t,n,i){null==this.openlist&&(this.openlist=new lh),this.sync_broadphase(),e.validate_dir();var r=e.maxdist>=$_.POSINF(),a=null==i?new b_:i;if(null!=this.dtree.root&&e.aabbtest(this.dtree.root.aabb))if(r)this.openlist.add(this.dtree.root);else{var s=e.aabbsect(this.dtree.root.aabb);0<=s&&s<e.maxdist&&this.openlist.add(this.dtree.root)}if(null!=this.stree.root&&e.aabbtest(this.stree.root.aabb))if(r)this.openlist.add(this.stree.root);else{var l=e.aabbsect(this.stree.root.aabb);0<=l&&l<e.maxdist&&this.openlist.add(this.stree.root)}for(;!this.openlist.empty();){var o=this.openlist.pop_unsafe();if(o.isLeaf()){var _=o.shape;(null==n||_.filter.shouldCollide(n))&&(_.isCircle()?e.circlesect2(_.circle,t,a):e.aabbtest(_.aabb)&&e.polysect2(_.polygon,t,a))}else{if(null!=o.child1&&e.aabbtest(o.child1.aabb))if(r)this.openlist.add(o.child1);else{var p=e.aabbsect(o.child1.aabb);0<=p&&p<e.maxdist&&this.openlist.add(o.child1)}if(null!=o.child2&&e.aabbtest(o.child2.aabb))if(r)this.openlist.add(o.child2);else{var u=e.aabbsect(o.child2.aabb);0<=u&&u<e.maxdist&&this.openlist.add(o.child2)}}}return this.openlist.clear(),a},__class__:Tu});var Au=function(){this.waket=0,this.sleep=!1,this.comps=null,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.comps=new sh};(n["zpp_nape.space.ZPP_Island"]=Au).__name__=["zpp_nape","space","ZPP_Island"],Au.prototype={next:null,elem:function(){return this},begin:function(){return this.next},_inuse:null,modified:null,pushmod:null,length:null,setbegin:function(e){this.next=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){e._inuse=!0;var t=e;return t.next=this.begin(),this.next=t,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){t._inuse=!0;var n=t;return null==e?(n.next=this.begin(),this.next=n):(n.next=e.next,e.next=n),this.pushmod=this.modified=!0,this.length++,n},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.next=e.next,e.elem()._inuse=!1,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;return null==e?(n=(t=this.begin()).next,this.next=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0)),t.elem()._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.next=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},comps:null,sleep:null,waket:null,free:function(){},alloc:function(){this.waket=0},__class__:Au};var Du=function(){this.woken=!1,this.waket=0,this.sleeping=!1,this.island=null,this.constraint=null,this.body=null,this.isBody=!1,this.rank=0,this.parent=null,this.next=null,this.reset(),this.woken=!1};(n["zpp_nape.space.ZPP_Component"]=Du).__name__=["zpp_nape","space","ZPP_Component"],Du.prototype={next:null,parent:null,rank:null,isBody:null,body:null,constraint:null,island:null,sleeping:null,waket:null,woken:null,free:function(){this.body=null,this.constraint=null},alloc:function(){},reset:function(){this.sleeping=!1,this.island=null,(this.parent=this).rank=0},__class__:Du};var Eu=function(){this.lazydel=!1,this.freed=!1,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.int2=null,this.int1=null,this.di=0,this.id=0,this.arbiters=new Hu};(n["zpp_nape.space.ZPP_CallbackSet"]=Eu).__name__=["zpp_nape","space","ZPP_CallbackSet"],Eu.get=function(e,t){var n;return null==Eu.zpp_pool?n=new Eu:(n=Eu.zpp_pool,Eu.zpp_pool=n.next,n.next=null),n.alloc(),e.id<t.id?(n.int1=e,n.int2=t):(n.int1=t,n.int2=e),n.id=n.int1.id,n.di=n.int2.id,n},Eu.prototype={id:null,di:null,int1:null,int2:null,arbiters:null,COLLISIONstate:null,COLLISIONstamp:null,SENSORstate:null,SENSORstamp:null,FLUIDstate:null,FLUIDstamp:null,next:null,elem:function(){return this},begin:function(){return this.next},_inuse:null,modified:null,pushmod:null,length:null,setbegin:function(e){this.next=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){e._inuse=!0;var t=e;return t.next=this.begin(),this.next=t,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){t._inuse=!0;var n=t;return null==e?(n.next=this.begin(),this.next=n):(n.next=e.next,e.next=n),this.pushmod=this.modified=!0,this.length++,n},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.next=e.next,e.elem()._inuse=!1,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;return null==e?(n=(t=this.begin()).next,this.next=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0)),t.elem()._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.next=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},freed:null,lazydel:null,free:function(){this.int1=this.int2=null,this.id=this.di=-1,this.freed=!0},alloc:function(){this.freed=!1,this.lazydel=!1,this.COLLISIONstate=1,this.COLLISIONstamp=0,this.SENSORstate=1,this.SENSORstamp=0,this.FLUIDstate=1,this.FLUIDstamp=0},add_arb:function(e){return!this.arbiters.inlined_has(e)&&(this.arbiters.inlined_add(e),!0)},try_remove_arb:function(e){return this.arbiters.inlined_try_remove(e)},remove_arb:function(e){this.arbiters.inlined_remove(e)},empty_arb:function(e){var t;t=!0;for(var n=this.arbiters.begin();null!=n;){if(0!=(n.elem().type&e)){t=!1;break}n=n.next}return t},really_empty:function(){return this.arbiters.empty()},sleeping:function(){var e;e=!0;for(var t=this.arbiters.begin();null!=t;){if(!t.elem().sleeping){e=!1;break}t=t.next}return e},__class__:Eu};var Ou=function(e){this.space=null,(this.cbsets=null)==wc.zpp_pool?this.cbsets=new wc:(this.cbsets=wc.zpp_pool,wc.zpp_pool=this.cbsets.next,this.cbsets.next=null),this.cbsets.alloc(),this.cbsets.lt=np.setlt,this.space=e};(n["zpp_nape.space.ZPP_CbSetManager"]=Ou).__name__=["zpp_nape","space","ZPP_CbSetManager"],Ou.prototype={cbsets:null,space:null,get:function(e){if(e.empty())return null;var t;null==np.zpp_pool?t=new np:(t=np.zpp_pool,np.zpp_pool=t.next,t.next=null),t.alloc();var n=t.cbTypes;t.cbTypes=e;var i,r=this.cbsets.find_weak(t);if(null!=r)i=r.data;else{var a=np.get(e);this.cbsets.insert(a),a.manager=this,i=a}t.cbTypes=n;var s=t;return s.free(),s.next=np.zpp_pool,np.zpp_pool=s,i},remove:function(e){for(this.cbsets.remove(e);!e.cbpairs.empty();){var t=e.cbpairs.pop_unsafe();t.a!=t.b&&(e==t.a?t.b.cbpairs.remove(t):t.a.cbpairs.remove(t));var n=t;n.free(),n.next=ip.zpp_pool,ip.zpp_pool=n}e.manager=null},clear:function(){},validate:function(){if(!this.cbsets.empty()){for(var e=this.cbsets.parent;null!=e.prev;)e=e.prev;for(;null!=e;)if(e.data.validate(),null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}},pair:function(e,t){for(var n=null,i=(e.cbpairs.length<t.cbpairs.length?e.cbpairs:t.cbpairs).begin();null!=i;){var r=i.elem();if(r.a==e&&r.b==t||r.a==t&&r.b==e){n=r;break}i=i.next}return null==n&&(n=ip.get(e,t),e.cbpairs.add(n),t!=e&&t.cbpairs.add(n)),n.validate(),n},valid_listener:function(e){return e.space==this.space},__class__:Ou};var Bu=function(e,t){this.prelisteners=null,this.precb=null,this.continuous=!1,this.toiEvents=null,this.pre_dt=0,this.convexShapeList=null,this.cbsets=null,this.callbackset_list=null,this.callbacks=null,this.wrap_listeners=null,this.listeners=null,this.islands=null,this.staticsleep=null,this.wrap_livecon=null,this.live_constraints=null,this.wrap_live=null,this.live=null,this.wrap_arbiters=null,this.s_arbiters=null,this.f_arbiters=null,this.c_arbiters_false=null,this.c_arbiters_true=null,this.sortcontacts=!1,this.time=0,this.midstep=!1,this.stamp=0,this.global_ang_drag=0,this.global_lin_drag=0,this.__static=null,this.bphase=null,this.kinematics=null,this.wrap_constraints=null,this.constraints=null,this.wrap_compounds=null,this.compounds=null,this.wrap_bodies=null,this.bodies=null,this.wrap_gravity=null,this.gravityy=0,this.gravityx=0,this.userData=null,this.outer=null,this.toiEvents=new ch,this.global_lin_drag=.015,this.global_ang_drag=.015,this.precb=new Ao,this.precb.zpp_inner=new tp,this.sortcontacts=!0,this.pre_dt=0,null==t||t==Y_.get_DYNAMIC_AABB_TREE()?this.bphase=new Tu(this):t==Y_.get_SWEEP_AND_PRUNE()&&(this.bphase=new ju(this)),this.time=0,this.gravityy=null!=e?(this.gravityx=e.x,e.y):this.gravityx=0,this.bodies=new Wu,this.wrap_bodies=ec.get(this.bodies),this.wrap_bodies.zpp_inner.adder=Cc(this,this.bodies_adder),this.wrap_bodies.zpp_inner.subber=Cc(this,this.bodies_subber),this.compounds=new Xu,this.wrap_compounds=nc.get(this.compounds),this.wrap_compounds.zpp_inner.adder=Cc(this,this.compounds_adder),this.wrap_compounds.zpp_inner.subber=Cc(this,this.compounds_subber),this.kinematics=new Wu,this.c_arbiters_true=new uh,this.c_arbiters_false=new uh,this.f_arbiters=new _h,this.s_arbiters=new ph,this.islands=new Au,this.live=new Wu,this.wrap_live=ec.get(this.live,!0),this.staticsleep=new Wu,this.constraints=new lp,this.wrap_constraints=$h.get(this.constraints),this.wrap_constraints.zpp_inner.adder=Cc(this,this.constraints_adder),this.wrap_constraints.zpp_inner.subber=Cc(this,this.constraints_subber),this.live_constraints=new lp,this.wrap_livecon=$h.get(this.live_constraints,!0),this.__static=yu.__static(),(this.__static.zpp_inner.space=this).callbacks=new tp,this.midstep=!1,this.listeners=new hh,this.wrap_listeners=ic.get(this.listeners),this.wrap_listeners.zpp_inner.adder=Cc(this,this.listeners_adder),this.wrap_listeners.zpp_inner.subber=Cc(this,this.listeners_subber),this.callbackset_list=new Eu,this.mrca1=new op,this.mrca2=new op,this.prelisteners=new rp,this.cbsets=new Ou(this)};(n["zpp_nape.space.ZPP_Space"]=Bu).__name__=["zpp_nape","space","ZPP_Space"],Bu.prototype={outer:null,userData:null,gravityx:null,gravityy:null,wrap_gravity:null,getgravity:function(){this.wrap_gravity=y_.get(this.gravityx,this.gravityy),this.wrap_gravity.zpp_inner._inuse=!0,this.wrap_gravity.zpp_inner._invalidate=Cc(this,this.gravity_invalidate),this.wrap_gravity.zpp_inner._validate=Cc(this,this.gravity_validate)},gravity_invalidate:function(e){this.gravityx=e.x,this.gravityy=e.y;for(var t=new Xu,n=this.bodies.begin();null!=n;){var i=n.elem();i.world||(i.component.waket=this.stamp+(this.midstep?0:1),i.isKinematic()&&(i.kinematicDelaySleep=!0),i.component.sleeping&&this.really_wake(i,!1)),n=n.next}for(var r=this.compounds.begin();null!=r;){var a=r.elem();t.add(a),r=r.next}for(;!t.empty();){for(var s=t.pop_unsafe(),l=s.bodies.begin();null!=l;){var o=l.elem();o.world||(o.component.waket=this.stamp+(this.midstep?0:1),o.isKinematic()&&(o.kinematicDelaySleep=!0),o.component.sleeping&&this.really_wake(o,!1)),l=l.next}for(var _=s.compounds.begin();null!=_;){var p=_.elem();t.add(p),_=_.next}}},gravity_validate:function(){this.wrap_gravity.zpp_inner.x=this.gravityx,this.wrap_gravity.zpp_inner.y=this.gravityy},bodies:null,wrap_bodies:null,compounds:null,wrap_compounds:null,constraints:null,wrap_constraints:null,kinematics:null,bphase:null,__static:null,global_lin_drag:null,global_ang_drag:null,stamp:null,midstep:null,time:null,sortcontacts:null,c_arbiters_true:null,c_arbiters_false:null,f_arbiters:null,s_arbiters:null,wrap_arbiters:null,live:null,wrap_live:null,live_constraints:null,wrap_livecon:null,staticsleep:null,islands:null,listeners:null,wrap_listeners:null,callbacks:null,callbackset_list:null,cbsets:null,clear:function(){for(;!this.listeners.empty();){var e=this.listeners.pop_unsafe();this.remListener(e)}for(;!this.callbackset_list.empty();){var t=this.callbackset_list.pop_unsafe();t.arbiters.clear();var n=t;n.free(),n.next=Eu.zpp_pool,Eu.zpp_pool=n}for(;!this.c_arbiters_true.empty();)this.c_arbiters_true.pop_unsafe().retire();for(;!this.c_arbiters_false.empty();)this.c_arbiters_false.pop_unsafe().retire();for(;!this.s_arbiters.empty();)this.s_arbiters.pop_unsafe().retire();for(;!this.f_arbiters.empty();)this.f_arbiters.pop_unsafe().retire();for(this.bphase.clear();!this.bodies.empty();){var i=this.bodies.pop_unsafe();if(null!=i.component){var r=i.component.island;if(null!=r){for(;!r.comps.empty();)r.comps.pop_unsafe().reset();var a=r;a.free(),a.next=Au.zpp_pool,Au.zpp_pool=a}}i.removedFromSpace(),i.space=null}for(;!this.constraints.empty();){var s=this.constraints.pop_unsafe();if(null!=s.component){var l=s.component.island;if(null!=l){for(;!l.comps.empty();)l.comps.pop_unsafe().reset();var o=l;o.free(),o.next=Au.zpp_pool,Au.zpp_pool=o}}s.removedFromSpace(),s.space=null}this.kinematics.clear();for(var _=new Xu;!this.compounds.empty();){var p=this.compounds.pop_unsafe();_.add(p)}for(;!_.empty();){var u=_.pop_unsafe();u.removedFromSpace(),u.space=null;for(var h=u.bodies.begin();null!=h;){var c=h.elem();if(null!=c.component){var d=c.component.island;if(null!=d){for(;!d.comps.empty();)d.comps.pop_unsafe().reset();var m=d;m.free(),m.next=Au.zpp_pool,Au.zpp_pool=m}}c.removedFromSpace(),c.space=null,h=h.next}for(var f=u.constraints.begin();null!=f;){var g=f.elem();if(null!=g.component){var v=g.component.island;if(null!=v){for(;!v.comps.empty();)v.comps.pop_unsafe().reset();var b=v;b.free(),b.next=Au.zpp_pool,Au.zpp_pool=b}}g.removedFromSpace(),g.space=null,f=f.next}for(var y=u.compounds.begin();null!=y;){var x=y.elem();_.add(x),y=y.next}}this.staticsleep.clear(),this.live.clear(),this.live_constraints.clear(),this.stamp=0,this.time=0,this.mrca1.clear(),this.mrca2.clear(),this.prelisteners.clear(),this.cbsets.clear()},bodies_adder:function(e){return e.zpp_inner.space!=this&&(null!=e.zpp_inner.space&&e.zpp_inner.space.outer.get_bodies().remove(e),this.addBody(e.zpp_inner),!0)},bodies_subber:function(e){this.remBody(e.zpp_inner)},compounds_adder:function(e){return e.zpp_inner.space!=this&&(null!=e.zpp_inner.space&&e.zpp_inner.space.wrap_compounds.remove(e),this.addCompound(e.zpp_inner),!0)},compounds_subber:function(e){this.remCompound(e.zpp_inner)},constraints_adder:function(e){return e.zpp_inner.space!=this&&(null!=e.zpp_inner.space&&e.zpp_inner.space.outer.get_constraints().remove(e),this.addConstraint(e.zpp_inner),!0)},constraints_subber:function(e){this.remConstraint(e.zpp_inner)},listeners_adder:function(e){return e.zpp_inner.space!=this&&(null!=e.zpp_inner.space&&e.zpp_inner.space.outer.get_listeners().remove(e),this.addListener(e.zpp_inner),!0)},listeners_subber:function(e){this.remListener(e.zpp_inner)},revoke_listener:function(e){},unrevoke_listener:function(e){},addListener:function(e){e.space=this,e.addedToSpace(),null!=e.interaction&&this.unrevoke_listener(e.interaction)},remListener:function(e){null!=e.interaction&&this.revoke_listener(e.interaction),e.removedFromSpace(),e.space=null},add_callbackset:function(e){e.int1.cbsets.inlined_add(e),e.int2.cbsets.inlined_add(e),this.callbackset_list.inlined_add(e)},remove_callbackset:function(e){e.lazydel=!0,e.int1.cbsets.inlined_remove(e),e.int2.cbsets.inlined_remove(e)},transmitType:function(e,t){var n=e;n.world||(n.component.waket=this.stamp+(this.midstep?0:1),n.isKinematic()&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,!1)),2==e.type?this.live.remove(e):3==e.type?(this.kinematics.remove(e),this.staticsleep.remove(e)):1==e.type&&this.staticsleep.remove(e),e.type=t,3==e.type&&this.kinematics.add(e),1==e.type&&this.static_validation(e),e.component.sleeping=!0;var i=e;i.world||(i.component.waket=this.stamp+(this.midstep?0:1),i.isKinematic()&&(i.kinematicDelaySleep=!0),i.component.sleeping&&this.really_wake(i,!0))},added_shape:function(e,t){if(null==t&&(t=!1),!t){var n=e.body;n.world||(n.component.waket=this.stamp+(this.midstep?0:1),n.isKinematic()&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,!1))}this.bphase.insert(e),e.addedToSpace()},removed_shape:function(e,t){null==t&&(t=!1);var n=this,i=e.body;t||i.wake();for(var r=null,a=i.arbiters.begin();null!=a;){var s=[a.elem()];if(s[0].ws1==e||s[0].ws2==e){if(0!=s[0].present){this.MRCA_chains(s[0].ws1,s[0].ws2);for(var l=this.mrca1.begin();null!=l;){for(var o=l.elem(),_=this.mrca2.begin();null!=_;){var p=_.elem(),u=o.cbSet,h=p.cbSet;if(u.validate(),h.validate(),np.empty_intersection(u,h))_=_.next;else{var c=[bu.get(o,p)];c[0].remove_arb(s[0]),s[0].present--,np.find_all(u,h,1,function(e,t){return function(i){if(0!=(i.itype&t[0].type)&&e[0].empty_arb(i.itype)){var r=n.push_callback(i);r.event=1,bu.int_callback(e[0],i,r),r.set=e[0]}}}(c,s)),c[0].really_empty()&&this.remove_callbackset(c[0]),_=_.next}}l=l.next}}if(s[0].b1!=i&&s[0].b1.isDynamic()){var d=s[0].b1;d.world||(d.component.waket=this.stamp+(this.midstep?0:1),d.isKinematic()&&(d.kinematicDelaySleep=!0),d.component.sleeping&&this.really_wake(d,!1))}if(s[0].b2!=i&&s[0].b2.isDynamic()){var m=s[0].b2;m.world||(m.component.waket=this.stamp+(this.midstep?0:1),m.isKinematic()&&(m.kinematicDelaySleep=!0),m.component.sleeping&&this.really_wake(m,!1))}s[0].lazyRetire(this,i),a=i.arbiters.erase(r)}else a=(r=a).next}this.bphase.remove(e),e.removedFromSpace()},addConstraint:function(e){e.space=this,e.addedToSpace(),e.active&&(e.component.sleeping=!0,this.wake_constraint(e,!0))},remConstraint:function(e){e.active&&(this.wake_constraint(e,!0),this.live_constraints.remove(e)),e.removedFromSpace(),e.space=null},addCompound:function(e){e.space=this,e.addedToSpace();for(var t=e.bodies.begin();null!=t;){var n=t.elem();this.addBody(n),t=t.next}for(var i=e.constraints.begin();null!=i;){var r=i.elem();this.addConstraint(r),i=i.next}for(var a=e.compounds.begin();null!=a;){var s=a.elem();this.addCompound(s),a=a.next}},remCompound:function(e){for(var t=e.bodies.begin();null!=t;){var n=t.elem();this.remBody(n),t=t.next}for(var i=e.constraints.begin();null!=i;){var r=i.elem();this.remConstraint(r),i=i.next}for(var a=e.compounds.begin();null!=a;){var s=a.elem();this.remCompound(s),a=a.next}e.removedFromSpace(),e.space=null},addBody:function(e,t){null==t&&(t=-1),e.space=this,e.addedToSpace(),e.component.sleeping=!0;var n=e;n.world||(n.component.waket=this.stamp+(this.midstep?0:1),n.isKinematic()&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,!0));for(var i=e.shapes.begin();null!=i;){var r=i.elem();this.added_shape(r,!0),i=i.next}e.isStatic()?this.static_validation(e):e.isDynamic()||3!=t&&this.kinematics.add(e)},remBody:function(e,t){if(null==t&&(t=-1),e.isStatic()){var n=e;n.world||(n.component.waket=this.stamp+(this.midstep?0:1),n.isKinematic()&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,!0)),this.staticsleep.remove(e)}else if(e.isDynamic()){var i=e;i.world||(i.component.waket=this.stamp+(this.midstep?0:1),i.isKinematic()&&(i.kinematicDelaySleep=!0),i.component.sleeping&&this.really_wake(i,!0)),this.live.remove(e)}else{3!=t&&this.kinematics.remove(e);var r=e;r.world||(r.component.waket=this.stamp+(this.midstep?0:1),r.isKinematic()&&(r.kinematicDelaySleep=!0),r.component.sleeping&&this.really_wake(r,!0)),this.staticsleep.remove(e)}for(var a=e.shapes.begin();null!=a;){var s=a.elem();this.removed_shape(s,!0),a=a.next}e.removedFromSpace(),e.space=null},shapesUnderPoint:function(e,t,n,i){return this.bphase.shapesUnderPoint(e,t,n,i)},bodiesUnderPoint:function(e,t,n,i){return this.bphase.bodiesUnderPoint(e,t,n,i)},shapesInAABB:function(e,t,n,i,r){return this.bphase.shapesInAABB(e.zpp_inner,t,n,i,r)},bodiesInAABB:function(e,t,n,i,r){return this.bphase.bodiesInAABB(e.zpp_inner,t,n,i,r)},shapesInCircle:function(e,t,n,i,r){return this.bphase.shapesInCircle(e.get_x(),e.get_y(),t,n,i,r)},bodiesInCircle:function(e,t,n,i,r){return this.bphase.bodiesInCircle(e.get_x(),e.get_y(),t,n,i,r)},shapesInShape:function(e,t,n,i){return this.bphase.shapesInShape(e,t,n,i)},bodiesInShape:function(e,t,n,i){return this.bphase.bodiesInShape(e,t,n,i)},rayCast:function(e,t,n){return this.bphase.rayCast(e.zpp_inner,t,null==n?null:n.zpp_inner)},rayMultiCast:function(e,t,n,i){return this.bphase.rayMultiCast(e.zpp_inner,t,null==n?null:n.zpp_inner,i)},convexShapeList:null,convexCast:function(e,t,n,i){var r;null==hu.zpp_pool?r=new hu:(r=hu.zpp_pool,hu.zpp_pool=r.next,r.next=null),r.alloc(),this.prepareCast(e);var a=e.body,s=a.posx,l=a.posy;a.sweepTime=0,a.sweep_angvel=a.angvel,a.sweepIntegrate(t);var o=a.posx,_=a.posy;e.validate_sweepRadius();var p,u=e.sweepRadius;null==Lp.zpp_pool?p=new Lp:(p=Lp.zpp_pool,Lp.zpp_pool=p.next,p.next=null),p.alloc();var h=s,c=o;p.minx=(h<c?h:c)-u;var d=s,m=o;p.maxx=(m<d?d:m)+u;var f=l,g=_;p.miny=(f<g?f:g)-u;var v=l,b=_;p.maxy=(b<v?v:b)+u;var y=this.convexShapeList=this.bphase.shapesInAABB(p,!1,!1,null==n?null:n.zpp_inner,this.convexShapeList),x=p;x.free(),x.next=Lp.zpp_pool,Lp.zpp_pool=x;var z=0,w=0,k=w=z=0,S=0;S=k=0;for(var C=null,N=t+1,P=y.iterator();P.hasNext();){var M=P.next();M!=e.outer&&M.get_body()!=a.outer&&(r.s1=e,r.s2=M.zpp_inner,i?(M.zpp_inner.validate_sweepRadius(),M.get_body().zpp_inner.sweep_angvel=M.get_body().zpp_inner.angvel,M.get_body().zpp_inner.sweepTime=0,cu.dynamicSweep(r,t,0,0,!0),M.get_body().zpp_inner.sweepIntegrate(0),M.get_body().zpp_inner.sweepValidate(M.zpp_inner)):cu.staticSweep(r,t,0,0),r.toi*=t,0<r.toi&&r.toi<N&&(N=r.toi,z=r.axis.x,w=r.axis.y,k=r.c2.x,S=r.c2.y,C=M))}y.clear();var I=r;return I.free(),I.next=hu.zpp_pool,hu.zpp_pool=I,a.sweepIntegrate(0),a.sweepValidate(e),N<=t?Gp.getConvex(y_.get(-z,-w),y_.get(k,S),N,C):null},prepareCast:function(e){e.isCircle()?e.circle.validate_worldCOM():e.polygon.validate_gaxi()},convexMultiCast:function(e,t,n,i,r){var a;null==hu.zpp_pool?a=new hu:(a=hu.zpp_pool,hu.zpp_pool=a.next,a.next=null),a.alloc(),this.prepareCast(e);var s=e.body,l=s.posx,o=s.posy;s.sweepTime=0,s.sweep_angvel=s.angvel,s.sweepIntegrate(t);var _=s.posx,p=s.posy;e.validate_sweepRadius();var u,h=e.sweepRadius;null==Lp.zpp_pool?u=new Lp:(u=Lp.zpp_pool,Lp.zpp_pool=u.next,u.next=null),u.alloc();var c=l,d=_;u.minx=(c<d?c:d)-h;var m=l,f=_;u.maxx=(f<m?m:f)+h;var g=o,v=p;u.miny=(g<v?g:v)-h;var b=o,y=p;u.maxy=(y<b?b:y)+h;var x=this.convexShapeList=this.bphase.shapesInAABB(u,!1,!1,null==n?null:n.zpp_inner,this.convexShapeList),z=u;z.free(),z.next=Lp.zpp_pool,Lp.zpp_pool=z;for(var w=null==r?new l_:r,k=x.iterator();k.hasNext();){var S=k.next();if(S!=e.outer&&S.get_body()!=s.outer&&(a.s1=e,a.s2=S.zpp_inner,i?(S.zpp_inner.validate_sweepRadius(),S.get_body().zpp_inner.sweep_angvel=S.get_body().zpp_inner.angvel,S.get_body().zpp_inner.sweepTime=0,cu.dynamicSweep(a,t,0,0,!0),S.get_body().zpp_inner.sweepIntegrate(0),S.get_body().zpp_inner.sweepValidate(S.zpp_inner)):cu.staticSweep(a,t,0,0),a.toi*=t,0<a.toi)){for(var C=Gp.getConvex(y_.get(-a.axis.x,-a.axis.y),y_.get(a.c2.x,a.c2.y),a.toi,S),N=null,P=w.zpp_inner.inner.begin();null!=P;){var M=P.elem();if(C.get_toi()<M.get_toi())break;P=(N=P).next}w.zpp_inner.inner.inlined_insert(N,C)}}x.clear();var I=a;return I.free(),I.next=hu.zpp_pool,hu.zpp_pool=I,s.sweepIntegrate(0),s.sweepValidate(e),w},push_callback:function(e){var t;return null==tp.zpp_pool?t=new tp:(t=tp.zpp_pool,tp.zpp_pool=t.next,t.next=null),t.alloc(),this.callbacks.push(t),t.listener=e,t},pre_dt:null,step:function(e,t,n){var i=this;if(this.time+=e,this.pre_dt=e,this.midstep=!0,this.stamp++,this.validation(),this.bphase.broadphase(this,!0),this.prestep(e),this.sortcontacts){var r=this.c_arbiters_false;if(!r.empty()&&null!=r.begin().next){for(var a,s,l,o=r.begin(),_=null,p=null,u=null,h=null,c=1;;){for(a=0,p=o,_=o=null;null!=p;){for(++a,u=p,s=0,l=c;null!=u&&s<c;)++s,u=u.next;for(;0<s||0<l&&null!=u;)0==s?(u=(h=u).next,--l):0==l||null==u?(p=(h=p).next,--s):!p.elem().active||!u.elem().active||p.elem().oc1.dist<u.elem().oc1.dist?(p=(h=p).next,--s):(u=(h=u).next,--l),null!=_?_.next=h:o=h,_=h;p=u}if(_.next=null,c<<=1,!(1<a))break}r.setbegin(o)}}this.updateVel(e),this.warmStart(),this.iterateVel(t);for(var d=this.kinematics.begin();null!=d;){var m=d.elem();m.pre_posx=m.posx,m.pre_posy=m.posy,m.pre_rot=m.rot,d=d.next}for(var f=this.live.begin();null!=f;){var g=f.elem();g.pre_posx=g.posx,g.pre_posy=g.posy,g.pre_rot=g.rot,f=f.next}this.updatePos(e),this.continuous=!0,this.continuousCollisions(e),this.continuous=!1,this.iteratePos(n);for(var v=this.kinematics.begin();null!=v;){var b=v.elem(),y=!(b.posx==b.pre_posx&&b.posy==b.pre_posy),x=b.pre_rot!=b.rot;y&&b.invalidate_pos(),x&&b.invalidate_rot(),v=v.next}for(var z=this.live.begin();null!=z;){var w=z.elem(),k=!(w.posx==w.pre_posx&&w.posy==w.pre_posy),S=w.pre_rot!=w.rot;k&&w.invalidate_pos(),S&&w.invalidate_rot(),z=z.next}for(var C=null,N=this.staticsleep.begin();null!=N;){var P=N.elem();if(!P.isKinematic()||0==P.velx&&0==P.vely&&0==P.angvel){if(P.kinematicDelaySleep){P.kinematicDelaySleep=!1,N=N.next;continue}P.component.sleeping=!0,N=this.staticsleep.inlined_erase(C)}else N=(C=N).next}this.doForests(e),this.sleepArbiters(),this.midstep=!1;for(var M=null,I=this.callbackset_list.begin();null!=I;){var T=[I.elem()];if(T[0].really_empty()){I=this.callbackset_list.inlined_erase(M);var A=T[0];A.free(),A.next=Eu.zpp_pool,Eu.zpp_pool=A}else{var D=[T[0].sleeping()];np.find_all(T[0].int1.cbSet,T[0].int2.cbSet,6,function(e,t){return function(n){if((!e[0]||n.allowSleepingCallbacks)&&!t[0].empty_arb(n.itype)){var r=i.push_callback(n);r.event=6,bu.int_callback(t[0],n,r),r.set=t[0]}}}(D,T)),I=(M=I).next}}for(;!this.callbacks.empty();){var E=this.callbacks.pop();0==E.listener.type?E.listener.body.handler(E.wrapper_body()):1==E.listener.type?E.listener.constraint.handler(E.wrapper_con()):2==E.listener.type&&E.listener.interaction.handleri(E.wrapper_int());var O=E;O.free(),O.next=tp.zpp_pool,tp.zpp_pool=O}},toiEvents:null,continuousCollisions:function(e){var t=2*Math.PI/e;this.bphase.broadphase(this,!1);for(var n=0;n<1&&!this.toiEvents.empty();){for(var i=null,r=2,a=!1,s=null,l=null,o=this.toiEvents.begin();null!=o;){var _=o.elem(),p=_.s1.body,u=_.s2.body;if(p.sweepFrozen&&u.sweepFrozen){if(0==_.toi||!Fp.testCollide_safe(_.s1,_.s2)){o=this.toiEvents.erase(l);var h=_;h.free(),h.next=hu.zpp_pool,hu.zpp_pool=h;continue}_.toi=0}if(_.frozen1!=p.sweepFrozen||_.frozen2!=u.sweepFrozen){if(_.kinematic){o=this.toiEvents.erase(l);var c=_;c.free(),c.next=hu.zpp_pool,hu.zpp_pool=c;continue}if(_.frozen1=p.sweepFrozen,_.frozen2=u.sweepFrozen,_.frozen1){var d=_.s1;_.s1=_.s2,_.s2=d,_.frozen1=!1,_.frozen2=!0}if(cu.staticSweep(_,e,0,co.collisionSlopCCD),_.toi<0){o=this.toiEvents.erase(l);var m=_;m.free(),m.next=hu.zpp_pool,hu.zpp_pool=m;continue}}0<=_.toi&&(_.toi<r||!a&&_.kinematic)&&(r=(i=_).toi,a=_.kinematic,s=l),o=(l=o).next}if(null==i)break;this.toiEvents.erase(s),n=i.toi;var f=i.s1.body,g=i.s2.body;f.sweepFrozen||(f.sweepIntegrate(n*e),f.sweepValidate(i.s1)),g.sweepFrozen||(g.sweepIntegrate(n*e),g.sweepValidate(i.s2)),i.arbiter;var v=this.narrowPhase(i.s1,i.s2,!0,i.arbiter,!0);if(null==v?null!=i.arbiter&&null!=i.arbiter.pair&&(i.arbiter.pair.arb=null,i.arbiter.pair=null):this.presteparb(v,e,!0)||v.type==Mp.COL&&v.acting()&&(v.colarb.warmStart(),v.colarb.applyImpulseVel(),v.colarb.applyImpulseVel(),v.colarb.applyImpulseVel(),v.colarb.applyImpulseVel(),f.sweep_angvel=f.angvel%t,g.sweep_angvel=g.angvel%t),null!=v&&v.acting()&&v.type==Mp.COL){if(!f.sweepFrozen&&!f.isKinematic())if(f.sweepFrozen=!0,i.failed)f.angvel=f.sweep_angvel=0;else if(i.slipped){var b=f;b.sweep_angvel*=co.angularCCDSlipScale,f.angvel=b.sweep_angvel}else f.angvel=f.sweep_angvel;if(!g.sweepFrozen&&!g.isKinematic())if(g.sweepFrozen=!0,i.failed)g.angvel=g.sweep_angvel=0;else if(i.slipped){var y=g;y.sweep_angvel*=co.angularCCDSlipScale,g.angvel=y.sweep_angvel}else g.angvel=g.sweep_angvel}var x=i;x.free(),x.next=hu.zpp_pool,hu.zpp_pool=x}for(;!this.toiEvents.empty();){var z=this.toiEvents.pop_unsafe();z.free(),z.next=hu.zpp_pool,hu.zpp_pool=z}for(var w=this.kinematics.begin();null!=w;){var k=w.elem();k.sweepIntegrate(e),k.sweepTime=0,w=w.next}for(var S=this.live.begin();null!=S;){var C=S.elem();C.sweepFrozen||C.sweepIntegrate(e),C.sweepTime=0,S=S.next}},continuousEvent:function(e,t,n,i,r){if(e.body.sweepFrozen&&t.body.sweepFrozen)return i;if(e.body.disableCCD||t.body.disableCCD)return i;if(null!=i&&null==i.colarb||this.interactionType(e,t,e.body,t.body)<=0)return i;var a=e.body,s=t.body;if(n||a.bullet||s.bullet){var l;null==hu.zpp_pool?l=new hu:(l=hu.zpp_pool,hu.zpp_pool=l.next,l.next=null),l.alloc();var o=a.isKinematic()||s.isKinematic();if(n&&!o)e.body.isDynamic()?(l.s1=e,l.s2=t):(l.s2=e,l.s1=t),l.kinematic=!1,cu.staticSweep(l,this.pre_dt,0,co.collisionSlopCCD);else if(l.s1=e,l.s2=t,l.kinematic=o,l.s1.body.sweepFrozen||l.s2.body.sweepFrozen){if(l.s1.body.sweepFrozen){var _=l.s1;l.s1=l.s2,l.s2=_,l.frozen1=!1,l.frozen2=!0}cu.staticSweep(l,this.pre_dt,0,co.collisionSlopCCD)}else cu.dynamicSweep(l,this.pre_dt,0,co.collisionSlopCCD);if(n&&l.toi<0||l.failed){var p=l;p.free(),p.next=hu.zpp_pool,hu.zpp_pool=p}else this.toiEvents.add(l),l.frozen1=l.s1.body.sweepFrozen,l.frozen2=l.s2.body.sweepFrozen,l.arbiter=null!=i?i.colarb:null}return i},bodyCbWake:function(e){if(e.isDynamic()&&null!=e.cbSet)if(this.midstep)for(var t=e.cbSet.bodylisteners.begin();null!=t;){var n=t.elem();if(2==n.event){var i=this.push_callback(n);i.event=2,i.body=e,t=t.next}else t=t.next}else e.component.woken=!0},bodyCbSleep:function(e){if(e.isDynamic()&&null!=e.cbSet)for(var t=e.cbSet.bodylisteners.begin();null!=t;){var n=t.elem();if(3==n.event){var i=this.push_callback(n);i.event=3,i.body=e,t=t.next}else t=t.next}},constraintCbWake:function(e){if(null!=e.cbSet)if(this.midstep)for(var t=e.cbSet.conlisteners.begin();null!=t;){var n=t.elem();if(2==n.event){var i=this.push_callback(n);i.event=2,i.constraint=e,t=t.next}else t=t.next}else e.component.woken=!0},constraintCbSleep:function(e){if(null!=e.cbSet)for(var t=e.cbSet.conlisteners.begin();null!=t;){var n=t.elem();if(3==n.event){var i=this.push_callback(n);i.event=3,i.constraint=e,t=t.next}else t=t.next}},constraintCbBreak:function(e){if(null!=e.cbSet)for(var t=e.cbSet.conlisteners.begin();null!=t;){var n=t.elem();if(4==n.event){var i=this.push_callback(n);i.event=4,i.constraint=e,t=t.next}else t=t.next}},nullListenerType:function(e,t){for(var n=new op,i=e.interactors.begin();null!=i;){var r=i.elem();n.add(r),i=i.next}if(e!=t)for(var a=t.interactors.begin();null!=a;){var s=a.elem();n.add(s),a=a.next}for(;!n.empty();){var l=n.pop_unsafe();if(l.isCompound()){for(var o=l.icompound,_=o.bodies.begin();null!=_;){var p=_.elem();n.add(p),_=_.next}for(var u=o.compounds.begin();null!=u;){var h=u.elem();n.add(h),u=u.next}}else for(var c=l.isBody()?l.ibody:l.ishape.body,d=l.isShape()?l.ishape:null,m=c.arbiters.begin();null!=m;){var f=m.elem();if(0!=f.present)if(null==d||f.ws1==d||f.ws2==d){this.MRCA_chains(f.ws1,f.ws2);for(var g=this.mrca1.begin();null!=g;){var v=g.elem();if(v.cbSet==e||v.cbSet==t){for(var b=this.mrca2.begin();null!=b;){var y=b.elem();if(v.cbSet==e&&y.cbSet!=t||v.cbSet==t&&y.cbSet!=e)b=b.next;else{var x=bu.get(v,y);if(null!=x){for(;!x.arbiters.empty();)x.arbiters.pop_unsafe().present--;this.remove_callbackset(x)}b=b.next}}g=g.next}else g=g.next}m=m.next}else m=m.next;else m=m.next}}},nullInteractorType:function(e,t){if(null==t&&(t=e),e.isCompound()){for(var n=e.icompound,i=n.bodies.begin();null!=i;){var r=i.elem();this.nullInteractorType(r,t),i=i.next}for(var a=n.compounds.begin();null!=a;){var s=a.elem();this.nullInteractorType(s,t),a=a.next}}else for(var l=e.isBody()?e.ibody:e.ishape.body,o=e.isShape()?e.ishape:null,_=l.arbiters.begin();null!=_;){var p=_.elem();if(0!=p.present)if(null==o||p.ws1==o||p.ws2==o){this.MRCA_chains(p.ws1,p.ws2);for(var u=this.mrca1.begin();null!=u;){for(var h=u.elem(),c=this.mrca2.begin();null!=c;){var d=c.elem();if(h==t||d==t){var m=bu.get(h,d);null!=m&&(p.present--,m.remove_arb(p),m.really_empty()&&this.remove_callbackset(m)),c=c.next}else c=c.next}u=u.next}_=_.next}else _=_.next;else _=_.next}},freshListenerType:function(e,t){for(var n=new op,i=e.interactors.begin();null!=i;){var r=i.elem();n.add(r),i=i.next}if(e!=t)for(var a=t.interactors.begin();null!=a;){var s=a.elem();n.add(s),a=a.next}for(;!n.empty();){var l=n.pop_unsafe();if(l.isCompound()){for(var o=l.icompound,_=o.bodies.begin();null!=_;){var p=_.elem();n.add(p),_=_.next}for(var u=o.compounds.begin();null!=u;){var h=u.elem();n.add(h),u=u.next}}else for(var c=l.isBody()?l.ibody:l.ishape.body,d=l.isShape()?l.ishape:null,m=c.arbiters.begin();null!=m;){var f=m.elem();if(f.presentable)if(null==d||f.ws1==d||f.ws2==d){this.MRCA_chains(f.ws1,f.ws2);for(var g=this.mrca1.begin();null!=g;){var v=g.elem();if(v.cbSet==e||v.cbSet==t){for(var b=this.mrca2.begin();null!=b;){var y=b.elem();if(v.cbSet==e&&y.cbSet!=t||v.cbSet==t&&y.cbSet!=e)b=b.next;else{var x=bu.get(v,y);null==x&&(x=Eu.get(v,y),this.add_callbackset(x)),x.add_arb(f)&&f.present++,b=b.next}}g=g.next}else g=g.next}m=m.next}else m=m.next;else m=m.next}}},freshInteractorType:function(e,t){if(null==t&&(t=e),e.isCompound()){for(var n=e.icompound,i=n.bodies.begin();null!=i;){var r=i.elem();this.freshInteractorType(r,t),i=i.next}for(var a=n.compounds.begin();null!=a;){var s=a.elem();this.freshInteractorType(s,t),a=a.next}}else for(var l=e.isBody()?e.ibody:e.ishape.body,o=e.isShape()?e.ishape:null,_=l.arbiters.begin();null!=_;){var p=_.elem();if(p.presentable)if(null==o||p.ws1==o||p.ws2==o){this.MRCA_chains(p.ws1,p.ws2);for(var u=this.mrca1.begin();null!=u;){for(var h=u.elem(),c=this.mrca2.begin();null!=c;){var d=c.elem();if(h==t||d==t){var m=h.cbSet,f=d.cbSet;if(m.validate(),f.validate(),!np.empty_intersection(m,f)){var g=bu.get(h,d);null==g&&(g=Eu.get(h,d),this.add_callbackset(g)),g.add_arb(p)&&p.present++}c=c.next}else c=c.next}u=u.next}_=_.next}else _=_.next;else _=_.next}},wakeCompound:function(e){for(var t=e.bodies.begin();null!=t;){var n=t.elem();n.world||(n.component.waket=this.stamp+(this.midstep?0:1),n.isKinematic()&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,!1)),t=t.next}for(var i=e.constraints.begin();null!=i;){var r=i.elem();this.wake_constraint(r),i=i.next}for(var a=e.compounds.begin();null!=a;){var s=a.elem();this.wakeCompound(s),a=a.next}},wakeIsland:function(e){for(;!e.comps.empty();){var t=e.comps.pop_unsafe();if(t.waket=this.stamp+(this.midstep?0:1),t.isBody){var n=t.body;this.live.add(n);for(var i=n.arbiters.begin();null!=i;){var r=i.elem();if(r.sleeping)if(r.sleeping=!1,r.up_stamp+=this.stamp-r.sleep_stamp,r.type==Mp.COL){var a=r.colarb;a.stat?this.c_arbiters_true.inlined_add(a):this.c_arbiters_false.inlined_add(a)}else r.type==Mp.FLUID?this.f_arbiters.inlined_add(r.fluidarb):this.s_arbiters.inlined_add(r.sensorarb);i=i.next}if(this.bodyCbWake(n),t.reset(),!n.isStatic())for(var s=n.shapes.begin();null!=s;){var l=s.elem();null!=l.node&&this.bphase.sync(l),s=s.next}}else{var o=t.constraint;this.live_constraints.inlined_add(o),this.constraintCbWake(o),t.reset()}}var _=e;_.free(),_.next=Au.zpp_pool,Au.zpp_pool=_},non_inlined_wake:function(e,t){null==t&&(t=!1);var n=e;n.world||(n.component.waket=this.stamp+(this.midstep?0:1),n.isKinematic()&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,t))},really_wake:function(e,t){if(null==t&&(t=!1),null==e.component.island){e.component.sleeping=!1,e.isKinematic()||e.isStatic()?this.staticsleep.inlined_add(e):this.live.inlined_add(e);for(var n=e.constraints.begin();null!=n;){var i=n.elem();i.space==this&&this.wake_constraint(i),n=n.next}for(var r=e.arbiters.begin();null!=r;){var a=r.elem();if(a.sleeping)if(a.sleeping=!1,a.up_stamp+=this.stamp+(this.midstep?0:1)-a.sleep_stamp,a.type==Mp.COL){var s=a.colarb;s.stat?this.c_arbiters_true.inlined_add(s):this.c_arbiters_false.inlined_add(s)}else a.type==Mp.FLUID?this.f_arbiters.inlined_add(a.fluidarb):this.s_arbiters.inlined_add(a.sensorarb);if(a.type!=Mp.SENSOR&&!a.cleared&&a.up_stamp>=this.stamp&&0!=(1&a.immState)){if(a.b1.isDynamic()&&a.b1.component.sleeping){var l=a.b1;l.world||(l.component.waket=this.stamp+(this.midstep?0:1),l.isKinematic()&&(l.kinematicDelaySleep=!0),l.component.sleeping&&this.really_wake(l,!1))}if(a.b2.isDynamic()&&a.b2.component.sleeping){var o=a.b2;o.world||(o.component.waket=this.stamp+(this.midstep?0:1),o.isKinematic()&&(o.kinematicDelaySleep=!0),o.component.sleeping&&this.really_wake(o,!1))}}r=r.next}if(!t&&e.isDynamic()&&this.bodyCbWake(e),!t&&!this.bphase.is_sweep&&!e.isStatic())for(var _=e.shapes.begin();null!=_;){var p=_.elem();null!=p.node&&this.bphase.sync(p),_=_.next}}else this.wakeIsland(e.component.island)},wake_constraint:function(e,t){return null==t&&(t=!1),!!e.active&&(e.component.waket=this.stamp+(this.midstep?0:1),!!e.component.sleeping&&(null==e.component.island?(e.component.sleeping=!1,this.live_constraints.inlined_add(e),e.wake_connected(),t||this.constraintCbWake(e)):this.wakeIsland(e.component.island),!0))},doForests:function(e){for(var t=this.c_arbiters_false.begin();null!=t;){var n=t.elem();if(!n.cleared&&n.up_stamp==this.stamp&&0!=(1&n.immState)&&n.b1.isDynamic()&&n.b2.isDynamic()){var i,r;if(n.b1.component==n.b1.component.parent)i=n.b1.component;else{for(var a=n.b1.component,s=null;a!=a.parent;){var l=a.parent;a.parent=s,s=a,a=l}for(;null!=s;){var o=s.parent;s.parent=a,s=o}i=a}if(n.b2.component==n.b2.component.parent)r=n.b2.component;else{for(var _=n.b2.component,p=null;_!=_.parent;){var u=_.parent;_.parent=p,p=_,_=u}for(;null!=p;){var h=p.parent;p.parent=_,p=h}r=_}i!=r&&(i.rank<r.rank?i.parent=r:i.rank>r.rank?r.parent=i:(r.parent=i).rank++)}t=t.next}for(var c=this.f_arbiters.begin();null!=c;){var d=c.elem();if(!d.cleared&&d.up_stamp==this.stamp&&0!=(1&d.immState)&&d.b1.isDynamic()&&d.b2.isDynamic()){var m,f;if(d.b1.component==d.b1.component.parent)m=d.b1.component;else{for(var g=d.b1.component,v=null;g!=g.parent;){var b=g.parent;g.parent=v,v=g,g=b}for(;null!=v;){var y=v.parent;v.parent=g,v=y}m=g}if(d.b2.component==d.b2.component.parent)f=d.b2.component;else{for(var x=d.b2.component,z=null;x!=x.parent;){var w=x.parent;x.parent=z,z=x,x=w}for(;null!=z;){var k=z.parent;z.parent=x,z=k}f=x}m!=f&&(m.rank<f.rank?m.parent=f:m.rank>f.rank?f.parent=m:(f.parent=m).rank++)}c=c.next}for(var S=this.live_constraints.begin();null!=S;)S.elem().forest(),S=S.next;for(;!this.live.empty();){var C,N=this.live.inlined_pop_unsafe(),P=N.component;if(P==P.parent)C=P;else{for(var M=P,I=null;M!=M.parent;){var T=M.parent;M.parent=I,I=M,M=T}for(;null!=I;){var A=I.parent;I.parent=M,I=A}C=M}null==C.island&&(null==Au.zpp_pool?C.island=new Au:(C.island=Au.zpp_pool,Au.zpp_pool=C.island.next,C.island.next=null),C.island.alloc(),this.islands.inlined_add(C.island),C.island.sleep=!0),P.island=C.island,P.island.comps.inlined_add(P);var D=N.atRest(e);P.island.sleep=P.island.sleep&&D,P.waket>P.island.waket&&(P.island.waket=P.waket)}for(;!this.live_constraints.empty();){var E,O=this.live_constraints.inlined_pop_unsafe().component;if(O==O.parent)E=O;else{for(var B=O,L=null;B!=B.parent;){var j=B.parent;B.parent=L,L=B,B=j}for(;null!=L;){var F=L.parent;L.parent=B,L=F}E=B}O.island=E.island,O.island.comps.inlined_add(O),O.waket>O.island.waket&&(O.island.waket=O.waket)}for(;!this.islands.empty();){var R=this.islands.inlined_pop_unsafe();if(R.sleep)for(var G=R.comps.begin();null!=G;){var Z=G.elem();if(Z.isBody){var U=Z.body;U.velx=0,U.vely=0,U.angvel=0,Z.sleeping=!0;for(var V=U.shapes.begin();null!=V;){var q=V.elem();this.bphase.sync(q),V=V.next}this.bodyCbSleep(U)}else{var W=Z.constraint;this.constraintCbSleep(W),Z.sleeping=!0}G=G.next}else{for(;!R.comps.empty();){var X=R.comps.inlined_pop_unsafe();X.waket=R.waket,X.isBody?this.live.inlined_add(X.body):this.live_constraints.inlined_add(X.constraint),X.reset()}var H=R;H.free(),H.next=Au.zpp_pool,Au.zpp_pool=H}}},sleepArbiters:function(){var e=null,t=this.c_arbiters_true,n=t.begin(),i=null!=this.c_arbiters_false;for(i&&null==n&&(i=!1,n=this.c_arbiters_false.begin(),t=this.c_arbiters_false,e=null);null!=n;){var r=n.elem();r.b1.component.sleeping&&r.b2.component.sleeping?(r.sleep_stamp=this.stamp,r.sleeping=!0,n=t.inlined_erase(e),i&&null==n&&(i=!1,n=this.c_arbiters_false.begin(),t=this.c_arbiters_false,e=null)):(n=(e=n).next,i&&null==n&&(i=!1,n=this.c_arbiters_false.begin(),t=this.c_arbiters_false,e=null))}var a=null,s=this.f_arbiters,l=s.begin(),o=!1;for(o&&null==l&&(o=!1,a=s=null);null!=l;){var _=l.elem();_.b1.component.sleeping&&_.b2.component.sleeping?(_.sleep_stamp=this.stamp,_.sleeping=!0,l=s.inlined_erase(a),o&&null==l&&(o=!1,a=s=null)):(l=(a=l).next,o&&null==l&&(o=!1,a=s=null))}var p=null,u=this.s_arbiters,h=u.begin(),c=!1;for(c&&null==h&&(c=!1,p=u=null);null!=h;){var d=h.elem();d.b1.component.sleeping&&d.b2.component.sleeping?(d.sleep_stamp=this.stamp,d.sleeping=!0,h=u.inlined_erase(p),c&&null==h&&(c=!1,p=u=null)):(h=(p=h).next,c&&null==h&&(c=!1,p=u=null))}},static_validation:function(e){e.shapes.empty()||e.validate_aabb(),e.validate_mass(),e.validate_inertia();for(var t=e.shapes.begin();null!=t;){var n=t.elem();n.isPolygon()&&(n.polygon.splice_collinear(),n.polygon.validate_gaxi()),t=t.next}e.sweepFrozen=!0},validation:function(){this.cbsets.validate();for(var e=this.live.begin();null!=e;){var t=e.elem();t.sweepRadius=0;for(var n=t.shapes.begin();null!=n;){var i=n.elem();i.isPolygon()&&(i.polygon.splice_collinear(),i.polygon.validate_gaxi()),i.validate_sweepRadius(),i.sweepRadius>t.sweepRadius&&(t.sweepRadius=i.sweepRadius),n=n.next}if(t.validate_mass(),t.validate_inertia(),t.shapes.empty()||(t.validate_aabb(),t.validate_worldCOM()),t.validate_gravMass(),t.validate_axis(),t.component.woken&&null!=t.cbSet)for(var r=t.cbSet.bodylisteners.begin();null!=r;){var a=r.elem();if(2==a.event){var s=this.push_callback(a);s.event=2,s.body=t,r=r.next}else r=r.next}t.component.woken=!1;for(var l=t.shapes.begin();null!=l;){var o=l.elem();this.bphase.sync(o),l=l.next}e=e.next}for(var _=this.kinematics.begin();null!=_;){var p=_.elem();p.sweepRadius=0;for(var u=p.shapes.begin();null!=u;){var h=u.elem();h.isPolygon()&&(h.polygon.splice_collinear(),h.polygon.validate_gaxi()),h.validate_sweepRadius(),h.sweepRadius>p.sweepRadius&&(p.sweepRadius=h.sweepRadius),u=u.next}p.validate_mass(),p.validate_inertia(),p.shapes.empty()||(p.validate_aabb(),p.validate_worldCOM()),p.validate_gravMass(),p.validate_axis();for(var c=p.shapes.begin();null!=c;){var d=c.elem();this.bphase.sync(d),c=c.next}_=_.next}for(var m=this.live_constraints.begin();null!=m;){var f=m.elem();if(f.active){if(f.component.woken&&null!=f.cbSet)for(var g=f.cbSet.conlisteners.begin();null!=g;){var v=g.elem();if(2==v.event){var b=this.push_callback(v);b.event=2,b.constraint=f,g=g.next}else g=g.next}f.component.woken=!1}m=m.next}},updateVel:function(e){for(var t=1-e*this.global_lin_drag,n=1-e*this.global_ang_drag,i=this.live.begin();null!=i;){var r=i.elem();if(0!=r.smass){var a=e*r.imass;r.velx=t*r.velx+(r.forcex+this.gravityx*r.gravMass)*a,r.vely=t*r.vely+(r.forcey+this.gravityy*r.gravMass)*a}if(0!=r.sinertia){var s,l;s=r.worldCOMx-r.posx,l=r.worldCOMy-r.posy;var o=r.torque+(this.gravityy*s-this.gravityx*l)*r.gravMass;r.angvel=n*r.angvel+o*e*r.iinertia}i=i.next}},updatePos:function(e){for(var t=2*Math.PI/e,n=this.live.begin();null!=n;){var i=n.elem();if(i.pre_posx=i.posx,i.pre_posy=i.posy,i.pre_rot=i.rot,i.sweepTime=0,i.sweep_angvel=i.angvel%t,i.sweepIntegrate(e),i.disableCCD)i.sweepFrozen=!0,i.bullet=!1;else{var r=co.staticCCDLinearThreshold*i.sweepRadius,a=co.staticCCDAngularThreshold;if((i.velx*i.velx+i.vely*i.vely)*e*e>r*r||i.angvel*i.angvel*e*e>a*a||i.isKinematic()){var s=i.sweep_angvel;s<0&&(s=-s);for(var l=1/s,o=i.shapes.begin();null!=o;){var _=o.elem(),u=_.aabb,h=u.minx,c=u.miny,d=u.maxx,m=u.maxy,f=p.int(s*e*_.sweepCoef*.008333333333333333);8<f&&(f=8);var g=s*e/f;i.sweepIntegrate(e),_.force_validate_aabb(),h<u.minx?u.minx=h:h=u.minx,c<u.miny?u.miny=c:c=u.miny,d>u.maxx?u.maxx=d:d=u.maxx,m>u.maxy?u.maxy=m:m=u.maxy;for(var v=1,b=f;v<b;){var y=v++;i.sweepIntegrate(g*y*l),_.force_validate_aabb(),h<u.minx?u.minx=h:h=u.minx,c<u.miny?u.miny=c:c=u.miny,d>u.maxx?u.maxx=d:d=u.maxx,m>u.maxy?u.maxy=m:m=u.maxy}this.bphase.sync(_),o=o.next}if(i.sweepFrozen=!1,i.isDynamic()&&i.bulletEnabled){var x=co.bulletCCDLinearThreshold*i.sweepRadius,z=co.bulletCCDAngularThreshold;((i.velx*i.velx+i.vely*i.vely)*e*e>x*x||i.angvel*i.angvel*e*e>z*z)&&(i.bullet=!0)}}else i.sweepFrozen=!0,i.bullet=!1}n=n.next}for(var w=this.kinematics.begin();null!=w;){var k=w.elem();if(k.pre_posx=k.posx,k.pre_posy=k.posy,k.pre_rot=k.rot,k.sweepTime=0,k.sweep_angvel=k.angvel%t,k.sweepIntegrate(e),k.disableCCD)k.sweepFrozen=!0,k.bullet=!1;else{var S=co.staticCCDLinearThreshold*k.sweepRadius,C=co.staticCCDAngularThreshold;if((k.velx*k.velx+k.vely*k.vely)*e*e>S*S||k.angvel*k.angvel*e*e>C*C||k.isKinematic()){var N=k.sweep_angvel;N<0&&(N=-N);for(var P=1/N,M=k.shapes.begin();null!=M;){var I=M.elem(),T=I.aabb,A=T.minx,D=T.miny,E=T.maxx,O=T.maxy,B=p.int(N*e*I.sweepCoef*.008333333333333333);8<B&&(B=8);var L=N*e/B;k.sweepIntegrate(e),I.force_validate_aabb(),A<T.minx?T.minx=A:A=T.minx,D<T.miny?T.miny=D:D=T.miny,E>T.maxx?T.maxx=E:E=T.maxx,O>T.maxy?T.maxy=O:O=T.maxy;for(var j=1,F=B;j<F;){var R=j++;k.sweepIntegrate(L*R*P),I.force_validate_aabb(),A<T.minx?T.minx=A:A=T.minx,D<T.miny?T.miny=D:D=T.miny,E>T.maxx?T.maxx=E:E=T.maxx,O>T.maxy?T.maxy=O:O=T.maxy}this.bphase.sync(I),M=M.next}if(k.sweepFrozen=!1,k.isDynamic()&&k.bulletEnabled){var G=co.bulletCCDLinearThreshold*k.sweepRadius,Z=co.bulletCCDAngularThreshold;((k.velx*k.velx+k.vely*k.vely)*e*e>G*G||k.angvel*k.angvel*e*e>Z*Z)&&(k.bullet=!0)}}else k.sweepFrozen=!0,k.bullet=!1}w=w.next}},continuous:null,presteparb:function(e,t,n){null==n&&(n=!1);var i=this;if(!e.cleared&&e.b1.component.sleeping&&e.b2.component.sleeping)return e.sleep_stamp=this.stamp,e.sleeping=!0;if(!e.cleared||0!=e.present||e.intchange){var r=!n&&e.up_stamp==this.stamp-1&&!e.cleared&&!e.intchange,a=e.fresh&&!e.cleared&&!e.intchange;if(r&&(e.endGenerated=this.stamp),a||r||e.cleared||e.intchange){this.inlined_MRCA_chains(e.ws1,e.ws2);for(var s=this.mrca1.begin();null!=s;){for(var l=s.elem(),o=this.mrca2.begin();null!=o;){var _=o.elem(),p=l.cbSet,u=_.cbSet;if(np.empty_intersection(p,u))o=o.next;else{var h=[bu.get(l,_)];if(a||e.intchange){if(null==h[0]){var c=Eu.get(l,_);h[0]=c,this.add_callbackset(h[0])}np.find_all(p,u,0,function(t){return function(n){if(0!=(n.itype&e.type)&&t[0].empty_arb(n.itype)){var r=i.push_callback(n);r.event=0,bu.int_callback(t[0],n,r),r.set=t[0]}}}(h)),h[0].add_arb(e)&&e.present++}else e.present--,h[0].remove_arb(e),np.find_all(p,u,1,function(t){return function(n){if(0!=(n.itype&e.type)&&t[0].empty_arb(n.itype)){var r=i.push_callback(n);r.event=1,bu.int_callback(t[0],n,r),r.set=t[0]}}}(h)),h[0].really_empty()&&this.remove_callbackset(h[0]);o=o.next}}s=s.next}}e.fresh=!1,e.intchange=!1}if(e.cleared||e.up_stamp+(e.type==Mp.COL?co.arbiterExpirationDelay:0)<this.stamp)return e.type==Mp.SENSOR?e.sensorarb.retire():e.type==Mp.FLUID?e.fluidarb.retire():e.colarb.retire(),!0;var d=e.active;return e.active=e.presentable=e.up_stamp==this.stamp,0!=(1&e.immState)?e.active&&e.type!=Mp.SENSOR&&(null!=e.colarb?e.colarb.preStep(t)&&(e.active=!1):e.fluidarb.preStep(this,t)):null!=e.colarb&&e.colarb.cleanupContacts()&&(e.active=!1),d!=e.active&&(e.b1.arbiters.modified=!0,e.b2.arbiters.modified=!0,this.c_arbiters_true.modified=this.c_arbiters_false.modified=!0,this.s_arbiters.modified=this.f_arbiters.modified=!0),!1},prestep:function(e){for(var t=null,n=this.live_constraints.begin();null!=n;){var i=n.elem();i.preStep(e)?(n=this.live_constraints.erase(t),i.broken(),this.constraintCbBreak(i),i.removeOnBreak?(i.component.sleeping=!0,this.midstep=!1,null!=i.compound?i.compound.wrap_constraints.remove(i.outer):this.wrap_constraints.remove(i.outer),this.midstep=!0):i.active=!1,i.clearcache()):n=(t=n).next}var r=null,a=this.c_arbiters_true,s=a.begin(),l=null!=this.c_arbiters_false;for(l&&null==s&&(l=!1,s=this.c_arbiters_false.begin(),a=this.c_arbiters_false,r=null);null!=s;){var o=s.elem();this.presteparb(o,e)?(s=a.inlined_erase(r),l&&null==s&&(l=!1,s=this.c_arbiters_false.begin(),a=this.c_arbiters_false,r=null)):(s=(r=s).next,l&&null==s&&(l=!1,s=this.c_arbiters_false.begin(),a=this.c_arbiters_false,r=null))}var _=null,p=this.f_arbiters,u=p.begin(),h=!1;for(h&&null==u&&(h=!1,_=p=null);null!=u;){var c=u.elem();this.presteparb(c,e)?(u=p.inlined_erase(_),h&&null==u&&(h=!1,_=p=null)):(u=(_=u).next,h&&null==u&&(h=!1,_=p=null))}var d=null,m=this.s_arbiters,f=m.begin(),g=!1;for(g&&null==f&&(g=!1,d=m=null);null!=f;){var v=f.elem();this.presteparb(v,e)?(f=m.inlined_erase(d),g&&null==f&&(g=!1,d=m=null)):(f=(d=f).next,g&&null==f&&(g=!1,d=m=null))}},warmStart:function(){for(var e=this.f_arbiters.begin();null!=e;){var t=e.elem();t.acting()&&t.warmStart(),e=e.next}var n=this.c_arbiters_false.begin(),i=!0;for(null==n&&(n=this.c_arbiters_true.begin(),i=!1);null!=n;){var r=n.elem();r.acting()&&r.warmStart(),n=n.next,i&&null==n&&(n=this.c_arbiters_true.begin(),i=!1)}for(var a=this.live_constraints.begin();null!=a;)a.elem().warmStart(),a=a.next},iterateVel:function(e){for(var t=0,n=e;t<n;){t++;for(var i=this.f_arbiters.begin();null!=i;){var r=i.elem();r.acting()&&r.applyImpulseVel(),i=i.next}for(var a=null,s=this.live_constraints.begin();null!=s;){var l=s.elem();l.applyImpulseVel()?(s=this.live_constraints.erase(a),l.broken(),this.constraintCbBreak(l),l.removeOnBreak?(l.component.sleeping=!0,this.midstep=!1,null!=l.compound?l.compound.wrap_constraints.remove(l.outer):this.wrap_constraints.remove(l.outer),this.midstep=!0):l.active=!1,l.clearcache()):s=(a=s).next}var o=this.c_arbiters_false.begin(),_=!0;for(null==o&&(o=this.c_arbiters_true.begin(),_=!1);null!=o;){var p=o.elem();p.acting()&&p.applyImpulseVel(),o=o.next,_&&null==o&&(o=this.c_arbiters_true.begin(),_=!1)}}},iteratePos:function(e){for(var t=0,n=e;t<n;){t++;for(var i=null,r=this.live_constraints.begin();null!=r;){var a=r.elem();!a.__velocity&&a.stiff&&a.applyImpulsePos()?(r=this.live_constraints.erase(i),a.broken(),this.constraintCbBreak(a),a.removeOnBreak?(a.component.sleeping=!0,this.midstep=!1,null!=a.compound?a.compound.wrap_constraints.remove(a.outer):this.wrap_constraints.remove(a.outer),this.midstep=!0):a.active=!1,a.clearcache()):r=(i=r).next}var s=this.c_arbiters_false.begin(),l=!0;for(null==s&&(s=this.c_arbiters_true.begin(),l=!1);null!=s;){var o=s.elem();o.acting()&&o.applyImpulsePos(),s=s.next,l&&null==s&&(s=this.c_arbiters_true.begin(),l=!1)}}},group_ignore:function(e,t){var n=e.lookup_group();if(null==n)return!1;var i=t.lookup_group();if(null==i)return!1;for(var r=!1;null!=n&&null!=i;){if(n==i){r=n.ignore;break}n.depth<i.depth?i=i.group:n=n.group}return r},interactionType:function(e,t,n,i){var r;r=!1;for(var a=n.constraints.begin();null!=a;){var s=a.elem();if(s.ignore&&s.pair_exists(n.id,i.id)){r=!0;break}a=a.next}return r||this.group_ignore(e,t)?-1:(e.sensorEnabled||t.sensorEnabled)&&e.filter.shouldSense(t.filter)?2:!e.fluidEnabled&&!t.fluidEnabled||!e.filter.shouldFlow(t.filter)||0==n.imass&&0==i.imass&&0==n.iinertia&&0==i.iinertia?!e.filter.shouldCollide(t.filter)||0==n.imass&&0==i.imass&&0==n.iinertia&&0==i.iinertia?-1:1:0},precb:null,prelisteners:null,narrowPhase:function(e,t,n,i,r){var a=this,s=null,l=e.body,o=t.body,_=this.interactionType(e,t,l,o);if(-1!=_){var p,u;e.type>t.type?(p=t,u=e):e.type==t.type?e.id<t.id?(p=e,u=t):(u=e,p=t):(p=e,u=t);var h=p==t;if(0==_){var c;if(null==i){for(var d=null,m=(l.arbiters.length<o.arbiters.length?l:o).arbiters.begin();null!=m;){var f=m.elem();if(f.id==p.id&&f.di==u.id){d=f;break}m=m.next}c=d}else c=i;var g,v=null==c,b=!1;if(v?(null==Tp.zpp_pool?g=new Tp:(g=Tp.zpp_pool,Tp.zpp_pool=g.next,g.next=null),g.alloc()):null==c.fluidarb?(c.lazyRetire(this,null),null==Tp.zpp_pool?g=new Tp:(g=Tp.zpp_pool,Tp.zpp_pool=g.next,g.next=null),g.alloc(),b=v=g.intchange=!0):g=c.fluidarb,v||g.stamp!=this.stamp||r)if(g.stamp=this.stamp,Fp.flowCollide(p,u,g)){if(g.fresh=v?(g.assign(e,t,p.id,u.id),this.f_arbiters.inlined_add(g),!b):g.up_stamp<this.stamp-1||g.endGenerated==this.stamp&&r,g.up_stamp=g.stamp,g.fresh||0==(4&g.immState)){var y=!(g.immState=1),x=g.ws1.id>g.ws2.id?g.ws2:g.ws1,z=g.ws1.id>g.ws2.id?g.ws1:g.ws2;this.inlined_MRCA_chains(x,z);for(var w=this.mrca1.begin();null!=w;){for(var k=w.elem(),S=this.mrca2.begin();null!=S;){var C=S.elem(),N=k.cbSet,P=C.cbSet;if(np.empty_intersection(N,P))S=S.next;else{var M=null,I=null;if(this.prelisteners.inlined_clear(),np.find_all(N,P,5,function(e){return function(t){if(0!=(4&t.itype)){var n=a.prelisteners.inlined_insert(e[0],t);e[0]=n,y=!!y||!t.pure}}}([null])),this.prelisteners.empty())S=S.next;else{if(null==(M=bu.get(k,C))&&(I=Eu.get(k,C),this.add_callbackset(I)),null==M||(M.FLUIDstamp!=this.stamp||r)&&0==(4&M.FLUIDstate)){if(null!=I&&(M=I),null!=M)for(var T=this.prelisteners.begin();null!=T;)7==T.elem().itype&&(M.COLLISIONstamp=this.stamp,M.SENSORstamp=this.stamp),M.FLUIDstamp=this.stamp,T=T.next;var A=g.active;g.active=!0,this.precb.zpp_inner.pre_arbiter=g,this.precb.zpp_inner.set=M;for(var D=this.prelisteners.begin();null!=D;){var E=D.elem();this.precb.zpp_inner.listener=E,bu.int_callback(M,E,this.precb.zpp_inner),this.precb.zpp_inner.pre_swapped=k!=this.precb.zpp_inner.int1;var O=E.handlerp(this.precb);null!=O&&(g.immState=O==Do.get_ACCEPT()?5:O==Do.get_ACCEPT_ONCE()?1:O==Do.get_IGNORE()?6:2),D=D.next}if(g.active=A,null!=M)for(var B=this.prelisteners.begin();null!=B;)7==B.elem().itype&&(M.COLLISIONstate=g.immState,M.SENSORstate=g.immState),M.FLUIDstate=g.immState,B=B.next}else null==M?0==(4&g.immState)&&(g.immState=1):g.immState=M.FLUIDstate;S=S.next}}}w=w.next}if(y&&0==(4&g.immState)){if(g.b1.isDynamic()){var L=g.b1;L.world||(L.component.waket=this.stamp+(this.midstep?0:1),L.isKinematic()&&(L.kinematicDelaySleep=!0),L.component.sleeping&&this.really_wake(L,!1))}if(g.b1.isDynamic()){var j=g.b2;j.world||(j.component.waket=this.stamp+(this.midstep?0:1),j.isKinematic()&&(j.kinematicDelaySleep=!0),j.component.sleeping&&this.really_wake(j,!1))}}}if(0!=(1&g.immState)){if(g.b1.isDynamic()&&g.b1.component.sleeping){var F=g.b1;F.world||(F.component.waket=this.stamp+(this.midstep?0:1),F.isKinematic()&&(F.kinematicDelaySleep=!0),F.component.sleeping&&this.really_wake(F,!1))}if(g.b2.isDynamic()&&g.b2.component.sleeping){var R=g.b2;R.world||(R.component.waket=this.stamp+(this.midstep?0:1),R.isKinematic()&&(R.kinematicDelaySleep=!0),R.component.sleeping&&this.really_wake(R,!1))}}g.sleeping&&(g.sleeping=!1,this.f_arbiters.inlined_add(g)),s=g}else if(v){var G=g;G.free(),G.next=Tp.zpp_pool,Tp.zpp_pool=G,s=null}else s=g;else s=g}else if(1==_){var Z,U=n?this.c_arbiters_true:this.c_arbiters_false;if(null==i){for(var V=null,q=(l.arbiters.length<o.arbiters.length?l:o).arbiters.begin();null!=q;){var W=q.elem();if(W.id==p.id&&W.di==u.id){V=W;break}q=q.next}Z=V}else Z=i;var X,H=null==Z,Y=!1;if(H?(null==Ap.zpp_pool?X=new Ap:(X=Ap.zpp_pool,Ap.zpp_pool=X.next,X.next=null),X.alloc(),X.stat=n):null==Z.colarb?(Z.lazyRetire(this,null),null==Ap.zpp_pool?X=new Ap:(X=Ap.zpp_pool,Ap.zpp_pool=X.next,X.next=null),X.alloc(),X.intchange=!0,X.stat=n,Y=H=!0):(h=p!=(X=Z.colarb).s1,X.stat!=n&&(X.stat=n,X.sleeping||((n?this.c_arbiters_false:this.c_arbiters_true).remove(X),U.add(X)))),H||X.stamp!=this.stamp||r)if(X.stamp=this.stamp,Fp.contactCollide(p,u,X,h)){if(X.fresh=H?(X.assign(e,t,p.id,u.id),U.inlined_add(X),!Y):X.up_stamp<this.stamp-1||X.endGenerated==this.stamp&&r,X.up_stamp=X.stamp,X.fresh||0==(4&X.immState)){var J=!(X.immState=1),K=X.ws1.id>X.ws2.id?X.ws2:X.ws1,Q=X.ws1.id>X.ws2.id?X.ws1:X.ws2;this.inlined_MRCA_chains(K,Q);for(var $=this.mrca1.begin();null!=$;){for(var ee=$.elem(),te=this.mrca2.begin();null!=te;){var ne=te.elem(),ie=ee.cbSet,re=ne.cbSet;if(np.empty_intersection(ie,re))te=te.next;else{var ae=null,se=null;if(this.prelisteners.inlined_clear(),np.find_all(ie,re,5,function(e){return function(t){if(0!=(1&t.itype)){var n=a.prelisteners.inlined_insert(e[0],t);e[0]=n,J=!!J||!t.pure}}}([null])),this.prelisteners.empty())te=te.next;else{if(null==(ae=bu.get(ee,ne))&&(se=Eu.get(ee,ne),this.add_callbackset(se)),null==ae||(ae.COLLISIONstamp!=this.stamp||r)&&0==(4&ae.COLLISIONstate)){if(null!=se&&(ae=se),null!=ae)for(var le=this.prelisteners.begin();null!=le;)7==le.elem().itype?(ae.COLLISIONstamp=this.stamp,ae.SENSORstamp=this.stamp,ae.FLUIDstamp=this.stamp):ae.COLLISIONstamp=this.stamp,le=le.next;var oe=X.active;X.active=!0,X.cleanupContacts(),this.precb.zpp_inner.pre_arbiter=X,this.precb.zpp_inner.set=ae;for(var _e=this.prelisteners.begin();null!=_e;){var pe=_e.elem();this.precb.zpp_inner.listener=pe,bu.int_callback(ae,pe,this.precb.zpp_inner),this.precb.zpp_inner.pre_swapped=ee!=this.precb.zpp_inner.int1;var ue=pe.handlerp(this.precb);null!=ue&&(X.immState=ue==Do.get_ACCEPT()?5:ue==Do.get_ACCEPT_ONCE()?1:ue==Do.get_IGNORE()?6:2),_e=_e.next}if(X.active=oe,null!=ae)for(var he=this.prelisteners.begin();null!=he;)7==he.elem().itype?(ae.COLLISIONstate=X.immState,ae.SENSORstate=X.immState,ae.FLUIDstate=X.immState):ae.COLLISIONstate=X.immState,he=he.next}else null==ae?0==(4&X.immState)&&(X.immState=1):X.immState=ae.COLLISIONstate;te=te.next}}}$=$.next}if(J&&0==(4&X.immState)){if(X.b1.isDynamic()){var ce=X.b1;ce.world||(ce.component.waket=this.stamp+(this.midstep?0:1),ce.isKinematic()&&(ce.kinematicDelaySleep=!0),ce.component.sleeping&&this.really_wake(ce,!1))}if(X.b1.isDynamic()){var de=X.b2;de.world||(de.component.waket=this.stamp+(this.midstep?0:1),de.isKinematic()&&(de.kinematicDelaySleep=!0),de.component.sleeping&&this.really_wake(de,!1))}}}if(0!=(1&X.immState)){if(X.b1.isDynamic()&&X.b1.component.sleeping){var me=X.b1;me.world||(me.component.waket=this.stamp+(this.midstep?0:1),me.isKinematic()&&(me.kinematicDelaySleep=!0),me.component.sleeping&&this.really_wake(me,!1))}if(X.b2.isDynamic()&&X.b2.component.sleeping){var fe=X.b2;fe.world||(fe.component.waket=this.stamp+(this.midstep?0:1),fe.isKinematic()&&(fe.kinematicDelaySleep=!0),fe.component.sleeping&&this.really_wake(fe,!1))}}X.sleeping&&(X.sleeping=!1,U.inlined_add(X)),s=X}else if(H){var ge=X;ge.free(),ge.next=Ap.zpp_pool,Ap.zpp_pool=ge,s=null}else s=X;else s=X}else{var ve;if(null==i){for(var be=null,ye=(l.arbiters.length<o.arbiters.length?l:o).arbiters.begin();null!=ye;){var xe=ye.elem();if(xe.id==p.id&&xe.di==u.id){be=xe;break}ye=ye.next}ve=be}else ve=i;var ze,we=null==ve,ke=!1;if(we?(null==Ip.zpp_pool?ze=new Ip:(ze=Ip.zpp_pool,Ip.zpp_pool=ze.next,ze.next=null),ze.alloc()):null==ve.sensorarb?(ve.lazyRetire(this,null),null==Ip.zpp_pool?ze=new Ip:(ze=Ip.zpp_pool,Ip.zpp_pool=ze.next,ze.next=null),ze.alloc(),ke=we=ze.intchange=!0):ze=ve.sensorarb,we||ze.stamp!=this.stamp||r)if(ze.stamp=this.stamp,Fp.testCollide(p,u)){if(ze.fresh=we?(ze.assign(e,t,p.id,u.id),this.s_arbiters.inlined_add(ze),!ke):ze.up_stamp<this.stamp-1||ze.endGenerated==this.stamp&&r,ze.up_stamp=ze.stamp,ze.fresh||0==(4&ze.immState)){var Se=!(ze.immState=1),Ce=ze.ws1.id>ze.ws2.id?ze.ws2:ze.ws1,Ne=ze.ws1.id>ze.ws2.id?ze.ws1:ze.ws2;this.inlined_MRCA_chains(Ce,Ne);for(var Pe=this.mrca1.begin();null!=Pe;){for(var Me=Pe.elem(),Ie=this.mrca2.begin();null!=Ie;){var Te=Ie.elem(),Ae=Me.cbSet,De=Te.cbSet;if(np.empty_intersection(Ae,De))Ie=Ie.next;else{var Ee=null,Oe=null;if(this.prelisteners.inlined_clear(),np.find_all(Ae,De,5,function(e){return function(t){if(0!=(2&t.itype)){var n=a.prelisteners.inlined_insert(e[0],t);e[0]=n,Se=!!Se||!t.pure}}}([null])),this.prelisteners.empty())Ie=Ie.next;else{if(null==(Ee=bu.get(Me,Te))&&(Oe=Eu.get(Me,Te),this.add_callbackset(Oe)),null==Ee||(Ee.SENSORstamp!=this.stamp||r)&&0==(4&Ee.SENSORstate)){if(null!=Oe&&(Ee=Oe),null!=Ee)for(var Be=this.prelisteners.begin();null!=Be;)7==Be.elem().itype?(Ee.COLLISIONstamp=this.stamp,Ee.SENSORstamp=this.stamp,Ee.FLUIDstamp=this.stamp):Ee.SENSORstamp=this.stamp,Be=Be.next;var Le=ze.active;ze.active=!0,this.precb.zpp_inner.pre_arbiter=ze,this.precb.zpp_inner.set=Ee;for(var je=this.prelisteners.begin();null!=je;){var Fe=je.elem();this.precb.zpp_inner.listener=Fe,bu.int_callback(Ee,Fe,this.precb.zpp_inner),this.precb.zpp_inner.pre_swapped=Me!=this.precb.zpp_inner.int1;var Re=Fe.handlerp(this.precb);null!=Re&&(ze.immState=Re==Do.get_ACCEPT()?5:Re==Do.get_ACCEPT_ONCE()?1:Re==Do.get_IGNORE()?6:2),je=je.next}if(ze.active=Le,null!=Ee)for(var Ge=this.prelisteners.begin();null!=Ge;)7==Ge.elem().itype?(Ee.COLLISIONstate=ze.immState,Ee.SENSORstate=ze.immState,Ee.FLUIDstate=ze.immState):Ee.SENSORstate=ze.immState,Ge=Ge.next}else null==Ee?0==(4&ze.immState)&&(ze.immState=1):ze.immState=Ee.SENSORstate;Ie=Ie.next}}}Pe=Pe.next}if(Se&&0==(4&ze.immState)){if(!ze.b1.isStatic()){var Ze=ze.b1;Ze.world||(Ze.component.waket=this.stamp+(this.midstep?0:1),Ze.isKinematic()&&(Ze.kinematicDelaySleep=!0),Ze.component.sleeping&&this.really_wake(Ze,!1))}if(!ze.b2.isStatic()){var Ue=ze.b2;Ue.world||(Ue.component.waket=this.stamp+(this.midstep?0:1),Ue.isKinematic()&&(Ue.kinematicDelaySleep=!0),Ue.component.sleeping&&this.really_wake(Ue,!1))}}}ze.sleeping&&(ze.sleeping=!1,this.s_arbiters.inlined_add(ze)),s=ze}else if(we){var Ve=ze;Ve.free(),Ve.next=Ip.zpp_pool,Ip.zpp_pool=Ve,s=null}else s=ze;else s=ze}}return s},mrca1:null,mrca2:null,MRCA_chains:function(e,t){this.inlined_MRCA_chains(e,t)},inlined_MRCA_chains:function(e,t){this.mrca1.inlined_clear(),this.mrca2.inlined_clear(),null!=e.cbSet&&this.mrca1.inlined_add(e),null!=e.body.cbSet&&this.mrca1.inlined_add(e.body),null!=t.cbSet&&this.mrca2.inlined_add(t),null!=t.body.cbSet&&this.mrca2.inlined_add(t.body);for(var n=e.body.compound,i=t.body.compound;n!=i;)(null==n?0:n.depth)<(null==i?0:i.depth)?(null!=i.cbSet&&this.mrca2.inlined_add(i),i=i.compound):(null!=n.cbSet&&this.mrca1.inlined_add(n),n=n.compound)},__class__:Bu};var Lu=function(){this.aabb=null,this.shape=null,this.prev=null,this.next=null};(n["zpp_nape.space.ZPP_SweepData"]=Lu).__name__=["zpp_nape","space","ZPP_SweepData"],Lu.prototype={next:null,prev:null,shape:null,aabb:null,free:function(){this.prev=null,this.shape=null,this.aabb=null},alloc:function(){},gt:function(e){return this.aabb.minx>e.aabb.minx},__class__:Lu};var ju=function(e){this.failed=null,this.list=null,Nu.call(this),this.space=e,this.is_sweep=!0,this.sweep=this};(n["zpp_nape.space.ZPP_SweepPhase"]=ju).__name__=["zpp_nape","space","ZPP_SweepPhase"],ju.__super__=Nu,ju.prototype=r(Nu.prototype,{list:null,__insert:function(e){var t;null==Lu.zpp_pool?t=new Lu:(t=Lu.zpp_pool,Lu.zpp_pool=t.next,t.next=null),t.alloc(),(e.sweep=t).shape=e,t.aabb=e.aabb,t.next=this.list,null!=this.list&&(this.list.prev=t),this.list=t},__remove:function(e){var t=e.sweep;null==t.prev?this.list=t.next:t.prev.next=t.next,null!=t.next&&(t.next.prev=t.prev),e.sweep=null;var n=t;n.free(),n.next=Lu.zpp_pool,Lu.zpp_pool=n},__sync:function(e){this.space.continuous||e.validate_aabb()},sync_broadphase:function(){this.space.validation(),null!=this.list&&this.sync_broadphase_fast()},sync_broadphase_fast:function(){for(var e=this.list.next;null!=e;){var t=e.next,n=e.prev;if(e.gt(n))e=t;else{for(;null!=n.prev&&n.prev.gt(e);)n=n.prev;var i=e.prev;i.next=e.next,null!=e.next&&(e.next.prev=i),null==n.prev?(e.prev=null,((this.list=e).next=n).prev=e):(e.prev=n.prev,((n.prev=e).prev.next=e).next=n),e=t}}},broadphase:function(e,t){if(null!=this.list){this.sync_broadphase_fast();for(var n=this.list;null!=n;){for(var i=n.next,r=n.shape,a=r.body,s=n.aabb.maxx;null!=i&&!(i.aabb.minx>s);){var l=i.shape,o=l.body;o!=a&&(a.isStatic()&&o.isStatic()||a.component.sleeping&&o.component.sleeping||r.aabb.intersectY(l.aabb)&&(t?e.narrowPhase(r,l,!a.isDynamic()||!o.isDynamic(),null,!1):e.continuousEvent(r,l,!a.isDynamic()||!o.isDynamic(),null,!1))),i=i.next}n=n.next}}},clear:function(){for(;null!=this.list;)this.list.shape.removedFromSpace(),this.__remove(this.list.shape)},shapesUnderPoint:function(e,t,n,i){this.sync_broadphase();for(var r=fu.get(e,t),a=null==i?new W_:i,s=this.list;null!=s&&s.aabb.minx>e;)s=s.next;for(;null!=s&&s.aabb.minx<=e;){if(s.aabb.maxx>=e&&s.aabb.miny<=t&&s.aabb.maxy>=t){var l=s.shape;(null==n||l.filter.shouldCollide(n))&&(l.isCircle()?Fp.circleContains(l.circle,r)&&a.push(l.outer):Fp.polyContains(l.polygon,r)&&a.push(l.outer))}s=s.next}var o=r;return o.free(),o.next=fu.zpp_pool,fu.zpp_pool=o,a},bodiesUnderPoint:function(e,t,n,i){this.sync_broadphase();for(var r=fu.get(e,t),a=null==i?new P_:i,s=this.list;null!=s&&s.aabb.minx>e;)s=s.next;for(;null!=s&&s.aabb.minx<=e;){if(s.aabb.maxx>=e&&s.aabb.miny<=t&&s.aabb.maxy>=t){var l=s.shape,o=l.body.outer;a.has(o)||(null==n||l.filter.shouldCollide(n))&&(l.isCircle()?Fp.circleContains(l.circle,r)&&a.push(o):Fp.polyContains(l.polygon,r)&&a.push(o))}s=s.next}var _=r;return _.free(),_.next=fu.zpp_pool,fu.zpp_pool=_,a},shapesInAABB:function(e,t,n,i,r){this.sync_broadphase(),this.updateAABBShape(e);for(var a=this.aabbShape.zpp_inner.aabb,s=null==r?new W_:r,l=this.list;null!=l&&l.aabb.maxx<a.minx;)l=l.next;for(;null!=l&&l.aabb.minx<=a.maxx;){var o=l.shape;(null==i||o.filter.shouldCollide(i))&&(t?n?Fp.containTest(this.aabbShape.zpp_inner,o)&&s.push(o.outer):a.contains(l.aabb)?s.push(o.outer):l.aabb.intersect(a)&&Fp.testCollide_safe(o,this.aabbShape.zpp_inner)&&s.push(o.outer):(n?a.contains(l.aabb):l.aabb.intersect(a))&&s.push(o.outer)),l=l.next}return s},failed:null,bodiesInAABB:function(e,t,n,i,r){this.sync_broadphase(),this.updateAABBShape(e);var a=this.aabbShape.zpp_inner.aabb,s=null==r?new P_:r;null==this.failed&&(this.failed=new P_);for(var l=this.list;null!=l&&l.aabb.maxx<a.minx;)l=l.next;for(;null!=l&&l.aabb.minx<=a.maxx;){var o=l.shape,_=o.body.outer;if(l.aabb.intersect(a)&&(null==i||o.filter.shouldCollide(i)))if(t)if(n){if(!this.failed.has(_)){var p=Fp.containTest(this.aabbShape.zpp_inner,o);!s.has(_)&&p?s.push(_):p||(s.remove(_),this.failed.push(_))}}else!s.has(_)&&Fp.testCollide_safe(o,this.aabbShape.zpp_inner)&&s.push(_);else if(n){if(!this.failed.has(_)){var u=a.contains(o.aabb);!s.has(_)&&u?s.push(_):u||(s.remove(_),this.failed.push(_))}}else!s.has(_)&&a.contains(o.aabb)&&s.push(_);l=l.next}return this.failed.clear(),s},shapesInCircle:function(e,t,n,i,r,a){this.sync_broadphase(),this.updateCircShape(e,t,n);for(var s=this.circShape.zpp_inner.aabb,l=null==a?new W_:a,o=this.list;null!=o&&o.aabb.maxx<s.minx;)o=o.next;for(;null!=o&&o.aabb.minx<=s.maxx;){if(o.aabb.intersect(s)){var _=o.shape;(null==r||_.filter.shouldCollide(r))&&(i?Fp.containTest(this.circShape.zpp_inner,_)&&l.push(_.outer):Fp.testCollide_safe(_,this.circShape.zpp_inner)&&l.push(_.outer))}o=o.next}return l},bodiesInCircle:function(e,t,n,i,r,a){this.sync_broadphase(),this.updateCircShape(e,t,n);var s=this.circShape.zpp_inner.aabb,l=null==a?new P_:a;null==this.failed&&(this.failed=new P_);for(var o=this.list;null!=o&&o.aabb.maxx<s.minx;)o=o.next;for(;null!=o&&o.aabb.minx<=s.maxx;){if(o.aabb.intersect(s)){var _=o.shape,p=_.body.outer;if(null==r||_.filter.shouldCollide(r))if(i){if(!this.failed.has(p)){var u=Fp.containTest(this.circShape.zpp_inner,_);!l.has(p)&&u?l.push(p):u||(l.remove(p),this.failed.push(p))}}else!l.has(p)&&Fp.testCollide_safe(_,this.circShape.zpp_inner)&&l.push(p)}o=o.next}return this.failed.clear(),l},shapesInShape:function(e,t,n,i){this.sync_broadphase(),this.validateShape(e);for(var r=e.aabb,a=null==i?new W_:i,s=this.list;null!=s&&s.aabb.maxx<r.minx;)s=s.next;for(;null!=s&&s.aabb.minx<=r.maxx;){if(s.aabb.intersect(r)){var l=s.shape;(null==n||l.filter.shouldCollide(n))&&(t?Fp.containTest(e,l)&&a.push(l.outer):Fp.testCollide_safe(l,e)&&a.push(l.outer))}s=s.next}return a},bodiesInShape:function(e,t,n,i){this.sync_broadphase(),this.validateShape(e);var r=e.aabb,a=null==i?new P_:i;null==this.failed&&(this.failed=new P_);for(var s=this.list;null!=s&&s.aabb.maxx<r.minx;)s=s.next;for(;null!=s&&s.aabb.minx<=r.maxx;){if(s.aabb.intersect(r)){var l=s.shape,o=l.body.outer;if(null==n||l.filter.shouldCollide(n))if(t){if(!this.failed.has(o)){var _=Fp.containTest(e,l);!a.has(o)&&_?a.push(o):_||(a.remove(o),this.failed.push(o))}}else!a.has(o)&&Fp.testCollide_safe(e,l)&&a.push(o)}s=s.next}return this.failed.clear(),a},rayCast:function(e,t,n){this.sync_broadphase(),e.validate_dir();var i=e.rayAABB(),r=e.maxdist,a=null;if(0==e.dirx)for(var s=this.list;null!=s&&s.aabb.minx<=i.minx;){if(s.aabb.intersect(i)&&(null==n||s.shape.filter.shouldCollide(n))){var l=e.aabbsect(s.aabb);if(0<=l&&l<r){var o=s.shape.isCircle()?e.circlesect(s.shape.circle,t,r):e.polysect(s.shape.polygon,t,r);null!=o&&(r=o.get_distance(),null!=a&&a.dispose(),a=o)}}s=s.next}else if(e.dirx<0){for(var _=this.list,p=null;null!=_&&_.aabb.minx<=i.maxx;)_=(p=_).next;for(_=p;null!=_;){if(_.aabb.intersect(i)&&(null==n||_.shape.filter.shouldCollide(n))){var u=e.aabbsect(_.aabb);if(0<=u&&u<r){var h=_.shape.isCircle()?e.circlesect(_.shape.circle,t,r):e.polysect(_.shape.polygon,t,r);null!=h&&(r=h.get_distance(),null!=a&&a.dispose(),a=h)}}_=_.prev}}else for(var c=this.list;null!=c&&c.aabb.minx<=i.maxx&&c.aabb.minx<e.originx+e.dirx*r;){if(c.aabb.intersect(i)&&(null==n||c.shape.filter.shouldCollide(n))){var d=e.aabbsect(c.aabb);if(0<=d&&d<r){var m=c.shape.isCircle()?e.circlesect(c.shape.circle,t,r):e.polysect(c.shape.polygon,t,r);null!=m&&(r=m.get_distance(),null!=a&&a.dispose(),a=m)}}c=c.next}var f=i;return f.free(),f.next=Lp.zpp_pool,Lp.zpp_pool=f,a},rayMultiCast:function(e,t,n,i){this.sync_broadphase(),e.validate_dir();var r=e.rayAABB(),a=null==i?new b_:i;if(0==e.dirx)for(var s=this.list;null!=s&&s.aabb.minx<=r.minx;)s.aabb.intersect(r)&&(null==n||s.shape.filter.shouldCollide(n))&&0<=e.aabbsect(s.aabb)&&(s.shape.isCircle()?e.circlesect2(s.shape.circle,t,a):e.polysect2(s.shape.polygon,t,a)),s=s.next;else if(e.dirx<0){for(var l=this.list,o=null;null!=l&&l.aabb.minx<=r.maxx;)l=(o=l).next;for(l=o;null!=l;)l.aabb.intersect(r)&&(null==n||l.shape.filter.shouldCollide(n))&&0<=e.aabbsect(l.aabb)&&(l.shape.isCircle()?e.circlesect2(l.shape.circle,t,a):e.polysect2(l.shape.polygon,t,a)),l=l.prev}else for(var _=this.list;null!=_&&_.aabb.minx<=r.maxx;)_.aabb.intersect(r)&&(null==n||_.shape.filter.shouldCollide(n))&&0<=e.aabbsect(_.aabb)&&(_.shape.isCircle()?e.circlesect2(_.shape.circle,t,a):e.polysect2(_.shape.polygon,t,a)),_=_.next;var p=r;return p.free(),p.next=Lp.zpp_pool,Lp.zpp_pool=p,a},__class__:ju});var Fu=function(e,t){this.width=0,this.list=null,this.width=e,this.list=[]};(n["zpp_nape.util.ZNPArray2_Float"]=Fu).__name__=["zpp_nape","util","ZNPArray2_Float"],Fu.prototype={list:null,width:null,resize:function(e,t,n){for(var i=0,r=(this.width=e)*t;i<r;){var a=i++;this.list[a]=n}},get:function(e,t){return this.list[t*this.width+e]},set:function(e,t,n){return this.list[t*this.width+e]=n},__class__:Fu};var Ru=function(e,t){this.width=0,this.list=null,this.width=e,this.list=[]};(n["zpp_nape.util.ZNPArray2_ZPP_GeomVert"]=Ru).__name__=["zpp_nape","util","ZNPArray2_ZPP_GeomVert"],Ru.prototype={list:null,width:null,resize:function(e,t,n){for(var i=0,r=(this.width=e)*t;i<r;){var a=i++;this.list[a]=n}},get:function(e,t){return this.list[t*this.width+e]},set:function(e,t,n){return this.list[t*this.width+e]=n},__class__:Ru};var Gu=function(e,t){this.width=0,this.list=null,this.width=e,this.list=[]};(n["zpp_nape.util.ZNPArray2_ZPP_MarchPair"]=Gu).__name__=["zpp_nape","util","ZNPArray2_ZPP_MarchPair"],Gu.prototype={list:null,width:null,resize:function(e,t,n){for(var i=0,r=(this.width=e)*t;i<r;){var a=i++;this.list[a]=n}},get:function(e,t){return this.list[t*this.width+e]},set:function(e,t,n){return this.list[t*this.width+e]=n},__class__:Gu};var Zu=function(){this.di=0,this.id=0,this.hnext=null,this.next=null,this.value=!1};(n["zpp_nape.util.Hashable2_Boolfalse"]=Zu).__name__=["zpp_nape","util","Hashable2_Boolfalse"],Zu.get=function(e,t,n){var i=Zu.getpersist(e,t);return i.value=n,i},Zu.getpersist=function(e,t){var n;return null==Zu.zpp_pool?n=new Zu:(n=Zu.zpp_pool,Zu.zpp_pool=n.next,n.next=null),n.alloc(),n.id=e,n.di=t,n},Zu.ordered_get=function(e,t,n){return e<=t?Zu.get(e,t,n):Zu.get(t,e,n)},Zu.ordered_get_persist=function(e,t){return e<=t?Zu.getpersist(e,t):Zu.getpersist(t,e)},Zu.prototype={value:null,next:null,hnext:null,id:null,di:null,free:function(){},alloc:function(){},__class__:Zu};var Uu=function(){this.cnt=0,this.table=null,this.cnt=0,this.table=[];for(var e=0;e<1048576;)e++,this.table.push(null)};(n["zpp_nape.util.FastHash2_Hashable2_Boolfalse"]=Uu).__name__=["zpp_nape","util","FastHash2_Hashable2_Boolfalse"],Uu.prototype={table:null,cnt:null,empty:function(){return 0==this.cnt},clear:function(){for(var e=0,t=this.table.length;e<t;){var n=e++,i=this.table[n];if(null!=i){for(;null!=i;){var r=i.hnext;i.hnext=null,i=r}this.table[n]=null}}},get:function(e,t){var n=this.table[this.hash(e,t)];if(null==n)return null;if(n.id==e&&n.di==t)return n;for(;null!=(n=n.hnext)&&(n.id!=e||n.di!=t););return n},ordered_get:function(e,t){if(t<e){var n=e;e=t,t=n}return this.get(e,t)},has:function(e,t){var n=this.table[this.hash(e,t)];if(null==n)return!1;if(n.id==e&&n.di==t)return!0;for(;null!=(n=n.hnext)&&(n.id!=e||n.di!=t););return null!=n},maybeAdd:function(e){var t=this.hash(e.id,e.di),n=this.table[t];null==n?(this.table[t]=e).hnext=null:(e.hnext=n.hnext,n.hnext=e),this.cnt++},add:function(e){var t=this.hash(e.id,e.di),n=this.table[t];null==n?(this.table[t]=e).hnext=null:(e.hnext=n.hnext,n.hnext=e),this.cnt++},remove:function(e){var t=this.hash(e.id,e.di),n=this.table[t];if(n==e)this.table[t]=n.hnext;else if(null!=n){for(var i;null!=(n=(i=n).hnext)&&n!=e;);i.hnext=n.hnext}e.hnext=null,this.cnt--},hash:function(e,t){return 106039*e+t&1048575},__class__:Uu};var Vu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_CallbackSet"]=Vu).__name__=["zpp_nape","util","ZNPList_ZPP_CallbackSet"],Vu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==vh.zpp_pool?t=new vh:(t=vh.zpp_pool,vh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==vh.zpp_pool?n=new vh:(n=vh.zpp_pool,vh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=vh.zpp_pool,vh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=vh.zpp_pool,vh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Vu};var qu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Shape"]=qu).__name__=["zpp_nape","util","ZNPList_ZPP_Shape"],qu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==bh.zpp_pool?t=new bh:(t=bh.zpp_pool,bh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==bh.zpp_pool?n=new bh:(n=bh.zpp_pool,bh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=bh.zpp_pool,bh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=bh.zpp_pool,bh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:qu};var Wu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Body"]=Wu).__name__=["zpp_nape","util","ZNPList_ZPP_Body"],Wu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==yh.zpp_pool?t=new yh:(t=yh.zpp_pool,yh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==yh.zpp_pool?n=new yh:(n=yh.zpp_pool,yh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=yh.zpp_pool,yh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=yh.zpp_pool,yh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Wu};var Xu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Compound"]=Xu).__name__=["zpp_nape","util","ZNPList_ZPP_Compound"],Xu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==zh.zpp_pool?t=new zh:(t=zh.zpp_pool,zh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==zh.zpp_pool?n=new zh:(n=zh.zpp_pool,zh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=zh.zpp_pool,zh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=zh.zpp_pool,zh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Xu};var Hu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Arbiter"]=Hu).__name__=["zpp_nape","util","ZNPList_ZPP_Arbiter"],Hu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Nh.zpp_pool?t=new Nh:(t=Nh.zpp_pool,Nh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Nh.zpp_pool?n=new Nh:(n=Nh.zpp_pool,Nh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Nh.zpp_pool,Nh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Nh.zpp_pool,Nh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Hu};var Yu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_CbSetPair"]=Yu).__name__=["zpp_nape","util","ZNPList_ZPP_CbSetPair"],Yu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Mh.zpp_pool?t=new Mh:(t=Mh.zpp_pool,Mh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Mh.zpp_pool?n=new Mh:(n=Mh.zpp_pool,Mh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Mh.zpp_pool,Mh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Mh.zpp_pool,Mh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Yu};var Ju=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_CutInt"]=Ju).__name__=["zpp_nape","util","ZNPList_ZPP_CutInt"],Ju.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Ih.zpp_pool?t=new Ih:(t=Ih.zpp_pool,Ih.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Ih.zpp_pool?n=new Ih:(n=Ih.zpp_pool,Ih.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Ih.zpp_pool,Ih.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Ih.zpp_pool,Ih.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Ju};var Ku=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_CutVert"]=Ku).__name__=["zpp_nape","util","ZNPList_ZPP_CutVert"],Ku.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Th.zpp_pool?t=new Th:(t=Th.zpp_pool,Th.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Th.zpp_pool?n=new Th:(n=Th.zpp_pool,Th.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Th.zpp_pool,Th.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Th.zpp_pool,Th.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Ku};var Qu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_PartitionVertex"]=Qu).__name__=["zpp_nape","util","ZNPList_ZPP_PartitionVertex"],Qu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Ah.zpp_pool?t=new Ah:(t=Ah.zpp_pool,Ah.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Ah.zpp_pool?n=new Ah:(n=Ah.zpp_pool,Ah.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Ah.zpp_pool,Ah.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Ah.zpp_pool,Ah.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Qu};var $u=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_PartitionedPoly"]=$u).__name__=["zpp_nape","util","ZNPList_ZPP_PartitionedPoly"],$u.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Dh.zpp_pool?t=new Dh:(t=Dh.zpp_pool,Dh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Dh.zpp_pool?n=new Dh:(n=Dh.zpp_pool,Dh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Dh.zpp_pool,Dh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Dh.zpp_pool,Dh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:$u};var eh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_GeomVert"]=eh).__name__=["zpp_nape","util","ZNPList_ZPP_GeomVert"],eh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Eh.zpp_pool?t=new Eh:(t=Eh.zpp_pool,Eh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Eh.zpp_pool?n=new Eh:(n=Eh.zpp_pool,Eh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Eh.zpp_pool,Eh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Eh.zpp_pool,Eh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:eh};var th=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_SimplifyP"]=th).__name__=["zpp_nape","util","ZNPList_ZPP_SimplifyP"],th.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Oh.zpp_pool?t=new Oh:(t=Oh.zpp_pool,Oh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Oh.zpp_pool?n=new Oh:(n=Oh.zpp_pool,Oh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Oh.zpp_pool,Oh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Oh.zpp_pool,Oh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:th};var nh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_SimpleVert"]=nh).__name__=["zpp_nape","util","ZNPList_ZPP_SimpleVert"],nh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Bh.zpp_pool?t=new Bh:(t=Bh.zpp_pool,Bh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Bh.zpp_pool?n=new Bh:(n=Bh.zpp_pool,Bh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Bh.zpp_pool,Bh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Bh.zpp_pool,Bh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:nh};var ih=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_SimpleEvent"]=ih).__name__=["zpp_nape","util","ZNPList_ZPP_SimpleEvent"],ih.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Lh.zpp_pool?t=new Lh:(t=Lh.zpp_pool,Lh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Lh.zpp_pool?n=new Lh:(n=Lh.zpp_pool,Lh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Lh.zpp_pool,Lh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Lh.zpp_pool,Lh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:ih};var rh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_AABBPair"]=rh).__name__=["zpp_nape","util","ZNPList_ZPP_AABBPair"],rh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==jh.zpp_pool?t=new jh:(t=jh.zpp_pool,jh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==jh.zpp_pool?n=new jh:(n=jh.zpp_pool,jh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=jh.zpp_pool,jh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=jh.zpp_pool,jh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:rh};var ah=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Edge"]=ah).__name__=["zpp_nape","util","ZNPList_ZPP_Edge"],ah.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Fh.zpp_pool?t=new Fh:(t=Fh.zpp_pool,Fh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Fh.zpp_pool?n=new Fh:(n=Fh.zpp_pool,Fh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Fh.zpp_pool,Fh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Fh.zpp_pool,Fh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:ah};var sh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Component"]=sh).__name__=["zpp_nape","util","ZNPList_ZPP_Component"],sh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Gh.zpp_pool?t=new Gh:(t=Gh.zpp_pool,Gh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Gh.zpp_pool?n=new Gh:(n=Gh.zpp_pool,Gh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Gh.zpp_pool,Gh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Gh.zpp_pool,Gh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:sh};var lh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_AABBNode"]=lh).__name__=["zpp_nape","util","ZNPList_ZPP_AABBNode"],lh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Zh.zpp_pool?t=new Zh:(t=Zh.zpp_pool,Zh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Zh.zpp_pool?n=new Zh:(n=Zh.zpp_pool,Zh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Zh.zpp_pool,Zh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Zh.zpp_pool,Zh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:lh};var oh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_InteractionGroup"]=oh).__name__=["zpp_nape","util","ZNPList_ZPP_InteractionGroup"],oh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Uh.zpp_pool?t=new Uh:(t=Uh.zpp_pool,Uh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Uh.zpp_pool?n=new Uh:(n=Uh.zpp_pool,Uh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Uh.zpp_pool,Uh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Uh.zpp_pool,Uh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:oh};var _h=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_FluidArbiter"]=_h).__name__=["zpp_nape","util","ZNPList_ZPP_FluidArbiter"],_h.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Vh.zpp_pool?t=new Vh:(t=Vh.zpp_pool,Vh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Vh.zpp_pool?n=new Vh:(n=Vh.zpp_pool,Vh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Vh.zpp_pool,Vh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Vh.zpp_pool,Vh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:_h};var ph=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_SensorArbiter"]=ph).__name__=["zpp_nape","util","ZNPList_ZPP_SensorArbiter"],ph.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==qh.zpp_pool?t=new qh:(t=qh.zpp_pool,qh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==qh.zpp_pool?n=new qh:(n=qh.zpp_pool,qh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=qh.zpp_pool,qh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=qh.zpp_pool,qh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:ph};var uh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_ColArbiter"]=uh).__name__=["zpp_nape","util","ZNPList_ZPP_ColArbiter"],uh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Wh.zpp_pool?t=new Wh:(t=Wh.zpp_pool,Wh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Wh.zpp_pool?n=new Wh:(n=Wh.zpp_pool,Wh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Wh.zpp_pool,Wh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Wh.zpp_pool,Wh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:uh};var hh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Listener"]=hh).__name__=["zpp_nape","util","ZNPList_ZPP_Listener"],hh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Xh.zpp_pool?t=new Xh:(t=Xh.zpp_pool,Xh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Xh.zpp_pool?n=new Xh:(n=Xh.zpp_pool,Xh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Xh.zpp_pool,Xh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Xh.zpp_pool,Xh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:hh};var ch=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_ToiEvent"]=ch).__name__=["zpp_nape","util","ZNPList_ZPP_ToiEvent"],ch.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Hh.zpp_pool?t=new Hh:(t=Hh.zpp_pool,Hh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Hh.zpp_pool?n=new Hh:(n=Hh.zpp_pool,Hh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Hh.zpp_pool,Hh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Hh.zpp_pool,Hh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:ch};var dh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ConvexResult"]=dh).__name__=["zpp_nape","util","ZNPList_ConvexResult"],dh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Yh.zpp_pool?t=new Yh:(t=Yh.zpp_pool,Yh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Yh.zpp_pool?n=new Yh:(n=Yh.zpp_pool,Yh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Yh.zpp_pool,Yh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Yh.zpp_pool,Yh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:dh};var mh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_GeomPoly"]=mh).__name__=["zpp_nape","util","ZNPList_ZPP_GeomPoly"],mh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Jh.zpp_pool?t=new Jh:(t=Jh.zpp_pool,Jh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Jh.zpp_pool?n=new Jh:(n=Jh.zpp_pool,Jh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Jh.zpp_pool,Jh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Jh.zpp_pool,Jh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:mh};var fh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_RayResult"]=fh).__name__=["zpp_nape","util","ZNPList_RayResult"],fh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Kh.zpp_pool?t=new Kh:(t=Kh.zpp_pool,Kh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Kh.zpp_pool?n=new Kh:(n=Kh.zpp_pool,Kh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Kh.zpp_pool,Kh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Kh.zpp_pool,Kh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:fh};var gh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_CbType"]=gh).__name__=["zpp_nape","util","ZNPNode_ZPP_CbType"],gh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:gh};var vh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_CallbackSet"]=vh).__name__=["zpp_nape","util","ZNPNode_ZPP_CallbackSet"],vh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:vh};var bh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Shape"]=bh).__name__=["zpp_nape","util","ZNPNode_ZPP_Shape"],bh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:bh};var yh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Body"]=yh).__name__=["zpp_nape","util","ZNPNode_ZPP_Body"],yh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:yh};var xh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Constraint"]=xh).__name__=["zpp_nape","util","ZNPNode_ZPP_Constraint"],xh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:xh};var zh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Compound"]=zh).__name__=["zpp_nape","util","ZNPNode_ZPP_Compound"],zh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:zh};var wh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_InteractionListener"]=wh).__name__=["zpp_nape","util","ZNPNode_ZPP_InteractionListener"],wh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:wh};var kh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_CbSet"]=kh).__name__=["zpp_nape","util","ZNPNode_ZPP_CbSet"],kh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:kh};var Sh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Interactor"]=Sh).__name__=["zpp_nape","util","ZNPNode_ZPP_Interactor"],Sh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Sh};var Ch=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_BodyListener"]=Ch).__name__=["zpp_nape","util","ZNPNode_ZPP_BodyListener"],Ch.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Ch};var Nh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Arbiter"]=Nh).__name__=["zpp_nape","util","ZNPNode_ZPP_Arbiter"],Nh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Nh};var Ph=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_ConstraintListener"]=Ph).__name__=["zpp_nape","util","ZNPNode_ZPP_ConstraintListener"],Ph.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Ph};var Mh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_CbSetPair"]=Mh).__name__=["zpp_nape","util","ZNPNode_ZPP_CbSetPair"],Mh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Mh};var Ih=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_CutInt"]=Ih).__name__=["zpp_nape","util","ZNPNode_ZPP_CutInt"],Ih.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Ih};var Th=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_CutVert"]=Th).__name__=["zpp_nape","util","ZNPNode_ZPP_CutVert"],Th.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Th};var Ah=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_PartitionVertex"]=Ah).__name__=["zpp_nape","util","ZNPNode_ZPP_PartitionVertex"],Ah.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Ah};var Dh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_PartitionedPoly"]=Dh).__name__=["zpp_nape","util","ZNPNode_ZPP_PartitionedPoly"],Dh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Dh};var Eh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_GeomVert"]=Eh).__name__=["zpp_nape","util","ZNPNode_ZPP_GeomVert"],Eh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Eh};var Oh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_SimplifyP"]=Oh).__name__=["zpp_nape","util","ZNPNode_ZPP_SimplifyP"],Oh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Oh};var Bh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_SimpleVert"]=Bh).__name__=["zpp_nape","util","ZNPNode_ZPP_SimpleVert"],Bh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Bh};var Lh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_SimpleEvent"]=Lh).__name__=["zpp_nape","util","ZNPNode_ZPP_SimpleEvent"],Lh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Lh};var jh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_AABBPair"]=jh).__name__=["zpp_nape","util","ZNPNode_ZPP_AABBPair"],jh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:jh};var Fh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Edge"]=Fh).__name__=["zpp_nape","util","ZNPNode_ZPP_Edge"],Fh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Fh};var Rh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Vec2"]=Rh).__name__=["zpp_nape","util","ZNPNode_ZPP_Vec2"],Rh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Rh};var Gh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Component"]=Gh).__name__=["zpp_nape","util","ZNPNode_ZPP_Component"],Gh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Gh};var Zh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_AABBNode"]=Zh).__name__=["zpp_nape","util","ZNPNode_ZPP_AABBNode"],Zh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Zh};var Uh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_InteractionGroup"]=Uh).__name__=["zpp_nape","util","ZNPNode_ZPP_InteractionGroup"],Uh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Uh};var Vh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_FluidArbiter"]=Vh).__name__=["zpp_nape","util","ZNPNode_ZPP_FluidArbiter"],Vh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Vh};var qh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_SensorArbiter"]=qh).__name__=["zpp_nape","util","ZNPNode_ZPP_SensorArbiter"],qh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:qh};var Wh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_ColArbiter"]=Wh).__name__=["zpp_nape","util","ZNPNode_ZPP_ColArbiter"],Wh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Wh};var Xh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Listener"]=Xh).__name__=["zpp_nape","util","ZNPNode_ZPP_Listener"],Xh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Xh};var Hh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_ToiEvent"]=Hh).__name__=["zpp_nape","util","ZNPNode_ZPP_ToiEvent"],Hh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Hh};var Yh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ConvexResult"]=Yh).__name__=["zpp_nape","util","ZNPNode_ConvexResult"],Yh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Yh};var Jh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_GeomPoly"]=Jh).__name__=["zpp_nape","util","ZNPNode_ZPP_GeomPoly"],Jh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Jh};var Kh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_RayResult"]=Kh).__name__=["zpp_nape","util","ZNPNode_RayResult"],Kh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Kh};var Qh=function(){this.at_index=0,this.at_ite=null,this.zip_length=!1,this._length=0,this.inner=null,z_.call(this),this.at_ite=null,this.at_index=0,this.zip_length=!0,this._length=0};(n["zpp_nape.util.ZPP_MixVec2List"]=Qh).__name__=["zpp_nape","util","ZPP_MixVec2List"],Qh.get=function(e,t){null==t&&(t=!1);var n=new Qh;return n.inner=e,n.zpp_inner.immutable=t,n},Qh.__super__=z_,Qh.prototype=r(z_.prototype,{inner:null,_length:null,zip_length:null,at_ite:null,at_index:null,zpp_gl:function(){if(this.zpp_vm(),this.zip_length){this._length=0;for(var e=this.inner.begin();null!=e;)e.elem(),this._length++,e=e.next;this.zip_length=!1}return this._length},zpp_vm:function(){this.zpp_inner.validate(),this.inner.modified&&(this.zip_length=!0,this._length=0,this.at_ite=null)},at:function(e){if(this.zpp_vm(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.at_index||null==this.at_ite)for(this.at_index=0,this.at_ite=this.inner.begin();;){this.at_ite.elem();break}for(;this.at_index!=e;)for(this.at_index++,this.at_ite=this.at_ite.next;;){this.at_ite.elem();break}return this.at_ite.elem().wrapper()},push:function(e){this.zpp_inner.modify_test(),this.zpp_vm();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.inner.add(e.zpp_inner);else{var n=this.inner.iterator_at(this.get_length()-1);this.inner.insert(n,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_vm();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){var n=this.inner.iterator_at(this.get_length()-1);this.inner.insert(n,e.zpp_inner)}else this.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_vm();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.inner.pop()}else{null!=this.at_ite&&null==this.at_ite.next&&(this.at_ite=null);var n=1==this.get_length()?null:this.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.inner.front():n.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.inner.erase(n)}return this.zpp_inner.invalidate(),e.wrapper()},shift:function(){this.zpp_inner.modify_test(),this.zpp_vm();var e=null;if(this.zpp_inner.reverse_flag){null!=this.at_ite&&null==this.at_ite.next&&(this.at_ite=null);var t=1==this.get_length()?null:this.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.inner.front():t.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.inner.erase(t)}else{var i=(e=this.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.inner.pop()}return this.zpp_inner.invalidate(),e.wrapper()},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_vm(),t=!1;for(var n=this.inner.begin();null!=n;){var i=n.elem();if(e.zpp_inner==i){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},__class__:Qh});var $h=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new lp,this._invalidated=!0};(n["zpp_nape.util.ZPP_ConstraintList"]=$h).__name__=["zpp_nape","util","ZPP_ConstraintList"],$h.get=function(e,t){null==t&&(t=!1);var n=new jo;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},$h.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:$h};var ec=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Wu,this._invalidated=!0};(n["zpp_nape.util.ZPP_BodyList"]=ec).__name__=["zpp_nape","util","ZPP_BodyList"],ec.get=function(e,t){null==t&&(t=!1);var n=new P_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},ec.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:ec};var tc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new op,this._invalidated=!0};(n["zpp_nape.util.ZPP_InteractorList"]=tc).__name__=["zpp_nape","util","ZPP_InteractorList"],tc.get=function(e,t){null==t&&(t=!1);var n=new L_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},tc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:tc};var nc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Xu,this._invalidated=!0};(n["zpp_nape.util.ZPP_CompoundList"]=nc).__name__=["zpp_nape","util","ZPP_CompoundList"],nc.get=function(e,t){null==t&&(t=!1);var n=new A_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},nc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:nc};var ic=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new hh,this._invalidated=!0};(n["zpp_nape.util.ZPP_ListenerList"]=ic).__name__=["zpp_nape","util","ZPP_ListenerList"],ic.get=function(e,t){null==t&&(t=!1);var n=new Mo;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},ic.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:ic};var rc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new mp,this._invalidated=!0};(n["zpp_nape.util.ZPP_CbTypeList"]=rc).__name__=["zpp_nape","util","ZPP_CbTypeList"],rc.get=function(e,t){null==t&&(t=!1);var n=new zo;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},rc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:rc};var ac=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new jp,this._invalidated=!0};(n["zpp_nape.util.ZPP_Vec2List"]=ac).__name__=["zpp_nape","util","ZPP_Vec2List"],ac.get=function(e,t){null==t&&(t=!1);var n=new z_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},ac.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:ac};var sc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new mh,this._invalidated=!0};(n["zpp_nape.util.ZPP_GeomPolyList"]=sc).__name__=["zpp_nape","util","ZPP_GeomPolyList"],sc.get=function(e,t){null==t&&(t=!1);var n=new u_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},sc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:sc};var lc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new fh,this._invalidated=!0};(n["zpp_nape.util.ZPP_RayResultList"]=lc).__name__=["zpp_nape","util","ZPP_RayResultList"],lc.get=function(e,t){null==t&&(t=!1);var n=new b_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},lc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:lc};var oc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new dh,this._invalidated=!0};(n["zpp_nape.util.ZPP_ConvexResultList"]=oc).__name__=["zpp_nape","util","ZPP_ConvexResultList"],oc.get=function(e,t){null==t&&(t=!1);var n=new l_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},oc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:oc};var _c=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new ah,this._invalidated=!0};(n["zpp_nape.util.ZPP_EdgeList"]=_c).__name__=["zpp_nape","util","ZPP_EdgeList"],_c.get=function(e,t){null==t&&(t=!1);var n=new U_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},_c.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:_c};var pc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new qu,this._invalidated=!0};(n["zpp_nape.util.ZPP_ShapeList"]=pc).__name__=["zpp_nape","util","ZPP_ShapeList"],pc.get=function(e,t){null==t&&(t=!1);var n=new W_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},pc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:pc};var uc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new oh,this._invalidated=!0};(n["zpp_nape.util.ZPP_InteractionGroupList"]=uc).__name__=["zpp_nape","util","ZPP_InteractionGroupList"],uc.get=function(e,t){null==t&&(t=!1);var n=new i_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},uc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:uc};var hc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Hu,this._invalidated=!0};(n["zpp_nape.util.ZPP_ArbiterList"]=hc).__name__=["zpp_nape","util","ZPP_ArbiterList"],hc.get=function(e,t){null==t&&(t=!1);var n=new Ho;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},hc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:hc};var cc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Dp,this._invalidated=!0};(n["zpp_nape.util.ZPP_ContactList"]=cc).__name__=["zpp_nape","util","ZPP_ContactList"],cc.get=function(e,t){null==t&&(t=!1);var n=new $o;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},cc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:cc};var dc=function(){};(n["zpp_nape.util.ZPP_Math"]=dc).__name__=["zpp_nape","util","ZPP_Math"],dc.sqrt=function(e){return Math.sqrt(e)},dc.invsqrt=function(e){return 1/dc.sqrt(e)},dc.sqr=function(e){return e*e},dc.clamp2=function(e,t){return dc.clamp(e,-t,t)},dc.clamp=function(e,t,n){return e<t?t:n<e?n:e};var mc=function(){};(n["zpp_nape.util.ZPP_PubPool"]=mc).__name__=["zpp_nape","util","ZPP_PubPool"];var fc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_Body"]=fc).__name__=["zpp_nape","util","ZPP_Set_ZPP_Body"],fc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=fc.zpp_pool,fc.zpp_pool=o},clear:function(){this.clear_with(function(e){})},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=fc.zpp_pool,fc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:fc};var gc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_CbSetPair"]=gc).__name__=["zpp_nape","util","ZPP_Set_ZPP_CbSetPair"],gc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=gc.zpp_pool,gc.zpp_pool=o},clear:function(){this.clear_with(function(e){})},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=gc.zpp_pool,gc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:gc};var vc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_PartitionVertex"]=vc).__name__=["zpp_nape","util","ZPP_Set_ZPP_PartitionVertex"],vc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=vc.zpp_pool,vc.zpp_pool=o},clear:function(){this.clear_with(function(e){})},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=vc.zpp_pool,vc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==vc.zpp_pool?t=new vc:(t=vc.zpp_pool,vc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==vc.zpp_pool?t=new vc:(t=vc.zpp_pool,vc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==vc.zpp_pool?t=new vc:(t=vc.zpp_pool,vc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==vc.zpp_pool?t=new vc:(t=vc.zpp_pool,vc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==vc.zpp_pool?t=new vc:(t=vc.zpp_pool,vc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==vc.zpp_pool?t=new vc:(t=vc.zpp_pool,vc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==vc.zpp_pool?t=new vc:(t=vc.zpp_pool,vc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:vc};var bc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_PartitionPair"]=bc).__name__=["zpp_nape","util","ZPP_Set_ZPP_PartitionPair"],bc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=bc.zpp_pool,bc.zpp_pool=o},clear:function(){this.clear_with(function(e){})},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=bc.zpp_pool,bc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==bc.zpp_pool?t=new bc:(t=bc.zpp_pool,bc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==bc.zpp_pool?t=new bc:(t=bc.zpp_pool,bc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==bc.zpp_pool?t=new bc:(t=bc.zpp_pool,bc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==bc.zpp_pool?t=new bc:(t=bc.zpp_pool,bc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==bc.zpp_pool?t=new bc:(t=bc.zpp_pool,bc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==bc.zpp_pool?t=new bc:(t=bc.zpp_pool,bc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==bc.zpp_pool?t=new bc:(t=bc.zpp_pool,bc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:bc};var yc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_SimpleVert"]=yc).__name__=["zpp_nape","util","ZPP_Set_ZPP_SimpleVert"],yc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=yc.zpp_pool,yc.zpp_pool=o},clear:function(){this.clear_with(function(e){})},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=yc.zpp_pool,yc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==yc.zpp_pool?t=new yc:(t=yc.zpp_pool,yc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==yc.zpp_pool?t=new yc:(t=yc.zpp_pool,yc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==yc.zpp_pool?t=new yc:(t=yc.zpp_pool,yc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==yc.zpp_pool?t=new yc:(t=yc.zpp_pool,yc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==yc.zpp_pool?t=new yc:(t=yc.zpp_pool,yc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==yc.zpp_pool?t=new yc:(t=yc.zpp_pool,yc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==yc.zpp_pool?t=new yc:(t=yc.zpp_pool,yc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:yc};var xc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_SimpleSeg"]=xc).__name__=["zpp_nape","util","ZPP_Set_ZPP_SimpleSeg"],xc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=xc.zpp_pool,xc.zpp_pool=o},clear:function(){this.clear_with(function(e){})},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=xc.zpp_pool,xc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==xc.zpp_pool?t=new xc:(t=xc.zpp_pool,xc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==xc.zpp_pool?t=new xc:(t=xc.zpp_pool,xc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==xc.zpp_pool?t=new xc:(t=xc.zpp_pool,xc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==xc.zpp_pool?t=new xc:(t=xc.zpp_pool,xc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==xc.zpp_pool?t=new xc:(t=xc.zpp_pool,xc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==xc.zpp_pool?t=new xc:(t=xc.zpp_pool,xc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==xc.zpp_pool?t=new xc:(t=xc.zpp_pool,xc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:xc};var zc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_SimpleEvent"]=zc).__name__=["zpp_nape","util","ZPP_Set_ZPP_SimpleEvent"],zc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=zc.zpp_pool,zc.zpp_pool=o},clear:function(){this.clear_with(function(e){})},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=zc.zpp_pool,zc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==zc.zpp_pool?t=new zc:(t=zc.zpp_pool,zc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==zc.zpp_pool?t=new zc:(t=zc.zpp_pool,zc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==zc.zpp_pool?t=new zc:(t=zc.zpp_pool,zc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==zc.zpp_pool?t=new zc:(t=zc.zpp_pool,zc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==zc.zpp_pool?t=new zc:(t=zc.zpp_pool,zc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==zc.zpp_pool?t=new zc:(t=zc.zpp_pool,zc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==zc.zpp_pool?t=new zc:(t=zc.zpp_pool,zc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:zc};var wc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_CbSet"]=wc).__name__=["zpp_nape","util","ZPP_Set_ZPP_CbSet"],wc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=wc.zpp_pool,wc.zpp_pool=o},clear:function(){this.clear_with(function(e){})},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=wc.zpp_pool,wc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==wc.zpp_pool?t=new wc:(t=wc.zpp_pool,wc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==wc.zpp_pool?t=new wc:(t=wc.zpp_pool,wc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==wc.zpp_pool?t=new wc:(t=wc.zpp_pool,wc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==wc.zpp_pool?t=new wc:(t=wc.zpp_pool,wc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==wc.zpp_pool?t=new wc:(t=wc.zpp_pool,wc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==wc.zpp_pool?t=new wc:(t=wc.zpp_pool,wc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==wc.zpp_pool?t=new wc:(t=wc.zpp_pool,wc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:wc};var kc,Sc=0;function Cc(e,t){return null==t?null:(null==t.__id__&&(t.__id__=Sc++),null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[t.__id__],null==n&&((n=function(){return n.method.apply(n.scope,arguments)}).scope=e,n.method=t,e.hx__closures__[t.__id__]=n),n);var n}n.Math=Math,String.prototype.__class__=n.String=String,String.__name__=["String"],n.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=n.Date=Date,Date.__name__=["Date"];var Nc=n.Int={__name__:["Int"]},Pc=n.Dynamic={__name__:["Dynamic"]},Mc=n.Float=Number;Mc.__name__=["Float"];var Ic=n.Bool=Boolean;Ic.__ename__=["Bool"];var Tc=n.Class={__name__:["Class"]},Ac={},Dc={},Ec=t.ArrayBuffer||_o;null==Ec.prototype.slice&&(Ec.prototype.slice=_o.sliceImpl);var Oc,Bc=t.DataView||po,Lc=t.Float32Array||uo._new,jc=t.Uint8Array||ho._new;l.game_was_already_launched=!1,o.MEASUREMENT_INTERVAL=1e3,o.FONT_FAMILY="Helvetica,Arial",o.FPS_BG_CLR="#00FF00",o.FPS_WARN_BG_CLR="#FF8000",o.FPS_PROB_BG_CLR="#FF0000",o.MS_BG_CLR="#FFFF00",o.MEM_BG_CLR="#086A87",o.INFO_BG_CLR="#00FFFF",o.FPS_TXT_CLR="#000000",o.MS_TXT_CLR="#000000",o.MEM_TXT_CLR="#FFFFFF",o.INFO_TXT_CLR="#000000",o.TOP_LEFT="TL",o.TOP_RIGHT="TR",o.BOTTOM_LEFT="BL",o.BOTTOM_RIGHT="BR",o.DELAY_TIME=4e3,m.Element=0,m.PCData=1,m.CData=2,m.Comment=3,m.DocType=4,m.ProcessingInstruction=5,m.Document=6,O.LIGHT=16054256,O.LIGHT_MID=15199710,O.MID_LIGHT=13753277,O.MID=9546397,O.DARK_MID=4087919,O.DARK=1651777,O.RED=13772832,O.ORANGE=13792544,O.GREEN=3253280,O.BLUE=1935032,O.RED_LIGHT=15640467,O.ORANGE_LIGHT=15711890,O.GREEN_LIGHT=10546070,O.BLUE_LIGHT=9687278,W.guid_prefix="guid_not_initialized",W.guid_postfix=0,ie.destroyed_entity_list=[],le.pushClass=re.pushClass,le.pushBool=re.pushBool,le.pushInt=re.pushInt,le.pushDouble=re.pushDouble,le.pushString=re.pushString,le.pushEnum=re.pushEnum,le.pushArray=re.pushArray,le.pushInstance=re.pushInstance,le.pushIgnore=re.pushIgnore,le.pushPoint=re.pushPoint,le.pushTransform=re.pushTransform,oe.debug_draw_polygons_and_circles=!1,ve.famobi_paused=!1,ve.famobi_pauseReasons=[],xe.dice_roll_add_min_frames=10,xe.dice_roll_add_max_frames=15,xe.dice_roll_available_abilities=[ye.Bomb,ye.Dynamite,ye.Armor,ye.Nitro],Se.magnet_distance=650,Me.bomb_min_existance_time=30,Me.total_explosion_time=21,Me.bomb_explosion_radius=300,Me.dynamite_explosion_radius=300,Me.barrel_explosion_radius=300,Te.shield_time=600,Te.nitro_time=60,Te.nitro_time_per_1_pick=30,Te.magnet_time=120,Te.transition_time=30,Te.shuffle_time=30,De.adjusts=[],De.updates=[],Le.balloon_time=3,Le.anchor_time=3,He.max_size=100,He.count_per_row=10,He.spacing=10,He.offset_x=225,He.offset_y=565,He.max_width_offset=-40,He.max_height=150,et.move_to_sides_speed=300,lt.min_average_velocity_threshold=35,lt.initial_rotation=.7853981633974351,lt.max_rotation=1.5707963267948701,ot.rotate_until_angle_min=.5,ot.rotate_until_angle_max=1,gt.time_frame=.2,Dt.additional_distance_to_timeout=50,Lt.flip_count=16,jt.arrow_animation_time=1,jt.arrow_speed_y=-5,Ft.barrel_fall_time_array=[1.467,1.432,1.433,1.45,1.434,1.434,1.45,1.449,1.45,1.433],Ft.total_health=100,Ft.damage_coeff=50,Ft.text_offset=-180,Gt.text_offset=-200,Gt.max_time=30,Gt.nitro_to_drive_coeff=1.5,qt.text_in_time=1,qt.challenge_show_time=2,qt.text_out_time=1,$t.car_ranking_count=10,$t.car_ranking_current=0,$t.restart_current_count=0,$t.restart_max_count=20,$t.restart_wait_frames=10,nn.smooth_steps=100,nn.scroll_coeff=30,nn.zoom_coeff=.005,nn.zoom_speed=.001,rn.time=180,rn.follow_time=0,rn.deattach_coeff=.95,rn.slow_down_delay=0,rn.slow_down_duration=60,rn.slow_down_smooth_in_duration=5,rn.slow_down_smooth_out_duration=5,rn.slow_down_time_coeff=.1,sn.background_time=.01,sn.title_pop_time=.15,sn.title_scale=.8,sn.title_scale_increase=.001,sn.title_scale_in_time=2,sn.title_alpha_out_time=.25,_n.level_number=1,_n.top_speed=0,_n.acceleration=0,_n.handling=0,_n.armor=0,mn.total_space_steps=0,mn.physics_update_time=0,fn.consolas_24="consolas_24",fn.toonish_36="toonish_36",fn.avantgarde_lt_medium_dark_26="avantgarde_lt_medium_dark_26",fn.avantgarde_lt_medium_light_26="avantgarde_lt_medium_light_26",fn.bell_gothic_std_black_dark_26="bell_gothic_std_black_dark_26",fn.bell_gothic_std_black_light_26="bell_gothic_std_black_light_26",fn.bell_gothic_std_black_very_light_26="bell_gothic_std_black_very_light_26",fn.bell_gothic_std_bold_dark_26="bell_gothic_std_bold_dark_26",fn.bell_gothic_std_bold_light_26="bell_gothic_std_bold_light_26",fn.tw_cen_mt_condensed_extra_bold_dark_29="tw_cen_mt_condensed_extra_bold_dark_29",yn.transition_time=15,kn.camera_time=60,kn.wait_for_finish_time=1,kn.finished_animation_time=15,kn.wait_for_level_stats_time=120,kn.finished_start_scale=2,kn.finished_end_scale=1,kn.camera_shake_amount=5,kn.camera_shake_time=5,Cn.init_wait=30,Cn.time_per_count=15,Cn.time_per_wait=10,Cn.max_countdown_state=5,Cn.camera_additional_offset=-80,Cn.camera_additional_offset_step=.82,Nn.anim_time=.2,Nn.anim_scale=1.5,Nn.coin_display_debug_visibility=!0,An.distance_between_text=50,An.primary_text_font_size=42,An.secondary_text_font_size=32,An.stage_height_coeff=.33,An.phase_in_time=.2,An.phase_out_time=.5,Rn.phase_in_time=.1,Rn.phase_out_time=.75,Rn.white_circle_time=.5,Rn.wheel_anim_angle_start=-100,Rn.wheel_anim_angle_end=-180,Rn.wheel_anim_time=1.5,Un.terrain_draw_count=20,Un.pre_simulate_world_steps=60,Un.pre_wait_steps=20,Un.camera_smooth_steps=30,Un.countdown_camera_smooth_steps=200,Un.slow_step_stimulation_for_desktop=!1,Un.texture_offset_add=0,Un.race_zoom_min=1,Un.race_zoom_max=.75,Un.physics_dc_coeff=1.2,Un.physics_velocity_iterations=10,Un.physics_position_iterations=10,Vn.game_trace_log=[],Xn.wait_in_menu_time=.5,Jn.max_column_count=4,Jn.distance_from_ground=120,Jn.x_distance=240,Jn.y_distance=200,Jn.scale=1,Jn.floating_time=1.5,Jn.floating_distance=15,Qn.wait_in_time=.05,Qn.anim_in_time=.35,Qn.anim_out_time=.2,ti.locked_alpha=.25,ti.white_circle_animation_time=1,ti.white_circle_min_scale=1.5,ti.white_circle_max_scale=2,li.metric_width=390,li.metric_height=30,li.metric_green_or_red_alpha=1,li.metric_offset=70,li.metric_space=20,di.scale_anim_time=1,di.map_item_anim_time=1,di.animate_in_wait_time=.1,di.animate_in_time=.6,di.animate_in_start_scale=2,xi.place_button_space=5,xi.camera_smooth_steps=10,xi.camera_smooth_steps_init=20,xi.camera_smooth_steps_init_time=1,xi.scroll_speed_coeff=1,xi.snap_distance=1e4,xi.max_scroll_to_sides=200,xi.start_drag_distance=20,xi.speed_coeff=.5,xi.speed_decrease_coeff=.5,xi.max_distance_for_speed=350,xi.max_speed=500,xi.speed_for_scroll_threshold=100,xi.close_button_anchor_x=.55,xi.close_button_anchor_y=.45,xi.main_button_deactivated_alpha=.3,xi.map_zoom_wait_time=.5,xi.finger_radius=30,xi.init_debug_scroll_location="",xi.place_treasure="treasure",xi.place_achievements="achievements",xi.place_upgrades="upgrades",xi.place_shop="shop",xi.place_map="map",Si.normal=Si.create([1,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1]),Si.ground=Si.create([0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1]),Si.ray_to_ground=Si.create([0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,1]),Si.car_body=Si.create([0,1,0,0,0,0,0,0],[1,0,1,1,1,1,1,1]),Si.car_wheel=Si.create([0,1,0,0,0,0,0,0],[1,0,1,1,1,1,1,1]),Si.car_wolf_body=Si.create([0,0,1,0,0,0,0,0],[1,1,0,1,1,1,1,1]),Si.car_wolf_wheel=Si.create([0,0,1,0,0,0,0,0],[1,1,0,1,1,1,1,1]),Si.car_suspension=Si.create([0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]),Si.car_baggage=Si.create([0,0,1,0,0,0,0,0],[1,1,0,1,1,1,1,1]),Si.car_baggage_self=Si.create([0,0,1,0,0,0,0,0],[1,1,1,1,1,1,1,1]),Si.normal_except_cars=Si.create([1,0,0,0,0,0,0,0],[1,0,1,1,1,1,1,1]),Si.only_to_ground=Si.create([0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1]),Si.no_interaction=Si.create([0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]),Pi.shine_effect_total_pause_time=45,Pi.transition_out_total_time=10,Pi.transition_out_treasure_chest_total_time=30,Pi.pickup_scale_time=6,Ei.place_coeff=.7,Ei.stunt_coeff=.3,Ei.bar_placement_y_coeff=.65,Ei.bar_scale=.9,Ei.chest_scale=.65,Ei.bar_offset_top_y=-50,Ei.bar_offset_middle_y=0,Ei.chest_offset_y=-200,Ei.buttons_offset_y=140,Ei.background_alpha=.95,Ei.menu_in_time=.3,Ei.menu_initial_scale=3.5,Ei.bar_time_in_seconds=2,Ei.pause_time_in_seconds=1,Ei.text_alpha_time=.1,Ei.indicator_anim_time=.2,Ei.indicator_anim_scale=2,Ei.chest_anim_scale=1.25,Ei.chest_default_scale=2,Ei.distance_between_buttons=400,Ei.button_anim_time=.5,Ei.button_scale_anim_time=.6,Ei.continue_button_inactive_alpha=.25,Ei.button_scale=.9,Ei.button_anim_scale=1,Ei.place_names=["0","1st","2nd","3rd","4th","5th","6th","7th","8th","9th","10th"],Ei.test_overwrite_place=-1,Ei.test_overwrite_stunts=-1,Zi.ratio_start=.6666666666666666,Zi.ratio_end=.6666666666666666,Zi.zoom_time=2,Zi.start_point=new Gi(-1e4,-6e3,2e4),Zi.camera_tied=!0,Zi.button_time=.2,Zi.button_distance_y=125,Zi.button_position_x_width_coeff=.22,Zi.button_position_y_height_coeff=.6,Zi.yacht_speed=-1.5,Zi.cloud_speed=-30,Zi.credits_menu_x_coeff=.67,Zi.credits_menu_y_coeff=.59,qi.pieces_destroy_distance=2e3,Ki.ramp_angle_in_degrees=45,tr.WAKE=1,tr.PROPS=2,tr.ANGDRAG=4,tr.ARBITERS=8,nr.car_body_default=new er(.2,.57,.7,.8,.001),nr.car_wheel_default=new er(.8,.5,1.2,.6,.005),nr.car_suspension_default=new er(0,1,2,.2,.001),nr.car_baggage_default=new er(.2,.57,.7,.1,.001),nr.box=new er(.5,.5,1.2,.4,.005),nr.balloons=new er(.8,.5,1,.2,.005),nr.balloons_line=new er(.8,.5,1,.1,.005),nr.anchor=new er(.2,.5,1,.4,.005),nr.anchor_line=new er(.2,.5,1,.2,.005),ir.total_size=50,rr.keys_forward=[87,38],rr.keys_backward=[83,40],rr.keys_left=[65,37],rr.keys_right=[68,39],rr.keys_nitro=[81,16],rr.keys_power=[69,13],rr.keys_jump=[32],sr.radius=80,or.radius=80,or.transtion_in_time=15,or.pickup_time=10,_r.radius=80,_r.down_scale=.95,_r.down_rotation=30,_r.clockwise_rotation=0,_r.anti_clockwise_rotation=-45,ur.max_angular_vel=65,ur.slow_volume_coeff=.5,ur.fast_volume_coeff=.6,cr.car_rudolf="car_rudolf",cr.car_bus="car_bus",cr.car_farm_truck="car_farm_truck",cr.car_semioval="car_semioval",cr.car_tourcycle="car_tourcycle",cr.car_ice_cream_truck="car_ice_cream_truck",cr.car_bug="car_bug",cr.car_coyote="car_coyote",cr.car_cow="car_cow",cr.car_rider="car_rider",cr.car_taxi="car_taxi",cr.all_cars=["car_rudolf","car_bus","car_farm_truck","car_semioval","car_tourcycle","car_ice_cream_truck","car_bug","car_coyote","car_cow","car_rider","car_taxi"],cr.rank_1_cars=["car_rider","car_semioval","car_bug"],cr.rank_2_cars=["car_rudolf","car_bus","car_taxi","car_farm_truck"],cr.rank_3_cars=["car_cow","car_ice_cream_truck","car_coyote","car_tourcycle"],xr.RewardedAdNothing=0,xr.RewardedAdCoins=1,xr.RewardedAdChests=2,Or.background_scale=.95,Or.icon_y=-100,Or.title_text_y=-310,Or.name_text_y=45,Or.description_text_max_width=330,Or.description_text_y=150,Or.name_text_font_size=36,Or.description_text_font_size=26,Br.card_scale=1,Br.distance_between_cards=0,Rr.text_size=22,Rr.text_offset_x=-30,Rr.offset_y=50,Rr.spacing=50,Zr.phase_in_time=20,Zr.phase_in_scale=10,Zr.phase_in_camera_shake_amount=8,Zr.phase_in_camera_shake_time=4,Zr.phase_out_time=10,Zr.phase_out_scale=2,Zr.phase_use_time=20,Zr.phase_use_scale=2.5,Zr.item_size=39,Zr.item_distance=44,Vr.reward_prefix="reward_",Vr.ongoing_prefix="ongoing_",Vr.achievement_prefix="achievement_",Vr.armor_texture="armor",Vr.bomb_texture="bomb",Vr.dynamite_texture="dynamite",Vr.acceleration_texture="acceleration",Vr.boost_texture="boost",Vr.coin_texture="coin",Vr.balloons_texture="balloons",Vr.handling_texture="handling",Vr.first_texture="first",Vr.unlock_car_texture="unlock_car",Xr.stunt_front_wheelie=0,Xr.stunt_back_wheelie=1,Xr.stunt_front_flip=2,Xr.stunt_back_flip=3,Xr.stunt_wheelie_to_flip_combo=4,Xr.stunt_flip_to_wheelie_combo=5,Xr.stunt_wheelie_combo=6,Xr.stunt_flip_combo=7,Xr.stunt_perfect_landing=8,Xr.points_flip=1e3,Xr.points_wheelie=100,Xr.points_flip_combo=700,Xr.points_wheelie_combo=500,Xr.points_flip_to_wheelie_combo=800,Xr.points_wheelie_to_flip_combo=600,Xr.points_perfect_landing=500,Xr.combo_expiration_time=1.5,Xr.wheelie_start_min_time=.4,Xr.wheelie_point_per_time_step=.2,Xr.min_speed_coeff=.5,Xr.perfect_landing_time=1.2,Xr.perfect_landing_wheel_time=.034,Xr.score_name_min_display_time=.5,Xr.phase_out_time=.2,Xr.bar_offset=80,Xr.bar_offset_per_digit=19.5,Yr.debug_angle_difference=0,Yr.debug_grip=0,Yr.debug_swipe_steps=0,Yr.corner_distance_coeff=.3,Yr.grip_min_delta_angle=.01,Yr.grip_increase=.2,Yr.grip_decrease=.05,Yr.wheel_max_force_angle=.3,Yr.atan_smoothing_multiplier=50,Yr.max_friction=.8,Qr.PI=Math.PI,Qr.PI2=2*Math.PI,Qr.DEGREES_TO_RADIANS=.017453292519943,Qr.RADIANS_TO_DEGREES=57.29577951308232,Qr.INCHES_TO_CENTIMETERS=2.54,Qr.EPSILON=1e-8,Qr.GAMMA_LANCZOS_P=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7],$r.validate_reusable_objects=!1,ea.destroyed_point_list=[],ia.destroyed_bounds_list=[],ra.destroyed_quad_list=[],la.destroyed_matrix_list=[],ka.exists=!1,Ta.award_adventurer=new Ia("adventr_drivrs_vkas001",Lr.Finish2Levels),Ta.award_back_wheelie_pro=new Ia("adventr_drivrs_vkas002",Lr.Finish6Levels),Ta.award_spinner=new Ia("adventr_drivrs_vkas003",Lr.Stunt3xFrontFlip),Ta.award_combo_pro=new Ia("adventr_drivrs_vkas004",Lr.Stunt3xCombo),Ta.award_completionist=new Ia("adventr_drivrs_vkas005",Lr.Finish10LevelsWith100Score),Ta.award_back_flip_expert=new Ia("adventr_drivrs_vkas006",Lr.Stunt10BackFlipsInALevel),Ta.award_flip_master=new Ia("adventr_drivrs_vkas007",Lr.Stunt100Flips),Ta.award_number_one=new Ia("adventr_drivrs_vkas008",Lr.Finish20Levels1st),Ta.award_combo_expert=new Ia("adventr_drivrs_vkas009",Lr.Stunt10xCombo),Ta.award_100=new Ia("adventr_drivrs_vkas010",Lr.Finish30LevelsWith100Score),Ta.all_awards=[Ta.award_adventurer,Ta.award_back_wheelie_pro,Ta.award_spinner,Ta.award_combo_pro,Ta.award_completionist,Ta.award_back_flip_expert,Ta.award_flip_master,Ta.award_number_one,Ta.award_combo_expert,Ta.award_100],Da.destroyed_description_list=[],ja.debug_on=!1,ja.debug_tree_update_ms=0,ja.debug_total_objects=0,ja.debug_add_checks=0,ja.debug_index_checks=0,ja.debug_dynamic_checks=0,Fa.destroyed_partition_objects=[],Ka.CLICK_EVENT_DISTANCE=3,es.show_adblock_warning=!1,ts.ORDER_LEFT=0,ts.ORDER_RIGHT=1,ts.ORDER_TOP=2,ts.ORDER_BOTTOM=3,rs.ID_TOPEDGE=3,rs.ID_RIGHTEDGE=0,rs.ID_BOTTOMEDGE=2,rs.ID_LEFTEDGE=1,fs.destroyed_sprite_list=[],gs.destroyed_group_list=[],vs.NAME="BEF_v3",vs.BOOL_FLAG=0,vs.BOOL_TRUE_FLAG=1,vs.BOOL_FALSE_FLAG=2,vs.INT_FLAG=3,vs.DOUBLE_FLAG=4,vs.STRING_FLAG=5,vs.NULL_FLAG=6,vs.ENUM_FLAG=7,vs.ENUM_INDEX_INDEX_FLAG=8,vs.ENUM_STRING_INDEX_FLAG=9,vs.ENUM_STRING_STRING_FLAG=10,vs.ARRAY_FLAG=11,vs.INSTANCE_FLAG=12,vs.INSTANCE_POINT_FLAG=128,vs.INSTANCE_TRANSFORM_FLAG=129,Es.debug_print_stats=!1,Es.debug_print_time_and_texture_size=!0,Es.debug_add_base_texture_to_stage=!1,Es.bleeding_fix=2,Es.destroyed_terrain_rect_list=[],Es.destroyed_sprite_object_list=[],Os.None=0,Os.BikasNet=1,Os.LaggedCom=2,Os.PokiCom=3,Os.Famobi=4,js.Development=0,js.Release=1,Gs.working_library="",Gs.working_stage="",Gs.background_objects_source="",Gs.level_data_saves=[],Gs.all_sound_loops=[],Gs.all_music_loops=[],Gs.all_sounds=[],Xs.transition_out_time=15,Qs.UNKNOWN=0,Qs.WEBGL=1,Qs.CANVAS=2,$s.paused=!1,$s.right_mouse_button_down=!1,$s.top_listeners=[],tl.TYPE_DIRECT="direct",tl.TYPE_ORGANIC="organic",tl.TYPE_REFERRAL="referral",nl.ERROR_SEVERITY_SILENCE=0,nl.ERROR_SEVERITY_TRACE=1,nl.ERROR_SEVERITY_EXCEPTIONS=2,il.SCOPE_VISITOR=1,il.SCOPE_SESSION=2,il.SCOPE_PAGE=3,ll.REFERRER_INTERNAL="0",pl.paused=!1,hl.VERSION="5.2.5",dl.parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],vl.OBJECT_KEY_NUM=1,vl.TYPE_KEY_NUM=2,vl.LABEL_KEY_NUM=3,vl.VALUE_VALUE_NUM=1,bl.TYPE_EVENT="event",bl.TYPE_TRANSACTION="tran",bl.TYPE_ITEM="item",bl.TYPE_SOCIAL="social",bl.TYPE_CUSTOMVARIABLE="var",bl.X10_CUSTOMVAR_NAME_PROJECT_ID="8",bl.X10_CUSTOMVAR_VALUE_PROJECT_ID="9",bl.X10_CUSTOMVAR_SCOPE_PROJECT_ID="11",bl.CAMPAIGN_DELIMITER="|",yl.X10_EVENT_PROJECT_ID="5",Tl.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Tl.BYTES=Il.ofString(Tl.CHARS),Ol.count=0,Ul.i64tmp=new Cl(0,0),ql.escapes=((Oc=new Ll).set("lt","<"),Oc.set("gt",">"),Oc.set("amp","&"),Oc.set("quot",'"'),Oc.set("apos","'"),Oc),Jl.LEN_EXTRA_BITS_TBL=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1],Jl.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Jl.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1],Jl.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Jl.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],to.INFINITY=new to,io.EMPTY=io._new(NaN,NaN),ro.point=io._new(),ro.zero=io._new(0,0),ro.EPSILON=1e-8,so.__toStr={}.toString,uo.BYTES_PER_ELEMENT=4,ho.BYTES_PER_ELEMENT=1,co.epsilon=1e-8,co.fluidAngularDragFriction=2.5,co.fluidAngularDrag=100,co.fluidVacuumDrag=.5,co.fluidLinearDrag=.5,co.collisionSlop=.2,co.collisionSlopCCD=.5,co.distanceThresholdCCD=.05,co.staticCCDLinearThreshold=.05,co.staticCCDAngularThreshold=.005,co.bulletCCDLinearThreshold=.125,co.bulletCCDAngularThreshold=.0125,co.dynamicSweepLinearThreshold=17,co.dynamicSweepAngularThreshold=.6,co.angularCCDSlipScale=.75,co.arbiterExpirationDelay=6,co.staticFrictionThreshold=2,co.elasticThreshold=20,co.sleepDelay=60,co.linearSleepThreshold=.2,co.angularSleepThreshold=.4,co.contactBiasCoef=.3,co.contactStaticBiasCoef=.6,co.contactContinuousBiasCoef=.4,co.contactContinuousStaticBiasCoef=.5,co.constraintLinearSlop=.1,co.constraintAngularSlop=.001,co.illConditionedThreshold=2e8,$_.FMAX=1e100,ep._Constraint=0,ep._Interactor=0,ep._CbType=0,ep._CbSet=0,ep._Listener=0,ep._ZPP_SimpleVert=0,ep._ZPP_SimpleSeg=0,ep._Space=0,ep._InteractionGroup=0,pp.ANY_SHAPE=new yo,pp.ANY_BODY=new yo,pp.ANY_COMPOUND=new yo,pp.ANY_CONSTRAINT=new yo,up.internal=!1,up.id_ImmState_ACCEPT=1,up.id_ImmState_IGNORE=2,up.id_ImmState_ALWAYS=4,up.id_GravMassMode_DEFAULT=0,up.id_GravMassMode_FIXED=1,up.id_GravMassMode_SCALED=2,up.id_InertiaMode_DEFAULT=0,up.id_InertiaMode_FIXED=1,up.id_MassMode_DEFAULT=0,up.id_MassMode_FIXED=1,up.id_BodyType_STATIC=1,up.id_BodyType_DYNAMIC=2,up.id_BodyType_KINEMATIC=3,up.id_ListenerType_BODY=0,up.id_ListenerType_CONSTRAINT=1,up.id_PreFlag_ACCEPT=1,up.id_ListenerType_INTERACTION=2,up.id_PreFlag_IGNORE=2,up.id_ListenerType_PRE=3,up.id_PreFlag_ACCEPT_ONCE=3,up.id_PreFlag_IGNORE_ONCE=4,up.id_CbEvent_BEGIN=0,up.id_CbEvent_ONGOING=6,up.id_InteractionType_COLLISION=1,up.id_CbEvent_END=1,up.id_InteractionType_SENSOR=2,up.id_CbEvent_WAKE=2,up.id_InteractionType_FLUID=4,up.id_CbEvent_SLEEP=3,up.id_InteractionType_ANY=7,up.id_CbEvent_BREAK=4,up.id_CbEvent_PRE=5,up.id_Winding_UNDEFINED=0,up.id_Winding_CLOCKWISE=1,up.id_Winding_ANTICLOCKWISE=2,up.id_ValidationResult_VALID=0,up.id_ValidationResult_DEGENERATE=1,up.id_ValidationResult_CONCAVE=2,up.id_ValidationResult_SELF_INTERSECTING=3,up.id_ShapeType_CIRCLE=0,up.id_ShapeType_POLYGON=1,up.id_Broadphase_DYNAMIC_AABB_TREE=0,up.id_Broadphase_SWEEP_AND_PRUNE=1,up.id_ArbiterType_COLLISION=1,up.id_ArbiterType_SENSOR=2,up.id_ArbiterType_FLUID=4,hp.types=[Io.get_BODY(),Io.get_CONSTRAINT(),Io.get_INTERACTION(),Io.get_PRE()],hp.events=[bo.get_BEGIN(),bo.get_END(),bo.get_WAKE(),bo.get_SLEEP(),bo.get_BREAK(),bo.get_PRE(),bo.get_ONGOING()],fp.UCbSet=new _p,fp.VCbSet=new _p,fp.WCbSet=new _p,fp.UCbType=new mp,fp.VCbType=new mp,fp.WCbType=new mp,Mp.internal=!1,Mp.COL=1,Mp.FLUID=4,Mp.SENSOR=2,Mp.types=[null,Yo.get_COLLISION(),Yo.get_SENSOR(),null,Yo.get_FLUID()],Ap.FACE1=0,Ap.FACE2=1,Ap.CIRCLE=2,Dp.internal=!1,Op.SHAPE=1,Op.BODY=2,Fp.flowpoly=new jp,Fp.flowsegs=new jp,Gp.internal=!1,Kp.me=new Kp,Kp.look_march=[-1,224,56,216,14,-1,54,214,131,99,-1,91,141,109,181,85],tu.nextId=0,yu.types=[null,M_.get_STATIC(),M_.get_DYNAMIC(),M_.get_KINEMATIC()],yu.cur_graph_depth=0,wu.types=[X_.get_CIRCLE(),X_.get_POLYGON()],Su.internal=!1,Iu.tmpaabb=new Lp,Tu.FATTEN=3,Tu.VEL_STEPS=2,$h.internal=!1,ec.internal=!1,tc.internal=!1,nc.internal=!1,ic.internal=!1,rc.internal=!1,ac.internal=!1,sc.internal=!1,lc.internal=!1,oc.internal=!1,_c.internal=!1,pc.internal=!1,uc.internal=!1,hc.internal=!1,cc.internal=!1,l.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);